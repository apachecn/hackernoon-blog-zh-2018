<html>
<head>
<title>Ethereum Development Walkthrough (Part 1: Smart contracts)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊开发演练(第1部分:智能合约)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/ethereum-development-walkthrough-part-1-smart-contracts-b3979e6e573e?source=collection_archive---------2-----------------------#2018-01-14">https://medium.com/hackernoon/ethereum-development-walkthrough-part-1-smart-contracts-b3979e6e573e?source=collection_archive---------2-----------------------#2018-01-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/d194334fb3b68035eff9d9495cf42181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u90cJ3k-ZXvLlgWg1apBEg.png"/></div></div></figure><p id="ace4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">智能合约，ICOs，Mist，Metamask，Remix，geth，web3..如果你花一点时间尝试进入以太坊发展的世界，你可能已经看到了这一切。</p><p id="29ad" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一些人将智能合约部署到测试网络，另一些人告诉你阅读黄皮书，还有一些人建议你使用truffle套件，因为它很棒。你在那里，不知道到底要做什么，也不知道所有的事情是如何一起工作的。</p><p id="0461" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果这是你阅读的第一篇关于以太坊或者区块链生态系统的文章，你会爱上它的！专家们在twitter上互相辱骂，不安全的标准和协议，未经测试和漏洞百出的开发工具。并不是所有的事情都想通了，每个人都在朝着不同的方向前进，还有很多事情要做。机构、银行和政府的未来由疯狂的开发商决定！太棒了。</p><p id="5907" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">无论如何，不要再担心了，我会试着在这个系列教程中为你把所有的点连接起来，带你穿过智能契约和dapps开发的宇宙，并向你展示一切是如何组合在一起的。</p><p id="6306" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">虽然我不会深入到每个细节，但我会链接一些材料来帮助您更好地理解一些概念，并且由您来研究它们并了解所有的小细节。本系列的目标是帮助您以最简单的方式更好地理解事物是如何协同工作的，就像朋友会向您解释一样。</p><h1 id="c474" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">我甚至不知道以太坊是什么</h1><p id="8119" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">以太坊官网是这样告诉我们的:</p><blockquote class="le lf lg"><p id="8125" class="jc jd lh je b jf jg jh ji jj jk jl jm li jo jp jq lj js jt ju lk jw jx jy jz hn dt translated">以太坊是一个运行智能合同的<strong class="je hv">分散平台</strong>:应用程序完全按照编程运行，没有任何停机、审查、欺诈或第三方干扰的可能性。</p></blockquote><p id="09ff" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">换句话说，它使用赋予我们区块链技术的能力来认证我们运行的代码的执行。</p><p id="9b14" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你不知道区块链、以太坊、比特币、加密货币或这些词的意思，我建议你听听这个精彩的播客，由<em class="lh"> Tim Ferriss </em>制作，采访<em class="lh"> Nick Szabo和Naval Ravikant: </em> <a class="ae ka" href="https://tim.blog/2017/06/04/nick-szabo/" rel="noopener ugc nofollow" target="_blank">加密货币的安静大师Nick Szabo </a></p><h1 id="522d" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">什么是智能合约？</h1><p id="ea3b" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">在以太坊上，<em class="lh">智能合约</em>是<em class="lh">可以</em>处理金钱的脚本。就这么简单。</p><p id="f743" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这些合同由我们称之为矿商的各方执行和认证。矿工是添加交易(执行智能合同、支付加密货币等)的多台计算机。)到我们称之为块的公共分类账。多个块构成一个区块链。</p><p id="ede7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们用一种叫做天然气的东西来支付这些矿工，这是履行合同的成本。当你发布智能合约，或者执行智能合约的功能，或者向另一个账户转账时，你要支付一些乙醚，这些乙醚会转化为汽油。</p><p id="9176" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果还不清楚，或者你想知道更多细节，这里有一些有趣的链接:</p><ul class=""><li id="34b7" class="ll lm hu je b jf jg jj jk jn ln jr lo jv lp jz lq lr ls lt dt translated"><a class="ae ka" href="https://www.youtube.com/watch?v=w9WLo33KfCY" rel="noopener ugc nofollow" target="_blank">视频智能合约的不同介绍。</a></li><li id="ac35" class="ll lm hu je b jf lu jj lv jn lw jr lx jv ly jz lq lr ls lt dt translated"><a class="ae ka" href="https://en.wikipedia.org/wiki/Smart_contract" rel="noopener ugc nofollow" target="_blank">维基百科上的智能合约页面。</a></li><li id="f356" class="ll lm hu je b jf lu jj lv jn lw jr lx jv ly jz lq lr ls lt dt translated"><a class="ae ka" href="https://ethereum.stackexchange.com/questions/3/what-is-meant-by-the-term-gas/62#62" rel="noopener ugc nofollow" target="_blank">更详细的解释<em class="lh">气</em>。</a></li></ul><h1 id="9f1c" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">在深入智能合约开发之前</h1><p id="112a" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">在本教程中，我会假设你已经具备了一定的软件开发基础，并且具备了Javascript和Node.JS的基础知识，否则你会很快迷失。我们将用于开发的编程语言Solidity接近Javascript的语法，由于以太坊周围的许多开发工具都是基于Javascript和NodeJS的，如果您已经对这两者都很熟悉，那么您将更容易进入。这不是给初学者的教程，如果你不理解一些概念，我会给你链接一些替代教程，剩下的由你自己研究。</p><h1 id="fcef" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">智能合同开发</h1><p id="611a" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">现在，最后，我们开始有趣的部分，正如我所说的，Solidity接近Javascript，但它们不一样。关于可靠性，我很抱歉地告诉你，前端开发人员，你不能把JQuery放在一段代码上，然后希望它能工作，你不能忽视安全性，你不能黑进去。当我们讨论安全性、开发模式和代码防错时，我们会明白为什么。</p><p id="da7d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，对于我们的第一个例子，我在想一个受到电影《时间<em class="lh">中</em>启发的剧本，在一个反乌托邦的未来，人们用他们剩余的时间去像钱一样生活。在电影中，他们有一种掰手腕的变体，涉及到玩时间，我们将这样做！用聪明的合同来赚钱。</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="md me l"/></div></figure><p id="9535" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">别担心，我会为你提供我们将在Github上看到的所有脚本。</p><p id="e1ff" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此外，如果这是你第一次处理智能合约，如果你现在不理解所有东西也没关系，这需要实践、阅读文档和一些研究来适应可靠性。</p><h2 id="ab6b" class="mf kc hu bd kd mg mh mi kh mj mk ml kl jn mm mn kp jr mo mp kt jv mq mr kx ms dt translated">代码</h2><p id="7387" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">现在，关于编码，首先，Solidity脚本的基础是下面的代码片段，<em class="lh"> pragma </em>指令告诉编译器我们正在使用哪个版本的Solidity，以及我们的契约的名称，类似于Javascript中的类的结构。这里是“摔跤”。</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="mt me l"/></div></figure><p id="0c50" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们想要两个摔跤手，所以我们将添加两个变量来保存他们帐户的地址(他们钱包的公钥)。</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="mt me l"/></div></figure><p id="6117" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在我们的小游戏中，在每一轮中，摔跤手可以投入一笔钱，如果一个人投入的钱是另一个人的两倍(总计)，他就赢了。</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="mt me l"/></div></figure><p id="d487" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">关于public/private关键字的一个重要的事情是，即使变量是私有的，这并不意味着有人不能读取它的内容，它只是意味着它只能在契约内访问，但在现实中，由于整个区块链存储在许多计算机上，存储在变量内的<em class="lh">信息</em>总是可以被其他人看到，这代表了您应该记住的第一个安全考虑。</p><p id="c8d5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">另一方面，编译器自动为公共变量创建getter函数。为了使其他契约或用户能够更改公共变量的值，您需要创建一个setter函数。</p><p id="721e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们将为游戏的每一步添加三个事件。开始时，摔跤手在比赛中为每一轮注册，结束时，摔跤手获胜。事件只是日志，它们可以用来在分布式应用程序(也称为dapps)的用户界面中调用JavaScript回调。事件甚至可以在开发过程中用于调试目的，因为在Solidity上没有与JavaScript的“console.log()”函数等效的功能。</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="mt me l"/></div></figure><p id="af83" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们将添加构造函数，在Solidity中，它与我们的契约同名，并且在创建契约时只被调用一次。</p><p id="c1e8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这里，第一个摔跤手将是创建合同的人。“msg.sender”是调用该函数的人的地址。</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="mt me l"/></div></figure><p id="a2a0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，我们让另一个摔跤手用下面的函数注册:</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="mt me l"/></div></figure><p id="4cfc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">require函数是Solidity中一个特殊的错误处理函数，如果不满足某个条件，它将恢复更改。在我们的例子中，如果变量摔跤手2等于0x0地址(相当于地址0)，我们可以继续，如果地址摔跤手2不同于0x0地址，这意味着一个玩家已经注册为对手，因此，我们将拒绝新的注册。</p><p id="6a38" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">同样，“msg.sender”是调用该函数的帐户的地址，我们发出一个事件，表示比赛开始了。</p><p id="624d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，每个摔跤手都会调用一个函数，“摔跤()”，投入金钱。如果两人都玩了，我们就看其中一人是否赢了(我们的规则是其中一人必须投入另一人两倍的现金)。“payable”关键字意味着该函数可以接收金钱，如果没有设置，该函数将不接受以太。“msg.value”是发送给合同的乙醚量。</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="mt me l"/></div></figure><p id="b4c0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后我们添加endOfGame()和endOfRound()函数。“internal”关键字与private相同，唯一的区别是内部函数可以被其他契约继承(因为Solidity类似于其他面向对象语言)，而私有函数不能被继承。</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="mt me l"/></div></figure><p id="a0f7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">请注意，我们不直接将钱交付给获胜者，虽然在这种情况下这并不重要，因为获胜者将从该合同中拿走所有的钱，在其他情况下，当多个用户可以从一个合同中撤销ether时，使用撤销模式更安全，以避免再次进入。</p><p id="1ca3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它只是意味着，例如，如果多个用户可以从一个合同中取钱，一个人可以简单地一次多次调用取款函数，并多次得到付款。因此，我们需要以这样一种方式编写我们的取款函数，它将在向他付款之前取消他应该收到的金额。</p><p id="5f71" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">看起来是这样的:</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="mt me l"/></div></figure><p id="1269" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">仅此而已。你可以在下面的<a class="ae ka" href="https://github.com/devzl/ethereum-walkthrough-1/blob/master/Wrestling.sol" rel="noopener ugc nofollow" target="_blank">链接</a>找到完整的片段:</p><div class="mu mv fm fo mw mx"><a href="https://github.com/devzl/ethereum-walkthrough-1/blob/master/Wrestling.sol" rel="noopener  ugc nofollow" target="_blank"><div class="my ab ej"><div class="mz ab na cl cj nb"><h2 class="bd hv fv z el nc eo ep nd er et ht dt translated">devzl/以太坊-漫游-1</h2><div class="ne l"><h3 class="bd b fv z el nc eo ep nd er et ek translated">以太坊-演练-1 -以太坊系列教程的第一部分“以太坊开发…</h3></div><div class="nf l"><p class="bd b gc z el nc eo ep nd er et ek translated">github.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl ja mx"/></div></div></a></div><h2 id="653a" class="mf kc hu bd kd mg mh mi kh mj mk ml kl jn mm mn kp jr mo mp kt jv mq mr kx ms dt translated">使用IDE</h2><p id="957a" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">现在复制片段，并在浏览器的新标签中打开<a class="ae ka" href="https://ethereum.github.io/browser-solidity/" rel="noopener ugc nofollow" target="_blank">混音IDE </a>:</p><p id="4147" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以直接在你的浏览器上使用<a class="ae ka" href="https://ethereum.github.io/browser-solidity/" rel="noopener ugc nofollow" target="_blank"> Remix </a>，它有很多有趣的功能，目前你很难在其他地方找到。</p><p id="c8f7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">点击页面左上方的“+”按钮，创建一个名为“摔跤. sol”的新文件，然后点击上面链接的<a class="ae ka" href="https://github.com/devzl/ethereum-walkthrough-1/blob/master/Wrestling.sol" rel="noopener ugc nofollow" target="_blank"> github repo </a>中的代码:</p><figure class="lz ma mb mc fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nm"><img src="../Images/819fee1d1e0644c39c92c7b575a37f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SwPvFkk3CgxHicZ83-6-SQ.png"/></div></div></figure><p id="21dd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后一些语法突出。Github不支持Solidity。sol扩展还没有。</p><p id="61c7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在页面的右侧，您可以找到多个有趣的选项卡，如“分析”选项卡，它将显示错误和建议。我让你更多地去发现这个工具。我想向您展示它，即使我们将在下一部分中使用其他工具，正如我之前所说，本系列教程的目标是为您将这些点连接起来，并向您展示事情是如何组合在一起的，并且由您来决定您是否能够轻松地在浏览器上使用ide。如果有的话，邀请你阅读Remix 的<a class="ae ka" href="http://remix.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">文档。</a></p><p id="d469" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者，你应该通过阅读它的<a class="ae ka" href="https://solidity.readthedocs.io/en/develop/" rel="noopener ugc nofollow" target="_blank">文档</a>来开始熟悉solidity。</p><p id="726f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在下一部分中，我们将看到如何将智能合约部署到两种测试网络，discover truffle、ganache和geth，以及它们如何能够组合在一起。</p><p id="6800" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你喜欢这第一部分，你可以在推特上找到我<a class="ae ka" href="https://twitter.com/dev_zl" rel="noopener ugc nofollow" target="_blank"> @dev_zl </a>。</p><p id="f264" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">第二部分可以在这里找到<a class="ae ka" href="https://hackernoon.com/ethereum-development-walkthrough-part-2-truffle-ganache-geth-and-mist-8d6320e12269" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="lz ma mb mc fq iv"><div class="bz el l di"><div class="nn me l"/></div></figure></div></div>    
</body>
</html>