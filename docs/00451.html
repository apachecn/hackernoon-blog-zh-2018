<html>
<head>
<title>Ethereum Development Walkthrough (Part 2: Truffle, Ganache, Geth and Mist)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊开发演练(第2部分:松露、加纳切、Geth和Mist)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/ethereum-development-walkthrough-part-2-truffle-ganache-geth-and-mist-8d6320e12269?source=collection_archive---------0-----------------------#2018-01-15">https://medium.com/hackernoon/ethereum-development-walkthrough-part-2-truffle-ganache-geth-and-mist-8d6320e12269?source=collection_archive---------0-----------------------#2018-01-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/cfca796b31fc10300e689c5b442fb9f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*cnBvRUN_L9E17gPeO_9pbg.png"/></div></figure><p id="7029" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在本系列教程的第一部分中，我们已经看到了什么是智能合同，以及它是如何工作的。现在，我们将它部署到两种测试网络。</p><h2 id="2871" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">我们将使用的工具</h2><p id="9125" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">目前最突出的工具是:</p><ul class=""><li id="53e9" class="kx ky hu ja b jb jc jf jg jj kz jn la jr lb jv lc ld le lf dt translated">Truffle:一个用于<a class="ae jw" href="https://hackernoon.com/tagged/ethereum" rel="noopener ugc nofollow" target="_blank">以太坊</a>的开发环境、测试框架和资产管道。换句话说，它帮助你开发智能合约，发布它们，测试它们，等等。你可以阅读块菌套件的<a class="ae jw" href="http://truffleframework.com/docs/" rel="noopener ugc nofollow" target="_blank">文档了解更多信息。</a></li><li id="706a" class="kx ky hu ja b jb lg jf lh jj li jn lj jr lk jv lc ld le lf dt translated">Ganache:它以前被称为TestRPC，如果你读过几个月前的教程，他们可能会将TestRPC与Truffle一起使用，但它在Truffle套件中集成TestRPC后被重命名。Ganache所做的很简单，它创建了一个虚拟以太坊<a class="ae jw" href="https://hackernoon.com/tagged/blockchain" rel="noopener ugc nofollow" target="_blank">区块链</a>，并生成一些我们将在开发过程中使用的假账户。</li><li id="629a" class="kx ky hu ja b jb lg jf lh jj li jn lj jr lk jv lc ld le lf dt translated">Mist:这是一款用于分散式网络应用的浏览器。它试图成为Chrome或Firefox的等价物，但不是Dapps。它仍然是不安全的，你不应该使用它与不可信的dapps。</li><li id="3bfa" class="kx ky hu ja b jb lg jf lh jj li jn lj jr lk jv lc ld le lf dt translated">以太坊钱包:它是Mist的一个版本，但只打开一个单一的dapp，即<a class="ae jw" href="https://wallet.ethereum.org/" rel="noopener ugc nofollow" target="_blank">以太坊钱包</a>。Mist和以太坊钱包只是UI前台。我们需要一个核心将我们连接到以太坊区块链(它可能是真正的以太坊区块链，或一个测试)。</li><li id="f299" class="kx ky hu ja b jb lg jf lh jj li jn lj jr lk jv lc ld le lf dt translated">Geth:是您计算机上的核心应用程序，它会将您连接到区块链。它也可以开始一个新的(在我们的例子中，我们将创建一个本地测试区块链)，创建合同，矿井以太网等。</li></ul><p id="a778" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们将首先使用松露和加纳切，然后使用松露和geth和Mist。</p><h1 id="355e" class="ll jy hu bd jz lm ln lo kd lp lq lr kh ls lt lu kk lv lw lx kn ly lz ma kq mb dt translated">装置</h1><p id="34b3" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">本教程的要求是你知道什么是以及如何使用命令行工具，并且你对<a class="ae jw" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> NPM </a>有点熟悉。</p><h2 id="ed30" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">松露</h2><p id="b5e0" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">打开命令行，键入下一部分:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="bca6" class="jx jy hu mh b fv ml mm l mn mo">npm install -g truffle</span></pre><p id="5745" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果出了问题，我建议你多读读松露的文件。</p><h2 id="28fb" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">加纳切</h2><p id="ce97" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">然后，安装Ganache的命令行界面:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="d4c5" class="jx jy hu mh b fv ml mm l mn mo">npm install -g ganache-cli</span></pre><p id="75d6" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你对某些事情不确定，这里是<a class="ae jw" href="https://github.com/trufflesuite/ganache-cli" rel="noopener ugc nofollow" target="_blank"> Ganache的Github页面</a>。</p><p id="9122" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">名词（noun的缩写）b:Ganache有一个<a class="ae jw" href="http://truffleframework.com/ganache/" rel="noopener ugc nofollow" target="_blank"> GUI，但是因为我们是haxors，所以我们将使用CLI。</a></p><h1 id="ad29" class="ll jy hu bd jz lm ln lo kd lp lq lr kh ls lt lu kk lv lw lx kn ly lz ma kq mb dt translated">我们开始吧</h1><p id="e718" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">首先，创建一个新文件夹，并键入下一行:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="4dda" class="jx jy hu mh b fv ml mm l mn mo">truffle init</span></pre><p id="a64f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它将初始化一个空的truffle项目。</p><p id="d46f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">然后将<a class="ae jw" rel="noopener" href="/@dev_zl/ethereum-development-walkthrough-part-1-smart-contracts-b3979e6e573e">上一个教程</a>中的<a class="ae jw" href="https://github.com/devzl/ethereum-walkthrough-1/blob/master/Wrestling.sol" rel="noopener ugc nofollow" target="_blank">摔跤. sol </a>文件复制到“合同”文件夹中。</p><p id="a1b5" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">接下来，打开文件夹“migrations”并创建一个名为“2_deploy_contracts.js”的新文件。迁移只是帮助我们将合同部署到区块链的脚本。</p><p id="df1d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">将下面的代码粘贴到里面，并保存。</p><figure class="mc md me mf fq iv"><div class="bz el l di"><div class="mp mq l"/></div></figure><p id="7ce7" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">第一行从“contracts”文件夹中导入“摔跤. sol”文件，第四行将它部署到区块链。</p><p id="df9f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，回到根文件夹，你会看到两个文件，“truffle.js”和“truffle-config.js”。如果你在Windows上，去掉“truffle.js”，如果你在另一个系统上，去掉其中一个，或者两个都保留，都不重要。原因是，在Windows上有一个命名问题，当我们想要执行Truffle命令时，它会打开配置文件“truffle.js ”,而不是读取里面的内容。</p><p id="69c7" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我正在写这个关于Windows的教程，所以我将删除“truffle.js”文件。然后，我将把这段代码放在“truffle-config.js”中:</p><figure class="mc md me mf fq iv"><div class="bz el l di"><div class="mp mq l"/></div></figure><p id="466e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它基本上是说，当使用开发网络时，使用端口7545连接到位于“127.0.0.1”(本地主机)的主机。</p><p id="8aff" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在我们准备在区块链上测试我们的代码！</p><h2 id="1954" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">测试我们的代码</h2><p id="201e" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">在第一部分中，我们将使用Ganache。</p><p id="c9d0" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">启动新的命令行并键入以下命令:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="2c05" class="jx jy hu mh b fv ml mm l mn mo">ganache-cli -p 7545</span></pre><p id="3582" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它告诉ganache-cli从端口7545开始。</p><p id="e54f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">Ganache将为我们生成测试帐户，它们默认有100个以太，并且是解锁的，所以我们可以从它们那里自由发送以太。例如，第一个客户就是这里的这个人:</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div class="fe ff mr"><img src="../Images/7b5a21c6afd7322049a093fc187f0ca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*SK6_iTRZtzxcw7lZC4wktQ.png"/></div></figure><p id="293c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，回到我们的第一个命令行界面，我们执行两个命令:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="9e13" class="jx jy hu mh b fv ml mm l mn mo">truffle compile<br/>truffle migrate --network development</span></pre><p id="2d80" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><em class="ms">编译</em>将我们的Solidity代码编译成字节码(以太坊虚拟机(EVM)理解的代码)，在我们的例子中，Ganache模拟了EVM。</p><p id="e8c9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><em class="ms"> Migrate </em>将代码部署到区块链，在我们的例子中，区块链可以在我们之前设置的网络“开发”的“truffle-config.js”文件中找到。</p><p id="fb0f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，如果一切按预期进行，您应该会在终端上看到以下内容:</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div class="fe ff mt"><img src="../Images/9882a8923285a2c1a71bd76aa75c661a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*hRN5jWhhVBuHwNkxgY6QTw.png"/></div></figure><p id="6537" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">注意，它显示了实例化摔跤契约的地址。</p><p id="f52f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在运行ganache-cli的命令行界面上，您可以看到正在执行的事务:</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div class="fe ff mu"><img src="../Images/ed762e8ea2c2d58cdfe0e3eb215b9b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*gRy2q9fWODMRGFEZqTy-vg.png"/></div></figure><p id="d0d9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">注意，它显示了实例化摔跤契约的地址。</p><p id="d7f4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在输入下面的命令来启动Truffle的控制台。这将有助于我们与加纳切的区块链互动。</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="2659" class="jx jy hu mh b fv ml mm l mn mo">truffle console --network development</span></pre><p id="ced0" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">首先，我们将执行以下命令:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="5537" class="jx jy hu mh b fv ml mm l mn mo">account0 = web3.eth.accounts[0]<br/>account1 = web3.eth.accounts[1]</span></pre><p id="996f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它将第一个帐户的地址分配给变量account0，第二个分配给变量account1。Web3是一个JavaScript API，它封装了RPC调用，帮助我们以一种简单的方式与区块链交互。</p><p id="24de" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">那我们就这样写:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="8020" class="jx jy hu mh b fv ml mm l mn mo">Wrestling.deployed().then(inst =&gt; { WrestlingInstance = inst })</span></pre><p id="33a8" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它将一个引用分配给truffle部署到变量“WrestlingInstance”的契约的实例。</p><p id="d4fb" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">执行下一行:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="b733" class="jx jy hu mh b fv ml mm l mn mo">WrestlingInstance.wrestler1.call()</span></pre><p id="3fff" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它将返回摔跤手1的地址，在我们的例子中，它是第一个帐户。松露，在迁移过程中，从Ganache那里拿起了默认账户，这是第一个账户，因为我们在迁移过程中没有指定<a class="ae jw" href="http://truffleframework.com/docs/getting_started/migrations#available-accounts" rel="noopener ugc nofollow" target="_blank">另一个账户地址</a>，或者松露的<a class="ae jw" href="http://truffleframework.com/docs/advanced/configuration" rel="noopener ugc nofollow" target="_blank">配置文件中的另一个地址。</a></p><p id="ddc6" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">然后，我们将第二个帐户注册为对手:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="73aa" class="jx jy hu mh b fv ml mm l mn mo">WrestlingInstance.registerAsAnOpponent({from: account1})</span></pre><p id="c4f8" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这里,“from”指令告诉函数应该从哪个帐户触发事务。</p><p id="e6a8" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在执行该行时，它应该返回类似如下的内容:</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="fe ff mv"><img src="../Images/9afcb312bb4a455c065520552d79b706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RTSSgEBM35XW3Ov6rjHYpw.png"/></div></div></figure><p id="ac7e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">请注意，该事务使用了Gas，并触发了事件“摔跤开始事件”。</p><p id="e21c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">您可以通过执行下面一行来检索第二个摔跤手的地址:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="2ce2" class="jx jy hu mh b fv ml mm l mn mo">WrestlingInstance.wrestler2.call()</span></pre><p id="901c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，玩家可以摔跤了:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="05be" class="jx jy hu mh b fv ml mm l mn mo">WrestlingInstance.wrestle({from: account0, value: web3.toWei(2, "ether")})<br/>WrestlingInstance.wrestle({from: account1, value: web3.toWei(3, "ether")})</span><span id="4b09" class="jx jy hu mh b fv na mm l mn mo">// End of the first round</span><span id="ca51" class="jx jy hu mh b fv na mm l mn mo">WrestlingInstance.wrestle({from: account0, value: web3.toWei(5, "ether")})<br/>WrestlingInstance.wrestle({from: account1, value: web3.toWei(20, "ether")})</span><span id="9ca1" class="jx jy hu mh b fv na mm l mn mo">// End of the wrestling</span></pre><p id="a5df" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">“value”指令用于在交易中发送以太网。“web3.toWei(5，“ether”)”部分发送5个ether，该值被转换为<a class="ae jw" href="https://www.reddit.com/r/ethereum/comments/42jcee/what_is_a_wei_number/czatvsq/" rel="noopener ugc nofollow" target="_blank"> <em class="ms"> Wei </em> </a> <em class="ms">。</em>卫是乙醚的基本单位(最低面额)。更多信息可在此<a class="ae jw" href="https://ethereum.stackexchange.com/questions/253/the-ether-denominations-are-called-finney-szabo-and-wei-what-who-are-these-na" rel="noopener ugc nofollow" target="_blank">链接</a>找到。</p><p id="3fe0" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在执行最后一行时，account1将成为赢家，因为我们总共为它添加了23个以太，这比我们为account0添加的以太多一倍。</p><p id="f358" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">对你来说，一个小练习就是从合同中撤销乙醚。</p><p id="2631" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，由您来研究如何使用Truffle和Ganache的高级功能。你可以从阅读<a class="ae jw" href="http://truffleframework.com/docs/getting_started/contracts" rel="noopener ugc nofollow" target="_blank">文档</a>开始，或者，如果你感到迷失或者想要巩固你对我们刚刚看到的知识，这里有一个<a class="ae jw" href="http://truffleframework.com/tutorials/pet-shop" rel="noopener ugc nofollow" target="_blank">极好的松露介绍</a>。</p><h1 id="203e" class="ll jy hu bd jz lm ln lo kd lp lq lr kh ls lt lu kk lv lw lx kn ly lz ma kq mb dt translated">geth在图片中的位置</h1><p id="df6d" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">现在，如果我们使用Ganache进行开发，我们会希望使用更接近真实环境的东西，即使只是为了更熟悉它。</p><h2 id="8681" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">装置</h2><p id="05d1" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">从<a class="ae jw" href="https://geth.ethereum.org/downloads/" rel="noopener ugc nofollow" target="_blank">下载geth </a>开始。在Windows上，您可能需要将geth的安装文件夹添加到PATH变量中。</p><p id="9505" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">下载<a class="ae jw" href="https://github.com/ethereum/mist/releases" rel="noopener ugc nofollow" target="_blank">迷雾或者以太坊钱包</a>。对于我们的使用，两者都是一样的，所以你选择哪一个并不重要。</p><h2 id="640e" class="jx jy hu bd jz ka kb kc kd ke kf kg kh jj ki kj kk jn kl km kn jr ko kp kq kr dt translated">创建本地专用测试网络</h2><p id="7912" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">在同一个根文件夹下，新建一个文件，命名为“genesis.json”。然后过去里面的以下内容。</p><figure class="mc md me mf fq iv"><div class="bz el l di"><div class="mp mq l"/></div></figure><p id="55d9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">文件“genesis.json”只是geth创建新区块链所需的配置文件。目前理解文件的内容并不重要。</p><p id="2b08" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果在没有指定任何参数的情况下运行geth，它将尝试连接到mainnet。mainnet是以太坊的主要网络，以太坊的真正区块链。</p><p id="62a4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果在没有指定任何参数的情况下运行Mist，如果geth的实例正在运行，它将抛出一个错误。如果您告诉Mist连接到实际正在运行的geth实例(我们一会儿就要做的)，它会工作得很好。如果在没有geth实例运行的情况下运行Mist，它将启动一个新的geth实例，并最终询问您应该从哪个区块链网络下载块。</p><p id="536e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">有一个公共以太坊测试网络，但是我们将在本地创建自己的私有测试网络，使用我们之前创建的“genesis.json”文件。</p><p id="5d4b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">启动另一个命令行界面，键入以下内容(确保在项目根文件夹中运行):</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="92aa" class="jx jy hu mh b fv ml mm l mn mo">geth --datadir=./chaindata/ init ./genesis.json</span></pre><p id="4e86" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们启动geth并指定我们的区块链将存储在哪里，这里是“chaindata”文件夹(它将自动生成)，我们用我们的“genesis.json”配置文件初始化它。</p><p id="f1d4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">然后，我们使用以下命令启动geth:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="1b68" class="jx jy hu mh b fv ml mm l mn mo">geth --datadir=./chaindata/ --rpc</span></pre><p id="e311" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">“- rpc”参数告诉geth接受rpc连接，这是必需的，以便truffle可以连接到geth。</p><p id="aea5" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">打开另一个命令行界面，使用相同的参数启动Mist(或以太坊钱包):</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="6aa8" class="jx jy hu mh b fv ml mm l mn mo">mist –rpc <a class="ae jw" href="http://127.0.0.1:8545" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8545</a></span></pre><p id="5d8a" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">“-rpc”告诉Mist(或以太坊钱包)连接到我们启动的geth实例。</p><p id="9570" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在钱包选项卡中，按添加帐户并创建新钱包:</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="fe ff nb"><img src="../Images/0535af77cd22f340536d90baa4dced86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YaHNn9OCsd3ancdLyWLdRQ.png"/></div></div></figure><p id="3d9d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">请注意，我们使用的是私有网络。<strong class="ja hv">当心那个</strong>，你不会想把你的以太网用于开发目的。</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="fe ff nc"><img src="../Images/437ec192f7ea7fddd08193ddb7a1b9a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xlzGDoKGqwnCKHmkOknJ6g.png"/></div></div></figure><p id="3aae" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我将使用密码“123456789”创建一个帐户。在真实环境中，使用更强的密码。</p><p id="2f69" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">打开一个新的命令行界面并运行以下命令:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="d77f" class="jx jy hu mh b fv ml mm l mn mo">geth attach</span></pre><p id="a06d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它将运行geth的控制台，我们现在可以与它进行交互。</p><p id="061d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在Mist UI上创建主帐户后，我们将在“geth attach”控制台中运行该命令:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="4591" class="jx jy hu mh b fv ml mm l mn mo">miner.start()</span></pre><p id="0a10" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它将启动一个miner，该过程将确认交易，几秒钟或几分钟后(取决于您的计算机)，您应该开始看到乙醚被添加到您的余额(以及您的主帐户):</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="fe ff nd"><img src="../Images/148d92c7617240dd29552349d92a12b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k_nfPCTVS8jt_GhQ5770nQ.png"/></div></div></figure><p id="c7ef" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">注意，如果你没有足够的内存可用，它可能根本不会开始挖掘。您可以使用命令“miner.stop()”停止挖掘。</p><p id="f584" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，再次打开“truffle-config.js”文件，修改如下:</p><figure class="mc md me mf fq iv"><div class="bz el l di"><div class="mp mq l"/></div></figure><p id="a94c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">“ourTestNet”是连接到geth实例所必需的配置。默认情况下，Geth在端口8545上启动。</p><p id="45d2" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在我们启动“geth attach”的命令行界面中，我们将解锁该帐户，以便我们可以使用它来从Truffle迁移智能合约，使用以下命令:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="e4e2" class="jx jy hu mh b fv ml mm l mn mo">personal.unlockAccount('0x6AC4660c960Aaf5d9E86403DDAcB4791767e5869', '123456789')</span></pre><p id="d653" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在这里，我使用了我刚刚创建的帐户的地址，这将是一个不同的地址，我将在这些测试中使用密码“123456789”。请注意，密码是以明文显示的，您应该对一个真实的帐户使用不同的方法。</p><p id="3ab4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，回到我们之前启动Truffle的命令行界面，运行以下命令:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="bb1f" class="jx jy hu mh b fv ml mm l mn mo">truffle migrate --network ourTestNet</span></pre><p id="eae1" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">它将开始把合同迁移到geth正在运行的区块链。如果您以前停止过miner，请将其启动，否则将不会执行迁移。</p><p id="0678" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果迁移成功，您将看到如下输出:</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div class="fe ff ne"><img src="../Images/d94cccd5dfc51c1ff582b2825044dca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*83NhaEUEsybnGfb3-cgA1Q.png"/></div></figure><p id="3651" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，运行以下命令启动Truffle的控制台:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="4afc" class="jx jy hu mh b fv ml mm l mn mo">truffle console --network ourTestNet</span></pre><p id="5388" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">然后运行这两个命令:</p><pre class="mc md me mf fq mg mh mi mj aw mk dt"><span id="b7d6" class="jx jy hu mh b fv ml mm l mn mo">Wrestling.address<br/>JSON.stringify(Wrestling.abi)</span></pre><p id="b845" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">您应该得到如下输出:</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="fe ff nf"><img src="../Images/797c09b294e796f74f99261a54f163eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7FQF1_1vfOqfTfbczH4jKw.png"/></div></div></figure><p id="41cc" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">第一行返回已部署的string contract实例的地址。</p><p id="cee1" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">第二条线，将还掉合同<a class="ae jw" href="https://solidity.readthedocs.io/en/develop/abi-spec.html" rel="noopener ugc nofollow" target="_blank"> ABI </a>。<a class="ae jw" href="https://solidity.readthedocs.io/en/develop/abi-spec.html" rel="noopener ugc nofollow" target="_blank"> ABI </a>基本上是对合同的描述。它包含一个函数和变量的列表。</p><p id="56ad" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><em class="ms">复制地址和ABI时，删除截图中用红色箭头突出显示的撇号。</em></p><p id="81b6" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，回到Mist，我们将打开“contracts”选项卡，并单击“watch contract”。</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="fe ff ng"><img src="../Images/6883e2275e67c849be08a0d69e3e866a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eSGa0rbU6Gc0A812zbZDOg.png"/></div></div></figure><p id="447b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">然后，我们将通过地址和我们部署的摔跤合同的ABI:</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div class="fe ff nh"><img src="../Images/e812acbedcf4682e9c1fb7d3c1a7d519.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*EADjsaMzOk2D9TVE1W7Kvw.png"/></div></figure><p id="188b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">单击“确定”，它将显示在您关注的合同列表中。点击它，它将打开合同页面。如果您向下滚动，您会看到类似这样的内容:</p><figure class="mc md me mf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="fe ff nf"><img src="../Images/809799b96d794e09904f3b3bde0ef5de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5zYZensQqxwig2KNlXHWRg.png"/></div></div></figure><p id="551e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">使用选择一个功能部件与合同进行交互。这和我们上面用松露的控制台做的一样。</p><p id="9bb4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">就这样，我们看到了Ganache和geth是如何发挥作用的。当您想要将合同部署到真实的区块链时，您应该使用第二种方法，并将geth与mainnet连接起来。</p><p id="9151" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">名词（noun的缩写）B: <em class="ms">你可以直接在Mist上部署合同，而不需要使用松露迁移系统</em>，<a class="ae jw" href="https://www.youtube.com/watch?v=TC-bDQZbXd0" rel="noopener ugc nofollow" target="_blank">这里有一个该过程的示例视频</a>。不过，在实际开发过程中使用Truffle更有趣，因为如果使用模块化方法开发智能合约，您将能够包含和导入多个其他智能合约和脚本。</p><p id="10a1" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">名词（noun的缩写）B.2:你总是可以在一个基本的nodepad应用程序上编写你的合同代码，并使用某个<a class="ae jw" href="http://nakamotoinstitute.org/trusted-third-parties/" rel="noopener ugc nofollow" target="_blank">信任的第三方</a>的门户将它部署到mainnet，但是我建议你不要这样做。</p><p id="3241" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">本教程的存储库可以在以下位置找到:</p><div class="ni nj fm fo nk nl"><a href="https://github.com/devzl/ethereum-walkthrough-2" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab ej"><div class="nn ab no cl cj np"><h2 class="bd hv fv z el nq eo ep nr er et ht dt translated">devzl/以太坊-漫游-2</h2><div class="ns l"><h3 class="bd b fv z el nq eo ep nr er et ek translated">以太坊-演练-2 -以太坊系列教程的第二部分“以太坊开发…</h3></div><div class="nt l"><p class="bd b gc z el nq eo ep nr er et ek translated">github.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz iw nl"/></div></div></a></div><h1 id="f94b" class="ll jy hu bd jz lm ln lo kd lp lq lr kh ls lt lu kk lv lw lx kn ly lz ma kq mb dt translated">最后</h1><p id="e36f" class="pw-post-body-paragraph iy iz hu ja b jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr kw jt ju jv hn dt translated">我们已经看到了开发和部署智能合同的4种方式:</p><ul class=""><li id="c98e" class="kx ky hu ja b jb jc jf jg jj kz jn la jr lb jv lc ld le lf dt translated">第一种是用松露和Ganache。由于我们复制了上一篇教程中的代码，我想告诉你，现在已经有了针对最流行的文本编辑器和ide的<a class="ae jw" href="https://solidity.readthedocs.io/en/develop/#available-solidity-integrations" rel="noopener ugc nofollow" target="_blank">插件。有些只提供语法突出显示，有些则在其他方面提供帮助。</a></li><li id="cfc9" class="kx ky hu ja b jb lg jf lh jj li jn lj jr lk jv lc ld le lf dt translated">第二个是将代码从Truffle部署到geth(以及GUI应用Mist)。</li><li id="4678" class="kx ky hu ja b jb lg jf lh jj li jn lj jr lk jv lc ld le lf dt translated">第三，当你刚刚学习Solidity时，使用Remix来编写小而简单的契约，并在Mist中部署代码，就像前面链接的视频中的<a class="ae jw" href="https://www.youtube.com/watch?v=TC-bDQZbXd0" rel="noopener ugc nofollow" target="_blank">所示。</a></li><li id="aa48" class="kx ky hu ja b jb lg jf lh jj li jn lj jr lk jv lc ld le lf dt translated">或者像一个真正的牛仔一样，您可以使用一个简单的文本编辑器来编写，然后使用一个无名的第三方的拖放部署特性来部署您的未测试的契约。</li></ul><p id="7553" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在<a class="ae jw" href="https://hackernoon.com/ethereum-development-walkthrough-part-3-security-limitations-and-considerations-d482f05278b4" rel="noopener ugc nofollow" target="_blank">下一部分</a>中，我们将<a class="ae jw" href="https://hackernoon.com/ethereum-development-walkthrough-part-3-security-limitations-and-considerations-d482f05278b4" rel="noopener ugc nofollow" target="_blank">讨论安全性</a>，因为我们的“摔跤”脚本还远未准备好在真实环境中推出。</p><p id="419b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">之后，我们将看到代币的创造，以及最初的硬币发行(ico)。</p><p id="ed47" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你喜欢第二部分，你可以在twitter上找到我。</p><figure class="mc md me mf fq iv"><div class="bz el l di"><div class="oa mq l"/></div></figure></div></div>    
</body>
</html>