<html>
<head>
<title>Habitat from Chef: Build, Deploy, and Manage Your Cloud Services</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Chef的栖息地:构建、部署和管理您的云服务</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/habitat-from-chef-build-deploy-and-manage-your-cloud-services-f35ecf60e25a?source=collection_archive---------26-----------------------#2018-01-17">https://medium.com/hackernoon/habitat-from-chef-build-deploy-and-manage-your-cloud-services-f35ecf60e25a?source=collection_archive---------26-----------------------#2018-01-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="c895" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Habitat允许您构建自己的包，<a class="ae jp" href="https://bldr.habitat.sh/#/explore" rel="noopener ugc nofollow" target="_blank">但也提供了数千个自己的包，</a>，提供了一种独立的包存储库形式，您可以将其部署到任何生产环境中。Habitat的核心概念是一个<a class="ae jp" href="http://plan.sh/" rel="noopener ugc nofollow" target="_blank"> <em class="jq"> plan.sh </em> </a>文件，其中包含了Habitat构建一个包所需的细节，还有<a class="ae jp" href="https://www.habitat.sh/docs/reference" rel="noopener ugc nofollow" target="_blank">大量的变量</a>你可以添加到一个。幸运的是，有一套工具可以帮助你摆脱定义计划文件的苦差事，包括用于Linux、macOS和Windows的CLI工具。</p><h1 id="16b6" class="jr js hu bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">创建一个计划</h1><p id="5863" class="pw-post-body-paragraph ir is hu it b iu kp iw ix iy kq ja jb jc kr je jf jg ks ji jj jk kt jm jn jo hn dt translated">在一个项目的目录中，您想要启用Habitat，发出以下命令，Habitat将尝试为您建立一个计划:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="ca2e" class="ld js hu kz b fv le lf l lg lh">hab plan init</span></pre><p id="275c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我尝试在现有节点中运行这个命令。JS项目和Habitat生成了以下计划文件:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="2224" class="ld js hu kz b fv le lf l lg lh">pkg_name=express-node-mongo-skeleton <br/>pkg_origin=chrischinchilla <br/>pkg_version="0.1.0" <br/>pkg_scaffolding="core/scaffolding-node"</span></pre><p id="d3a2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以上是一个简单的计划文件，而Habitat允许你设置复杂的变量并使用逻辑和迭代，在<a class="ae jp" href="https://www.habitat.sh/docs/developing-packages/#write-plans" rel="noopener ugc nofollow" target="_blank">关于计划</a>的Habitat文档中找到更多细节。</p><h1 id="c1d1" class="jr js hu bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">构建包</h1><p id="4a7a" class="pw-post-body-paragraph ir is hu it b iu kp iw ix iy kq ja jb jc kr je jf jg ks ji jj jk kt jm jn jo hn dt translated">有几种不同的方法来构建您的包，使用基于GUI的构建器服务，或者手动使用Habitat studio。</p><p id="079d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要使用构建器构建一个包，<a class="ae jp" href="https://bldr.habitat.sh/#/origins" rel="noopener ugc nofollow" target="_blank">登录到服务</a>，创建一个“origin”并向其添加集成点，这些集成点目前是Docker Hub (DH)或Amazon Container Registry (ACR)。您的包的来源只能是GitHub存储库，因为Habitat利用一个小应用程序来监视您指定的存储库中的变化。也许将来你的包裹会有其他来源。</p><figure class="ku kv kw kx fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff li"><img src="../Images/092e4c1db37d7ad62e5e6a280b9cbb2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wA4VLeU3WeEEvSm5.jpg"/></div></div></figure><p id="68a2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">点击<em class="jq"> Build Jobs </em>选项卡下的<em class="jq"> Build latest version </em>按钮构建您的包，或者每当您将更改推送到主分支时。如果您配置了到DH或ACR的集成，那么您总是可以在那里找到您的软件包的最新版本，或者您可以使用以下命令在任何安装了habitat的平台上手动安装一个:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="eed6" class="ld js hu kz b fv le lf l lg lh">hab install chrischinchilla/express-node-mongo-skeleton</span></pre><p id="e0de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">默认情况下，您创建的任何包对任何其他habitat用户都是公开可用的。</p><figure class="ku kv kw kx fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff lq"><img src="../Images/433abbf2585d3997fc0cb80261fb85ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xpo76zltQAjkCcme.jpg"/></div></div></figure><p id="1c80" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">studio是一个运行在Docker容器中的虚拟环境，在这里您可以迭代地构建、测试和运行包，并将它们导出到容器注册表中。在您的源文件夹中，启动Habitat Studio，这是一个自包含的最小shell环境，您可以在其中开发、构建和打包软件，而不受应用程序计划中未指定的任何依赖项的影响。</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="eee1" class="ld js hu kz b fv le lf l lg lh">hab studio enter</span></pre><p id="039b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在studio中，运行:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="c3b9" class="ld js hu kz b fv le lf l lg lh">build</span></pre><p id="c982" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">studio将开始为您下载依赖项来测试您的应用程序。当您准备好发布时，导出包:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="0b56" class="ld js hu kz b fv le lf l lg lh">hab pkg export chrischinchilla/express-node-mongo-skeleton</span></pre><figure class="ku kv kw kx fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff lr"><img src="../Images/de0fbcb502003a4030900ecae6e35ab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3VmihI-lWeZ_RNMe.jpg"/></div></div></figure><h1 id="99e3" class="jr js hu bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">连接包</h1><p id="4eb5" class="pw-post-body-paragraph ir is hu it b iu kp iw ix iy kq ja jb jc kr je jf jg ks ji jj jk kt jm jn jo hn dt translated">当然，现代应用程序很少孤立运行，为了允许habitat包彼此共享资源，您在<a class="ae jp" href="http://plan.sh/" rel="noopener ugc nofollow" target="_blank"> <em class="jq"> plan.sh </em> </a>文件中定义了什么是可共享的。</p><p id="d370" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您定义一个包可以与<code class="eh ls lt lu kz b">pkg_exports</code>共享什么，例如，端口:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="ac80" class="ld js hu kz b fv le lf l lg lh">pkg_exports=( <br/>  [port]=app.port <br/>)</span></pre><p id="57b8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以及一个套餐可以从其他带<code class="eh ls lt lu kz b">pkg_binds</code>或者<code class="eh ls lt lu kz b">pkg_binds_optional</code>的套餐里消费什么:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="4012" class="ld js hu kz b fv le lf l lg lh">pkg_binds=( <br/>  [port]=app.port <br/>)</span></pre><p id="a499" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您甚至可以在代码中使用环境变量和包来访问这些绑定，例如JavaScript中的<a class="ae jp" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank"> dotenv </a>。</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="b922" class="ld js hu kz b fv le lf l lg lh">var port =process.env.PORT</span></pre><h1 id="ff39" class="jr js hu bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">运行包</h1><p id="d638" class="pw-post-body-paragraph ir is hu it b iu kp iw ix iy kq ja jb jc kr je jf jg ks ji jj jk kt jm jn jo hn dt translated">您可以用无数种可能的方式将您的包作为Docker容器运行，包括Docker Compose，以及在它们之间共享绑定变量。这同样适用于在ACR上运行habitat-powered容器；您可以将创建的任何包作为容器运行，并通过使用环境变量在它们之间共享详细信息。</p><h1 id="6398" class="jr js hu bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">进一步探索</h1><p id="e73d" class="pw-post-body-paragraph ir is hu it b iu kp iw ix iy kq ja jb jc kr je jf jg ks ji jj jk kt jm jn jo hn dt translated">我在Habitat遇到的最大问题之一是理解它的能力。它的特性集如此丰富，探索完全可能的东西是很困难的。我联系了社区，询问他们设计Habitat的目的，得到了类似的回答。</p><figure class="ku kv kw kx fq lj"><div class="bz el l di"><div class="lv lw l"/></div></figure><p id="4406" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Habitat融合了构建系统、CI工具、服务发现等功能。该项目还处于早期阶段，所以我建议您在转移所有工具之前运行测试项目，但是我很想听听您对该工具的想法以及它将如何帮助您。</p></div><div class="ab cl lx ly hc lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hn ho hp hq hr"><p id="b985" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">最初发表于</em><a class="ae jp" href="https://dzone.com/articles/habitat-from-chef-build-deploy-and-manage-your-clo" rel="noopener ugc nofollow" target="_blank"><em class="jq">dzone.com</em></a><em class="jq">。</em></p></div></div>    
</body>
</html>