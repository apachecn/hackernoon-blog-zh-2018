<html>
<head>
<title>📝 Building a static blog using Gatsby and Strapi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">📝使用Gatsby和Strapi构建静态博客</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-a-static-blog-using-gatsby-and-strapi-8b5acfc82ad8?source=collection_archive---------1-----------------------#2018-01-18">https://medium.com/hackernoon/building-a-static-blog-using-gatsby-and-strapi-8b5acfc82ad8?source=collection_archive---------1-----------------------#2018-01-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/1234d699319cbdc9a1e5d8fdc7a4d292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nm8xfHvOa1F0poWE6-YegA.png"/></div></div></figure><p id="4ca6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">静态网站包含具有固定内容的网页。从技术上讲，它是一个简单的HTML文件列表，向每个访问者显示相同的信息。与动态网站不同，它们不需要任何后端编程或数据库。发布一个静态网站很容易:文件被上传到一个简单的网络服务器或存储提供商。静态网站的两个主要优势是安全性和速度:没有数据库，所以它不会被黑客攻击，也不需要为每个请求呈现一个页面，这使得网页浏览速度更快。</p><p id="6b56" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了让他们的创作更容易，大量开源的静态网站生成器可用:<a class="ae ka" href="https://jekyllrb.com/" rel="noopener ugc nofollow" target="_blank"> Jekyll </a>、<a class="ae ka" href="https://gohugo.io/" rel="noopener ugc nofollow" target="_blank"> Hugo </a>、<a class="ae ka" href="https://hexo.io/" rel="noopener ugc nofollow" target="_blank"> Hexo </a>等。大多数时候，内容是通过静态(最好是降价)文件或内容API来管理的。然后，生成器请求内容，将其注入到开发人员定义的模板中，并生成一堆HTML文件。</p><p id="0cd8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">渐进式网络应用程序(PWA)是高度基于JavaScript的网络应用程序，可靠、快速且吸引人。由于PWA使网页浏览速度更快，提供了更好的用户体验，它已经成为构建网页界面的默认方式。因此，在过去几年中出现了许多令人惊叹的前端框架:Angular、Vue和最近的React。</p><blockquote class="kb kc kd"><p id="a761" class="jc jd ke je b jf jg jh ji jj jk jl jm kf jo jp jq kg js jt ju kh jw jx jy jz hn dt translated"><em class="hu">盖茨比:当静态网站遇到进步的网络应用</em></p></blockquote><p id="2c00" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">静态网站和PWA都有很强的优势，这使得我们渴望在同一个项目中使用它们！幸运的是，我们有工具来弥合他们之间的差距，我们最近听说的一个肯定是盖茨比。所以，我们决定给你一个完整的例子，告诉你如何从盖茨比开始。一个静态网站需要一个内容源:在这个例子中，我们将使用一个用Strapi构建的API来交付它。</p><h2 id="0204" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">盖茨比是什么？</h2><p id="ece7" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated"><a class="ae ka" href="https://www.gatsbyjs.org/" rel="noopener ugc nofollow" target="_blank">盖茨比</a>是一个<em class="ke">风驰电掣</em> <strong class="je hv"> <em class="ke">网站框架</em> </strong> <em class="ke">为React </em>。它允许开发者在几分钟内建立基于React的网站。无论你想开发一个博客还是一个企业网站，盖茨比都会满足你的需求。</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/76bf7895085b4a5f9426708a7057ae8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*itOa2km8ytC_sIxw.jpg"/></div></div></figure><p id="548c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因为它是基于React的，所以网页不会被重新加载，这使得生成的网站非常快。大量的插件可以让开发者节省时间并从任何来源(Markdown文件、CMS等)获取数据。).盖茨比强烈基于<a class="ae ka" href="https://www.gatsbyjs.org/docs/node-interface/" rel="noopener ugc nofollow" target="_blank">“节点”接口</a>，它是盖茨比数据系统的中心。</p><p id="abe4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该项目由<a class="ae ka" href="https://twitter.com/kylemathews" rel="noopener ugc nofollow" target="_blank">凯尔·马修斯</a>创建，于2017年7月正式<a class="ae ka" href="https://www.gatsbyjs.org/blog/gatsby-v1/" rel="noopener ugc nofollow" target="_blank">发布，并且已经</a><a class="ae ka" href="https://github.com/gatsbyjs/gatsby#showcase" rel="noopener ugc nofollow" target="_blank">被数十家公司</a>使用。</p><h2 id="414e" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">什么是Strapi？</h2><p id="ac4f" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated"><a class="ae ka" href="https://strapi.io/" rel="noopener ugc nofollow" target="_blank"> Strapi </a>是<em class="ke">最先进的</em> <strong class="je hv"> <em class="ke"> Node.js无头内容管理系统</em> </strong> <em class="ke">。</em></p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/776a00208caf67ccd57a59699d2909fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uwKsrGlqqjYpxDzE.png"/></div></div></figure><p id="8e74" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">由于其可扩展的插件系统，它提供了大量的内置功能:管理面板，认证和权限管理，内容管理，API生成器等。</p><p id="5ffc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">与其他CMS不同，<strong class="je hv"> Strapi是100%开源的</strong>，这意味着:</p><ul class=""><li id="ebda" class="ln lo hu je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated"><strong class="je hv">斯特拉皮完全自由了。</strong></li><li id="35ed" class="ln lo hu je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">你可以把它放在你自己的服务器上，这样你就拥有了数据。</li><li id="1374" class="ln lo hu je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">多亏了插件系统，它完全是可定制和可扩展的。</li></ul><h1 id="3af4" class="mb kj hu bd kk mc md me ko mf mg mh ks mi mj mk kv ml mm mn ky mo mp mq lb mr dt translated">API设置</h1><p id="c706" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">为了创造奇迹，让我们创建一个Strapi API并添加一些内容。</p><h2 id="3148" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">创建一个Strapi项目</h2><p id="eef9" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">安装Strapi</p><p id="3d2b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ke">要求:请确保</em> <a class="ae ka" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank"> <em class="ke">节点8 </em> </a> <em class="ke">(或更高版本)和</em><a class="ae ka" href="https://docs.mongodb.com/manual/installation/" rel="noopener ugc nofollow" target="_blank"><em class="ke">MongoDB</em></a><em class="ke">已经安装并运行在您的机器上。</em></p><p id="8d9f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用npm安装Strapi:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="816b" class="ki kj hu mt b fv mx my l mz na">$ npm i strapi@alpha -g</span></pre><p id="1d88" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ke">注:Strapi v3还是alpha版本，不过对于本教程来说就没问题了。</em></p><p id="e18f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">生成一个Strapi项目</p><p id="1144" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建一个名为<code class="eh nb nc nd mt b">gatsby-strapi-tutorial</code>的目录:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="0b50" class="ki kj hu mt b fv mx my l mz na">$ mkdir gatsby-strapi-tutorial</span></pre><p id="444e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">通过一个命令行在其中搭建您的API:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="a039" class="ki kj hu mt b fv mx my l mz na">$ cd gatsby-strapi-tutorial<br/>$ strapi new api</span></pre><p id="b421" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">启动服务器</p><p id="212e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在项目的文件夹中输入:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="b52d" class="ki kj hu mt b fv mx my l mz na">$ cd api</span></pre><p id="93ce" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">启动Node.js服务器:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="21eb" class="ki kj hu mt b fv mx my l mz na">$ strapi start</span></pre><p id="d1af" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从现在开始，您应该能够访问项目的管理面板:<a class="ae ka" href="http://localhost:1337/admin" rel="noopener ugc nofollow" target="_blank">http://localhost:1337/admin</a>。</p><h2 id="c797" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">创建您的第一个用户</h2><p id="1ad3" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">从<a class="ae ka" href="http://localhost:1337/admin/plugins/users-permissions/auth/register" rel="noopener ugc nofollow" target="_blank">注册页面</a>添加您的第一个用户。</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/ace0e1aa0b36c3bc8226af272488c677.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CSopc-xv07Ed8CWC.png"/></div></div></figure><h2 id="e14d" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">创建内容类型</h2><p id="7ecc" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">Strapi APIs基于一种叫做内容类型的数据结构(相当于框架中的模型和Wordpress中的内容类型)。</p><p id="c4fc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ka" href="http://localhost:1337/admin/plugins/content-type-builder/" rel="noopener ugc nofollow" target="_blank">创建一个名为<code class="eh nb nc nd mt b">article</code>的内容类型</a>，包含四个字段:</p><ul class=""><li id="b949" class="ln lo hu je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated"><code class="eh nb nc nd mt b">title</code>(类型<code class="eh nb nc nd mt b">string</code>)</li><li id="a2c5" class="ln lo hu je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated"><code class="eh nb nc nd mt b">content</code>(类型<code class="eh nb nc nd mt b">text</code>)</li><li id="a9be" class="ln lo hu je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated"><code class="eh nb nc nd mt b">image</code>(类型<code class="eh nb nc nd mt b">media</code>)</li><li id="d28d" class="ln lo hu je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated"><code class="eh nb nc nd mt b">author</code>(类型<code class="eh nb nc nd mt b">relation</code>，一个用户多条)</li></ul><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ne"><img src="../Images/b30b0235b3ccd54317541183652a2820.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yiC3QRE4xdtf1Lwx.png"/></div></div></figure><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nf"><img src="../Images/eb018bdb0f09fd702d236f892f81ba29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*izqU0eq81Sy65i_vhGMtRQ.png"/></div></div></figure><h2 id="b867" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">插入一些条目</h2><p id="19fb" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">在数据库中添加一些文章。为此，请遵循以下说明:</p><ol class=""><li id="25cf" class="ln lo hu je b jf jg jj jk jn lp jr lq jv lr jz ng lt lu lv dt translated">访问<a class="ae ka" href="http://localhost:1337/admin/plugins/content-type-builder/models/article" rel="noopener ugc nofollow" target="_blank">文章列表页面</a>。</li><li id="9106" class="ln lo hu je b jf lw jj lx jn ly jr lz jv ma jz ng lt lu lv dt translated">点击<code class="eh nb nc nd mt b">Add New Article</code>。</li><li id="7b4a" class="ln lo hu je b jf lw jj lx jn ly jr lz jv ma jz ng lt lu lv dt translated">插入值，链接到作者并提交表单。</li><li id="5a51" class="ln lo hu je b jf lw jj lx jn ly jr lz jv ma jz ng lt lu lv dt translated">创建另外两篇文章。</li></ol><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/8d0028d126b022baa622e60e5a38bbbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F3Aoj64rb2za-nMk.png"/></div></div></figure><h2 id="35a8" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">允许访问</h2><p id="d206" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">出于安全原因，默认情况下，<a class="ae ka" href="http://localhost:1337/article" rel="noopener ugc nofollow" target="_blank"> API访问</a>是受限制的。要允许访问，请访问来宾角色的<a class="ae ka" href="http://localhost:1337/admin/plugins/users-permissions/roles" rel="noopener ugc nofollow" target="_blank">授权和权限部分，选择<code class="eh nb nc nd mt b">Article - find</code>操作并保存。此时，您应该能够</a><a class="ae ka" href="http://localhost:1337/articles" rel="noopener ugc nofollow" target="_blank">请求文章列表</a>。</p><p id="71e7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">作者API访问权限也受到限制。通过选择<code class="eh nb nc nd mt b">find</code>(在“用户&amp;权限”部分)动作并保存表单来授权匿名访问。</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/fc4f6f2a086241a6a1aff2e5b0678d6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MXEOpf2AZCjghH3C.png"/></div></div></figure><h1 id="15b6" class="mb kj hu bd kk mc md me ko mf mg mh ks mi mj mk kv ml mm mn ky mo mp mq lb mr dt translated">静态网站开发</h1><p id="e2ad" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">干得好，我们的API已经准备好了！我们可以开始开发静态网站。</p><h2 id="0f26" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">安装盖茨比</h2><p id="4b35" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">首先，安装Gatsby CLI:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="4b4f" class="ki kj hu mt b fv mx my l mz na">$ npm install --global gatsby-cli</span></pre><h2 id="a2ba" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">生成一个盖茨比项目</h2><p id="8183" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">在您之前创建的文件夹<code class="eh nb nc nd mt b">gatsby-strapi-tutorial</code>中，生成您的全新博客:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="e4d0" class="ki kj hu mt b fv mx my l mz na">$ gatsby new blog</span></pre><h2 id="aab8" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">以开发模式开始</h2><p id="1042" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">在项目的文件夹中输入:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="7bd3" class="ki kj hu mt b fv mx my l mz na">$ cd blog</span></pre><p id="5095" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">启动服务器:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="fd23" class="ki kj hu mt b fv mx my l mz na">$ gatsby develop</span></pre><p id="b6aa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">至此，您应该已经能够通过这个地址访问您的Gatsby网站:<a class="ae ka" href="http://localhost:8000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8000 </a>。</p><h2 id="1c0f" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">安装Strapi源代码插件</h2><p id="a595" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">当你管理一个静态网站时，你的数据可能来自不同的来源:Markdown文件、CSV文件、WordPress网站(使用JSON REST API插件)等。</p><p id="b909" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">盖茨比很明白这一点。所以它的创造者决定建立一个特定的、独立的层:数据层。整个系统由GraphQL提供强大的支持。</p><p id="ec80" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要将Gatsby连接到一个新的数据源，您必须<a class="ae ka" href="https://www.gatsbyjs.org/docs/create-source-plugin" rel="noopener ugc nofollow" target="_blank">开发一个新的数据源插件</a>。幸运的是，<a class="ae ka" href="https://www.gatsbyjs.org/docs/plugins" rel="noopener ugc nofollow" target="_blank">几个源码插件已经存在了</a>，所以其中的一些应该可以满足你的需求。</p><p id="8b6b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这个例子中，我们使用的是Strapi。显然，我们需要一个Strapi APIs的源代码插件。好消息:<a class="ae ka" href="https://github.com/strapi/gatsby-source-strapi" rel="noopener ugc nofollow" target="_blank">我们为你建造了它</a>！</p><p id="dcc1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们安装它:</p><pre class="lj lk ll lm fq ms mt mu mv aw mw dt"><span id="d952" class="ki kj hu mt b fv mx my l mz na">$ npm install --save gatsby-source-strapi</span></pre><p id="036b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个插件需要一些配置。将<code class="eh nb nc nd mt b">gatsby-config.js</code>的内容替换为:</p><p id="a957" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ke">路径:</em>T1】</p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="c5cc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，重启服务器，让Gatsby考虑这些更新。</p><h2 id="599f" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">文章列表</h2><p id="f243" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">首先，我们要显示文章列表。为此，请在现有主页文件中添加以下内容:</p><p id="442f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ke">路径:</em> <code class="eh nb nc nd mt b"><em class="ke">src/pages/index.js</em></code></p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="7d94" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们在这里做什么？</p><p id="bb36" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在文件的结尾，我们导出了<code class="eh nb nc nd mt b">pageQuery</code>，这是一个GraphQL查询，请求文章的完整列表。如您所见，由于精确的GraphQL查询语言，我们只需要<code class="eh nb nc nd mt b">id</code>、<code class="eh nb nc nd mt b">title</code>和<code class="eh nb nc nd mt b">content</code>字段。</p><p id="b143" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，我们将<code class="eh nb nc nd mt b">{ data }</code>析构对象作为<code class="eh nb nc nd mt b">IndexPage</code>的参数进行传递，并对其<code class="eh nb nc nd mt b">allStrapiArticles</code>对象进行循环以显示数据。</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/6ea4081bb547dfc602991228383a5159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XJhkwZOE7KWl5Jc0.png"/></div></div></figure><p id="05d2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">提示:在几秒钟内生成您的GraphQL查询！</p><p id="c0fb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Gatsby包含了一个有用的GraphiQL接口。它使得GraphQL查询的开发方式更加简单和直观。<a class="ae ka" href="http://localhost:8000/___graphql" rel="noopener ugc nofollow" target="_blank">查看它</a>并尝试创建一些查询。</p><h2 id="022e" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">添加图像</h2><p id="7fcb" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">要添加图像，我们需要从默认安装的包<code class="eh nb nc nd mt b">gatsby-image</code>中导入<code class="eh nb nc nd mt b">Img</code>。用以下内容替换<code class="eh nb nc nd mt b">src/pages/index.js</code>的内容:</p><p id="1f7f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">路径:<code class="eh nb nc nd mt b">src/pages/index.js</code></p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="nh ni l"/></div></figure><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nf"><img src="../Images/feb6cc73ff3a37b9066141a9e2911f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JcpVYRt3j6lr0mZEUvF9yA.png"/></div></div></figure><h2 id="4ded" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">文章视图</h2><p id="cf74" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">我们的网站现在开始看起来像一个博客，这是一件好事。然而，仍然缺少一个重要的部分:文章的详细信息页面。</p><p id="f24a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们创建包含特定GraphQL请求并定义显示内容的模板:</p><p id="8243" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ke">路径:</em> <code class="eh nb nc nd mt b"><em class="ke">src/templates/article.js</em></code></p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="8d03" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这看起来不错，但是此时，Gatsby不知道何时应该显示这个模板。每篇文章都需要一个特定的URL。因此，我们将通过<code class="eh nb nc nd mt b"><a class="ae ka" href="https://www.gatsbyjs.org/docs/creating-and-modifying-pages" rel="noopener ugc nofollow" target="_blank">createPage</a></code> <a class="ae ka" href="https://www.gatsbyjs.org/docs/creating-and-modifying-pages" rel="noopener ugc nofollow" target="_blank">函数</a>通知Gatsby我们需要的新URL。</p><p id="ba18" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，我们将编写一个名为<code class="eh nb nc nd mt b">makeRequest</code>的新函数来执行GraphQL请求。然后，我们导出一个名为<code class="eh nb nc nd mt b">createPages</code>的函数，在这个函数中，我们获取文章列表，并为每篇文章创建一个页面。结果如下:</p><p id="8efa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ke">路径:</em>T4】</p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="b327" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">重启Gatsby服务器。</p><p id="942f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从现在开始，您应该可以通过点击主页上显示的URL来访问详细页面。</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/6e8349b1445589f8be1117d9a8621321.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qRxwVT_Vqz7knhdk.png"/></div></div></figure><h2 id="d41f" class="ki kj hu bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc dt translated">作者视图</h2><p id="9926" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">文章是作者写的。他们应该有一个专门的页面。</p><p id="115e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建作者视图和文章页面的过程非常相似。首先，我们创建模板:</p><p id="be46" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ke">路径:</em>T5】</p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="727a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">其次，我们更新<code class="eh nb nc nd mt b">gatsby-node.js</code>文件来创建URL:</p><p id="6463" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ke">路径:</em>T7】</p><figure class="lj lk ll lm fq iv"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="9068" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，重启服务器，从文章视图的链接访问作者页面。</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/cad320ca4e9ff53f7d15e23ea5e6ce57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ztKZaDnO_WLMXHBP.png"/></div></div></figure><h1 id="b379" class="mb kj hu bd kk mc md me ko mf mg mh ks mi mj mk kv ml mm mn ky mo mp mq lb mr dt translated">结论</h1><p id="d445" class="pw-post-body-paragraph jc jd hu je b jf ld jh ji jj le jl jm jn lf jp jq jr lg jt ju jv lh jx jy jz hn dt translated">恭喜你。您已经成功构建了一个超级快速且易于维护的博客！</p><p id="569e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因为内容是由Strapi管理的，所以作者可以通过一个很好的UI来写文章，开发人员只需要重新构建Gatsby博客来更新内容。</p><p id="c1e4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> <em class="ke">下一步何去何从？</em> </strong></p><p id="e427" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">请继续这个项目，发现盖茨比和斯特拉皮的优点。这里有一些你可以添加的特性:作者列表，文章类别，以及带有Strapi API或Disqus的评论系统。你也可以创建其他类型网站(电子商务商店、公司网站等)。).</p><p id="20e2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当您的项目完成后，您可能会想要部署它。盖茨比生成的静态网站可以<a class="ae ka" href="https://www.gatsbyjs.org/docs/deploy-gatsby/" rel="noopener ugc nofollow" target="_blank">轻松发布在存储提供商</a>上:Netlify、S3/Cloudfront、GitHub pages、GitLab pages、Heroku等。Strapi API只不过是一个简单的Node.js API，因此它可以托管在Heroku或任何安装了Node.js的Linux实例上。</p><p id="27dc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">本教程的<a class="ae ka" href="https://github.com/strapi/strapi-examples/tree/master/gatsby-strapi-tutorial" rel="noopener ugc nofollow" target="_blank">代码源可在GitHub </a>上获得。要实时观看，克隆存储库，运行<code class="eh nb nc nd mt b">npm run setup</code>，启动Strapi服务器(<code class="eh nb nc nd mt b">cd api &amp;&amp; strapi start</code>)和Gatsby服务器(<code class="eh nb nc nd mt b">cd blog &amp;&amp; npm run develop</code>)。</p><p id="60f7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们希望你喜欢这个教程。请随意评论它，分享它，并让我们知道您是如何创建用React构建的站点并管理它们的内容的。</p></div></div>    
</body>
</html>