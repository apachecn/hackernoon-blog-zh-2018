<html>
<head>
<title>Introduction to Headless Chrome with Java</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Java无头Chrome简介</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/introduction-to-headless-chrome-with-java-b591bc4764a0?source=collection_archive---------12-----------------------#2018-01-18">https://medium.com/hackernoon/introduction-to-headless-chrome-with-java-b591bc4764a0?source=collection_archive---------12-----------------------#2018-01-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/58ec4186f10a736b11b1706a5d47ce64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TXu3-11RKO6sfN7R9pakTg.jpeg"/></div></div></figure><div class=""/><p id="3e6c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在前面的文章中，我向您介绍了两种不同的<a class="ae ka" href="https://hackernoon.com/tagged/tools" rel="noopener ugc nofollow" target="_blank">工具</a>来用Java执行网页抓取。<a class="ae ka" href="https://ksah.in/introduction-to-web-scraping-with-java/" rel="noopener ugc nofollow" target="_blank"> HtmlUnit </a>在第一篇文章中，而<a class="ae ka" href="https://ksah.in/web-scraping-handling-ajax-website/" rel="noopener ugc nofollow" target="_blank"> PhantomJS </a>在关于处理<a class="ae ka" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> Javascript </a>的文章中沉甸甸的网站。</p><p id="fd3d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这次我们将从<a class="ae ka" href="https://hackernoon.com/tagged/chrome" rel="noopener ugc nofollow" target="_blank"> Chrome </a>引入一个新特性，即<strong class="je ig"> <em class="kb">无头</em> </strong>模式。有一个谣言流传开来，说谷歌使用了一个特殊版本的Chrome来满足他们的爬行需求。我不知道这是不是真的，但谷歌几个月前推出了Chrome 59无头模式。</p><p id="77fc" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"> <em class="kb">本文节选自我的新书《Java Web scratching manual》</em></strong><strong class="je ig"><em class="kb">该书将教会你崇高的Web scratching艺术。从解析HTML到破解验证码，处理大量的Javascript网站等等。</em> </strong></p><p id="3f15" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">PhantomJS是这个领域的领导者，它曾经(现在仍然)大量用于浏览器自动化和测试。听到无头Chrome的消息后，这位PhantomJS维护者说他将辞去维护者的职务，因为我引用了<em class="kb">“Google Chrome比PhantomJS[……]”</em><br/>更快更稳定。看起来无头Chrome正在成为浏览器自动化和处理大量Javascript网站的一种方式。</p><p id="0f5e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">HtmlUnit、PhantomJS和其他无头浏览器都是非常有用的工具，问题是它们没有Chrome稳定，有时您会遇到Chrome不会出现的<a class="ae ka" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> Javascript </a>错误。</p><h1 id="5474" class="kc kd if bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">先决条件</h1><ul class=""><li id="ed75" class="la lb if je b jf lc jj ld jn le jr lf jv lg jz lh li lj lk dt translated">谷歌浏览器&gt; 59</li><li id="eee8" class="la lb if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated"><a class="ae ka" href="https://sites.google.com/a/chromium.org/chromedriver/downloads" rel="noopener ugc nofollow" target="_blank">镀铬工</a></li><li id="7f57" class="la lb if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">硒</li><li id="28e0" class="la lb if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">在您的<strong class="je ig"> <em class="kb"> pom.xml </em> </strong>中添加最新版本的硒:</li></ul><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="fd96" class="lz kd if lv b fv ma mb l mc md">&lt;dependency&gt; &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt; &lt;artifactId&gt;selenium-java&lt;/artifactId&gt; &lt;version&gt;3.8.1&lt;/version&gt; &lt;/dependency&gt;</span></pre><p id="a32b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您没有安装Google Chrome，您可以在这里下载<a class="ae ka" href="https://www.google.com/chrome/browser/desktop/index.html" rel="noopener ugc nofollow" target="_blank"/><br/>要安装Chromedriver，您可以在MacOS上使用brew:</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="d0f8" class="lz kd if lv b fv ma mb l mc md">brew install chromedriver</span></pre><p id="d362" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或使用以下链接下载。<br/>有很多版本，我建议你使用Chrome和chromedriver的最后一个版本。</p><p id="e0fb" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这一部分中，我们将登录Hacker News，并在登录后拍摄一个屏幕快照。我们不需要Chrome无头来完成这个任务，但本文的目的只是向您展示如何使用Selenium来运行无头Chrome。</p><p id="46e1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们要做的第一件事是创建一个WebDriver对象，并设置chromedriver路径和一些参数:</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="cafe" class="lz kd if lv b fv ma mb l mc md">// Init chromedriver <br/>String chromeDriverPath = "/Path/To/Chromedriver" ; System.setProperty("webdriver.chrome.driver", chromeDriverPath); ChromeOptions options = new ChromeOptions(); options.addArguments("--headless", "--disable-gpu", "--window-size=1920,1200","--ignore-certificate-errors"); WebDriver driver = new ChromeDriver(options);</span></pre><p id="87df" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Windows系统上需要<code class="eh me mf mg lv b">--disable-gpu</code>选项，根据<a class="ae ka" href="https://developers.google.com/web/updates/2017/04/headless-chrome" rel="noopener ugc nofollow" target="_blank">文档</a> <br/> Chromedriver应该会自动找到Google Chrome的可执行路径，如果你有一个特殊的安装，或者如果你想使用不同版本的Chrome，你可以用:</p><pre class="lq lr ls lt fq lu lv lw lx aw ly dt"><span id="2d76" class="lz kd if lv b fv ma mb l mc md">options.setBinary("/Path/to/specific/version/of/Google Chrome");</span></pre><p id="701e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你想进一步了解不同的选项，这里是<a class="ae ka" href="https://sites.google.com/a/chromium.org/chromedriver/capabilities" rel="noopener ugc nofollow" target="_blank"> Chromedriver文档</a></p><p id="2b32" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下一步是对Hacker News登录表单执行GET请求，选择用户名和密码字段，用我们的凭据填写该字段，然后单击登录按钮。然后，我们必须检查凭据错误，如果我们已经登录，那么可以采取一个屏幕截图。</p><figure class="lq lr ls lt fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mh"><img src="../Images/fbe805bfa4ccf53d9cd4415cb2ce8d78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*84MfSiflBx9VInqF.png"/></div></div></figure><p id="011b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们在之前的一篇文章中已经这样做了，下面是完整的代码:</p><figure class="lq lr ls lt fq hw"><div class="bz el l di"><div class="mi mj l"/></div></figure><p id="4581" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你现在应该有一个很好的屏幕截图，黑客新闻主页，而被认证。正如您所看到的，Chrome无头确实很容易使用，它与PhantomJS没有什么不同，因为我们使用Selenium来运行它。</p><p id="38cc" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">和往常一样，代码可以在这个<a class="ae ka" href="https://github.com/ksahin/introWebScraping" rel="noopener ugc nofollow" target="_blank"> Github存储库</a>中获得</p><p id="a470" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"> <em class="kb">本文节选自我的新书</em> </strong> <a class="ae ka" href="https://www.javawebscrapinghandbook.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="je ig"> <em class="kb"> Java刮网手册</em> </strong> </a> <strong class="je ig"> <em class="kb">这本书会教你刮网的高贵艺术。从解析HTML到破解captchas，再到处理大量的Javascript网站等等。</em> </strong> <a class="ae ka" href="https://www.javawebscrapinghandbook.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="je ig"> <em class="kb">结账出书！</em> </strong> </a></p></div><div class="ab cl mk ml hc mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hn ho hp hq hr"><p id="3ee3" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="kb">原载于</em><a class="ae ka" href="https://ksah.in/introduction-to-chrome-headless/" rel="noopener ugc nofollow" target="_blank"><em class="kb">ksah . in</em></a><em class="kb">2018年1月18日。</em></p><figure class="lq lr ls lt fq hw"><div class="bz el l di"><div class="mr mj l"/></div></figure></div></div>    
</body>
</html>