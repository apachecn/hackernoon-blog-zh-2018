<html>
<head>
<title>Adding a CMS to Your Static Site With Netlify CMS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Netlify CMS向静态站点添加CMS</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/adding-a-cms-to-your-static-site-with-netlify-cms-4adadf49aac2?source=collection_archive---------7-----------------------#2018-01-19">https://medium.com/hackernoon/adding-a-cms-to-your-static-site-with-netlify-cms-4adadf49aac2?source=collection_archive---------7-----------------------#2018-01-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="ed48" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">近七年来，我一直是CMS的实现者和贡献者，主要是用Drupal，但偶尔也用Joomla！还有WordPress。大约3年前，我遇到了Jekyll，我有了一个启示，一个让我管理和呈现内容的系统，但以一种适合我作为一个作家的方式，使用标记格式，如markdown，reStructuredText和Asciidoc。虽然纯文本和版本控制方法对某些人来说很好，尽管GitHub和GitLab等供应商尽了最大努力，但对技术不太精通的人来说仍然不太容易使用。许多项目试图弥合这一差距，融合两个世界的精华，从商业SaaS提供商如<a class="ae jp" href="https://www.contentful.com/" rel="noopener ugc nofollow" target="_blank"> Contentful </a>、<a class="ae jp" href="https://prismic.io/" rel="noopener ugc nofollow" target="_blank"> Prismic </a>或<a class="ae jp" href="https://cloudcannon.com/" rel="noopener ugc nofollow" target="_blank"> CloudCannon </a>到开源选项如<a class="ae jp" href="https://getcockpit.com/" rel="noopener ugc nofollow" target="_blank"> Cockpit </a>和<a class="ae jp" href="https://getmesh.io/" rel="noopener ugc nofollow" target="_blank"> getmesh </a>。</p><p id="ae19" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就在一年多前，<a class="ae jp" href="https://www.netlify.com/" rel="noopener ugc nofollow" target="_blank"> Netlify </a>，静态网站的神奇主机宣布了“<a class="ae jp" href="https://www.netlifycms.org/docs/" rel="noopener ugc nofollow" target="_blank"> Netlify CMS </a>”，它看起来很有前途，为git工作流添加了一个类似CMS的接口。我做了一些初步的调查，但现在终于有时间来研究如何设置和使用它了。</p><p id="72c9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我会将Netlify CMS (NC)与Jekyll一起使用，但您可以找到如何将其添加到<a class="ae jp" href="https://www.netlifycms.org/docs/add-to-your-site" rel="noopener ugc nofollow" target="_blank">其他现有静态站点</a>或<a class="ae jp" href="https://www.netlifycms.org/docs/start-with-a-template/" rel="noopener ugc nofollow" target="_blank">从一个新站点</a>开始的说明。</p><h1 id="1ecb" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">将Netlify CMS添加到Jekyll</h1><p id="3c45" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">用<em class="kt">index.html</em>和<em class="kt"> config.yml </em>文件创建一个<em class="kt"> admin </em>文件夹；它们分别作为管理界面及其背后的设置的网关。</p><p id="a228" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<em class="kt">index.html</em>中，添加创建管理界面所需的框架HTML、JavaScript和CSS，对于完全定制的品牌，你也可以添加链接到你的样式表，但由于这是管理“后端”，你可能不需要它们。</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="7f83" class="ld jr hu kz b fv le lf l lg lh">&lt;!doctype html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>  &lt;meta charset="utf-8" /&gt;<br/>  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;<br/>  &lt;title&gt;Content Manager&lt;/title&gt;<br/>  &lt;!-- Add your own styles here --&gt;<br/>  &lt;link rel="stylesheet" href="<a class="ae jp" href="https://unpkg.com/netlify-cms@" rel="noopener ugc nofollow" target="_blank">https://unpkg.com/netlify-cms@</a>^1.0.0/dist/cms.css" /&gt;</span><span id="e290" class="ld jr hu kz b fv li lf l lg lh">&lt;/head&gt;<br/>&lt;body&gt;<br/>  &lt;!-- Include the script that builds the page and powers Netlify CMS --&gt;<br/>  &lt;script src="<a class="ae jp" href="https://unpkg.com/netlify-cms@" rel="noopener ugc nofollow" target="_blank">https://unpkg.com/netlify-cms@</a>^1.0.0/dist/cms.js"&gt;&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="56db" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当然，配置文件因您的用例而异，但是我将向您展示我在我的'<a class="ae jp" href="https://www.gregariousmammal.com/" rel="noopener ugc nofollow" target="_blank">群居哺乳动物</a>'站点中使用的文件，您可以从那里进行推断。</p><p id="02f6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，确定后端类型，如果用户需要认证才能访问它，您可以使用Netlify或GitHub中定义的用户(那些具有推送访问的用户)。我想允许用户在Netlify之外更改内容，所以使用GitHub方法:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="b50a" class="ld jr hu kz b fv le lf l lg lh">backend:<br/>  name: github<br/>  repo: GregariousMammal/Main-Site # Path to Github repository<br/>  branch: master # Branch to update</span></pre><p id="574b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要定义哪些用户可以访问管理后端和编辑内容，我建议你阅读<a class="ae jp" href="https://www.netlifycms.org/docs/add-to-your-site/#authentication" rel="noopener ugc nofollow" target="_blank"> Netlify的步骤</a>。你可以用各种不同的方法进行认证，或者通过你已经设置好的Netlify的身份服务来处理这个过程。</p><p id="eae8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您添加以下设置，则帖子将通过一个工作流流程，在您发布帖子之前，特定用户可以查看和编辑拉请求中的帖子。否则，NC向上面定义的分支提交帖子。</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="86f4" class="ld jr hu kz b fv le lf l lg lh">publish_mode:editorial_workflow</span></pre><figure class="ku kv kw kx fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff lj"><img src="../Images/6e84d24bbd9f199f9abc54b632693fd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hhy0E_EeNQjqlnUm.jpg"/></div></div></figure><p id="2320" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该网站使用了大量的图片，我希望人们在每篇文章中添加一张图片，所以你需要定义图片的存储位置，使用<code class="eh lr ls lt kz b">media_folder</code>参数添加图片，还需要使用<code class="eh lr ls lt kz b">public_folder</code>来设置图片的位置:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="db42" class="ld jr hu kz b fv le lf l lg lh">media_folder: "images" # Media files will be stored in the repo under images<br/>public_folder: "/images" # The src attribute for uploaded media will begin with /images</span></pre><p id="1089" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我确实发现了一些存储在子文件夹中的图像的问题，<a class="ae jp" href="https://github.com/netlify/netlify-cms/issues/513" rel="noopener ugc nofollow" target="_blank">有一个问题</a>讨论子文件夹，但是我不确定这是否相关。</p><figure class="ku kv kw kx fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff lj"><img src="../Images/6e348816e61445d43f6e75bc6279fe59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qwA4uJoDXfYe6WUi.jpg"/></div></div></figure><p id="5cc9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在到了最复杂的部分。我的网站有许多不同的“内容类型”来表示不同的内容项，有时使用集合，有时在不同的地方使用不同的字段。该部分将是您的配置部分，由一系列代表您的内容的YAML部分组成。一般结构是:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="8e39" class="ld jr hu kz b fv le lf l lg lh">collections:<br/>  - name: "posts" # Used in routes, e.g. /admin/collections/blog<br/>    label: "Posts" # Used in the UI<br/>    folder: "_posts" # The path to the folder where the documents are stored<br/>    create: true # Allow users to create new documents in this collection<br/>    slug: "{{year}}-{{month}}-{{day}}-{{slug}}" # Filename template i.e. YYYY-MM-DD-title.md<br/>    filter:<br/>      - field: publication_url<br/>      - value: ""<br/>    fields: # The fields for each document, usually in front matter<br/>      - {label: "Layout", name: "layout", widget: "hidden", default: "post"}<br/>      - {label: "Title", name: "title", widget: "string"}<br/>      - {label: "Publish Date", name: "date", widget: "datetime"}<br/>      - {label: "Featured Image", name: "image", widget: "image"}<br/>      - {label: "Categories", name: "categories", widget: "string"}<br/>      - {label: "Tags", name: "tags", widget: "string"}<br/>      - {label: "Body", name: "body", widget: "markdown"}<br/>      - {label: "Publication URL", name: "publication_url", widget: "string"}</span></pre><p id="a4c1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以使用大约<a class="ae jp" href="https://www.netlifycms.org/docs/widgets/" rel="noopener ugc nofollow" target="_blank"> 12个默认小部件</a>中的一个，如果您知道React，那么<a class="ae jp" href="https://www.netlifycms.org/docs/custom-widgets/" rel="noopener ugc nofollow" target="_blank">创建您自己的</a>并不太难。默认情况下，字段被设置为<code class="eh lr ls lt kz b">required</code>，所以如果它们不在您的内容模型中，就添加<code class="eh lr ls lt kz b">required: false</code>，即:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="6150" class="ld jr hu kz b fv le lf l lg lh">- {label: "Publication URL", name: "publication_url", widget: "string", required: false}</span></pre><p id="2e83" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我的网站有很多内容，我无法让Netlify CMS加载所有内容——这可能是JavaScript调用或GitHub API的限制。可能有一种方法可以解决这个问题，但是由于很多帖子都是针对聚合内容自动生成的存根文件，所以我不需要编辑它们。Netlify CMS提供了一种使用字段值的<code class="eh lr ls lt kz b">filter</code>属性来过滤这些内容的方法。</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="5002" class="ld jr hu kz b fv le lf l lg lh">filter:<br/>  - field: language<br/>  - value: en</span></pre><p id="1c77" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我想通过日期过滤来加载最近的帖子，但这是不可能的，所以我试着过滤没有<code class="eh lr ls lt kz b">publication_url</code>的帖子，但没有多少运气让过滤器工作，你的里程可能会有所不同。从GitHub API中获取的内容也有限制，所以我可能需要将我的内容重新组织到更多的集合或子文件夹中。</p><p id="1f35" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以在这里看到我的网站<a class="ae jp" href="https://github.com/GregariousMammal/Main-Site/blob/master/admin/config.yml" rel="noopener ugc nofollow" target="_blank">的完整内容类型。</a></p><h1 id="50f0" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">使用Netlify CMS</h1><p id="9f9f" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">像往常一样启动你的静态站点发生器，然后访问<em class="kt"> _admin </em>。您应该会看到针对您定义的每种内容类型的部分，以及针对媒体和工作流(如果启用)的部分。</p><figure class="ku kv kw kx fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff lj"><img src="../Images/6a72d61234b08174aaa621e9c2329cd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-EjCnd4oR3aBGH1D.jpg"/></div></div></figure><p id="2d1a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该界面有有限的过滤和排序选项，但有一个搜索框。您可以使用<em class="kt">添加</em>按钮，用一个方便的GUI创建内容并预览。当您单击<em class="kt">保存</em>时，帖子将被保留在一个拉请求中，直到您发布它们，然后它们将被合并到母版中。<a class="ae jp" href="https://www.netlifycms.org/docs/configuration-options#publish-mode" rel="noopener ugc nofollow" target="_blank">这里有一个总结</a>什么样的GUI动作导致什么样的git动作。</p><figure class="ku kv kw kx fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff lj"><img src="../Images/42cb5fe5e17a92c861e4dc4c67cef449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZLFGKkRnIF-a0xrB.jpg"/></div></div></figure><figure class="ku kv kw kx fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff lj"><img src="../Images/33640430e2af7ad5331e03d9282f5843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TyGewPJahRNyUNuX.jpg"/></div></div></figure><h1 id="935f" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">SSCMS(静态网站CMS！)</h1><p id="2e64" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">在我看来，到目前为止，Netlify已经尽最大努力为静态网站创建了一个类似CMS的前端，以适应技术和非技术用户的工作流。现在还处于早期，还需要一些缺陷和特性，但是随着Netlify商业产品和社区驱动力的增强，我对它的发展抱有很大的希望。</p></div><div class="ab cl lu lv hc lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hn ho hp hq hr"><p id="116c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="kt">原载于</em><a class="ae jp" href="https://dzone.com/articles/adding-a-cms-to-your-static-site-with-netlify-cms" rel="noopener ugc nofollow" target="_blank"><em class="kt">dzone.com</em></a><em class="kt">。</em></p></div></div>    
</body>
</html>