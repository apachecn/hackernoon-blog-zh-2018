<html>
<head>
<title>Introducing react-graceful-image</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">介绍反应优雅的形象</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/introducing-react-graceful-image-f9125fcefb61?source=collection_archive---------19-----------------------#2018-01-21">https://medium.com/hackernoon/introducing-react-graceful-image-f9125fcefb61?source=collection_archive---------19-----------------------#2018-01-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="bdf4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一个图像组件，通过提供可选的延迟加载、可选的占位符和失败重试来优雅地处理图像错误。尤其适用于信号较差的应用场合，例如乘坐火车、公共汽车或汽车。</p><h1 id="c17c" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">视觉示例</h1><figure class="ko kp kq kr fq ks fe ff paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="fe ff kn"><img src="../Images/026148d71dafb8cebd099f4a8487f01b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3z6opjn3rWEEYKrtZJB2Hw.png"/></div></div><figcaption class="kz la fg fe ff lb lc bd b be z ek">Browser loading images in various states</figcaption></figure><ol class=""><li id="2fd6" class="ld le hu it b iu iv iy iz jc lf jg lg jk lh jo li lj lk ll dt translated">当图像由于信号不好而失败时的默认浏览器行为</li><li id="2269" class="ld le hu it b iu lm iy ln jc lo jg lp jk lq jo li lj lk ll dt translated">带有反应优雅的图像占位符</li><li id="6630" class="ld le hu it b iu lm iy ln jc lo jg lp jk lq jo li lj lk ll dt translated">禁用反应优雅图像的占位符</li><li id="bfdd" class="ld le hu it b iu lm iy ln jc lo jg lp jk lq jo li lj lk ll dt translated">使用react-graceful-image重试—如果映像加载失败，包将再次尝试加载映像</li></ol><p id="b533" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="lr">(注意:这些并不相互排斥，例如，默认行为同时使用占位符和重试。)</em></p><h1 id="df72" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">履行</h1><p id="cfcb" class="pw-post-body-paragraph ir is hu it b iu ls iw ix iy lt ja jb jc lu je jf jg lv ji jj jk lw jm jn jo hn dt translated"><strong class="it hv">占位符</strong></p><ul class=""><li id="75f8" class="ld le hu it b iu iv iy iz jc lf jg lg jk lh jo lx lj lk ll dt translated">实现为嵌入到数据URI中的SVG这意味着您不必为了下载占位符而触发额外的HTTP请求，占位符就嵌入到组件中</li><li id="54be" class="ld le hu it b iu lm iy ln jc lo jg lp jk lq jo lx lj lk ll dt translated">该组件还提供了一种定制占位符的方法，即通过<code class="eh ly lz ma mb b">placeholderColor</code>属性改变占位符的颜色，以及通过常规的<code class="eh ly lz ma mb b">styles</code>或<code class="eh ly lz ma mb b">className</code>属性<em class="lr">(注意，通过这种方式传递的样式也会传递到实际的图像中。)</em></li><li id="0a6d" class="ld le hu it b iu lm iy ln jc lo jg lp jk lq jo lx lj lk ll dt translated">它还为您提供了禁用占位符的选项，在这种情况下，图像在加载之前根本不会呈现，因为图像在成功加载之前不会呈现，这也意味着如果图像失败，它将不会占用页面上的预期空间，您也不会得到一个损坏的图像图标</li></ul><p id="0850" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">重试</strong></p><ul class=""><li id="41a6" class="ld le hu it b iu iv iy iz jc lf jg lg jk lh jo lx lj lk ll dt translated">使用<code class="eh ly lz ma mb b">setTimeout</code>实现，它会调整延迟和所需的重试次数，以尝试优雅地重新加载映像</li><li id="6cb0" class="ld le hu it b iu lm iy ln jc lo jg lp jk lq jo lx lj lk ll dt translated">默认情况下，每次重试之间的延迟会加倍，但是可以通过<code class="eh ly lz ma mb b">retry.accumulate</code>属性进行修改，该属性接受以下值之一“乘”、“加”、“不加”，并相应地更新重试算法<em class="lr">(注意，您也可以更改延迟时间和重试次数)</em></li></ul><h1 id="fa1b" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">用法示例</h1><p id="cf1e" class="pw-post-body-paragraph ir is hu it b iu ls iw ix iy lt ja jb jc lu je jf jg lv ji jj jk lw jm jn jo hn dt translated">下面的代码片段将显示一个蓝色的SVG占位符，如果它在可视视窗中，那么它将加载实际的给定图像，并在加载完成后淡入。如果加载映像失败，它将再次尝试加载映像，最多8次，初始延迟为2秒，然后增加到4秒，8秒，16秒，依此类推(默认重试配置)。它还会将“content-image”类名中定义的任何样式应用到占位符<em class="lr">(以及图像加载后的图像)</em>。</p><pre class="ko kp kq kr fq mc mb md me aw mf dt"><span id="7914" class="mg jq hu mb b fv mh mi l mj mk">import React, { Component } from 'react'<br/>import Image from 'react-graceful-image'</span><span id="2da7" class="mg jq hu mb b fv ml mi l mj mk">class YourComponent extends Component {<br/>  render() {<br/>    return (<br/>      &lt;Image<br/>        src="path_to_image"<br/>        className="content-image"<br/>        alt="My awesome image"<br/>        placeholderColor="#0083FE"<br/>      /&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="e6e3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面的代码片段将显示一个浅灰色(默认)的SVG占位符，如果它在可视视窗中，那么它将加载实际的给定图像，并在加载完成后淡入。如果加载映像失败，它将再次尝试加载映像，最多15次，初始延迟为3秒，然后增加到6秒，然后增加到9秒，然后增加到12秒，依此类推。它会将20px的填充应用到占位符<em class="lr">(以及图像加载后的图像)。</em></p><pre class="ko kp kq kr fq mc mb md me aw mf dt"><span id="7ce1" class="mg jq hu mb b fv mh mi l mj mk">import React, { Component } from 'react'<br/>import Image from 'react-graceful-image'</span><span id="0c26" class="mg jq hu mb b fv ml mi l mj mk">class YourComponent extends Component {<br/>  render() {<br/>    return (<br/>      &lt;Image<br/>        src="path_to_image"<br/>        width="150"<br/>        height="150"<br/>        style={{padding: '20px'}}<br/>        alt="My awesome image"<br/>        retry={{count: 15, delay: 3, accumulate: 'add'}}<br/>      /&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="ea38" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">感谢阅读，更多使用细节请查看github项目页面:<a class="ae mm" href="https://github.com/linasmnew/react-graceful-image" rel="noopener ugc nofollow" target="_blank">https://github.com/linasmnew/react-graceful-image</a>。您也可以使用:<code class="eh ly lz ma mb b">npm install --save react-graceful-image</code>通过npm安装它</p></div></div>    
</body>
</html>