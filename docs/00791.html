<html>
<head>
<title>Ranking NFL Teams Using Maximum Likelihood Estimation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用最大似然估计对NFL球队进行排名</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/ranking-nfl-teams-using-maximum-likelihood-estimation-7a4ed8994a67?source=collection_archive---------12-----------------------#2018-01-25">https://medium.com/hackernoon/ranking-nfl-teams-using-maximum-likelihood-estimation-7a4ed8994a67?source=collection_archive---------12-----------------------#2018-01-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/626153565c463ecaba088d072ea082e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uXgNRhORVgVD1m-0w_Z3JA.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">I almost like these better.</figcaption></figure><p id="eeb9" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">2017 <a class="ae ke" href="https://hackernoon.com/tagged/nfl" rel="noopener ugc nofollow" target="_blank"> NFL </a>赛季按输赢记录排名前四的球队是:</p><ol class=""><li id="690b" class="kf kg hu ji b jj jk jn jo jr kh jv ki jz kj kd kk kl km kn dt translated"><strong class="ji hv">新英格兰爱国者</strong>，13–3</li><li id="bab5" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hv">匹兹堡钢人</strong>，13-3</li><li id="d895" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">费城老鹰队，13-3</li><li id="447f" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hv">明尼苏达维京人</strong>，13–3</li></ol><p id="ac53" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">那么哪个队是最好的呢？</p><p id="993b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">乍一看，这个问题听起来无法回答。如果输赢记录是对球队在整个赛季中表现的完整评估，那么所有这些球队都一样好，没有区别。</p><p id="0024" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">但是任何观看体育比赛的人都知道，这不是真的。即使不考虑老鹰队在第14周失去了他们的首发四分卫卡森·温兹，你仍然会看到大多数球迷将爱国者队和维京队置于老鹰队和钢人队之上。为什么？因为球队的比赛方式有明显的不同:他们的策略，他们的优势和劣势，以及他们在比赛中的关注点。</p><p id="2937" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">简而言之，每一次胜利都不是平等的。</p><p id="8c1c" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">所以，人们想出了排名系统。Ringer，FiveThirtyEight，那些以在<em class="kt">上大喊大叫为工作的笨蛋们都开发了一个系统，根据他们记录之外的数据对NFL球队进行评估和排名。</em></p><p id="ec2c" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这些质量不一。任何有半个大脑的人都可以想象，斯基普·贝勒斯的推理糟透了。在我看来，ESPN的系统非常好，我认为FiveThirtyEight位于ELO的系统非常有趣，并且给出了一贯合理的预测。</p><p id="d590" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">今天，我将忽略所有这些系统，基于完全不同的推理，建立我自己的系统。为什么？因为我可以。</p></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><p id="ac5a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">先说个例子。想象一个有三支球队的联赛:<strong class="ji hv"> X，Y，Z </strong>。假设这一系列的结果发生了:</p><ol class=""><li id="9157" class="kf kg hu ji b jj jk jn jo jr kh jv ki jz kj kd kk kl km kn dt translated"><strong class="ji hv"> X </strong>拍<strong class="ji hv"> Y </strong>。</li><li id="81ba" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hv"> Y </strong>击败<strong class="ji hv"> Z </strong>。</li><li id="ec33" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hv"> Z </strong>击败<strong class="ji hv"> X </strong>。</li><li id="b850" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hv"> Y </strong>打<strong class="ji hv"> X </strong>。</li></ol><p id="4744" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">然后，打了四场比赛，我们三个队的记录如下:</p><ul class=""><li id="5add" class="kf kg hu ji b jj jk jn jo jr kh jv ki jz kj kd lb kl km kn dt translated"><strong class="ji hv">X</strong>:1–2</li><li id="e585" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd lb kl km kn dt translated"><strong class="ji hv">Y</strong>:2–1</li><li id="2a89" class="kf kg hu ji b jj ko jn kp jr kq jv kr jz ks kd lb kl km kn dt translated"><strong class="ji hv">Z</strong>:1–1</li></ul><p id="c613" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">因此，我们的目标是给每个团队分配一个等级，<em class="kt"> R </em>，代表该团队的真正实力。</p><p id="63f1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">首先，让我们对每个团队的评级施加一个约束:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff lc"><img src="../Images/61407d16dab1a1d4c32c3710d120ea2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*xWoLv0xAJlyHVM5nqsC48Q.png"/></div></figure><p id="8b69" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">也就是说，X队击败Y队的概率等于它在这两个队之间的总评分中所占的份额。然后，我们可以得出以下结论:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lh"><img src="../Images/16d67b3998e8aa5b20f6cf26f462e8b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4uPRjJ06d8AtIZpGeUJaKA.png"/></div></div></figure><p id="4ff3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">上面陈述了本赛季结果的总概率等于每场单独比赛结果概率的乘积。但是，我们知道这些游戏导致了给定的结果:我们自己观察到的！因此，最大化我们观察到的结果的概率的评级是每个团队的“真实”评级。</p><p id="0ce9" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">也就是说，我们希望找到每个<em class="kt"> R </em>的值，使得<em class="kt"> Pr(schedule) </em>最大化:团队评级的<strong class="ji hv"> <em class="kt">最大似然估计</em> </strong>。</p><p id="151b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">实际上找到这个需要一些数学知识，我们将在下一节中讨论，但是首先，让我们直观地思考这个优化问题。假设您有三个杠杆，每个杠杆代表一个团队的评级。我们从1开始所有三个杠杆，然后慢慢开始增加X的杠杆。你可以看到，X既在我们优化的分数的分子中，也在分数的分母中，所以增加它只会增加<em class="kt"> Pr(schedule) </em>一个点。然后我们跳到Y的杠杆，开始增加它，直到值再次开始下降。然后我们跳回X，或者向前移动到Z，等等，直到我们在三者之间找到最大化等式的完美平衡。</p></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><p id="8062" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">但是当然，现实没有杠杆，计算我们的最大值需要数学。我们本质上是要推导这个方程的梯度下降(最终，编程并运行它！)，这就从找梯度开始。</p><p id="99ab" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">同样，这是我们的等式:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lh"><img src="../Images/16d67b3998e8aa5b20f6cf26f462e8b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4uPRjJ06d8AtIZpGeUJaKA.png"/></div></div></figure><p id="1c28" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">你会注意到的第一件事是，这将是一个令人沮丧的求导表达式。我们有除法和乘法，这将导致一些痛苦的代数。但是，事实证明，我们对这个特定的方程没有任何特别的忠诚:我们可以优化一个等价的方程，这个方程更容易推导，但行为方式与这个方程相同(也就是说，具有与这个方程相同的极值)。</p><p id="e2ae" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我任意选择自然对数，因为它是一个单调递增的函数，保持了原始方程的全局极值，它将这个复杂的数学问题转化为更容易处理的加法和减法。然后:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/9296dc40ec7b89096ffdf028fbef7b4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-P2p1OemPEfJAHqH8EFq1g.png"/></div></div></figure><p id="23ff" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">对于某些代数，这变成了:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lj"><img src="../Images/87ad7591cd23d2c23cb1abe5e7469ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhDWoW2CrAHba8iKHFYGhA.png"/></div></div></figure><p id="0af3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">下一步是依次对每个<em class="kt"> R </em>求偏导数。我会给你这些方程。如果你愿意，可以验证我的数学！</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/60714284830563ae8de379d517b144af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*tHLRznAj3r4ACjWkkLextg.png"/></div></figure><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff ll"><img src="../Images/4cd8978451839986ff2c7e821f2dfe18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*vtDzMfuM0ev3iRZ7ECFF9A.png"/></div></figure><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff lm"><img src="../Images/802ca30a8739d6a6085d74b1af13d851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*Ul4QuDH6rJdu29VQJ1R2yQ.png"/></div></figure><p id="cba5" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，我们将每个导数设置为0(因为我们想找到函数不变的点，在这个函数中，这个点是最大值)，并将我们的方程转换为更好的形式:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff ln"><img src="../Images/90e5141d91782dcee5f1f7fc024c6ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*uoQqASGTuM_huelINfNsgw.png"/></div></figure><p id="962b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在我们只剩下一个由三个等式组成的系统，代表我们每个团队的评分。显而易见的下一步是求解这个系统，但是即使粗略地看一下，你也会发现找到一个代数解是非常困难的，如果不是不可能的话。矩阵方法在这里也不起作用，因为这是一个非线性系统，不能被改造成更好的形式。</p><p id="957c" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">所以让我们退一步，换个角度看这个问题。如果我们只是任意选择每个<em class="kt"> R </em>的值作为初始估计值会怎么样？例如，假设每个等级为1。</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff lo"><img src="../Images/4fff0c5316ac5ffab319c394a9254cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*XnCibESN8CvL7rJucF45xw.png"/></div></figure><p id="29f3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">然后让我们把这些值代入每个方程。这给了你:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff lp"><img src="../Images/8f4e85d3a0c6561b721d06097e574486.png" data-original-src="https://miro.medium.com/v2/resize:fit:246/format:webp/1*0N88zPlLtoRzIDlxYlDrTg.png"/></div></figure><p id="59c6" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这告诉我们什么？嗯，它告诉我们，在上述方程的一次<em class="kt">迭代</em>之后，我们发现这是最大<a class="ae ke" href="https://hackernoon.com/tagged/likelihood" rel="noopener ugc nofollow" target="_blank">可能性</a>的当前估计。虽然这不是一个特别好的估计，但它已经表达了我们之前讨论过的很多直观的想法。y对X和Z都赢了，所以评级最高。X打败了Y，但也输给了Y，而且输给了Z，一个被Y打败的队伍，所以在Y下面，而Z在X上面是因为它打败了X，输给了Y，X也输给了Y。</p><p id="bbc9" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，我们可以再次运行相同的过程，插入这些新的<em class="kt"> R </em>值，并找到更新的估计值。有整整一个世纪的学术文献，可以追溯到20世纪20年代，指出最终，这些值会收敛，你会找到你的最大似然估计。</p><p id="6cb4" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">恭喜你！你刚刚跑了梯度下降。现在，做同样的事情，但是对于32支球队和15 * 17 = 180场比赛的完整NFL赛季。</p></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><p id="df04" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我们上面的数学解决了一个残缺和缩短的NFL赛季，但它很容易扩展到整个赛季。这是我们最后的方程式:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff ln"><img src="../Images/90e5141d91782dcee5f1f7fc024c6ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*uoQqASGTuM_huelINfNsgw.png"/></div></figure><p id="31fc" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，如果你盯着这个看一会儿，你就能说服自己，上述方程的一般形式是:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff lq"><img src="../Images/a5013a31a5d5a0618d374d5582e56278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*Pg4d5hru7K3aZJhvssoj9A.png"/></div></figure><p id="d01e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">其中<em class="kt"> R_A </em>是团队<em class="kt"> A </em>的评分，<em class="kt"> W_A </em>是团队<em class="kt"> A </em>的总胜场数，<em class="kt">G _ω</em>是A对战团队<em class="kt">ω</em>的场次。</p></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><p id="8ab9" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">解决了上面的数学问题，我们终于可以编写代码来寻找一些真实数据的最大似然估计量了。我将用2017年NFL赛季作为我们的例子，我将从头开始写一切，因为再次，<em class="kt">我可以</em>。</p><p id="470f" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我们首先实现我们想要优化的通用评定公式:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="lr ls l"/></div></figure><p id="1890" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这里，<code class="eh lt lu lv lw b">current_weights</code>是长度为32的数组，在我们的第一次迭代中被初始化为1，其中<code class="eh lt lu lv lw b">current_weights[i]</code>是团队<em class="kt"> i的当前评估值，</em> <code class="eh lt lu lv lw b">games_matrix</code>是二维数组，使得<code class="eh lt lu lv lw b">games_matrx[i][j]</code>是团队<em class="kt"> i </em>与团队<em class="kt"> j </em>比赛的次数，<code class="eh lt lu lv lw b">wins_array</code>是一维数组，其中<code class="eh lt lu lv lw b">wins_array[i]</code>是团队<em class="kt"> i. </em>的获胜次数</p><p id="3670" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">然后，这和我们上面推导的方程完全一样。现在，为了迭代它，我们可以这样做:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="lr ls l"/></div></figure><p id="e9a3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这个函数相当简单:它从上面获取<code class="eh lt lu lv lw b">games_matrix</code>和<code class="eh lt lu lv lw b">wins_array</code>参数，初始化一个<code class="eh lt lu lv lw b">current_weights</code>数组，然后当迭代之间仍然有变化时，它沿着梯度曲线(也就是我们的<code class="eh lt lu lv lw b">optimization_function</code>)向局部最大值行进。</p><p id="e959" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，我们只需要样本数据！为了实现这一点，我使用了非常有用的<a class="ae ke" href="https://github.com/BurntSushi/nflgame" rel="noopener ugc nofollow" target="_blank"> nflgame模块</a>，它从<a class="ae ke" href="https://nfl.com" rel="noopener ugc nofollow" target="_blank">NFL.com</a>的GameCenter JSON feeds中提取数据。下面是代码:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="lr ls l"/></div></figure><p id="879b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在我们可以将它们连接在一起:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="lr ls l"/></div></figure></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><p id="5ce7" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">以下是我在2017年NFL赛季用上述代码运行得到的结果:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="lr ls l"/></div></figure><p id="feca" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我觉得很可靠。你可以在这里看到ESPN最终的常规赛实力排名。他们的前五名是新英格兰爱国者队、匹兹堡钢人队、明尼苏达维京人队、新奥尔良圣徒队和洛杉矶公羊队，这和我的很接近，特别是因为我们没有使用任何比赛结果以外的信息。(例如，我敢肯定卡森·温茨撕裂他的ACL与老鹰队跌出他们的前五名有很大关系)。</p></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><p id="4309" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">到目前为止，这种方法的核心问题是，它对每一次胜利都一视同仁，这是完全不正确的。老鹰队在分区赛中以15比10险胜猎鹰队，这应该和他们上周在分区赛中以38比7击败维京人队一样对待吗？显然，不应该。猎鹰队以微弱优势输掉了比赛，而维京队则被彻底摧毁。事实上，猎鹰队的排名似乎应该随着这两个结果而上升，因为他们以微弱优势输给了一支被高排名的维京人队。</p><p id="177d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">表达这一点的最简单的标准是胜率:胜方与败方之间的分数差。将这一点融入我们的方法的一个简单方法是，在计算每个团队的胜率时，对较大的胜率给予更多的权重，对较小的胜率给予较少的权重。</p><p id="e9c7" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">经过反复试验，我想出了这个公式:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/3d2cb47a734fb35cc9e6c8deea3b2e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:230/format:webp/1*XlX2q2QME6uAJ4MjyFeEvw.png"/></div></figure><p id="fdf4" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">其中<em class="kt"> D </em>为得分差，<em class="kt"> S </em>为总得分。这实质上说的是，每一场胜利都自动给予1/2，然后，我们加上一个与分数差成比例的因子。如果<em class="kt"> D </em>接近<em class="kt"> S </em>，意味着获胜的团队赢了很多，我们最终得到的数字接近1/2，这导致总的获胜权重接近1。然而，如果<em class="kt"> D </em>比<em class="kt">S</em>小得多，我们最终会得到一个接近1/2的win权重。</p><p id="246f" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">每一次胜利都将在这个范围内的某个地方结束，但是它的价值将与获胜者赢得的金额成比例。下面是它在代码中的样子:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="lr ls l"/></div></figure><p id="b0cf" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在这里，game是nflgame模块中的一个对象，它包含关于特定NFL游戏的数据。</p><p id="b13b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果你还记得，我们在<code class="eh lt lu lv lw b">generate_matrices</code>函数中计算了我们的胜利。这又是一个例子，但是调用了<code class="eh lt lu lv lw b">wins_update_formula</code>函数，而不是简单地为每次胜利加1:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="lr ls l"/></div></figure><p id="6172" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">当然，这是结果:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="lr ls l"/></div></figure><p id="a98b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">他们变了一点。我会给你一个完整的比较，但新奥尔良上升了一位，而卡罗莱纳下降了。明尼苏达仍然是我们常规赛的最爱，但是费城上升了一位，亚特兰大下降了一点。</p></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><p id="c444" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">你可以做更多的事情。想办法考虑主场优势，或者更精细的进攻/防守指标。找到一个更智能的公式来衡量胜利。在一个更大的数据集上运行这个，也许能找到有史以来最好的团队。比较一个球队的常规赛平均得分和季后赛得分(唯一有足够数据的球队可能是钢人队和爱国者队)。修复我的劣质代码，在更大的数据量上运行得更快。</p><p id="54b3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">但在此之前，我目前的方法有一个问题。我的统计知识更丰富的读者可能已经意识到，纳入胜率的自相关问题:更好的球队将更经常获胜，也更经常以更大的优势获胜，这将随着时间的推移抬高我们的评级。对此的解决方案是找到一种获胜更新公式，当较低评级的团队获胜时，该公式对胜利的约束进行更多的加权，而当较高评级的团队获胜时，该公式对胜利的约束进行更少的加权。我将引导我的沉闷的教授，并把它作为一个练习(提示:<a class="ae ke" href="https://www.youtube.com/watch?v=o2we_B6hDrY" rel="noopener ugc nofollow" target="_blank"> <em class="kt">使用自然日志，卢克！</em> </a>)。</p><p id="3bc1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这里是包含本文中使用的所有代码的存储库。另外，你可以在推特上找到我，地址是@AakashJapi，电子邮件地址是:<em class="kt"> aakashjapi，gmail dot com，</em>和脸书。请随时联系我，告诉我你的想法/想法/nfl迷因/爱国者垃圾言论，或者任何事情。</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="ly ls l"/></div></figure></div></div>    
</body>
</html>