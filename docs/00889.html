<html>
<head>
<title>How To Script An Automatic Token Airdrop for 40k subscribers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä¸º40kç”¨æˆ·ç¼–å†™è‡ªåŠ¨ä»¤ç‰Œç©ºæŠ•è„šæœ¬</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/how-to-script-an-automatic-token-airdrop-for-40k-subscribers-e40c8b1a02c6?source=collection_archive---------1-----------------------#2018-01-28">https://medium.com/hackernoon/how-to-script-an-automatic-token-airdrop-for-40k-subscribers-e40c8b1a02c6?source=collection_archive---------1-----------------------#2018-01-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/7ad94f05300968b77dc9c22d07b8c039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HBFViHlWjtWl-xQnByOeDg.jpeg"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">Photo by <a class="ae ih" href="https://unsplash.com/photos/DiTiYQx0mh4?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Dose Media</a> on <a class="ae ih" href="https://unsplash.com/search/photos/robot?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="11a4" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">æˆ‘å¾ˆé«˜å…´åœ°å®£å¸ƒï¼Œæˆ‘æœ€è¿‘åŠ å…¥äº†<a class="ae ih" href="http://polymath.network" rel="noopener ugc nofollow" target="_blank">åšå­¦è€…</a>å›¢é˜Ÿï¼Œæˆä¸ºä¸€åå¯é æ€§å·¥ç¨‹å¸ˆï¼Œè´Ÿè´£å¼€å‘åŸºäº<a class="ae ih" href="https://hackernoon.com/tagged/blockchain" rel="noopener ugc nofollow" target="_blank">åŒºå—é“¾</a>çš„è¯åˆ¸ä»£å¸çš„æ–°æ ‡å‡†ã€‚ğŸ†ğŸ†ğŸ†</p><p id="1328" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">åœ¨è¿™ç¯‡æ–‡ç« /æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä»‹ç»ç¼–å†™node.jsè„šæœ¬çš„è¿‡ç¨‹ï¼Œè¯¥è„šæœ¬æ‰§è¡Œè‡ªåŠ¨ä»¤ç‰Œåˆ†å‘/ç©ºæŠ•åˆ°ä»¥å¤ªåŠåœ°å€åˆ—è¡¨ã€‚æˆ‘å°†ä½¿ç”¨æˆ‘ä»¬ä¸ºPolymathä»¤ç‰Œåˆ†å‘è¿‡ç¨‹ç¼–å†™çš„ä»£ç â€”â€”è¿™æ˜¯ä¸€ä¸ªéå¸¸æ ‡å‡†çš„ERC20ä»¤ç‰Œâ€”â€”å¹¶æ£€æŸ¥æˆ‘æ„å»ºçš„ç”¨äºå¤„ç†ä»¤ç‰Œè‡ªåŠ¨åˆ†å‘çš„è„šæœ¬ã€‚</p><p id="ab85" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">æœ€åˆï¼Œæˆ‘è®¡åˆ’é€šè¿‡Infuraè¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œè¿™æ ·æˆ‘å°±ä¸å¿…åœ¨æœ¬åœ°è¿è¡Œä¸€ä¸ªå®Œæ•´çš„èŠ‚ç‚¹ã€‚è¿™éœ€è¦ç¦»çº¿ç­¾ç½²äº¤æ˜“ï¼Œæˆ‘æ˜¯é€šè¿‡ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„web3ä¸­å‡ ä¸ªæ–¹ä¾¿çš„åŠŸèƒ½æ¥å®Œæˆçš„ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå°½ç®¡è¿™åœ¨testrpcå’ŒRopstenä¸Šå¾ˆç®¡ç”¨ï¼Œä½†åœ¨Mainnetä¸Šå´æ˜¯ä¸€åœºç¾éš¾ã€‚äº¤æ˜“å¹¶æ²¡æœ‰å¢åŠ ï¼Œè¿™æ˜¯éå¸¸ç¼“æ…¢ï¼Œæ˜‚è´µå’Œä¸å¯é çš„ã€‚<br/>å¦‚æœä½ æ— è®ºå¦‚ä½•éƒ½æƒ³æ£€æŸ¥ä¸€ä¸‹ï¼Œ<a class="ae ih" href="https://github.com/PolymathNetwork/polymath-token-distribution/commit/5f1d15bdc9050366a94430956ec74ffda3c93bb8" rel="noopener ugc nofollow" target="_blank">ä½ å¯ä»¥å‚è€ƒè¿™ä¸ªæ—©æœŸæäº¤</a>ã€‚</p><h1 id="aa1d" class="kf kg ik bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">ä»¤ç‰Œå’Œä»¤ç‰Œåˆ†å‘åˆåŒ</h1><p id="778e" class="pw-post-body-paragraph jh ji ik jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">æˆ‘åœ¨Polymathçš„é¦–è¦ä»»åŠ¡ä¹‹ä¸€æ˜¯å¸®åŠ©å›¢é˜Ÿæ•²å®šä»¤ç‰Œå’Œä»¤ç‰Œåˆ†å‘æ™ºèƒ½åˆåŒï¼Œæˆ‘ä»¬å°†åœ¨æœªæ¥å‡ å¤©ä½¿ç”¨è¿™äº›åˆåŒæ¥å‘å¸ƒ<a class="ae ih" href="https://hackernoon.com/tagged/poly" rel="noopener ugc nofollow" target="_blank"> POLY </a>ä»¤ç‰Œï¼Œå¹¶å‘è®¢é˜…è¯¥å¹³å°çš„4ä¸‡äººè¿›è¡Œç©ºæŠ•ã€‚</p><p id="704a" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">æˆ‘ä¸æ‰“ç®—è¯¦ç»†ä»‹ç»è¿™äº›åˆåŒçš„ä»£ç ï¼Œä½†æ˜¯ä½ å¯ä»¥çœ‹çœ‹å®ƒä»¬ï¼Œå› ä¸ºå®ƒä»¬å·²ç»åœ¨<a class="ae ih" href="https://github.com/PolymathNetwork/polymath-token-distribution" rel="noopener ugc nofollow" target="_blank"> Polymathçš„Githubåº“</a>ä¸Šå…¬å¼€äº†ã€‚</p><p id="f2be" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">è¿™é‡Œæœ‰ä¸€äº›å…³äº<code class="eh li lj lk ll b"><strong class="jj il">PolyToken.sol</strong></code> <strong class="jj il"> </strong>å’Œ<code class="eh li lj lk ll b"><strong class="jj il">PolyDistribution.sol</strong></code>æ™ºèƒ½åˆçº¦çš„å€¼å¾—ä¸€æçš„äº‹æƒ…ï¼Œè¿™å°†æœ‰åŠ©äºç†è§£æœ¬æ•™ç¨‹çš„å…¶ä½™éƒ¨åˆ†:</p><ul class=""><li id="396c" class="lm ln ik jj b jk jl jo jp js lo jw lp ka lq ke lr ls lt lu dt translated"><code class="eh li lj lk ll b"><strong class="jj il">PolyToken.sol</strong></code>æ˜¯ä¿åˆ©ä»¤ç‰Œçš„åˆçº¦ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æ ‡å‡†çš„ERC20ä»¤ç‰ŒåˆåŒï¼Œä¾›åº”å›ºå®šã€‚</li><li id="eb62" class="lm ln ik jj b jk lv jo lw js lx jw ly ka lz ke lr ls lt lu dt translated"><code class="eh li lj lk ll b"><strong class="jj il">PolyDistribution.sol</strong></code>æ˜¯å¤„ç†ä»¤ç‰Œåˆå§‹åˆ†å‘çš„åˆåŒã€‚æˆ‘ä»¬å°†é¢„å”®æŠ•èµ„è€…ã€é¡¾é—®ã€åˆ›å§‹äººç­‰çš„ä»£å¸åˆ†é…åˆ†å¼€ã€‚å› ä¸ºç©ºæŠ•çš„è¿‡ç¨‹æ˜¯éå¸¸ä¸åŒçš„ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨1000ä¸‡ä¸ªä»£å¸(ä»å‘è¡Œçš„10äº¿ä¸ªä»£å¸ä¸­)è¿›è¡Œç©ºæŠ•ï¼Œå‘40ï¼Œ000äººåˆ†å‘250ä¸ªä»£å¸ã€‚æœ¬æ•™ç¨‹ä¸­æœ€é‡è¦çš„å‡½æ•°æ˜¯<code class="eh li lj lk ll b">airdropTokens()</code>ï¼Œè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹:</li></ul><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="c147" class="mi kg ik ll b fv mj mk l ml mm"><strong class="ll il">function airdropTokens(address[] _recipient) public onlyOwnerOrAdmin</strong> {<br/>    require(now &gt;= startTime);<br/>    uint airdropped;<br/>    for(uint i = 0; i&lt; _recipient.length; i++)<br/>    {<br/>        if (!airdrops[_recipient[i]]) {<br/>          airdrops[_recipient[i]] = true;<br/>          require(POLY.transfer(_recipient[i], 250 * decimalFactor));<br/>          airdropped = airdropped.add(250 * decimalFactor);<br/>        }<br/>    }<br/>    AVAILABLE_AIRDROP_SUPPLY = AVAILABLE_AIRDROP_SUPPLY.sub(airdropped);<br/>    AVAILABLE_TOTAL_SUPPLY = AVAILABLE_TOTAL_SUPPLY.sub(airdropped);<br/>    grandTotalClaimed = grandTotalClaimed.add(airdropped);<br/>  }</span></pre><p id="ac25" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh li lj lk ll b">airdropTokens()</code>åŸºæœ¬ä¸Šåšçš„æ˜¯åˆ†å‘(è°ƒç”¨ERC20çš„<code class="eh li lj lk ll b">transfer()</code>å‡½æ•°)250ä¸ªPOLYä»¤ç‰Œâ€”â€”å®ƒä»¬æ˜¯å¸¸è§„çš„ERC20ä»¤ç‰Œâ€”â€”åˆ°ä¸€ä¸ªåœ°å€æ•°ç»„ã€‚å¯¹äºæˆ‘ä»¬æ”¶åˆ°çš„æ¯ä¸ªåœ°å€ï¼Œåªè¦ä»–ä»¬è¿˜æ²¡æœ‰æ”¶åˆ°åˆ†é…ï¼Œæˆ‘ä»¬å°±è½¬ç§»250ä¸ªèšç»™ä»–ä»¬ã€‚è¯¥è¿‡ç¨‹å®Œæˆåï¼Œæˆ‘ä»¬æ›´æ–°å¯ç”¨çš„ä¾›åº”ï¼Œå¹¶è·Ÿè¸ªå·²ç»åˆ†å‘äº†å¤šå°‘ä»¤ç‰Œã€‚</p><p id="224d" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">åœ¨æœ¬æ•™ç¨‹<strong class="jj il">ä¸­ï¼Œæˆ‘ä»¬å°†åªå…³æ³¨ä¸ºç©ºæŠ•æ¥æ”¶è€…åˆ†å‘ä»¤ç‰Œ</strong>ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œè¿™äº›ä»£å¸çš„åˆ†é…å’Œè½¬è®©æ²¡æœ‰æˆæƒæœŸæˆ–æ‚¬å´–æœŸã€‚å…¶ä»–ç±»å‹çš„åˆ†é…åˆ™ä¸åŒï¼Œåœ¨è½¬è®©/å‡ºå”®ä¹‹å‰ï¼Œéœ€è¦æ»¡è¶³ä¸€äº›ç‰¹æ®Šæ¡ä»¶ã€‚</p><p id="a48d" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mn">å¦‚æœæ‚¨æœ‰å…´è¶£äº†è§£å…¶ä½™çš„åˆ†é…æ˜¯å¦‚ä½•å®Œæˆçš„ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹</em> <code class="eh li lj lk ll b"><strong class="jj il"><em class="mn">PolyDistribution.sol</em></strong></code> <strong class="jj il"> <em class="mn">ä¸­çš„</em> <code class="eh li lj lk ll b"><em class="mn">setAllocation()</em></code> <em class="mn">å’Œ</em> <code class="eh li lj lk ll b"><em class="mn"> transferTokens()</em></code> <em class="mn">å‡½æ•°ã€‚</em>T19ã€‘</strong></p><h1 id="60ae" class="kf kg ik bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">ä»¤ç‰Œåˆ†å‘äº‹ä»¶</h1><p id="d876" class="pw-post-body-paragraph jh ji ik jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">å½“ä»¤ç‰Œåˆ†å‘æ—¥æœŸåˆ°æ¥æ—¶ï¼Œæˆ‘ä»¬å›¢é˜Ÿéœ€è¦åšçš„æ˜¯å°†ä»¤ç‰Œåˆ†å‘åˆ°æ³¨å†Œç©ºæŠ•çš„æ¯ä¸ªå¸æˆ·ã€‚è¿™äº›æ•°æ®æ˜¯åœ¨è¿‡å»å‡ ä¸ªæœˆé‡Œä»comapnyçš„ç½‘ç«™ä¸Šæ”¶é›†çš„ï¼Œå…¶ä¸­åŒ…å«æ³¨å†Œç©ºæŠ•å¹¶åœ¨KYCéªŒè¯è¿‡ç¨‹ä¸­æˆåŠŸéªŒè¯çš„æ¯ä¸ªå¸æˆ·çš„åœ°å€ã€‚æˆ‘ä»¬ä¸ºç©ºæŠ•è¿‡ç¨‹æ”¶é›†çš„æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªåªæœ‰ä¸€åˆ—çš„CSVæ–‡ä»¶ä¸­:æ¯ä¸ªç”¨æˆ·çš„ä»¥å¤ªåŠåœ°å€ã€‚</p><p id="6829" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mn">æ³¨æ„ï¼Œè¯¥è„šæœ¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ä¿®æ”¹ï¼Œä¸ä»…åŒ…å«ç”¨æˆ·çš„åœ°å€ï¼Œè¿˜åŒ…å«åº”è¯¥ä¼ é€å¤šå°‘ä»¤ç‰Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºæˆ‘ä»¬å†³å®šç»™æ¯ä¸ªäºº250ä¸ªPOLYï¼Œè¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œæˆ‘ä»¬é€‰æ‹©åœ¨distribution smartåˆåŒä¸­ç¡¬ç¼–ç è¿™ä¸ªæ•°å­—ã€‚</em></p><p id="9621" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ä»ç†è®ºä¸Šè®²ï¼Œç©ºæŠ•éå¸¸ç®€å•ã€‚æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ä¸ºæˆ‘ä»¬æ”¶é›†çš„æ¯ä¸ªåœ°å€è°ƒç”¨ERC20ä»¤ç‰Œçš„<code class="eh li lj lk ll b">transfer()</code>å‡½æ•°ã€‚</p><p id="5583" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¦‚æœæˆ‘ä»¬åªæœ‰å°‘æ•°å‡ ä¸ªè®¢é˜…è€…ï¼Œå¯ä»¥é€šè¿‡æ‰‹åŠ¨æ‰§è¡Œ<code class="eh li lj lk ll b">transfer() </code>åŠŸèƒ½æ¥å®Œæˆä¸Šè¿°æ“ä½œï¼Œä½†å½“å®ƒå¯åŠ¨æ—¶ï¼Œå¯èƒ½ä¼šæœ‰æˆåƒä¸Šä¸‡çš„äººæƒ³è¦è·å¾—ä»–ä»¬çš„ä»¤ç‰Œï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å®Œæˆä¸Šè¿°æ“ä½œå°†éå¸¸è€—æ—¶ã€‚</p><h1 id="442e" class="kf kg ik bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">é€šè¿‡Node.jsè„šæœ¬è‡ªåŠ¨åŒ–ä»¤ç‰Œåˆ†å‘è¿‡ç¨‹ã€‚</h1><p id="1dd2" class="pw-post-body-paragraph jh ji ik jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">è§£é‡Šäº†ä»¤ç‰Œå’Œåˆ†å‘å¥‘çº¦çš„å·¥ä½œåŸç†åï¼Œè®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶JSä»£ç ã€‚ä¸ºäº†å®ç°ä»¤ç‰Œåˆ†å‘è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›äº‹æƒ…:</p><ol class=""><li id="8201" class="lm ln ik jj b jk jl jo jp js lo jw lp ka lq ke mo ls lt lu dt translated">æˆ‘ä»¬å¿…é¡»è¯»å–CSVæ–‡ä»¶ï¼Œå¹¶å¤„ç†å®ƒä»¥åˆ é™¤ç©ºç™½æˆ–æ— æ•ˆçš„æ¡ç›®ã€‚æˆ‘ä»¬å‡è®¾ä¸€äº›æ•°æ®å°†ä¼šä¸¢å¤±æˆ–è€…ä¸€äº›åœ°å€å¯èƒ½æ˜¯é”™è¯¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ç¡®ä¿åœ¨å°†å®ƒä»¬å‘é€åˆ°åŒºå—é“¾ä¹‹å‰å°†å®ƒä»¬åˆ é™¤ã€‚</li><li id="f0a4" class="lm ln ik jj b jk lv jo lw js lx jw ly ka lz ke mo ls lt lu dt translated">æˆ‘ä»¬å°†æŠŠåœ°å€æ‰“åŒ…åˆ°å¤šä¸ªæ•°ç»„ä¸­ï¼Œæ¯ä¸ªæ•°ç»„åŒ…å«80ä¸ªåœ°å€ã€‚ä¸ºä»€ä¹ˆæ˜¯80ï¼Ÿç»è¿‡å‡ æ¬¡æµ‹è¯•ï¼Œè€ƒè™‘åˆ°è¿é€ä»£å¸çš„æ²¹è´¹ï¼Œè¿™æ˜¯ä¸€ä¸ªç†æƒ³çš„æ•°å­—ã€‚æ ¹æ®æ‚¨è¯•å›¾å¯¹æ¯ä¸ªæ¡ç›®åšä»€ä¹ˆï¼Œæ¯ä¸ªäº‹åŠ¡å¯èƒ½ä¼šèŠ±è´¹æ›´å¤šæˆ–æ›´å°‘çš„gasï¼Œæ‚¨åº”è¯¥ç›¸åº”åœ°æ‰“åŒ…æ¡ç›®ï¼Œä»¥ä¾¿äº‹åŠ¡ä¸ä¼šè€—å°½gaså¹¶å›æ»šã€‚</li><li id="c695" class="lm ln ik jj b jk lv jo lw js lx jw ly ka lz ke mo ls lt lu dt translated">ä¸€æ—¦æˆ‘ä»¬æœ‰äº†æ•°ç»„é›†åˆï¼Œæˆ‘ä»¬å°†æŠŠå®ƒä»¬ä¼ é€’ç»™æ™ºèƒ½å¥‘çº¦ä¸Šçš„<code class="eh li lj lk ll b">airdropTokens()</code>å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†éå†æ•°ç»„å¹¶è°ƒç”¨æ¯ä¸ªè®¢æˆ·çš„<code class="eh li lj lk ll b">transfer()</code>æ–¹æ³•æ¥å‘é€ä»–ä»¬çš„ä»¤ç‰Œã€‚</li><li id="ac4f" class="lm ln ik jj b jk lv jo lw js lx jw ly ka lz ke mo ls lt lu dt translated">ä¹‹åï¼Œæˆ‘ä»¬å°†è¿è¡Œå¦ä¸€ä¸ªè¿›ç¨‹æ¥è·å–ç”±å‘è¡ŒåˆåŒç”Ÿæˆçš„æ‰€æœ‰<code class="eh li lj lk ll b">Transfer</code>äº‹ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ£€æŸ¥å‘è¡Œæ˜¯å¦é¡ºåˆ©ã€‚(æˆ‘ä»¬å°†å¯¹åˆ†å‘çš„ä»¤ç‰Œè¿›è¡Œæ±‚å’Œï¼Œè¿™åº”è¯¥ä¸æˆ‘ä»¬æ–‡ä»¶ä¸­çš„æ•°æ®ç›¸åŒ¹é…)ã€‚</li></ol><p id="8fbd" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj il">è®©æˆ‘ä»¬ä»è®¾ç½®é¡¹ç›®å¼€å§‹:</strong></p><p id="6036" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¦‚æœä½ æƒ³è·³è¿‡æ•´ä¸ªæ•™ç¨‹ï¼Œåªè¿è¡Œè„šæœ¬ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°<a class="ae ih" href="https://github.com/PolymathNetwork/polymath-token-distribution" rel="noopener ugc nofollow" target="_blank">å®Œæ•´çš„æºä»£ç </a>ã€‚</p><h2 id="1a1e" class="mi kg ik bd kh mp mq mr kl ms mt mu kp js mv mw kt jw mx my kx ka mz na lb nb dt translated">å»ºç«‹</h2><p id="3249" class="pw-post-body-paragraph jh ji ik jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥è®¾ç½®ä¸€ä¸ªå…¨æ–°çš„é¡¹ç›®å¹¶å®‰è£…æ‰€éœ€çš„ä¾èµ–é¡¹:</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="3fec" class="mi kg ik ll b fv mj mk l ml mm">$ mkdir distributionTutorial<br/>$ npm init<br/>$ truffle init<br/>$ npm install web3 fast-csv truffle-contract ethereumjs-testrpc  --save</span></pre><p id="a153" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€äº›åº“å’Œæ¡†æ¶:</p><ul class=""><li id="b6db" class="lm ln ik jj b jk jl jo jp js lo jw lp ka lq ke lr ls lt lu dt translated">Truffle: å®ƒå…è®¸æˆ‘ä»¬è½»æ¾åœ°ä»JavaScriptç¼–è¯‘ã€è¿ç§»å’Œäº¤äº’æˆ‘ä»¬çš„åˆåŒã€‚</li><li id="d207" class="lm ln ik jj b jk lv jo lw js lx jw ly ka lz ke lr ls lt lu dt translated"><strong class="jj il"> Fast-csv: </strong>è¯»å–å¹¶å¤„ç†csvæ–‡ä»¶ä¸­çš„æ•°æ®ã€‚</li></ul><p id="d111" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">æ‚¨è¿˜åº”è¯¥å®‰è£…å¥‡å¶æ ¡éªŒï¼Œå¹¶åœ¨Ropsten(æˆ–æ‚¨å–œæ¬¢çš„ä»»ä½•testnet / mainnet)ä¸ŠåŒæ­¥å®ƒã€‚ä»¥ä¸‹å‘½ä»¤å¯¹æˆ‘æ¥è¯´éå¸¸æœ‰æ•ˆ:</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="84ff" class="mi kg ik ll b fv mj mk l ml mm">parity â€” chain ropsten â€” rpcapi â€œeth,net,web3,personal,parityâ€ â€” unlock &lt;THE ACCOUNT YOU WANT TO UNLOCK&gt; â€” password $HOME/password.file</span></pre><p id="8684" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">æ¥ä¸‹æ¥ï¼Œå°†Polymath Distributionæ™ºèƒ½åˆåŒå¤åˆ¶åˆ°é¡¹ç›®çš„<code class="eh li lj lk ll b">contracts</code>æ–‡ä»¶å¤¹ä¸­ã€‚è¿™äº›æ–‡ä»¶å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°:<a class="ae ih" href="https://github.com/PolymathNetwork/polymath-token-distribution/tree/master/contracts" rel="noopener ugc nofollow" target="_blank">https://github . com/polymath network/polymath-token-distribution/tree/master/contracts</a></p><p id="bbf7" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">æ‰“å¼€truffle.jså¹¶ç”¨ä»¥ä¸‹ä»£ç æ›¿æ¢å…¶å†…å®¹:</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="95bb" class="mi kg ik ll b fv mj mk l ml mm">module.exports = {<br/>  networks: {<br/>   development: {<br/>      host: 'localhost',<br/>      port: 8545,<br/>      network_id: '*', // Match any network id<br/>      gas: 3500000,<br/>    }, <br/>   ropsten: {<br/>      host: 'localhost',<br/>      port: 8545,<br/>      network_id: '3', // Match any network id<br/>      gas: 3500000,<br/>      gasPrice: 50000000000<br/>    },<br/>  },<br/>  solc: {<br/>    optimizer: {<br/>      enabled: true,<br/>      runs: 200,<br/>    },<br/>  },<br/>};</span></pre><p id="a312" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ä»¥ä¸Šå°†å…è®¸æˆ‘ä»¬è¿è¡Œ<code class="eh li lj lk ll b">truffle migrate --network ropsten</code>æ¥å°†åˆåŒéƒ¨ç½²åˆ°Ropsten testnetã€‚åœ¨èƒ½å¤Ÿå°†åˆåŒéƒ¨ç½²åˆ°Ropstenä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºtruffleåˆ›å»ºéƒ¨ç½²è„šæœ¬ã€‚ç”¨ä¸‹é¢çš„ä»£ç åœ¨<code class="eh li lj lk ll b">migrations</code>æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º<code class="eh li lj lk ll b">2_deploy_contracts.js</code>çš„æ–°æ–‡ä»¶:</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="88e0" class="mi kg ik ll b fv mj mk l ml mm">var PolyToken = artifacts.require('./PolyToken.sol');<br/>var PolyDistribution = artifacts.require('./PolyDistribution.sol');</span><span id="c316" class="mi kg ik ll b fv nc mk l ml mm">module.exports = async (deployer, network) =&gt; {<br/>  let _now = Date.now();<br/>  let _fromNow = 60 * 5 * 1000; // Start distribution in 1 hour<br/>  let _startTime = (_now + _fromNow) / 1000;<br/>  await deployer.deploy(PolyDistribution, _startTime);<br/>  console.log(`<br/>    ---------------------------------------------------------------<br/>    --------- POLYMATH (POLY) TOKEN SUCCESSFULLY DEPLOYED ---------<br/>    ---------------------------------------------------------------<br/>    - Contract address: ${PolyDistribution.address}<br/>    - Distribution starts in: ${_fromNow/1000/60} minutes<br/>    - Local Time: ${new Date(_now + _fromNow)}<br/>    ---------------------------------------------------------------<br/>  `);<br/>};</span></pre><p id="280e" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ä¸Šé¢çš„ä»£ç å°†åœ¨æ‚¨æ‰§è¡Œ<code class="eh li lj lk ll b">truffle migrate --network ropsten</code>æ—¶è¿è¡Œã€‚å®ƒå°†æŠŠPolyDistributionå¥‘çº¦éƒ¨ç½²åˆ°Ropsten(å®ƒè¿˜å¤„ç†POLY Tokenå¥‘çº¦çš„éƒ¨ç½²)ï¼Œå°†<code class="eh li lj lk ll b">_startTime</code>è®¾ç½®ä¸ºäº”åˆ†é’Ÿã€‚ç¡®ä¿<code class="eh li lj lk ll b">_startTime</code>å˜é‡è®¾ç½®æ­£ç¡®ï¼Œå¹¶ä¸”ä¸€æ—¦åˆ°è¾¾<code class="eh li lj lk ll b">_startTime</code>å°±å°è¯•ç©ºæŠ•ï¼Œå¦åˆ™æ‰§è¡Œå°†å¤±è´¥ã€‚æˆ‘ä»¬ä½¿ç”¨<code class="eh li lj lk ll b">_startTime</code>æ¥é˜²æ­¢äººä»¬åœ¨ä»£å¸åˆ†å‘æ´»åŠ¨å¼€å§‹å‰æå–ä»£å¸ã€‚</p><p id="30fb" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ç»§ç»­è¿è¡Œ<code class="eh li lj lk ll b">truffle migrate --network ropsten</code>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨åº”è¯¥ä¼šåœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡º:</p><figure class="ma mb mc md fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nd"><img src="../Images/e74e225c3d442d7405788f85aca29a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*plignHhyVj0ZcEuAXiTTMw.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">The tx hashes and contract address will be different for you.</figcaption></figure><p id="05b8" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¦‚æœæ‚¨çœ‹ä¸åˆ°æ­¤è¾“å‡ºæˆ–å‡ºç°é”™è¯¯ï¼Œè¯·ç¡®ä¿æ‚¨æ­£åœ¨è¿è¡Œå¥‡å¶æ ¡éªŒï¼Œå¹¶ä¸”å®Œå…¨åŒæ­¥ã€‚æ­¤å¤–ï¼Œç¡®ä¿æ‚¨çš„å¸æˆ·ä¸­æœ‰è¶³å¤Ÿçš„ä¹™é†šç”¨äºéƒ¨ç½²Ropsten testnetä¸Šçš„åˆåŒã€‚</p><p id="20ad" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">è®°ä¸‹æˆ‘ä»¬åˆšåˆšéƒ¨ç½²çš„Polyåˆ†å¸ƒå¥‘çº¦çš„åœ°å€ï¼Œæˆ‘ä»¬ç¨åå°†ä½¿ç”¨å®ƒã€‚</p><h2 id="7106" class="mi kg ik bd kh mp mq mr kl ms mt mu kp js mv mw kt jw mx my kx ka mz na lb nb dt translated">è¯»å–CSVæ–‡ä»¶</h2><p id="4a5c" class="pw-post-body-paragraph jh ji ik jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">è®©æˆ‘ä»¬å¼€å§‹ç¼–å†™è„šæœ¬ï¼Œè¯¥è„šæœ¬å°†æŠŠPOLYä»¤ç‰Œè‡ªåŠ¨åˆ†é…ç»™æ³¨å†Œäº†airdropçš„åœ°å€ã€‚</p><p id="047b" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåä¸º<code class="eh li lj lk ll b">scripts</code>çš„æ–°æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º<code class="eh li lj lk ll b">csv_allocation.js</code>çš„æ–°æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶å°†åŒ…å«è¿è¡Œåˆ†é…è¿‡ç¨‹çš„æ‰€æœ‰ä»£ç ã€‚</p><p id="55ad" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">åœ¨æˆ‘ä»¬ç»§ç»­é˜…è¯»å’Œå¤„ç†CSVæ–‡ä»¶çš„ä»£ç ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å°†æ–‡ä»¶æ·»åŠ åˆ°é¡¹ç›®ä¸­ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåä¸º<code class="eh li lj lk ll b">airdrop.csv</code>çš„1åˆ—CSVæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªå°†æ¥æ”¶ä»¤ç‰Œçš„åœ°å€çš„æ¡ç›®ã€‚åˆ›å»ºè¯¥æ–‡ä»¶å¹¶å°†å…¶æ·»åŠ åˆ°<code class="eh li lj lk ll b">scripts/data</code>æ–‡ä»¶å¤¹ã€‚</p><figure class="ma mb mc md fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ne"><img src="../Images/5a3329ee93782028611fa8b7aaf7fec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GWGkekiOohJxe67G60RMLQ.png"/></div></div></figure><p id="3c1b" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¦‚æœä½ æƒ³è½»æ¾åœ°æµ‹è¯•airdropï¼Œä½ å¯ä»¥ç”¨ä½ æ§åˆ¶çš„â€œéšæœºâ€åœ°å€è‡ªå·±ç”Ÿæˆè¿™ä¸ªæ–‡ä»¶ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯è¿è¡Œtestrpcå¹¶æŒ‡å®šæƒ³è¦åˆ›å»ºå¤šå°‘ä¸ªå¸æˆ·ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="fd59" class="mi kg ik ll b fv mj mk l ml mm">testrpc -m "word1 word2 word3..." -a 300</span></pre><p id="62c8" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ä¸Šé¢çš„å‘½ä»¤å°†æ ¹æ®æ‚¨æä¾›çš„åŠ©è®°ç¬¦ç”Ÿæˆ300ä¸ªå¸æˆ·ã€‚å°†åœ°å€å¤åˆ¶åˆ°<code class="eh li lj lk ll b">airdrop.csv</code>ã€‚</p><p id="52da" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å›åˆ°æˆ‘ä»¬çš„<code class="eh li lj lk ll b"> csv_allocation.js</code>è„šæœ¬ï¼Œè®©æˆ‘ä»¬æ·»åŠ å¿…è¦çš„ä»£ç ï¼Œä»¥ä¾¿èƒ½å¤Ÿè¯»å–<code class="eh li lj lk ll b">airdrop.csv</code>ã€‚<code class="eh li lj lk ll b">csv_allocation.js</code>å¢åŠ å¦‚ä¸‹ä»£ç :</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="6a51" class="mi kg ik ll b fv mj mk l ml mm">var fs = require('fs');<br/>var csv = require('fast-csv');<br/>var BigNumber = require('bignumber.js');</span><span id="9872" class="mi kg ik ll b fv nc mk l ml mm">let polyDistributionAddress = process.argv.slice(2)[0];<br/>let BATCH_SIZE = process.argv.slice(2)[1];<br/>if(!BATCH_SIZE) BATCH_SIZE = 80;<br/>let distribData = new Array();<br/>let allocData = new Array();</span><span id="eba0" class="mi kg ik ll b fv nc mk l ml mm">function readFile() {<br/>  var stream = fs.createReadStream("scripts/data/airdrop.csv");</span><span id="db23" class="mi kg ik ll b fv nc mk l ml mm">let index = 0;<br/>let batch = 0;</span><span id="bd04" class="mi kg ik ll b fv nc mk l ml mm">console.log(`<br/>    --------------------------------------------<br/>    --------- Parsing distrib.csv file ---------<br/>    --------------------------------------------</span><span id="22cf" class="mi kg ik ll b fv nc mk l ml mm">******** Removing beneficiaries without address data<br/>  `);</span><span id="e7c7" class="mi kg ik ll b fv nc mk l ml mm">var csvStream = csv()<br/>      .on("data", function(data){<br/>          let isAddress = web3.utils.isAddress(data[0]);<br/>          if(isAddress &amp;&amp; data[0]!=null &amp;&amp; data[0]!='' ){<br/>            allocData.push(data[0]);</span><span id="c664" class="mi kg ik ll b fv nc mk l ml mm">index++;<br/>            if(index &gt;= BATCH_SIZE)<br/>            {<br/>              distribData.push(allocData);<br/>              allocData = [];<br/>              index = 0;<br/>            }</span><span id="061c" class="mi kg ik ll b fv nc mk l ml mm">}<br/>      })<br/>      .on("end", function(){<br/>           //Add last remainder batch<br/>           distribData.push(allocData);<br/>           allocData = [];<br/>           setAllocation();<br/>      });</span><span id="181f" class="mi kg ik ll b fv nc mk l ml mm">  stream.pipe(csvStream);<br/>}</span><span id="43b1" class="mi kg ik ll b fv nc mk l ml mm">if(polyDistributionAddress){<br/>  console.log("Processing airdrop. Batch size is",BATCH_SIZE, "accounts per transaction");<br/>  readFile();<br/>}else{<br/>  console.log("Please run the script by providing the address of the PolyDistribution contract");<br/>}</span></pre><p id="80a4" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">æ‚¨ç°åœ¨å¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹æ“ä½œæ¥è¿è¡Œè„šæœ¬:</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="076e" class="mi kg ik ll b fv mj mk l ml mm">$ node scripts/csv_allocation.js 0x0... 80<br/>// Where 0x0... is the address of the PolyDistribution contract we previously deployed to Ropsten.<br/>// 80 is the batch size we want to process. (How many accounts per array we want to process and send to the airdropTokens function) Can be omitted, defaults to 80.</span></pre><p id="b6e3" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj il">æŸ¥çœ‹ä»£ç :</strong></p><p id="ea36" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥å…è®¸æˆ‘ä»¬è¯»å–æ–‡ä»¶å’Œå¤„ç†CSVæ–‡ä»¶çš„åº“ã€‚</p><p id="17d2" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ç„¶åï¼Œå¦‚æœä½ çœ‹æœ€åå‡ è¡Œä»£ç ï¼Œä½ ä¼šçœ‹åˆ°æˆ‘ä»¬æ­£åœ¨è®¿é—®è¿è¡Œè„šæœ¬æ—¶ä¼ é€’çš„å‚æ•°ï¼Œå¦‚æœæœ‰èšäºŒç”²åŸºç¡…æ°§çƒ·å¥‘çº¦çš„åœ°å€ï¼Œæˆ‘ä»¬è°ƒç”¨<code class="eh li lj lk ll b">readFile()</code>å‡½æ•°ã€‚</p><p id="d878" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh li lj lk ll b">readFile()</code>å‡½æ•°çš„ä½œç”¨æ˜¯è®¿é—®<code class="eh li lj lk ll b">airdrop.csv</code>æ–‡ä»¶å¹¶é€è¡Œè¯»å–ã€‚åœ¨æ¯ä¸€è¡Œï¼Œæˆ‘ä»¬ç¡®ä¿è¯¥å€¼ä¸ä¸ºnullæˆ–ç©ºï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨web3çš„<code class="eh li lj lk ll b">isAddress()</code>å‡½æ•°æ¥éªŒè¯ä¼ é€’çš„åœ°å€æ˜¯å¦æœ‰æ•ˆã€‚å¦‚æœåœ°å€æ²¡é—®é¢˜ï¼Œæˆ‘ä»¬å°†å…¶æ·»åŠ åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œè¯¥æ•°ç»„ä¿å­˜äº†æˆ‘ä»¬å°†ç”¨æ¥æ„å»ºæ¯ä¸ªEthereumäº‹åŠ¡çš„å¤„ç†æ•°æ®ã€‚<br/>ä¸€æ—¦æ•°æ®è¢«å®Œå…¨å¤„ç†å®Œæ¯•ï¼Œæˆ‘ä»¬åˆ°è¾¾æ–‡ä»¶çš„æœ«å°¾ï¼Œæˆ‘ä»¬å°±è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è·å–80ä¸ªåœ°å€çš„æ•°ç»„å¹¶å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚</p><p id="cc46" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mn">è¯·æ³¨æ„ï¼Œè¯¥åŠŸèƒ½éå¸¸ç®€å•ï¼Œå¯ä»¥è¿›ä¸€æ­¥æ”¹è¿›ä»¥æ£€æµ‹è¶…è¿‡POLYä¾›åº”é‡çš„ä»¤ç‰Œé‡ã€é‡å¤åœ°å€ç­‰ã€‚æ‰€æœ‰è¿™äº›æƒ…å†µä»ç„¶åœ¨åˆåŒæ–¹é¢å¾—åˆ°å¤„ç†ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬èƒ½èŠ‚çœä¸€äº›å¯¹Ethereumçš„äº‹åŠ¡è°ƒç”¨ï¼Œé‚£å°±å¤ªå¥½äº†ã€‚</em></p><h2 id="7caa" class="mi kg ik bd kh mp mq mr kl ms mt mu kp js mv mw kt jw mx my kx ka mz na lb nb dt translated">å¤„ç†ä»¤ç‰Œåˆ†å‘</h2><p id="713c" class="pw-post-body-paragraph jh ji ik jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">ç°åœ¨æˆ‘ä»¬å·²ç»å°†æ•°æ®å¤„ç†æˆäº†ä¸€ä¸ªæ•°ç»„â€”â€”æˆ‘ä»¬åº”è¯¥æœ‰ä¸€ä¸ªåä¸º<code class="eh li lj lk ll b">distribData</code>çš„æ•°ç»„ï¼Œå®ƒåŒ…å«å‡ ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„æœ€å¤šæœ‰80ä¸ªåœ°å€â€”â€”æˆ‘ä»¬å°†ä¸ºæ¯ä¸ªæ•°ç»„è°ƒç”¨æ™ºèƒ½åˆåŒä¸­çš„<code class="eh li lj lk ll b">airdropTokens()</code>å‡½æ•°ã€‚</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="92cb" class="mi kg ik ll b fv mj mk l ml mm">const delay = ms =&gt; new Promise(resolve =&gt; setTimeout(resolve, ms));</span><span id="2efa" class="mi kg ik ll b fv nc mk l ml mm"><strong class="ll il">async function setAllocation() {</strong></span><span id="a990" class="mi kg ik ll b fv nc mk l ml mm">console.log(`<br/>    --------------------------------------------<br/>    ---------Performing allocations ------------<br/>    --------------------------------------------<br/>  `);</span><span id="839e" class="mi kg ik ll b fv nc mk l ml mm">let accounts = await web3.eth.getAccounts();</span><span id="6f4c" class="mi kg ik ll b fv nc mk l ml mm">let polyDistribution = await PolyDistribution.at(polyDistributionAddress);</span><span id="15fa" class="mi kg ik ll b fv nc mk l ml mm">  for(var i = 0;i&lt; distribData.length;i++){</span><span id="a7b4" class="mi kg ik ll b fv nc mk l ml mm">try{<br/>      let gPrice = 50000000000;<br/>      console.log("Attempting to allocate 250 POLYs to accounts:",distribData[i],"\n\n");<br/>      let r = await polyDistribution.airdropTokens(distribData[i],{from:accounts[0], gas:4500000, gasPrice:gPrice});<br/>      console.log("---------- ---------- ---------- ----------");<br/>      console.log("Allocation + transfer was successful.", r.receipt.gasUsed, "gas used. Spent:",r.receipt.gasUsed * gPrice,"wei");<br/>      console.log("---------- ---------- ---------- ----------\n\n")<br/>    } catch (err){<br/>      console.log("ERROR:",err);<br/>    }</span><span id="4824" class="mi kg ik ll b fv nc mk l ml mm"> }<br/>}</span></pre><p id="c7b8" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹è¿™ä¸ªå‡½æ•°ã€‚JSè„šæœ¬ä¸­çš„<code class="eh li lj lk ll b">setAllocation()</code>åªéœ€éå†å¡«å……äº†æ¥è‡ªcsvæ–‡ä»¶çš„å·²å¤„ç†æ•°æ®çš„<code class="eh li lj lk ll b">distribData</code>æ•°ç»„ï¼Œç„¶åå¯¹äºæ¯ä¸ªæ¡ç›®æ•°ç»„ï¼Œæˆ‘ä»¬ç»§ç»­å¯¹æ™ºèƒ½å¥‘çº¦æ‰§è¡Œ<code class="eh li lj lk ll b">airdropTokens()</code>ï¼Œä¼ é€’æ•°ç»„ã€‚</p><p id="74cb" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¯¹äºæˆ‘ä»¬å¤„ç†çš„æ¯ä¸€æ‰¹åœ°å€ï¼Œæˆ‘ä»¬æ£€ç´¢äº‹ä»¶æ—¥å¿—å¹¶æ‰“å°èŠ±è´¹äº†å¤šå°‘æ±½æ²¹ï¼Œä»¥ç¡®ä¿å¤„ç†æˆåŠŸã€‚</p><p id="96e0" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mn">æ¯æ‰¹åº”æ¶ˆè€—çš„æ°”ä½“é‡å¤§è‡´ç›¸åŒã€‚å¦‚æœæœ‰ä¸€ä¸ªæ‰¹æ¬¡çš„æ±½æ²¹æˆæœ¬æ›´ä½ï¼Œè¿™æ„å‘³ç€è¯¥æ‰¹æ¬¡ä¸­çš„ä¸€äº›åœ°å€æ²¡æœ‰è¢«è½¬ç§»ä»¤ç‰Œï¼Œå¯èƒ½æ˜¯å› ä¸ºå®ƒä»¬ä»¥å‰å·²ç»è¢«è½¬ç§»äº†ä»¤ç‰Œã€‚</em></p><h2 id="4f5d" class="mi kg ik bd kh mp mq mr kl ms mt mu kp js mv mw kt jw mx my kx ka mz na lb nb dt translated">ä»ERC20ä»¤ç‰Œè¯»å–è½¬ç§»äº‹ä»¶ä»¥éªŒè¯äº¤æ˜“</h2><p id="5ef7" class="pw-post-body-paragraph jh ji ik jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">æ”¶å·¥å‰æˆ‘ä»¬å¯ä»¥åšçš„æœ€åä¸€ä»¶äº‹æ˜¯è®¿é—®ERC20 POLY token Transfer()å‡½æ•°çš„äº‹ä»¶æ—¥å¿—ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å¿«é€Ÿæ£€æŸ¥æœ‰å¤šå°‘å¸æˆ·è·å¾—äº†ä»¤ç‰Œã€‚</p><p id="9886" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">åœ¨<code class="eh li lj lk ll b">setAllocation()</code>åŠŸèƒ½çš„æœ«å°¾å¢åŠ ä»¥ä¸‹å‡ è¡Œ:</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="f136" class="mi kg ik ll b fv mj mk l ml mm">console.log("Distribution script finished successfully.")<br/>  console.log("Waiting 2 minutes for transactions to be mined...")<br/>  await delay(90000);<br/>  console.log("Retrieving logs to inform total amount of tokens distributed so far. This may take a while...")</span><span id="dfbd" class="mi kg ik ll b fv nc mk l ml mm">let polytokenAddress = await polyDistribution.POLY({from:accounts[0]});<br/>  let polyToken = await PolyToken.at(polytokenAddress);</span><span id="b798" class="mi kg ik ll b fv nc mk l ml mm">var sumAccounts = 0;<br/>  var sumTokens = 0;</span><span id="c98f" class="mi kg ik ll b fv nc mk l ml mm">var events = await polyToken.Transfer({from: polyDistribution.address},{fromBlock: 0, toBlock: 'latest'});<br/>  events.get(function(error, log) {<br/>      event_data = log;<br/>      //console.log(log);<br/>      for (var i=0; i&lt;event_data.length;i++){<br/>          //let tokens = event_data[i].args.value.times(10 ** -18).toString(10);<br/>          //let addressB = event_data[i].args.to;<br/>          sumTokens += event_data[i].args.value.times(10 ** -18).toNumber();<br/>          sumAccounts +=1;<br/>          //console.log(`Distributed ${tokens} POLY to address ${addressB}`);</span><span id="6889" class="mi kg ik ll b fv nc mk l ml mm">}<br/>      console.log(`A total of ${sumTokens} POLY tokens have been distributed to ${sumAccounts} accounts so far.`);<br/>  });</span></pre><p id="4694" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ä¸Šé¢çš„ä»£ç æ·»åŠ äº†ä¸€ä¸ªè¶…æ—¶ï¼Œå› æ­¤æˆ‘ä»¬ç»™äº‹åŠ¡ä¸€äº›æ—¶é—´æ¥å®ŒæˆæŒ–æ˜ï¼Œç„¶åæˆ‘ä»¬å¾—åˆ°POLYä»¤ç‰Œçš„<code class="eh li lj lk ll b">Transfer()</code>äº‹ä»¶ï¼Œé€šè¿‡ä½œä¸ºPolyDistributionå¥‘çº¦çš„<code class="eh li lj lk ll b">from</code>å­—æ®µè¿‡æ»¤äº‹ä»¶ã€‚</p><p id="52c1" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ç„¶åï¼Œæˆ‘ä»¬å¯¹äº‹ä»¶è¿›è¡Œè®¡æ•°ï¼Œå¹¶è®¡ç®—åˆ†å‘äº†å¤šå°‘ä»¤ç‰Œã€‚æˆ‘ä»¬å¯ä»¥ç”¨è¿™äº›æ•°æ®ä¸åŸå§‹æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒã€‚æˆ‘ä»¬è¿˜å¯ä»¥åˆ—å‡ºæ¯ä¸ªè·å¾—ä»¤ç‰Œçš„åœ°å€ï¼Œæˆ–è€…æ·»åŠ ä¸€ä¸ªæ¯”è¾ƒCSVæ–‡ä»¶å’Œäº‹ä»¶æ—¥å¿—æ•°æ®çš„å‡½æ•°ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ›´æœ‰è¶£çš„è¯ã€‚</p><h2 id="6207" class="mi kg ik bd kh mp mq mr kl ms mt mu kp js mv mw kt jw mx my kx ka mz na lb nb dt translated">æ‰§è¡Œè„šæœ¬</h2><p id="6e34" class="pw-post-body-paragraph jh ji ik jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">å°±æ˜¯è¿™æ ·ï¼è®©æˆ‘ä»¬è¯•è¯•è¿™ä¸ªå‰§æœ¬ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤:</p><pre class="ma mb mc md fq me ll mf mg aw mh dt"><span id="4fe6" class="mi kg ik ll b fv mj mk l ml mm">$ node scripts/csv_allocation.js 0x0...<br/>// Replace 0x0... with the address of the PolyDistribution contract you deployed to Ropsten</span></pre><p id="8b52" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨åº”è¯¥ä¼šåœ¨æ§åˆ¶å°ä¸Šçœ‹åˆ°å¦‚ä¸‹å†…å®¹:</p><figure class="ma mb mc md fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff nf"><img src="../Images/2b11364281fdca2805754e9b015542cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uCN8WuCfz6nCWLVSmshdZw.png"/></div></div></figure><p id="b61f" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¦‚æœä½ å»<a class="ae ih" href="http://ropsten.etherscan.com" rel="noopener ugc nofollow" target="_blank">ä»¥å¤ªç½‘æ‰«æ</a>å¹¶è¾“å…¥ä½ éƒ¨ç½²çš„å¤šåˆ†é”€åˆåŒçš„åœ°å€ï¼Œä½ åº”è¯¥çœ‹åˆ°è¿™æ ·çš„å†…å®¹:</p><figure class="ma mb mc md fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ng"><img src="../Images/5c68c2916b61c5a5718304d6ef2ed557.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGTYjPzSLe-0x9wQGj2gSA.png"/></div></div></figure><p id="1927" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¦‚æœæ‚¨å¯ä»¥åœ¨CSVæ–‡ä»¶ä¸­çœ‹åˆ°æ¯ä¸ªå¸æˆ·çš„<code class="eh li lj lk ll b">Transfer()</code>äº‹ä»¶ï¼Œé‚£ä¹ˆæ­å–œæ‚¨ï¼<br/>æ‚¨å·²ç»æˆåŠŸå®Œæˆç©ºæŠ•ï¼</p></div><div class="ab cl nh ni hc nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="hn ho hp hq hr"><p id="3218" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">æ„Ÿè°¢ä½ é€šè¯»è¿™ç¯‡æ•™ç¨‹ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½åƒæˆ‘å†™è¿™ç¯‡æ•™ç¨‹ä¸€æ ·å–œæ¬¢é˜…è¯»å®ƒã€‚æ•¬è¯·å…³æ³¨æ›´å¤šä¸æˆ‘åœ¨åŒºå—é“¾æ„å»ºä¸‹ä¸€ä»£ä»¤ç‰ŒåŒ–è¯åˆ¸å¹³å°çš„å†’é™©ç»å†ç›¸å…³çš„æ–‡ç« ã€æ•™ç¨‹å’Œæ•…äº‹ï¼</p><p id="b6e2" class="pw-post-body-paragraph jh ji ik jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">å¦‚æœä½ æ­£åœ¨åšä½ è‡ªå·±çš„ç©ºæŠ•ï¼Œéœ€è¦å»ºè®®ï¼Œè¯·åœ¨ä¸‹é¢çš„è¯„è®ºåŒºè”ç³»æˆ‘ï¼Œæˆ–è€…å‘é‚®ä»¶ç»™æˆ‘ï¼Œæˆ‘ä¼šå°½æˆ‘æ‰€èƒ½å°½å¿«å›å¤ã€‚</p><figure class="ma mb mc md fq hw"><div class="bz el l di"><div class="no np l"/></div></figure></div></div>    
</body>
</html>