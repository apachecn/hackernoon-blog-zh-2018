<html>
<head>
<title>JS WTF 🦄 with Math</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JS WTF🦄用数学</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/js-wtf-with-math-79da9a941ec1?source=collection_archive---------4-----------------------#2018-01-29">https://medium.com/hackernoon/js-wtf-with-math-79da9a941ec1?source=collection_archive---------4-----------------------#2018-01-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="6c60" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">让我们用JavaScript <strong class="ak"> Math </strong>来驾驭古怪。</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/5dcba17c2142867765fa3c7dfdb4a29d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uuY_0i_Js0rdZ0elX0VUfg.png"/></div></div></figure><h1 id="5410" class="jv jw hu bd jx jy jz ka kb kc kd ke kf ja kg jb kh jd ki je kj jg kk jh kl km dt translated">最大()与最小()</h1><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="kn ko l"/></div></figure><p id="43a9" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">什么？<code class="eh ll lm ln lo b">max</code>不大于<code class="eh ll lm ln lo b">min</code>？<strong class="kr hv">否</strong>😱但这是有原因的。</p><p id="66de" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><a class="ae lp" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/max" rel="noopener ugc nofollow" target="_blank">根据定义</a> <code class="eh ll lm ln lo b">Math.max([value1[, value2[, ...]]])</code>返回给定数字中的最大值。然而，当没有提供参数时，它返回<strong class="kr hv">最小可能值</strong>，即<code class="eh ll lm ln lo b">-Infinity</code>。</p><p id="c6c5" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">正如您所猜测的，当没有提供参数时，<code class="eh ll lm ln lo b">Math.min()</code>返回<code class="eh ll lm ln lo b">Infinity</code>，即<strong class="kr hv">最大可能值</strong>。</p><p id="aa7d" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">所以，对比<code class="eh ll lm ln lo b">Math.max() &gt; Math.min()</code>的时候甚至不公平。</p><blockquote class="lq"><p id="cbfc" class="lr ls hu bd lt lu lv lw lx ly lz lk ek translated">这不公平。</p></blockquote><p id="d209" class="pw-post-body-paragraph kp kq hu kr b ks ma iv ku kv mb iy kx ky mc la lb lc md le lf lg me li lj lk hn dt translated"><code class="eh ll lm ln lo b">-Infinity</code>其道低于<code class="eh ll lm ln lo b">Infinity</code>。</p><h1 id="c068" class="jv jw hu bd jx jy jz ka kb kc kd ke kf ja kg jb kh jd ki je kj jg kk jh kl km dt">0.1 + 0.2</h1><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="kn ko l"/></div></figure><p id="4bb8" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">平心而论这不是JS的问题。这是<strong class="kr hv">浮点数学</strong>。</p><blockquote class="mf mg mh"><p id="a9d5" class="kp kq mi kr b ks kt iv ku kv kw iy kx mj kz la lb mk ld le lf ml lh li lj lk hn dt translated">计算机本身只能存储整数，所以它们需要某种方式来表示十进制数。这种表示带有一定程度的不准确性。这就是为什么，通常情况下，<code class="eh ll lm ln lo b">.1 + .2 != .3</code>——<a class="ae lp" href="http://0.30000000000000004.com/" rel="noopener ugc nofollow" target="_blank">0.300000000000004.com</a></p></blockquote><p id="5d6d" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">问题在于机器存储数值的方式(即<strong class="kr hv">二进制表示</strong>)。)在<strong class="kr hv">整数值</strong>的情况下，只有可以表示为数字乘以2的幂的整数才能被精确表示。</p><p id="43c0" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">至于<strong class="kr hv">有理数</strong>(比如<code class="eh ll lm ln lo b">0.1</code>，就是<code class="eh ll lm ln lo b">1/10</code>)只有分母可以表示为2的幂的值才能精确表示。</p><p id="73f6" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">虽然<code class="eh ll lm ln lo b">0.1</code>和<code class="eh ll lm ln lo b">0.2</code>可以在<code class="eh ll lm ln lo b">base 10</code>中精确表示，但对于<code class="eh ll lm ln lo b">base 2</code>来说却不是这样。当这种情况发生时，我们的机器会创建一个其真实值的近似值(这导致一个重复值)。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="kn ko l"/></div></figure><p id="6daf" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><strong class="kr hv">因此，</strong> <code class="eh ll lm ln lo b"><strong class="kr hv">0.1 + 0.2</strong></code> <strong class="kr hv">的结果将是一个重复值。</strong></p><p id="dc55" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">在<code class="eh ll lm ln lo b">base 10</code>中由<code class="eh ll lm ln lo b">0.30000000000000004</code>表示。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mm"><img src="../Images/c480466e3db8d237146c86ba7353b5ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*lIUAJ_Cu6PgTrL6MLj1uvA.gif"/></div></figure><h1 id="d416" class="jv jw hu bd jx jy jz ka kb kc kd ke kf ja kg jb kh jd ki je kj jg kk jh kl km dt">[] + {}</h1><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="kn ko l"/></div></figure><p id="57b0" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">在每个例子中,<code class="eh ll lm ln lo b">+</code>操作符有不同的行为。</p><p id="b118" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">对于表达式<code class="eh ll lm ln lo b">[] + {}</code>，它表现为<a class="ae lp" href="https://www.ecma-international.org/ecma-262/6.0/index.html#sec-addition-operator-plus" rel="noopener ugc nofollow" target="_blank"> <strong class="kr hv">加法运算符</strong> </a> <strong class="kr hv"> </strong>，对于表达式<code class="eh ll lm ln lo b">{} + []</code>，它表现为<a class="ae lp" href="https://www.ecma-international.org/ecma-262/6.0/index.html#sec-unary-plus-operator" rel="noopener ugc nofollow" target="_blank"> <strong class="kr hv">一元运算符</strong> </a>。</p><p id="ca91" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">当解释表达式<code class="eh ll lm ln lo b">[] + {}</code>时，JS识别一个加法运算，但是在将两个操作数相加之前，它将它们转换成<strong class="kr hv">原语</strong>。这是通过执行静态方法<code class="eh ll lm ln lo b">.toString()</code>来完成的。</p><p id="2b29" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">结果，我们以操作<code class="eh ll lm ln lo b">'' + '[object Object]'</code>结束。</p><p id="0cac" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">只有在这个阶段JS才知道加法运算符<code class="eh ll lm ln lo b">+</code>的目的是<strong class="kr hv">连接字符串</strong>。并且返回<code class="eh ll lm ln lo b">'[object Object]'</code>的最终值。</p><p id="bca3" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">下一个！</p><p id="c7b1" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">对于表达式<code class="eh ll lm ln lo b">{} + []</code>，第一个操作符是一对花括号(即<em class="mi">一个空块</em>)。)这个空块表示<strong class="kr hv">“没事做”</strong>。因此，JS在执行表达式时向前移动。</p><p id="7879" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">当到达<code class="eh ll lm ln lo b">+</code>操作符时，它表现为<strong class="kr hv">一元操作符</strong>，因为它没有左操作数。通过<a class="ae lp" href="https://www.safaribooksonline.com/library/view/you-dont-know/9781491905159/ch04.html" rel="noopener ugc nofollow" target="_blank">强制</a> <code class="eh ll lm ln lo b">[]</code>翻译成<code class="eh ll lm ln lo b">0</code>。</p><h1 id="782f" class="jv jw hu bd jx jy jz ka kb kc kd ke kf ja kg jb kh jd ki je kj jg kk jh kl km dt translated">真+真</h1><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="kn ko l"/></div></figure><p id="e256" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">这里，<code class="eh ll lm ln lo b">+</code> <strong class="kr hv"> </strong>操作符表现为<strong class="kr hv">附加操作符</strong>并将两个操作数相加。然而，在此之前，它需要转换它们<code class="eh ll lm ln lo b">ToNumber</code>。</p><p id="0771" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><a class="ae lp" href="https://www.ecma-international.org/ecma-262/6.0/index.html#sec-tonumber" rel="noopener ugc nofollow" target="_blank">根据定义</a>，如果参数为<strong class="kr hv">真</strong>，则<code class="eh ll lm ln lo b">ToNumber</code>返回<strong class="kr hv"> 1 </strong>，如果参数为<strong class="kr hv">假</strong>，则<strong class="kr hv"> 0 </strong>。</p><p id="2074" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">因为这个原因，我们的表达式<code class="eh ll lm ln lo b">true + true</code>翻译成<code class="eh ll lm ln lo b">1 + 1</code>，就是2。</p><h1 id="2d26" class="jv jw hu bd jx jy jz ka kb kc kd ke kf ja kg jb kh jd ki je kj jg kk jh kl km dt">1 &lt; 2 &lt; 3</h1><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="kn ko l"/></div></figure><p id="240a" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><strong class="kr hv"> <em class="mi">剧透预警:</em> </strong> <em class="mi">是</em><strong class="kr hv"><em class="mi"/></strong><a class="ae lp" href="https://www.safaribooksonline.com/library/view/you-dont-know/9781491905159/ch04.html" rel="noopener ugc nofollow" target="_blank"><strong class="kr hv"><em class="mi">威压</em> </strong> </a> <em class="mi">再来</em>😎</p><p id="6802" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">在这里，对这两个例子进行逐步讲解可能是有用的。</p><p id="a594" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><code class="eh ll lm ln lo b">1 &lt; 2 &lt; 3</code></p><ol class=""><li id="91df" class="mn mo hu kr b ks kt kv kw ky mp lc mq lg mr lk ms mt mu mv dt translated">因为JS从<strong class="kr hv">左到右</strong>解释和执行表达式，所以会先运行表达式<code class="eh ll lm ln lo b">1 &lt; 2</code>，因此<code class="eh ll lm ln lo b">true &lt; 3</code>；</li><li id="bdf2" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk ms mt mu mv dt translated">接下来，<strong class="kr hv">胁迫</strong>，<code class="eh ll lm ln lo b">ToNumber(true) &lt; 3</code>翻译过来就是【T41</li><li id="b601" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk ms mt mu mv dt translated">返回<code class="eh ll lm ln lo b">true</code>(因为<code class="eh ll lm ln lo b">1</code>比<code class="eh ll lm ln lo b">3</code>低)；</li></ol><p id="ed98" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><code class="eh ll lm ln lo b">3 &gt; 2 &gt; 1</code></p><ol class=""><li id="652f" class="mn mo hu kr b ks kt kv kw ky mp lc mq lg mr lk ms mt mu mv dt translated">因为<code class="eh ll lm ln lo b">3 &gt; 2</code>是<code class="eh ll lm ln lo b">true</code>那么<code class="eh ll lm ln lo b">true &gt; 1</code>；</li><li id="758c" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk ms mt mu mv dt translated"><code class="eh ll lm ln lo b">ToNumber(true) &gt; 1</code>翻译成<code class="eh ll lm ln lo b">1 &gt; 1</code> ( <strong class="kr hv">再强制</strong>👌);</li><li id="d680" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk ms mt mu mv dt translated">返回<code class="eh ll lm ln lo b">false</code>(因为<code class="eh ll lm ln lo b">1</code>不高于<code class="eh ll lm ln lo b">1</code>)；</li></ol><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mm"><img src="../Images/4d0bd3ddec5d640315e841b1836ccf7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*Cdv2JlqHAfbdRn5W90vT_Q.gif"/></div></figure><h1 id="3c29" class="jv jw hu bd jx jy jz ka kb kc kd ke kf ja kg jb kh jd ki je kj jg kk jh kl km dt translated"><strong class="ak">‘5’+3</strong></h1><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="kn ko l"/></div></figure><p id="8588" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><a class="ae lp" href="https://www.ecma-international.org/ecma-262/6.0/index.html#sec-addition-operator-plus" rel="noopener ugc nofollow" target="_blank">根据定义</a><strong class="kr hv"/><strong class="kr hv">加法运算符</strong>执行<strong class="kr hv">字符串串联</strong>或<strong class="kr hv">数字加法</strong>。</p><p id="d36b" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><strong class="kr hv">当其中一个操作数是字符串时，JS将另一个操作数转换为字符串，并返回两者的串联</strong>。在<code class="eh ll lm ln lo b">'5' + 3</code>的情况下，因为左操作数是一个字符串，所以最终结果是<code class="eh ll lm ln lo b">'5'</code>和<code class="eh ll lm ln lo b">ToString(3)</code>的串联，即<code class="eh ll lm ln lo b">'53'</code>。</p><p id="18dd" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><a class="ae lp" href="https://www.ecma-international.org/ecma-262/6.0/index.html#sec-subtraction-operator-minus" rel="noopener ugc nofollow" target="_blank"> <strong class="kr hv">减法运算符</strong> </a>对两个操作数执行<strong class="kr hv">减法</strong>。</p><p id="4e17" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated">然而，当操作符不是类型<code class="eh ll lm ln lo b">Number</code>时，它被转换为<code class="eh ll lm ln lo b">ToNumber</code>。由于这个原因，字符串<code class="eh ll lm ln lo b">'5'</code>被转换成减去<code class="eh ll lm ln lo b">3</code>的数字<code class="eh ll lm ln lo b">5</code>。最终结果是<code class="eh ll lm ln lo b">2</code>。</p><h1 id="3853" class="jv jw hu bd jx jy jz ka kb kc kd ke kf ja kg jb kh jd ki je kj jg kk jh kl km dt translated">&lt; your weirdness &gt;</h1><p id="e021" class="pw-post-body-paragraph kp kq hu kr b ks nb iv ku kv nc iy kx ky nd la lb lc ne le lf lg nf li lj lk hn dt translated"><em class="mi">如果你发现这里有什么奇怪的地方，请告诉我</em>👐</p><h1 id="5be0" class="jv jw hu bd jx jy jz ka kb kc kd ke kf ja kg jb kh jd ki je kj jg kk jh kl km dt translated">由于🍻</h1><ul class=""><li id="7ae9" class="mn mo hu kr b ks nb kv nc ky ng lc nh lg ni lk nj mt mu mv dt translated">Maggie Neterval为她的<a class="ae lp" href="https://www.youtube.com/watch?v=CRpKE04lkgo" rel="noopener ugc nofollow" target="_blank">演讲</a></li><li id="5c61" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk nj mt mu mv dt translated">震撼人心的<a class="ae lp" href="http://0.30000000000000004.com/" rel="noopener ugc nofollow" target="_blank">0.30000000000000004.com</a></li><li id="263e" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk nj mt mu mv dt translated"><a class="ae lp" href="https://twitter.com/Oracle" rel="noopener ugc nofollow" target="_blank">甲骨文</a>的— <a class="ae lp" href="http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html" rel="noopener ugc nofollow" target="_blank">每个计算机科学家都应该知道的浮点运算</a></li><li id="969e" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk nj mt mu mv dt translated"><a class="ae lp" href="https://twitter.com/getify" rel="noopener ugc nofollow" target="_blank">凯尔·辛普森</a>为他的<a class="ae lp" href="https://www.youtube.com/watch?v=2pL28CcEijU" rel="noopener ugc nofollow" target="_blank">视频</a>和<a class="ae lp" href="https://www.safaribooksonline.com/library/view/you-dont-know/9781491905159/" rel="noopener ugc nofollow" target="_blank">书</a></li><li id="80d5" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk nj mt mu mv dt translated"><a class="ae lp" href="https://developer.mozilla.org/en-US/docs/Web" rel="noopener ugc nofollow" target="_blank"> MDN文档</a></li><li id="06fb" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk nj mt mu mv dt translated"><a class="ae lp" href="https://twitter.com/prattprattpratt" rel="noopener ugc nofollow" target="_blank">克里斯·帕拉特</a>为<a class="ae lp" href="https://youtu.be/2LIQ2-PZBC8" rel="noopener ugc nofollow" target="_blank">银河护卫队</a>和gif</li><li id="ea55" class="mn mo hu kr b ks mw kv mx ky my lc mz lg na lk nj mt mu mv dt translated"><a class="ae lp" href="https://twitter.com/hackernoon" rel="noopener ugc nofollow" target="_blank">骇客正午</a>为出版❤️</li></ul></div><div class="ab cl nk nl hc nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="hn ho hp hq hr"><p id="12cd" class="pw-post-body-paragraph kp kq hu kr b ks kt iv ku kv kw iy kx ky kz la lb lc ld le lf lg lh li lj lk hn dt translated"><em class="mi">一定要看看我在JS WTF上的其他文章</em></p><div class="nr ns fm fo nt nu"><a href="https://hackernoon.com/oh-my-goodnejs-arrays-f9e9e4f03c97" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">JS WTF🦄使用数组</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">让我们利用一些带有JavaScript数组的WTF。</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">hackernoon.com</p></div></div><div class="od l"><div class="oe l of og oh od oi jt nu"/></div></div></a></div><div class="nr ns fm fo nt nu"><a href="https://hackernoon.com/js-wtf-with-number-5cd73514befb" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">JS WTF🦄带编号</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">是时候用数字来驾驭一些JavaScript WTF了。</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">hackernoon.com</p></div></div><div class="od l"><div class="oj l of og oh od oi jt nu"/></div></div></a></div></div></div>    
</body>
</html>