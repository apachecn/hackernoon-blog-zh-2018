<html>
<head>
<title>Stream &amp; Go: News Feeds for Over 500 Million End Users</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Stream &amp; Go:面向超过5亿最终用户的新闻源</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/stream-go-news-feeds-for-over-300-million-end-users-b227614cf32f?source=collection_archive---------13-----------------------#2018-01-29">https://medium.com/hackernoon/stream-go-news-feeds-for-over-300-million-end-users-b227614cf32f?source=collection_archive---------13-----------------------#2018-01-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/486a794999b4f367109ae4499c58ca12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*hlWxQRXVUz4GJysQCV4F9Q.png"/></div></figure><blockquote class="iy iz ja"><p id="93fb" class="jb jc jd je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">更新(2019年6月10日)</strong> : Stream现在为超过5亿的最终用户提供订阅和聊天服务！</p></blockquote><p id="d08c" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><a class="ae kd" href="https://getstream.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">流</strong> </a>是一个API，使开发者能够构建新闻提要和活动流(<a class="ae kd" href="https://getstream.io/try-the-api/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">试试API </strong> </a>)。超过500家公司使用我们的产品，为超过5亿最终用户提供信息。诸如Product Hunt、<a class="ae kd" href="https://stackshare.io/under-armour/connected-fitness" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">、安德玛</strong> </a>、Powerschool、<a class="ae kd" href="https://stackshare.io/bandsintown/bandsintown" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">bands town</strong></a>、<a class="ae kd" href="https://stackshare.io/dubsmash/dubsmash-scaling-to-200-million-users-with-3-engineers" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">dubssmash</strong></a>、Compass and Fabric(谷歌)等公司都依赖于Stream来为其新闻源提供动力。除了API，Stream的创始人还编写了最广泛使用的<a class="ae kd" href="https://github.com/tschellenbach/stream-framework" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">开源解决方案，用于构建可扩展的提要</strong> </a>。</p><p id="5dd5" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">以下是Stream今天的样子:</p><ul class=""><li id="869a" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz kj kk kl km dt translated">服务器数量:180</li><li id="a8b3" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">每月更新340亿次</li><li id="2fea" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">平均API响应时间:12毫秒</li><li id="009b" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">平均实时响应时间:2毫秒</li><li id="4b1f" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">地区:4个(美国东部、EU-西部、东京和新加坡)</li><li id="e760" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">每月1B API请求数(约20k/分钟)</li></ul><p id="f098" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">鉴于我们的大多数客户是工程师，我们经常谈论我们的堆栈。这是一个高层次的概述:</p><ol class=""><li id="dc06" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz ks kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/go" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Go </strong> </a>是我们主要的编程语言。</li><li id="85e1" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated">我们使用基于<a class="ae kd" href="https://stackshare.io/rocksdb" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">RocksDB</strong></a>+<a class="ae kd" href="https://raft.github.io/" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">Raft</strong></a>构建的定制解决方案作为我们的主数据库(我们从<a class="ae kd" href="https://stackshare.io/cassandra" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Cassandra </strong> </a>开始，但是希望对性能有更多的控制)。<a class="ae kd" href="https://stackshare.io/postgresql" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> PostgreSQL </strong> </a>存储配置、API密钥等。</li><li id="a88a" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/opentracing" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> OpenTracing </strong> </a>和<a class="ae kd" href="https://stackshare.io/jaeger" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">Jaeger</strong></a>handle tracing，<a class="ae kd" href="https://stackshare.io/statsd" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> StatsD </strong> </a>和<a class="ae kd" href="https://stackshare.io/grafana" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Grafana </strong> </a>提供详细的监控，我们使用<a class="ae kd" href="https://www.elastic.co/products" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">麋鹿</strong> </a>栈进行集中日志记录。</li><li id="c0cb" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/python" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Python </strong> </a>是我们机器学习的首选语言，devops和我们的网站<a class="ae kd" href="https://getstream.io/" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">https://getstream . io</strong></a>(<a class="ae kd" href="https://stackshare.io/django" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">Django</strong></a>，<a class="ae kd" href="https://stackshare.io/django-rest-framework" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">DRF</strong></a>&amp;<a class="ae kd" href="https://stackshare.io/react" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">React</strong></a>)。</li><li id="e103" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated">Stream结合使用了<strong class="je hv">写扇出</strong>和<strong class="je hv">读扇出</strong>。当用户打开他们的提要时，这会产生快速的读取性能，当著名用户发布更新时，也会产生快速的传播时间。</li></ol><p id="1e05" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><a class="ae kd" href="https://twitter.com/tommasobarbugli" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">托马索·巴尔古利</strong> </a>和我(<a class="ae kd" href="https://twitter.com/tschellenbach" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">@ tschellenbach</strong></a>)是近3年前开始流的开发者。我们在阿姆斯特丹成立了公司，参加了2015年纽约Techstars，并于2016年在科罗拉多州博尔德开设了办事处。在相当短的时间内，这是一次相当疯狂的旅程！超过15名开发人员和许多支持角色，包括销售和市场营销，与早期相比，这个团队感觉非常庞大。</p><h1 id="ec15" class="kt ku hu bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">挑战:新闻提要和活动流</h1><p id="bae2" class="pw-post-body-paragraph jb jc hu je b jf lr jh ji jj ls jl jm ka lt jp jq kb lu jt ju kc lv jx jy jz hn dt translated">关注关系的本质使得扩展提要变得很困难。你们大多数人都会记得脸书的长加载时间、Twitter的fail whale或者Tumblr的技术债务年。提要很难扩展，因为没有明确的方法来分割数据。关注关系将每个人和其他人联系起来。这使得在多台机器上分割数据变得困难。如果你想了解更多关于这个问题的信息，请查阅以下文件:</p><ul class=""><li id="bc7d" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz kj kk kl km dt translated"><a class="ae kd" href="http://highscalability.com/blog/2013/7/8/the-architecture-twitter-uses-to-deal-with-150m-active-users.html" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Twitter的技术回到拥有1.5亿活跃用户的日子</strong> </a></li><li id="7e99" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://engineering.linkedin.com/blog/2016/03/followfeed--linkedin-s-feed-made-faster-and-smarter" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> LinkedIn的排名提要</strong> </a></li><li id="41a1" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="http://jeffterrace.com/docs/feeding-frenzy-sigmod10-web.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">雅虎/普林斯顿研究论文</strong> </a></li></ul><p id="78c5" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">在很高的层面上，有3种不同的方式来扩展您的订阅源:</p><ol class=""><li id="5901" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz ks kk kl km dt translated">写入时扇出:基本上预先计算所有内容。这很昂贵，但是很容易将数据分片。</li><li id="290d" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated">扇出-读取:很难扩展，但更实惠和新的活动出现得更快。</li><li id="3f13" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated">以上两种方法的结合:更好的性能和减少的延迟，但增加了代码的复杂性。</li></ol><p id="3bd5" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">Stream结合使用写扇出和读扇出。这使我们能够有效地支持具有高度关联图形的客户，以及具有更稀疏数据集的客户。这很重要，因为我们的客户使用Stream的方式非常不同。看看这些来自<a class="ae kd" href="https://stackshare.io/bandsintown/bandsintown" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">bands town</strong></a>、Unsplash、<a class="ae kd" href="https://stackshare.io/product-hunt/product-hunt" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">产品搜索</strong> </a>的截图:</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff lw"><img src="../Images/35515884416164dea22240f79600bb30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0vgRcttdQVBKyzWfwNtSgg.png"/></div></div></figure><h1 id="541d" class="kt ku hu bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">从<a class="ae kd" href="https://stackshare.io/python" rel="noopener ugc nofollow" target="_blank"> Python </a>切换到<a class="ae kd" href="https://stackshare.io/go" rel="noopener ugc nofollow" target="_blank"> Go </a></h1><p id="b4a9" class="pw-post-body-paragraph jb jc hu je b jf lr jh ji jj ls jl jm ka lt jp jq kb lu jt ju kc lv jx jy jz hn dt translated">在多年优化我们现有的feed技术后，我们决定用2.0的Stream来实现更大的飞跃。虽然Stream的第一次迭代是由Python和Cassandra支持的，但对于我们基础设施的Stream 2.0，我们<a class="ae kd" href="https://getstream.io/blog/switched-python-go/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">切换到Go </strong> </a>。我们从Python切换到Go的主要原因是性能。使用Python很难加速Stream的某些特性，如聚合、排序和序列化。</p><p id="9778" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">我们从2017年3月开始使用Go，到目前为止这是一次很棒的体验。Go大大提高了我们开发团队的生产力。它不仅提高了我们的开发速度，对于Stream的许多组件来说，它也快了30倍。</p><p id="332c" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">围棋的表现以积极的方式极大地影响了我们的建筑。使用Python时，我们经常发现自己纯粹出于性能原因而将逻辑委托给数据库层。Go的高性能在架构方面给了我们更多的灵活性。这极大地简化了我们的基础架构，并显著改善了延迟。例如，我们看到web服务器数量减少了10比1，这是由于相同数量的请求使用了更少的内存和CPU。</p><p id="b600" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">最初，我们在Go的包管理方面有些困难。然而，使用<a class="ae kd" href="https://github.com/golang/dep" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Dep </strong> </a>连同<a class="ae kd" href="https://github.com/getstream/vg" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> VG包</strong> </a>有助于创建一个伟大的工作流。</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff mf"><img src="../Images/f19d45b63b42d9168c5bb83f69dda0a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*3YtBsG5iw6brMTHvPA4ztQ.png"/></div></div></figure><p id="5681" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">如果你从未尝试过围棋，你会想试试这个在线巡回赛:<a class="ae kd" href="https://tour.golang.org/welcome/1" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">https://tour.golang.org/welcome/1</strong></a></p><p id="9f50" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">作为一门语言，围棋非常注重性能。内置的<a class="ae kd" href="https://golang.org/pkg/net/http/pprof/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> PPROF </strong> </a>工具对于发现性能问题来说是惊人的。优步的<a class="ae kd" href="https://github.com/uber/go-torch" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Go-Torch </strong> </a>库非常适合可视化PPROF中的数据，并将在Go 1.10中捆绑在PPROF中。</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff mg"><img src="../Images/5acea430598c3cc7bbeba357028a2e19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uCWv4L8tYxlUsBjLPz2_Fw.png"/></div></div></figure><h1 id="904a" class="kt ku hu bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">从卡珊德拉切换到<a class="ae kd" href="https://stackshare.io/rocksdb" rel="noopener ugc nofollow" target="_blank">洛克sdb</a>T34】筏</h1><p id="cb29" class="pw-post-body-paragraph jb jc hu je b jf lr jh ji jj ls jl jm ka lt jp jq kb lu jt ju kc lv jx jy jz hn dt translated">1.0的流杠杆<a class="ae kd" href="https://stackshare.io/cassandra" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Cassandra </strong> </a>用于存储feed。Cassandra是构建提要的常见选择。例如，Instagram开始时使用<a class="ae kd" href="https://stackshare.io/redis" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Redis </strong> </a>，但最终<a class="ae kd" href="https://www.datastax.com/dev/blog/facebooks-instagram-making-the-switch-to-cassandra-from-redis-a-75-insta-savings" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">切换到Cassandra </strong> </a>以应对其快速的使用增长。Cassandra可以非常高效地处理繁重写入工作。</p><p id="7ece" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">Cassandra是一个很棒的工具，允许您通过添加更多节点来扩展写入容量，尽管它也非常复杂。这种复杂性使得很难诊断性能波动。尽管我们有多年运行Cassandra的经验，但感觉还是有点像黑箱。当构建Stream 2.0时，我们决定采用不同的方法，构建Keevo。Keevo是我们在RocksDB、gRPC和Raft基础上建立的内部键值商店。</p><p id="3910" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><a class="ae kd" href="https://stackshare.io/rocksdb" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> RocksDB </strong> </a>是由脸书的数据工程团队开发和维护的高性能嵌入式数据库库。RocksDB最初是Google的LevelDB的一个分支，它为SSD引入了几项性能改进。现在RocksDB是一个独立的项目，正在积极开发中。它是用C++写的，速度很快。看看这个<a class="ae kd" href="https://github.com/facebook/rocksdb/wiki/RocksDB-In-Memory-Workload-Performance-Benchmarks" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">基准如何处理700万QPS </strong> </a>。就技术而言，它比Cassandra简单得多。这意味着维护开销减少，性能提高，最重要的是，性能更加一致。有趣的是<a class="ae kd" href="https://stackshare.io/linkedin/linkedin" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> LinkedIn </strong> </a>也使用RocksDB为<a class="ae kd" href="https://engineering.linkedin.com/blog/2016/03/followfeed--linkedin-s-feed-made-faster-and-smarter" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">他们的feed </strong> </a>。</p><p id="8668" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">我们的基础架构托管在<a class="ae kd" href="https://stackshare.io/amazon-ec2" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> AWS </strong> </a>上，旨在承受整个可用性区域的中断。与Cassandra不同，Keevo clusters将节点组织成领导者和追随者。当领导者(主)节点变得不可用时，同一部署中的其他节点将开始选举并挑选新的领导者。选举新领导人是一项快速操作，几乎不会影响实时流量。</p><p id="79c8" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">为此，Keevo使用Hashicorp的Go实现<a class="ae kd" href="https://github.com/hashicorp/raft" rel="noopener ugc nofollow" target="_blank"><strong class="je hv"/></a>来实现Raft一致性算法。这确保了Keevo中存储的每一位都存储在3个不同的服务器上，并且操作始终一致。这个网站很好地展示了Raft是如何工作的:<a class="ae kd" href="https://raft.github.io/" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">https://raft.github.io/</strong></a></p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff mh"><img src="../Images/de2e6dfb0e162a4223e511e10fd78f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l3C6o4EqveWRd5KImjf5gA.png"/></div></div></figure><h1 id="71a1" class="kt ku hu bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">不完全是微服务</h1><p id="bb5d" class="pw-post-body-paragraph jb jc hu je b jf lr jh ji jj ls jl jm ka lt jp jq kb lu jt ju kc lv jx jy jz hn dt translated">通过利用Go和RocksDB，我们能够实现出色的提要性能。平均响应时间约为12毫秒。该架构介于整体架构和微服务之间。Stream在以下7种服务上运行:</p><ol class=""><li id="446e" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz ks kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/stream/stream-api" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">流API </strong> </a></li><li id="8b79" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/stream/keevo" rel="noopener ugc nofollow" target="_blank">T5】基沃T7】</a></li><li id="da70" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/stream/realtime" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">实时&amp;消防软管</strong> </a></li><li id="128b" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/stream/analytics" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">分析学</strong> </a></li><li id="54d4" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/stream/machine-learning-and-personalization" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">个性化&amp;机器学习</strong> </a></li><li id="59ae" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/stream/site-and-dashboard" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">现场&amp;仪表盘</strong> </a></li><li id="ecea" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz ks kk kl km dt translated">异步工作线程</li></ol><p id="0794" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">要查看我们划分为堆栈的所有服务，请越过<a class="ae kd" href="https://stackshare.io/stream/stacks" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">这里的</strong> </a>。</p><p id="9415" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><strong class="je hv">个性化&amp;机器学习</strong></p><p id="689f" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">几乎所有带有提要的大型应用都使用机器学习和个性化。例如，LinkedIn会对你订阅源中的条目进行优先排序。Instagram的explore feed显示你关注的人之外你可能感兴趣的照片。Etsy使用类似的方法来优化电子商务转换。Stream支持以下5种个性化用例:</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff mi"><img src="../Images/3712ab64a6646f6460476359214da3f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0XAcnQgsD_f-JNAoll-_4w.png"/></div></div></figure><p id="7561" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><a class="ae kd" href="https://getstream.io/docs_personalization/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">用于构建个性化订阅源的文档。</strong> </a></p><p id="05ed" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">所有这些个性化用例都依赖于将feeds与分析和机器学习相结合。对于机器学习方面，我们使用<a class="ae kd" href="https://stackshare.io/python" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Python </strong> </a>生成模型。对于我们的每个企业客户，模型都是不同的。通常我们会使用这些神奇的库之一:</p><ul class=""><li id="26fc" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz kj kk kl km dt translated"><a class="ae kd" href="https://github.com/lyst/lightfm" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">LightFM</strong></a>—<a class="ae kd" href="https://www.infoworld.com/article/3241852/machine-learning/how-to-implement-a-recommender-system.html" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">如何实现推荐系统</strong> </a></li><li id="e908" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://github.com/dmlc/xgboost" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> XGBoost </strong> </a></li><li id="a690" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/scikit-learn" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Scikit学</strong> </a></li><li id="8e0f" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/numpy" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">Numpy</strong></a><a class="ae kd" href="https://stackshare.io/pandas" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">熊猫</strong> </a>和Dask</li><li id="4dce" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/jupyter" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Jupyter笔记本</strong> </a>(用于开发)</li><li id="6f68" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://github.com/projectmesa/mesa" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">台面框架</strong> </a></li></ul><p id="9449" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><strong class="je hv">分析学</strong></p><p id="ec34" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">分析数据是通过一个基于Go的微型服务器收集的。在后台，它将生成go-routine来根据需要汇总数据。由此产生的指标存储在<a class="ae kd" href="https://stackshare.io/elasticsearch" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">弹性</strong> </a>中。以前我们看<a class="ae kd" href="https://stackshare.io/druid" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">德鲁伊</strong> </a>，看起来是一个很扎实的项目。现在，我们可以用一个更简单的解决方案。</p><p id="7dc8" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><strong class="je hv">仪表盘&amp;站点</strong></p><p id="0472" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">仪表盘由<a class="ae kd" href="https://stackshare.io/react" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> React </strong> </a>和<a class="ae kd" href="https://stackshare.io/reduxjs" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Redux </strong> </a>供电。我们还在所有示例应用程序中使用React和Redux:</p><ul class=""><li id="e78c" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz kj kk kl km dt translated"><a class="ae kd" href="http://cabin.getstream.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">小屋:用React &amp; Redux </strong> </a>建立社交网络的系列教程</li><li id="2f48" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="http://github.com/getstream/winds" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Winds:开源RSS &amp;播客app </strong> </a> (Winds 2.0很快就要出来了)</li></ul><p id="b004" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">该网站以及该网站的API由<a class="ae kd" href="https://stackshare.io/python" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Python </strong> </a>、<a class="ae kd" href="https://stackshare.io/django" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Django </strong> </a>和<a class="ae kd" href="http://www.django-rest-framework.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Django Rest框架</strong> </a>提供支持。Stream赞助了Django Rest框架，因为这是一个非常棒的开源项目。如果你需要快速构建一个API，没有比DRF和Python更好的工具了。</p><p id="79d5" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">我们使用<a class="ae kd" href="https://stackshare.io/imgix" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Imgix </strong> </a>来调整我们网站上图像的大小。对我们来说，Imgix具有成本效益，速度快，总的来说是一个很好的服务。<a class="ae kd" href="https://github.com/thumbor/thumbor" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Thumbor </strong> </a>是一个很好的开源替代品。</p><p id="9640" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><strong class="je hv">实时</strong></p><p id="5a6b" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">我们的实时基础设施基于Go、Redis和优秀的<a class="ae kd" href="https://github.com/gorilla/websocket" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">gorilla web socket</strong></a>库。它实现了Bayeux协议。就架构而言，它非常类似于基于节点的<a class="ae kd" href="https://stackshare.io/faye" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Faye </strong> </a>库。</p><p id="68a9" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">读黑客新闻上的“<a class="ae kd" href="https://news.ycombinator.com/item?id=15766011" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">抛弃去找Node.js </strong> </a>”帖子很有趣。作者从转到节点来提高性能。我们实际上反其道而行之，从节点转移到实时系统。新的基于Go的基础设施处理每个节点8倍的流量。</p><h1 id="c6f5" class="kt ku hu bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">开发、测试和多区域</h1><p id="b4d9" class="pw-post-body-paragraph jb jc hu je b jf lr jh ji jj ls jl jm ka lt jp jq kb lu jt ju kc lv jx jy jz hn dt translated">就devops而言，实例的调配和配置是完全自动化的，结合使用了:</p><ul class=""><li id="db66" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/aws-cloudformation" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">云形成</strong> </a></li><li id="ef8e" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">云初始化</li><li id="663e" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/puppet" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">傀儡</strong> </a></li><li id="1fa5" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">Boto &amp; <a class="ae kd" href="https://stackshare.io/fabric" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">面料</strong> </a></li></ul><p id="44ba" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">因为我们的基础设施是用代码定义的，所以推出新区域变得很简单。我们大量使用<a class="ae kd" href="https://stackshare.io/aws-cloudformation" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">云形成</strong> </a>。我们堆栈的每一个部分都在CloudFormation模板中定义。如果需要，我们可以在几分钟内生成一个新的专用碎片。此外，AWS参数存储用于保存应用程序设置。我们最大的部署在美国东部，但我们在东京、新加坡和都柏林也有分支机构。</p><p id="471c" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">Puppet和Cloud-init的组合用于配置我们的实例。我们直接在EC2实例上运行自包含的Go二进制文件，没有任何额外的容器层。</p><p id="9d58" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">发布我们服务的新版本是由<a class="ae kd" href="https://stackshare.io/travis-ci" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">特拉维斯</strong> </a>完成的。特拉维斯首先运行我们的测试套件。一旦通过，它就会发布一个新的二进制版本到<a class="ae kd" href="https://stackshare.io/github" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> GitHub </strong> </a>。一些常见的任务，比如为Go项目安装依赖项，或者构建二进制文件，都是使用普通的Makefiles自动完成的。(我们知道，疯狂的老派，对吧？)我们的二进制文件是用UPX压缩的。</p><p id="1d7f" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><strong class="je hv">工具高亮:</strong> <a class="ae kd" href="https://stackshare.io/travis-ci" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">特拉维斯</strong> </a></p><blockquote class="iy iz ja"><p id="f7af" class="jb jc jd je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">特拉维斯在过去的几年里取得了长足的进步。在某些情况下，我更喜欢<a class="ae kd" href="https://stackshare.io/jenkins" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">詹金斯</strong> </a>，因为这样更容易调试不完整的构建。随着名副其实的“debug build”按钮的加入，Travis现在是明显的赢家。它易于使用并且是免费开源的，不需要维护任何东西。</p></blockquote><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff mj"><img src="../Images/67ab864c6371cb6554d6ac37226e5d50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7BP-v2TyRosk8_LvWTEWQ.png"/></div></div></figure><p id="75f6" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">接下来，我们使用<a class="ae kd" href="https://stackshare.io/fabric" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Fabric </strong> </a>对我们的AWS实例进行滚动部署。如果在部署过程中出现任何问题，它将暂停部署。我们非常重视稳定性:</p><ul class=""><li id="df2d" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz kj kk kl km dt translated">需要高水平的测试覆盖率。</li><li id="b424" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">发布是由Travis创建的(不运行测试很难部署)。</li><li id="4b75" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">代码由至少2名团队成员评审。</li><li id="9375" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">我们广泛的QA集成测试套件评估所有7个组件是否仍然工作。</li></ul><p id="7e2a" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">我们已经写了我们用<a class="ae kd" href="https://getstream.io/blog/how-we-test-go-at-stream/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">测试Go代码库</strong> </a>的经验。当事情不顺利时，我们会尽最大努力对正在发生的问题保持透明:</p><ul class=""><li id="c6a3" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/statuspage-io" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">状态页面</strong> </a></li><li id="4013" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/twilio" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Twilio </strong> </a>全天候电话支持</li><li id="33b1" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/victorops" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">胜利</strong> </a>通知我们团队</li><li id="2f7c" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated">#救火频道上<a class="ae kd" href="https://stackshare.io/slack" rel="noopener ugc nofollow" target="_blank">的<strong class="je hv">松弛</strong>的</a></li><li id="eebf" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/intercom" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">对讲</strong> </a>为客户支持</li></ul><p id="6c88" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">VictorOps是我们支持团队的新成员。这使得在当前问题上的合作变得非常容易。</p><p id="24ab" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><strong class="je hv">工具高亮:</strong> <a class="ae kd" href="https://stackshare.io/victorops" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">胜利</strong> </a></p><blockquote class="iy iz ja"><p id="afd5" class="jb jc jd je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">关于<a class="ae kd" href="https://stackshare.io/victorops" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> VictorOps </strong> </a>最好的部分是他们如何使用时间表在团队成员之间进行协作。VictorOps是让我们的团队了解停机情况的一种很好的方式。它还与<a class="ae kd" href="https://stackshare.io/slack" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Slack </strong> </a>很好地集成在一起。这种设置使我们能够对生产中出现的任何问题做出快速反应，协同工作并更快地解决问题。</p></blockquote><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div class="fe ff mk"><img src="../Images/8915bfcf98e08501f11c46ba6c4d1737.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*JxfmNSyUsFHmKMZLZJmINQ.png"/></div></figure><p id="7fb4" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">我们的大部分基础设施都运行在AWS上:</p><ul class=""><li id="c4c5" class="ke kf hu je b jf jg jj jk ka kg kb kh kc ki jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/aws-elastic-load-balancing" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> ELB </strong> </a>进行负载均衡</li><li id="a2e6" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/amazon-rds-for-postgresql" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> RDS </strong> </a>用于可靠的Postgres托管</li><li id="79d3" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/amazon-elasticache" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">elastic cache</strong></a>用于Redis托管</li><li id="9d76" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/amazon-route-53" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Route53 </strong> </a>为我们的DNS</li><li id="56d8" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/amazon-cloudfront" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">云锋</strong> </a>为我们的CDN</li><li id="ba60" class="ke kf hu je b jf kn jj ko ka kp kb kq kc kr jz kj kk kl km dt translated"><a class="ae kd" href="https://stackshare.io/amazon-elasticsearch-service" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">AWS elastic search</strong></a>为麋鹿而描摹用<a class="ae kd" href="https://stackshare.io/jaeger" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Jaeger </strong> </a></li></ul><p id="f970" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">devops的职责由我们的团队共同承担。虽然我们有一个专门的devops工程师，但我们所有的开发人员都必须了解并拥有整个工作流程。</p><p id="26e1" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><strong class="je hv">监控</strong></p><p id="701e" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">Stream使用<a class="ae kd" href="https://stackshare.io/opentracing" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> OpenTracing </strong> </a>进行追踪，使用<a class="ae kd" href="https://stackshare.io/grafana" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Grafana </strong> </a>进行漂亮的仪表盘。使用<a class="ae kd" href="https://stackshare.io/statsd" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> StatsD </strong> </a>完成对Grafana的跟踪。最终的结果是这样的美:</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff lw"><img src="../Images/7c646e7286e3de698805f92c2721d5a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FLDN9Kgu-A7EwtFMQlckkg.png"/></div></div></figure><p id="1342" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">我们在<a class="ae kd" href="https://stackshare.io/sentry" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Sentry </strong> </a>中跟踪我们的错误，并使用ELK堆栈来集中我们的日志。</p><p id="3282" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated"><strong class="je hv">工具高亮:</strong><a class="ae kd" href="https://stackshare.io/opentracing" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">OpenTracing</strong></a><strong class="je hv">+</strong><a class="ae kd" href="https://stackshare.io/jaegar" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">Jaegar</strong></a></p><blockquote class="iy iz ja"><p id="78c7" class="jb jc jd je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">栈中的一个新成员是<a class="ae kd" href="https://stackshare.io/opentracing" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> OpenTracing </strong> </a>。过去我们使用<a class="ae kd" href="https://stackshare.io/new-relic" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> New Relic </strong> </a>，它对Python来说就像一个魔咒，但是不能自动测量Go的跟踪信息。用<a class="ae kd" href="https://stackshare.io/jaeger" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Jaeger </strong> </a>进行OpenTracing是一个很棒的解决方案，非常适合Stream。它也可能是追踪解决方案的最佳标志:</p></blockquote><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div class="fe ff ml"><img src="../Images/44809a1dfd24c117af22dbef4c05c207.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*EKEsybT_RuPyfpm3CYA8lw.png"/></div></figure><h1 id="c2ce" class="kt ku hu bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">结束语</h1><p id="96ef" class="pw-post-body-paragraph jb jc hu je b jf lr jh ji jj ls jl jm ka lt jp jq kb lu jt ju kc lv jx jy jz hn dt translated"><a class="ae kd" href="https://stackshare.io/go" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Go </strong> </a>是一门绝对令人惊叹的语言，并且在性能和开发人员生产力方面取得了重大胜利。对于追踪，我们使用OpenTracing和Jaeger。我们的监控运行在StatsD和Graphite上。集中式日志记录由ELK堆栈处理。</p><p id="54bd" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">Stream的主数据库是建立在<a class="ae kd" href="https://stackshare.io/rocksdb" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> RocksDB </strong> </a>和Raft之上的定制解决方案。过去我们使用Cassandra，我们发现它很难维护，而且与RocksDB相比，它不能给我们足够的性能控制。</p><p id="f646" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">我们利用外部工具和解决方案来解决非核心竞争力的一切问题。<a class="ae kd" href="https://stackshare.io/redis" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Redis </strong> </a>托管由ElastiCache处理，Postgres由RDS处理，email由<a class="ae kd" href="https://stackshare.io/mailgun" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Mailgun </strong> </a>处理，测试构建由Travis处理，错误报告由Sentry处理。</p><p id="eb52" class="pw-post-body-paragraph jb jc hu je b jf jg jh ji jj jk jl jm ka jo jp jq kb js jt ju kc jw jx jy jz hn dt translated">感谢您阅读我们的堆栈！如果你是Stream的用户，请务必在StackShare上将<a class="ae kd" href="https://stackshare.io/stream" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Stream </strong> </a>添加到你的stack中。如果你是个有才华的人，<a class="ae kd" href="https://stackshare.io/stream/stacks#jobs" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">来和我们一起工作吧</strong> </a>！最后，如果你还没有尝试过Stream，看看这个API  的快速<a class="ae kd" href="https://getstream.io/try-the-api/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">教程。</strong></a></p></div></div>    
</body>
</html>