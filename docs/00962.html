<html>
<head>
<title>DL06: DeepDream (with code)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DL06:深梦(附代码)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/dl06-deepdream-with-code-5f735052e21f?source=collection_archive---------20-----------------------#2018-01-30">https://medium.com/hackernoon/dl06-deepdream-with-code-5f735052e21f?source=collection_archive---------20-----------------------#2018-01-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="a34f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">DeepDream解释(用PyTorch代码)</p><p id="23f0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">往期帖子:<br/> <a class="ae jp" href="https://hackernoon.com/dl01-writing-a-neural-network-from-scratch-theory-c02ccc897864" rel="noopener ugc nofollow" target="_blank"> DL01:神经网络理论</a> <br/> <a class="ae jp" href="https://hackernoon.com/dl02-writing-a-neural-network-from-scratch-code-b32f4877c257" rel="noopener ugc nofollow" target="_blank"> DL02:从零开始编写神经网络(代码)</a> <br/> <a class="ae jp" href="https://hackernoon.com/dl03-gradient-descent-719aff91c7d6" rel="noopener ugc nofollow" target="_blank"> DL03:梯度下降</a> <br/> <a class="ae jp" href="https://hackernoon.com/dl04-backpropagation-bbcfbf2528d6" rel="noopener ugc nofollow" target="_blank"> DL04:反向传播</a> <br/> <a class="ae jp" href="https://hackernoon.com/dl05-convolutional-neural-networks-1d3bb7fff586" rel="noopener ugc nofollow" target="_blank"> DL05:卷积神经网络</a></p><h1 id="d6b8" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">代码可以在这里找到<a class="ae jp" href="https://github.com/thesemicolonguy/deep-dream-pytorch" rel="noopener ugc nofollow" target="_blank">。</a></h1><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/d11344de70dea5e197cede24410100cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*4hLxxtdae1AotNtEz4dmiw.png"/></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Image generated by my code</figcaption></figure><h2 id="30a5" class="la jr hu bd js lb lc ld jw le lf lg ka jc lh li ke jg lj lk ki jk ll lm km ln dt translated">什么是DeepDream？</h2><p id="3d41" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">这是一个有趣的算法来生成迷幻般的图像。它也给了一种感觉，什么特征，CNN的特定层已经学会了。这是一种可视化预先训练的CNN层的方法。</p><h2 id="f4cd" class="la jr hu bd js lb lc ld jw le lf lg ka jc lh li ke jg lj lk ki jk ll lm km ln dt translated">它是如何工作的？</h2><p id="1a24" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">使用基本图像，该图像被馈送给预先训练的CNN(它甚至可以是随机噪声)。然后，向前传递直到特定层。现在，为了了解这一层学到了什么，我们需要通过这一层最大化激活。</p><p id="f79a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该层的梯度被设置为等于来自该层的激活，然后在输入图像上进行梯度上升。这最大化了该层的激活。</p><p id="5327" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，只做这么多并不能产生好的图像。各种技术被用来使结果图像更好。高斯模糊可以使图像更平滑。</p><p id="c106" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使图像更好的一个主要概念是使用<strong class="it hv">八度音阶</strong>。输入图像被反复缩小，并且梯度上升被应用到所有图像，然后结果被合并到单个输出图像中。下图将有助于更好地理解八度音阶:</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="fe ff lt"><img src="../Images/2499a22d44b42ec0f9c0cd96b35ff38d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFgIqRXLDE03_sUWNnxFzQ.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Source: <a class="ae jp" href="https://www.youtube.com/watch?v=ws-ZbiFV1Ms&amp;t=35s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=ws-ZbiFV1Ms&amp;t=35s</a></figcaption></figure><h2 id="eb8c" class="la jr hu bd js lb lc ld jw le lf lg ka jc lh li ke jg lj lk ki jk ll lm km ln dt translated">代码？</h2><p id="9a08" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">我用VGG16创建了这些DeepDream可视化。</p><p id="dda5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该代码主要有两个功能:</p><ul class=""><li id="a8fe" class="ly lz hu it b iu iv iy iz jc ma jg mb jk mc jo md me mf mg dt translated">dd_helper:这是实际的deep_dream代码。它获取一个输入图像，向前传递到一个特定的层，然后通过梯度上升更新输入图像。</li></ul><figure class="kp kq kr ks fq kt"><div class="bz el l di"><div class="mh mi l"/></div></figure><ul class=""><li id="fc2d" class="ly lz hu it b iu iv iy iz jc ma jg mb jk mc jo md me mf mg dt translated">deep_dream_vgg:这是一个<strong class="it hv">递归</strong>函数。它反复缩小图像，然后调用dd_helper。然后，它对结果进行升级，并将其合并(混合)到递归树上更高一级的图像中。最终图像与输入图像的大小相同。</li></ul><figure class="kp kq kr ks fq kt"><div class="bz el l di"><div class="mh mi l"/></div></figure><h1 id="7e8e" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">不同conv层的输出(从浅层到深层):</h1><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div class="fe ff mj"><img src="../Images/c0e83dec4f5ab081cbe7e448a514aeaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*wXh-sfd6NLfY4NKyavoNfw.png"/></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Input image</figcaption></figure><blockquote class="mk ml mm"><p id="8b96" class="ir is mn it b iu iv iw ix iy iz ja jb mo jd je jf mp jh ji jj mq jl jm jn jo hn dt translated">注意，浅层学习基本的形状、线条和边缘。之后，层学习模式。更深的层次学习更复杂的特征，如眼睛、脸等。</p></blockquote><div class="kp kq kr ks fq ab cb"><figure class="mr kt ms mt mu mv mw paragraph-image"><img src="../Images/a41e145ceda70a28bc6f29524920a1df.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*kGkr_kqrVdTXwNLcZOytkg.png"/></figure><figure class="mr kt ms mt mu mv mw paragraph-image"><img src="../Images/7e40362a6bf7c156d300f4c51a71e082.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*hYk7z5VedgfPd-qK6XvsOw.png"/></figure></div><div class="ab cb"><figure class="mr kt ms mt mu mv mw paragraph-image"><img src="../Images/14d6c3b7ab7bb85746e3c23b311cc205.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*NCnzbrXeBZu7Ljn3EQmzMQ.png"/></figure><figure class="mr kt ms mt mu mv mw paragraph-image"><img src="../Images/f4fc6ed317e3b7087fc892dcb704e302.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*4E7YghRyFtslf-dA5RyMgw.png"/></figure></div><div class="ab cb"><figure class="mr kt ms mt mu mv mw paragraph-image"><img src="../Images/0d2fd3665818dd228a1db55454152eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*3dShxOK6VlI27g2qAJo6hg.png"/></figure><figure class="mr kt ms mt mu mv mw paragraph-image"><img src="../Images/7504b86ab57c0291b5576230958cf11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*zNtMC_GJMX-9C2is8m7_Ww.png"/></figure></div><div class="ab cb"><figure class="mr kt ms mt mu mv mw paragraph-image"><img src="../Images/7a33ea949bf82def5b67dbcfeec06b4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*7t-uB-38k1iMA4ur3VwM8w.png"/></figure><figure class="mr kt ms mt mu mv mw paragraph-image"><img src="../Images/6f550a98f1ff9e995f8c0ee7612b7343.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*xKa-9hlos-00VmQT53w2ag.png"/></figure></div><div class="ab cb"><figure class="mr kt mx mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/97d53c0aa7e7361f52a09fb9aaa20c34.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*MKJQncg6fhE4pxF2ULSuiw.png"/></div></figure><figure class="mr kt mx mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/13341138e891e20854a416b2c7a406be.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*G2hhcNsbPvdE5welTGHTmA.png"/></div></figure><figure class="mr kt mx mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/47048776007a23d55bf945fb47062d3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*uEDS2Zk8-UTJlp-zDmIqAA.png"/></div></figure></div><h1 id="000f" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">如果你喜欢这个，给我一个Github上的⋆！</h1></div></div>    
</body>
</html>