<html>
<head>
<title>Building Google’s Art and Culture Portrait Matcher</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建谷歌的艺术和文化肖像匹配器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-googles-art-and-culture-portrait-matcher-8abc040e9a10?source=collection_archive---------35-----------------------#2018-01-30">https://medium.com/hackernoon/building-googles-art-and-culture-portrait-matcher-8abc040e9a10?source=collection_archive---------35-----------------------#2018-01-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="d18c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当我兴奋的室友第一次向我展示肖像搜索功能时，我对结果感到惊讶(有点被侮辱)。对于那些不熟悉它的人来说，谷歌艺术与文化中的这一功能允许你在谷歌的数字化艺术收藏中找到与你提交的自拍相似的面孔。</p><p id="b884" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对我来说，这是真正可怕的作品:</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff jp"><img src="../Images/62dc45a17ba421acb5777e3ae4e74d2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*h2RroojXMW4Y38mV62tn8w.png"/></div><figcaption class="jx jy fg fe ff jz ka bd b be z ek">Apparently my 17th century doppelgänger</figcaption></figure><p id="b567" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">多亏了大量可用的开源工具和库，在一个下午的时间里就可以创造出一些不那么不可思议但有点实用的东西。</p><h2 id="c55b" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">粗略的计划</h2><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="fe ff kw"><img src="../Images/4f86ea9c33838961ebfaa29aa2afc9b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luF5HxWdLFd71rbyamZfpg.png"/></div></div></figure><p id="d3fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，找到一些面部识别即服务。辉煌的<a class="ae lb" href="https://www.kairos.com" rel="noopener ugc nofollow" target="_blank"> Kairos </a>提供了一个免费且令人不安的API，一旦输入一个图片的url，它就会提供大量信息:</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff lc"><img src="../Images/aafcda0c59e4ba15ed224c0f7aea0414.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*IA8aKaD18OR22oMpfvsORA.png"/></div><figcaption class="jx jy fg fe ff jz ka bd b be z ek">Generic input image</figcaption></figure><pre class="jq jr js jt fq ld le lf lg aw lh dt"><span id="fe92" class="kb kc hu le b fv li lj l lk ll"><strong class="le hv">Returned JSON data (some image info removed for length)</strong><br/>{"images":<br/>  [{"faces":<br/>    [{"attributes":<br/>      {"age":40,<br/>      "asian":0.00539,<br/>      "black":0.00032,<br/>      "gender":{<br/>        "femaleConfidence":0.00002<br/>        "maleConfidence":0.99998,<br/>        "type":"M"},<br/>      "glasses":"None",<br/>      "hispanic":0.04204,<br/>      "lips":"Apart",<br/>      "other":0.01249,<br/>      "white":0.93976}    <br/>    }]<br/>  }]<br/>}</span></pre><p id="cd6c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> Kairos </strong>还允许将带标签的图像<em class="lm">注册</em>到数据库中，当未加标签的图像传递给API时，它会返回数据库中<strong class="it hv"> </strong> <em class="lm">最相似图像</em>的标签。</p><p id="02e9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">虽然这是为了识别以前已经注册过的人，但它可以非常尊重地执行艺术识别任务(当它的相似性阈值设置得足够低时)。</p><p id="6f89" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了找到合适的图片来注册，我挖掘了我正在尝试模仿的服务，从<a class="ae lb" href="https://www.google.com/culturalinstitute/beta/" rel="noopener ugc nofollow" target="_blank">谷歌艺术和文化</a>网站抓取艺术品的URL。如果我要在这方面投入超过四个小时，我可能会花时间给每件艺术品贴上一个唯一的id，这个id与图像、艺术品名称和艺术家的数据库相关联，以提供全面而轻松的用户体验。</p><p id="e040" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但我不是。</p><p id="305f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以每幅作品的标签只是它的url，所以用户可以被重定向到他们匹配的作品。</p><pre class="jq jr js jt fq ld le lf lg aw lh dt"><span id="3c5d" class="kb kc hu le b fv li lj l lk ll">from flask import Flask, redirect</span><span id="21a0" class="kb kc hu le b fv ln lj l lk ll">#Some function here, get a suitable image url as label<br/>    return redirect(label)</span></pre><h2 id="3eff" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jc km kn ko jg kp kq kr jk ks kt ku kv dt translated">服务器和主机</h2><p id="1a06" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated"><strong class="it hv"> Flask </strong>提供了一个简单的选项，在使用python处理图像IO和处理的同时向用户提供网页。不想花太多时间在主机上，我只是在本地运行网站。</p><p id="fa42" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Kairos需要一个公共图像url作为其输入，因此为了在本地网络之外公开我的站点，Ngrok提供了一个到我的本地主机的安全通道。</p><p id="a10f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下一个挑战是处理用户输入和API响应，同时继续为用户提供站点服务。为了处理异步事件，可以使用<strong class="it hv">线程</strong>库来分离两个进程。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="fe ff lt"><img src="../Images/d5bdcea55519a883fa248c00bcd2e53b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0q7ZdN6Rtn6vCBHO7kttg.png"/></div></div></figure><p id="c89b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，是时候把朋友、家人以及一些普通人的自拍照上传到网站上了，结果如下所示！</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="fe ff lu"><img src="../Images/9e7af28ea80dcc4d5be097b0440dd385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UA8GkGPCszywXO0ONAJHrA.png"/></div></div><figcaption class="jx jy fg fe ff jz ka bd b be z ek">Results from my site — Successfully matches sex &amp; ethnicity</figcaption></figure></div></div>    
</body>
</html>