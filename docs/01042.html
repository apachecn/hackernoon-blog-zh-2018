<html>
<head>
<title>Infrastructure as Code Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基础设施代码教程</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/infrastructure-as-code-tutorial-e0353b530527?source=collection_archive---------8-----------------------#2018-02-01">https://medium.com/hackernoon/infrastructure-as-code-tutorial-e0353b530527?source=collection_archive---------8-----------------------#2018-02-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><h1 id="812e" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated"><strong class="ak">基础设施作为代码究竟是什么？</strong></h1><p id="798b" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">作为<a class="ae kn" href="https://hackernoon.com/tagged/code" rel="noopener ugc nofollow" target="_blank">代码</a>的基础设施是DevOps中的关键实践之一。</p><p id="f53e" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">回到过去，当DevOps运动开始时，人们意识到IT运营(系统管理员)的工作非常混乱。大多数系统管理任务都是手动完成的，或者通过自己编写的脚本来完成。这两种方法效果都不好。</p><p id="a962" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">在团队中工作时，手动完成的任务带来了真正的混乱，因为没有人知道托管基础架构是什么样子，运行的机器是如何配置的，做了哪些更改。当系统出现故障时，没人知道是什么变化导致了系统崩溃。在这种情况下，系统管理员的工作变成了胡乱猜测。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="fe ff kt"><img src="../Images/6d1baecf2b6d82ff2f35ada606017f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*8R2ULh5LTTx0fDGcMV2WGQ.jpeg"/></div></figure><p id="1306" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">脚本对于基础设施和配置管理也不太适用。它们比手工工作更好，因为我们对任务进行了某种程度的自动化和标准化，并且我们可以将脚本保存在源代码控制系统中，如Git，以跟踪对它所做的更改。但是这些脚本有很大的问题。</p><p id="3e9f" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">首先，人们如何写一个脚本来完成相同的任务有很大的不同。因此，每个脚本都是独一无二的，通常需要花费大量的时间和精力来理解。</p><p id="e160" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">其次，随着时间的推移，系统配置越来越大，脚本也变得越来越大和复杂。如果多人正在处理同一个脚本，这一点尤其正确。此外，人们可能来来去去都没有在他们的脚本上留下适当的文档。很容易发生这样的情况:在某个时候，团队中没有人会真正理解这个特定脚本的作用。</p><p id="492d" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">最后，脚本不利于长期配置和基础设施管理，因为它们不提供<strong class="jr hv">幂等性</strong>。幂等性意味着如果我们多次运行一个脚本，我们将得到相同的结果。如果运行多次，大多数脚本不能确保相同的结果。幂等性使我们能够随着时间的推移对系统进行更改，并确保通过更改和使用相同的配置脚本来正确配置系统。这是长期配置和基础架构管理的关键条件。尽管有可能确保脚本的幂等性，但是考虑到前面提到的第一个和第二个原因，这很难做到。</p><p id="538e" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">因此，聪明的人意识到，手工工作和脚本并不真正适合IT运营，并建议采用一种新的方法，即基础架构即代码。</p><p id="8b7f" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">他们发现将所有的配置脚本保存在源代码控制中非常有用，因为它允许控制正在发生的变化。这是在团队环境中工作的关键。</p><p id="2dee" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">他们还意识到，大多数配置和基础架构管理任务实际上都非常常见且定义明确:启动具有特定特征的虚拟机、创建防火墙规则、安装系统软件包、复制文件、启动服务等。所以他们想:“为什么我们不为我们正在使用的系统编写执行那些常见任务的模块/函数呢？我们将对它们进行测试，确保它们能在我们的系统中工作，并且是<strong class="jr hv">等幂的</strong>。”现在，我们不再在每次需要做什么的时候编写自己的脚本实现，而是使用这些模块/函数(构建在脚本之上的高级抽象)。</p><p id="218a" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">例如，比较以下Bash脚本来安装系统包:</p><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="438a" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">对于这个可行的剧本，它为我们提供了一个幂等抽象来完成同样的任务:</p><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="lb lc l"/></div></figure><h1 id="c199" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated"><strong class="ak">如果没有真正的代码，为什么叫基础设施为代码？</strong></h1><p id="df2f" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">没错，这个例子看起来不像是您可能经常看到的代码:</p><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="932d" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">但是在<em class="ld"> apt </em>模块后面有一个真正的Python代码，它完成了这项工作。你可以把<em class="ld"> apt </em>看作是接受参数的函数的名字，例如一个标志，是安装还是删除一个包，包的名字等等。</p><h1 id="45af" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">我们为什么需要它？</h1><p id="6643" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">基础设施作为一种编码方式，给系统管理工作带来了秩序。一些主要优势包括:</p><ul class=""><li id="5a22" class="le lf hu jr b js ko jw kp ka lg ke lh ki li km lj lk ll lm dt translated"><em class="ld">它允许我们控制托管系统的当前状态。</em>因为我们确保我们的配置是等幂的，所以我们可以通过相同的脚本管理托管系统的整个生命周期。例如，我们可能会在我们的系统上安装一个包，该包已经用以下Ansible行动手册进行了初始配置:</li></ul><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="7f34" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">然后，我们可以通过添加另一个包的名称来更改该行动手册，并运行该行动手册以确保它已安装:</p><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="c159" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">如果我们再次运行剧本，我们可以确信，如果系统已经有了正确的包，什么都不会被安装，或者如果一些包丢失(例如，它们被一些坏员工手动删除)，它们将被安装。通过相同的脚本管理系统的整个生命周期意味着我们的源代码控制报告中的配置代码反映了被管理系统的当前状态。</p><ul class=""><li id="e706" class="le lf hu jr b js ko jw kp ka lg ke lh ki li km lj lk ll lm dt translated"><em class="ld">我们可以将开发领域常见的实践应用到我们的基础设施管理中</em>。将代码保持在源代码控制中，使用同行评审，测试我们的代码是软件开发中非常常见的做法。它们允许我们关注所有正在发生的变化，确保人们使用同行评审来批准它，并通过用测试覆盖我们的代码来防止早期阶段的失败。这些不仅对开发界，而且对运营界都是有价值实践。</li></ul><h1 id="a995" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated"><strong class="ak">我是一名开发人员，我为什么要学习基础设施代码？</strong></h1><p id="6cd3" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">难道您不好奇如何在远程服务器上运行您开发的应用程序吗？运营人员使用什么工具来完成这项工作？</p><p id="d570" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">此外，如果你热衷于写代码，基础设施作为代码应该很容易学习。你只需要学习一种新的语言语法，这种语法比你已经知道的任何编程语言理解起来都简单。那应该很好玩:)</p><h1 id="9a29" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated"><strong class="ak">什么是基础设施即代码教程？</strong></h1><p id="4de3" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我试图创建一个简单易懂的关于基础设施的<a class="ae kn" href="https://github.com/Artemmkin/infrastructure-as-code-tutorial" rel="noopener ugc nofollow" target="_blank">教程作为代码</a>。它是基于实践的，这意味着它没有太多的理论，但大量的实践让你感受到什么是代码基础设施。</p><p id="ff70" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">它涵盖了现代操作世界中常见的许多工具:Packer、Terraform、Ansible、vagger、Docker和Docker Compose。我还计划在未来增加更多的例子。</p><p id="d7a1" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">在<a class="ae kn" href="https://hackernoon.com/tagged/tutorial" rel="noopener ugc nofollow" target="_blank">教程</a>结束时，您将获得自己的存储库，其中包含测试应用程序和基础设施代码，以管理运行该应用程序的环境。<a class="ae kn" href="https://github.com/Artemmkin/infrastructure-as-code-example" rel="noopener ugc nofollow" target="_blank">这里的</a>是您将获得的存储库的一个例子。</p><h1 id="fc9c" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated"><strong class="ak">这个教程是为了什么而制作的？</strong></h1><p id="05ad" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我记得我第一次接触代码形式的基础设施，以及本教程中涉及的所有不同的工具。我花了一些时间来了解正在发生的事情，这些工具解决了什么问题，以及它们如何协同工作。我制作这个教程是为了帮助那些对这一切不熟悉或者对这些工具感到困惑的人。</p><p id="df18" class="pw-post-body-paragraph jp jq hu jr b js ko ju jv jw kp jy jz ka kq kc kd ke kr kg kh ki ks kk kl km hn dt translated">它是开源的，我真的希望听到任何关于如何使它变得更好的建议:)</p><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="ln lc l"/></div></figure></div></div>    
</body>
</html>