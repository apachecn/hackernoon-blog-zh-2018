<html>
<head>
<title>So How Do I Really Do An Atomic Swap</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">那么，我该如何进行原子交换呢</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/so-how-do-i-really-do-an-atomic-swap-f797852c7639?source=collection_archive---------9-----------------------#2018-02-03">https://medium.com/hackernoon/so-how-do-i-really-do-an-atomic-swap-f797852c7639?source=collection_archive---------9-----------------------#2018-02-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/d4cb6dca56ebdc10e8052015427b8918.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGh_2lT394KI1GtV-lugaA.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">A Real Atomic Swap Between Viacoin and Litecoin</figcaption></figure><p id="043a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">加密，加密，加密，这是现在谈论最多的话题，加密的消亡，加密的革命，但是在这篇文章中我们不打算谈论它，而是去做，去使用它。T3】</p><p id="c0b6" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我将向您展示原子交换在实践中是如何工作的，从代码的角度看它们背后的逻辑，以及实现最终结果的执行流程:</p><blockquote class="kf kg kh"><p id="d7fd" class="jg jh ke ji b jj jk jl jm jn jo jp jq ki js jt ju kj jw jx jy kk ka kb kc kd hn dt translated">Alice拥有Viacoin，而Bob是Litecoin的坚定支持者，但他想要Viacoin，因为他相信它有光明的未来，Alice和Bob如何在不通过第三方的情况下将他们的藏毒量交换给对方？</p></blockquote><p id="8306" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">答案是<a class="ae kl" href="https://en.bitcoin.it/wiki/Hashed_Timelock_Contracts" rel="noopener ugc nofollow" target="_blank"> <strong class="ji hv">散列时间锁定契约</strong> </a>，简而言之就是HTLC。</p><p id="de36" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">简而言之，散列时间锁契约是一个非图灵完全契约，它像一个带有密钥的谜题一样工作，但要求求解者(在本例中为Bob)在X时间过去之前提供密钥，否则他将失去要求奖励的能力，并将其返回给契约的发起者。</p><p id="99f4" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">散列锁是满足条件的“事务难题”，输入数据散列等于来自前一个块的散列值，在脚本(比特币脚本语言)中，它看起来像这样:</p><figure class="km kn ko kp fq iv"><div class="bz el l di"><div class="kq kr l"/></div></figure><p id="e7e7" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">原子跨链交换是发生在两个区块链上的散列锁定契约，发起者将创建一个契约并在其中锁定数量X的硬币Z，该契约在时间段T内有效。如果密钥提供了有效秘密，则它可以移动锁定的硬币。如果在T结束之前没有完成，则该契约被取消。</p><p id="b5fe" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果你从比特币原语的角度来考虑它，这是有意义的，它也显示了密码学如何在简单的逻辑中使这种操作安全可靠。</p><p id="11b8" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">Alice在合同A中锁定了一些Viacoin，Bob在合同B中锁定了一些Litecoin，Alice给了Bob打开锁定的via coin的秘密，Bob在最后也做了同样的事情Alice和Bob都被激励去分享秘密，因为如果不是他们两个做的，硬币会回到他们各自的钱包中，不会发生交换。</p><h2 id="cca0" class="ks kt hu bd ku kv kw kx ky kz la lb lc jr ld le lf jv lg lh li jz lj lk ll lm dt translated">让我们做一个原子交换</h2><p id="440a" class="pw-post-body-paragraph jg jh hu ji b jj ln jl jm jn lo jp jq jr lp jt ju jv lq jx jy jz lr kb kc kd hn dt translated">要求:</p><ul class=""><li id="fa7c" class="ls lt hu ji b jj jk jn jo jr lu jv lv jz lw kd lx ly lz ma dt translated">2台VPS(数字海洋、Vultr …)或2台机器。</li><li id="15c5" class="ls lt hu ji b jj mb jn mc jr md jv me jz mf kd lx ly lz ma dt translated">在每台机器上运行两个区块链的完整节点</li><li id="120b" class="ls lt hu ji b jj mb jn mc jr md jv me jz mf kd lx ly lz ma dt translated">原子wap包</li><li id="f467" class="ls lt hu ji b jj mb jn mc jr md jv me jz mf kd lx ly lz ma dt translated">支持的硬币(比特币、莱特币、Viacoin、Decred、Particl……)都是基于UXTO的协议。</li></ul><p id="0eb1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">首先，您需要安装两个节点，并配置它们使用testnet，如这里的<a class="ae kl" href="https://github.com/viacoin/atomicswap" rel="noopener ugc nofollow" target="_blank">所述</a>。</p><p id="60c5" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">场景:</p><figure class="km kn ko kp fq iv"><div class="bz el l di"><div class="kq kr l"/></div></figure><p id="0b83" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在您的第一台机器上，您使用发起者区块链(比如Alice的Viacoin)发起契约。</p><figure class="km kn ko kp fq iv"><div class="bz el l di"><div class="kq kr l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Alice initiates the swap</figcaption></figure><p id="b12a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">一旦创建了合同，Bob必须对其进行审计，以检查是否:</p><ul class=""><li id="5966" class="ls lt hu ji b jj jk jn jo jr lu jv lv jz lw kd lx ly lz ma dt translated">锁定的金额是双方同意的金额</li><li id="17c7" class="ls lt hu ji b jj mb jn mc jr md jv me jz mf kd lx ly lz ma dt translated">地址是鲍勃的地址</li><li id="bbf6" class="ls lt hu ji b jj mb jn mc jr md jv me jz mf kd lx ly lz ma dt translated">该合同在区块链上公布(不可更改)</li></ul><figure class="km kn ko kp fq iv"><div class="bz el l di"><div class="kq kr l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Bob audits the contract</figcaption></figure><p id="7dd0" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果一切都是正确的，Bob通过参与合同锁定他的硬币。</p><figure class="km kn ko kp fq iv"><div class="bz el l di"><div class="kq kr l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Bob participates in the swap by creating a new contract</figcaption></figure><p id="6f66" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">轮到爱丽丝审核合同了</p><figure class="km kn ko kp fq iv"><div class="bz el l di"><div class="kq kr l"/></div></figure><p id="dba8" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果一切都检查过了(条件达成一致),爱丽丝继续兑换她的莱特币</p><figure class="km kn ko kp fq iv"><div class="bz el l di"><div class="kq kr l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Alice redeeming the litecoins from Bob’s contract</figcaption></figure><p id="6fdc" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在对于Bob来说，一旦交易实际公布，Bob可以提取Alice在入会时知道的秘密，该秘密将解锁Bob可以兑换的Viacoin区块链上锁定的硬币</p><figure class="km kn ko kp fq iv"><div class="bz el l di"><div class="kq kr l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Bob now can extract the secret to redeem his Viacoins</figcaption></figure><p id="8391" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">就这样，硬币被解锁，原子交换完成。</p><p id="b329" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这项技术将真正实现去中心化的交换，原子互换相当于外汇交换，但是是无信任和去中心化的。</p><p id="7d9e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">实现主流可用性的道路还很漫长，我希望这将有助于构建东西，这是新协议的时代。</p></div></div>    
</body>
</html>