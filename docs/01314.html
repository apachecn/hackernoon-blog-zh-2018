<html>
<head>
<title>A RESTful API for iftop</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iftop的RESTful API</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/introducing-a-rest-api-to-iftop-542545ff73bc?source=collection_archive---------16-----------------------#2018-02-10">https://medium.com/hackernoon/introducing-a-rest-api-to-iftop-542545ff73bc?source=collection_archive---------16-----------------------#2018-02-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="b44c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您曾经在Linux 上使用过<a class="ae jp" href="http://www.ex-parrot.com/pdw/iftop/" rel="noopener ugc nofollow" target="_blank"> iftop </a>或<a class="ae jp" href="http://www.binarytides.com/linux-commands-monitor-network/" rel="noopener ugc nofollow" target="_blank">任何其他</a><a class="ae jp" href="https://blog.serverdensity.com/80-linux-monitoring-tools-know/" rel="noopener ugc nofollow" target="_blank">可用网络监控工具，那么您至少会对通过它们可以查看/总结的详细信息留下一点印象。</a></p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/507292c0014c18190dfab176b0701309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PuN0CD1CbJ2LFQV2CO1U4A.png"/></div></div></figure><p id="58f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这些工具大多使用<a class="ae jp" href="http://www.tcpdump.org/" rel="noopener ugc nofollow" target="_blank"> libpcap </a>来实时检查数据包，并汇总/存储它们的详细信息；现在问题来了:如果我想用webservice API来读取这些信息呢？</p><h1 id="30f1" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">iftop微服务</h1><p id="3b65" class="pw-post-body-paragraph ir is hu it b iu la iw ix iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo hn dt translated">事实证明，这是一个小型iftop微服务的完美用例。使用这个API，我们可以根据IP地址、协议类型和发送/接收的字节数来检索网络使用统计数据。</p><p id="f2b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我继续向iftop添加了一个最小的RESTful API这是对<code class="eh lf lg lh li b">/iftop/history</code>的调用的(经过美化的)输出:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lj lk l"/></div></figure><p id="6f78" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">很好，不是吗？还有一个用于<code class="eh lf lg lh li b">/iftop/version</code>的方法允许读取当前版本。</p><p id="f562" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以使用以下命令运行它:</p><p id="811d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh lf lg lh li b">iftop -S 8080</code></p><p id="1dfd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">默认情况下，它会将root权限授予用户<code class="eh lf lg lh li b">nobody</code>和组<code class="eh lf lg lh li b">nogroup</code>(可配置)。</p><p id="fa5c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">启用web服务将禁用curses或基于文本的输出，iftop日志记录输出(关于标准错误)将变得更类似于web服务:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lj lk l"/></div></figure><p id="2777" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以从以下网址获得我的iftop补丁的最新版本:</p><div class="ll lm fm fo ln lo"><a href="https://github.com/gdm85/iftop" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab ej"><div class="lq ab lr cl cj ls"><h2 class="bd hv fv z el lt eo ep lu er et ht dt translated">gdm85/iftop</h2><div class="lv l"><h3 class="bd b fv z el lt eo ep lu er et ek translated">带有webservice API补丁的当前iftop git存储库的镜像</h3></div></div><div class="lw l"><div class="lx l ly lz ma lw mb ka lo"/></div></div></a></div><h1 id="2586" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">上游</h1><p id="84c0" class="pw-post-body-paragraph ir is hu it b iu la iw ix iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo hn dt translated">事后看来，我很高兴选择iftop，因为代码注释非常有趣。我的<a class="ae jp" href="https://github.com/gdm85/iftop/blob/949ed0f7e2c54c598868c270b82c2d702131a339/stringmap.c#L5" rel="noopener ugc nofollow" target="_blank">最佳选择</a>:</p><p id="f695" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh lf lg lh li b">Also, I haven't implemented removal of items from the tree. So sue me.</code></p><p id="3f58" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">补丁已经上传了，但是我还没有收到维护者的任何回复。我对它们被接受不抱太大希望，但是不管怎样，你已经可以通过克隆<a class="ae jp" href="https://github.com/gdm85/iftop" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>和构建iftop来使用它们和webservice API特性了。</p></div></div>    
</body>
</html>