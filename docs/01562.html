<html>
<head>
<title>Zero config React + Typescript + CSS Modules + JEST with Poi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">零配置React + Typescript + CSS模块+ JEST with Poi</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/zero-config-react-typescript-css-modules-jest-with-poi-bbcedfe2383a?source=collection_archive---------11-----------------------#2018-02-19">https://medium.com/hackernoon/zero-config-react-typescript-css-modules-jest-with-poi-bbcedfe2383a?source=collection_archive---------11-----------------------#2018-02-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/1d46d72db5867c898fa9a3161d49f671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IiRGtYA1t_f8Pi4l2qXKhQ.jpeg"/></div></div></figure><p id="365c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇文章最初发表在我公司的博客上。我们在Appfocused的使命是通过利用我们丰富的经验、对现代UI趋势的了解、最佳实践和代码工艺，帮助公司在web上实现 <a class="ae kb" href="https://www.appfocused.com" rel="noopener ugc nofollow" target="_blank"> <em class="ka">卓越的用户体验。</em></a></p><p id="446c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Poi.js是一个取代初学者工具包和样板项目的工具。Poi的承诺是“不再有配置地狱”。在<em class="ka">几乎没有</em>配置的情况下，它提供以下内容:</p><ul class=""><li id="f09c" class="kc kd hu je b jf jg jj jk jn ke jr kf jv kg jz kh ki kj kk dt translated">自动传输和捆绑(使用webpack和babel/postcss)</li><li id="9b2d" class="kc kd hu je b jf kl jj km jn kn jr ko jv kp jz kh ki kj kk dt translated">热代码重载</li><li id="f579" class="kc kd hu je b jf kl jj km jn kn jr ko jv kp jz kh ki kj kk dt translated"><code class="eh kq kr ks kt b">./static</code>中的文件被复制到dist文件夹</li></ul><p id="c184" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将尝试进一步推动它，并获得一个稍微高级的配置来与<em class="ka"> Poi </em>一起工作。在写作的时候，我的技术栈偏好是使用<a class="ae kb" href="https://hackernoon.com/tagged/css-modules" rel="noopener ugc nofollow" target="_blank"> CSS模块</a>(在<em class="ka"> create-react-app </em>中还没有现成的，没有弹出功能)用<a class="ae kb" href="https://hackernoon.com/tagged/typescript" rel="noopener ugc nofollow" target="_blank"> Typescript </a>进行反应，并用Jest和Enzyme进行测试。</p><p id="b460" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这就是我们即将实施的工作流程，它应该不会超过15分钟。系好安全带，我们开始吧。</p></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><h1 id="18bd" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">Poi</h1><p id="7026" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">首先在您的项目中安装Poi工具本身:</p><p id="f55d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">npm install poi -D</code></p><p id="4cad" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来我们需要运行Poi，我们将使用npx来帮助我们。Npx 允许在本地项目中完美地执行节点二进制文件。如果你还没有安装它，让我们把它分类。</p><p id="f3e6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">npm install npx -g</code></p><p id="684a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您现在尝试运行<code class="eh kq kr ks kt b">npx poi</code>，您会看到一个错误，因为根目录中仍然没有<em class="ka"> index.js </em>文件。现在，让我们只添加一个空文件来让Poi高兴:</p><p id="b3f8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">touch index.js</code></p></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><h1 id="4dcc" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">反应</h1><p id="0ea9" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">我们有一些东西，但我们需要我们的超级反应能力。<br/>这是我们通常通过互联网连接获得的信息:</p><p id="b539" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">npm install react react-dom --save</code></p><p id="bf5e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Poi有现成的Vue.js配置，对于其他任何东西，您都需要一个预置。幸运的是，有一个React:</p><p id="2dea" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">npm install poi-preset-react -D</code></p><p id="6f4c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所有预设都在<em class="ka"> poi.config.js </em>中连接，这是我们启动并运行React所需的唯一配置。至今印象深刻！</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">poi.config.js</figcaption></figure><p id="1451" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，我们添加一个简单的<em class="ka"> App.jsx </em>文件来测试jsx是否运行良好</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">App.jsx</figcaption></figure><p id="2d3b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，我们需要为react应用程序添加一个强制的<em class="ka"> index.js </em>内容，以在DOM中呈现<em class="ka"> App </em>组件，从而开始享受#0CJS React的热模块替换。</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">index.js</figcaption></figure></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><h1 id="6c23" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">以打字打的文件</h1><p id="67f5" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">下一步是让React使用Typescript。<br/>为了完成这项任务，我们需要以下物品:</p><ul class=""><li id="2190" class="kc kd hu je b jf jg jj jk jn ke jr kf jv kg jz kh ki kj kk dt translated">添加类型脚本</li><li id="e86c" class="kc kd hu je b jf kl jj km jn kn jr ko jv kp jz kh ki kj kk dt translated">添加<em class="ka"> tsconfig.json </em></li><li id="6f9d" class="kc kd hu je b jf kl jj km jn kn jr ko jv kp jz kh ki kj kk dt translated">为typescript添加一个poi预置并连接它</li><li id="d841" class="kc kd hu je b jf kl jj km jn kn jr ko jv kp jz kh ki kj kk dt translated">添加缺少的类型定义</li><li id="78b3" class="kc kd hu je b jf kl jj km jn kn jr ko jv kp jz kh ki kj kk dt translated">添加React-Typescript组件</li></ul><p id="e5fc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们首先安装Typescript和Poi预置作为我们项目的开发依赖项。</p><p id="94ed" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">npm install typescript poi-preset-typescript -D</code></p><p id="72e5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们已经知道如何连接Poi预设，对吗？</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div></figure><p id="42b1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来是一个简单的<em class="ka"> tsconfig.json </em>，Typescript需要它来更好地理解您希望它如何操作。让我们想出一个:</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">tsconfig.json</figcaption></figure><p id="b58e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，我们将把我们的<em class="ka"> App.jsx </em>重命名为<em class="ka"> App.ts </em>，并添加缺失的react类型</p><p id="f20e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">npm install @types/react -D</code></p><p id="52ab" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下面是我们的新组件的外观:</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">App.tsx</figcaption></figure></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><h1 id="127e" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">CSS模块</h1><p id="9aa5" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">Poi文档说以<em class="ka"> .module.css </em>结尾的文件<em class="ka">. module . scss</em><em class="ka">. module . less</em>默认应该支持css模块。</p><p id="cf05" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们添加一个文件<em class="ka"> App.module.css </em>，导入到App.tsx中:</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">App.module.css</figcaption></figure><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">App.tsx</figcaption></figure><p id="b4d5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当我们将css模块导入文件时，TS会不高兴，会告诉我们<em class="ka"> [ts]找不到模块。/App.module.css </em></p><p id="2b8a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们也解决这个问题，并添加一个<em class="ka"> global.d.ts </em>文件，其中包含以下行:</p><p id="56c4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">declare module '*.css';</code></p><p id="16a1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">斑点狗！我们现在有了一个带有typescript和css模块的react应用程序。您也可以在终端中发出<code class="eh kq kr ks kt b">npx poi build</code>命令，将它构建到一个<em class="ka"> dist/ </em>文件夹中。</p><h1 id="3815" class="lb lc hu bd ld le mo lg lh li mp lk ll lm mq lo lp lq mr ls lt lu ms lw lx ly dt translated">用Jest和Enzyme进行单元测试</h1><p id="57dd" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">安装带有类型的<em class="ka"> jest </em>和<em class="ka"> jest-css-modules </em>以使webpack和jest与css模块配合良好:</p><p id="e1da" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">npm install jest <a class="ae kb" href="http://twitter.com/types/jest" rel="noopener ugc nofollow" target="_blank">@types/jest</a> ts-jest jest-css-modules</code></p><p id="1a0a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">添加酶及其所有适配器和类型:</p><p id="6c84" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">npm install enzyme @types/enzyme enzyme-adapter-react-16 @types/enzyme-adapter-react-16 -D</code></p><p id="48ca" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来我们需要为<em class="ka">酶</em>配置适配器:</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">setupTests.ts</figcaption></figure><p id="37ca" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">并将一些<em class="ka"> jest </em>配置添加到我们的<em class="ka"> package.json </em>中，使其能够很好地与我们的类型脚本文件和css模块配合工作。</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">package.json</figcaption></figure><p id="428a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，让我们为我们的<em class="ka"> App.tsx </em>组件编写一个简单的单元测试，并将其放入<em class="ka"> __tests__ </em>文件夹:</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mi mj l"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">App.spec.tsx</figcaption></figure><p id="a805" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kq kr ks kt b">npx jest</code>将运行我们的测试，瞧，我们一切都是绿色的！我们现在准备编码一些重要的东西。</p><figure class="me mf mg mh fq iv"><div class="bz el l di"><div class="mt mj l"/></div></figure></div></div>    
</body>
</html>