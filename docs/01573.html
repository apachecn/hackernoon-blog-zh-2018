<html>
<head>
<title>The Android Heretic, Issue 1: Runtime Permissions Suck!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android异端，问题1:运行时权限烂透了！</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/the-android-heretic-issue-1-runtime-permissions-suck-26501d39dacb?source=collection_archive---------22-----------------------#2018-02-19">https://medium.com/hackernoon/the-android-heretic-issue-1-runtime-permissions-suck-26501d39dacb?source=collection_archive---------22-----------------------#2018-02-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/3419608aa2810e3c197e90e02db9b65d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZcJKz3761vChU1VFHfzkw.jpeg"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">My expression when I first heard about Marshmallow’s runtime permissions. I then threw the book against a wall and it <strong class="bd ih">broke</strong>. True story.</figcaption></figure><div class=""/><div class=""><h2 id="f715" class="pw-subtitle-paragraph jh ij ik bd b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy ek translated">一系列消除因果报应的帖子</h2></div><p id="a978" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated"><em class="kv">“Android异端”是一个新的系列，在这个系列中，我将讨论让我恼火的关于Android和Android开发的事情。它们不会是你通常所说的“相机API很烂”类型的帖子。相反，我会抱怨一些机器人世界的圣人。</em></p><p id="dff8" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">现在，在正常情况下，这些帖子会毁掉任何Android开发者的信誉，但既然我一开始就没有信誉，那就不是问题。</p><h2 id="4153" class="kw kx ik bd ky kz la lb lc ld le lf lg ki lh li lj km lk ll lm kq ln lo lp lq dt translated">2009年:“模态对话框烂透了，哈哈”</h2><p id="1d57" class="pw-post-body-paragraph jz ka ik kb b kc lr jl ke kf ls jo kh ki lt kk kl km lu ko kp kq lv ks kt ku hn dt translated">嘿，还记得2009年我们安卓粉丝是如何取笑iPhone的吗？每当有人收到一条消息，就会在屏幕上弹出一个停止工作流的弹出窗口，这看起来是多么奇怪？</p><p id="dcf2" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">对于我们这些Android爱好者来说，情况就不一样了:我们会在通知下拉列表中得到一个漂亮、谨慎的通知，并在滚动条中预览显示的消息(既然我们在这里:该死的，决定移除滚动条的人——该死的见鬼去吧！)</p><p id="1113" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">你还想让我提醒你Windows Vista的用户账户控制(UAC)吗？在当时，所有人都认为它是撒旦和舒布·尼格拉思(Shub-Niggurath)的后代。</p><figure class="lx ly lz ma fq hw fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/7669098574777c3c27a70353360c8f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*z2X1mqBBX_Ti9gMEoavjjA.jpeg"/></div><figcaption class="id ie fg fe ff if ig bd b be z ek">UAC’s mom and her thousand young. What a whore.</figcaption></figure><p id="43be" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">你猜怎么着？随着Android Marshmallow中运行时权限的引入，Android用户也将开始尝到这种滋味。但这次他们会喜欢，因为谷歌这么说了。</p><h2 id="0e07" class="kw kx ik bd ky kz la lb lc ld le lf lg ki lh li lj km lk ll lm kq ln lo lp lq dt translated">2016:“OMG，模态权限对话框摇滚！”</h2><p id="adc1" class="pw-post-body-paragraph jz ka ik kb b kc lr jl ke kf ls jo kh ki lt kk kl km lu ko kp kq lv ks kt ku hn dt translated">每当我提到我不喜欢运行时权限，我就会被群起而攻之:“用户终于有了选择！他们可以精确地接受或拒绝权限。你疯了吗？<em class="kv">你是共产党员吗？”</em></p><p id="9bcc" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">虽然我不能否认这种许可模式在某种程度上是有道理的，但我认为谷歌(它本质上抄袭了苹果的许可模式的所有可怕之处)本可以做得更好。</p><p id="149e" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">那么，我为什么讨厌这种模式呢？因为在开发商这边，很乱。在用户方面，它很烦人，而且会停止工作流。</p><h2 id="ddc2" class="kw kx ik bd ky kz la lb lc ld le lf lg ki lh li lj km lk ll lm kq ln lo lp lq dt translated">实现运行时权限或:第八层地狱</h2><p id="74e0" class="pw-post-body-paragraph jz ka ik kb b kc lr jl ke kf ls jo kh ki lt kk kl km lu ko kp kq lv ks kt ku hn dt translated">实现运行时权限迫使开发人员在他们的活动中添加授权代码(并检查权限是否已经被授予)。在每个人都试图让他们的活动类变得更轻的时候(在谷歌自己的架构组件的帮助下)，这有什么意义呢？</p><p id="231b" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">API包含的方法名比威尔士村庄的德语单词还要长，这也于事无补。</p><p id="4310" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated"><code class="eh mb mc md me b">ActivityCompat.<strong class="kb il">shouldShowRequestPermissionRationale()</strong></code>？</p><p id="cfb1" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">真的吗？</p><p id="ecaa" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">那些建议的“优雅降级”指导方针如何？在这些指导方针下，即使用户拒绝<em class="kv">某些</em>权限，应用程序仍应工作。</p><p id="f2af" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">显然，开发人员也应该关心确保应用程序保持功能，即使一些权限被授予，一些被拒绝。祝你在编写意大利面条代码时愉快。</p><p id="7881" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">“但是……但是……安东尼斯。有第三方库使得处理权限变得容易得多！”</p><p id="91fd" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">当然:一个精心制作的第一方API的标志是需要第三方库来使它可用。</p><h2 id="537d" class="kw kx ik bd ky kz la lb lc ld le lf lg ki lh li lj km lk ll lm kq ln lo lp lq dt translated">停下你正在做的事，我之前忘记问你了！</h2><p id="014d" class="pw-post-body-paragraph jz ka ik kb b kc lr jl ke kf ls jo kh ki lt kk kl km lu ko kp kq lv ks kt ku hn dt translated">作为一个用户，运行时权限也会变得非常烦人，非常快。</p><p id="fec3" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">想象一下，安装了那个闪亮的新相机应用程序，突然发现一只鹿在吃一只狼。或者猫追狗。或者特朗普尊重女性。你想当场就拍下那张照片！所以你按下快门按钮，让混蛋大吃一惊！</p><figure class="lx ly lz ma fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mf"><img src="../Images/df47aec1cd0e95dc677dcef5cdd37860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1_p0mv3GrkshnkRu7NeZKg.png"/></div></div><figcaption class="id ie fg fe ff if ig bd b be z ek">App name redacted under instructions from Shub-Niggurath</figcaption></figure><p id="138f" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">这个时刻已经过去了。</p><p id="a7c3" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">鹿又开始假装它不是邪恶的化身。狗已经跑了，唐纳德又开始不管三七二十一抓阴道了。</p><p id="acdb" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">你可以争辩说这是开发商的错:他们本可以更早地请求许可。但是更早的<em class="kv">什么时候</em>？在应用程序发布时？这是什么样的用户体验？如果用户在这之前还没有启动应用程序呢？</p><p id="564a" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">另一个真正困扰我的方面是一些应用程序的流动突然中断，几乎是粗鲁的。</p><p id="e90e" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">例如，用我的应用程序Veterondo ( <a class="ae mg" href="https://play.google.com/store/apps/details?id=com.saladdressing.veterondo" rel="noopener ugc nofollow" target="_blank"> Play Store </a>，<a class="ae mg" href="https://github.com/Antonis427/veterondo" rel="noopener ugc nofollow" target="_blank"> Github </a>)我试图做一个时尚、简约的天气应用程序。第一次打开应用程序时，你会得到一个动画介绍，然后第二个活动会显示实际信息。</p><p id="5492" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">尽管我很想让应用程序流畅地从一个屏幕切换到另一个屏幕，但我做不到:我必须请求某个地方的位置许可。在应用程序启动时，它破坏了气氛(安装应用程序，看看:想象一下，你首先得到的不是开场动画，而是一个侵入性的弹出窗口和<em class="kv">然后是</em>动画)。同样的事情在两个屏幕之间，但我不得不妥协。</p><p id="2c50" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">不仅如此，因为你不能设置对话框的样式(这是可以理解的，至少——它必须看起来像一个系统级的东西),弹出窗口在试图看起来与众不同的应用程序中看起来很不合适。</p><h2 id="3c2e" class="kw kx ik bd ky kz la lb lc ld le lf lg ki lh li lj km lk ll lm kq ln lo lp lq dt translated">所以，你的解决办法是什么，聪明人？</h2><p id="ce2f" class="pw-post-body-paragraph jz ka ik kb b kc lr jl ke kf ls jo kh ki lt kk kl km lu ko kp kq lv ks kt ku hn dt translated">逻辑上说，我不一定要想出一个更好的解决方案，才能被允许批评谷歌的做法。然而，这里有一些我想到的解决办法</p><ul class=""><li id="eda6" class="mh mi ik kb b kc kd kf kg ki mj km mk kq ml ku mm mn mo mp dt translated">允许用户选择在安装时授予所有必需的权限，或者为受虐者提供一个随用随授的模式</li><li id="dfdc" class="mh mi ik kb b kc mq kf mr ki ms km mt kq mu ku mm mn mo mp dt translated">如果你担心应用程序会开始做一些事情，而不是显示一个该死的弹出窗口，你会向用户显示一个正在进行的通知，说“[在此输入应用程序名称]当前正在录制音频”怎么样？请注意，我并不是不讨厌正在进行的通知，但是您并不认为为后台进程这样做是不值得的。额外酱:使它成为一个可操作的通知，让用户禁用通知的行为。不客气</li><li id="469f" class="mh mi ik kb b kc mq kf mr ki ms km mt kq mu ku mm mn mo mp dt translated">打开一个浮动终端窗口，让用户输入</li></ul><pre class="lx ly lz ma fq mv me mw mx aw my dt"><span id="21a7" class="kw kx ik me b fv mz na l nb nc">sudo grant PERMISSION_NAME</span></pre><p id="0582" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">这仍然很烦人，但至少他们会觉得自己像个黑客。</p><p id="2fae" class="pw-post-body-paragraph jz ka ik kb b kc kd jl ke kf kg jo kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">或者你知道吗？也许谷歌的工程师和UX专家大军可以用一种比一个业余时间在媒体上敲键盘更好的方式来解决这个问题。随便说说。</p><figure class="lx ly lz ma fq hw"><div class="bz el l di"><div class="nd ne l"/></div></figure></div></div>    
</body>
</html>