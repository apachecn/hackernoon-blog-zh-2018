<html>
<head>
<title>Migrating to React-Redux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迁移到React-Redux</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/migrating-to-react-redux-9b3d8e4b15fd?source=collection_archive---------31-----------------------#2018-02-19">https://medium.com/hackernoon/migrating-to-react-redux-9b3d8e4b15fd?source=collection_archive---------31-----------------------#2018-02-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/470272365847aa95abe5c430127bf664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dkvk5eK3LEANzI-Lu60GNw.jpeg"/></div></div></figure><p id="63e3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">跟我重复“我不需要<a class="ae ka" href="https://hackernoon.com/tagged/redux" rel="noopener ugc nofollow" target="_blank"> Redux </a>”。说真的，你可能不知道。在我们开始添加带有复杂验证的更复杂的表单之前，我们在SPA中并不需要Redux。你可以很容易地不用Redux编写一个<a class="ae ka" href="https://hackernoon.com/tagged/react" rel="noopener ugc nofollow" target="_blank"> React </a> SPA。可以在页面级别(或者更高级别，如果您愿意)管理状态。不用Redux也能轻松创建React app。然而，当复杂的验证出现时，我们决定需要Redux。我们认为最好是从页面中提取出这种逻辑，将其转化为动作和缩减器。</p><figure class="kc kd ke kf fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kb"><img src="../Images/3040bc10e0e740246a104535426a506f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XITqOabGC7FelP1I."/></div></div></figure><h1 id="19c2" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">该过程</h1><p id="0970" class="pw-post-body-paragraph jc jd hu je b jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv li jx jy jz hn dt translated">当我们第一次开始使用Redux时，我们不知道自己在做什么。我们已经用React编程7-8个月了。这是一个全新的想法。这是一场全新的比赛。怎么从React到Redux？对我们来说，你要一个部件一个部件地做。我们还有很多页面不在Redux中，因为我们不需要接触这些页面。为什么要改变运行良好的东西呢？显然，如果我们确实需要重用其他页面，我们也会使它们冗余。这对我们来说已经成了家常便饭。</p><p id="5c07" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们是如何做到Redux的，就是我们让我们的页面变成了无状态的。这很容易做到，因为我们的大多数组件都是无状态的。然后我们用我们称之为容器的东西把这些纸包起来。这个容器与我们的减速器和动作有联系。这意味着我们已经能够保持组件的可视化，没有复杂的状态。容器看起来像什么？</p><p id="852e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">假设您有一个如下所示的React组件。</p><pre class="kc kd ke kf fq lj lk ll lm aw ln dt"><span id="7be0" class="lo kh hu lk b fv lp lq l lr ls">import * as React from 'react';<br/>import { Button } from 'react-bootstrap';</span><span id="c97b" class="lo kh hu lk b fv lt lq l lr ls">interface MyProps {<br/>    onButtonClick: () =&gt; void;<br/>    name: string;<br/>}</span><span id="3d85" class="lo kh hu lk b fv lt lq l lr ls">export const MyComponent: React.StatelessComponent&lt;MyProps&gt; = (props) =&gt; {<br/>    return (<br/>        &lt;div&gt;<br/>           &lt;span&gt;{props.name}&lt;/span&gt;<br/>           &lt;Button onClick={props.onButtonClick} /&gt;<br/>        &lt;/div&gt;<br/>    );<br/>};</span></pre><p id="8ddb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它必须从某个地方得到状态，对吗？这就是容器出现的地方。</p><pre class="kc kd ke kf fq lj lk ll lm aw ln dt"><span id="a61e" class="lo kh hu lk b fv lp lq l lr ls">import * as React from 'react';<br/>import { MyComponent } from './MyComponent';<br/>import { State } from './reducer';<br/>import { Dispatch, connect } from 'react-redux';<br/>import { onButtonClick } from './actions';</span><span id="8c3e" class="lo kh hu lk b fv lt lq l lr ls">type StateToProps = {<br/>    name: string;<br/>};</span><span id="ec51" class="lo kh hu lk b fv lt lq l lr ls">const mapStateToProps = (state: State): StateToProps =&gt; {<br/>    return {<br/>        name: state.name,<br/>    };<br/>};</span><span id="b647" class="lo kh hu lk b fv lt lq l lr ls">type DispatchToProps = {<br/>    onButtonClick(): void;<br/>};</span><span id="5256" class="lo kh hu lk b fv lt lq l lr ls">const mapDispatchToProps = (dispatch: Dispatch&lt;State&gt;): DispatchToProps =&gt; ({<br/>    onButtonClick() {<br/>        dispatch(onButtonClick())<br/>    },<br/>});</span><span id="6f9a" class="lo kh hu lk b fv lt lq l lr ls">export type MyComponentContainerProps = StateToProps &amp; DispatchToProps;</span><span id="97de" class="lo kh hu lk b fv lt lq l lr ls">export class MyComponentContainer extends React.Component&lt;MyComponentContainerProps, {}&gt;{</span><span id="bc4b" class="lo kh hu lk b fv lt lq l lr ls">render() {<br/>        return (<br/>            &lt;MyComponent<br/>                name={this.props.name}<br/>                onButtonClick={this.props.onButtonClick}<br/>            /&gt;<br/>        );<br/>    }       <br/>};</span><span id="cd01" class="lo kh hu lk b fv lt lq l lr ls">export default connect(mapStateToProps, mapDispatchToProps)(MyComponentContainerContainer);</span></pre><p id="e704" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">容器连接到你的减速器，减速器是你的状态守护者。任何改变你状态的东西都必须来自你的减压器。减速器是如何获得变化的？</p><pre class="kc kd ke kf fq lj lk ll lm aw ln dt"><span id="3f95" class="lo kh hu lk b fv lp lq l lr ls">import { handleActions, Action } from 'redux-actions';</span><span id="bcae" class="lo kh hu lk b fv lt lq l lr ls">export const CHANGE_NAME = 'MYCOMPONENT.CHANGE_NAME';</span><span id="3348" class="lo kh hu lk b fv lt lq l lr ls">export interface State {<br/>    name: string;<br/>}</span><span id="1fca" class="lo kh hu lk b fv lt lq l lr ls">export const initialState: State = {<br/>    name: 'John',<br/>}</span><span id="185e" class="lo kh hu lk b fv lt lq l lr ls">export const myComponentReducer = handleActions&lt;State, string&gt;({<br/>    [CHANGE_NAME]: (state, action: Action&lt;string&gt;) =&gt; {<br/>        return {<br/>            ...state,<br/>            name: action.payload,<br/>        };<br/>    },<br/>}, initialState);</span></pre><p id="97cc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这就是行动的由来。动作向你的缩减器发送消息说“嘿，我有这个事件。它在这里有这个变化。做你想做的。”我们可以看到该事件与上面的reducer中的字符串相同，所以当调用该动作时，它将触发reducer上的状态变化。</p><pre class="kc kd ke kf fq lj lk ll lm aw ln dt"><span id="2ea1" class="lo kh hu lk b fv lp lq l lr ls">import { CHANGE_NAME } from './State';<br/>import { Dispatch } from 'react-redux';<br/>import { createAction } from 'redux-actions';</span><span id="7aae" class="lo kh hu lk b fv lt lq l lr ls">const onButtonClickAction = createAction(CHANGE_NAME, (name: string) =&gt; name);</span><span id="a1eb" class="lo kh hu lk b fv lt lq l lr ls">export const onButtonClick = () =&gt; {<br/>    return (dispatch: Dispatch&lt;string&gt;) =&gt; {<br/>        dispatch(onButtonClickAction('new name'));<br/>    };<br/>};</span></pre><p id="a14c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您还需要做其他事情，如添加提供商和创建商店等。但是你可以在<a class="ae ka" href="https://redux.js.org/" rel="noopener ugc nofollow" target="_blank"> Redux </a>上查到。</p><h1 id="0079" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">摘要</h1><p id="e268" class="pw-post-body-paragraph jc jd hu je b jf le jh ji jj lf jl jm jn lg jp jq jr lh jt ju jv li jx jy jz hn dt translated">从上面的例子可以看出，这确实给你的解决方案增加了许多样板代码。如果你认为你不需要Redux，那么你很可能不需要。在我的下一篇文章中，我将讨论React-Redux-Forms。React中的验证工作相当多，但是React-Redux-Forms确实帮助我们最小化了组件中的噪声，这样我们就有了漂亮、干净的代码，任何人都可以很快阅读并获得要点。</p><p id="cfe6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我知道你们是如何使用Redux的。我很想听听，看看我们能否有所改进。</p></div><div class="ab cl lu lv hc lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hn ho hp hq hr"><p id="0e55" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="mb">原载于2018年2月19日</em><a class="ae ka" href="https://www.alexaitken.nz/blog/migrating-to-react-redux/" rel="noopener ugc nofollow" target="_blank"><em class="mb">www . alexaitken . NZ</em></a><em class="mb">。</em></p><figure class="kc kd ke kf fq iv"><div class="bz el l di"><div class="mc md l"/></div></figure></div></div>    
</body>
</html>