<html>
<head>
<title>Copying text to clipboard with JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript将文本复制到剪贴板</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/copying-text-to-clipboard-with-javascript-df4d4988697f?source=collection_archive---------0-----------------------#2018-02-20">https://medium.com/hackernoon/copying-text-to-clipboard-with-javascript-df4d4988697f?source=collection_archive---------0-----------------------#2018-02-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="99a4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">在这篇文章中，我将深入解释来自</em> <a class="ae ju" href="https://github.com/Chalarangelo/30-seconds-of-code" rel="noopener ugc nofollow" target="_blank"> <em class="jp"> 30秒代码</em> </a> <em class="jp">的</em> <code class="eh jq jr js jt b"><em class="jp">copyToClipboard</em></code> <em class="jp">片段是如何工作的。您可以在项目的资源库中找到它的源代码和大量其他有用的方法。</em></p><figure class="jw jx jy jz fq ka fe ff paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="fe ff jv"><img src="../Images/be78f80e446c27f86a970a2e05771371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f2eZ4JeqO2TMkuNwwVN4gg.png"/></div></div><figcaption class="kh ki fg fe ff kj kk bd b be z ek"><strong class="bd kl">30 seconds of code:</strong> Javascript snippets that you can understand in 30 seconds or less</figcaption></figure><h2 id="8155" class="km kn hu bd ko kp kq kr ks kt ku kv kw jc kx ky kz jg la lb lc jk ld le lf lg dt translated">核心功能</h2><p id="f165" class="pw-post-body-paragraph ir is hu it b iu lh iw ix iy li ja jb jc lj je jf jg lk ji jj jk ll jm jn jo hn dt translated">在<a class="ae ju" href="https://hackernoon.com/tagged/web-development" rel="noopener ugc nofollow" target="_blank">网站建设</a>中经常出现的一件事是将一些文本复制到剪贴板的能力，而不需要用户选择它或者在键盘上敲击合适的组合键。Javascript可以通过五个简单的步骤轻松做到这一点:</p><ol class=""><li id="ea5a" class="lm ln hu it b iu iv iy iz jc lo jg lp jk lq jo lr ls lt lu dt translated">创建一个要追加到文档中的<code class="eh jq jr js jt b">&lt;textarea&gt;</code>元素。将它的<code class="eh jq jr js jt b">value</code>设置为我们想要复制到剪贴板的字符串。</li><li id="87b0" class="lm ln hu it b iu lv iy lw jc lx jg ly jk lz jo lr ls lt lu dt translated">将所述<code class="eh jq jr js jt b">&lt;textarea&gt;</code>元素添加到当前HTML文档中。</li><li id="2a9a" class="lm ln hu it b iu lv iy lw jc lx jg ly jk lz jo lr ls lt lu dt translated">使用<code class="eh jq jr js jt b"><a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/select" rel="noopener ugc nofollow" target="_blank">HTMLInputElement.select()</a></code>选择<code class="eh jq jr js jt b">&lt;textarea&gt;</code>元素的内容。</li><li id="07d8" class="lm ln hu it b iu lv iy lw jc lx jg ly jk lz jo lr ls lt lu dt translated">使用<code class="eh jq jr js jt b"><a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand#Commands" rel="noopener ugc nofollow" target="_blank">Document.execCommand('copy')</a></code>将<code class="eh jq jr js jt b">&lt;textarea&gt;</code>的内容复制到剪贴板。</li><li id="1aeb" class="lm ln hu it b iu lv iy lw jc lx jg ly jk lz jo lr ls lt lu dt translated">从文档中移除<code class="eh jq jr js jt b">&lt;textarea&gt;</code>元素。</li></ol><p id="f3ca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这个方法的最简单版本应该是这样的:</p><figure class="jw jx jy jz fq ka"><div class="bz el l di"><div class="ma mb l"/></div><figcaption class="kh ki fg fe ff kj kk bd b be z ek">copyToClipboard method basic implementation</figcaption></figure><p id="fde5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请记住，由于<code class="eh jq jr js jt b">Document.execCommand()</code>的工作方式，这种方法不会在任何地方都有效，而只是作为用户操作的结果(比如在<code class="eh jq jr js jt b">click</code>事件监听器内部)。</p><h2 id="8296" class="km kn hu bd ko kp kq kr ks kt ku kv kw jc kx ky kz jg la lb lc jk ld le lf lg dt translated">使附加的元素不可见</h2><p id="400c" class="pw-post-body-paragraph ir is hu it b iu lh iw ix iy li ja jb jc lj je jf jg lk ji jj jk ll jm jn jo hn dt translated">如果您尝试上面的方法，您可能会看到一些闪烁，当<code class="eh jq jr js jt b">&lt;textarea&gt;</code>元素被追加然后移除时。这个问题对于使用屏幕阅读器的人来说尤其糟糕，因为它会导致一些非常烦人的问题。因此，下一个合乎逻辑的步骤是使用一些CSS使这个元素不可见，并使它成为<code class="eh jq jr js jt b">readonly</code>以防用户试图弄乱它:</p><figure class="jw jx jy jz fq ka"><div class="bz el l di"><div class="ma mb l"/></div><figcaption class="kh ki fg fe ff kj kk bd b be z ek">copyToClipboard implementation without the textarea being shown</figcaption></figure><h2 id="5eee" class="km kn hu bd ko kp kq kr ks kt ku kv kw jc kx ky kz jg la lb lc jk ld le lf lg dt translated">保存和恢复原始文档的选择</h2><p id="6206" class="pw-post-body-paragraph ir is hu it b iu lh iw ix iy li ja jb jc lj je jf jg lk ji jj jk ll jm jn jo hn dt translated">最后要考虑的是，用户可能已经选择了HTML文档中的一些内容，所以最好不要删除他们可能已经选择的任何内容。幸运的是，我们现在可以使用一些现代的Javascript方法和属性，如<code class="eh jq jr js jt b"><a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/API/DocumentOrShadowRoot/getSelection" rel="noopener ugc nofollow" target="_blank">DocumentOrShadowRoot.getSelection()</a></code>、<code class="eh jq jr js jt b"><a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/API/Selection/rangeCount" rel="noopener ugc nofollow" target="_blank">Selection.rangeCount</a></code>、<code class="eh jq jr js jt b"><a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/API/Selection/getRangeAt" rel="noopener ugc nofollow" target="_blank">Selection.getRangeAt()</a></code>、<code class="eh jq jr js jt b"><a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/API/Selection/removeAllRanges" rel="noopener ugc nofollow" target="_blank">Selection.removeAllRanges()</a></code>和<code class="eh jq jr js jt b"><a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/API/Selection/addRange" rel="noopener ugc nofollow" target="_blank">Selection.addRange()</a></code>来保存和恢复原始的文档选择。下面是实现这些改进的最终带注释的代码:</p><figure class="jw jx jy jz fq ka"><div class="bz el l di"><div class="ma mb l"/></div><figcaption class="kh ki fg fe ff kj kk bd b be z ek">Final form of copyToClipboard with selection storing</figcaption></figure><p id="56de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">差不多就是这些了。在不到20行代码中，我们创建了前端开发中最常用的方法之一。</p></div><div class="ab cl mc md hc me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hn ho hp hq hr"><p id="c9ab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">如果你喜欢这篇文章，给它一个掌声(或者五十个),记得查看</em> <a class="ae ju" href="https://github.com/Chalarangelo/30-seconds-of-code" rel="noopener ugc nofollow" target="_blank"> <em class="jp"> 30秒代码</em> </a> <em class="jp">为你的Javascript项目获取更多有用的代码片段！</em></p><figure class="jw jx jy jz fq ka"><div class="bz el l di"><div class="mj mb l"/></div></figure></div></div>    
</body>
</html>