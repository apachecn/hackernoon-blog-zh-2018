<html>
<head>
<title>How to use Sass string replacement to animate changes in an SVG</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Sass字符串替换来动态显示SVG中的变化</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-use-sass-string-replacement-to-animate-changes-in-an-svg-3ecdfc53ea91?source=collection_archive---------14-----------------------#2018-02-20">https://medium.com/hackernoon/how-to-use-sass-string-replacement-to-animate-changes-in-an-svg-3ecdfc53ea91?source=collection_archive---------14-----------------------#2018-02-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/38450c9b0267ed3fc38a286838873656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDZmGL23W31oCwVl5nxogA.jpeg"/></div></div></figure><p id="6b54" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有时，我希望有一个SVG作为URL编码的<code class="eh ka kb kc kd b">background-image: url(path/to/your.svg);</code>，通常在伪元素上(<a class="ae ke" href="https://codepen.io/tigt/post/optimizing-svgs-in-data-uris" rel="noopener ugc nofollow" target="_blank">参见泰勒·亨特斯关于URL编码SVG的文章</a>)。我喜欢这样做，因为这意味着我的SVG在我的样式表中，并为我节省了一个额外的服务器请求。我使用Sass运行一个字符串替换函数来编辑SVG的代码，从而使它具有动画效果。很酷吧？！下面的例子展示了如何将这种技术应用到一个只有单一填充颜色的简单SVG中。</p><figure class="kf kg kh ki fq iv"><div class="bz el l di"><div class="kj kk l"/></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Codepen example of Sass string replacement on an SVG — <a class="ae ke" href="https://codepen.io/stuartjnelson/full/xYOXRZ/" rel="noopener ugc nofollow" target="_blank">https://codepen.io/stuartjnelson/full/xYOXRZ/</a></figcaption></figure><h2 id="b606" class="kp kq hu bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">我们要做什么</h2><ol class=""><li id="ffc1" class="lk ll hu je b jf lm jj ln jn lo jr lp jv lq jz lr ls lt lu dt translated">导出并优化<a class="ae ke" href="https://hackernoon.com/tagged/svg" rel="noopener ugc nofollow" target="_blank"> SVG </a>，使其尽可能小</li><li id="f14d" class="lk ll hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">使用<a class="ae ke" href="http://yoksel.github.io/url-encoder/" rel="noopener ugc nofollow" target="_blank"> SVG URL-encoder </a>对SVG进行编码，以便可以在您的<code class="eh ka kb kc kd b">.scss</code>文件中使用</li><li id="34ee" class="lk ll hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">使用<a class="ae ke" href="https://hugogiraudel.com/2014/01/13/sass-string-replacement-function/" rel="noopener ugc nofollow" target="_blank"> Hugo Giraude的</a>字符串替换功能来更改SVG</li><li id="d1fd" class="lk ll hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">创建一个mixin来调用字符串替换函数并输出<a class="ae ke" href="https://hackernoon.com/tagged/css" rel="noopener ugc nofollow" target="_blank"> CSS </a></li></ol><h1 id="502d" class="ma kq hu bd kr mb mc md kv me mf mg kz mh mi mj lc mk ml mm lf mn mo mp li mq dt translated">1.导出和优化SVG</h1><p id="3e44" class="pw-post-body-paragraph jc jd hu je b jf lm jh ji jj ln jl jm jn mr jp jq jr ms jt ju jv mt jx jy jz hn dt translated">从你最喜欢的图形编辑器导出的SVG总是有一堆我们不需要的信息。我个人认为Adobe Illustrators SVG export是最干净的，但是可以随意使用你选择的任何编辑器。</p><p id="717b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">通过选择画板工具并双击我的SVG，我将画板裁剪到SVG的边缘。</p><figure class="kf kg kh ki fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mu"><img src="../Images/fcf3ed75dd2ba1738f93c805ed1796a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CEHl6ikZih6XbOsTMf3zfw.jpeg"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Using the Artboard Tool to exactly crop the artboard to the graphic</figcaption></figure><p id="63cd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后我想有一个单一的路径，因为我的SVG只有一种填充颜色。我为我的SVG选择父组，并使用Mac上的<code class="eh ka kb kc kd b">cmd + 8</code>或Windows上的<code class="eh ka kb kc kd b">ctlr + 8</code>将其转换为复合路径。</p><figure class="kf kg kh ki fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mu"><img src="../Images/7dbec7387f728ba05f263c638d471384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tjOXZIf8BpLfkDr4d5lQnA.jpeg"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Combining the groups/layers into a single compound path</figcaption></figure><p id="a7fe" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">导出SVG后，在文本编辑器中打开它，您应该会看到类似这样的代码。</p><figure class="kf kg kh ki fq iv"><div class="bz el l di"><div class="mv kk l"/></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">My SVG exported straight from Adobe Illustrator — <a class="ae ke" href="https://gist.github.com/stuartjnelson/dec1d06046e82fc0dc9492706c18311d" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/stuartjnelson/dec1d06046e82fc0dc9492706c18311d</a></figcaption></figure><h2 id="ede3" class="kp kq hu bd kr ks kt ku kv kw kx ky kz jn la lb lc jr ld le lf jv lg lh li lj dt translated">优化导出的SVG</h2><p id="e69f" class="pw-post-body-paragraph jc jd hu je b jf lm jh ji jj ln jl jm jn mr jp jq jr ms jt ju jv mt jx jy jz hn dt translated">这个SVG没有像我希望的那样优化。下面列出了一些优化SVG的选项。</p><ol class=""><li id="2a7d" class="lk ll hu je b jf jg jj jk jn mw jr mx jv my jz lr ls lt lu dt translated">使用SVGO CLI从命令行进行优化。查看我关于如何为SVGO CLI设置bash别名的演练</li><li id="bc0c" class="lk ll hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">在浏览器中使用杰克·阿奇博尔德的牛逼软件<a class="ae ke" href="https://jakearchibald.github.io/svgomg/" rel="noopener ugc nofollow" target="_blank"> SVGO GUI </a></li><li id="49ab" class="lk ll hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">使用文本编辑器手动编辑SVG。</li></ol><p id="1a37" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于一个简单的SVG，比如我们正在使用的例子，我会在SVGO GUI上运行它，然后编辑一些东西。当在CSS中使用SVG时，我喜欢确保始终保留ViewBox。我在过去遇到过SVG变得非常小并且没有<code class="eh ka kb kc kd b">viewBox</code>属性的问题。在SVGO图形用户界面的偏好列表底部有一个选项可以做到这一点，并且移除了<code class="eh ka kb kc kd b">width</code>和<code class="eh ka kb kc kd b">height</code>属性。请看下面完成的SVG！</p><figure class="kf kg kh ki fq iv fe ff paragraph-image"><div class="fe ff mz"><img src="../Images/2f857eef1d745a3ec946e9c0162eb000.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*jXnc1aYT4Xinrijub0lNzA.png"/></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">SVGO GUI option to keep the viewBox attribute but to remove width &amp; height</figcaption></figure><figure class="kf kg kh ki fq iv"><div class="bz el l di"><div class="mv kk l"/></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">SVGO GUI optimised SVG</figcaption></figure><figure class="kf kg kh ki fq iv"><div class="bz el l di"><div class="mv kk l"/></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">SVGO GUI optimised SVG that I then manually removed `data-name` from</figcaption></figure><h1 id="4811" class="ma kq hu bd kr mb mc md kv me mf mg kz mh mi mj lc mk ml mm lf mn mo mp li mq dt translated">2.数据对SVG进行编码，以便在SCSS使用</h1><p id="969e" class="pw-post-body-paragraph jc jd hu je b jf lm jh ji jj ln jl jm jn mr jp jq jr ms jt ju jv mt jx jy jz hn dt translated">我没有对SVG进行64进制编码，因为正如Taylor Hunt指出的那样，没有必要使用T11(它实际上会使SVG变得更大)。我在浏览器中使用Yoksel的<a class="ae ke" href="http://yoksel.github.io/url-encoder/" rel="noopener ugc nofollow" target="_blank"> SVGO URL编码</a>工具对我的SVG进行URL编码。只需粘贴您的SVG和嘣你得到它的编码回来。对于步骤4，您只需要准备好CSS文本<em class="na">中的<code class="eh ka kb kc kd b">url()</code>中的所有内容。</em></p><figure class="kf kg kh ki fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nb"><img src="../Images/13df38dfa5a9a463d268fcb839b0f1dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2v6vSwwNN0pchsOiD3Ss3w.png"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek"><a class="ae ke" href="http://css.yoksel.ru/" rel="noopener ugc nofollow" target="_blank">Yoksel’s</a> SVG URI-encode tool is free, fast and awesome</figcaption></figure><h1 id="11fb" class="ma kq hu bd kr mb mc md kv me mf mg kz mh mi mj lc mk ml mm lf mn mo mp li mq dt translated">3.字符串替换功能</h1><p id="e0ee" class="pw-post-body-paragraph jc jd hu je b jf lm jh ji jj ln jl jm jn mr jp jq jr ms jt ju jv mt jx jy jz hn dt translated"><a class="ae ke" href="https://hugogiraudel.com/2014/01/13/sass-string-replacement-function/" rel="noopener ugc nofollow" target="_blank"> Hugo Giraude发表了一篇关于使用Sass创建字符串替换函数的伟大文章</a>。我使用了他的函数的一个简单版本。请注意，传递给函数<em class="na">的字符串必须是用引号括起来的字符串。</em></p><figure class="kf kg kh ki fq iv"><div class="bz el l di"><div class="mv kk l"/></div></figure><h1 id="0962" class="ma kq hu bd kr mb mc md kv me mf mg kz mh mi mj lc mk ml mm lf mn mo mp li mq dt translated">4.创建一个函数和一个mixin来调用字符串替换函数并输出CSS</h1><p id="d7cf" class="pw-post-body-paragraph jc jd hu je b jf lm jh ji jj ln jl jm jn mr jp jq jr ms jt ju jv mt jx jy jz hn dt translated">我从编码器中复制了编码的SVG，并将其放入一个函数中，该函数负责通过调用字符串替换函数来替换我们的SVG的填充。这个函数，<code class="eh ka kb kc kd b">svg-color-string-modifier()</code>做了4件事；</p><ol class=""><li id="9653" class="lk ll hu je b jf jg jj jk jn mw jr mx jv my jz lr ls lt lu dt translated">检查你是否通过了一个论点(你可以进一步验证这一点，但我觉得没有必要)。</li><li id="91db" class="lk ll hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">然后，它会在您传入的颜色参数周围添加引号。</li><li id="7129" class="lk ll hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">然后，如果颜色中有杂凑，它会从颜色中移除杂凑(<code class="eh ka kb kc kd b">#</code>)。</li><li id="0473" class="lk ll hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">最后，它将SVG作为一个长字符串返回，其中插入了新的填充颜色。</li></ol><figure class="kf kg kh ki fq iv"><div class="bz el l di"><div class="mv kk l"/></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Sass function for modifying URL-encoded SVG’s fill propertiy</figcaption></figure><p id="a35b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我在编码的SVG上用<code class="eh ka kb kc kd b">fill="%23#{$svg-color}"</code>替换了<code class="eh ka kb kc kd b">fill="%23000000"</code>。<code class="eh ka kb kc kd b">%23</code>是<code class="eh ka kb kc kd b">#</code>符号的ULR编码版本。你可以在上面的代码片段中看到的散列是<a class="ae ke" href="https://webdesign.tutsplus.com/tutorials/all-you-ever-need-to-know-about-sass-interpolation--cms-21375" rel="noopener ugc nofollow" target="_blank">萨斯插值</a>。使用这个函数，我们现在可以动态地改变我们的SVG填充！</p><p id="90be" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后我创建一个mixin来输出<code class="eh ka kb kc kd b">background-image</code> CSS。</p><figure class="kf kg kh ki fq iv"><div class="bz el l di"><div class="mv kk l"/></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Sass mixin to output the SVG with your desired color</figcaption></figure><p id="c6f2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就是这样。我用本文中的所有代码创建了一个可用的Codepen示例。非常感谢<a class="ae ke" href="https://twitter.com/issunboshi" rel="noopener ugc nofollow" target="_blank">克里夫</a>(非常棒的全栈开发)&amp; <a class="ae ke" href="http://taavetkelle.co.uk/" rel="noopener ugc nofollow" target="_blank">塔维</a>(像UI/UX/前端开发这样的向导)帮助我改进这篇文章。任何问题/评论/bug/反馈请联系！感谢阅读。</p><figure class="kf kg kh ki fq iv"><div class="bz el l di"><div class="kj kk l"/></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Codepen example of Sass string replacement on an SVG — <a class="ae ke" href="https://codepen.io/stuartjnelson/full/xYOXRZ/" rel="noopener ugc nofollow" target="_blank">https://codepen.io/stuartjnelson/full/xYOXRZ/</a></figcaption></figure><figure class="kf kg kh ki fq iv"><div class="bz el l di"><div class="nc kk l"/></div></figure></div></div>    
</body>
</html>