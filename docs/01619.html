<html>
<head>
<title>“Run-From-Zip” with Cake Kudu Client</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与Cake Kudu客户端一起“从Zip运行”</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/run-from-zip-with-cake-kudu-client-5c063cd72b37?source=collection_archive---------23-----------------------#2018-02-20">https://medium.com/hackernoon/run-from-zip-with-cake-kudu-client-5c063cd72b37?source=collection_archive---------23-----------------------#2018-02-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="e8e9" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">部署Azure Web应用和功能应用的新方式</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/25f867cae796802cc7ca1ef5651dbdf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q-Gq7magBU3wtbLeeW4FCQ.png"/></div></div></figure><blockquote class="jv jw jx"><p id="aace" class="jy jz ka kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">更新！自从这篇文章发表以来，Azure App Services从Zip文件运行的功能有了一些突破性的变化，这个问题已经在Cake中得到解决。客户端版本0.6.0你可以在下面的帖子中了解更多</p></blockquote><div class="kv kw fm fo kx ky"><a rel="noopener follow" target="_blank" href="/@devlead/cake-kudu-client-version-0-6-0-released-cb6435629684"><div class="kz ab ej"><div class="la ab lb cl cj lc"><h2 class="bd hv fv z el ld eo ep le er et ht dt translated">蛋糕。Kudu.Client版本0.6.0发布</h2><div class="lf l"><h3 class="bd b fv z el ld eo ep le er et ek translated">此版本修复了Azure App Services从Zip运行web应用部署功能中的一个重大更改。</h3></div><div class="lg l"><p class="bd b gc z el ld eo ep le er et ek translated">medium.com</p></div></div><div class="lh l"><div class="li l lj lk ll lh lm jt ky"/></div></div></a></div><p id="1c75" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh ln kj kk kl lo kn ko kp lp kr ks kt ku hn dt translated">几天前，Azure宣布他们在preview中增加了一种新的部署应用服务的方式，叫做<a class="ae lq" href="https://github.com/Azure/app-service-announcements/issues/84" rel="noopener ugc nofollow" target="_blank"> Run-From-Zip </a>，可以让你使用Zip文件进行部署。</p><p id="f800" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh ln kj kk kl lo kn ko kp lp kr ks kt ku hn dt translated">与以前一样，使用zip文件进行部署，这种新方法的不同之处在于，该文件没有提取到“wwwroot”目录中，而是将zip文件<em class="ka">挂载为只读的“wwwroot”。</em></p><p id="6f12" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh ln kj kk kl lo kn ko kp lp kr ks kt ku hn dt translated">zip文件可以在网站外部托管，也可以在应用服务本身的一个特殊文件夹中托管，后者现在是“Kudu客户端”Cake addin现在支持的——使您能够在Cake构建脚本中使用这种新的部署方法。</p><h1 id="10f6" class="lr ls hu bd lt lu lv lw lx ly lz ma mb ja mc jb md jd me je mf jg mg jh mh mi dt translated">先决条件</h1><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mj"><img src="../Images/d0e35d6527917a3306dd0dc086e2c508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*5zpTL2QO9z2plg5eGNZbaQ.png"/></div></figure><p id="92c7" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh ln kj kk kl lo kn ko kp lp kr ks kt ku hn dt translated">要启用Run-From-Zip部署，您首先需要设置一个名为<code class="eh mk ml mm mn b">WEBSITE_USE_ZIP</code>的应用程序设置，您可以在从外部源部署时将其设置为一个url，或者在本例中将其设置为<code class="eh mk ml mm mn b">1</code>。</p><h1 id="e113" class="lr ls hu bd lt lu lv lw lx ly lz ma mb ja mc jb md jd me je mf jg mg jh mh mi dt translated">ZipRunFromDirectory</h1><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mo mp l"/></div></figure><p id="b58c" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh ln kj kk kl lo kn ko kp lp kr ks kt ku hn dt translated">给事物命名很难，但是插件现在有了一个名为<a class="ae lq" href="https://cakebuild.net/api/Cake.Kudu.Client.Extensions/KuduClientZipExtensions/AA111BEB" rel="noopener ugc nofollow" target="_blank">ziprunfromdirect</a>的方法，它将完成所有的“繁重工作”并部署一个本地目录。</p><h2 id="de36" class="mq ls hu bd lt mr ms mt lx mu mv mw mb ln mx my md lo mz na mf lp nb nc mh nd dt translated">用法示例</h2><p id="8649" class="pw-post-body-paragraph jy jz hu kb b kc ne iv ke kf nf iy kh ln ng kk kl lo nh ko kp lp ni ks kt ku hn dt translated">所以使用这种新方法部署一个站点只需要几行代码</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mo mp l"/></div></figure><p id="ee6e" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh ln kj kk kl lo kn ko kp lp kr ks kt ku hn dt translated">返回的文件路径是部署到应用程序服务的zip文件。</p><h2 id="b369" class="mq ls hu bd lt mr ms mt lx mu mv mw mb ln mx my md lo mz na mf lp nb nc mh nd dt translated">秘密地</h2><p id="2d03" class="pw-post-body-paragraph jy jz hu kb b kc ne iv ke kf nf iy kh ln ng kk kl lo nh ko kp lp ni ks kt ku hn dt translated">那么这里到底发生了什么？<br/>简而言之，该方法将:</p><ol class=""><li id="9a7e" class="nj nk hu kb b kc kd kf kg ln nl lo nm lp nn ku no np nq nr dt translated">内存中的zip源目录</li><li id="2a01" class="nj nk hu kb b kc ns kf nt ln nu lo nv lp nw ku no np nq nr dt translated">将zip压缩到<code class="eh mk ml mm mn b">d:\home\data\SitePackages</code>中一个唯一的带有日期戳的文件名</li><li id="2064" class="nj nk hu kb b kc ns kf nt ln nu lo nv lp nw ku no np nq nr dt translated">将压缩文件的文件名推送到<code class="eh mk ml mm mn b">d:\home\data\SitePackages\siteversion.txt</code></li><li id="469d" class="nj nk hu kb b kc ns kf nt ln nu lo nv lp nw ku no np nq nr dt translated">通过Kudu API调用该站点以确保它是已部署的正确版本(为此，在已部署的zip中包含了一个名为<code class="eh mk ml mm mn b">KuduClientZipRunFromDirectoryVersion.txt</code>的文件)</li><li id="df7f" class="nj nk hu kb b kc ns kf nt ln nu lo nv lp nw ku no np nq nr dt translated">返回部署的zip的远程路径</li></ol><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nx"><img src="../Images/4153d310599021ec58aa5cbafbeb3c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V-B2mL_XY1NSZ7qGKNklFw.png"/></div></div></figure><h1 id="929b" class="lr ls hu bd lt lu lv lw lx ly lz ma mb ja mc jb md jd me je mf jg mg jh mh mi dt translated">结束语</h1><p id="3918" class="pw-post-body-paragraph jy jz hu kb b kc ne iv ke kf nf iy kh ln ng kk kl lo nh ko kp lp ni ks kt ku hn dt translated">我已经试了几天了，发现部署非常稳定和快速。但是真的需要更多的测试来看看在生产中运行这个会有什么影响，现有的应用程序在只读模式下会有什么表现，等等。</p><p id="2624" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh ln kj kk kl lo kn ko kp lp kr ks kt ku hn dt translated">这是一个闪亮的新特性，仍然在预览中，一般的指导和工具支持还没有完全到位，但正如你在这篇文章中看到的，原语已经到位，可以在未来建立和完善体验！</p><div class="kv kw fm fo kx ky"><a href="https://hackernoon.com/introducing-cake-kudu-client-abda40d15f38" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab ej"><div class="la ab lb cl cj lc"><h2 class="bd hv fv z el ld eo ep le er et ht dt translated">介绍Cake Kudu客户端</h2><div class="lf l"><h3 class="bd b fv z el ld eo ep le er et ek translated">使用Cake远程发送到Azure应用服务</h3></div><div class="lg l"><p class="bd b gc z el ld eo ep le er et ek translated">hackernoon.com</p></div></div></div></a></div></div></div>    
</body>
</html>