<html>
<head>
<title>AWS OpenVPN Access Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS OpenVPN访问服务器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/aws-openvpn-access-server-c9edaece035a?source=collection_archive---------8-----------------------#2018-02-26">https://medium.com/hackernoon/aws-openvpn-access-server-c9edaece035a?source=collection_archive---------8-----------------------#2018-02-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/3b1b69659fc5c4275e38622d11be05d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CXNQW2ZhXOKhjBHMqxPT0A.jpeg"/></div></div></figure><p id="6013" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">能够以安全的方式直接访问<strong class="je hv"> AWS </strong>资源非常有用。为此，您可以:</p><ul class=""><li id="11e9" class="ka kb hu je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">设置与<strong class="je hv"> AWS直连</strong>的专用连接</li><li id="9766" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">使用<strong class="je hv">网络设备</strong></li><li id="e123" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">使用<strong class="je hv">软件定义的专用网络</strong>，如<strong class="je hv"> OpenVPN </strong></li></ul><p id="1b5e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这篇文章中，我将带你了解如何在AWS上创建一个<strong class="je hv"> OpenVPN </strong>服务器，从任何地方的任何设备安全地连接到你的VPC、私有网络资源和应用程序。</p><p id="a8c6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，登录您的<strong class="je hv"> AWS管理控制台</strong>并从<strong class="je hv">OpenVPN Access Server AWS market place</strong>产品中启动一个<strong class="je hv"> EC2实例</strong>:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ko"><img src="../Images/d2f8de614ff169b770ad9ea9dcfb80cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RxIGQWMzZ4CddqT0."/></div></div></figure><p id="4dc3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">出于演示目的，选择<em class="kt"> t2.micro: </em></p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ku"><img src="../Images/e488f232a814cf03c40e9f3bb7b44ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wPgYMoC0t73N4aoY."/></div></div></figure><p id="4126" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用除“<strong class="je hv">启用终止保护</strong>之外的默认设置，因为我们不希望我们的<strong class="je hv"> VPN </strong>被意外终止:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kv"><img src="../Images/553c2e1f478a5753b6f115b19a9c8eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x3v8Khtz7PCZ8f3H."/></div></div></figure><p id="59c6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">分配一个新的<strong class="je hv">安全组</strong>，如下所示:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kw"><img src="../Images/a25084f32ebb0dc5eda670878d5763fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LsR4IAfGXXfuIBcV."/></div></div></figure><ul class=""><li id="ea99" class="ka kb hu je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated"><strong class="je hv"> TCP — 22 </strong>:远程访问实例。</li><li id="6904" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated"><strong class="je hv"> TCP — 443 </strong> : HTTPS，这是用户用来登录VPN服务器并检索他们的密钥和安装信息的接口。</li><li id="7255" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated"><strong class="je hv"> TCP — 943 </strong> : OpenVPN管理Web Dashboard。</li><li id="2bc5" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated"><strong class="je hv"> UDP — 1194 </strong> : OpenVPN UDP端口。</li></ul><p id="2f45" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了确保我们的VPN实例公共IP地址在停止后不会改变，为其分配一个<strong class="je hv">弹性IP </strong>:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kx"><img src="../Images/4f053a2e28876cfe7c6787483e0897f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tjptbp-B9P0YO2Tw."/></div></div></figure><p id="d7b9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了简单起见，我在<strong class="je hv"> Route 53 </strong>中添加了一个<strong class="je hv"> A </strong>记录，它指向实例<strong class="je hv">弹性IP </strong>:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div class="fe ff ky"><img src="../Images/e4742f379d0f5437a884a6f16816de3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/0*gyYVtEyL0GdB3Goz."/></div></figure><p id="5d72" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦<strong class="je hv"> AMI </strong>成功启动，您将需要使用<strong class="je hv"> DNS </strong>记录通过<strong class="je hv"> SSH </strong>连接到服务器:</p><blockquote class="kz la lb"><p id="77a7" class="jc jd kt je b jf jg jh ji jj jk jl jm lc jo jp jq ld js jt ju le jw jx jy jz hn dt translated">宋承宪<a class="ae lf" href="mailto:openvpnas@openvpn.slowcoder.com" rel="noopener ugc nofollow" target="_blank">openvpnas@openvpn.slowcoder.com</a>-I/path/to/key . PEM</p></blockquote><p id="4a66" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首次连接时，系统会提示您设置OpenVPN服务器:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lg"><img src="../Images/65dc9c291144c9c59f9d3605b724490a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UaM_RebtMcLorGPS."/></div></div></figure><p id="863c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为<em class="kt"> openvpn </em>管理员用户设置新密码:</p><blockquote class="kz la lb"><p id="bf77" class="jc jd kt je b jf jg jh ji jj jk jl jm lc jo jp jq ld js jt ju le jw jx jy jz hn dt translated">sudo passwd openvpn</p></blockquote><p id="6c8c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将浏览器指向<a class="ae lf" href="https://openvpn.slowcoder.com/" rel="noopener ugc nofollow" target="_blank">https://openvpn.slowcoder.com</a>，并使用<em class="kt"> openvpn </em>凭证登录</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lh"><img src="../Images/41623301e6096bbb427ebccea881b9d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8lAgBisfmqFeOGN4."/></div></div></figure><p id="cd4e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下载<strong class="je hv"> OpenVPN Connect客户端</strong>，安装完成后，点击<strong class="je hv">导入</strong>，然后点击<strong class="je hv">从服务器</strong>:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/cf6e3e1317052a03318402159989ff04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/0*8gJhBE7WkluqbUL1."/></div></div></figure><p id="d49e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，键入<strong class="je hv"> OpenVN DNS </strong>名称:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div class="fe ff lj"><img src="../Images/6c405b995f4e24e78568b017e35da676.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/0*7cYXugAKr1dXH4hE."/></div></figure><p id="19f5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">输入您的<em class="kt"> openvpn </em>作为用户名，输入与之前相同的密码，点击<strong class="je hv">连接</strong>:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lh"><img src="../Images/ff874ed7550abf13202cf32cdbcf64ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aoo23Jib_en5KKVg."/></div></div></figure><p id="baae" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">连接后，您应该会看到一个绿色的复选标记:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/bc9c7acc5ebf26741dc3789385184f26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/0*6m-T7uNOkOZPV9nF."/></div></figure><p id="9a01" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要验证客户端是否已连接，请在<a class="ae lf" href="https://openvpn.slowcoder.com/admin" rel="noopener ugc nofollow" target="_blank">https://openvpn.slowcoder.com/admin</a>上登录<strong class="je hv"> OpenVPN管理仪表板</strong>:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ll"><img src="../Images/34c246dc9466cb14e35c8a66313e6727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X3JvgFjbZcg30GUp."/></div></div></figure><p id="53a3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，在专用子网中创建一个简单的web服务器实例，以验证VPN正在工作:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lm"><img src="../Images/905412894414ff02d32eeec1ec36dca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xwkYZU_j3PIkzKSY."/></div></div></figure><p id="79c9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您将浏览器指向web服务器私有地址，您应该会看到一个简单的HTML页面:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ln"><img src="../Images/902c3a06aa67bfc34e7feaf08dbe453a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uNaD3HvXcuz4576Y."/></div></div></figure></div></div>    
</body>
</html>