<html>
<head>
<title>How to add Spotlight support to your iOS app</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Spotlight支持添加到您的iOS应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-add-spotlight-support-to-your-ios-app-4a89054aff89?source=collection_archive---------11-----------------------#2018-02-28">https://medium.com/hackernoon/how-to-add-spotlight-support-to-your-ios-app-4a89054aff89?source=collection_archive---------11-----------------------#2018-02-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="e7e4" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">Swift教程将使您的应用程序在Spotlight search中可用</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/08f1a4a22231c86a71c6f8e6857b37da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WCl8G6QjyuVBvFcHm6LGLw.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek"><a class="ae jz" href="http://apple.co/2CrlXDf" rel="noopener ugc nofollow" target="_blank">http://apple.co/2CrlXDf</a></figcaption></figure><p id="6251" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">对于任何拥有移动应用的个人或创业公司来说，最大的挑战是如何提高用户留存率。你可以吸引用户下载app，但是第一次使用后会怎样？</p><p id="c09a" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">有的用户会把你的app删了，有的觉得有用就留着。但是，这并不总是意味着他们会使用它，如果他们把它安装在他们的手机上。通常，这款应用程序可能会被隐藏在某个文件夹中，或者数百个已安装的应用程序中。</p><blockquote class="kw kx ky"><p id="1ac5" class="ka kb kz kc b kd ke iv kf kg kh iy ki la kk kl km lb ko kp kq lc ks kt ku kv hn dt translated">这就是为什么我们需要想办法<strong class="kc hv">提醒</strong>用户我们的应用是存在的。</p></blockquote><p id="df74" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">苹果为我们提供了许多<a class="ae jz" href="https://hackernoon.com/tagged/ios" rel="noopener ugc nofollow" target="_blank"> iOS </a>功能，这些功能可以提高我们应用的可见性，即使用户不使用它。比如像<a class="ae jz" href="https://hackernoon.com/tagged/spotlight" rel="noopener ugc nofollow" target="_blank"> <em class="kz">聚光灯</em> </a> <em class="kz">，今日Widget </em>，<em class="kz"> iMessage </em>，<em class="kz">推送通知，Siri等等功能..</em>。</p><p id="1c19" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">在本教程中，我将介绍如何为您的iOS应用程序正确使用Spotlight功能。我最近在我的最新iOS应用程序<a class="ae jz" href="http://apple.co/2CrlXDf" rel="noopener ugc nofollow" target="_blank"> <em class="kz">中实现了这个功能，名为1BET </em> </a>，所以你将看到的所有截图都来自那里。</p><h1 id="d5b6" class="ld le hu bd lf lg lh li lj lk ll lm ln ja lo jb lp jd lq je lr jg ls jh lt lu dt translated">聚光灯</h1><p id="d03b" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">Spotlight是iOS中一个超级强大的搜索功能，可以搜索支持它的已安装应用程序的内容。这类似于你在Safari上的搜索体验。它还与Siri同步，并为您提供热门歌曲部分。你可以通过从主菜单向下滑动来定位Spotlight。</p><p id="5ed0" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">我将讲述关于Spotlight最重要的两件事:</strong></p><ol class=""><li id="91be" class="ma mb hu kc b kd ke kg kh kj mc kn md kr me kv mf mg mh mi dt translated">让您的内容可以在Spotlight上搜索到；</li><li id="02cd" class="ma mb hu kc b kd mj kg mk kj ml kn mm kr mn kv mf mg mh mi dt translated">将按下的项目拦截回您的iOS应用程序；</li></ol><h2 id="d787" class="mo le hu bd lf mp mq mr lj ms mt mu ln kj mv mw lp kn mx my lr kr mz na lt nb dt translated">#1创建可搜索的内容</h2><p id="9e02" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">如果我们希望我们的应用程序内容出现在Spotlight中，我们需要使用<a class="ae jz" href="https://developer.apple.com/documentation/corespotlight" rel="noopener ugc nofollow" target="_blank"> CoreSpotlight </a>框架。为了创建可搜索的内容，我们需要熟悉:</p><ul class=""><li id="9eff" class="ma mb hu kc b kd ke kg kh kj mc kn md kr me kv nc mg mh mi dt translated"><a class="ae jz" href="https://developer.apple.com/documentation/corespotlight/cssearchableitemattributeset" rel="noopener ugc nofollow" target="_blank">CSSearchableItemAttributeSet</a>-指定您希望在Spotlight中显示的属性(即标题、内容描述、缩略图)。</li><li id="e68e" class="ma mb hu kc b kd mj kg mk kj ml kn mm kr mn kv nc mg mh mi dt translated"><a class="ae jz" href="https://developer.apple.com/documentation/corespotlight/cssearchableitem" rel="noopener ugc nofollow" target="_blank"> CSSearchableItem </a> -这个类表示搜索项。我们可以分配一个<strong class="kc hv"> <em class="kz">唯一标识符</em> </strong>用于引用对象，一个<strong class="kc hv"> <em class="kz">域</em> </strong> <em class="kz"> </em>用于管理组中的项目，一个<strong class="kc hv"> <em class="kz">属性集</em> </strong> <em class="kz"> </em>用于传递我们为该对象创建的<em class="kz">CSSearchableItemAttributeSet</em>。</li><li id="a6e2" class="ma mb hu kc b kd mj kg mk kj ml kn mm kr mn kv nc mg mh mi dt translated"><a class="ae jz" href="https://developer.apple.com/documentation/corespotlight/cssearchableindex" rel="noopener ugc nofollow" target="_blank">CSSearchableIndex</a>——一个负责索引Spotlight上内容的类。它需要一个数组<em class="kz"> CSSearchableItem。</em></li></ul><p id="19bf" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">现在，让我们看看这三个类一起工作的例子。👇</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nd ne l"/></div></figure><p id="5619" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">这是我在<a class="ae jz" href="http://apple.co/2CrlXDf" rel="noopener ugc nofollow" target="_blank"> 1BET </a>中处理聚光灯支持的方式…</p><p id="aad2" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">CoreSpotlight框架有自己的规则，我们必须遵守。<em class="kz"> CSSearchableItem </em>是我们需要利用的数据模型，以便让聚光灯正常工作。如您所见，我正在迭代我的数据模型，并使用我需要的属性创建<em class="kz"> CSSearchableItem </em>对象。之后，只需将所有新创建的项目添加到一个数组中，并将其传递给<em class="kz"> CSSearchableIndex。</em></p><p id="3565" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">此时，当您开始搜索时，您需要在Spotlight中看到结果。就是这样！😉</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff nf"><img src="../Images/89b9cee995c38d9c5181057b7d8430c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*siZSDHKkycCHljnHwUOaCg.png"/></div></figure><blockquote class="kw kx ky"><p id="39f1" class="ka kb kz kc b kd ke iv kf kg kh iy ki la kk kl km lb ko kp kq lc ks kt ku kv hn dt translated">注意:当然还有比上面看到的更多的属性。你可以在苹果官方文档中找到。</p></blockquote><p id="4ae8" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">域名什么时候有用？<br/></strong><em class="kz">CSSearchableItem</em>域属性可能相当有用。如果你对我们为什么需要域名有任何困惑，我现在将解释一种情况…在我的例子中，我有2个不同的域名<code class="eh ng nh ni nj b">matches</code>和<code class="eh ng nh ni nj b">news</code>。<em class="kz">比赛</em>域填充有比赛投注提示，<em class="kz">新闻</em>填充有最新的体育文章。</p><p id="27bf" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">现在，我只在某些特定情况下显示<em class="kz">新闻</em>。这意味着有时我不想让他们出现在聚光灯下。如果你已经把它们添加到了索引中，它们将会留在那里。这意味着我们需要找到一种方法来删除该域(组)中的所有条目。👇</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nd ne l"/></div></figure><p id="763d" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">使用CSSearchableIndex，我们可以轻松地删除特定领域的所有可搜索项目。您也可以同时添加多个域。</p><h2 id="8756" class="mo le hu bd lf mp mq mr lj ms mt mu ln kj mv mw lp kn mx my lr kr mz na lt nb dt translated">#2截取按下的项目</h2><p id="8f0f" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">在这种情况下，用户发现您在Spotlight上的一些搜索结果很有趣，并希望看到更多信息。用户点击该项目，会自动重定向到您的应用程序。但是，如果我们没有正确拦截该项目，用户将只会出现在应用程序的初始屏幕上，而不是被重定向到特定的内容。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/3a02c914fde4d98b4afd2a6bcfa25c1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyNHxgWmjIRxnMJMB04F8g.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek"><a class="ae jz" href="http://apple.co/2CrlXDf" rel="noopener ugc nofollow" target="_blank">http://apple.co/2CrlXDf</a></figcaption></figure><p id="ad67" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">这是一个用户如何打开Spotlight，进行搜索，并通过点击其中一个项目重定向到比赛概览屏幕的流程。</p><p id="7c1d" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv"> App Delegate <br/> </strong>首先，转到<code class="eh ng nh ni nj b">AppDelegate.swift</code>添加下面的片段。这个方法将触发根视图控制器内部的<code class="eh ng nh ni nj b">restoreUserActivityState()</code>。您还可以注意到，我们正在传递包含已按下项目数据的<a class="ae jz" href="https://developer.apple.com/documentation/foundation/nsuseractivity" rel="noopener ugc nofollow" target="_blank"> NSUserActivity </a>对象。👇</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nd ne l"/></div></figure><blockquote class="kw kx ky"><p id="6e97" class="ka kb kz kc b kd ke iv kf kg kh iy ki la kk kl km lb ko kp kq lc ks kt ku kv hn dt translated"><em class="hu">注意:我的根视图控制器的位置如示例所示。你必须用你自己的逻辑去改变它。</em></p></blockquote><p id="7a1c" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv"> UIViewController <br/> </strong>最后一步是打开您在AppDelegate方法中转换的视图控制器，并在那里覆盖<em class="kz">restoreuractivitystate()</em>。👇</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nd ne l"/></div></figure><p id="0238" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">如果您从一开始就遵循了本教程，您会注意到我们正在将一个唯一标识符<strong class="kc hv"><em class="kz"/></strong>传递给我们创建的每个<strong class="kc hv"><em class="kz"/></strong><a class="ae jz" href="https://developer.apple.com/documentation/corespotlight/cssearchableitem" rel="noopener ugc nofollow" target="_blank"><em class="kz">CSSearchableItem</em></a>。restoreUserActivityState将向我们返回该标识符，这将使我们能够找到合适的对象，并提供用户应该导航到的合适的视图控制器。</p></div><div class="ab cl nk nl hc nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="hn ho hp hq hr"><p id="6c97" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">这就是这篇教程，我希望它能帮助你学会如何为你的iOS应用程序添加Spotlight支持。我也希望这个特性能给你的分析软件带来积极的推动。📈</strong></p><p id="565b" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">如果你能，我将不胜感激👏或者分享这个故事，以便其他人可以找到它并从中学习。干杯！</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><a href="http://bit.ly/2KkkwGL"><div class="fe ff jj"><img src="../Images/3b10192bfb279b218705b94b67cf09cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nmDX3wxlLcKHDvTF5iDULA.png"/></div></a></figure><h2 id="a1f8" class="mo le hu bd lf mp mq mr lj ms mt mu ln kj mv mw lp kn mx my lr kr mz na lt nb dt translated">查看我的最新项目:</h2><div class="nr ns fm fo nt nu"><a href="https://play.google.com/store/apps/details?id=betting.tips.goals" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">BetScore:Google Play上的足球博彩技巧、比分和赔率应用</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">我们提供高胜率的专业足球技巧。每个比赛模拟包含三个预测…</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">play.google.com</p></div></div><div class="od l"><div class="oe l of og oh od oi jt nu"/></div></div></a></div><div class="nr ns fm fo nt nu"><a href="https://play.google.com/store/apps/details?id=betting.tips.sportsbet" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">Google Play上的篮球、曲棍球和手球应用程序的下注技巧</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">超过500，000名职业博彩客户、体彩投注者和体育博彩爱好者信任我们的日常体育博彩…</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">play.google.com</p></div></div><div class="od l"><div class="oj l of og oh od oi jt nu"/></div></div></a></div><h2 id="97ee" class="mo le hu bd lf mp mq mr lj ms mt mu ln kj mv mw lp kn mx my lr kr mz na lt nb dt translated">阅读更多我在媒体上的作品:</h2><div class="nr ns fm fo nt nu"><a href="https://hackernoon.com/introducing-clean-swift-architecture-vip-770a639ad7bf" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">引入干净的Swift架构(VIP)</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">忘了MVC吧，现在！</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">hackernoon.com</p></div></div><div class="od l"><div class="ok l of og oh od oi jt nu"/></div></div></a></div><div class="nr ns fm fo nt nu"><a href="https://medium.freecodecamp.org/how-you-can-use-the-google-maps-sdk-with-ios-using-swift-4-a9bba26d9c4d" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">使用Swift 4在iOS上使用Google Maps SDK的终极指南</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">许多iOS应用程序使用谷歌地图。这是一个非常普遍的特点，所以我决定准备一个终极指南…</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">medium.freecodecamp.org</p></div></div><div class="od l"><div class="ol l of og oh od oi jt nu"/></div></div></a></div><div class="nr ns fm fo nt nu"><a rel="noopener follow" target="_blank" href="/theappspace/swift-custom-uiview-with-xib-file-211bb8bbd6eb"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">SWIFT —带有XIB文件的自定义UIView</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">用XIB文件定制UIView是iOS开发中非常常见的做法。自定义UIView类不包含XIB文件…</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">medium.com</p></div></div><div class="od l"><div class="om l of og oh od oi jt nu"/></div></div></a></div><div class="nr ns fm fo nt nu"><a href="https://hackernoon.com/how-to-add-spotlight-support-to-your-ios-app-4a89054aff89" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">如何将Spotlight支持添加到您的iOS应用程序</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">Swift教程将使您的应用程序在Spotlight search中可用</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">hackernoon.com</p></div></div><div class="od l"><div class="on l of og oh od oi jt nu"/></div></div></a></div><div class="nr ns fm fo nt nu"><a href="https://hackernoon.com/core-data-relationships-d813ed66ba8c" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">核心数据关系</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">理解一对一和一对多关系</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">hackernoon.com</p></div></div><div class="od l"><div class="oo l of og oh od oi jt nu"/></div></div></a></div><div class="nr ns fm fo nt nu"><a href="https://hackernoon.com/understanding-auto-layout-in-xcode-9-2719710f0706" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab ej"><div class="nw ab nx cl cj ny"><h2 class="bd hv fv z el nz eo ep oa er et ht dt translated">了解Xcode 9中的自动布局</h2><div class="ob l"><h3 class="bd b fv z el nz eo ep oa er et ek translated">所有你需要知道的关于自动布局</h3></div><div class="oc l"><p class="bd b gc z el nz eo ep oa er et ek translated">hackernoon.com</p></div></div><div class="od l"><div class="op l of og oh od oi jt nu"/></div></div></a></div><h2 id="0b96" class="mo le hu bd lf mp mq mr lj ms mt mu ln kj mv mw lp kn mx my lr kr mz na lt nb dt translated">订阅我的时事通讯:</h2><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oq ne l"/></div></figure><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oq ne l"/></div></figure></div></div>    
</body>
</html>