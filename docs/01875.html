<html>
<head>
<title>Exploring Stellar Lumens — Development Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索恒星流明-开发教程</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/exploring-stellar-lumens-development-tutorial-cdf6d09a0e87?source=collection_archive---------12-----------------------#2018-02-28">https://medium.com/hackernoon/exploring-stellar-lumens-development-tutorial-cdf6d09a0e87?source=collection_archive---------12-----------------------#2018-02-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/539ae2106587c0cf1444e2153e77c13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4o1JS5mTOOLVv9Na51zCRQ.jpeg"/></div></div></figure><p id="1b38" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">今天，我有机会探索恒星流明的<strong class="je hv">技术面</strong>，并对利弊进行<strong class="je hv">分析。我想我终于可以把它从我的遗愿清单上划掉了！本文的目标是将一个简单的事务推送到Stellar网络。由于我找不到太多关于Stellar的技术“如何做”的信息，我决定用老方法来做:<a class="ae ka" href="https://en.wikipedia.org/wiki/RTFM" rel="noopener ugc nofollow" target="_blank"> RTFM </a>！</strong></p><h1 id="a208" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">了解恒星</h1><p id="8fad" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">立即钻研代码是愚蠢的，因此我在Stellar <a class="ae ka" href="https://www.stellar.org/developers/guides/get-started/" rel="noopener ugc nofollow" target="_blank">网站</a>上找到了这篇高层次的架构概述指南。</p><h2 id="1b3e" class="le kc hu bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">API:地平线</h2><p id="ca2d" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">所有与Stellar网络的交互都通过Horizon(一个RESTful HTTP API服务器)进行。它允许开发者提交交易、检查账户余额和订阅事件。您可以通过web浏览器使用Horizon，这是一个命令行工具，如cURL，或者是最简单的解决方案Stellar SDK。Stellar SDK可用于<a class="ae ka" href="https://github.com/stellar/js-stellar-sdk" rel="noopener ugc nofollow" target="_blank"><em class="ls">JavaScript</em></a><em class="ls">，Java和Go </em>。还有社区维护的针对<em class="ls"> Python、C#和Ruby </em>的SDK。</p><h2 id="a1f3" class="le kc hu bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">恒星内核</h2><p id="574c" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">恒星核心是恒星网络的主干，每台地平线服务器都与它相连。恒星核心负责验证交易和达成共识。核心是由一群个人创建一个分散的网络。网络上的每一笔交易都要支付一小笔费用:100斯特鲁普(相当于0.00001 XLM)。应该防止不良实体向网络发送垃圾邮件。</p><p id="00e3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ls">Stellar Consensus Protocol(SCP)<br/></em>SCP优先考虑安全性，而不是活性——如果出现分区或行为不当的节点，它会停止网络的进程，直到达成共识。你可以在他们的<a class="ae ka" href="https://www.stellar.org/papers/stellar-consensus-protocol.pdf" rel="noopener ugc nofollow" target="_blank">白皮书</a>中找到更多关于该协议的信息。</p><p id="7bc5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ls">用Docker </em>运行Stellar Core<br/>通过运行Stellar Core实例有可能成为网络的一部分。使用<a class="ae ka" href="https://hub.docker.com/r/stellar/quickstart/" rel="noopener ugc nofollow" target="_blank">stellar/quick start docker image</a>可以轻松设置这样的实例。</p><p id="ec61" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">幸运的是，Stellar提供了一个用于开发目的的测试网。信息可以在<a class="ae ka" href="https://www.stellar.org/developers/guides/concepts/test-net.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="2c87" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">让我们编码恒星</h1><p id="ce75" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><strong class="je hv">先决条件</strong>:JavaScript、Express和Async/Await的基础知识。</p><p id="b382" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">目标</strong>:在testnet上创建两个账户，用testnet令牌填充账户，并将一些随机金额从一个账户转移到另一个账户。最后，我们希望能够用事务浏览器检索事务。总的来说，这个Stellar编码教程教你入门Stellar开发的基础知识。</p><p id="7d83" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">完整的工作代码:</strong>可以在<a class="ae ka" href="https://github.com/michielmulders/stellar-js-sdk" rel="noopener ugc nofollow" target="_blank">这里</a>找到，这样更容易跟随教程。博客底部还添加了完整的代码片段。</p><h2 id="682c" class="le kc hu bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">创建帐户</h2><p id="9dc1" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">Stellar JavaScript SDK是所提供的SDK中最稳定的。你可以用npm: <code class="eh lt lu lv lw b">npm i -S stellar-sdk</code>轻松安装这个包。</p><p id="9102" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们告诉我们的Stellar SDK使用testnet服务器URL:</p><pre class="lx ly lz ma fq mb lw mc md aw me dt"><span id="c8b0" class="le kc hu lw b fv mf mg l mh mi">const server = new Stellar.Server('https://horizon-testnet.stellar.org')<br/>Stellar.Network.useTestNetwork()</span></pre><p id="e397" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们准备创建两个随机帐户。Stellar SDK提供了一个无种子随机创建密钥对的功能。</p><pre class="lx ly lz ma fq mb lw mc md aw me dt"><span id="6e24" class="le kc hu lw b fv mf mg l mh mi">let pairA = Stellar.Keypair.random()<br/>let pairB = Stellar.Keypair.random()</span></pre><p id="7507" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个密钥对包含一个检索公钥<code class="eh lt lu lv lw b">pair.publicKey()</code>和秘密<code class="eh lt lu lv lw b">pair.secret()</code>的函数。</p><p id="b587" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，我定义了一个路由来初始化两个帐户。在这个函数中，我们将基于我们的公钥创建我们的钱包/账户，并请求<code class="eh lt lu lv lw b">stellar friendbot</code>在两个账户上发送10.000 testnet流明给我们。我使用<code class="eh lt lu lv lw b">request-promise</code> npm包向Horizon testnet API发送请求，因为这与async/await配合得很好。我们通过一个查询字符串传递来自第一个密钥对的公钥。</p><pre class="lx ly lz ma fq mb lw mc md aw me dt"><span id="09cd" class="le kc hu lw b fv mf mg l mh mi">await rp.get({<br/>  uri: 'https://horizon-testnet.stellar.org/friendbot',<br/>  qs: { addr: pairA.publicKey() },<br/>  json: true<br/>})</span></pre><p id="aecf" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">帐户现已创建，但我们的应用程序中没有帐户对象。那么，让我们来检索这个。</p><pre class="lx ly lz ma fq mb lw mc md aw me dt"><span id="79b0" class="le kc hu lw b fv mf mg l mh mi">accountB = await server.loadAccount(pairB.publicKey())</span></pre><p id="5e05" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在可以检查我们的帐户上是否有一些恒星流明。</p><pre class="lx ly lz ma fq mb lw mc md aw me dt"><span id="ad40" class="le kc hu lw b fv mf mg l mh mi">accountA.balances.forEach((balance) =&gt; {<br/>  console.log('Type:', balance.asset_type, ', Balance:', balance.balance)<br/>})</span></pre><p id="0cec" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们也为<code class="eh lt lu lv lw b">pairB</code>重复这个代码，以便检索<code class="eh lt lu lv lw b">accountB</code>。</p><h2 id="2707" class="le kc hu bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">传递恒星流明</h2><p id="1b7a" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">一个事务可以由链接到<code class="eh lt lu lv lw b">TransactionBuider</code>的多个操作组成，从而创建(多)事务。为了简单起见，我们将只转移少量的testnet流明。我们将<code class="eh lt lu lv lw b">pairB</code>的公钥定义为目的地。转账金额等于<code class="eh lt lu lv lw b">30.0000001</code>。StellarSDK要求amount参数应精确到小数点后七位。</p><pre class="lx ly lz ma fq mb lw mc md aw me dt"><span id="ebb1" class="le kc hu lw b fv mf mg l mh mi">const transaction = new Stellar.TransactionBuilder(accountA)<br/>  .addOperation(Stellar.Operation.payment({<br/>    destination: pairB.publicKey(),<br/>    asset: Stellar.Asset.native(),<br/>    amount: '30.0000001'<br/>  }))<br/>  .build()</span></pre><p id="e68e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">好了，交易已经准备好，可以由转账发起者— <code class="eh lt lu lv lw b">transaction.sign(pairA)</code>签字了。好了，现在把这个发给地平线网:<br/> <code class="eh lt lu lv lw b">const transactionResult = await server.submitTransaction(transaction)</code></p><h2 id="5e66" class="le kc hu bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">检索历史</h2><p id="6324" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">以下代码将为每个“历史页面”仅返回一个交易。您可以使用“历史页面”对象上的<code class="eh lt lu lv lw b">next()</code>功能来检索账户历史中的下一笔交易。</p><pre class="lx ly lz ma fq mb lw mc md aw me dt"><span id="7996" class="le kc hu lw b fv mf mg l mh mi">let historyPage = await server.transactions()<br/>  .forAccount(accountA.accountId())<br/>  .call()</span></pre><p id="30c1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们希望打印事务中操作的细节(XDR编码)。让我们解码到base64并循环处理事务的操作，以打印所有发送的金额。</p><pre class="lx ly lz ma fq mb lw mc md aw me dt"><span id="d169" class="le kc hu lw b fv mf mg l mh mi">let txDetails = Stellar.xdr.TransactionEnvelope<br/>  .fromXDR(historyPage.records[1].envelope_xdr, 'base64')</span><span id="4bd9" class="le kc hu lw b fv mj mg l mh mi">txDetails._attributes.tx._attributes.operations<br/>  .map(operation =&gt; console.log(<br/>    `Transferred amount:         <br/>    ${operation._attributes.body._value._attributes.amount.low} XLM`<br/>  ))</span></pre><p id="3ef0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，让我们检索下一个“历史页面”。</p><pre class="lx ly lz ma fq mb lw mc md aw me dt"><span id="2318" class="le kc hu lw b fv mf mg l mh mi">historyPage = await historyPage.next()</span></pre><p id="3346" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ls">就这样？是的，惊讶吗？</em></p><h2 id="21b5" class="le kc hu bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">你知道吗</h2><ul class=""><li id="6473" class="mk ml hu je b jf kz jj la jn mm jr mn jv mo jz mp mq mr ms dt translated">你可以探索一下网络上的交易— <a class="ae ka" href="https://horizon-testnet.stellar.org/transactions/8380cde0b2300c087427edf6cae08abb12cdc5eea30c3ec129f45f0db37c7c09" rel="noopener ugc nofollow" target="_blank">例子</a>。链接在<code class="eh lt lu lv lw b">transactionResult</code>参数:<code class="eh lt lu lv lw b">transactionResult._links.transaction.href</code>中返回。</li><li id="5146" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">关于事务的元数据以标准数据序列化格式的XDR格式存储。你可以在这里反序列化它<a class="ae ka" href="https://www.stellar.org/laboratory/#xdr-viewer?input=AAAAABQfUJxjNiLOX3QqcxCIcpFemEm7uI6aeT5GGyBKRmhiAAAAZAB0LFwAAAADAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAA0bR27%2ByXbgKzVd7tOZ2VreBy%2BijKqULK5aH%2F7R2EvfkAAAAAAAAAABHhowEAAAAAAAAAAUpGaGIAAABA1jaHLjUwWPe6rDpQEjv4mGMOrmZ00Ab%2BePjK1yrPZg7vpN1s%2FgsEULgbwyEXIFtteKN1imSO6k1mRFDKYpiPBQ%3D%3D&amp;type=TransactionEnvelope&amp;network=public" rel="noopener ugc nofollow" target="_blank">。</a></li><li id="979f" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">您可以在这里查找类似<a class="ae ka" href="https://horizon-testnet.stellar.org/accounts/GA47YQ3Y4UCUSOKGAR53L5WSM4AN34JQSGFQ2CMVELJVWN7IYOWI6PBB/operations?order=desc" rel="noopener ugc nofollow" target="_blank">的公钥的所有交易。</a></li></ul><h1 id="0c50" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">恒星分析</h1><h2 id="258c" class="le kc hu bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">赞成的意见</h2><ul class=""><li id="b4f6" class="mk ml hu je b jf kz jj la jn mm jr mn jv mo jz mp mq mr ms dt translated">Stellar是一个支付引擎，专注于资产移动，而其他区块链可能专注于程序本身的逻辑。Stellar和Ripple正在处理你的钱是如何交易和发送的，这是一个更特殊的目的。</li><li id="57ad" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">Stellar对于任何不太了解区块链的web开发人员来说都很容易集成。</li><li id="96cf" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">非常适合支付/跨货币/跨境支付。</li><li id="45e7" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">快速，便宜，容易建立自己的联合网络:这是由于共识算法不使用工作证明，而是他们的自定义<a class="ae ka" href="https://www.stellar.org/papers/stellar-consensus-protocol.pdf" rel="noopener ugc nofollow" target="_blank">恒星共识协议</a>。</li><li id="15f3" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">非常便宜的费用:每次手术0.00001 XLM。一笔交易可以包含多项操作，因此费用不取决于转账金额。</li></ul><h2 id="a9b4" class="le kc hu bd kd lf lg lh kh li lj lk kl jn ll lm kp jr ln lo kt jv lp lq kx lr dt translated">骗局</h2><ul class=""><li id="29b7" class="mk ml hu je b jf kz jj la jn mm jr mn jv mo jz mp mq mr ms dt translated">隐私——每一笔交易都可以被区块链浏览器发现和读取。</li><li id="9ac0" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">缺少重要的标准，如支付环节(仍在开发中),这降低了采用的速度。支付链接将处理链接上的点击，提示用户付款，这对电子商务至关重要。目前，你需要手动复制粘贴地址、交易备忘录和金额，比特币有一个一键批准支付选项。</li></ul><p id="b076" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">很难确定这是否是一个<em class="ls">赞成/反对</em> : Stellar并没有真正使用智能合同的概念(它不是图灵完成)。<em class="ls"> </em>它适用于一些流行的用例，如托管、时间受限和原子事务。然而，标准可以扩展到更多的用例，但它永远不会达到“编写你自己的DApp”的地步。这很好，因为它使Stellar为资产转移的特定目的而优化，而不是被人们的幻想所膨胀。</p><blockquote class="my mz na"><p id="2638" class="jc jd ls je b jf jg jh ji jj jk jl jm nb jo jp jq nc js jt ju nd jw jx jy jz hn dt translated">Stellar成功地消除了区块链的知识壁垒，尽管它是一家区块链支付提供商。米歇尔·穆尔德斯</p></blockquote><h1 id="90b7" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">成为一流专家的资源</h1><ul class=""><li id="7bf7" class="mk ml hu je b jf kz jj la jn mm jr mn jv mo jz mp mq mr ms dt translated">这个例子的完整代码在<a class="ae ka" href="https://github.com/michielmulders/stellar-js-sdk" rel="noopener ugc nofollow" target="_blank"> Github </a>上。</li><li id="abed" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">Horizon API <a class="ae ka" href="http://stellar.github.io/js-stellar-sdk/TransactionBuilder.html" rel="noopener ugc nofollow" target="_blank">文档</a>。</li><li id="b334" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">Testnet <a class="ae ka" href="https://horizon-testnet.stellar.org" rel="noopener ugc nofollow" target="_blank"> explorer </a>。</li><li id="ff3b" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">入门代码示例<a class="ae ka" href="https://www.stellar.org/developers/guides/get-started/transactions.html" rel="noopener ugc nofollow" target="_blank">这里</a>，这里<a class="ae ka" href="https://www.stellar.org/developers/js-stellar-sdk/reference/examples.html" rel="noopener ugc nofollow" target="_blank">这里</a>，这里<a class="ae ka" href="https://github.com/rafaalb/React-StellarLumens/blob/5311e784e2a5ac85356a7fc97382a8537882d94c/src/actions/payments.js" rel="noopener ugc nofollow" target="_blank">这里</a> (react)。</li><li id="62f7" class="mk ml hu je b jf mt jj mu jn mv jr mw jv mx jz mp mq mr ms dt translated">检查恒星网络的<a class="ae ka" href="https://dashboard.stellar.org/" rel="noopener ugc nofollow" target="_blank">状态</a>。</li></ul></div><div class="ab cl ne nf hc ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="hn ho hp hq hr"><figure class="lx ly lz ma fq iv"><div class="bz el l di"><div class="nl nm l"/></div></figure><p id="8816" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有兴趣开始自己的区块链项目，但不知道如何开始？您需要帮助开始代币销售或进行审计吗？与 <a class="ae ka" href="https://theledger.be" rel="noopener ugc nofollow" target="_blank"> <em class="ls">取得联系</em> </a> <em class="ls">。</em></p></div><div class="ab cl ne nf hc ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="hn ho hp hq hr"><p id="e64f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">完整的代码片段:</p><figure class="lx ly lz ma fq iv"><div class="bz el l di"><div class="nn nm l"/></div></figure></div></div>    
</body>
</html>