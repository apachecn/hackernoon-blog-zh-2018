<html>
<head>
<title>The Redux Type Flow (revisited in 2018)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redux型流程(2018年重访)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/the-redux-type-flow-93aada6964e5?source=collection_archive---------1-----------------------#2018-03-03">https://medium.com/hackernoon/the-redux-type-flow-93aada6964e5?source=collection_archive---------1-----------------------#2018-03-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="e762" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">探索冗余使用流程中的类型安全</h2></div><p id="b38e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae kf" href="https://hackernoon.com/tagged/redux" rel="noopener ugc nofollow" target="_blank"> redux </a>代码中的类型安全有3个组成部分:</p><ul class=""><li id="01ba" class="kg kh hu jl b jm jn jp jq js ki jw kj ka kk ke kl km kn ko dt translated">行动</li><li id="b19d" class="kg kh hu jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko dt translated">动作创建者</li><li id="9a42" class="kg kh hu jl b jm kp jp kq js kr jw ks ka kt ke kl km kn ko dt translated"><a class="ae kf" href="https://hackernoon.com/tagged/reducer" rel="noopener ugc nofollow" target="_blank">减速器</a></li></ul><p id="b1c0" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv">动作</strong>只是<a class="ae kf" href="https://wikipedia.org/wiki/Plain_old_Java_object" rel="noopener ugc nofollow" target="_blank">普通的老JS对象</a>。它们是由动作创作者创造的。</p><p id="0f88" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv">动作创建者</strong>是创建动作对象的功能。</p><p id="1d4c" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv">归约器</strong>是带有两个参数的函数——T0和T1。其中，给<code class="eh ku kv kw kx b">action</code>添加合适的字体是一个真正的挑战。我们一会儿就会明白为什么会这样。</p></div><div class="ab cl ky kz hc la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hn ho hp hq hr"><h1 id="5926" class="lf lg hu bd lh li lj lk ll lm ln lo lp ja lq jb lr jd ls je lt jg lu jh lv lw dt translated">我们的工作台</h1><p id="5013" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">为了表达我的观点，我将在本文中使用一个简单的reducer函数。它存储来自输入的字符串消息，默认值为“Hello World”。用户可以<strong class="jl hv">清除</strong>输入，<strong class="jl hv">更新</strong>或<strong class="jl hv">复位</strong>它。</p><pre class="mc md me mf fq mg kx mh mi aw mj dt"><span id="8b4a" class="mk lg hu kx b fv ml mm l mn mo">const <strong class="kx hv">CLEAR</strong> = 'CLEAR';<br/>const <strong class="kx hv">RESET</strong> = 'RESET';<br/>const <strong class="kx hv">UPDATE</strong> = 'UPDATE';</span><span id="8508" class="mk lg hu kx b fv mp mm l mn mo">function <strong class="kx hv">reducer</strong>(state: string = '', action) {<br/>  switch (action.type) {<br/>    case <strong class="kx hv">CLEAR</strong>:<br/>      return '';</span><span id="85c1" class="mk lg hu kx b fv mp mm l mn mo">    case <strong class="kx hv">RESET</strong>:<br/>      return action.text;</span><span id="843c" class="mk lg hu kx b fv mp mm l mn mo">    case <strong class="kx hv">UPDATE</strong>:<br/>      return action.text;</span><span id="6ea7" class="mk lg hu kx b fv mp mm l mn mo">    <strong class="kx hv">default</strong>:<br/>      return state;<br/>  }<br/>}</span><span id="01a5" class="mk lg hu kx b fv mp mm l mn mo">function <strong class="kx hv">clear</strong>() {<br/>  return { type: CLEAR };<br/>}</span><span id="ffaa" class="mk lg hu kx b fv mp mm l mn mo">function <strong class="kx hv">reset</strong>() {<br/>  return { type: RESET, text: 'Hello World' };<br/>}</span><span id="6850" class="mk lg hu kx b fv mp mm l mn mo">function <strong class="kx hv">update</strong>(text: string) {<br/>  return { type: UPDATE, text };<br/>}</span></pre></div><div class="ab cl ky kz hc la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hn ho hp hq hr"><h1 id="bdef" class="lf lg hu bd lh li lj lk ll lm ln lo lp ja lq jb lr jd ls je lt jg lu jh lv lw dt translated">手动类型</h1><p id="bc27" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">“主要想法”是每个动作创建者创建一个具有独特形状的<em class="mq">动作</em>——一个具有类型<code class="eh ku kv kw kx b">string</code>值的属性<code class="eh ku kv kw kx b">type</code>。</p><p id="bd81" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以手动将类型添加到action对象中，并在reducer中将它们用作一个<a class="ae kf" href="https://flow.org/en/docs/types/unions/" rel="noopener ugc nofollow" target="_blank"> union </a>类型。</p><pre class="mc md me mf fq mg kx mh mi aw mj dt"><span id="3e9f" class="mk lg hu kx b fv ml mm l mn mo">type <strong class="kx hv">ClearAction</strong> = { type: 'CLEAR' };<br/>type <strong class="kx hv">ResetAction</strong> = { type: 'RESET', text: 'Hello World' };<br/>type <strong class="kx hv">UpdateAction</strong> = { type: 'UPDATE', text: string };</span><span id="dcde" class="mk lg hu kx b fv mp mm l mn mo">type <strong class="kx hv">Action</strong> =<br/>  | ClearAction<br/>  | ResetAction<br/>  | UpdateAction;</span><span id="9aa0" class="mk lg hu kx b fv mp mm l mn mo">function reducer(state: string = '', action: <strong class="kx hv">Action</strong>) {<br/>  ...<br/>}</span></pre><p id="e2b2" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个简单的方法<em class="mq">就在</em>起作用，你可以在这里<a class="ae kf" href="https://flow.org/try/#0C4TwDgpgBAwgNhAhgJwIIGNgEsD2A7KAXigG8pRIAuKAchgBkBRVAJRqgF8BuAKAuhYQAzhGAZs+IqXLgI1Gi0YBlRgBUaAGnIQAHsHkAJCHDg4oAdRzI4AE3bc+sqAFUwNxMAjjcBYmX7yzgAKACKoqoya2nrUQsDIWHgA5py8jpBQ3pKEPFBQAD6wCChZeLkFUIIiYpg+5YWu7p6laej4cbBMrFJ0XWy8bXgdiiqqPSNqNAPtwC6h4Yw9wWERUzw8AGYArni1ksgQNlvoEMgAFHEeclBxCck9UYh7eNSlAJSk5UIA7ljA6AALKBnJ4SPAAOn4HxI5Ty6EQIk6zBYlFheSgB2AW2QBBoazR8MRE1UqPR6Mx2IIoJ8kN0wDSZMJ0GWC1JZIxokpUGp+FpegZ6JsEA2iC2cH0aLyFJxN2AV14eQ4PCVmx2zyg6GK52h5WlBH8smoDGRqWV622uzBHOqZx1Us5MoNVEqyjUWk8MVoRhMZks1jsppVFvVWzcVzOHv0sruSTtHKxjpkzpZEXddMDPCAA" rel="noopener ugc nofollow" target="_blank">看到</a>。以这种方式注释代码的一个额外好处是，我们也可以向动作创建者添加类型(参见<a class="ae kf" href="https://flow.org/try/#0C4TwDgpgBAwgNhAhgJwIIGNgEsD2A7KAXigG8pRIAuKAchgBkBRVAJRqgF8BuAKAuhYQAzhGAZs+IqXLgI1Gi0YBlRgBUaAGnIQAHsHkAJCHDg4oAdRzI4AE3bc+sqAFUwNxMAjjcBYmX7yzgAKACKoqoya2nrUQsDIWHgA5py8jpBQ3pKEPFBQAD6wCChZeLkFUIIiYpg+5YWu7p6laej4cbBMrFJ0XWy8bXgdiiqqPSNqNAPtwC6h4Yw9wWERUzw8AGYArni1ksgQNlvoEMgAFHEeclBxCck9UYh7eNSlAJSk5UIA7ljA6AALKBnJ4SPAAOn4HxI5Ty6EQIk6zBYlFheSgB2AW2QBBoazR8MRE1UqPR6Mx2IIoJ8kN0wDSZMJ0GWC1JZIxokpUGp+FpegZ6JsEA2iC2cH0aLyFJxN2AV14eQ4PCVmx2zyg6GK5ze1HgSDQ6phUs5Mv8sl1fVSyvW212YI51TOOsqwlEpU+xqxppkVEqyjUWk8MVoRhMZks1jsVpVtvVWzcVzOQf0sruSWdjSu7qNHK9BDNvpZEUDdOjPCAA" rel="noopener ugc nofollow" target="_blank">这里的</a>)。</p><pre class="mc md me mf fq mg kx mh mi aw mj dt"><span id="bf54" class="mk lg hu kx b fv ml mm l mn mo">...</span><span id="4ff3" class="mk lg hu kx b fv mp mm l mn mo">function <strong class="kx hv">clear</strong>(): <strong class="kx hv">ClearAction</strong> {<br/>  return { type: CLEAR };<br/>}</span><span id="b67f" class="mk lg hu kx b fv mp mm l mn mo">function <strong class="kx hv">reset</strong>(): <strong class="kx hv">ResetAction</strong> {<br/>  return { type: RESET, text: 'Hello World' };<br/>}</span><span id="45a9" class="mk lg hu kx b fv mp mm l mn mo">function <strong class="kx hv">update</strong>(text: string): <strong class="kx hv">UpdateAction</strong> {<br/>  return { type: UPDATE, text };<br/>}</span></pre></div><div class="ab cl ky kz hc la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hn ho hp hq hr"><h1 id="2360" class="lf lg hu bd lh li lj lk ll lm ln lo lp ja lq jb lr jd ls je lt jg lu jh lv lw dt translated">推断的注释类型</h1><p id="a4a9" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">在一个小而简单的项目中，这很好。但是当您有多个reducer，并且每个reducer有多个动作，每个动作对象有不同的形状时，手动编写所有内容本身就是一个挑战。我们需要一个更好的系统；一个有某种程度自动化的系统。</p><p id="4ed5" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们来看看<code class="eh ku kv kw kx b">ResetAction</code>:</p><pre class="mc md me mf fq mg kx mh mi aw mj dt"><span id="67c5" class="mk lg hu kx b fv ml mm l mn mo">type ResetAction = <strong class="kx hv">{ type: 'RESET', text: 'Hello World' }</strong>;</span></pre><p id="863c" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">它与<code class="eh ku kv kw kx b">reset()</code>动作创建者的返回值形状相同。</p><pre class="mc md me mf fq mg kx mh mi aw mj dt"><span id="88bc" class="mk lg hu kx b fv ml mm l mn mo">function reset() {<br/>  return <strong class="kx hv">{ type: RESET, text: 'Hello World' }</strong>;<br/>}</span></pre><p id="2f46" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">除了手动编写每个操作对象类型，我们还可以:</p><ol class=""><li id="aa83" class="kg kh hu jl b jm jn jp jq js ki jw kj ka kk ke mr km kn ko dt translated">调用操作创建者</li><li id="f872" class="kg kh hu jl b jm kp jp kq js kr jw ks ka kt ke mr km kn ko dt translated">将返回的对象转换为静态类型</li><li id="c7f8" class="kg kh hu jl b jm kp jp kq js kr jw ks ka kt ke mr km kn ko dt translated">在<code class="eh ku kv kw kx b">Action</code>类型中使用这些类型值。</li></ol><p id="a00d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">幸运的是，我们真的不需要<em class="mq">字面上的</em>调用动作创建者。我们可以利用<a class="ae kf" href="https://flow.org/en/docs/types/comments/" rel="noopener ugc nofollow" target="_blank"> Flow的注释类型</a>，它们将在“编译时”而不是运行时执行代码块(参见这里的<a class="ae kf" href="https://flow.org/try/#0PQKgXGBQAE0MYHsB2BnALvANgUwIYCcBBONAS2WgF4s98AKASgG4Z5l1p9sVs1iyK1LjzSMWsRKgwBXAA4ATXGmz9ySKtDmLldAOS7mkEMEiQ0AT1nZoAYRwFVg6BasIAZjQck1LF9YBK3LyO6tR+7pxBfN7IvpbWAKoKSioxoc7xEVopISxm8dAhVKwAPrb2RGml0IEiIdVJ2qkCSHmSHDYAMgCihP4aul29-ros7Rj+3QDK3QAqA5Mzs6OQ49AJAAoAIoSz3QObO3srkG7SSGmR8tJw2PToKWDQ6PikSADmA7oANNC4aU8QgxoABvVgoADupDQcAAFtA6P8WgA6PzAsGwCS4Hi2Hp9KCYzFcNDSfDqfR5QlwbEBaZzAmEyIksl-NKo7AADzQlMx1Jxh123QZhOJpPUSLU7K5PNg8mwblw0kwaGFRN4YueaBS4mgAF9IPrIMBgPBcEgkAhlH9zZaUqyWvAuEoEPgUNAoWh4W83HcuPIMlYUKdzpc4BVGKDWKKWSCA9gnkM+nqWIazhcHcJeBGMUyNbG-E9FnNfsouU9dAAJbCYTAIaAAdRdmHkumTBtMacu2R0pZVmteH3RUfVMbjTwFexLnIwupTkCAA" rel="noopener ugc nofollow" target="_blank"/>)。</p><pre class="mc md me mf fq mg kx mh mi aw mj dt"><span id="a519" class="mk lg hu kx b fv ml mm l mn mo">/*::<br/>  // <em class="mq">"compile time"</em> execution code<br/>  const <strong class="kx hv">clearAction</strong> = clear();<br/>  const <strong class="kx hv">resetAction</strong> = reset();<br/>  const <strong class="kx hv">updateAction</strong> = update('');<br/>*/</span><span id="cc8f" class="mk lg hu kx b fv mp mm l mn mo">type <strong class="kx hv">ClearAction</strong> = typeof clearAction;<br/>type <strong class="kx hv">ResetAction</strong> = typeof resetAction;<br/>type <strong class="kx hv">UpdateAction</strong> = typeof updateAction;</span><span id="5f6a" class="mk lg hu kx b fv mp mm l mn mo">type <strong class="kx hv">Action</strong> = <br/>  | ClearAction<br/>  | ResetAction<br/>  | UpdateAction;</span><span id="ecb3" class="mk lg hu kx b fv mp mm l mn mo">function reducer(state: string = '', action: <strong class="kx hv">Action</strong>) {<br/>  ...<br/>}</span></pre><p id="e5aa" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">不幸的是，因为我们是通过调用动作创建者来推断动作对象的类型，所以我们<strong class="jl hv">不能</strong>用推断的类型来注释创建者。这有点道理，因为这将在推断的类型和类型注释之间创建一个循环的依赖链。</p><p id="d301" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv"> <em class="mq">注意:</em> </strong> <em class="mq">在</em>行:5 <em class="mq">中，我们将一个空字符串传递给</em> <code class="eh ku kv kw kx b"><em class="mq">update()</em></code> <em class="mq">，因为它需要一个字符串参数，而Flow要求我们传递</em> <strong class="jl hv"> <em class="mq">所有的</em> </strong> <em class="mq">参数来进行适当的函数调用。</em></p></div><div class="ab cl ky kz hc la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hn ho hp hq hr"><h1 id="e942" class="lf lg hu bd lh li lj lk ll lm ln lo lp ja lq jb lr jd ls je lt jg lu jh lv lw dt translated">提取返回类型</h1><p id="224e" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">最<em class="mq">合法</em>的解决方案之一来自<a class="ae kf" href="https://github.com/facebook/flow/issues/4002" rel="noopener ugc nofollow" target="_blank">这个github线程</a>。其中一条评论把我引向了谢恩·奥斯本的这篇文章。</p><p id="8e92" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">本文讨论了一种“提取”函数返回类型的类型，并将其用于动作创建者。一个<a class="ae kf" href="https://github.com/facebook/flow/issues/4002#issuecomment-384756198" rel="noopener ugc nofollow" target="_blank">后来在帖子中的评论</a>将这背后的想法浓缩到了它的本质:<em class="mq">动作是动作创造者的返回类型；而不是相反</em>。为了提取函数的返回类型，我们使用了一个<a class="ae kf" href="https://flow.org/en/docs/types/generics/#toc-function-types-with-generics" rel="noopener ugc nofollow" target="_blank">通用函数类型</a> <code class="eh ku kv kw kx b">ReturnType</code>。</p><pre class="mc md me mf fq mg kx mh mi aw mj dt"><span id="79d6" class="mk lg hu kx b fv ml mm l mn mo">type <strong class="kx hv">ReturnTypeHelper</strong> = &lt;T&gt;((...Array&lt;any&gt;) =&gt; T) =&gt; T;<br/>type <strong class="kx hv">ReturnType</strong>&lt;Fn&gt; =  $Call&lt;ReturnTypeHelper, Fn&gt;;</span></pre><p id="f653" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这与前一个相同(见这里的<a class="ae kf" href="https://flow.org/try/#0C4TwDgpgBAJAogD2AJwIYGNgCULAK7IB2APAGKEB8UAvLAMKoA2jxxAKhQBScB0fAgsjQhiqQiAoBKGlTbTqsgDRRyFANwAoDaEhQ6jCKmT9MASwD2hGrEQoM2XARI6I5gGZR0Bo+u3hoOADOuCbAFla08EhomDj4RMQu7lDIEMHAvi5QAKpgACaowBCh4dZRdrGOCUkeePmFEL5+uiWWNBpQUAA+et7GZpYd3VBBIQOEQz25BUWthJoa6JaBwHoAMnD8WNYA5HQbWzuaS4QrI3AAynBsu1iX10eLy6vZAAoAIvxscLtvn9+PDRuPCEcYpCB5PDoCDITgrBoALigK2QpkIAHNdjtlPZwki5tIAN5DQIAd1MwHQAAsoJxcZYeC4iUNOuhUMF1pssAiWZ1wfErDtAXzPOyAvc2DyRZ1UgKoPTCIyIEgFiK2Ry-l84FLpbKnPLxkqVVoRXkIG5UHhGMAdSK9URkcAGppOgBfDTujQAei9osIhHMRXl-sDDQNYTa6FShXMyECUHJwBpaLcMNSeSgLkCQJBYK8hlhzJlVSshMz-iR+y5UFdmk9wNBEasqXSnCL-P1ZZcSLuVzYyiKSCROwAEhBmOYoAB1WOMPI7Gt1rQNsF1GYQTiDm2O1EY9v20vlyBIzXfAfK1a1j0aIA" rel="noopener ugc nofollow" target="_blank">和</a>)，也不能给动作创建者添加类型。但是从好的方面来看——更少的语法！</p></div><div class="ab cl ky kz hc la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hn ho hp hq hr"><h1 id="9711" class="lf lg hu bd lh li lj lk ll lm ln lo lp ja lq jb lr jd ls je lt jg lu jh lv lw dt translated">拨打$电话</h1><p id="4a13" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">现在我们对添加类型所需的过程有了更好的理解，我们可以通过使用Flow的<a class="ae kf" href="https://flow.org/en/docs/types/utilities/#toc-call" rel="noopener ugc nofollow" target="_blank">实用程序类型</a> <code class="eh ku kv kw kx b"><a class="ae kf" href="https://flow.org/en/docs/types/utilities/#toc-call" rel="noopener ugc nofollow" target="_blank">$Call</a></code>(您已经在上面的操作中看到了)直接调用函数来进一步减少语法。</p><blockquote class="mu mv mw"><p id="e12a" class="jj jk mq jl b jm jn iv jo jp jq iy jr mx jt ju jv my jx jy jz mz kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">$Call&lt;F&gt;</code>是表示调用给定的<a class="ae kf" href="https://flow.org/en/docs/types/functions" rel="noopener ugc nofollow" target="_blank">函数类型</a> <code class="eh ku kv kw kx b">F</code>的结果的类型。这类似于在运行时调用一个函数，但是在<strong class="jl hv">类型级别</strong>；这意味着函数类型调用是静态发生的，即不是在运行时。</p></blockquote><p id="3de8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这就是我们得到的(见这里的<a class="ae kf" href="https://flow.org/try/#0C4TwDgpgBAwgNhAhgJwIIGNgEsD2A7KAXigBIZE44AeUSHAMynQRQD4BuAKFugCUIAzhGAZs+IqXKUa4CAyjJBwjt1lQAqmAAmiYBFG4CxMhWo95AV226IAGigDgyLHgDmK1ZCgHxhTlCgAH1gWNExDfyCofiERcPxI4M0dPR88Lk50fEdYABkAUVReCQByGAKikq4svBzefIBlfIAVUvqm5qrM7OANAAUAEVRm-NL1QeH8rs56Czx4gkUtC3QIZAAKRxsALgcnF1dSkvtEBd20gEooAG9IgQB3LGB0AAsoddOxPAA6HivbgIBdCIIR5Qq8baRQEKYQWZAEErTaHA0HtFqQ6EBRTAOEET6GX4QAAewAyyJB0HGQxGGMx2NxUHx+EJJLJgK0EHoiAscGAtOh9PhexsXACAF9OBLOAB6aVMRB4PA4PSMxXKmyMhZMRS6HDIARQR7AN4uehrJZQHgCGZzLXMJAbf6RQUEa6W2S7crgqBirhS2bzL4w2LrJ1Y2FCt08XZo5r2PQk3YlAASEEoOCgAHU9XAtCUfX7ODbA4YoFYUhB1gm+XtnG4wzCcZH3ZBdlTJvHib1fZLOEA" rel="noopener ugc nofollow" target="_blank"/>)。</p><pre class="mc md me mf fq mg kx mh mi aw mj dt"><span id="4635" class="mk lg hu kx b fv ml mm l mn mo">type <strong class="kx hv">ClearAction</strong> = <strong class="kx hv">$Call</strong>&lt;typeof clear&gt;;<br/>type <strong class="kx hv">ResetAction</strong> = <strong class="kx hv">$Call</strong>&lt;typeof reset&gt;;<br/>type <strong class="kx hv">UpdateAction</strong> = <strong class="kx hv">$Call</strong>&lt;typeof update, string&gt;; // arguments</span><span id="8e7c" class="mk lg hu kx b fv mp mm l mn mo">type <strong class="kx hv">Action</strong> = <br/>  | ClearAction<br/>  | ResetAction<br/>  | UpdateAction;</span><span id="e7ea" class="mk lg hu kx b fv mp mm l mn mo">function reducer(state: string = '', action: <strong class="kx hv">Action</strong>) {<br/>  ...<br/>}</span></pre><p id="4c6b" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv"> <em class="mq">注:</em> </strong> <em class="mq">以我的经验来看，</em> <code class="eh ku kv kw kx b"><em class="mq">$Call</em></code> <em class="mq">有时候有就是“不工作”的倾向。我还没有试验它来找出这背后的原因。如果你知道什么，一定要告诉我。</em></p></div><div class="ab cl ky kz hc la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hn ho hp hq hr"><h1 id="2c8b" class="lf lg hu bd lh li lj lk ll lm ln lo lp ja lq jb lr jd ls je lt jg lu jh lv lw dt translated">定论</h1><p id="fc4b" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">最终，一切都取决于你的选择。如果您希望动作创建者具有显式类型，您需要手动添加类型注释。如果没有，使用推断类型来简化过程并减少语法。</p><p id="5612" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我希望从长远来看，你会发现这很有用。如果你用不同的方式输入redux代码，可能是很酷的方式，请在评论区告诉我。</p><figure class="mc md me mf fq na"><div class="bz el l di"><div class="nb nc l"/></div></figure></div></div>    
</body>
</html>