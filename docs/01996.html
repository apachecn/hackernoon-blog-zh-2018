<html>
<head>
<title>Build a realtime voting app in less than 10 min</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在不到10分钟的时间内构建一个实时投票应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-a-realtime-voting-app-in-less-than-10-min-336ec364b5da?source=collection_archive---------5-----------------------#2018-03-05">https://medium.com/hackernoon/build-a-realtime-voting-app-in-less-than-10-min-336ec364b5da?source=collection_archive---------5-----------------------#2018-03-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="e18b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">实时技术和数据使得应用程序更加有用和实用。整个实时世界是如此迷人，它的每一点探索只会让人更加敬畏！</p><p id="4e89" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">本教程是我在2018年3月在芬兰赫尔辛基举行的<a class="ae jp" href="http://ngvikings.org" rel="noopener ugc nofollow" target="_blank">维京人大会</a>上做的<a class="ae jp" href="https://youtu.be/PJZ06MLXGwA" rel="noopener ugc nofollow" target="_blank">演讲</a>的后续！<a class="ae jp" href="https://speakerdeck.com/srushtika/understanding-the-realtime-ecosystem-2" rel="noopener ugc nofollow" target="_blank">的演讲</a>可以在我的<a class="ae jp" href="https://speakerdeck.com/srushtika" rel="noopener ugc nofollow" target="_blank">个人资料</a>上查看。</p><h1 id="8496" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">我们将建造什么？</h1><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/6cdd08b1fc8f8952d33b389eda460fec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*PO3NIyPDQ5uFjllqgVE_cw.gif"/></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">A quick preview of how the outcome would look</figcaption></figure><p id="dc1f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将构建一个简单的投票应用程序，允许与会者对会议的反馈进行实时投票，如上所示！</p><p id="c862" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">与会者将使用另一个由三个简单按钮组成的应用程序，每个按钮对应一种投票类型。一旦用户投票，所有按钮都被禁用，这样他们就不会重复投票。然而，这个应用程序并不是万无一失的，因为它不需要用户登录，因此，一个用户可以通过重复刷新页面来投多张票。因此，这只是一个实时演示:)</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff la"><img src="../Images/5398f7420790a2945093dbe2cf34be2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4cx6XG3-UkWBaT2rXLgAzg.jpeg"/></div></div></figure><h1 id="ca62" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">演示</h1><p id="6f44" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">如果你只是想试试最终的结果，打开浏览器，打开angular应用程序，这里是<a class="ae jp" href="https://188l9p4jj.codesandbox.io/" rel="noopener ugc nofollow" target="_blank"/>。现在从手机或另一个浏览器窗口/选项卡，打开投票应用程序托管，<a class="ae jp" href="http://tiny.cc/realtime-voting" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="490d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">完整的源代码存放在我的<a class="ae jp" href="https://github.com/Srushtika/realtime-voting" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>上。</p><h1 id="ae21" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">我们将使用什么？</h1><p id="8a8d" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">我们将使用一些JavaScript框架和库，这将使我们的工作变得更容易和更可展示。</p><h2 id="aebc" class="lk jr hu bd js ll lm ln jw lo lp lq ka jc lr ls ke jg lt lu ki jk lv lw km lx dt translated">1.能够实现实时功能</h2><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/9a81e9534336848b12561dbf469738bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*PzBxXwB9ydQRyPJmgYR4BQ.png"/></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Ably Realtime</figcaption></figure><p id="d32b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">是一个优秀的实时消息平台，可以很容易地为我们的应用程序添加实时功能。它附带了实时库和REST库，根据用例来使用。对于我们的应用程序，我们将使用Ably的实时库，它允许我们通过WebSockets连接到平台。为此，您首先需要在这里创建一个新帐户(您可以免费获得一个)<a class="ae jp" href="https://ably.com/" rel="noopener ugc nofollow" target="_blank">并从仪表盘获取一个应用程序URL。</a></p><h2 id="da46" class="lk jr hu bd js ll lm ln jw lo lp lq ka jc lr ls ke jg lt lu ki jk lv lw km lx dt translated">2.用于构建漂亮图表的Chart.js</h2><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff lz"><img src="../Images/2ff09e407e2672a8e95c3510f542639a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3-xgZUKr4ruD1FNL-xaMQ.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Chart.js is a library for implementing various types of charts</figcaption></figure><p id="cc93" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Chart.js 是一个库，它让我们可以轻松地包含漂亮的图形，这些图形代表静态或动态变化的数据。我们将使用Chart.js来显示用户的投票。</p><h2 id="09cf" class="lk jr hu bd js ll lm ln jw lo lp lq ka jc lr ls ke jg lt lu ki jk lv lw km lx dt translated">3.Angular 4 CLI作为前端框架</h2><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff ma"><img src="../Images/fc9a1f8299a64560e361d10c83bf3db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lIxV3pnc7O5s5B-q.jpg"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Angular Command Line Interface</figcaption></figure><p id="b8b8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们使用Angular 4构建投票应用程序。为什么？因为Angular是一个非常好的构建前端web应用的JavaScript框架。展望未来，Angular有潜力利用像<a class="ae jp" href="https://ably.com/" rel="noopener ugc nofollow" target="_blank"> Ably </a>这样的平台，漂亮地呈现实时获得的数据。如果你的系统上还没有安装这个软件，请按照<a class="ae jp" href="https://cli.angular.io/" rel="noopener ugc nofollow" target="_blank">网站</a>上的<a class="ae jp" href="https://cli.angular.io/" rel="noopener ugc nofollow" target="_blank">这些</a>简单步骤操作。</p><h1 id="555a" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">入门指南</h1><p id="7f4a" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">我们将详细了解angular应用程序，它显示了实时投票数的图表。然而，我们将只浏览带有三个按钮的客户端应用程序，让用户投票，因为它非常简单！</p><p id="1381" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">注意:本教程是如何构建应用程序的高级概述，如果您希望复制代码，请访问<a class="ae jp" href="https://github.com/Srushtika/realtime-voting" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>。</p><h2 id="568f" class="lk jr hu bd js ll lm ln jw lo lp lq ka jc lr ls ke jg lt lu ki jk lv lw km lx dt translated">在macOS终端上通过CLI创建新的Angular4应用程序</h2><p id="f817" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">在我们开始之前，请确保您的计算机上安装了节点包管理器(<a class="ae jp" href="https://www.npmjs.com/get-npm" rel="noopener ugc nofollow" target="_blank"> npm </a>)和<a class="ae jp" href="https://cli.angular.io/" rel="noopener ugc nofollow" target="_blank"> Angular CLI </a>。</p><p id="3935" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先创建一个新的Angular应用程序。我把它命名为<em class="mb">ng-vote ably</em>，可以随意修改。</p><p id="7dce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，移动到新的项目文件夹，并在您的浏览器上本地提供该应用程序，以确保初始设置没有问题。</p><p id="49df" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果到目前为止一切正常，我们将开始创建一个新的组件来保存我们的图表。我已经将组件命名为<em class="mb">投票图</em>，可以随意修改。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff mc"><img src="../Images/35553365899d0ca3f3b7d3b2c6744045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4D5jZXLeo0vNJE_YLt9gcw.png"/></div></div></figure><p id="928e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，在src文件夹内的index.html文件中，分别为Ably和Chart.js添加两个脚本，如下所示:</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff md"><img src="../Images/cde5a99d1fe52c81cf8db1c16ec07cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GYMMaEOI_t8Z5IahSc1HIQ.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">index.html</figcaption></figure><p id="b249" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，导航到src-&gt;app-&gt;app.component.ts，并将其修改为包含以下内容:</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff me"><img src="../Images/e13e7c9187eaefb0825d5bb37ebd98de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gZBVKb5GSyTYsINJ3o9hBA.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">app.component.html</figcaption></figure><p id="0ffe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请注意，还添加了一个新标记“app-vote-chart ”,它将保存我们之前创建的新组件的内容。</p><p id="e489" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">“title”变量是在src-&gt;app-&gt;app.component.ts中声明的。将它的内容修改为“Vikings ”,以便在插入HTML文件时，它会有一些意义。</p><h2 id="8589" class="lk jr hu bd js ll lm ln jw lo lp lq ka jc lr ls ke jg lt lu ki jk lv lw km lx dt translated">投票图表组件</h2><p id="0b51" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">现在让我们写一些真正的代码吧！</p><p id="21fa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在组件的HTML文件中，添加一个新的div，它将包含我们图形的画布，如下所示:</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff mf"><img src="../Images/aa9c66ecf71ed53484c7ea8fe5faa891.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phsJKslCxcweWDmdSffEvg.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">vote-chart.component.html</figcaption></figure><p id="5fad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，在组件的TS文件中，我们将连接到Ably的实时库，使用:</p><blockquote class="mg mh mi"><p id="6b8b" class="ir is mb it b iu iv iw ix iy iz ja jb mj jd je jf mk jh ji jj ml jl jm jn jo hn dt translated">这是新的。实时(<your-app-url>)；</your-app-url></p></blockquote><p id="4958" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">附加到用户将在其上发布投票的频道，如下所示:</p><blockquote class="mg mh mi"><p id="8c6a" class="ir is mb it b iu iv iw ix iy iz ja jb mj jd je jf mk jh ji jj ml jl jm jn jo hn dt translated">this . receive channel = this . ably . channels . get(' vote-channel ')；</p></blockquote><p id="28fa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，订阅该通道上的更新，以便在该通道上发布任何数据(新投票)时触发回调函数，如下所示:</p><blockquote class="mg mh mi"><p id="e3a6" class="ir is mb it b iu iv iw ix iy iz ja jb mj jd je jf mk jh ji jj ml jl jm jn jo hn dt translated">this . receive channel . subscribe(" update "，function(message: any) {}</p></blockquote><p id="38f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是在这样做之前，一定要导入chart.js并声明Ably变量。我们的目标是每当用户在名为“投票频道”的频道上发布任何投票时更新图表，如下所示。您的<em class="mb"> vote-chart.component.ts </em>文件应该包含以下内容:</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff mm"><img src="../Images/215a51433dc5231ed86177fb97fb7da2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CFEMz7zDk0vRfLzx5JYq3A.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">vote-chart.component.ts</figcaption></figure><p id="3bbc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如上所示，我们创建了一个新图表，并设置了标签和来自投票发布者的实际数据。此外，每种投票都有不同的背景颜色。对于每一个公布的投票，我们增加一个简单的计数器，并更新图表以反映这些新数据。</p><h2 id="607a" class="lk jr hu bd js ll lm ln jw lo lp lq ka jc lr ls ke jg lt lu ki jk lv lw km lx dt translated">发布投票</h2><p id="5faa" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">包含可以用来投票的按钮的应用程序的完整代码可以在<a class="ae jp" href="https://glitch.com/edit/#!/clear-pirate" rel="noopener ugc nofollow" target="_blank">这里</a>找到。这是一个简单的JavaScript应用程序，当点击一个按钮时，它在“投票-频道”上发布投票，如下所示:</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff mn"><img src="../Images/8c28cfd6e73f24a6597d8c9b2f74b8b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxOteha7cfQdAhAEFRDfUA.png"/></div></div></figure><h1 id="a7dd" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">就是这样！</h1><p id="56a7" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">你的实时投票程序已经准备好了。如果你在实现这个应用程序时有任何困难，或者如果你有任何问题，请随时通过评论这个帖子或通过<a class="ae jp" href="http://twitter.com/Srushtika" rel="noopener ugc nofollow" target="_blank"> Twitter </a>联系我。</p><p id="0a40" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想了解实时技术世界的最新动态，订阅Ably的时事通讯吧！</p><figure class="kp kq kr ks fq kt"><div class="bz el l di"><div class="mo mp l"/></div></figure><p id="3d29" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你觉得这个教程有帮助，请鼓掌并分享:)</p></div></div>    
</body>
</html>