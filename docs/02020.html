<html>
<head>
<title>git greenbase means never pulling a broken build</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">git greenbase意味着永远不要退出一个失败的构建</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/git-greenbase-means-never-pulling-a-broken-build-165d36b005ce?source=collection_archive---------29-----------------------#2018-03-05">https://medium.com/hackernoon/git-greenbase-means-never-pulling-a-broken-build-165d36b005ce?source=collection_archive---------29-----------------------#2018-03-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/ea79e522bd0b33f03493c790bebd9e6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*GsdDyY8dcxhgkrhH_Tj8Pw.png"/></div></figure><p id="491e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果您的团队使用Git和持续集成，那么您的工作流很有可能受益于<code class="eh jw jx jy jz b">git greenbase</code>。但是首先，戴上你的虚拟现实耳机，通过我们经验丰富的开发人员Karen的眼睛体验一下<code class="eh jw jx jy jz b">git pull</code>的危险。</p><h1 id="597e" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">凯伦vs破碎的建筑</h1><p id="dded" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated">你带着晨跑的疲惫，脸上带着微笑，迈着轻快的步伐去上班——灯泡在跑步途中熄灭了:你知道为什么身份服务在每天早上11:48就停止了。启动控制台，你<code class="eh jw jx jy jz b">cd</code>到正确的回购和<code class="eh jw jx jy jz b">git pull</code>从你的指尖敏捷地流动，你的脚跟敲打出播放列表上最后一首歌的节拍；这是个好主意。</p><p id="ab1d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">Git决定它需要重新打包并清除你的超大回购上的垃圾。你微微翻了翻眼睛，但没关系——今天没有什么能让你沮丧。你瞬间进出Vim。很难相信这样一个简单的三行变化会减轻这么多的痛苦。你看了一眼时钟。在每日站立会议之前进行代码审查是有可能的。只剩下一件事要做…运行测试。</p><blockquote class="ld le lf"><p id="5dcc" class="iy iz lg ja b jb jc jd je jf jg jh ji lh jk jl jm li jo jp jq lj js jt ju jv hn dt translated"><em class="hu">“真好笑……”</em></p></blockquote><p id="8033" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">“真有意思……17次测试失败？？?"你惊恐地皱起眉头。“我的改变怎么可能打破时间窗口”，你摇摇头想。在下面，你曾经快乐的脚停止了跳动，它的好节拍被遗忘了。</p><p id="3c13" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">接下来的10分钟像美洲狮一样悄悄溜过你，因为你倾倒了所有的源文件，甚至与你的修复有一点点关系。还是一无所获。屏幕上的一个光点就像一个冷馅饼砸在脸上一样，让你无法集中注意力。"你要来单口相声吗？"哎呀，我迟到了！</p><p id="6dbc" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在敏捷的大半圆附近，你侧身走到你的伙伴安妮旁边，像土狼一样停了下来。每个人看起来都有点被逗乐了，但他们没有看着你。汤姆为弄坏了房子道歉。</p><p id="02bf" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">“对不起，各位，我迟到了”，你温顺地插嘴说。"我在看一些我打破的测试。"</p><p id="d6ba" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">汤姆不好意思地看着你。"有没有可能，它们是时间控件中的17个测试？"</p><p id="c05e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">向前弯腰，你发出一声过于戏剧性的愤怒沮丧的叹息。</p><p id="5469" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">队员们扫视了一下四周，然后大笑起来。这是一种会心的笑声，一种同情和相互理解的笑声。</p><h1 id="d842" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">香草<code class="eh jw jx jy jz b">git pull</code>的不足之处</h1><p id="550c" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated">在我们的故事里你发生了什么？你拉了一个破碎的建筑！这让你徒劳地寻找一个不是你造成的问题。</p><p id="0bbf" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">你跑去<code class="eh jw jx jy jz b">git pull</code>拉最新的变更，但是仔细想想，你真的想要<em class="lg">最新的</em>变更吗？或者你想要最新的<em class="lg">好的</em>变化？当人们建造房子时，他们需要时间准备土地和地基。他们不会在一堆垃圾上开始建造。同样，当我们开始开发一个新的特性或缺陷修复时，我们应该从一个已知的好地方开始。这让你相信任何构建或测试失败都是你的错，而不是安妮、汤姆或那个在办公室里骑独轮车的实习生的错。</p><p id="2e43" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果您的团队实践<a class="ae lk" href="https://www.thoughtworks.com/continuous-integration" rel="noopener ugc nofollow" target="_blank">持续集成(CI) </a>并拥有一套可靠的自动化测试，那么您的CI服务器就是构成“已知良好构建”的事实来源。</p><h1 id="c92f" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated"><code class="eh jw jx jy jz b">git greenbase</code>来救援了！</h1><p id="18b7" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated">这就是<code class="eh jw jx jy jz b">git greenbase</code>的用武之地。不要像老虎机一样盲目地运行<code class="eh jw jx jy jz b">git pull</code>并期待最好的结果，而是运行<code class="eh jw jx jy jz b">git greenbase</code>。它会向您的CI服务器查询最新的通过的<em class="lg">，或者“绿色”版本，然后重置您的本地主机以匹配。瞧啊。<code class="eh jw jx jy jz b">master</code>现在处于已知的良好状态。满怀信心地启动您的编码引擎！</em></p><h1 id="8835" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">地方特色分支呢？</h1><p id="7c53" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated">如果你在跟踪<code class="eh jw jx jy jz b">master</code>的本地特征分支上，并且你的团队使用基于rebase的工作流，那么<code class="eh jw jx jy jz b">git greenbase</code>仍然重置<code class="eh jw jx jy jz b">master</code>以匹配绿色构建，但是它<em class="lg">也</em>在主的顶部重新设置你的本地特征分支。很酷吧。</p><h1 id="bf55" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">安装<code class="eh jw jx jy jz b">git greenbase</code></h1><p id="9db8" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated"><code class="eh jw jx jy jz b">git greenbase</code>安详地坐在Github上:<a class="ae lk" href="https://github.com/tygerbytes/git-greenbase" rel="noopener ugc nofollow" target="_blank">https://github.com/tygerbytes/git-greenbase</a>。如果你使用的是Linux，安装如下:</p><pre class="ll lm ln lo fq lp jz lq lr aw ls dt"><span id="47e0" class="lt kb hu jz b fv lu lv l lw lx">git clone <a class="ae lk" href="https://github.com/tygerbytes/git-greenbase.git" rel="noopener ugc nofollow" target="_blank">https://github.com/tygerbytes/git-greenbase.git</a> cd git-greenbase ./install</span></pre><p id="6948" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><code class="eh jw jx jy jz b">./install</code>脚本将创建一个到git-greenbase的符号链接，并将其添加到您的路径中。Git会在您的路径中找到它，并允许您运行<code class="eh jw jx jy jz b">git greenbase</code>，就像任何Git命令一样。</p><p id="b81d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">(最新安装说明见<a class="ae lk" href="https://github.com/tygerbytes/git-greenbase#installation" rel="noopener ugc nofollow" target="_blank">报告</a>。)</p><h1 id="261d" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">但是Mac和Windows呢？</h1><p id="d750" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated">截至2018年3月，git greenbase仅在Linux上进行了测试。它<em class="lg">可能</em>也适用于Mac OS X。它很可能无法像Windows上的那样运行<strong class="ja hv">。我完全接受拉请求。如果需求足够大，我会用PowerShell写一个版本。</strong></p><h1 id="5f26" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">配置<code class="eh jw jx jy jz b">git greenbase</code>与您的CI提供者一起工作</h1><p id="9f3c" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated">现在它已经安装好了，您如何配置它来与您的CI提供者一起工作呢？通常，您需要向Git提供CI服务器的URL、API令牌和项目的ID。信息存储在您的Git配置中。</p><p id="01c0" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">例如，如果您使用Travis CI，您将运行类似于以下内容的命令:</p><pre class="ll lm ln lo fq lp jz lq lr aw ls dt"><span id="7224" class="lt kb hu jz b fv lu lv l lw lx">git config <strong class="jz hv">greenbase</strong>.<strong class="jz hv">provider </strong>travisci<br/>git config greenbase.<strong class="jz hv">travisci.token</strong> <em class="lg">&lt;TOKEN&gt;</em><br/>git config greenbase.travisci.<strong class="jz hv">serverUri </strong><em class="lg">&lt;SERVER_URI&gt;</em><br/>git config greenbase.travisci.<strong class="jz hv">repoId </strong><em class="lg">&lt;GITHUB_REPO_ID&gt;</em></span></pre><p id="9803" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">(<a class="ae lk" href="https://github.com/tygerbytes/git-greenbase#configuring-a-ci-provider" rel="noopener ugc nofollow" target="_blank">最新配置说明见repo </a>。)</p><h2 id="cb74" class="lt kb hu bd kc ly lz ma kg mb mc md kk jj me mf ko jn mg mh ks jr mi mj kw mk dt translated">支持哪些CI提供程序？</h2><p id="338a" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated">截至2018年3月，OSS盒子支持的CI提供商只有:</p><ul class=""><li id="aa15" class="ml mm hu ja b jb jc jf jg jj mn jn mo jr mp jv mq mr ms mt dt translated">Gitlab</li><li id="7ec5" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated">特拉维斯·CI</li><li id="a1ff" class="ml mm hu ja b jb mu jf mv jj mw jn mx jr my jv mq mr ms mt dt translated">TFS(未经充分测试)</li></ul><p id="9b27" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这是一个很短的列表！如果您想添加对另一个CI提供程序的支持，请随时向我发送请求。见下文“促进发展”</p><h1 id="e0b5" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">为<code class="eh jw jx jy jz b">git greenbase</code>发展做出贡献</h1><p id="e5bc" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated"><code class="eh jw jx jy jz b">git greenbase</code>用Bash编写，并使用<a class="ae lk" href="https://github.com/sstephenson/bats" rel="noopener ugc nofollow" target="_blank"> Bats测试框架</a>进行测试。</p><p id="42c4" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">为了可测试性和可维护性，我尽力以模块化的方式设计它。例如，与每个CI提供者通信的逻辑存在于它自己的Bash脚本中，它的Bats测试与它在同一个目录中。</p><p id="2d78" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">就我个人而言，<a class="ae lk" href="https://twitter.com/tygertec/status/832089675301003266" rel="noopener ugc nofollow" target="_blank"> Bash不是我最喜欢的语言</a>，我也不是一个超级熟练的Bash开发者。也就是说，我觉得像<code class="eh jw jx jy jz b">git greenbase</code>这样的工具会给DevOps带来更多的和平、爱和蝴蝶。所以我坚持。:)</p><p id="4469" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">最新开发详情见<a class="ae lk" href="https://github.com/tygerbytes/git-greenbase/blob/master/DEVELOPMENT.md" rel="noopener ugc nofollow" target="_blank">开发页面</a>。</p><h1 id="88fc" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">我能请你喝杯咖啡吗？</h1><p id="ce98" class="pw-post-body-paragraph iy iz hu ja b jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv hn dt translated">如果你对<code class="eh jw jx jy jz b">git greenbase</code>和它拯救了你和你的团队的所有痛苦感到超级兴奋，请给我买杯咖啡。我发现咖啡是一个巨大的动力。</p></div><div class="ab cl mz na hc nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="hn ho hp hq hr"><p id="558b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><em class="lg">原载于2018年3月5日tygertec.com</em><em class="lg">的</em><a class="ae lk" href="https://tygertec.com/git-greenbase/" rel="noopener ugc nofollow" target="_blank">T22。</a></p></div></div>    
</body>
</html>