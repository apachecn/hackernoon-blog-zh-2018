<html>
<head>
<title>Real-time API Monitoring Using GO and Pusher</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨GOå’ŒPusherè¿›è¡Œå®æ—¶APIç›‘æ§</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/real-time-api-monitoring-using-go-and-pusher-4e57c4e80cac?source=collection_archive---------8-----------------------#2018-03-08">https://medium.com/hackernoon/real-time-api-monitoring-using-go-and-pusher-4e57c4e80cac?source=collection_archive---------8-----------------------#2018-03-08</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/a0f09ae0d92b19ea2f26fcfc495ca93d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GkRPNOGl8xDtiqOsUTKgTg.jpeg"/></div></div></figure><blockquote class="jc jd je"><p id="9f4d" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">æŠ«éœ²:<a class="ae ke" href="https://goo.gl/52hnDL" rel="noopener ugc nofollow" target="_blank">ä¸ºå¼€å‘è€…æä¾›å®æ—¶APIçš„Pusher </a>ï¼Œæ­¤å‰æ›¾èµåŠ©è¿‡é»‘å®¢Noonã€‚</p><p id="985a" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">é˜…è¯»æœ¬æ•™ç¨‹éœ€è¦å¯¹Goå’ŒJavaScriptæœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ã€‚</p></blockquote><p id="561a" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">RESTæ˜¯ä¸€ç§æµè¡Œçš„æ¶æ„é£æ ¼ï¼Œç”¨äºåœ¨webä¸Šçš„è®¡ç®—æœºç³»ç»Ÿä¹‹é—´æä¾›æ ‡å‡†ï¼Œä½¿ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡æ›´åŠ å®¹æ˜“ã€‚å®ƒä¸»è¦è¢«APIç”¨æ¥å‘å…¶ä»–éœ€è¦æ•°æ®çš„ç³»ç»Ÿæä¾›æ•°æ®ã€‚</p><p id="91f4" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æœ‰æ—¶ï¼ŒAPIçš„æä¾›è€…æƒ³è¦ç›‘æ§å®ƒçš„ä½¿ç”¨ã€‚ç›‘æ§APIæœ‰åŠ©äºæä¾›æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å“ªäº›ç«¯ç‚¹è¢«æœ€é¢‘ç¹åœ°è°ƒç”¨ï¼Œæˆ–è€…å“ªäº›åŒºåŸŸæ˜¯ä½¿ç”¨è¯·æ±‚IPåœ°å€çš„æœ€å¤§å—ä¼—ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥ç”¨æ¥ä¼˜åŒ–APIã€‚</p><p id="03b5" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Pusherå®ç°å¯¹ç”¨GoLangæ„å»ºçš„å°å‹APIçš„å®æ—¶ç›‘æ§ã€‚ä¸‹é¢æ˜¯å®ƒæœ€ç»ˆåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­çš„é¢„è§ˆ:</p><figure class="kj kk kl km fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ki"><img src="../Images/4a9036a697db0b42b7fecd2462077925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*uxk2Dhe1apJP8iKvRbmh0A.gif"/></div></div></figure><h1 id="6fd5" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">è¦æ±‚</h1><p id="eb6e" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">è¦é˜…è¯»æœ¬æ–‡ï¼Œæ‚¨éœ€è¦ä»¥ä¸‹å†…å®¹:</p><ul class=""><li id="8700" class="lq lr hu ji b jj jk jn jo kf ls kg lt kh lu kd lv lw lx ly dt translated">æ‚¨é€‰æ‹©çš„IDEï¼Œä¾‹å¦‚<a class="ae ke" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio Code </a>ã€‚</li><li id="5445" class="lq lr hu ji b jj lz jn ma kf mb kg mc kh md kd lv lw lx ly dt translated"><a class="ae ke" href="https://golang.org/doc/install" rel="noopener ugc nofollow" target="_blank">è½¬åˆ°</a>å®‰è£…åœ¨ä½ çš„ç”µè„‘ä¸Šã€‚</li><li id="990e" class="lq lr hu ji b jj lz jn ma kf mb kg mc kh md kd lv lw lx ly dt translated">GoLangåŸºç¡€çŸ¥è¯†ã€‚</li><li id="5775" class="lq lr hu ji b jj lz jn ma kf mb kg mc kh md kd lv lw lx ly dt translated">JavaScript (ES6è¯­æ³•)å’ŒjQueryçš„åŸºç¡€çŸ¥è¯†ã€‚</li><li id="203e" class="lq lr hu ji b jj lz jn ma kf mb kg mc kh md kd lv lw lx ly dt translated">ä½¿ç”¨CLIå·¥å…·æˆ–ç»ˆç«¯çš„åŸºæœ¬çŸ¥è¯†ã€‚</li></ul><p id="acf4" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ä¸€æ—¦ä½ å…·å¤‡äº†ä»¥ä¸Šæ‰€æœ‰è¦æ±‚ï¼Œæˆ‘ä»¬å°±å¼€å§‹å§ã€‚</p><h1 id="065e" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">å»ºç«‹æˆ‘ä»¬çš„ä»£ç åº“</h1><p id="316e" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å·²ç»ç¼–å†™å¥½çš„GoLang CRUD APIï¼Œå®ƒå¯ä»¥åœ¨<a class="ae ke" href="https://github.com/neoighodaro/go-pusher-api-monitor/tree/master/api-goggles" rel="noopener ugc nofollow" target="_blank"> GitHub </a>ä¸Šè·å¾—ã€‚æˆ‘ä»¬å°†åˆ†å‰è¿™ä¸ªåº“ï¼Œå¹¶æŒ‰ç…§<strong class="ji hv"> README.md </strong>å®‰è£…æŒ‡å—æ¥è®¾ç½®å®ƒã€‚</p><p id="4519" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨APIé¡¹ç›®ä¸­è®¾ç½®Pusherã€‚Pusheræ˜¯ä¸€ç§ä¸ºæˆ‘ä»¬çš„webå’Œç§»åŠ¨åº”ç”¨ç¨‹åºæä¾›å®æ—¶åŠŸèƒ½çš„ç®€å•å®ç°çš„æœåŠ¡ã€‚æˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­ä½¿ç”¨å®ƒï¼Œä¸ºæˆ‘ä»¬çš„API monitorä»ªè¡¨æ¿æä¾›å®æ—¶æ›´æ–°ã€‚</p><p id="4eaf" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">è®©æˆ‘ä»¬å‰å¾€Pusher.comï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰ä¸€ä¸ªå…è´¹è´¦æˆ·ï¼Œä½ å¯ä»¥<a class="ae ke" href="https://pusher.com/signup?plan=sandbox" rel="noopener ugc nofollow" target="_blank">åˆ›å»ºä¸€ä¸ªã€‚åœ¨</a><a class="ae ke" href="https://dashboard.pusher.com/" rel="noopener ugc nofollow" target="_blank">ä»ªè¡¨æ¿</a>ä¸Šï¼Œåˆ›å»ºä¸€ä¸ªæ–°åº”ç”¨å¹¶å¤åˆ¶åº”ç”¨å‡­è¯(åº”ç”¨IDã€å¯†é’¥ã€å¯†ç å’Œé›†ç¾¤)ã€‚æˆ‘ä»¬å°†åœ¨APIä¸­ä½¿ç”¨è¿™äº›å‡­è¯ã€‚</p><p id="6795" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†Pusheråº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å°†é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…Pusher Goåº“:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="644d" class="mj ko hu mf b fv mk ml l mm mn">$ go get github.com/pusher/pusher-http-go</span></pre><h1 id="4a1c" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">ç›‘æ§æˆ‘ä»¬çš„API</h1><p id="d828" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å»ºç«‹äº†ä¸€ä¸ªåŠŸèƒ½æ€§çš„CRUD APIï¼Œç°åœ¨æˆ‘ä»¬å°†å®ç°å¯¹å®ƒçš„ç›‘æ§è°ƒç”¨ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ç›‘æ§:</p><ul class=""><li id="2c45" class="lq lr hu ji b jj jk jn jo kf ls kg lt kh lu kd lv lw lx ly dt translated">è¢«è°ƒç”¨çš„ç«¯ç‚¹çš„è¯¦ç»†ä¿¡æ¯åŒ…æ‹¬åç§°ã€è¯·æ±‚ç±»å‹(GETã€POSTç­‰)å’ŒURLã€‚</li><li id="29ca" class="lq lr hu ji b jj lz jn ma kf mb kg mc kh md kd lv lw lx ly dt translated">å¯¹äºæ¯ä¸ªå¯¹ç«¯ç‚¹çš„è°ƒç”¨ï¼Œæˆ‘ä»¬è¿˜ä¼šæ³¨æ„åˆ°:</li><li id="d1c2" class="lq lr hu ji b jj lz jn ma kf mb kg mc kh md kd lv lw lx ly dt translated">è¯·æ±‚IPåœ°å€åˆ é™¤ï¼Œ</li><li id="c236" class="lq lr hu ji b jj lz jn ma kf mb kg mc kh md kd lv lw lx ly dt translated">ç‰¹å®šå‘¼å«çš„å“åº”çŠ¶æ€ä»£ç ã€‚</li></ul><p id="f84f" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æ—¢ç„¶æˆ‘ä»¬å·²ç»å®šä¹‰äº†è¦ç›‘æ§çš„å†…å®¹ï¼Œæˆ‘ä»¬å°†å¼€å§‹åˆ›å»ºæ¨¡å‹æ¥è·Ÿè¸ªæˆ‘ä»¬è·å–çš„æ•°æ®ã€‚</p><h1 id="bd5a" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">åˆ›å»ºç›‘æ§æ¨¡å‹</h1><p id="43a5" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">åŸºäºæˆ‘ä»¬ä¸Šé¢çš„è§„èŒƒï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªæ–°çš„æ¨¡å‹æ–‡ä»¶<code class="eh mo mp mq mf b">EndPoints.go</code>å’Œ<code class="eh mo mp mq mf b">EndPointCalls.go</code>ã€‚æ­£å¦‚åœ¨åŸºç¡€APIä¸­æ‰€ä½¿ç”¨çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<a class="ae ke" href="http://jinzhu.me/gorm/" rel="noopener ugc nofollow" target="_blank">GORM</a>(GoLang ORM)æ¥ç®¡ç†æ•°æ®å­˜å‚¨ã€‚</p><blockquote class="jc jd je"><p id="23be" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="hu">ğŸ’¡æˆ‘ä»¬çš„æ–°æ¨¡å‹æ–‡ä»¶å°†å­˜åœ¨äºmodelsç›®å½•ä¸­ï¼Œå¹¶å±äºmodelsåŒ…ã€‚</em></p></blockquote><p id="3f3f" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">åœ¨<code class="eh mo mp mq mf b">EndPoints.go</code>ä¸­ï¼Œæˆ‘ä»¬å°†å®šä¹‰<code class="eh mo mp mq mf b">EndPoints</code>å¯¹è±¡å’Œä¸€ä¸ªä¿å­˜ç«¯ç‚¹çš„æ–¹æ³•:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="0e39" class="mj ko hu mf b fv mk ml l mm mn">package models</span><span id="2fd3" class="mj ko hu mf b fv mr ml l mm mn">import (<br/>    "github.com/jinzhu/gorm"<br/>)</span><span id="4a1e" class="mj ko hu mf b fv mr ml l mm mn">// EndPoints - endpoint model<br/>type EndPoints struct {<br/>    gorm.Model<br/>    Name, URL string<br/>    Type      string          `gorm:"DEFAULT:'GET'"`<br/>    Calls     []EndPointCalls `gorm:"ForeignKey:EndPointID"`<br/>}</span><span id="8148" class="mj ko hu mf b fv mr ml l mm mn">// SaveOrCreate - save endpoint called<br/>func (ep EndPoints) SaveOrCreate() EndPoints {<br/>    db.FirstOrCreate(&amp;ep, ep)<br/>    return ep<br/>}</span></pre><p id="f929" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">åœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæˆ‘ä»¬çš„æ¨¡å‹æ²¡æœ‰é‡æ–°åˆå§‹åŒ–GORMå®ä¾‹<code class="eh mo mp mq mf b">db</code>ï¼Œä½†æ˜¯å®ƒè¢«ä½¿ç”¨äº†ã€‚è¿™æ˜¯å› ä¸ºåœ¨<code class="eh mo mp mq mf b">Movies.go</code>æ–‡ä»¶ä¸­å®šä¹‰çš„å®ä¾‹å¯¹äºåŒ…çš„æ‰€æœ‰æˆå‘˜éƒ½æ˜¯å…¨å±€çš„ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«<code class="eh mo mp mq mf b">package models</code>çš„æ‰€æœ‰æˆå‘˜å¼•ç”¨å’Œä½¿ç”¨ã€‚</p><blockquote class="jc jd je"><p id="1cf8" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="hu">ğŸ’¡æˆ‘ä»¬çš„ç«¯ç‚¹æ¨¡å‹æœ‰ä¸€ä¸ªå±æ€§</em> <code class="eh mo mp mq mf b"><em class="hu">Calls</em></code> <em class="hu">ï¼Œå®ƒæ˜¯ä¸€ä¸ª</em> <code class="eh mo mp mq mf b"><em class="hu">EndPointCalls</em></code> <em class="hu">å¯¹è±¡çš„æ•°ç»„ã€‚è¯¥å±æ€§è¡¨ç¤º</em><a class="ae ke" href="http://jinzhu.me/gorm/associations.html#has-many" rel="noopener ugc nofollow" target="_blank"><em class="hu"/></a><em class="hu"/><code class="eh mo mp mq mf b"><em class="hu">EndPoints</em></code><em class="hu"/><code class="eh mo mp mq mf b"><em class="hu">EndPointCalls</em></code><em class="hu">ä¹‹é—´çš„ä¸€å¯¹å¤šå…³ç³»ã€‚æœ‰å…³æ¨¡å‹å…³è”å’Œå…³ç³»çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§GORM </em> <a class="ae ke" href="http://jinzhu.me/gorm/associations.html" rel="noopener ugc nofollow" target="_blank"> <em class="hu">æ–‡æ¡£</em> </a> <em class="hu">ã€‚</em></p></blockquote><p id="c98b" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨<code class="eh mo mp mq mf b">EndPointCalls.go</code>æ–‡ä»¶ä¸­å¡«å……<code class="eh mo mp mq mf b">EndPointCalls</code>æ¨¡å‹çš„æ¨¡å‹å®šä¹‰å’Œæ–¹æ³•:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="8d49" class="mj ko hu mf b fv mk ml l mm mn">package models</span><span id="40c1" class="mj ko hu mf b fv mr ml l mm mn">import (<br/>    "github.com/jinzhu/gorm"<br/>    "github.com/kataras/iris"<br/>)</span><span id="48b4" class="mj ko hu mf b fv mr ml l mm mn">// EndPointCalls - Object for storing endpoints call details<br/>type EndPointCalls struct {<br/>    gorm.Model<br/>    EndPointID   uint `gorm:"index;not null"`<br/>    RequestIP    string<br/>    ResponseCode int<br/>}</span><span id="a2b9" class="mj ko hu mf b fv mr ml l mm mn">// SaveCall - Save the call details of an endpoint<br/>func (ep EndPoints) SaveCall(context iris.Context) EndPointCalls {<br/>    epCall := EndPointCalls{<br/>        EndPointID:   ep.ID,<br/>        RequestIP:    context.RemoteAddr(),<br/>        ResponseCode: context.GetStatusCode(),<br/>    }</span><span id="137e" class="mj ko hu mf b fv mr ml l mm mn">    db.Create(&amp;epCall)<br/>    <br/>    return epCall<br/>}</span></pre><p id="7dc4" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬çš„<code class="eh mo mp mq mf b">EndPointCalls</code>æ¨¡å‹å®šä¹‰äº†ä¸€ä¸ª<code class="eh mo mp mq mf b">SaveCall</code>æ–¹æ³•ï¼Œå®ƒå­˜å‚¨äº†ä¸€ä¸ªç°æœ‰<code class="eh mo mp mq mf b">EndPoint</code>å¯¹è±¡çš„è¯·æ±‚IPåœ°å€å’Œå“åº”ä»£ç ã€‚</p><p id="c83f" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æœ€åï¼Œæˆ‘ä»¬å°†æ›´æ–°<code class="eh mo mp mq mf b">index.go</code>æ–‡ä»¶ä¸­çš„æ¨¡å‹è¿ç§»ï¼Œä»¥åŒ…å«æˆ‘ä»¬çš„æ–°æ¨¡å‹:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="7b3f" class="mj ko hu mf b fv mk ml l mm mn">// index.go<br/>// ...</span><span id="20c7" class="mj ko hu mf b fv mr ml l mm mn">func main() {<br/>    // ...</span><span id="b1fc" class="mj ko hu mf b fv mr ml l mm mn">    // Initialize ORM and auto migrate models<br/>    db, _ := gorm.Open("sqlite3", "./db/gorm.db")<br/>    db.AutoMigrate(&amp;models.Movies{}, &amp;models.EndPoints{}, &amp;models.EndPointCalls{})</span><span id="ea3a" class="mj ko hu mf b fv mr ml l mm mn">    // ...<br/>}</span></pre><h1 id="a81f" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">ä¿å­˜ç”¨äºç›‘æ§çš„ç«¯ç‚¹æ•°æ®</h1><p id="ec84" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">ä½¿ç”¨æˆ‘ä»¬æ–°åˆ›å»ºçš„æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ç¼–è¾‘<code class="eh mo mp mq mf b">MoviesController.go</code>æ–‡ä»¶ï¼Œä»¥ä¾¿åœ¨ç«¯ç‚¹è¢«è°ƒç”¨æ—¶ä¿å­˜ç›¸å…³æ•°æ®ã€‚</p><p id="b80c" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å‘<code class="eh mo mp mq mf b">MoviesController.go</code>æ·»åŠ ä¸€ä¸ªç§æœ‰çš„åŠ©æ‰‹æ–¹æ³•ï¼Œå®ƒå°†ä¿å­˜æ¨¡å‹çš„ç«¯ç‚¹æ•°æ®ã€‚è¯·çœ‹ä¸‹æ–‡:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="995c" class="mj ko hu mf b fv mk ml l mm mn">// MoviesController.go<br/>// ...</span><span id="34f7" class="mj ko hu mf b fv mr ml l mm mn">func (m MoviesController) saveEndpointCall(name string) {<br/>    endpoint := models.EndPoints{<br/>        Name: name,<br/>        URL:  m.Cntx.Path(),<br/>        Type: m.Cntx.Request().Method,<br/>    }</span><span id="10ec" class="mj ko hu mf b fv mr ml l mm mn">    endpoint = endpoint.SaveOrCreate()<br/>    endpointCall := endpoint.SaveCall(m.Cntx)<br/>}</span></pre><p id="6f30" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><code class="eh mo mp mq mf b">saveEndpointCall</code>æ–¹æ³•å°†ç«¯ç‚¹çš„åç§°ä½œä¸ºå‚æ•°ã€‚ä½¿ç”¨æ§åˆ¶å™¨çš„<code class="eh mo mp mq mf b">iris.Context</code>å®ä¾‹ï¼Œå®ƒè¯»å–å¹¶ä¿å­˜ç«¯ç‚¹è·¯å¾„å’Œè¯·æ±‚æ–¹æ³•ã€‚</p><p id="a21f" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ç°åœ¨è¿™ä¸ªå¸®åŠ©å™¨æ–¹æ³•å¯ç”¨äº†ï¼Œæˆ‘ä»¬å°†åœ¨<code class="eh mo mp mq mf b">MoviesController.go</code>æ–‡ä»¶ä¸­çš„æ¯ä¸ªç«¯ç‚¹æ–¹æ³•ä¸­è°ƒç”¨å®ƒ:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="2cc6" class="mj ko hu mf b fv mk ml l mm mn">// MoviesController.go<br/>// ...</span><span id="b97e" class="mj ko hu mf b fv mr ml l mm mn">// Get - get a list of all available movies<br/>func (m MoviesController) Get() {<br/>    movie := models.Movies{}<br/>    movies := movie.Get()</span><span id="0616" class="mj ko hu mf b fv mr ml l mm mn">    go m.saveEndpointCall("Movies List")<br/>    m.Cntx.JSON(iris.Map{"status": "success", "data": movies})<br/>}</span><span id="22d0" class="mj ko hu mf b fv mr ml l mm mn">// GetByID - Get movie by ID<br/>func (m MoviesController) GetByID(ID int64) {<br/>    movie := models.Movies{}<br/>    movie = movie.GetByID(ID)<br/>    if !movie.Validate() {<br/>        msg := fmt.Sprintf("Movie with ID: %v not found", ID)<br/>        m.Cntx.StatusCode(iris.StatusNotFound)<br/>        m.Cntx.JSON(iris.Map{"status": "error", "message": msg})<br/>    } else {<br/>        m.Cntx.JSON(iris.Map{"status": "success", "data": movie})<br/>    }</span><span id="b55a" class="mj ko hu mf b fv mr ml l mm mn">    name := fmt.Sprintf("Single Movie with ID: %v Retrieval", ID)<br/>    go m.saveEndpointCall(name)<br/>}</span><span id="0aed" class="mj ko hu mf b fv mr ml l mm mn">// ...</span></pre><p id="c627" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">å¦‚ä¸Šé¢çš„ä»£ç ç‰‡æ®µæ‰€ç¤ºï¼Œåœ¨æ¯ä¸ªCRUDæ–¹æ³•ä¸­éƒ½å°†è°ƒç”¨<code class="eh mo mp mq mf b">saveEndpointCall</code>åŠ©æ‰‹æ–¹æ³•ã€‚</p><blockquote class="jc jd je"><p id="fc49" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="hu">ğŸ’¡å°†</em> <code class="eh mo mp mq mf b"><em class="hu">saveEndpointCall</em></code> <em class="hu">æ–¹æ³•ç§°ä¸º</em><a class="ae ke" href="https://golangbot.com/goroutines/" rel="noopener ugc nofollow" target="_blank"><em class="hu">Goroutine</em></a><em class="hu">ã€‚ä»¥è¿™ç§æ–¹å¼è°ƒç”¨å®ƒä¼šåœ¨ç«¯ç‚¹æ–¹æ³•æ‰§è¡Œçš„åŒæ—¶è°ƒç”¨å®ƒï¼Œå¹¶å…è®¸æˆ‘ä»¬çš„ç›‘æ§ä»£ç ä¸ä¼šå»¶è¿Ÿæˆ–æŠ‘åˆ¶APIçš„å“åº”ã€‚</em></p></blockquote><h1 id="521b" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">åˆ›å»ºç«¯ç‚¹ç›‘æ§ä»ªè¡¨æ¿</h1><p id="e657" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†å¯¹APIè°ƒç”¨çš„ç›‘æ§ï¼Œæˆ‘ä»¬å°†åœ¨ä»ªè¡¨æ¿ä¸Šæ˜¾ç¤ºæˆ‘ä»¬ç§¯ç´¯çš„æ•°æ®ã€‚</p><h1 id="e02a" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">æ³¨å†Œæˆ‘ä»¬çš„æ¨¡æ¿å¼•æ“</h1><p id="2593" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">GoLangæ¡†æ¶Iriså…·æœ‰å®ç°ä¸€ç³»åˆ—æ¨¡æ¿å¼•æ“çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å°†å……åˆ†åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚</p><p id="bb3e" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å®ç°<strong class="ji hv">è½¦æŠŠ</strong>æ¨¡æ¿å¼•æ“ï¼Œå¹¶ä¸”åœ¨æˆ‘ä»¬çš„<code class="eh mo mp mq mf b">index.go</code>æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒæ³¨å†Œåˆ°appå®ä¾‹:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="f79a" class="mj ko hu mf b fv mk ml l mm mn">// index.go<br/>package main</span><span id="e306" class="mj ko hu mf b fv mr ml l mm mn">import (<br/>    "goggles/controllers"<br/>    "goggles/models"<br/>    "github.com/jinzhu/gorm"<br/>    "github.com/kataras/iris"<br/>)</span><span id="20c4" class="mj ko hu mf b fv mr ml l mm mn">func main() {<br/>    app := iris.New()</span><span id="493c" class="mj ko hu mf b fv mr ml l mm mn">    tmpl := iris.Handlebars("./templates", ".html")  <br/>    app.RegisterView(tmpl)</span><span id="6213" class="mj ko hu mf b fv mr ml l mm mn">    // ...</span><span id="ac0d" class="mj ko hu mf b fv mr ml l mm mn">    app.Run(iris.Addr("127.0.0.1:1234"))<br/>}</span></pre><blockquote class="jc jd je"><p id="b658" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="hu">ğŸ’¡æˆ‘ä»¬å·²ç»å®šä¹‰äº†æˆ‘ä»¬çš„æ¨¡æ¿å¼•æ“(Handlebars)ï¼Œæ¥æ¸²æŸ“åŒ…å«åœ¨</em> <code class="eh mo mp mq mf b"><em class="hu">templates</em></code> <em class="hu">ç›®å½•ä¸­çš„</em> <code class="eh mo mp mq mf b"><em class="hu">.html</em></code> <em class="hu">æ–‡ä»¶ã€‚</em></p></blockquote><h1 id="e7be" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">åˆ›å»ºä»ªè¡¨æ¿çš„è·¯çº¿å’Œæ§åˆ¶å™¨</h1><p id="a6f4" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">æ—¢ç„¶æˆ‘ä»¬å·²ç»å°†æ¨¡æ¿å¼•æ“æ³¨å†Œåˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å°†åœ¨<code class="eh mo mp mq mf b">index.go</code>ä¸­æ·»åŠ ä¸€ä¸ªè·¯ç”±æ¥å‘ˆç°æˆ‘ä»¬çš„API monitorä»ªè¡¨æ¿:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="bb24" class="mj ko hu mf b fv mk ml l mm mn">// index.go<br/>// ...</span><span id="2550" class="mj ko hu mf b fv mr ml l mm mn">func main() {<br/>    app := iris.New()</span><span id="7019" class="mj ko hu mf b fv mr ml l mm mn">    // ...</span><span id="3b36" class="mj ko hu mf b fv mr ml l mm mn">    app.Get("/admin/endpoints", func(ctx iris.Context) {<br/>        dashBoard := controllers.DashBoardController{Cntx: ctx}<br/>        dashBoard.ShowEndpoints()<br/>    })</span><span id="1253" class="mj ko hu mf b fv mr ml l mm mn">    app.Run(iris.Addr("127.0.0.1:1234"))<br/>}</span></pre><p id="21ad" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ä¸Šé¢ï¼Œæˆ‘ä»¬å·²ç»ä¸ºè·¯å¾„/admin/endpointsæ·»åŠ äº†å®šä¹‰ï¼Œæˆ‘ä»¬æ‰“ç®—åœ¨è¿™é‡Œå‘ˆç°APIç«¯ç‚¹åŠå…¶è°ƒç”¨çš„è¯¦ç»†ä¿¡æ¯ã€‚æˆ‘ä»¬è¿˜æŒ‡å®šè·¯ç”±åº”è¯¥ç”±DashBoardControllerçš„ShowEndpointsæ–¹æ³•å¤„ç†ã€‚</p><p id="7dc1" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ä¸ºäº†åˆ›å»ºDashBoardControllerï¼Œæˆ‘ä»¬å°†åœ¨controllersç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªDashBoardController.goæ–‡ä»¶ã€‚åœ¨æˆ‘ä»¬çš„DashBoardController.goæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†å®šä¹‰DashBoardControllerå¯¹è±¡åŠå…¶ShowEndpointsæ–¹æ³•:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="83fb" class="mj ko hu mf b fv mk ml l mm mn">// DashBoardController.go<br/>package controllers</span><span id="4c57" class="mj ko hu mf b fv mr ml l mm mn">import (<br/>    "goggles/models"<br/>    "github.com/kataras/iris"<br/>    "github.com/kataras/iris/mvc"<br/>)</span><span id="7916" class="mj ko hu mf b fv mr ml l mm mn">// DashBoardController - Controller object for Endpoints dashboard<br/>type DashBoardController struct {<br/>    mvc.BaseController<br/>    Cntx iris.Context<br/>}</span><span id="e4cf" class="mj ko hu mf b fv mr ml l mm mn">// ShowEndpoints - show list of endpoints<br/>func (d DashBoardController) ShowEndpoints() {<br/>    endpoints := (models.EndPoints{}).GetWithCallSummary()<br/>    d.Cntx.ViewData("endpoints", endpoints)<br/>    d.Cntx.View("endpoints.html")<br/>}</span></pre><p id="0c4a" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">åœ¨<code class="eh mo mp mq mf b">ShowEndpoints()</code>ä¸­ï¼Œæˆ‘ä»¬æ£€ç´¢æˆ‘ä»¬çš„ç«¯ç‚¹å’Œå®ƒä»¬çš„å‘¼å«æ‘˜è¦ä»¥ä¾›æ˜¾ç¤ºã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨<code class="eh mo mp mq mf b">d.Cntx.ViewData("endpoints", endpoints)</code>å°†è¿™äº›æ•°æ®ä¼ é€’ç»™æˆ‘ä»¬çš„è§†å›¾ï¼Œæœ€åæˆ‘ä»¬ä½¿ç”¨<code class="eh mo mp mq mf b">d.Cntx.View("endpoints.html")</code>å‘ˆç°æˆ‘ä»¬çš„è§†å›¾æ–‡ä»¶<code class="eh mo mp mq mf b">templates/endpoints.html</code>ã€‚</p><h1 id="96f5" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">æ£€ç´¢ç«¯ç‚¹å’Œå‘¼å«æ‘˜è¦</h1><p id="830a" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">ä¸ºäº†æ£€ç´¢æˆ‘ä»¬çš„ç«¯ç‚¹åˆ—è¡¨å’Œå®ƒä»¬çš„è°ƒç”¨æ‘˜è¦ï¼Œæˆ‘ä»¬å°†åœ¨<code class="eh mo mp mq mf b">EndPoints.go</code>æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸º<code class="eh mo mp mq mf b">GetWithCallSummary</code>çš„æ–¹æ³•ã€‚</p><p id="07e7" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æˆ‘ä»¬çš„<code class="eh mo mp mq mf b">GetWithCallSummary</code>æ–¹æ³•åº”è¯¥è¿”å›ç«¯ç‚¹å’Œå®ƒä»¬çš„è°ƒç”¨æ‘˜è¦ï¼Œä»¥ä¾¿æ˜¾ç¤ºã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åœ¨<code class="eh mo mp mq mf b">EndPoints.go</code>æ–‡ä»¶ä¸­æ˜¾ç¤ºæ‰€éœ€çš„å±æ€§å®šä¹‰ä¸€ä¸ªé›†åˆå¯¹è±¡<code class="eh mo mp mq mf b">EndPointWithCallSummary</code>:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="8f5e" class="mj ko hu mf b fv mk ml l mm mn">// EndPoints.go<br/>package models</span><span id="5d2d" class="mj ko hu mf b fv mr ml l mm mn">import (<br/>    "github.com/jinzhu/gorm"<br/>)</span><span id="9020" class="mj ko hu mf b fv mr ml l mm mn">// EndPoints - endpoint model<br/>type EndPoints struct {<br/>    gorm.Model<br/>    Name, URL string<br/>    Type      string          `gorm:"DEFAULT:'GET'"`<br/>    Calls     []EndPointCalls `gorm:"ForeignKey:EndPointID"`<br/>}</span><span id="968a" class="mj ko hu mf b fv mr ml l mm mn">// EndPointWithCallSummary - Endpoint with last call summary<br/>type EndPointWithCallSummary struct {<br/>    ID            uint<br/>    Name, URL     string<br/>    Type          string<br/>    LastStatus    int<br/>    NumRequests   int<br/>    LastRequester string<br/>}</span></pre><p id="d5c2" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ç„¶åå®šä¹‰<code class="eh mo mp mq mf b">GetWithCallSummary</code>æ–¹æ³•ä½¿ç”¨å¦‚ä¸‹:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="2aef" class="mj ko hu mf b fv mk ml l mm mn">// EndPoints.go</span><span id="426c" class="mj ko hu mf b fv mr ml l mm mn">// ...</span><span id="1dde" class="mj ko hu mf b fv mr ml l mm mn">// GetWithCallSummary - get all endpoints with call summary details<br/>func (ep EndPoints) GetWithCallSummary() []EndPointWithCallSummary {<br/>    var eps []EndPoints<br/>    var epsWithDets []EndPointWithCallSummary</span><span id="5f5c" class="mj ko hu mf b fv mr ml l mm mn">    db.Preload("Calls").Find(&amp;eps)</span><span id="a4e4" class="mj ko hu mf b fv mr ml l mm mn">    for _, elem := range eps {<br/>        calls := elem.Calls<br/>        lastCall := calls[len(calls)-1:][0]</span><span id="5c93" class="mj ko hu mf b fv mr ml l mm mn">        newElem := EndPointWithCallSummary{<br/>            elem.ID,<br/>            elem.Name,<br/>            elem.URL,<br/>            elem.Type,<br/>            lastCall.ResponseCode,<br/>            len(calls),<br/>            lastCall.RequestIP,<br/>        }</span><span id="7fc1" class="mj ko hu mf b fv mr ml l mm mn">        epsWithDets = append(epsWithDets, newElem)<br/>    }</span><span id="2604" class="mj ko hu mf b fv mr ml l mm mn">    return epsWithDets<br/>}</span><span id="42ec" class="mj ko hu mf b fv mr ml l mm mn">// ...</span></pre><p id="482c" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ä¸Šé¢ï¼Œ<code class="eh mo mp mq mf b">GetWithCallSummary</code>æ–¹æ³•åˆ©ç”¨äº†<code class="eh mo mp mq mf b">EndPoints</code>çš„<code class="eh mo mp mq mf b">Calls</code>å±æ€§ï¼Œè¯¥å±æ€§å®šä¹‰äº†å®ƒä¸<code class="eh mo mp mq mf b">EndPointCalls</code>çš„å…³ç³»ã€‚å½“ä»æ•°æ®åº“ä¸­æ£€ç´¢ç«¯ç‚¹åˆ—è¡¨æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨<code class="eh mo mp mq mf b">db.Preload("Calls").Find(&amp;eps)</code>åŠ è½½å®ƒçš„<code class="eh mo mp mq mf b">EndPointCalls</code>æ•°æ®ã€‚</p><p id="dc82" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æœ‰å…³GORMä¸­çš„ç´§æ€¥åŠ è½½çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a class="ae ke" href="http://jinzhu.me/gorm/crud.html#preloading-eager-loading" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a>ã€‚</p><p id="384b" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated"><code class="eh mo mp mq mf b">GetWithCallSummary</code>åˆå§‹åŒ–ä¸€ä¸ª<code class="eh mo mp mq mf b">EndPointWithCallSummary</code>æ•°ç»„ï¼Œå¹¶éå†ä»æˆ‘ä»¬çš„æ•°æ®åº“è¿”å›çš„<code class="eh mo mp mq mf b">EndPoints</code>å¯¹è±¡æ¥åˆ›å»º<code class="eh mo mp mq mf b">EndPointWithCallSummary</code>å¯¹è±¡ã€‚</p><p id="4d2c" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">è¿™äº›<code class="eh mo mp mq mf b">EndPointWithCallSummary</code>å¯¹è±¡è¢«é™„åŠ åˆ°åˆå§‹åŒ–çš„æ•°ç»„ä¸­å¹¶è¢«è¿”å›ã€‚</p><blockquote class="jc jd je"><p id="0999" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="hu">ğŸ’¡</em> <code class="eh mo mp mq mf b"><em class="hu">EndPointWithCallSummary</em></code> <em class="hu">ä¸æ˜¯æ¨¡å‹ã€‚å®ƒæ˜¯ä¸€ä¸ªé›†åˆå¯¹è±¡ï¼Œä¸éœ€è¦åœ¨æˆ‘ä»¬çš„æ•°æ®åº“ä¸­æœ‰ä¸€ä¸ªè¡¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒæ²¡æœ‰è‡ªå·±çš„æ–‡ä»¶ï¼Œä¹Ÿæ²¡æœ‰ä¼ é€’åˆ°</em> <code class="eh mo mp mq mf b"><em class="hu">index.go</em></code> <em class="hu">è¿›è¡Œè¿ç§»ã€‚</em></p></blockquote><h1 id="57a8" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">å®ç°ä»ªè¡¨æ¿å’Œæ˜¾ç¤ºæ•°æ®</h1><p id="e556" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†ä»ªè¡¨æ¿çš„è·¯ç”±ã€æ§åˆ¶å™¨å’Œæ˜¾ç¤ºæ•°æ®ï¼Œæˆ‘ä»¬å°†å®ç°ä»ªè¡¨æ¿è§†å›¾æ¥å®ç°ç«¯ç‚¹åŠå…¶æ‘˜è¦æ•°æ®çš„ç®€å•åˆ—è¡¨æ˜¾ç¤ºã€‚</p><p id="44d7" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">è®©æˆ‘ä»¬å°†<code class="eh mo mp mq mf b">templates/endpoints.html</code>æ›´æ–°ä¸ºä»¥ä¸‹ä»£ç :</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="c2d5" class="mj ko hu mf b fv mk ml l mm mn">&lt;!-- templates/endpoints.html --&gt;<br/>&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>    &lt;title&gt;Endpoints Monitor Dashboard&lt;/title&gt;<br/>    &lt;link rel="stylesheet" type="text/css" href="<a class="ae ke" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta.3/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta.3/css/bootstrap.min.css</a>" /&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>    &lt;div&gt;<br/>        &lt;nav class="navbar navbar-default navbar-static-top"&gt;<br/>            &lt;div class="container"&gt;<br/>                &lt;div class="navbar-header"&gt;<br/>                    &lt;a class="navbar-brand" href="<a class="ae ke" href="http://127.0.0.1:1234/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:1234/</a>"&gt;<br/>                        Goggles - A Real-Time API Monitor<br/>                    &lt;/a&gt;<br/>                &lt;/div&gt;<br/>            &lt;/div&gt;<br/>        &lt;/nav&gt;<br/>        &lt;div class="container"&gt;<br/>            &lt;div class="row"&gt;<br/>                &lt;div class="col-xs-12 col-lg-12"&gt;<br/>                    &lt;div class="endpoints list-group"&gt;<br/>                        {{#each endpoints}}<br/>                            &lt;a id="endpoint-{{ID}}" href="#" class="list-group-item <br/>                            list-group-item-{{status_class LastStatus}}"&gt;<br/>                                &lt;strong&gt;{{name}}&lt;/strong&gt;<br/>                                &lt;span class="stats"&gt;<br/>                                    {{type}}: &lt;strong&gt;{{url}}&lt;/strong&gt; |<br/>                                    Last Status: &lt;span class="last_status"&gt;<br/>                                    {{LastStatus}}&lt;/span&gt; |<br/>                                    Times Called: &lt;span class="times_called"&gt;<br/>                                    {{NumRequests}}&lt;/span&gt; |<br/>                                    Last Request IP: &lt;span class="request_ip"&gt;<br/>                                    {{LastRequester}}&lt;/span&gt;<br/>                                &lt;/span&gt;<br/>                            &lt;/a&gt;<br/>                        {{/each}}<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>            &lt;/div&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;script src="<a class="ae ke" href="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" rel="noopener ugc nofollow" target="_blank">https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js</a>"&gt;&lt;/script&gt;<br/>    &lt;script src="<a class="ae ke" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta.3/js/bootstrap.min.js" rel="noopener ugc nofollow" target="_blank">https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta.3/js/bootstrap.min.js</a>"&gt;&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="cf37" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ä¸Šé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨<a class="ae ke" href="https://getbootstrap.com/" rel="noopener ugc nofollow" target="_blank"> Bootstrap </a>å’ŒæŠŠæ‰‹æ¨¡æ¿å¼•æ“æ¥å‘ˆç°ç«¯ç‚¹åˆ—è¡¨ã€‚æˆ‘ä»¬è¿˜åˆ›å»ºå¹¶ä½¿ç”¨äº†ä¸€ä¸ªæ¨¡æ¿å‡½æ•°<code class="eh mo mp mq mf b">status_class</code>ï¼Œæ ¹æ®ä»–ä»¬æœ€è¿‘çš„é€šè¯çŠ¶æ€<code class="eh mo mp mq mf b">LastStatus</code>å¯¹æˆ‘ä»¬çš„åˆ—è¡¨è¿›è¡Œé¢œè‰²ç¼–ç ã€‚</p><p id="37f1" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">åˆå§‹åŒ–æ¨¡æ¿å¼•æ“åï¼Œæˆ‘ä»¬åœ¨<code class="eh mo mp mq mf b">index.go</code>ä¸­å®šä¹‰äº†<code class="eh mo mp mq mf b">status_class</code>æ¨¡æ¿å‡½æ•°:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="1c40" class="mj ko hu mf b fv mk ml l mm mn">// index.go</span><span id="1053" class="mj ko hu mf b fv mr ml l mm mn">// ...</span><span id="7a22" class="mj ko hu mf b fv mr ml l mm mn">func main() {<br/>    app := iris.New()</span><span id="da4e" class="mj ko hu mf b fv mr ml l mm mn">    tmpl := iris.Handlebars("./templates", ".html")</span><span id="f74f" class="mj ko hu mf b fv mr ml l mm mn">    tmpl.AddFunc("status_class", func(status int) string {<br/>        if status &gt;= 200 &amp;&amp; status &lt; 300 {<br/>            return "success"<br/>        } else if status &gt;= 300 &amp;&amp; status &lt; 400 {<br/>            return "warning"<br/>        } else if status &gt;= 400 {<br/>            return "danger"<br/>        }<br/>        return "success"<br/>    })</span><span id="19cd" class="mj ko hu mf b fv mr ml l mm mn">    app.RegisterView(tmpl)<br/>}</span></pre><p id="996b" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ç„¶åï¼Œåœ¨æˆ‘ä»¬çš„è§†å›¾æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†è¯¥å‡½æ•°ç§°ä¸º:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="bfd1" class="mj ko hu mf b fv mk ml l mm mn">class="list-group-item list-group-item-{{status_class LastStatus}}"</span></pre><blockquote class="jc jd je"><p id="9350" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="hu">ğŸ’¡ä¸Šé¢çš„LastStatusæ˜¯å‡½æ•°çš„å‚æ•°ã€‚</em></p></blockquote><h1 id="da03" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">å‘æˆ‘ä»¬çš„ä»ªè¡¨æ¿æ·»åŠ å®æ—¶æ›´æ–°</h1><p id="8f1e" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç›‘æ§äº†å¯¹APIçš„è°ƒç”¨ï¼Œå¹¶é€šè¿‡ä»ªè¡¨æ¿æ˜¾ç¤ºäº†æ•°æ®ã€‚æˆ‘ä»¬ç°åœ¨å°†ä½¿ç”¨<a class="ae ke" href="http://pusher.com/" rel="noopener ugc nofollow" target="_blank">æ¨é€å™¨</a>å‘æˆ‘ä»¬çš„ä»ªè¡¨æ¿æä¾›å®æ—¶æ•°æ®æ›´æ–°ã€‚</p><h1 id="baf3" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">ä»åç«¯å‘é€å®æ—¶æ•°æ®</h1><p id="2bd3" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">ä¹‹å‰ï¼Œæˆ‘ä»¬å®‰è£…äº†<a class="ae ke" href="https://github.com/pusher/pusher-http-go" rel="noopener ugc nofollow" target="_blank"> Pusher Goåº“</a>ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒåœ¨ç«¯ç‚¹è¢«è°ƒç”¨æ—¶è§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚åœ¨å¤„ç†APIè¯·æ±‚çš„<code class="eh mo mp mq mf b">MoviesController.go</code>æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†åˆå§‹åŒ–Pusherå®¢æˆ·ç«¯:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="6544" class="mj ko hu mf b fv mk ml l mm mn">// MoviesController.go</span><span id="58e5" class="mj ko hu mf b fv mr ml l mm mn">    package controllers</span><span id="43a0" class="mj ko hu mf b fv mr ml l mm mn">    import (<br/>        // ...<br/>        "github.com/pusher/pusher-http-go"<br/>    )</span><span id="a5c3" class="mj ko hu mf b fv mr ml l mm mn">    // MoviesController - controller object to serve movie data<br/>    type MoviesController struct {<br/>        mvc.BaseController<br/>        Cntx iris.Context<br/>    }</span><span id="478b" class="mj ko hu mf b fv mr ml l mm mn">    var client = pusher.Client{<br/>        AppId:   "app_id",<br/>        Key:     "app_key",<br/>        Secret:  "app_secret",<br/>        Cluster: "app_cluster",<br/>    }</span><span id="fe96" class="mj ko hu mf b fv mr ml l mm mn">    // ...</span></pre><p id="eaa0" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„åº”ç”¨ç¨‹åºä¸­çš„å‡­è¯åˆå§‹åŒ–äº†Pusherå®¢æˆ·ç«¯ã€‚</p><blockquote class="jc jd je"><p id="2de9" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="hu"> âš ï¸ç”¨ä½ çš„appå‡­è¯æ›¿æ¢</em> <code class="eh mo mp mq mf b"><em class="hu">app_id, app_key, app_secret and app_cluster</em></code> <em class="hu">ã€‚</em></p></blockquote><p id="f237" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Pusherå®¢æˆ·ç«¯æ¥è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œè¿™å°†åŒ…æ‹¬è¦åœ¨æˆ‘ä»¬çš„è§†å›¾ä¸­æ˜¾ç¤ºçš„ç«¯ç‚¹æ•°æ®ã€‚æˆ‘ä»¬å°†åœ¨<code class="eh mo mp mq mf b">saveEndpointCall</code>æ–¹æ³•ä¸­è¿™æ ·åšï¼Œè¯¥æ–¹æ³•è®°å½•ä¸€ä¸ªç«¯ç‚¹åŠå…¶è°ƒç”¨:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="b1e3" class="mj ko hu mf b fv mk ml l mm mn">// MoviesController.go</span><span id="8a05" class="mj ko hu mf b fv mr ml l mm mn">    // ...</span><span id="36c2" class="mj ko hu mf b fv mr ml l mm mn">    func (m MoviesController) saveEndpointCall(name string) {<br/>        endpoint := models.EndPoints{<br/>            Name: name,<br/>            URL:  m.Cntx.Path(),<br/>            Type: m.Cntx.Request().Method,<br/>        }<br/>        endpoint = endpoint.SaveOrCreate()<br/>        endpointCall := endpoint.SaveCall(m.Cntx)<br/>        endpointWithCallSummary := models.EndPointWithCallSummary{<br/>            ID:            endpoint.ID,<br/>            Name:          endpoint.Name,<br/>            URL:           endpoint.URL,<br/>            Type:          endpoint.Type,<br/>            LastStatus:    endpointCall.ResponseCode,<br/>            NumRequests:   1,<br/>            LastRequester: endpointCall.RequestIP,<br/>        }</span><span id="6771" class="mj ko hu mf b fv mr ml l mm mn">        client.Trigger("goggles_channel", "new_endpoint_request", endpointWithCallSummary)<br/>    }</span></pre><p id="bb0e" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">ä¸Šé¢ï¼Œæˆ‘ä»¬ä»<code class="eh mo mp mq mf b">EndPoints</code>(ç«¯ç‚¹)å’Œ<code class="eh mo mp mq mf b">EndPointCalls</code>åˆ›å»ºäº†ä¸€ä¸ª<code class="eh mo mp mq mf b">EndPointWithCallSummary</code>å¯¹è±¡ã€‚è¯¥<code class="eh mo mp mq mf b">EndPointWithCallSummary</code>å¯¹è±¡å…·æœ‰åœ¨ä»ªè¡¨æ¿ä¸Šæ˜¾ç¤ºæ‰€éœ€çš„æ‰€æœ‰æ•°æ®ï¼Œå› æ­¤å°†è¢«ä¼ é€’ç»™Pusherè¿›è¡Œä¼ è¾“ã€‚</p><h1 id="5c78" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">åœ¨ä»ªè¡¨æ¿ä¸Šå®æ—¶æ˜¾ç¤ºæ•°æ®</h1><p id="1b51" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">ä¸ºäº†æ˜¾ç¤ºç«¯ç‚¹çš„å®æ—¶æ›´æ–°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Pusher JavaScriptå®¢æˆ·ç«¯å’ŒjQueryåº“ã€‚</p><p id="d4b1" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">åœ¨æˆ‘ä»¬çš„è§†å›¾æ–‡ä»¶<code class="eh mo mp mq mf b">templates/endpoints.html</code>ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆä½¿ç”¨æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„å‡­è¯å¯¼å…¥å¹¶åˆå§‹åŒ–ä¸€ä¸ªPusherå®ä¾‹:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="bd89" class="mj ko hu mf b fv mk ml l mm mn">&lt;!-- endpoints.html --&gt;<br/>    &lt;script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta.3/js/bootstrap.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="//js.pusher.com/4.1/pusher.min.js"&gt;&lt;/script&gt;<br/>    &lt;script&gt;<br/>      const pusher = new Pusher('app_id', {cluster: "app_cluster"});<br/>    &lt;/script&gt;</span></pre><blockquote class="jc jd je"><p id="b873" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="hu"> âš ï¸ç”¨ä½ çš„åº”ç”¨å‡­è¯ä¸­çš„å€¼æ›¿æ¢</em> <code class="eh mo mp mq mf b"><em class="hu">app_id and app_cluster</em></code> <em class="hu">ã€‚</em></p></blockquote><p id="428c" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä»¥ä¸‹å†…å®¹:</p><ul class=""><li id="e960" class="lq lr hu ji b jj jk jn jo kf ls kg lt kh lu kd lv lw lx ly dt translated">å‘è§†å›¾æ·»åŠ æ–°ç«¯ç‚¹çš„æ¨¡æ¿ã€‚</li><li id="41af" class="lq lr hu ji b jj lz jn ma kf mb kg mc kh md kd lv lw lx ly dt translated">è¿½åŠ æ–°ç«¯ç‚¹å¹¶è·å–ç«¯ç‚¹çŠ¶æ€ç±»çš„å‡½æ•°ã€‚</li></ul><p id="9438" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æœ€åï¼Œæˆ‘ä»¬å°†è®¢é˜…<code class="eh mo mp mq mf b">goggles_channel</code>å¹¶ç›‘å¬<code class="eh mo mp mq mf b">new_endpoint_request</code>äº‹ä»¶ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬çš„ç«¯ç‚¹æ›´æ–°å°†è¢«ä¼ è¾“:</p><pre class="kj kk kl km fq me mf mg mh aw mi dt"><span id="d169" class="mj ko hu mf b fv mk ml l mm mn">&lt;!-- endpoints.html --&gt;<br/>    &lt;script&gt;<br/>    // ...<br/><br/>    const channel = pusher.subscribe("goggles_channel");<br/><br/>    channel.bind('new_endpoint_request', function(data) {<br/>        let end_point_id = data.ID;<br/>        if ( $('#endpoint-' + end_point_id).length &gt; 0 ) {<br/>            let status_class = getItemStatusClass(data['LastStatus']),<br/>                endpoint     = $('#endpoint-' + end_point_id);<br/>            let calls = 1 * endpoint.find('span.times_called').text()<br/>            endpoint.find('span.last_status').text(data['LastStatus']);<br/>            endpoint.find('span.times_called').text( (calls + 1) )<br/>            endpoint.removeClass('list-group-item-success');<br/>            endpoint.removeClass('list-group-item-danger');<br/>            endpoint.removeClass('list-group-item-warning');<br/>            endpoint.addClass('list-group-item-' + status_class);<br/>        } else {<br/>            addNewEndPoint(data);<br/>        }<br/>    });<br/><br/>    // ...</span></pre><p id="975e" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">åœ¨<code class="eh mo mp mq mf b">new_endpoint_request</code>äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œç«¯ç‚¹æ•°æ®è¢«åˆ†ä¸ºæ›´æ–°åœºæ™¯(ç«¯ç‚¹å·²ç»å­˜åœ¨äºä»ªè¡¨æ¿ä¸Š)æˆ–åˆ›å»ºåœºæ™¯(åˆ›å»ºå¹¶è¿½åŠ æ–°çš„åˆ—è¡¨é¡¹)ã€‚</p><p id="fbdb" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq kf js jt ju kg jw jx jy kh ka kb kc kd hn dt translated">æœ€åï¼Œæ‚¨å¯ä»¥æ„å»ºæ‚¨çš„åº”ç”¨ç¨‹åºï¼Œå½“æ‚¨è¿è¡Œå®ƒæ—¶ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼äºæˆ‘ä»¬åœ¨é¢„è§ˆä¸­çœ‹åˆ°çš„å†…å®¹:</p><figure class="kj kk kl km fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ki"><img src="../Images/4a9036a697db0b42b7fecd2462077925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*uxk2Dhe1apJP8iKvRbmh0A.gif"/></div></div></figure><h1 id="2280" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">ç»“è®º</h1><p id="ae70" class="pw-post-body-paragraph jf jg hu ji b jj ll jl jm jn lm jp jq kf ln jt ju kg lo jx jy kh lp kb kc kd hn dt translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿç›‘æ§å¯¹REST APIçš„å®æ—¶è¯·æ±‚ï¼Œå¹¶æ¼”ç¤ºPusherå¦‚ä½•ä¸GoLangåº”ç”¨ç¨‹åºä¸€èµ·å·¥ä½œã€‚</p><blockquote class="jc jd je"><p id="9802" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">è¿™ç¯‡æ–‡ç« æœ€åˆå‡ºç°åœ¨<a class="ae ke" href="https://blog.pusher.com/realtime-trade-platform-javascript-pusher/" rel="noopener ugc nofollow" target="_blank">æ¨å¹¿è€…åšå®¢</a>ä¸Šã€‚</p></blockquote></div></div>    
</body>
</html>