<html>
<head>
<title>Eclipse Attacks on Blockchains’ Peer-to-Peer Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Eclipse对区块链对等网络的攻击</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/eclipse-attacks-on-blockchains-peer-to-peer-network-26a62f85f11?source=collection_archive---------8-----------------------#2018-03-09">https://medium.com/hackernoon/eclipse-attacks-on-blockchains-peer-to-peer-network-26a62f85f11?source=collection_archive---------8-----------------------#2018-03-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/1fcfe4b0a50094e065ae5125b53d0bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QFG4-XVN7ygedUGo."/></div></div></figure><div class=""/><p id="8b98" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从系统的角度来看，区块链按照其层次结构大致由四个模块组成:</p><ul class=""><li id="84fe" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">共识引擎</li><li id="ec82" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">脚本和虚拟执行环境</li><li id="38a2" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">事务、块和链逻辑</li><li id="bf52" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">对等网络</li></ul><p id="e1da" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">大多数相关主题的研究都集中在<strong class="je ig">共识引擎</strong>(提高交易吞吐量)和<strong class="je ig">脚本语言</strong>(使区块链更有用)，对对等网络的属性基本上没有探索。</p><p id="f41f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">区块链的安全属性实际上取决于对等网络。对eclipse攻击的研究是由Ethan Heilman、Alison Kendler、Aviv Zohar和Sharon Goldberg在2015年开始的。他们的研究说明了通过控制数百个节点对比特币点对点网络的首次攻击，这在他们的研究论文中被建模为非结构化随机图。另一篇题为“<a class="ae ko" href="https://eprint.iacr.org/2018/236.pdf" rel="noopener ugc nofollow" target="_blank">对以太坊对等网络的低资源eclipse攻击</a>”的有趣研究论文展示了仅使用两台机器对以太坊的P2P网络层(通常建模为类似Kademlia DHT的结构化图形)发起Eclipse攻击的可行性。Eclipse攻击证明了在构建复杂的P2P系统时需要跨层设计。</p><h1 id="476d" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">Eclipse攻击</h1><p id="f247" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">像<a class="ae ko" href="https://en.wikipedia.org/wiki/LimeWire" rel="noopener ugc nofollow" target="_blank"> limewire </a>这样的P2P系统是一种计算或网络分布式应用架构，它在对等点之间划分任务或工作负载，而不需要中央协调服务器或稳定的主机。对等体通过八卦协议进行通信:</p><ul class=""><li id="be24" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">对等体A在线&amp;与对等体B连接，这是预先配置的；</li><li id="63b3" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">对等体A咨询对等体B &gt;了解对等体C的存在，并且D &gt;与这些新的对等体连接；</li><li id="2977" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">对等体A向B、C和D广播一条新消息。一旦B、C和D接收到该广播，它们就会将其发送给E、F、G、H…等等。</li></ul><figure class="lt lu lv lw fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff ls"><img src="../Images/421b42b91c3ff6e113bc47adf7555ebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hpduqdCeZMh33CW7."/></div></div></figure><p id="ee10" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对等体A对整个网络的视图完全依赖于B、C和d。在攻击期间，对等体A基本上与网络的其余部分隔离，并且其视图可以被攻击者操纵。这就是我们所说的Eclipse攻击，一种攻击包括区块链在内的P2P系统的简单方法。</p><p id="a341" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当每个对等点都<strong class="je ig">总是</strong>监听和与其他对等点通话(一种理想状态)时，发起椭圆攻击的成本很高，因为黑客需要控制整个网络才能入侵P2P系统。出于实际考虑，现实中每个对等体只与一小群对等体交换信息。因此，入侵系统的成本并不高。以太坊之所以选择像比特币一样将传出连接数设为13而不是8，是为了让以太坊网络的整体安全性更强大。</p><p id="e814" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">尽管如此，以太坊P2P网络仍然存在缺陷，使得黑客能够发起eclipse攻击。</p><h1 id="e07e" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">设计缺陷</h1><h2 id="865d" class="lx kq if bd kr ly lz ma kv mb mc md kz jn me mf ld jr mg mh lh jv mi mj ll mk dt translated">设计缺陷#1:对等体的身份</h2><p id="5484" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">以太坊网络中的对等体通过它们的节点id来标识，节点id是可以生成的64字节加密ECDSA公钥。多个以太坊节点，每个都有不同的节点ID，运行在具有单一IP地址的单一机器上。由于“对等体”的这种弱定义，黑客可以很容易地生成一大组以太坊对等体，将它们托管在一台具有相同单个IP地址的机器上，并战略性地协调它们，以阻止任何进出受害者节点的通信。这是Yuval Marcus等人的论文中使用的主要载体。铝..<strong class="je ig">对等体的身份应该与一些物理资源捆绑在一起，例如IP地址，以避免无限制地提供对等体并修复这样的设计缺陷。</strong></p><h2 id="bd4b" class="lx kq if bd kr ly lz ma kv mb mc md kz jn me mf ld jr mg mh lh jv mi mj ll mk dt translated">设计缺陷#2:对等选择策略</h2><p id="fa7d" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">以太坊没有使用随机的节点选择策略，而是使用Kademlia来选择新的节点。在Kademlia网络中，每一项内容都与一个密钥相关联，并且只存储在其节点ID“接近”其相关密钥的对等体上。“接近度”被定义为关键字和节点ID之间的二进制汉明距离。为了查找与关键字t相关联的内容，Kademlia节点在其桶中查找“最接近”t的节点id，并要求它们(a)返回与t相关联的内容，或者(b)返回甚至“更接近”t的一些节点id。在以太坊的例子中，一个节点:</p><ol class=""><li id="533b" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz ml kg kh ki dt translated">选择一个随机字符串t</li><li id="1523" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz ml kg kh ki dt translated">在其桶中查找k = 16个最接近字符串t的节点id</li><li id="f1e2" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz ml kg kh ki dt translated">要求每个节点从其桶中返回k个节点id，这有助于原始节点“更接近”字符串t</li></ol><p id="8f12" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个过程的结果是收集了多达k × k个新的节点id。</p><figure class="lt lu lv lw fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mm"><img src="../Images/2ae91eb01387b3a034a3f97220250805.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UGkvzXHbZD4etAeF."/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">Image Credit: <a class="ae ko" href="http://slideplayer.com/slide/3952039/" rel="noopener ugc nofollow" target="_blank">Kurtis Jolly</a></figcaption></figure><p id="0e8c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，从这些k × k个新发现的节点id中，要求最接近字符串t的k个节点返回更接近t的k个节点。这个过程迭代地继续，直到没有发现新的节点。因此，这使得攻击者能够创建一组节点id，用于填充受害节点对等体数据存储中的所有存储桶。这个漏洞需要用一个好的对等选择策略来修复。理想情况下，所选择的对等体 <strong class="je ig">应该分散在网络中以最小化这样的风险。</strong></p><h1 id="a6b8" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">设计缺陷3:入站vs .出站连接</h1><p id="e275" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">从对等体的角度来看，有两种类型的连接—入站(如果它是由另一个对等体发起的)和出站(如果它是由这个对等体发起的)连接。以太坊对入站和出站连接的总数设置了一个限制，称为maxpeers(默认为25)，但没有为每个连接设置限制。受害节点可能会在100%的入站连接来自黑客的情况下最大化maxpeer限制。<strong class="je ig">对传入连接的数量设置上限，迫使对等点混合传入和传出连接，将是解决这个问题的一种方法。</strong></p><h1 id="8c78" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">设计缺陷#4:重启并删除</h1><p id="0dea" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">在以太坊中，一个对等体将关于其他节点的信息存储在两种数据结构中:</p><ol class=""><li id="1ed7" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz ml kg kh ki dt translated"><strong class="je ig">硬盘上的长期数据存储</strong>，重启后仍然存在(word choice)</li><li id="ecb1" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz ml kg kh ki dt translated"><strong class="je ig">短期数据存储</strong>包含类似Kademlia的桶，当对等体重启时，这些桶总是空的。</li></ol><p id="2374" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">聪明的黑客可以利用设计缺陷#3和#4，在对等体重新启动后立即填充短期数据存储，从而快速将受害者的所有入站连接替换为恶意连接。<strong class="je ig">这个问题可以通过对传入连接进行采样来填充短期存储，并在重启后在短期数据存储中保留一些对等体，而不是将整个短期数据存储清除干净来解决。</strong></p><h1 id="f956" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">含义</h1><p id="af49" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">Eclipse攻击可用于打破网络共识，并导致:</p><ul class=""><li id="9885" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">双倍支出；</li><li id="3ca9" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">针对第二层协议(如闪电网络)的攻击，例如，攻击者可以通过欺骗他的受害者，使其认为支付通道仍然开放，而网络的非重叠部分看到支付通道关闭，从而无需支付就可以获得产品；</li><li id="6669" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">如果用户看到不一致的区块链视图，智能合约可能会受到攻击。</li></ul><h1 id="2d97" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">播种</h1><p id="964f" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">此外，通过增加受害者与合法对等方建立传出连接的可能性，更积极地播种无疑有助于抑制eclipse攻击。以下是优化播种的一些方法:</p><ul class=""><li id="2ac6" class="ka kb if je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated"><strong class="je ig">频率</strong>:播种可以在对等体重启后立即执行，或者每30分钟定期执行一次</li><li id="b650" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated"><strong class="je ig">覆盖范围</strong>:播种可以针对更多的节点执行(不限于以太坊网络中的六个引导节点)。重新启动后，以前使用的对等机仍然可以再次使用。</li><li id="6455" class="ka kb if je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated"><strong class="je ig">选择性</strong>:在播种过程中可以更严格地选择对等点。例如，可以使用具有不同网络特征(如延迟、跟踪路由、IP范围和ISP)的对等体。</li></ul><h1 id="7152" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">这对IoTeX有何影响？</h1><p id="6fb4" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">当我们设计IoTeX区块链时，我们特别关注对等体的身份、对等体选择策略、连接限制和播种策略。此外，我们正在积极探索通过利用网络统计使选定的对等点多样化的可行性。</p><h1 id="b67e" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">关于IoTeX</h1><p id="f814" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">IoTeX致力于打造下一代面向物联网的区块链平台。尖端的区块链区块链架构将解决与物联网DApps和生态系统增长相关的可扩展性、隐私性、隔离性和可开发性问题。通过将象征性激励与我们充满活力的全球社区相结合，我们相信我们可以众包顶级行业和社区人才，以推动区块链3.0的发展。</p><figure class="lt lu lv lw fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/0aaa3c96f041582e9084750add2ad890.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fGbJZGV9NC3pMh-_."/></div></div></figure><p id="5361" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">【https://iotex.io/telegram】电报: <a class="ae ko" href="https://iotex.io/telegram" rel="noopener ugc nofollow" target="_blank"> <em class="mr">电报:</em> </a></p><p id="3144" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="mr">推特:</em><a class="ae ko" href="https://twitter.com/iotex_io" rel="noopener ugc nofollow" target="_blank"><em class="mr">https://twitter.com/iotex_io</em></a></p></div></div>    
</body>
</html>