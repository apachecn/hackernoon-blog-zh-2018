<html>
<head>
<title>5 Twitter Batch Operations with a few Lines of Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用几行Javascript实现5个Twitter批处理操作</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/5-twitter-batch-operations-with-a-few-lines-of-javascript-5412846cd1aa?source=collection_archive---------13-----------------------#2018-03-11">https://medium.com/hackernoon/5-twitter-batch-operations-with-a-few-lines-of-javascript-5412846cd1aa?source=collection_archive---------13-----------------------#2018-03-11</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="aa70" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Twitter是一个创造社交存在的伟大工具。然而，使用twitter应用程序GUI进行批量操作是乏味且耗时的。API使得编写批量操作数据的程序成为可能。。<a class="ae jp" href="https://www.npmjs.com/package/dstwitter" rel="noopener ugc nofollow" target="_blank">dswitter模块</a>是一个<a class="ae jp" href="https://www.npmjs.com/package/dstools" rel="noopener ugc nofollow" target="_blank"> dstools </a>扩展，它使得在twitter用户或tweets等数据元素集合上执行twitter API变得容易。它很大程度上依赖于方法链模式，类似于jQuery。在本教程中，我们将展示如何:</p><ul class=""><li id="e1c8" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">获取关注者和朋友的列表(朋友是你关注的用户)</li><li id="a99d" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">显示带有关注者计数、朋友计数、您没有关注的关注者以及您关注但没有关注您的用户的报告</li><li id="d52b" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">关注所有关注您的用户(您尚未关注的用户)</li><li id="9661" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">取消关注所有你关注但没有关注你的用户</li><li id="a605" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">为您的关注者bios获取word cloud(个人资料的描述部分)</li><li id="beac" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">搜索在推特上谈论特定话题的用户</li></ul><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff ke"><img src="../Images/071bc3cde52a63557d8341e5713d1297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HrZfdLr3UHfyFbWdjsMZBA.png"/></div></div></figure><h1 id="581a" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">奠定基础——创建twitter应用程序</h1><p id="0801" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">为了使用twitter API，您首先需要创建一个twitter应用程序。一旦有了twitter应用程序，就可以使用它的凭证来访问twitter API。</p><p id="85dd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">前往apps.twitter.com<a class="ae jp" href="http://apps.twitter.com" rel="noopener ugc nofollow" target="_blank"/>，点击“创建新应用”按钮。</p><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff lt"><img src="../Images/8c21077a91b260306eb945d99954e75c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yr0c6ZswVd-8m4afHe_oJw.png"/></div></div></figure><p id="c9a8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">填写名称、描述和网站(如果愿意，您可以只键入一个占位符)。在本例中，我们只是将应用程序用于自己的用途。如果你正在创建一个处理其他用户的twitter应用，确保你的用户可以在某个地方了解这个应用。别忘了网站网址以http或https开头。点击按钮创建应用程序，瞧，你已经有了自己的应用程序。</p><p id="4e48" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们需要获得激活twitter API所需的凭证。选择“密钥和访问令牌”选项卡。这将显示您的应用程序<strong class="it hv">消费者密钥</strong>和<strong class="it hv">消费者秘密</strong>。您将需要它们来连接twitter API。我们将代表您访问API，因此我们需要一个用户访问令牌。获取用户令牌最简单的方法是在应用程序页面上，使用“创建我的访问令牌”按钮。只需点击它，您将获得一个用户<strong class="it hv">访问令牌</strong>和<strong class="it hv">访问令牌秘密</strong>。这些也是执行API请求所必需的。</p><h1 id="01b4" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">NPM图书馆</h1><p id="8089" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">在本教程中，我们将使用两个npm模块:<a class="ae jp" href="http://Function reference and jsdoc based documentation can be found at https://elshor.github.io/dstools/" rel="noopener ugc nofollow" target="_blank"> dstools </a>和<a class="ae jp" href="https://www.npmjs.com/package/dstwitter" rel="noopener ugc nofollow" target="_blank">dswitter</a>。<a class="ae jp" href="https://www.npmjs.com/package/dstools" rel="noopener ugc nofollow" target="_blank"> dstools </a>是一个npm模块，用于轻松操作twitter用户和推文等数据集合。它依赖于方法链接，我发现这个特性在处理需要分几个步骤操作的数据时非常有用。这个库与Jupyter笔记本很好地集成在一起。我的<a class="ae jp" href="https://hackernoon.com/data-science-for-javascript-developers-2cc3fb1fbefc" rel="noopener ugc nofollow" target="_blank">上一篇文章</a>解释了如何使用带有Javascript的Jupyter笔记本。但是，可以将这个包与普通的Javascript文件或REPL一起使用。</p><p id="8000" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://www.npmjs.com/package/dstwitter" rel="noopener ugc nofollow" target="_blank">dswitter包</a>是一个插件，以一种方便的方式提供twitter API功能。该库的一个重要特性是它能够处理twitter的API限制，比如每页最大结果数和速率限制。使用twitter API，每个API端点都受到每个特定API调用可以返回的项目数量以及应用程序每15分钟可以执行的API调用数量的限制。dstwitter模块可以将对许多项目的请求分成几个API调用，如果应用程序达到了配额，它会等待15分钟。</p><h1 id="5e34" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">这是代码</h1><p id="4d92" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">程序员喜欢看代码。事不宜迟，下面是代码(带有一些注释)。代码经过编辑，可以复制/粘贴到节点REPL中。因此后面的点。</p><h2 id="cd03" class="lu kr hu bd ks lv lw lx kw ly lz ma la jc mb mc le jg md me li jk mf mg lm mh dt translated">初始化环境</h2><p id="c176" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">首先，您需要加载这个库，并用twitter API所需的凭证初始化它</p><pre class="kf kg kh ki fq mi mj mk ml aw mm dt"><span id="1b0e" class="lu kr hu mj b fv mn mo l mp mq">require('dstwitter');//initialize dstwitter module<br/>let start = require('dstools').Collection().<br/>context('twitter',{//load twitter API credentials to context<br/> access_token_key:'ACCESS_TOKEN_KEY',<br/> access_token_secret : 'ACCESS_TOKEN_SECRET',<br/> consumer_key: 'CONSUMER_KEY',<br/> consumer_secret: 'CONSUMER_TOKEN'<br/>});</span></pre><h2 id="c644" class="lu kr hu bd ks lv lw lx kw ly lz ma la jc mb mc le jg md me li jk mf mg lm mh dt translated">显示带有关注者计数、朋友计数、您没有关注的关注者以及您关注但没有关注您的用户的报告</h2><p id="94ab" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">twitter应用程序向我们显示了关注者数量和您关注的用户数量。有趣的是，你追随的用户中有多少人没有追随你，你的追随者中有多少人你没有追随。</p><pre class="kf kg kh ki fq mi mj mk ml aw mm dt"><span id="adbe" class="lu kr hu mj b fv mn mo l mp mq">let followers, following;<br/>start.followersIDs(ME).//load followers<br/>do((output)=&gt;followers=output).//set followers variable<br/>followingIDs(ME).//load following<br/>do((output)=&gt;following=output).//set following variable<br/>do(()=&gt;{<br/> console.log(‘followers:’,followers.length);<br/> console.log(‘I follow:’,following.length);<br/> console.log(“Follow me that I don’t follow back:”, Collection(followers).drop(following).count());//use Collection function to create dstools collection and use its functions such as `drop`<br/> console.log(“Don’t follow me back:”, Collection(following).drop(followers).count());<br/>});</span></pre><h2 id="484b" class="lu kr hu bd ks lv lw lx kw ly lz ma la jc mb mc le jg md me li jk mf mg lm mh dt translated">关注所有关注您的用户(您尚未关注的用户)</h2><p id="d6c0" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">一些推特用户相信互惠追随，你追随任何追随你的人。下面的代码实现了这一点。</p><pre class="kf kg kh ki fq mi mj mk ml aw mm dt"><span id="d678" class="lu kr hu mj b fv mn mo l mp mq">start.collection(followers). <br/> drop(following).  //ignore users I am already following<br/> follow(); //follow them</span></pre><h2 id="657c" class="lu kr hu bd ks lv lw lx kw ly lz ma la jc mb mc le jg md me li jk mf mg lm mh dt translated">取消关注所有你关注但没有关注你的用户</h2><p id="5c6f" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">这与互惠友谊正好相反，在互惠友谊中，你不想追随任何不追随你的人。例外列表是您仍想关注的用户。这些可能是重要的twitter用户，即使他们没有关注你，你也要确保关注他们。</p><pre class="kf kg kh ki fq mi mj mk ml aw mm dt"><span id="0003" class="lu kr hu mj b fv mn mo l mp mq">exceptions = ['hackernoon','JavaScriptDaily'];<br/>following. //start with all users I follow<br/> drop(followers).  //drop users that follow me<br/> twitterUser(). //translate ids to user objects<br/> column('screen_name').//translate user objects to screen_names<br/> drop(exceptions).//remove exception screen names<br/> unfollow(); //unfollow whatever is left</span></pre><h2 id="ff70" class="lu kr hu bd ks lv lw lx kw ly lz ma la jc mb mc le jg md me li jk mf mg lm mh dt translated">为您的关注者简历获取word cloud(个人资料的描述部分)</h2><p id="47c1" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">了解你的受众是沟通的首要原则。当你有成千上万的追随者时，了解你的观众是一个挑战。一个可能的捷径是查看他们的bios的单词云，总结所有用户的bios。</p><pre class="kf kg kh ki fq mi mj mk ml aw mm dt"><span id="79e9" class="lu kr hu mj b fv mn mo l mp mq">start.followers(ME,10000).<br/>column('description').toLowerCase().<br/>terms().dropStopwords('term').<br/>sortDesc('count').head(50).wordCloud('term','count').save('word-cloud.html');</span></pre><h2 id="1ff3" class="lu kr hu bd ks lv lw lx kw ly lz ma la jc mb mc le jg md me li jk mf mg lm mh dt translated">搜索在推特上谈论特定话题的用户</h2><p id="7488" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">“追随谁”是任何twitter用户都会遇到的问题。如果你对“vue”感兴趣，你应该关注哪些twitter用户？使用下面的代码，我们搜索关于“vue”的推文，找到哪些用户写了推文，加载他们的用户配置文件，并显示亮点，以便我们可以选择关注谁:</p><pre class="kf kg kh ki fq mi mj mk ml aw mm dt"><span id="ae1c" class="lu kr hu mj b fv mn mo l mp mq">start.searchTweets('javascript react',10000,{result_type:'mixed'}).<br/>filter((tweet)=&gt;!tweet.text.startsWith('RT @')). //filter out retweets<br/>map((tweet)=&gt;tweet.user). //get users of the tweets<br/>groupBy('screen_name').<br/>sortDesc((item)=&gt;item.data[0].followers_count).//order by followers<br/>head(20).<br/>do((users)=&gt;{<br/> console.log('screen_name, tweets in search, followers, following, statuses, description');<br/> users.forEach((user)=&gt;console.log(<br/>  user.key + ':', //screen_name<br/>  user.data.length,<br/>  user.data[0].followers_count,<br/>  user.data[0].favourites_count,<br/>  user.data[0].statuses_count,<br/>  user.data[0].description));<br/>});</span></pre><h1 id="d5a5" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">最后的话</h1><p id="c409" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">Twitter是一个无尽的数据桶。使用twitter API并将其与数据分析工具结合可以产生重要的洞察力。这篇文章描述了在dstwitter包中使用API的基础知识。在以后的文章中，我将演示如何使用数据工具来分析twitter数据。同时，你可以看看我关于使用Javascript进行数据分析的帖子</p><div class="mr ms fm fo mt mu"><a href="https://hackernoon.com/data-science-for-javascript-developers-2cc3fb1fbefc" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab ej"><div class="mw ab mx cl cj my"><h2 class="bd hv fv z el mz eo ep na er et ht dt translated">Javascript开发人员的数据科学</h2><div class="nb l"><h3 class="bd b fv z el mz eo ep na er et ek translated">使用Javascript进行数据分析的教程</h3></div><div class="nc l"><p class="bd b gc z el mz eo ep na er et ek translated">hackernoon.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni ko mu"/></div></div></a></div></div></div>    
</body>
</html>