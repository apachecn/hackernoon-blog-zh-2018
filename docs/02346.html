<html>
<head>
<title>Part1-Using Deep learning to identify natural disasters from satellite images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第一部分-使用深度学习从卫星图像中识别自然灾害</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/using-deep-learning-to-identify-natural-disasters-from-satellite-images-94815a7514f4?source=collection_archive---------15-----------------------#2018-03-15">https://medium.com/hackernoon/using-deep-learning-to-identify-natural-disasters-from-satellite-images-94815a7514f4?source=collection_archive---------15-----------------------#2018-03-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="75fa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">导致这个小型项目的想法是，当有卫星图像时，CNN在识别自然灾害方面有多有效。一个能够使用接近实时的卫星图像标记灾害类型的精确系统将导致对受灾地区更好的反应和救济。</p><p id="ee7d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">使用的数据:</strong>来自NASA地球观测站的跨越多种灾害类型的不同分辨率的RGB卫星图像被用作训练和验证样本。(参见下图-1)。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/57933831224e88d56f681318c1ae0f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tVnskr1SVmQXho98tDCeBw.jpeg"/></div></div><figcaption class="kb kc fg fe ff kd ke bd b be z ek">Image1-RGB X 2967 X 2967 Satellite image of a wild fire(Source-NASA Earth observatory)</figcaption></figure><p id="b4cc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">数据提取- 为了从NASA地球观测站提取图像，我使用了非常酷的eonet API(<a class="ae kf" href="https://eonet.sci.gsfc.nasa.gov/api/v2" rel="noopener ugc nofollow" target="_blank">https://eonet.sci.gsfc.nasa.gov/api/v2【t 5.1/events】)。该API允许您使用GET request获取所需的图像url。这些图像按照自然灾害类型(例如火灾、干旱、风暴等)进行标记。我个人使用python中的请求来提取所需的URL及其对应的标签。为了提取图像，我混合使用了url2、xml.html &amp;请求包。</a></p><pre class="jq jr js jt fq kg kh ki kj aw kk dt"><span id="9ecc" class="kl km hu kh b fv kn ko l kp kq">#Below code should be able to download images to your local from a csv of links</span><span id="0883" class="kl km hu kh b fv kr ko l kp kq">import csv<br/>import urllib<br/>import lxml.html<br/>import requests</span><span id="a630" class="kl km hu kh b fv kr ko l kp kq">connection = urllib.urlopen(url)</span><span id="e6b6" class="kl km hu kh b fv kr ko l kp kq">with open('/required_url.csv') as csvfile:<br/>    csvrows = csv.reader(csvfile, delimiter=',', quotechar='"')<br/>    for row in csvrows:<br/>      if 'view.php' in row[0]:<br/>        filename = row[1]<br/>        url = row[0]<br/>        locn=row[2]<br/>        print (locn)</span></pre><p id="9b76" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我想研究的重要一点是，当缺乏数据时，<a class="ae kf" href="https://hackernoon.com/tagged/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a>模型可以产生的影响。为了确保我的数据样本没有图像丰富，我只用了80张图像。为了保持任务简单，我决定不进行多类分类，只将标签限制为两类(风暴野火/其他)。我的模型的最终目标是能够识别图像中是风暴还是野火(每隔一场自然灾害，它都应该被归类为其他灾害)。</p><p id="eeba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae kf" href="https://hackernoon.com/tagged/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>/数据科学/深度学习社区由一些最聪明的人组成，他们正在开发尖端工具和算法，这些工具和算法将改变我们所知的世界。他们也非常友好地与我们其他人分享这些，这样我们就不需要重新发明轮子了。我使用了由团队@fastai开发的fastai库促进的迁移学习。本实验中使用的大多数方法都是受深度学习第一部分课程的启发。在下面的实验中，我使用了在1000个imagenet类上进行了预训练的resnet32</p><h2 id="2843" class="kl km hu bd ks kt ku kv kw kx ky kz la jc lb lc ld jg le lf lg jk lh li lj lk dt translated">接下来的步骤:</h2><p id="357f" class="pw-post-body-paragraph ir is hu it b iu ll iw ix iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo hn dt translated">1)图像大小调整</p><p id="0258" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">2)确定最佳学习速率</p><p id="abda" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">3)训练输出层，同时保持初始层的其余权重固定</p><p id="94cc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">4)重新训练完整的模型</p><p id="fbba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">5)分析结果</p><ol class=""><li id="abb4" class="lq lr hu it b iu iv iy iz jc ls jg lt jk lu jo lv lw lx ly dt translated"><strong class="it hv">图像大小调整</strong></li></ol><p id="3ace" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如我之前提到的，大多数图像都有不同的分辨率。我想确保我们有一个统一的图像分辨率，以便GPU计算可以达到最佳。以下是调整大小后图像的外观示例:</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/582512ead5b9795d38fb0c51dfa60703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*NXkPtf4HBQduwpffucF_fg.png"/></div></figure><p id="3255" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> 2)确定最佳学习速率</strong></p><p id="2c3c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Jeremy在DL-1课程中展示的最神奇的工具之一是学习率查找器。寻找完美的学习率对于各种方法学(RF，梯度推进，DL)的ML实践者来说总是一个巨大的痛苦。使用下面的学习率查找工具，图表看起来是这样的。由于训练数据样本对我来说很低，我决定使用0.001的学习率来训练模型，以确保模型训练缓慢而不急于下结论。</p><p id="a2be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> 3)训练输出层，同时保持初始层的其余权重固定</strong></p><p id="bf6e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这一步将我推向了大约65%的准确率。与我提到的一篇论文相比，这篇论文看起来很糟糕。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff ma"><img src="../Images/96e3d36d22a6ee17adf50c7b1b44e6b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*pF5crSTj6I7Y-0RGPlnLOA.png"/></div><figcaption class="kb kc fg fe ff kd ke bd b be z ek">Transfer Learning from Deep Features for Remote Sensing and Poverty Mapping(Michael Xie and Neal Jean and Marshall Burke and David Lobell and Stefano Ermon)</figcaption></figure><p id="0dc0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> 4)重新训练完整模型</strong></p><p id="e0b2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在resnet34使用imagenet的1000个类对象进行预训练。在卫星图像的情况下，这1000个对象并不完全适合用于迁移学习。因此，我为我们的用例重新培训了imagenet的所有层。结果非常令人印象深刻，因为我现在已经达到了大约75% 的<strong class="it hv">精度。我观察到的一件事是，跨时期的精度变化不太稳定，这可能是由于低训练样本&lt; 100，由于该样本，模型试图拟合的函数不完全稳定，这可能导致当我移出样本时性能下降。</strong></p><p id="3918" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> 5)分析结果</strong></p><p id="33d9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们看看这个模型是如何预测的:</p><p id="b98b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">随机几张正确的图像</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff mb"><img src="../Images/0220564c2f77b54b4313d4ce7f8cbc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HcDLLZEloW2zY35EBBXSRA.png"/></div></div><figcaption class="kb kc fg fe ff kd ke bd b be z ek">model correctly predicting storm and wildfires</figcaption></figure><p id="68e0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">随机出现一些不正确的图像</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff mb"><img src="../Images/1e47eedf6dd21fc63e84912a82bc72b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fpj2_HcxflkyNcHtTs26qQ.png"/></div></div><figcaption class="kb kc fg fe ff kd ke bd b be z ek">Model not able to differentiate between other natural disasters and storm and wildfires</figcaption></figure><p id="a85a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">模型无法区分其他自然灾害，例如雪和我们预测的风暴和野火(如果你认为这甚至对人眼来说都很棘手，因为这两种灾害都与寻找白色物质有关(雪的情况下是雨夹雪，火的情况下是烟雾)。这可能会使任何人或机器感到困惑。解决方案可能是更多的训练数据，这将为机器提供更多的数据点，以得出正确的结论。</p><p id="5e84" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">最正确的风暴和野火</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff mc"><img src="../Images/8843f95109897813f37cf8066f4a0107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZXeDlE4GpWMdvCAP2yk0mQ.png"/></div></div></figure><p id="9f2a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">最正确的其他人(那不是风暴或野火)</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff md"><img src="../Images/52004ec4e8cde304bef7e3e3e019236d.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*U0jlPkZ-jTYQTfxsV7YzsA.png"/></div></figure><p id="bf95" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">最不正确的风暴或野火</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff mb"><img src="../Images/488e69d9c2b3904ead9a8e20b0cb2d6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYWglCstIV7iqp9GWCv74A.png"/></div></div></figure><p id="e1d5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">最不正确的其他(那不是风暴或野火)</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff me"><img src="../Images/8900b51d227a3f5c5c5d1f055fd85c9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Rba6PB3l1iQ7OYF2fqYmw.png"/></div></div></figure><h1 id="a732" class="mf km hu bd ks mg mh mi kw mj mk ml la mm mn mo ld mp mq mr lg ms mt mu lj mv dt translated">结论</h1><p id="acab" class="pw-post-body-paragraph ir is hu it b iu ll iw ix iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo hn dt translated">尽管我们预测风暴或野火这两种自然灾害的深度学习模型达到了大约75%的准确率，这看起来不错(与我跟踪的学术文献相比)，但该模型似乎不稳定。由于不同灾害图像的混淆性质(暴风雪看起来可能类似于野火)，甚至人眼也可能被混淆。可能是使用了更多的训练点(我在这个实验中只用了~80张图片应该更有收获。</p><h1 id="92b9" class="mf km hu bd ks mg mh mi kw mj mk ml la mm mn mo ld mp mq mr lg ms mt mu lj mv dt translated"><strong class="ak">接下来的步骤</strong></h1><ol class=""><li id="227d" class="lq lr hu it b iu ll iy lm jc mw jg mx jk my jo lv lw lx ly dt translated">获取更多自然灾害的卫星图像</li><li id="320e" class="lq lr hu it b iu mz iy na jc nb jg nc jk nd jo lv lw lx ly dt translated">尝试在更大的样本量上进行训练</li><li id="7a1c" class="lq lr hu it b iu mz iy na jc nb jg nc jk nd jo lv lw lx ly dt translated">进一步简化问题陈述(可以试着从野火中预测暴风雪),而不是在另一门课上搞个大杂烩</li></ol><p id="d197" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">衷心感谢<a class="ne nf gr" href="https://medium.com/u/34ab754f8c5e?source=post_page-----94815a7514f4--------------------------------" rel="noopener" target="_blank">杰瑞米·霍华德</a> &amp; <a class="ne nf gr" href="https://medium.com/u/ee56d0bac1b7?source=post_page-----94815a7514f4--------------------------------" rel="noopener" target="_blank">雷切尔·托马斯</a>和fastai的整个团队，感谢他们提供了这个令人惊叹的MOOC和Fastai工具包。自上而下的学习方法应该会让每个人都喜欢深度学习，因为它的实用性和广泛的应用案例。简直等不及2018课程的第二部分在网上发布了。</p><p id="ff33" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果我想在下一次迭代中解决这个问题，请阅读我实验的第二部分  </p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="nh ni l"/></div></figure></div></div>    
</body>
</html>