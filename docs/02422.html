<html>
<head>
<title>Komiser: AWS Environment Inspector</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Komiser: AWS环境检查员</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/komiser-aws-environment-inspector-8340946b6237?source=collection_archive---------4-----------------------#2018-03-17">https://medium.com/hackernoon/komiser-aws-environment-inspector-8340946b6237?source=collection_archive---------4-----------------------#2018-03-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/daeb81cc1923760716d2c4fcaae74392.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*KrqHQzlltWXp3dVrI3j_Nw.png"/></div></figure><p id="8347" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">为了在<strong class="ja hv"> AWS </strong>中构建<strong class="ja hv"> HA </strong> &amp; <strong class="ja hv">弹性</strong>应用，你需要假设一切都会失败。因此，您总是在多个<strong class="ja hv"> AZ </strong> &amp; <strong class="ja hv">区域</strong>中设计和部署您的应用程序。因此，您最终会得到许多未使用的AWS资源(快照、ELB、EC2、弹性IP等),这可能会让您损失一大笔钱。</p><p id="f7dc" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">AWS架构良好的框架的支柱之一是<strong class="ja hv">成本优化</strong>。这就是为什么您需要对您的<strong class="ja hv"> AWS基础设施</strong>有一个全局的概述。幸运的是，AWS提供了许多完全托管的服务，如<strong class="ja hv"> CloudWatch </strong>、<strong class="ja hv"> CloudTrail </strong>、<strong class="ja hv">可信顾问</strong> &amp; <strong class="ja hv"> AWS Config </strong>来帮助您实现这一点。但是，他们需要对AWS平台有深入的了解，而且他们不是直截了当的。</p><figure class="jy jz ka kb fq iv fe ff paragraph-image"><div class="fe ff jx"><img src="../Images/e9cfe2f2352eae091978c5b4faed7932.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/0*OI-LFN2UFBJSp3SR."/></div></figure><p id="b618" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这就是为什么我想出了<a class="ae jw" href="https://github.com/mlabouardy/komiser" rel="noopener ugc nofollow" target="_blank"> Komiser </a>这款工具，它通过查询<strong class="ja hv"> AWS API </strong>来获取AWS几乎所有关键服务的信息，如<strong class="ja hv"> EC2 </strong>、<strong class="ja hv"> RDS </strong>、<strong class="ja hv"> ELB </strong>、<strong class="ja hv"> S3 </strong>、<strong class="ja hv"> Lambda </strong> …在单个<strong class="ja hv">仪表盘</strong>中实时获取。</p><p id="e958" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">注意:为了防止请求超过AWS API速率限制，默认情况下，响应会在<strong class="ja hv">的<strong class="ja hv">内存缓存</strong>中缓存30分钟</strong>。</p><p id="2987" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> Komiser </strong>支持的<strong class="ja hv"> AWS服务</strong>:</p><figure class="jy jz ka kb fq iv fe ff paragraph-image"><div class="fe ff kc"><img src="../Images/a99f6fd88b2da42bab2a745ba3f45204.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*N_JD580JK3AFTpf_."/></div></figure><p id="a504" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">计算:</strong></p><ul class=""><li id="3692" class="kd ke hu ja b jb jc jf jg jj kf jn kg jr kh jv ki kj kk kl dt translated">运行/停止/终止EC2实例</li><li id="6c5e" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">每个区域的当前EC2实例</li><li id="6845" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">每个族类型的EC2实例</li><li id="e909" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">每个运行时环境的Lambda函数</li><li id="32eb" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">分离的弹性IP地址</li><li id="ec07" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">密钥对的总数</li><li id="c8bb" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">自动缩放组的总数</li></ul><p id="ed14" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">网络&amp;内容交付:</strong></p><ul class=""><li id="ea2f" class="kd ke hu ja b jb jc jf jg jj kf jn kg jr kh jv ki kj kk kl dt translated">VPC总数</li><li id="9599" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">网络访问控制列表的总数</li><li id="956e" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">安全组的总数</li><li id="b562" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">路由表的总数</li><li id="e388" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">互联网网关总数</li><li id="23a6" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">Nat网关的总数</li><li id="0052" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">每个家庭类型的弹性负载平衡器(ELB、ALB、NLB)</li></ul><p id="e172" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">管理工具:</strong></p><ul class=""><li id="5a6d" class="kd ke hu ja b jb jc jf jg jj kf jn kg jr kh jv ki kj kk kl dt translated">CloudWatch警报状态</li><li id="d4de" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">计费报告(最长6个月)</li></ul><p id="5a47" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">数据库:</strong></p><ul class=""><li id="3323" class="kd ke hu ja b jb jc jf jg jj kf jn kg jr kh jv ki kj kk kl dt translated">DynamoDB表</li><li id="2573" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">DynamoDB提供的吞吐量</li><li id="3926" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">RDS数据库实例</li></ul><p id="72a0" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">消息:</strong></p><ul class=""><li id="8e2c" class="kd ke hu ja b jb jc jf jg jj kf jn kg jr kh jv ki kj kk kl dt translated">SQS队列</li><li id="6dc5" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">社交网络话题</li></ul><p id="d002" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">储存:</strong></p><ul class=""><li id="dc8a" class="kd ke hu ja b jb jc jf jg jj kf jn kg jr kh jv ki kj kk kl dt translated">S3水桶</li><li id="30d7" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">EBS卷</li><li id="f9c7" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">EBS快照</li></ul><p id="8884" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">安全身份&amp;合规:</strong></p><ul class=""><li id="e1a5" class="kd ke hu ja b jb jc jf jg jj kf jn kg jr kh jv ki kj kk kl dt translated">IAM角色</li><li id="cd7a" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">IAM策略</li><li id="eebe" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">IAM组</li><li id="28df" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated">IAM用户</li></ul><p id="3058" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> 1 —配置凭证</strong></p><p id="88eb" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> Komiser </strong>需要您的AWS证书才能通过AWS服务认证。<strong class="ja hv"> CLI </strong>支持多种支持这些凭证的方法。默认情况下，CLI将自动从其<strong class="ja hv">默认凭据链</strong>获取凭据。凭据链中的常见项目如下:</p><p id="023f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">环境凭证:</strong></p><ul class=""><li id="6fc5" class="kd ke hu ja b jb jc jf jg jj kf jn kg jr kh jv ki kj kk kl dt translated"><em class="kr"> AWS_ACCESS_KEY_ID </em></li><li id="6ac1" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated"><em class="kr"> AWS_SECRET_ACCESS_KEY </em></li><li id="d9e4" class="kd ke hu ja b jb km jf kn jj ko jn kp jr kq jv ki kj kk kl dt translated"><em class="kr"> AWS_DEFAULT_REGION </em></li></ul><p id="0437" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv">共享凭证文件</strong> ( <strong class="ja hv"> ~/)。AWS/全权证书</strong></p><p id="4fa8" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> EC2实例角色凭证</strong></p><p id="509d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">首先，创建一个新的<a class="ae jw" href="https://console.aws.amazon.com/iam/home?region=us-east-1#" rel="noopener ugc nofollow" target="_blank"> IAM用户</a>，并为其分配以下<strong class="ja hv"> IAM策略</strong>:</p><figure class="jy jz ka kb fq iv"><div class="bz el l di"><div class="ks kt l"/></div></figure><p id="3810" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">接下来，生成新的<strong class="ja hv"> AWS访问密钥</strong> &amp; <strong class="ja hv">秘密密钥</strong>，然后更新<em class="kr"> ~/。AWS/凭证</em>文件如下:</p><figure class="jy jz ka kb fq iv"><div class="bz el l di"><div class="ks kt l"/></div></figure><p id="263e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> 2 —安装</strong></p><p id="30a9" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> 2.1 — CLI </strong></p><p id="4af6" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">找到适合您系统的<a class="ae jw" href="https://github.com/mlabouardy/butler" rel="noopener ugc nofollow" target="_blank">软件包</a>并下载。对于linux:</p><blockquote class="ku kv kw"><p id="bcd2" class="iy iz kr ja b jb jc jd je jf jg jh ji kx jk jl jm ky jo jp jq kz js jt ju jv hn dt translated">wget<a class="ae jw" href="https://s3.us-east-1.amazonaws.com/komiser/1.0.0/linux/komiser" rel="noopener ugc nofollow" target="_blank">https://S3 . us-east-1 . Amazon AWS . com/komiser/1 . 0 . 0/Linux/komiser</a></p><p id="c13e" class="iy iz kr ja b jb jc jd je jf jg jh ji kx jk jl jm ky jo jp jq kz js jt ju jv hn dt translated">chmod +x komiser</p></blockquote><p id="3409" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">注:<strong class="ja hv"> Komiser CLI </strong>经常更新，支持新的AWS服务。要查看您是否有最新版本，请查看<a class="ae jw" href="https://github.com/mlabouardy/komiser" rel="noopener ugc nofollow" target="_blank">项目Github资源库</a>。</p><p id="4376" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">安装<strong class="ja hv"> Komiser CLI </strong>后，您可能需要将可执行文件的路径添加到您的<strong class="ja hv"> PATH </strong>变量中。</p><p id="f243" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> 2.2 — Docker图像</strong></p><p id="dfae" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">使用官方<strong class="ja hv"> Komiser Docker图片</strong>:</p><blockquote class="ku kv kw"><p id="e43c" class="iy iz kr ja b jb jc jd je jf jg jh ji kx jk jl jm ky jo jp jq kz js jt ju jv hn dt translated">docker run-d-p 3000:3000-e AWS _ ACCESS _ KEY _ ID = "-e AWS _ SECRET _ ACCESS _ KEY = "-e AWS _ DEFAULT _ REGION = " "—名称komiser mlabouardy/komiser</p></blockquote><p id="19cc" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> 3 —概述</strong></p><p id="c63e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">安装完成后，启动<strong class="ja hv"> Komiser服务器</strong>:</p><blockquote class="ku kv kw"><p id="6903" class="iy iz kr ja b jb jc jd je jf jg jh ji kx jk jl jm ky jo jp jq kz js jt ju jv hn dt translated">komiser start —端口3000 —持续时间30</p></blockquote><p id="31b1" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你把你最喜欢的浏览器指向<a class="ae jw" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>，你应该会看到<strong class="ja hv"> Komiser Dashboard </strong>:</p><figure class="jy jz ka kb fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="fe ff la"><img src="../Images/cd3e3bd33c46a848bb948238870ad8be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vWIHZGHyeemfh6Uk."/></div></div></figure><p id="e2fc" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">希望有帮助！CLI仍处于早期阶段，因此欢迎您为Github上的项目做出贡献。</p></div></div>    
</body>
</html>