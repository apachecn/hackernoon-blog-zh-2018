<html>
<head>
<title>How to access your Raspberry Pi Camera from anywhere</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从任何地方访问您的Raspberry Pi相机</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-access-your-raspberry-pi-camera-from-anywhere-544ab9e5bacc?source=collection_archive---------0-----------------------#2018-03-18">https://medium.com/hackernoon/how-to-access-your-raspberry-pi-camera-from-anywhere-544ab9e5bacc?source=collection_archive---------0-----------------------#2018-03-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="16b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这篇文章是关于如何用树莓派监视你的宠物的系列文章的一部分，不要错过这里的第一步:<a class="ae jp" href="https://hackernoon.com/spy-your-pet-with-a-raspberry-pi-camera-server-e71bb74f79ea" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">用树莓派相机服务器监视你的宠物</strong> </a> <strong class="it hv"> </strong>在这里我描述了如何设置相机流服务器！</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/2c2aa2c7e17f3172914514770471307e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OcBoUYlT_MGzjRAnSdnmSA.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Final result of the tutorials : a full connected cage !</figcaption></figure><p id="72e7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了从任何地方访问您的Raspberry Pi，您需要能够进入您的家庭网络！从任何地方访问它的唯一方法是什么？你的IP地址！它基本上就像你的家庭地址，但在互联网上。</p><p id="84cb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，大多数家庭网络的IP地址在一定时间后会动态改变。假设你直接用它来访问你的PI，它只能工作很短时间，然后你需要回家再检查一次。</p><blockquote class="kg kh ki"><p id="6a59" class="ir is kj it b iu iv iw ix iy iz ja jb kk jd je jf kl jh ji jj km jl jm jn jo hn dt translated">哦！那么我们是否可以在Raspberry Pi中创建一个脚本来检查我们的IP地址并将其发送回给我们呢？</p></blockquote><p id="c8e8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以的！但假设你想建立一个网站或应用程序，使用这个IP来访问你的PI，你将不得不不断地做更新来改变IP。这很烦人，对吧？</p><blockquote class="kg kh ki"><p id="6941" class="ir is kj it b iu iv iw ix iy iz ja jb kk jd je jf kl jh ji jj km jl jm jn jo hn dt translated">然后，也许我可以要求家里有固定的IP地址？</p></blockquote><p id="d1ae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">是啊！但是大多数互联网提供商仍然对固定IP地址收费。这就是为什么我使用免费的DDNS工具。</p><h1 id="036a" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">无ip的动态DNS</h1><p id="31bf" class="pw-post-body-paragraph ir is hu it b iu ll iw ix iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo hn dt translated">为了从任何地方访问我的PI，我使用了一种叫做动态DNS或域名服务器的服务。它包括什么？</p><ul class=""><li id="761c" class="lq lr hu it b iu iv iy iz jc ls jg lt jk lu jo lv lw lx ly dt translated">您为您的家庭网络选择一个名称，它会将请求重定向到存储在非ip服务器上的IP地址。我选择了<a class="ae jp" href="http://mochi.ddns.net" rel="noopener ugc nofollow" target="_blank">http://mochi.ddns.net</a></li><li id="1f5f" class="lq lr hu it b iu lz iy ma jc mb jg mc jk md jo lv lw lx ly dt translated">您在您的Raspberry PI中安装no-ip脚本。这将确保您的家庭IP地址存储在no-ip总是更新。</li></ul><blockquote class="kg kh ki"><p id="7754" class="ir is kj it b iu iv iw ix iy iz ja jb kk jd je jf kl jh ji jj km jl jm jn jo hn dt translated">我使用<a class="ae jp" href="https://www.noip.com/" rel="noopener ugc nofollow" target="_blank"> no-ip </a>服务，因为你可以有一个免费的动态域名系统。网上还有很多其他服务，你可以选择任何适合你的服务。原理是一样的。</p></blockquote><h2 id="171e" class="me ko hu bd kp mf mg mh kt mi mj mk kx jc ml mm lb jg mn mo lf jk mp mq lj mr dt translated">第一步:创建你的域名</h2><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff ms"><img src="../Images/4c3c61efe8109f30e9e835a6196bef48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HLZbT1WKXNzK_cda9AP2kQ.png"/></div></div></figure><p id="56c5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<a class="ae jp" href="https://www.noip.com/" rel="noopener ugc nofollow" target="_blank">订阅</a>之后，在仪表板中，只需进入“动态DNS”部分。然后“创建主机名”。在下一个屏幕上选择一个名称，让选项默认并验证。现在让我们回到我们的圆周率！</p><h2 id="50af" class="me ko hu bd kp mf mg mh kt mi mj mk kx jc ml mm lb jg mn mo lf jk mp mq lj mr dt translated">步骤2:在您的PI上安装no-ip脚本</h2><p id="cc66" class="pw-post-body-paragraph ir is hu it b iu ll iw ix iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo hn dt translated">先从no-ip下载脚本吧。在Raspberry PI终端上:</p><pre class="jr js jt ju fq mt mu mv mw aw mx dt"><span id="3c1c" class="me ko hu mu b fv my mz l na nb"><strong class="mu hv"># Create the directory, step into, and download the script</strong><br/>mkdir /home/pi/noip<br/>cd /home/pi/noip<br/><em class="kj">wget </em><a class="ae jp" href="http://www.no-ip.com/client/linux/noip-duc-linux.tar.gztar" rel="noopener ugc nofollow" target="_blank"><em class="kj">http://www.no-ip.com/client/linux/noip-duc-linux.tar.gz<br/></em>tar</a> vzxf noip-duc-linux.tar.gz</span></pre><p id="051a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这应该已经创建了另一个目录，其中包含一个由最新版本的no-ip脚本命名的文件夹。</p><pre class="jr js jt ju fq mt mu mv mw aw mx dt"><span id="196a" class="me ko hu mu b fv my mz l na nb"><strong class="mu hv"># Install no-ip script!</strong><em class="kj"><br/>cd noip-</em><strong class="mu hv"><em class="kj">&lt;the_version_you_have_downloaded&gt;</em></strong><em class="kj"><br/></em>sudo make install</span></pre><p id="762d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您将被提示使用您的no-ip帐户登录。之后，当被问及希望多久触发一次更新时，我推荐15分钟。现在让我们启动服务吧！</p><pre class="jr js jt ju fq mt mu mv mw aw mx dt"><span id="710f" class="me ko hu mu b fv my mz l na nb">sudo /usr/local/bin/noip2<br/><strong class="mu hv"># To confirm the service is running properly</strong><br/>sudo noip2 ­-S</span></pre><p id="8491" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后一步，我们希望自动启动服务。如果我们不这样做，您将不得不在每次重新启动Pi后都这样做。</p><pre class="jr js jt ju fq mt mu mv mw aw mx dt"><span id="e53b" class="me ko hu mu b fv my mz l na nb"><strong class="mu hv"># Open the boot file</strong><br/>sudo nano /etc/rc.local</span><span id="df53" class="me ko hu mu b fv nc mz l na nb"><strong class="mu hv"># Add this line at the bottom of the file (just before exit 0)</strong><br/>/usr/local/bin/noip2</span></pre><p id="fd57" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">搞定了。现在我们有了一个自动系统，可以单独更新我们的域名IP！棘手的部分来了。</p><h1 id="c57e" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">配置您的internet box</h1><p id="57b9" class="pw-post-body-paragraph ir is hu it b iu ll iw ix iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo hn dt translated">好的，我们有一个域名，它总是重定向到我们的家庭网络。然而，你的互联网盒子(又名<strong class="it hv">路由器</strong>)不知道如何处理传入的请求！我们需要问<em class="kj">“嘿，请把进来的请求重定向到树莓派”。</em>所有的路由器都是不一样的，最好的办法就是用你的品牌和型号在网页上搜索“端口转发”。我会在这里强调你必须做的主要事情。</p><h2 id="a18f" class="me ko hu bd kp mf mg mh kt mi mj mk kx jc ml mm lb jg mn mo lf jk mp mq lj mr dt translated"><strong class="ak">连接到你的路由器管理面板</strong></h2><p id="8113" class="pw-post-body-paragraph ir is hu it b iu ll iw ix iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo hn dt translated">在web浏览器上，在URL栏中键入您的路由器IP地址。通常是192.168.1.1或192.168.1.254。如果没有，它应该在你的路由器手册的某个地方。</p><ol class=""><li id="50ef" class="lq lr hu it b iu iv iy iz jc ls jg lt jk lu jo nd lw lx ly dt translated">登录。默认情况下，凭据通常是admin &amp; admin或0000。</li><li id="2e3f" class="lq lr hu it b iu lz iy ma jc mb jg mc jk md jo nd lw lx ly dt translated">在路由器管理页面中，找到<strong class="it hv">端口转发</strong>部分。</li></ol><h2 id="b510" class="me ko hu bd kp mf mg mh kt mi mj mk kx jc ml mm lb jg mn mo lf jk mp mq lj mr dt translated">配置端口转发到您的PI</h2><p id="3014" class="pw-post-body-paragraph ir is hu it b iu ll iw ix iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo hn dt translated">找到端口转发后，您需要添加一个新规则。下面是一个参数及其含义的示例。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff ne"><img src="../Images/58c398b3f32c3ec8be0d57bb8f6dc870.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GIcYbMi1646bAX-1fA3Ogw.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">French BBOX port forwarding configuration</figcaption></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nf"><img src="../Images/caca2815db4c491390d31875bc6c1446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1TZhxFzf_U6OEKceMSR1CA.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">French Livebox port forwarding configuration with a additional rule for a web server (80). From left to right : Application, internal port, external port, protocol, device, active</figcaption></figure><p id="611b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">内部端口</strong>:raspberry Pi上的端口，请求应该被重定向到该端口。在我们的例子中，如果你遵循第一个教程，视频流服务器在8081。</p><p id="1433" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">外部端口</strong>:我们不希望所有请求都重定向到我们的PI。只有那些针对摄像头服务器的。因为我们将使用浏览器或应用程序来访问我们的Pi，所以我们可以使用任何我们想要的端口来请求我们的家庭网络。(例如，我们将使用<a class="ae jp" href="http://mochi.ddns.net:8081)." rel="noopener ugc nofollow" target="_blank"> http://mochi.ddns.net:XXXX)。</a>为了简单起见，我用了和视频流服务器一样的:8081。</p><p id="5820" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">协议</strong>:设置为全部。</p><p id="f2b1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> IP地址/设备</strong>:您家庭网络中Pi的IP。这就是我们将要重定向传入请求的地方，这样它们就可以到达我们的Pi。要找到它，请键入以下命令(在您的Pi上):</p><pre class="jr js jt ju fq mt mu mv mw aw mx dt"><span id="b08c" class="me ko hu mu b fv my mz l na nb">ifconfig</span></pre><p id="c8fb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在命令行响应中，找到<strong class="it hv">“inet addr”</strong>，这将为您提供Raspberry Pi IP</p><pre class="jr js jt ju fq mt mu mv mw aw mx dt"><span id="191d" class="me ko hu mu b fv my mz l na nb">wlan0 Link encap:Ethernet HWaddr 80:1f:02:aa:12:58<br/>      <strong class="mu hv">inet addr:192.168.1.8</strong> Bcast:192.168.1.255 Mask:255.255.255.0<br/>      ...</span></pre><blockquote class="kg kh ki"><p id="c374" class="ir is kj it b iu iv iw ix iy iz ja jb kk jd je jf kl jh ji jj km jl jm jn jo hn dt translated">我们实际上是在告诉我们的路由器:请用端口8081将所有外界请求重定向到端口8081上的raspberry Pi。</p></blockquote><p id="4d0b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">添加规则后，您可能需要重启路由器，最后我们都设置好了！</p><h1 id="ccd4" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">从任何地方访问您的Raspberry PI相机流</h1><p id="8087" class="pw-post-body-paragraph ir is hu it b iu ll iw ix iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo hn dt translated">在上一个教程中，我们学习了如何安装<strong class="it hv"> Motion Pi。</strong>还记得您为流服务器配置<strong class="it hv">端口的步骤吗？该端口是您系统上视频流的入口。现在我们要使用它…非常简单！</strong></p><p id="486e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">⚠️尝试使用不同于你家的连接。例如，在你的智能手机上。当在本地网络中时，尝试使用DDNS可能不起作用。这是<strong class="it hv">路由器</strong>的一个限制。</p><p id="e273" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">从网上测试你的相机！</strong>https://<strong class="it hv">&lt;your _ ddns _ name&gt;</strong>. ddns . net:<strong class="it hv">&lt;motion _ port&gt;T7】</strong></p><h2 id="7f06" class="me ko hu bd kp mf mg mh kt mi mj mk kx jc ml mm lb jg mn mo lf jk mp mq lj mr dt translated"><strong class="ak">认证摄像机服务器</strong></h2><p id="78fb" class="pw-post-body-paragraph ir is hu it b iu ll iw ix iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo hn dt translated">为了保护您的相机，您可以添加用户名和密码。如果您已经按照<a class="ae jp" href="https://hackernoon.com/spy-your-pet-with-a-raspberry-pi-camera-server-e71bb74f79ea" rel="noopener ugc nofollow" target="_blank">之前的教程</a>使用motion，您可以:</p><pre class="jr js jt ju fq mt mu mv mw aw mx dt"><span id="a340" class="me ko hu mu b fv my mz l na nb">sudo vim /etc/motion/motion.conf<br/># Add this line in the file<br/>webcontrol_authentication username:password</span></pre><p id="478e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">更多细节和选项见<a class="ae jp" href="https://motion-project.github.io/motion_config.html#webcontrol_authentication" rel="noopener ugc nofollow" target="_blank">运动文件</a>。</p></div><div class="ab cl ng nh hc ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="hn ho hp hq hr"><p id="2544" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所有这些教程也适用于您的raspberry PI上的任何公开服务。例如，你可以在一个网络服务器上建立一个网站。(那么端口将是80)。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff nn"><img src="../Images/36f6b05fd76deb10a1740378c586a037.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*FcK3hixtSz4qnHyWal2wEA.gif"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Capture from a distant browser</figcaption></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff nn"><img src="../Images/2605c31395fb160db494a36610b86092.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*bsNxsRC_0u2aSmq2E7lfHA.gif"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Connected food dispenser! (Next article)</figcaption></figure><p id="f71d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我的下一篇文章中，我将向你展示如何用你的树莓派 来建造一个食物分发器，然后用网络服务器从任何地方<strong class="it hv">触发它</strong>！</p><p id="81b1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你喜欢这篇文章，并且它帮助你在你的Pi上构建了你自己的远程系统，请贴一张它=D！</p><p id="1f17" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">非常感谢您的阅读。回头见。</p></div></div>    
</body>
</html>