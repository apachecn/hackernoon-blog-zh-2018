<html>
<head>
<title>Authorized requests to S3 bucket</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å‘S3Â·æ¯”æçš„æˆæƒè¯·æ±‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/authorized-requests-to-s3-bucket-6c64ba02f60c?source=collection_archive---------9-----------------------#2018-03-21">https://medium.com/hackernoon/authorized-requests-to-s3-bucket-6c64ba02f60c?source=collection_archive---------9-----------------------#2018-03-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="ee5f" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">å—ä¿æŠ¤çš„S3å­˜å‚¨æ¡¶ï¼Œå—ä¿æŠ¤çš„æ–‡ä»¶</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff jj"><img src="../Images/3be3340b943939b16372bdec32545134.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*BsS33Afv1Qzm7DU-XLJX0g.png"/></div></figure><p id="ef63" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">æœ¬ç¬”è®°æœ¬å±•ç¤ºäº†å‘S3å­˜å‚¨æ¡¶æ·»åŠ åŸºæœ¬æƒé™çš„æˆå“</p><p id="c987" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">æˆ‘ä»¬ä½¿ç”¨åŸºæœ¬èº«ä»½éªŒè¯ï¼Œè¿™æ˜¯ä¸€ç§HTTPåè®®ï¼Œç”¨äºå¯¹webå¯è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç®€å•èº«ä»½éªŒè¯ã€‚<a class="ae kn" href="https://en.wikipedia.org/wiki/Basic_access_authentication" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Basic_access_authentication</a></p><p id="400e" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">åŸºæœ¬èº«ä»½éªŒè¯ä¸æ˜¯å¾ˆå®‰å…¨â€”â€”ç„¶è€Œï¼Œæˆ‘ä»¬å°†å®ƒä¸HTTPSé…å¯¹ï¼Œå¹¶é™åˆ¶å¯¹s3å­˜å‚¨æ¡¶çš„è®¿é—®ã€‚</em></p><h2 id="c968" class="kp kq hu bd kr ks kt ku kv kw kx ky kz ka la lb lc ke ld le lf ki lg lh li lj dt translated">è®¾ç½®ä¸€äº›pythonçš„ä¸œè¥¿</h2><p id="1014" class="pw-post-body-paragraph jr js hu jt b ju lk iv jw jx ll iy jz ka lm kc kd ke ln kg kh ki lo kk kl km hn dt translated">åœ¨[1]ä¸­:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="c84c" class="kp kq hu lq b fv lu lv l lw lx">import requests; import json</span></pre><h1 id="641d" class="ly kq hu bd kr lz ma mb kv mc md me kz ja mf jb lc jd mg je lf jg mh jh li mi dt translated">æ— éœ€æˆæƒå³å¯è®¿é—®å®‰å…¨ç«¯ç‚¹</h1><p id="9ff0" class="pw-post-body-paragraph jr js hu jt b ju lk iv jw jx ll iy jz ka lm kc kd ke ln kg kh ki lo kk kl km hn dt translated">é¦–å…ˆï¼Œæˆ‘ä»¬è¯•å›¾åœ¨æ²¡æœ‰ä»»ä½•å‡­è¯çš„æƒ…å†µä¸‹è®¿é—®è¿™ä¸ªæ–‡ä»¶</p><p id="ee5c" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">åœ¨[2]ä¸­:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="52a3" class="kp kq hu lq b fv lu lv l lw lx">url = 'https://d17nii79zr8aom.cloudfront.net/success.json'<br/>resp = requests.get(url)<br/>resp.content</span></pre><p id="c56b" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Out[2]:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="6b29" class="kp kq hu lq b fv lu lv l lw lx">'Unauthorized'</span></pre><p id="39fb" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·»åŠ åŸºæœ¬çš„èº«ä»½éªŒè¯å‚æ•°</p><h1 id="c1d6" class="ly kq hu bd kr lz ma mb kv mc md me kz ja mf jb lc jd mg je lf jg mh jh li mi dt translated">ä½¿ç”¨authè®¿é—®å®‰å…¨ç«¯ç‚¹ï¼</h1><p id="7970" class="pw-post-body-paragraph jr js hu jt b ju lk iv jw jx ll iy jz ka lm kc kd ke ln kg kh ki lo kk kl km hn dt translated">åœ¨[3]ä¸­:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="3e42" class="kp kq hu lq b fv lu lv l lw lx">user, password = 'user', 'pass'<br/>resp = requests.get(url, auth=(user, password))<br/>data = json.loads(resp.content)<br/><strong class="lq hv">print</strong> json.dumps(data, indent=4)</span></pre><p id="27be" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Out [3]:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="e541" class="kp kq hu lq b fv lu lv l lw lx">{<br/>    "status": "success", <br/>    "secret": "yay now we can lockdown s3 files!"<br/>}</span></pre><p id="52c8" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">å¥½å§ï¼Œé…·ï¼Œé»‘å®¢ä¸å…³å¿ƒå‰é—¨ã€‚è®©æˆ‘ä»¬å°è¯•è®¿é—®S3å¯¹è±¡çš„ç›´æ¥url</p><h1 id="aefe" class="ly kq hu bd kr lz ma mb kv mc md me kz ja mf jb lc jd mg je lf jg mh jh li mi dt translated">ç›´æ¥S3æ¡¶è®¿é—®</h1><p id="1262" class="pw-post-body-paragraph jr js hu jt b ju lk iv jw jx ll iy jz ka lm kc kd ke ln kg kh ki lo kk kl km hn dt translated">åœ¨[4]ä¸­:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="8d8c" class="kp kq hu lq b fv lu lv l lw lx">direct_url = 'https://s3.amazonaws.com/locked-box/success.json'<br/>resp = requests.get(direct_url)<br/><strong class="lq hv">print</strong> resp.content</span></pre><p id="a1c3" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Out [4]:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="1508" class="kp kq hu lq b fv lu lv l lw lx">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;Error&gt;&lt;Code&gt;AccessDenied&lt;/Code&gt;&lt;Message&gt;Access Denied&lt;/Message&gt;&lt;RequestId&gt;58277072A5A1F927&lt;/RequestId&gt;&lt;HostId&gt;2CmgTzauvXbV0+bf9jMKvlXj3ViMNw4bUL1JMnu4L1QqHfOu0/eHJfG0cxunR0nq7hrVJb8HpQ0=&lt;/HostId&gt;&lt;/Error&gt;</span></pre><p id="e270" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">å¥½å§ï¼Œæ˜¾ç„¶è¿™æ²¡ç”¨â€”â€”æˆ‘ä»¬ç”šè‡³æ²¡æœ‰ä½¿ç”¨å‡­è¯ã€‚è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬çŸ¥é“ç™»å½•å‡­è¯ï¼Œä½†æ˜¯ç›´æ¥åœ¨S3æ¡¶è€Œä¸æ˜¯å®‰å…¨ç«¯ç‚¹ä¸Šä½¿ç”¨å®ƒä»¬ã€‚</p><p id="1287" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">åœ¨[5]ä¸­:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="ef9e" class="kp kq hu lq b fv lu lv l lw lx">user, password = 'user', 'pass'<br/>resp = requests.get(direct_url, auth=(user, password))<br/><strong class="lq hv">print</strong> resp.content</span></pre><p id="1b5c" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Out [5]:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="5f89" class="kp kq hu lq b fv lu lv l lw lx">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;Error&gt;&lt;Code&gt;InvalidArgument&lt;/Code&gt;&lt;Message&gt;Unsupported Authorization Type&lt;/Message&gt;&lt;ArgumentName&gt;Authorization&lt;/ArgumentName&gt;&lt;ArgumentValue&gt;Basic dXNlcjpwYXNz&lt;/ArgumentValue&gt;&lt;RequestId&gt;97760837E823C675&lt;/RequestId&gt;&lt;HostId&gt;MaKcLnOik5Bq4zV+2v9fNzKqikz7JEHdEIv7TJYUP+67jJmdU4w9ekOr9jaZIbGHj+Wz68M4RcI=&lt;/HostId&gt;&lt;/Error&gt;</span></pre><p id="c233" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">æ²¡æœ‰è®¿é—®å®ƒï¼å‘œï¼</p><blockquote class="mj mk ml"><p id="17fe" class="jr js ko jt b ju jv iv jw jx jy iy jz mm kb kc kd mn kf kg kh mo kj kk kl km hn dt translated">æˆåŠŸğŸ¤˜ğŸ½</p></blockquote><h2 id="69be" class="kp kq hu bd kr ks kt ku kv kw kx ky kz ka la lb lc ke ld le lf ki lg lh li lj dt translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Lambdaå‡½æ•°è¿›è¡Œèº«ä»½éªŒè¯æ¥é”å®šS3æ–‡ä»¶â€”â€”ä½¿ç”¨Cloudfront HTTPSç«¯ç‚¹ä½œä¸ºè®¿é—®ç‚¹</h2></div></div>    
</body>
</html>