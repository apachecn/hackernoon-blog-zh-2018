<html>
<head>
<title>Authorized requests to S3 bucket</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向S3·比提的授权请求</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/authorized-requests-to-s3-bucket-6c64ba02f60c?source=collection_archive---------9-----------------------#2018-03-21">https://medium.com/hackernoon/authorized-requests-to-s3-bucket-6c64ba02f60c?source=collection_archive---------9-----------------------#2018-03-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="ee5f" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">受保护的S3存储桶，受保护的文件</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff jj"><img src="../Images/3be3340b943939b16372bdec32545134.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*BsS33Afv1Qzm7DU-XLJX0g.png"/></div></figure><p id="ef63" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">本笔记本展示了向S3存储桶添加基本权限的成品</p><p id="c987" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我们使用基本身份验证，这是一种HTTP协议，用于对web可访问的文件进行简单身份验证。<a class="ae kn" href="https://en.wikipedia.org/wiki/Basic_access_authentication" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Basic_access_authentication</a></p><p id="400e" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">基本身份验证不是很安全——然而，我们将它与HTTPS配对，并限制对s3存储桶的访问。</em></p><h2 id="c968" class="kp kq hu bd kr ks kt ku kv kw kx ky kz ka la lb lc ke ld le lf ki lg lh li lj dt translated">设置一些python的东西</h2><p id="1014" class="pw-post-body-paragraph jr js hu jt b ju lk iv jw jx ll iy jz ka lm kc kd ke ln kg kh ki lo kk kl km hn dt translated">在[1]中:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="c84c" class="kp kq hu lq b fv lu lv l lw lx">import requests; import json</span></pre><h1 id="641d" class="ly kq hu bd kr lz ma mb kv mc md me kz ja mf jb lc jd mg je lf jg mh jh li mi dt translated">无需授权即可访问安全端点</h1><p id="9ff0" class="pw-post-body-paragraph jr js hu jt b ju lk iv jw jx ll iy jz ka lm kc kd ke ln kg kh ki lo kk kl km hn dt translated">首先，我们试图在没有任何凭证的情况下访问这个文件</p><p id="ee5c" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在[2]中:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="52a3" class="kp kq hu lq b fv lu lv l lw lx">url = 'https://d17nii79zr8aom.cloudfront.net/success.json'<br/>resp = requests.get(url)<br/>resp.content</span></pre><p id="c56b" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Out[2]:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="6b29" class="kp kq hu lq b fv lu lv l lw lx">'Unauthorized'</span></pre><p id="39fb" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">接下来，我们添加基本的身份验证参数</p><h1 id="c1d6" class="ly kq hu bd kr lz ma mb kv mc md me kz ja mf jb lc jd mg je lf jg mh jh li mi dt translated">使用auth访问安全端点！</h1><p id="7970" class="pw-post-body-paragraph jr js hu jt b ju lk iv jw jx ll iy jz ka lm kc kd ke ln kg kh ki lo kk kl km hn dt translated">在[3]中:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="3e42" class="kp kq hu lq b fv lu lv l lw lx">user, password = 'user', 'pass'<br/>resp = requests.get(url, auth=(user, password))<br/>data = json.loads(resp.content)<br/><strong class="lq hv">print</strong> json.dumps(data, indent=4)</span></pre><p id="27be" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Out [3]:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="e541" class="kp kq hu lq b fv lu lv l lw lx">{<br/>    "status": "success", <br/>    "secret": "yay now we can lockdown s3 files!"<br/>}</span></pre><p id="52c8" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">好吧，酷，黑客不关心前门。让我们尝试访问S3对象的直接url</p><h1 id="aefe" class="ly kq hu bd kr lz ma mb kv mc md me kz ja mf jb lc jd mg je lf jg mh jh li mi dt translated">直接S3桶访问</h1><p id="1262" class="pw-post-body-paragraph jr js hu jt b ju lk iv jw jx ll iy jz ka lm kc kd ke ln kg kh ki lo kk kl km hn dt translated">在[4]中:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="8d8c" class="kp kq hu lq b fv lu lv l lw lx">direct_url = 'https://s3.amazonaws.com/locked-box/success.json'<br/>resp = requests.get(direct_url)<br/><strong class="lq hv">print</strong> resp.content</span></pre><p id="a1c3" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Out [4]:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="1508" class="kp kq hu lq b fv lu lv l lw lx">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;Error&gt;&lt;Code&gt;AccessDenied&lt;/Code&gt;&lt;Message&gt;Access Denied&lt;/Message&gt;&lt;RequestId&gt;58277072A5A1F927&lt;/RequestId&gt;&lt;HostId&gt;2CmgTzauvXbV0+bf9jMKvlXj3ViMNw4bUL1JMnu4L1QqHfOu0/eHJfG0cxunR0nq7hrVJb8HpQ0=&lt;/HostId&gt;&lt;/Error&gt;</span></pre><p id="e270" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">好吧，显然这没用——我们甚至没有使用凭证。让我们假设我们知道登录凭证，但是直接在S3桶而不是安全端点上使用它们。</p><p id="1287" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在[5]中:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="ef9e" class="kp kq hu lq b fv lu lv l lw lx">user, password = 'user', 'pass'<br/>resp = requests.get(direct_url, auth=(user, password))<br/><strong class="lq hv">print</strong> resp.content</span></pre><p id="1b5c" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Out [5]:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="5f89" class="kp kq hu lq b fv lu lv l lw lx">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;Error&gt;&lt;Code&gt;InvalidArgument&lt;/Code&gt;&lt;Message&gt;Unsupported Authorization Type&lt;/Message&gt;&lt;ArgumentName&gt;Authorization&lt;/ArgumentName&gt;&lt;ArgumentValue&gt;Basic dXNlcjpwYXNz&lt;/ArgumentValue&gt;&lt;RequestId&gt;97760837E823C675&lt;/RequestId&gt;&lt;HostId&gt;MaKcLnOik5Bq4zV+2v9fNzKqikz7JEHdEIv7TJYUP+67jJmdU4w9ekOr9jaZIbGHj+Wz68M4RcI=&lt;/HostId&gt;&lt;/Error&gt;</span></pre><p id="c233" class="pw-post-body-paragraph jr js hu jt b ju jv iv jw jx jy iy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">没有访问它！呜！</p><blockquote class="mj mk ml"><p id="17fe" class="jr js ko jt b ju jv iv jw jx jy iy jz mm kb kc kd mn kf kg kh mo kj kk kl km hn dt translated">成功🤘🏽</p></blockquote><h2 id="69be" class="kp kq hu bd kr ks kt ku kv kw kx ky kz ka la lb lc ke ld le lf ki lg lh li lj dt translated">我们可以使用Lambda函数进行身份验证来锁定S3文件——使用Cloudfront HTTPS端点作为访问点</h2></div></div>    
</body>
</html>