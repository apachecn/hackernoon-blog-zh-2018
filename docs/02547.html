<html>
<head>
<title>How to build a Chrome Extension to save web content to Cosmic JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何构建一个Chrome扩展将网页内容保存到Cosmic JS</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-build-a-chrome-extension-to-save-web-content-to-cosmic-js-ca503ceabd84?source=collection_archive---------18-----------------------#2018-03-21">https://medium.com/hackernoon/how-to-build-a-chrome-extension-to-save-web-content-to-cosmic-js-ca503ceabd84?source=collection_archive---------18-----------------------#2018-03-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/a136a835ce11a12c7f80a00db075f9b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PFLPbPUd5MzJJs5-."/></div></div></figure><p id="cbd3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在本教程中，我们将构建一个Google Chrome扩展来保存web内容到<a class="ae ka" href="https://cosmicjs.com" rel="noopener ugc nofollow" target="_blank">宇宙JS桶</a>。把它想象成你的个人网络剪切机。</p><h1 id="a77a" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">TL；速度三角形定位法(dead reckoning)</h1><p id="c1ea" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><a class="ae ka" href="https://github.com/cosmicjs/content-grabber" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">从GitHub repo下载代码</strong> </a></p><h1 id="c7ec" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">先决条件</h1><p id="1450" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">你只需要安装Chrome进行测试，其他什么都不用做。</p><h1 id="7bf2" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">安装演示</h1><ol class=""><li id="1e56" class="le lf hu je b jf kz jj la jn lg jr lh jv li jz lj lk ll lm dt translated">通过下载或克隆repo将源代码放入您的机器，repo位于<a class="ae ka" href="https://github.com/cosmicjs/content-grabber" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">此处</strong> </a> <strong class="je hv">。</strong></li><li id="ddec" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">在Chrome中，访问<code class="eh ls lt lu lv b">chrome://extensions</code></li><li id="866b" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">勾选右上角的复选框，启用开发者模式。</li><li id="c6a7" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">单击“加载解压缩的扩展…”按钮。</li><li id="7a3d" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">选择包含您的<strong class="je hv">解包的</strong>扩展的目录。</li><li id="5826" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">刷新加载的页面。</li></ol><p id="1589" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，您将在Omnibox的右侧看到扩展图标。点击它，用你的宇宙JS凭证登录。您现在可以开始将内容保存到存储桶中。</p><h1 id="52f3" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">理解源代码</h1><p id="1533" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">Chrome扩展中的定义文件是<a class="ae ka" href="https://github.com/cosmicjs/content-grabber/blob/master/manifest.json" rel="noopener ugc nofollow" target="_blank"> manifest.json </a>文件。清单中的大多数字段都是不言自明的。让我们浏览一下主要的字段，看看每个文件都做些什么。</p><ul class=""><li id="09af" class="le lf hu je b jf jg jj jk jn lw jr lx jv ly jz lz lk ll lm dt translated"><code class="eh ls lt lu lv b">manifest_version</code>是“2”。不要改变它是非常重要的，因为它是chrome如何编译扩展的标志。</li><li id="4bea" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lz lk ll lm dt translated"><code class="eh ls lt lu lv b">permissions</code>包括扩展需要的权限<br/> - <code class="eh ls lt lu lv b">storage</code>权限允许你在“Chrome本地存储”存储数据，这对于跨网站和不同页面保存数据很重要。<br/> - <code class="eh ls lt lu lv b">https://api.cosmicjs.com/v1</code>权限允许在扩展中的任何地方从API检索数据和向API发送数据。</li><li id="9400" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lz lk ll lm dt translated"><code class="eh ls lt lu lv b">browser_action</code>包含与顶栏图标和HTML文件相关的“默认图标”和“默认弹出”</li><li id="2e0e" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lz lk ll lm dt translated"><code class="eh ls lt lu lv b">content_scripts</code>这是一个重要的部分，它包含注入网站的脚本<br/> - <code class="eh ls lt lu lv b">matches: [*://*/*]</code>告诉浏览器将脚本注入任何协议【http，https，...]和任何域。</li><li id="2f47" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lz lk ll lm dt translated">- <code class="eh ls lt lu lv b">css</code>字段包含要注入的CSS样式表</li><li id="195f" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lz lk ll lm dt translated">- <code class="eh ls lt lu lv b">js</code>字段包含要注入的JavaScript文件</li><li id="8a9f" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lz lk ll lm dt translated">- <code class="eh ls lt lu lv b">all_frames</code>为真，告知将脚本注入所有框架，如“iframe”标签。重要的是让扩展在任何地方都能工作</li><li id="f8a0" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lz lk ll lm dt translated"><code class="eh ls lt lu lv b">background</code>包括后台脚本，用于管理向Cosmic JS发送数据并检查授权</li></ul><p id="b44c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">js文件夹中的JavaScript文件是整个功能的所在。<code class="eh ls lt lu lv b">myscript.js</code>文件包含所有扩展的功能。<code class="eh ls lt lu lv b">contentscript.js</code>文件使用jquery和<code class="eh ls lt lu lv b">myscript.js</code>管理扩展功能匹配的网站。<code class="eh ls lt lu lv b">background.js</code> file定期调用授权函数，同时也向Cosmic bucket发送数据。</p><h1 id="77d0" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">结论</h1><p id="0401" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">API优先的内容管理系统的优势在于，你可以将你的应用集成到任何地方。因此，你的Cosmic JS Bucket可以驱动你的web应用、本地应用、浏览器扩展或者任何可以使用API的东西。如果您有任何问题，请通过<a class="ae ka" href="https://twitter.com/cosmic_js" rel="noopener ugc nofollow" target="_blank"> Twitter </a>联系我们，或者加入我们的<a class="ae ka" href="https://cosmicjs.com/community" rel="noopener ugc nofollow" target="_blank"> Slack </a>社区。</p><p id="e6d1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ka" href="https://cosmicjs.com/articles/how-to-build-a-chrome-extension-to-save-web-content-to-cosmic-js" rel="noopener ugc nofollow" target="_blank">本文原载于Cosmic JS </a>。</p></div></div>    
</body>
</html>