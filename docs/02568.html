<html>
<head>
<title>Running a scalable &amp; reliable GraphQL endpoint with Serverless</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨æ— æœåŠ¡å™¨è¿è¡Œå¯æ‰©å±•ä¸”å¯é çš„GraphQLç«¯ç‚¹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/running-a-scalable-reliable-graphql-endpoint-with-serverless-db16e42dc266?source=collection_archive---------6-----------------------#2018-03-22">https://medium.com/hackernoon/running-a-scalable-reliable-graphql-endpoint-with-serverless-db16e42dc266?source=collection_archive---------6-----------------------#2018-03-22</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="9d33" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">ç¬¬3éƒ¨åˆ†:AppSyncå‰ç«¯:AWSæ‰˜ç®¡çš„GraphQLæœåŠ¡</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/0d92436a2212f6ef911ea412db043f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E1KwFeH3ahexWaHVFIFuow.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">AWS AppSync architecture</figcaption></figure><blockquote class="jz ka kb"><p id="2126" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated"><strong class="kf hv">ç¬¬1éƒ¨åˆ†</strong> : <a class="ae kz" href="https://serverless.com/blog/running-scalable-reliable-graphql-endpoint-with-serverless/" rel="noopener ugc nofollow" target="_blank">ç®€ä»‹:å¸¦APIç½‘å…³çš„GraphQLç«¯ç‚¹+ AWS Lambda </a> <br/> <strong class="kf hv">ç¬¬2éƒ¨åˆ†</strong> : <a class="ae kz" href="https://hackernoon.com/running-a-scalable-reliable-graphql-endpoint-with-serverless-24c3bb5acb43" rel="noopener ugc nofollow" target="_blank"> AppSyncåç«¯:AWSæ‰˜ç®¡GraphQLæœåŠ¡</a> <br/> <strong class="kf hv">ç¬¬3éƒ¨åˆ†</strong> : AppSyncå‰ç«¯:AWSæ‰˜ç®¡GraphQLæœåŠ¡(æœ¬å¸–)<br/> <strong class="kf hv">ç¬¬4éƒ¨åˆ†</strong> : <a class="ae kz" href="https://hackernoon.com/serverless-appsync-plugin-top-10-new-features-3faaf6789480" rel="noopener ugc nofollow" target="_blank">æ— æœåŠ¡å™¨AppSyncæ’ä»¶:æ–°ç‰¹æ€§</a>(æœ€æ–°ï¼ï¼ï¼)</p></blockquote><blockquote class="la"><p id="63ab" class="lb lc hu bd ld le lf lg lh li lj ky ek translated"><em class="lk"> " </em> AWS AppSyncæ˜¯ä¸€ä¸ªå®Œå…¨æ‰˜ç®¡çš„æ— æœåŠ¡å™¨GraphQLæœåŠ¡ï¼Œæä¾›å®æ—¶æ•°æ®æŸ¥è¯¢ã€åŒæ­¥ã€é€šä¿¡å’Œç¦»çº¿ç¼–ç¨‹åŠŸèƒ½ã€‚<em class="lk">â€â€”ç¬¬äºŒéƒ¨åˆ†</em></p></blockquote><h1 id="29af" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja lw jb lx jd ly je lz jg ma jh mb mc dt translated">ä»‹ç»</h1><p id="7a42" class="pw-post-body-paragraph kc kd hu kf b kg md iv ki kj me iy kl mf mg ko kp mh mi ks kt mj mk kw kx ky hn dt translated">åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨<strong class="kf hv"> ReactJS </strong>å’Œ<strong class="kf hv"> AWS AppSync </strong>æ„å»ºè¿·ä½ Twitteråº”ç”¨çš„å®¢æˆ·ç«¯ç»„ä»¶ã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘å°†é‡ç‚¹ä»‹ç»:</p><ul class=""><li id="a98f" class="ml mm hu kf b kg kh kj kk mf mn mh mo mj mp ky mq mr ms mt dt translated"><em class="ke">é€šè¿‡AWS Amplifyè¿›è¡Œç”¨æˆ·è®¤è¯</em>ã€‚</li><li id="d682" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><em class="ke">è¿·ä½ æ¨ç‰¹åº”ç”¨ç»„ä»¶</em>ã€‚</li><li id="b8c3" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><em class="ke"> GraphQLè®¢é˜…</em>ã€‚</li><li id="7d24" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><em class="ke"> GraphQLçªå˜ä¸</em> <em class="ke">ä¹è§‚UIå’Œç¦»çº¿æ”¯æŒã€‚</em></li><li id="f47a" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><em class="ke">ä½¿ç”¨Netlifyå’ŒS3çš„æ— æœåŠ¡å™¨å®¢æˆ·ç«¯éƒ¨ç½²</em><em class="ke"/>ã€‚</li></ul><p id="f4ea" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">æˆ‘ä»¬å¼€å§‹å§ï¼ğŸƒ</p><blockquote class="jz ka kb"><p id="7fdf" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated"><strong class="kf hv">æ³¨1: </strong>åœ¨<a class="ae kz" href="https://hackernoon.com/running-a-scalable-reliable-graphql-endpoint-with-serverless-24c3bb5acb43" rel="noopener ugc nofollow" target="_blank">ç¬¬äºŒéƒ¨åˆ†</a>ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨AWS AppSyncã€DynamoDBã€ElasticSearchå’ŒAWS Lambdaåˆ›å»ºäº†è¿·ä½ Twitteråº”ç”¨çš„åç«¯GraphQL APIã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨æ–°çš„<a class="ae kz" href="https://github.com/sid88in/serverless-appsync-plugin" rel="noopener ugc nofollow" target="_blank">server less-app sync-plugin</a>éƒ¨ç½²äº†APIã€‚</p><p id="c30d" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated"><strong class="kf hv">æ³¨2: </strong>æ‚¨å¯ä»¥ä½¿ç”¨<code class="eh mz na nb nc b">yarn start.</code>åœ¨<a class="ae kz" href="https://github.com/serverless/serverless-graphql/blob/master/app-client/appsync-client/src/App.js" rel="noopener ugc nofollow" target="_blank"> serverless-graphql </a>å­˜å‚¨åº“ä¸­å¿«é€Ÿå¼€å§‹ä½¿ç”¨æ­¤åº”ç”¨ç¨‹åºï¼Œè¯·ç¡®ä¿é…ç½®è®¾ç½®æ­£ç¡®ã€‚</p><p id="fdb3" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated"><strong class="kf hv">æ³¨3: </strong> AppSyncå®¢æˆ·ç«¯ä¹Ÿæœ‰é’ˆå¯¹åŸç”ŸiOSã€webå’ŒReact Nativeçš„SDKï¼Œä½†åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<a class="ae kz" href="https://github.com/awslabs/aws-mobile-appsync-sdk-js" rel="noopener ugc nofollow" target="_blank"> JS SDK </a>æ„å»ºReact JSåº”ç”¨ã€‚</p></blockquote><h1 id="363f" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja nd jb lx jd ne je lz jg nf jh mb mc dt translated">AppSyncå®¢æˆ·ç«¯+ AWSæ”¾å¤§å™¨</h1><p id="e7d8" class="pw-post-body-paragraph kc kd hu kf b kg md iv ki kj me iy kl mf mg ko kp mh mi ks kt mj mk kw kx ky hn dt translated"><a class="ae kz" href="https://hackernoon.com/tagged/appsync" rel="noopener ugc nofollow" target="_blank"> AppSync </a>å®¢æˆ·ç«¯ä½¿ç”¨<a class="ae kz" href="https://dev-blog.apollodata.com/aws-appsync-powered-by-apollo-df61eb706183" rel="noopener ugc nofollow" target="_blank"> Apollo Client 2.0 </a>åœ¨å¹•åç®€åŒ–ç”¨æˆ·è®¤è¯ï¼Œç®¡ç†ç¦»çº¿é€»è¾‘ï¼Œæ”¯æŒ<a class="ae kz" href="https://hackernoon.com/tagged/real-time" rel="noopener ugc nofollow" target="_blank">å®æ—¶</a>è®¢é˜…ã€‚</p><p id="efed" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">å¦ä¸€æ–¹é¢ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¸¦æœ‰<a class="ae kz" href="https://github.com/aws/aws-amplify" rel="noopener ugc nofollow" target="_blank"> AWS Amplify </a>çš„AppSyncå®¢æˆ·ç«¯æ¥ç®€åŒ–åº”ç”¨ç¨‹åºä¸­çš„ç”¨æˆ·è®¤è¯å·¥ä½œæµğŸ”‘ã€‚AppSyncä½¿ç”¨APIå¯†é’¥ã€Cognitoç”¨æˆ·æ± æˆ–AWS IAMç­–ç•¥æä¾›èº«ä»½éªŒè¯ï¼ŒAWS Amplifyä½¿ç”¨<a class="ae kz" href="https://aws.github.io/aws-amplify/api/classes/authclass.html" rel="noopener ugc nofollow" target="_blank"> Auth Class </a>ä¸­æä¾›çš„æ–¹æ³•å¯¹<em class="ke">ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€å¯†ç ç¡®è®¤å’Œæ³¨é”€è¿›è¡Œè¡¥å……ã€‚</em></p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="1c94" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">import </strong>Amplify, { Auth } <strong class="nc hv">from 'aws-amplify'</strong>;<br/><strong class="nc hv">import </strong>{ <em class="ke">withAuthenticator </em>} <strong class="nc hv">from 'aws-amplify-react/dist/Auth'</strong>;<br/><strong class="nc hv">import </strong>AWSAppSyncClient <strong class="nc hv">from 'aws-appsync'</strong>;<br/><strong class="nc hv">import </strong>{ ApolloProvider } <strong class="nc hv">from 'react-apollo'</strong>;</span><span id="0f96" class="nk lm hu nc b fv np nm l nn no"><strong class="nc hv">const </strong>client = <strong class="nc hv">new </strong>AWSAppSyncClient({<br/>  <strong class="nc hv">url</strong>: 'https://xxxx.appsync-api.us-east-1.amazonaws.com/graphql',<br/>  <strong class="nc hv">region</strong>: 'us-east-1',<br/>  <strong class="nc hv">auth</strong>: {</span><span id="d199" class="nk lm hu nc b fv np nm l nn no">    // AWS Cognito User Pool<br/>    <strong class="nc hv">type</strong>: <strong class="nc hv">AUTH_TYPE</strong>.<strong class="nc hv">AMAZON_COGNITO_USER_POOLS</strong>,<br/>    jwtToken: <strong class="nc hv">async </strong>() =&gt;<br/>      (<strong class="nc hv">await </strong>Auth.currentSession()).getIdToken().getJwtToken(),<br/>    <br/>    // API KEY<br/>    <strong class="nc hv">type</strong>: <strong class="nc hv">AUTH_TYPE</strong>.<strong class="nc hv">API_KEY</strong>,<br/>    apiKey: 'xxxxxxxxxxxxx',</span><span id="9cc7" class="nk lm hu nc b fv np nm l nn no">    // AWS IAM<br/>    <strong class="nc hv">type: AUTH_TYPE.AWS_IAM</strong><br/>    credentials: () =&gt; Auth.currentCredentials(),</span><span id="46d3" class="nk lm hu nc b fv np nm l nn no">   },<br/>});</span><span id="bafa" class="nk lm hu nc b fv np nm l nn no"><strong class="nc hv">const </strong><em class="ke">WithProvider </em>= () =&gt; (<br/>  &lt;<strong class="nc hv">Router</strong>&gt;<br/>    &lt;<strong class="nc hv">ApolloProvider client=</strong>{client}&gt;<br/>  &lt;/<strong class="nc hv">Router</strong>&gt;<br/>);</span><span id="88d4" class="nk lm hu nc b fv np nm l nn no"><strong class="nc hv">export default </strong><em class="ke">withAuthenticator</em>(<em class="ke">WithProvider</em>);</span></pre><p id="59c1" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">å¦‚ä¸Šé¢çš„<code class="eh mz na nb nc b">App.js</code>ä»£ç æ‰€ç¤ºï¼Œå‘åº”ç”¨ç¨‹åºæ·»åŠ èº«ä»½éªŒè¯å°±åƒç”¨<code class="eh mz na nb nc b">withAuthenticator</code>é«˜é˜¶ç»„ä»¶åŒ…è£…åº”ç”¨ç¨‹åºçš„ä¸»ç»„ä»¶ä¸€æ ·ç®€å•ã€‚æ‚¨å¯ä»¥ä½¿ç”¨AWSçš„<code class="eh mz na nb nc b"><em class="ke">aws-appsync-react</em></code>å’Œ<code class="eh mz na nb nc b"><em class="ke">aws-amplify-react</em></code> <em class="ke"> </em>åŒ…è¿›è¡Œæ‰€æœ‰è¿™äº›é›†æˆã€‚</p><blockquote class="jz ka kb"><p id="c52e" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated"><strong class="kf hv">æ³¨æ„:</strong>å¯¹äºè¿™ä¸ªæ¼”ç¤ºï¼Œæˆ‘ä½¿ç”¨AWS Cognitoç”¨æˆ·æ± è¿›è¡Œç”¨æˆ·è®¤è¯ï¼Œå¹¶åœ¨Cognitoä¸­åˆ›å»ºäº†ä¸¤ä¸ªæµ‹è¯•ç”¨æˆ·(sidg_sidå’Œnikgraf)ã€‚ä¸€æ—¦ç”¨æˆ·ç™»å½•ï¼Œä»–ä»¬çš„ä¼šè¯å°±ä¼šè¢«Amplifyä¿å­˜åœ¨<code class="eh mz na nb nc b">localStorage</code>ä¸­ã€‚æ‰€ä»¥ç”¨æˆ·å¯ä»¥ç¦»å¼€é¡µé¢ï¼Œå›æ¥ï¼Œä»ç„¶ç™»å½•ï¼ä½ å¯ä»¥åœ¨<a class="nq nr gr" href="https://medium.com/u/695782484bda?source=post_page-----db16e42dc266--------------------------------" rel="noopener" target="_blank"> Nader Dabit </a>çš„<a class="ae kz" href="https://hackernoon.com/react-authentication-in-depth-4deebda9aa45" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªå¸–å­</a>ä¸­æ‰¾åˆ°æ›´å¤šç»†èŠ‚ã€‚</p></blockquote><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff ns"><img src="../Images/793f9493f255cfa062abb751799963fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*RAaDClm7sIgqNfLkNoq6Sg.gif"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">User Authentication with AWS AppSync + AWS Amplify + AWS Cognito</figcaption></figure><h1 id="731b" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja nd jb lx jd ne je lz jg nf jh mb mc dt translated">è¿·ä½ Twitteråº”ç”¨ç»„ä»¶</h1><p id="9693" class="pw-post-body-paragraph kc kd hu kf b kg md iv ki kj me iy kl mf mg ko kp mh mi ks kt mj mk kw kx ky hn dt translated">ç°åœ¨ï¼Œæ¿€åŠ¨äººå¿ƒçš„äº‹æƒ…å¼€å§‹äº†ï¼ğŸ’ƒ</p><p id="b495" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">è¿™ä¸ªåº”ç”¨çš„åŸºæœ¬ç»“æ„æ˜¯ä½¿ç”¨<code class="eh mz na nb nc b"><a class="ae kz" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank">create-react-app</a></code>åˆ›å»ºçš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨<code class="eh mz na nb nc b"><a class="ae kz" href="https://github.com/styled-components/styled-components" rel="noopener ugc nofollow" target="_blank">styled-components</a></code>ä½¿æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçœ‹èµ·æ¥å¾ˆèŠ±å“¨ğŸ’…ä¸‹é¢ç»™å‡ºäº†è¯¥åº”ç”¨ç¨‹åºçš„äº”ä¸ªä¸»è¦ç»„ä»¶ã€‚</p><ul class=""><li id="b693" class="ml mm hu kf b kg kh kj kk mf mn mh mo mj mp ky mq mr ms mt dt translated"><strong class="kf hv"> <em class="ke"> UserLogin </em> </strong>:ç”¨æˆ·å¯ä»¥ä»æœ¬App <em class="ke">(ä¸Šä¸€èŠ‚)ç™»å½•æˆ–æ³¨é”€ã€‚</em></li><li id="0bc1" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><strong class="kf hv"> <em class="ke"> ProfileInfo </em> </strong>:ä»DynamoDBä¸­æ£€ç´¢ç”¨æˆ·åŸºæœ¬èµ„æ–™ä¿¡æ¯ã€‚</li><li id="97ba" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><strong class="kf hv"><em class="ke">profile Tweets</em></strong>:ä»ElasticSearchæ£€ç´¢tweetsåˆ—è¡¨ã€‚</li><li id="8c6b" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><strong class="kf hv"> <em class="ke"> TweetForm </em> </strong>:ç”¨æˆ·å¯ä»¥å‘é€æ¨æ–‡ã€‚</li><li id="85ed" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><strong class="kf hv"> <em class="ke"> TweetSearch </em> </strong>:ç”¨æˆ·å¯ä»¥é€šè¿‡å…³é”®è¯æœç´¢æ‰€æœ‰tweetsçš„è¯­æ–™åº“ã€‚</li></ul><p id="6e29" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">ä¸ºäº†ä½¿è¿™ä¸€åˆ‡æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬åˆ©ç”¨äº†ç‰¹å®šçš„GraphQLæ“ä½œ:</p><ul class=""><li id="0354" class="ml mm hu kf b kg kh kj kk mf mn mh mo mj mp ky mq mr ms mt dt translated"><strong class="kf hv"> <em class="ke">æŸ¥è¯¢</em> </strong> â€”è·å–ç»™å®šç”¨æˆ·çš„ä¸ªäººèµ„æ–™ä¿¡æ¯å’Œæ¨æ–‡åˆ—è¡¨ã€‚</li><li id="370e" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><strong class="kf hv"> <em class="ke">çªå˜</em> </strong> â€”ä¸ºç»™å®šç”¨æˆ·åˆ›å»ºå’Œåˆ é™¤æ¨æ–‡ã€‚</li><li id="618f" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky mq mr ms mt dt translated"><strong class="kf hv"> <em class="ke">è®¢é˜…</em> </strong> â€”ç»™å®šç”¨æˆ·çš„å…³æ³¨è€…å¯ä»¥çœ‹åˆ°ä»–çš„æ–°æ¨æ–‡ã€‚</li></ul><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nt"><img src="../Images/2317cb665c8489473d86c240ff775cb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OUw1OiqWxksfgBHoikup7g.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Various Components of mini Twitter App</figcaption></figure><h1 id="a2a5" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja nd jb lx jd ne je lz jg nf jh mb mc dt translated">ä¸ªäººèµ„æ–™ä¿¡æ¯ç»„ä»¶:</h1><p id="9a7c" class="pw-post-body-paragraph kc kd hu kf b kg md iv ki kj me iy kl mf mg ko kp mh mi ks kt mj mk kw kx ky hn dt translated">åœ¨æœ¬èŠ‚ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨<code class="eh mz na nb nc b">react-apollo</code>ä¸­çš„<code class="eh mz na nb nc b">ProfileInfoQuery</code>ã€<code class="eh mz na nb nc b">graphql</code>è¿æ¥è¯¥ç»„ä»¶ã€‚</p><p id="5727" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">è¿™ä¸ªåº”ç”¨ç¨‹åºçš„GraphQLæ¨¡å¼å®šä¹‰äº†<code class="eh mz na nb nc b">getUserInfo</code>ã€‚ä¸‹é¢ç»™å‡ºçš„æŸ¥è¯¢çš„è§£æå™¨ä¸ºç»™å®šçš„ç”¨æˆ·<em class="ke">å¥æŸ„ä»DynamoDBè·å–æ•°æ®ã€‚</em></p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="acd7" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">export const </strong>ProfileInfoQuery = gql<strong class="nc hv">`<br/>  query </strong>ProfileInfoQuery(<strong class="nc hv">$handle: String!) {<br/>    getUserInfo(handle: $handle) {<br/>      name<br/>      location<br/>      description<br/>      following<br/>     }<br/>  }<br/>`</strong>;</span></pre><p id="59ce" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated"><em class="ke">å¥æŸ„</em>çš„å€¼æ˜¯ä»JWTä»¤ç‰Œä¸­è§£æå‡ºæ¥çš„ï¼Œå¯ä»¥åœ¨<code class="eh mz na nb nc b">context.identity.username</code>ä¸­è·å¾—ï¼Œæˆ–è€…å¯ä»¥ä½œä¸ºè¾“å…¥<code class="eh mz na nb nc b">context.arguments.handle</code>æä¾›ã€‚ä¸Šé¢çš„æŸ¥è¯¢æ˜¯ä½¿ç”¨AppSyncåç«¯ä¸­çš„ä»¥ä¸‹æ˜ å°„æ¨¡æ¿è§£å†³çš„ã€‚</p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="c1d3" class="nk lm hu nc b fv nl nm l nn no">{<br/>    "version" : "2017-02-28",<br/>    "operation" : "<strong class="nc hv">Query</strong>",<br/>    "query" : {<br/>        "expression": "<strong class="nc hv">handle</strong> = <strong class="nc hv">:handle</strong>",<br/>        "expressionValues" : {<br/>            ":handle" : {<br/>                "S" : "${<strong class="nc hv">context.identity.username</strong>}"<br/>            }<br/>        }<br/>    }<br/>}</span></pre><p id="494c" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated"><code class="eh mz na nb nc b">ProfileInfoComponent</code>ç»“å°¾æ˜¯:</p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="d3c2" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">import </strong>React <strong class="nc hv">from 'react'</strong>;<br/><strong class="nc hv">import </strong>{ <em class="ke">graphql </em>} <strong class="nc hv">from 'react-apollo'</strong>;<br/><strong class="nc hv">import </strong>{ ProfileInfoQuery } <strong class="nc hv">from '../queries'</strong>;</span><span id="8088" class="nk lm hu nc b fv np nm l nn no"><strong class="nc hv">const </strong><em class="ke">ProfileInfo </em>= ({ data: { loading, <strong class="nc hv">getUserInfo</strong> }}) =&gt; {<br/>  <strong class="nc hv">if </strong>(loading) { <strong class="nc hv">return </strong>( &lt;<strong class="nc hv">p</strong>&gt;Loading ...&lt;/<strong class="nc hv">p</strong>&gt; ); }</span><span id="24af" class="nk lm hu nc b fv np nm l nn no"><strong class="nc hv">  return </strong>( &lt;d<strong class="nc hv">iv</strong>&gt; &lt;<strong class="nc hv">h4</strong>&gt; {<strong class="nc hv">getUserInfo</strong>.<strong class="nc hv">name</strong>} &lt;/<strong class="nc hv">h4</strong>&gt; &lt;/d<strong class="nc hv">iv</strong>&gt; );<br/>};</span><span id="9d72" class="nk lm hu nc b fv np nm l nn no"><strong class="nc hv">export default </strong><em class="ke">graphql</em>(ProfileInfoQuery, {<br/>  options: props =&gt; ({<br/>    <strong class="nc hv">variables</strong>: {<br/>      <strong class="nc hv">handle</strong>: props.<strong class="nc hv">handle</strong>,<br/>    },<br/>  }),<br/>})(<strong class="nc hv"><em class="ke">ProfileInfo</em></strong>);</span></pre><blockquote class="jz ka kb"><p id="52f2" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated"><strong class="kf hv">æ³¨</strong>:è¿·ä½ Twitteråº”ç”¨çš„GraphQLæ¨¡å¼å’Œè§£æå™¨åœ¨<a class="ae kz" href="https://hackernoon.com/running-a-scalable-reliable-graphql-endpoint-with-serverless-24c3bb5acb43" rel="noopener ugc nofollow" target="_blank">ç¬¬2éƒ¨åˆ†</a>ä¸­æœ‰è§£é‡Šã€‚</p></blockquote><h1 id="236d" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja nd jb lx jd ne je lz jg nf jh mb mc dt translated">ä¸ªäººèµ„æ–™æ¨æ–‡ç»„ä»¶:</h1><p id="83a1" class="pw-post-body-paragraph kc kd hu kf b kg md iv ki kj me iy kl mf mg ko kp mh mi ks kt mj mk kw kx ky hn dt translated">è¯¥ç»„ä»¶çš„æ•°æ®ä¹Ÿä»AppSyncæ¨¡å¼ä¸­å®šä¹‰çš„<code class="eh mz na nb nc b">getUserInfo</code>ä¸­æ£€ç´¢ã€‚è¯¥æŸ¥è¯¢çš„è§£æå™¨ç‚¹å‡»ElasticSearch tweetç´¢å¼•ï¼Œå¹¶é€šè¿‡<em class="ke">å¥æŸ„æ£€ç´¢tweetã€‚</em></p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="4abe" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">export const </strong>ProfileTweetsQuery = gql<strong class="nc hv">`<br/>  query </strong>ProfileTweetsQuery<strong class="nc hv"> {<br/>    getUserInfo {<br/>      tweets(limit: 10) {<br/>        items {<br/>          tweet<br/>          tweet_id<br/>        } <br/>        nextToken<br/>      }<br/>    }<br/>  }<br/>`</strong>;</span></pre><h1 id="a945" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja nd jb lx jd ne je lz jg nf jh mb mc dt translated">ä¹è§‚çš„å›åº”å’Œçº¿ä¸‹çš„æ”¯æŒ</h1><p id="3013" class="pw-post-body-paragraph kc kd hu kf b kg md iv ki kj me iy kl mf mg ko kp mh mi ks kt mj mk kw kx ky hn dt translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬æƒ³è±¡ä»¥ä¸‹åœºæ™¯:</p><blockquote class="jz ka kb"><p id="38c7" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated">åœºæ™¯:åœ¨æ¼«é•¿çš„ä¸€å¤©å·¥ä½œåï¼Œä½ æ­£å‡†å¤‡å›å®¶ã€‚ä½ ä¹˜ç«è½¦ä»Aç«™åˆ°bç«™ã€‚ç°åœ¨ï¼Œä½ è¿˜åœ¨æ¨ç‰¹ä¸Šå‘è¡¨ä½ å¯¹ä½ æœ€æ„Ÿå…´è¶£çš„è¯é¢˜çš„æƒ³æ³•ï¼Œä½†çªç„¶ç«è½¦ç©¿è¿‡éš§é“ï¼Œç°åœ¨ä½ é‡åˆ°äº†ç½‘ç»œè¿æ¥é—®é¢˜ã€‚ä½ çš„åº”ç”¨ç¨‹åºå°†å¦‚ä½•å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Ÿ</p></blockquote><p id="9d96" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">åœ¨è¿™ç§å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·ä¼šæœŸæœ›åº”ç”¨ç¨‹åºæ­£å¸¸è¿è¡Œ(å“¦è€¶ï¼ç”¨æˆ·æœŸæœ›å¾ˆé«˜ğŸ˜‰ç‚¹å‡»åˆ é™¤åº”ç”¨ç¨‹åºæŒ‰é’®å¹¶ä¸ä¼šèŠ±è´¹ä»–ä»¬å¤ªå¤šæ—¶é—´ğŸ’).è¿™å°±æ˜¯<strong class="kf hv"> <em class="ke">ä¹è§‚å“åº”</em> </strong>å’Œ<strong class="kf hv"> <em class="ke">ç¦»çº¿æ”¯æŒ</em> </strong> <em class="ke"> </em>åœ¨åç«¯ä¸å¯è¾¾æ—¶å‰æ¥æ•‘æ´çš„åœ°æ–¹ã€‚</p><p id="b8d0" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªç»„ä»¶ï¼Œ<strong class="kf hv"> TweetForm </strong>å¤„ç†ä¸Šé¢è§£é‡Šçš„åœºæ™¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<em class="ke"> create tweet mutation </em>å°†ä¸€æ¡tweetè®°å½•æ”¾å…¥ElasticSearchç´¢å¼•ä¸­ã€‚</p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="5aef" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">export const </strong>AddTweetMutation = gql<strong class="nc hv">`<br/>  mutation AddTweetMutation(<br/>    $tweet: String!<br/>  ) {<br/>    createTweet(<br/>      tweet: $tweet<br/>    ) {<br/>      tweet_id<br/>      tweet<br/>    }<br/>  }<br/>`</strong>;</span></pre><p id="2554" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„ç»„ä»¶ä¸­å¢åŠ ä¸¤ä¸ªåŠŸèƒ½ï¼Œåœ¨è¿™ç¯‡æ–‡ç« çš„<a class="ae kz" href="https://code.tutsplus.com/tutorials/code-an-app-with-graphql-react-native-and-aws-appsync-the-app--cms-30569" rel="noopener ugc nofollow" target="_blank">ä¸­ä¹Ÿæœ‰è§£é‡Šã€‚</a></p><ol class=""><li id="c5cd" class="ml mm hu kf b kg kh kj kk mf mn mh mo mj mp ky nu mr ms mt dt translated"><code class="eh mz na nb nc b">optimisticResponse</code>å®šä¹‰æ‚¨å¸Œæœ›åœ¨æ›´æ–°åŠŸèƒ½ä¸­å¯ç”¨çš„æ–°å“åº”ã€‚</li><li id="0494" class="ml mm hu kf b kg mu kj mv mf mw mh mx mj my ky nu mr ms mt dt translated"><code class="eh mz na nb nc b">update</code>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä»£ç†(å…è®¸æ‚¨ä»ç¼“å­˜ä¸­è¯»å–)å’Œæ‚¨æƒ³è¦ç”¨æ¥è¿›è¡Œæ›´æ–°çš„æ•°æ®ã€‚æˆ‘ä»¬è¯»å–å½“å‰ç¼“å­˜(<code class="eh mz na nb nc b">proxy.readQuery</code>)ï¼Œå°†å®ƒä½œä¸ºæˆ‘ä»¬çš„æ–°æ¡ç›®æ·»åŠ åˆ°æ¡ç›®æ•°ç»„ä¸­ï¼Œç„¶åå†™å›ç¼“å­˜ï¼Œè¿™æ›´æ–°äº†æˆ‘ä»¬çš„UIã€‚</li></ol><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="37b0" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">export default </strong><em class="ke">graphql</em>(AddTweetMutation, {<br/>  props: ({ mutate }) =&gt; ({<br/>    addTweet: tweet =&gt; {<br/>      <strong class="nc hv">return </strong>mutate({<br/>        <strong class="nc hv">variables</strong>: {<br/>          tweet,<br/>        },<br/>        optimisticResponse: () =&gt; ({<br/>          <strong class="nc hv">createTweet</strong>: {<br/>            tweet,<br/>            <strong class="nc hv">tweet_id</strong>: uuid(),<br/>            <strong class="nc hv">__typename</strong>: <strong class="nc hv">'Tweet'</strong>,<br/>          },<br/>        }),<br/>        update: (proxy, { data: { createTweet } }) =&gt; {<br/>          <strong class="nc hv">const </strong>data = proxy.readQuery({<br/>            <strong class="nc hv">query</strong>: ProfileTweetsQuery,<br/>            <strong class="nc hv">variables</strong>: {<br/>              tweet,<br/>            },<br/>          });<br/>          data.<strong class="nc hv">meInfo</strong>.<strong class="nc hv">tweets</strong>.<strong class="nc hv">items</strong>.push(createTweet);<br/>          proxy.writeQuery({<br/>            <strong class="nc hv">query</strong>: ProfileTweetsQuery,<br/>            data,<br/>            <strong class="nc hv">variables</strong>: {<br/>              tweet,<br/>            },<br/>          });<br/>        },<br/>      });<br/>    },<br/>  }),<br/>})(TweetFormComponent);</span></pre><blockquote class="la"><p id="cda1" class="lb lc hu bd ld le lf lg lh li lj ky ek translated">å’Œ..å˜£ï¼ä½ å¯ä»¥äº²çœ¼ç›®ç¹è¿™ç§é­”åŠ›ğŸ‘“</p></blockquote><figure class="nw nx ny nz oa jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nv"><img src="../Images/19d91b879ddd2e257062a72ac9c5b75b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LkypTlddKOJvl_c-BL9Gfg.gif"/></div></div></figure><h1 id="91a6" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja nd jb lx jd ne je lz jg nf jh mb mc dt translated">è®©æˆ‘ä»¬çœ‹çœ‹æ‰€æœ‰è¿™äº›å®æ—¶çš„ä¸œè¥¿æ˜¯å¦‚ä½•å·¥ä½œçš„:</h1><blockquote class="la"><p id="2352" class="lb lc hu bd ld le ob oc od oe of ky ek translated">æœ€ç²¾å½©çš„éƒ¨åˆ†ï¼Ÿè¦è®©è®¢é˜…åœ¨åç«¯å·¥ä½œï¼Œæ‚¨åªéœ€ç”¨4è¡Œä»£ç æ‰©å±•æ‚¨çš„GraphQLæ¨¡å¼:</p></blockquote><pre class="nw nx ny nz oa ng nc nh ni aw nj dt"><span id="5731" class="nk lm hu nc b fv nl nm l nn no">type Subscription {<br/>  addTweet: Tweet<br/>  @aws_subscribe(mutations: [â€œcreateTweetâ€]<br/>}</span></pre><blockquote class="jz ka kb"><p id="e945" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated">åœºæ™¯:å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªç”¨æˆ·(sidg_sidå’Œnikgraf)äº’ç›¸å…³æ³¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªç”¨æˆ·éƒ½è®¢é˜…äº†å¯¹æ–¹çš„æ¨æ–‡ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œå½“ç”¨æˆ·sidg_sidå‘é€ä¸€æ¡æ¨æ–‡æ—¶ï¼Œå®ƒä¼šç«‹å³è¢«æ¨é€ç»™åŒ…æ‹¬nikgrafåœ¨å†…çš„æ‰€æœ‰å…³æ³¨è€…ï¼Œåä¹‹äº¦ç„¶ã€‚</p></blockquote><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nv"><img src="../Images/7f2f60739bc8a5818b7969286111ce29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*cuts_Q1frrZYovPjNUuX0w.gif"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Real Time Subscriptions</figcaption></figure><p id="7fcc" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">AWS AppSyncä¸­çš„è®¢é˜…è¢«è°ƒç”¨ä½œä¸ºå¯¹çªå˜çš„å“åº”ã€‚æ­¤å¤–ï¼Œå®ƒä»¬ç”±AWS AppSyncå®¢æˆ·ç«¯SDKè‡ªåŠ¨å¤„ç†ï¼Œä½¿ç”¨MQTT over Websocketsä½œä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ä¹‹é—´çš„ç½‘ç»œåè®®ã€‚æ¯æ¬¡æ·»åŠ æ–°çš„tweetæ—¶ï¼Œéƒ½ä¼šè°ƒç”¨ä¸‹é¢çš„è®¢é˜…ã€‚</p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="82c7" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">export const </strong>AddTweetSubscription = gql<strong class="nc hv">`<br/>  subscription AddTweetSubscription {<br/>    addTweet {<br/>      __typename<br/>      tweet_id<br/>      tweet<br/>    }<br/>  }<br/>`</strong>;<br/><br/><strong class="nc hv">export default </strong>{<br/>  AddTweetSubscription,<br/>};</span></pre><p id="c445" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">æˆ‘ä»¬ç°åœ¨é€šè¿‡ä½¿ç”¨<code class="eh mz na nb nc b">AddTweetSubscription</code>å’Œç”¨æˆ·<code class="eh mz na nb nc b">handle</code>è°ƒç”¨<code class="eh mz na nb nc b">subscribeToMore</code>å‡½æ•°ï¼Œå°†è¯¥è®¢é˜…æ·»åŠ åˆ°<em class="ke">ä¸ªäººèµ„æ–™æ¨æ–‡ç»„ä»¶</em>ã€‚<code class="eh mz na nb nc b">updateQuery</code>åœ¨ç»™å®šç”¨æˆ·ä¹‹å‰çš„æ¨æ–‡ä¸­æ·»åŠ ä¸€æ¡æ–°æ¨æ–‡ã€‚</p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="55ba" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">const </strong>tweetsQuery = <em class="ke">graphql</em>(ProfileTweetsQuery, {<br/>  options: props =&gt; ({<br/>    <strong class="nc hv">variables</strong>: { ...variables, <strong class="nc hv">handle</strong>: props.<strong class="nc hv">handle </strong>},<br/>    <strong class="nc hv">fetchPolicy</strong>: <strong class="nc hv">'cache-and-network'</strong>,<br/>  }),<br/>  props: props =&gt; ({<br/>    ...props,<br/>    subscribeToNewTweets: params =&gt;<br/>      props.<strong class="nc hv">data</strong>.subscribeToMore({<br/>        <strong class="nc hv">document</strong>: AddTweetSubscription,<br/>        <strong class="nc hv">variables</strong>: params,<br/>        updateQuery: (prev, { subscriptionData: { data: { addTweet } } }) =&gt; {<br/>          <strong class="nc hv">return </strong>{<br/>            ...prev,<br/>            <strong class="nc hv">getUserInfo</strong>: {<br/>              ...prev.<strong class="nc hv">getUserInfo</strong>,<br/>              <strong class="nc hv">tweets</strong>: {<br/>                <strong class="nc hv">items</strong>: [addTweet, ...prev.<strong class="nc hv">getUserInfo</strong>.<strong class="nc hv">tweets</strong>.<strong class="nc hv">items</strong>],<br/>              },<br/>            },<br/>          };<br/>        },<br/>      }),<br/>  }),<br/>});<br/><br/><strong class="nc hv">export default </strong>compose(tweetsQuery)(ProfileTweetsComponent);</span></pre><h1 id="07d4" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja nd jb lx jd ne je lz jg nf jh mb mc dt translated">æœç´¢æ‰€æœ‰æ¨æ–‡ç»„ä»¶</h1><p id="3eb4" class="pw-post-body-paragraph kc kd hu kf b kg md iv ki kj me iy kl mf mg ko kp mh mi ks kt mj mk kw kx ky hn dt translated">æœ€åä½†å¹¶éæœ€ä¸é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œç”¨æˆ·è¿˜å¯ä»¥é€šè¿‡å…³é”®è¯æœç´¢æ¨æ–‡è¯­æ–™åº“ã€‚è¯¥æŸ¥è¯¢çš„è§£æå™¨æ˜ å°„åˆ°åç«¯çš„ElasticSearchæŸ¥è¯¢ã€‚</p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="9d6f" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">export const </strong>SearchTweetsQuery = gql<strong class="nc hv">`<br/>  query UserQuery($keyword: String!) {<br/>    searchAllTweetsByKeyword(keyword: $keyword) {<br/>      items {<br/>        tweet<br/>        tweet_id<br/>      }<br/>    }<br/>  }<br/>`</strong>;</span></pre><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff og"><img src="../Images/8bd11eb2bf3124abcdfafdf794120fc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2rMuWsmEIjq8FD9TxHJB1w.gif"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">ElasticSearch Query</figcaption></figure><p id="a981" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated"><code class="eh mz na nb nc b">SearchTweetsComponent</code>ç»“å°¾æ˜¯:</p><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="ed0b" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">import </strong>React <strong class="nc hv">from 'react'</strong>;<br/><strong class="nc hv">import </strong>{ <em class="ke">graphql </em>} <strong class="nc hv">from 'react-apollo'</strong>;<br/><strong class="nc hv">import </strong>{ SearchTweetsQuery } <strong class="nc hv">from '../queries'</strong>;</span><span id="cd33" class="nk lm hu nc b fv np nm l nn no"><strong class="nc hv">const </strong>Search<em class="ke"> </em>= ({ data: { loading, searchAllTweetsByKeyword }}) =&gt; {<br/>  <strong class="nc hv">if </strong>(loading) { <strong class="nc hv">return </strong>( &lt;<strong class="nc hv">p</strong>&gt;Loading ...&lt;/<strong class="nc hv">p</strong>&gt; ); }</span><span id="ccbf" class="nk lm hu nc b fv np nm l nn no"><strong class="nc hv">return </strong>(<br/>  &lt;<strong class="nc hv">Container</strong>&gt;<br/>    {searchAllTweetsByKeyword.<strong class="nc hv">items</strong>.map((item, index) =&gt; (<br/>      &lt;<strong class="nc hv">Tweet key=</strong>{index}&gt;{item.tweet}&lt;/<strong class="nc hv">Tweet</strong>&gt;<br/>    ))}<br/>  &lt;/<strong class="nc hv">Container</strong>&gt;<br/>);<br/>};</span><span id="c75f" class="nk lm hu nc b fv np nm l nn no"><strong class="nc hv">export default </strong><em class="ke">graphql</em>(SearchTweetsQuery, {<br/>  options: props =&gt; ({<br/>    <strong class="nc hv">variables</strong>: {<br/>      <strong class="nc hv">handle</strong>: props.<strong class="nc hv">handle</strong>,<br/>    },<br/>  }),<br/>})(<!-- -->Search<!-- -->);</span></pre><h1 id="efe3" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja nd jb lx jd ne je lz jg nf jh mb mc dt translated">ä½¿ç”¨Netlifyå’Œ/æˆ–S3çš„æ— æœåŠ¡å™¨å®¢æˆ·ç«¯éƒ¨ç½²</h1><blockquote class="jz ka kb"><p id="a1ca" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated">éƒ¨ç½²Netlify:<strong class="kf hv">yarn build&amp;&amp;Netlifyéƒ¨ç½²build <br/> </strong>éƒ¨ç½²S3: <strong class="kf hv"> yarn build &amp; &amp;æ— æœåŠ¡å™¨å®¢æˆ·ç«¯éƒ¨ç½²</strong></p></blockquote><pre class="jk jl jm jn fq ng nc nh ni aw nj dt"><span id="a4b4" class="nk lm hu nc b fv nl nm l nn no"><strong class="nc hv">service: </strong>serverless-graphql-client<br/><br/><strong class="nc hv">frameworkVersion: "&gt;=1.21.0 &lt;2.0.0"<br/><br/>provider:<br/>  name: </strong>aws<br/>  <strong class="nc hv">runtime: </strong>nodejs6.10<br/>  <strong class="nc hv">stage: </strong>dev<br/>  <strong class="nc hv">region: </strong>us-east-1<br/><br/><strong class="nc hv">plugins:<br/>  </strong>- serverless-finch<br/><br/><strong class="nc hv">custom:<br/>  client:<br/>    bucketName: </strong>&lt;unique bucket name&gt;<br/>    <strong class="nc hv">distributionFolder: </strong>build</span></pre><h1 id="0816" class="ll lm hu bd ln lo lp lq lr ls lt lu lv ja nd jb lx jd ne je lz jg nf jh mb mc dt translated">ç‰¹åˆ«æ„Ÿè°¢</h1><p id="cba2" class="pw-post-body-paragraph kc kd hu kf b kg md iv ki kj me iy kl mf mg ko kp mh mi ks kt mj mk kw kx ky hn dt translated"><a class="nq nr gr" href="https://medium.com/u/ff3f225e7f5c?source=post_page-----db16e42dc266--------------------------------" rel="noopener" target="_blank"> Nik Graf </a>åˆä½œå®ç°å®¢æˆ·ç«¯ç»„ä»¶ã€‚<br/> <a class="ae kz" href="https://twitter.com/menyao" rel="noopener ugc nofollow" target="_blank"> Manuel </a>å’Œ<a class="nq nr gr" href="https://medium.com/u/695782484bda?source=post_page-----db16e42dc266--------------------------------" rel="noopener" target="_blank"> Nader </a>ç”¨äºå¸®åŠ©å’Œå®¡æŸ¥ä»£ç ã€‚</p><p id="2df2" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œæ„Ÿè°¢æ‰€æœ‰äººé¼“åŠ±æˆ‘å¤šå†™ç‚¹ä¸œè¥¿ï¼Œæ„Ÿè°¢ä»¥å‰çš„åšå®¢ã€‚</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oh oi l"/></div></figure><p id="ac6f" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated">æˆ‘æƒ³ç”¨æˆ‘æœ€å–œæ¬¢çš„ä¸€å¥è¯æ¥ç»“æŸæˆ‘çš„åšå®¢â€”</p><p id="4fbc" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl mf kn ko kp mh kr ks kt mj kv kw kx ky hn dt translated"><em class="ke">â€œæƒ³è±¡åŠ›æ¯”çŸ¥è¯†æ›´é‡è¦ã€‚å› ä¸ºçŸ¥è¯†æ˜¯æœ‰é™çš„ï¼Œè€Œæƒ³è±¡åŠ›åŒ…å«æ•´ä¸ªä¸–ç•Œï¼Œåˆºæ¿€è¿›æ­¥ï¼Œå‚¬ç”Ÿè¿›åŒ–ã€‚â€â€” </em>é˜¿å°”ä¼¯ç‰¹Â·çˆ±å› æ–¯å¦</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="oj oi l"/></div></figure></div></div>    
</body>
</html>