<html>
<head>
<title>Solidity Pitfalls and How to Avoid Them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可靠性陷阱以及如何避免它们</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/solidity-pitfalls-and-how-to-avoid-them-24ba87735c7a?source=collection_archive---------7-----------------------#2018-03-23">https://medium.com/hackernoon/solidity-pitfalls-and-how-to-avoid-them-24ba87735c7a?source=collection_archive---------7-----------------------#2018-03-23</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/2f8c45a85213126f9d0a88bfbe784d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pc_NshlGxsLg5dzjsCRmyA.jpeg"/></div></div></figure><p id="ed77" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Solidity仍然是一种新的、快速变化的语言，它有一些严重的缺陷。和所有新事物一样，bug和逻辑错误是不可避免的。幸运的是，ICO热潮引发了一场新的研究运动，研究区块链和高级编程语言的安全方面，因为某些智能合约持有数百万美元，使其成为黑客的完美目标。</p><p id="ce89" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ka">本文基于以下研究</em> <a class="ae kb" href="https://brage.bibsys.no/xmlui/bitstream/handle/11250/2479191/18400_FULLTEXT.pdf?sequence=1" rel="noopener ugc nofollow" target="_blank"> <em class="ka">论文</em> </a> <em class="ka">:《以太坊智能合约:安全漏洞和安全工具》作者是挪威科技大学的Ardit Dika。</em></p><h1 id="9985" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">ERC20关键错误</h1><p id="44de" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">ERC20采用两种方式执行令牌交易。</p><ol class=""><li id="ad84" class="lf lg hu je b jf jg jj jk jn lh jr li jv lj jz lk ll lm ln dt translated"><em class="ka">转账</em>功能可让您向某人的地址发送代币。</li><li id="d64e" class="lf lg hu je b jf lo jj lp jn lq jr lr jv ls jz lk ll lm ln dt translated">要将令牌存入智能合约，您必须使用组合'<em class="ka">批准&amp;转移自</em>'。</li></ol><p id="dfe2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但是，当您使用转账功能向智能合约发送令牌时，智能合约不会检测到您的存款请求。这导致永久失去你的资金。很多新手开发者都亲身经历过这个严重的错误。</p><p id="dc14" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">像ERC223和ERC777这样的标准试图减轻这种缺陷。更具体地说，ERC223允许开发人员使用相同的函数将资金发送到一个地址或合同:<em class="ka"> transfer </em>。ERC223允许开发人员处理传入的令牌交易，并拒绝不支持的令牌。最后，ERC223令牌标准更有效率，因为它是一个单步流程，而不是从两步流程到<em class="ka">批准&amp;转移。简而言之，ERC777通过提供广泛的交易处理机制来关注采用。—来源:<a class="ae kb" href="https://www.cointelligence.com/content/comparison-erc20-erc223-new-ethereum-erc777-token-standard/" rel="noopener ugc nofollow" target="_blank">联合情报局</a>。</em></p><h1 id="e3e7" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">未检查的发送功能</h1><p id="4c10" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">Kalra S .、Goel S .等人最近发表了一篇关于分析智能合同安全性的研究论文<a class="ae kb" href="http://wp.internetsociety.org/ndss/wp-content/uploads/sites/25/2018/02/ndss2018_09-1_Kalra_paper.pdf" rel="noopener ugc nofollow" target="_blank">。他们描述了</a><a class="ae kb" href="http://hackingdistributed.com/2016/06/16/scanning-live-ethereum-contracts-for-bugs/" rel="noopener ugc nofollow" target="_blank">未检查</a> <em class="ka">发送</em>函数的问题:“由于Solidity在发送调用时只允许2300 gas，接收契约中计算量大的回退函数将导致调用发送失败。没有正确处理此类失败调用并允许在发送调用失败后修改全局状态的协定可能会错误地导致以太网丢失。</p><h1 id="a888" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">公开可见的数据</h1><p id="6111" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">以太坊区块链的所有数据对任何人都是公开可见的。不管以太坊有什么正面影响，好处都是受限于这个属性的。公司不能使用以太坊支付员工的工资，因为这将暴露他们的月收入。</p><p id="d66b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如您所见，非常需要引入更多安全属性(如加密、数据混淆和安全事务处理机制)的区块链。英格玛项目通过其所谓的“T0”秘密智能合同“T1”做了一件大事。</p><h1 id="795c" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">不可更改的智能合同</h1><p id="2473" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">一旦部署了智能合约，就不可能对其进行修改或变更。这是有利的，因为它代表了一个值得信赖的平台。另一方面，由于这一特性，大量智能合约包含可被利用来获取非法利润的漏洞。</p><p id="e245" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此外，ICO的一个常见安全指南是在testnet上部署其ICO智能合约时使用任意名称。在ICO智能合同被黑客攻击之前就发生过这种情况，因为攻击者能够在主网上实际部署之前几周就找到testnet智能合同，给他们足够的时间找到关键的bug。</p><p id="a945" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">2016年，Luu等人开发了一种符号执行分析工具(<a class="ae kb" href="https://eprint.iacr.org/2016/633.pdf" rel="noopener ugc nofollow" target="_blank"> Oyente </a>)。该工具揭示了当时19，366份智能合同中的45%至少存在一个已知的安全问题。</p><h1 id="e767" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">超过最大气体量</h1><p id="3beb" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">让我们以一个略显滑稽的问题来结束。政府网站赚了大钱。幸运的获胜者可以获得大量的1100 ETH。然而，由于代码中的一个错误，需要5057945的气体量来声明以太。但是，在当时，一笔交易的最大用气量只有4712388。</p><p id="7a4a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该问题是由一个数组引起的，该数组循环所有债权人并逐个删除它们，返回获胜者。甚至Vitalik Buterin也跳出来给出了这条建议:“总的来说，我们似乎需要一条针对合同开发人员的新的标准建议:确保如果您有用户可以扩展的数组，那么要么找到一些方法让每个用户单独处理与他们自己相关联的数组元素，要么将工作划分到几个事务中。”</p><p id="2f82" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">幸运的是，这个问题现在已经解决了。这样难以发现的问题以后还会不断冒出来。</p><h1 id="d023" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">黄金提示:使用专家和审计审计审计！</h1><p id="699f" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">我不想无礼，但不要相信新奇的Solidity开发者会给你的ICO智能合约编码。合适的开发人员知道过去发生的问题，并知道如何应对。</p><p id="051f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">大多数正在开发的固体合同将用于ico，所以我们谈论的是数百万美元。让几个独立的机构审核你的智能合同，这是为了你的安全。</p></div></div>    
</body>
</html>