<html>
<head>
<title>Will your Elastic cluster be hacked?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的弹性集群会被黑吗？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/will-your-elastic-cluster-be-hacked-e280f3393cd1?source=collection_archive---------12-----------------------#2018-03-23">https://medium.com/hackernoon/will-your-elastic-cluster-be-hacked-e280f3393cd1?source=collection_archive---------12-----------------------#2018-03-23</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="6360" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">今年1月，超过1100名NFL球员和他们的经纪人发现他们的个人数据被泄露，并被勒索赎金。由于Elasticsearch安全漏洞，这成为可能。</p><p id="c511" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">安全技术提供商Kromtech Security的报告显示，部署在AWS上的近4000台Elasticsearch机器已经感染了JackPOS和AlinaPOS恶意软件。这些集群形成了一个巨大的僵尸网络，窃取和加密信用卡信息等个人数据。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/1cbc58a93e6c1eef887bf9a1088507d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_5O4gQZB3LH54tsdi2L2g.jpeg"/></div></div></figure><p id="416e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">恶意软件将自己伪装成Java实用程序，保存在%APPDATA%目录或Java相关软件的任何其他子目录中。恶意软件正在感染其他机器，在这个过程中向罪犯发送加密数据，或者要求赎金以将数据归还给合法所有者。</p><p id="2afc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这怎么可能呢？当它出来时，版本6.0以下的ES安装包创建了3个默认用户:elastic、logstash和kibana，使用“changeme”密码。很明显，这些密码应该立即被替换为强个人密码，但是许多管理员松懈下来，忘记了这个过程。</p><p id="23c1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">结果，多达4000台弹性搜索机器(其中99%部署在AWS上的<strong class="it hv"/>)被感染。AWS有一个详细的ES设置/配置指南，但似乎大多数管理员只是简单地点击下一步，下一步，下一步，确定或选择快速安装选项，忽略了整个安全配置。这种情况在<a class="ae jp" href="https://discuss.elastic.co/t/ransom-attack-on-elasticsearch-cluster/71310" rel="noopener ugc nofollow" target="_blank">弹性文章</a>中有更详细的阐述。</p><h1 id="6d68" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">如何保护您的弹性集群？</h1><p id="3eda" class="pw-post-body-paragraph ir is hu it b iu la iw ix iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo hn dt translated">Elastic没有闲着，发表了一篇博文，指导如何保护Elasticsearch机器。第一个建议是更新到最新的ES版本，很明显…公司竭尽全力消除管理员跳过初始密码设置的可能性。</p><p id="1d40" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如，现在甚至在集群内部也需要TLS连接，并且检查其设置是否正确现在是引导过程的一部分。此外，名为“<em class="lf">xpack . security . authc . accept _ default _ password</em>”的安全设置禁止在生产ES集群上使用默认密码。最后，配置好的CLI工具会自动为所有es默认用户生成随机引导密码，以消除黑客在安装集群和发布强永久密码之间的短时间内获得访问权限的机会。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/0cae0401380f285e1eeb3841dbeabb86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NyNltGye6_4YSCGDGhJ5Wg.jpeg"/></div></div></figure><p id="e909" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们建议执行以下步骤来保护您的ES群集:</p><ul class=""><li id="8ec5" class="lg lh hu it b iu iv iy iz jc li jg lj jk lk jo ll lm ln lo dt translated">将您的ES更新到<a class="ae jp" href="https://www.elastic.co/downloads/elasticsearch" rel="noopener ugc nofollow" target="_blank">最新版本</a>(撰写本文时为6.0)。从头重新安装ES会更好</li><li id="c600" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">阻止所有不使用的端口的外部访问</li><li id="e81d" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">将可信IP列入白名单</li><li id="8930" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">检查并监控所有服务器上的所有日志、连接和网络流量</li><li id="1983" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">在怀疑存在安全漏洞后，最好立即重新安装所有被入侵的机器，以避免数月内对每台机器进行分钟监控。</li></ul><p id="69ac" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">虽然看起来很平常，但这些行动将大大增加保护您的敏感数据和避免Elasticsearch恶意软件感染的机会。</p><h1 id="b22d" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">关于如何保护您的弹性集群的最终想法</h1><p id="908f" class="pw-post-body-paragraph ir is hu it b iu la iw ix iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo hn dt translated">在IT Svit，我们从一开始就意识到了易受攻击的默认密码，并付出了额外的努力来保护我们的客户。在所有要求使用弹性集群的项目中，我们利用第三方身份验证模块来防止任何通过弱ES身份验证协议的潜在安全漏洞。</p><p id="4c84" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您确定您的管理员在将Elasticsearch集群部署到AWS时没有跳过安全配置吗？你的密码足够强吗？遵循上述简单步骤，确保客户敏感数据的安全，让您高枕无忧！</p></div><div class="ab cl lu lv hc lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hn ho hp hq hr"><p id="2631" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最初，我把这个故事贴在了我公司的博客上——https://itsvit.com/blog/will-elastic-cluster-hacked/<a class="ae jp" href="https://itsvit.com/blog/will-elastic-cluster-hacked/" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>