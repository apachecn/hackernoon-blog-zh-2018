<html>
<head>
<title>AWS CloudWatch Monitoring with Grafana</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Grafana进行AWS CloudWatch监控</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/aws-cloudwatch-monitoring-with-grafana-ace63e1ab507?source=collection_archive---------3-----------------------#2018-03-24">https://medium.com/hackernoon/aws-cloudwatch-monitoring-with-grafana-ace63e1ab507?source=collection_archive---------3-----------------------#2018-03-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/702979fcbd5bc2120aed28871ab32361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i0oOj9ZyOM2AULYGs6fk-A.jpeg"/></div></div></figure><p id="7d75" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">混合云</strong>是新的现实。因此，对于您的全球基础设施，您将需要一个单一的工具、通用仪表板和图形编辑器。这就是<strong class="je hv">格拉夫纳</strong>发挥作用的地方。由于它的可插拔架构，您可以访问许多小部件和插件来创建交互式&amp;用户友好的仪表板。在这篇文章中，我将带您了解如何在Grafana中创建仪表板，以根据在<strong class="je hv"> AWS CloudWatch </strong>中收集的指标实时监控您的<strong class="je hv"> EC2 </strong>实例。</p><p id="2c0c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，使用以下<strong class="je hv"> IAM策略</strong>创建一个<strong class="je hv"> IAM角色</strong>:</p><figure class="ka kb kc kd fq iv"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="3fb4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用下面的<em class="kg">用户数据</em>脚本启动一个<strong class="je hv"> EC2 </strong>实例。确保将我们之前创建的角色与实例相关联:</p><figure class="ka kb kc kd fq iv"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="67fa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在安全组部分，允许端口<strong class="je hv"> 3000 </strong>上的入站流量(Grafana仪表板)。</p><p id="f0fe" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建完成后，将您的浏览器指向<a class="ae kh" href="http://instance_dns_name:3000/" rel="noopener ugc nofollow" target="_blank">http://instance _ DNS _ name:3000</a>，您应该会看到<strong class="je hv"> Grafana登录</strong>页面(默认凭证:<em class="kg"> admin/admin </em>):</p><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ki"><img src="../Images/d3d7e07eb31f83ad08672ceba0937283.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XXTKd2ptC_hO9JlZ."/></div></div></figure><p id="7086" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Grafana附带了对CloudWatch的内置支持，因此添加了一个新的数据源:</p><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kj"><img src="../Images/7967becc031100a4c1b4a69e93da3cb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BWBhqe3yIgtwimeD."/></div></div></figure><p id="e227" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">注意:如果您使用的是<em class="kg"> IAM角色</em>(推荐)，如上所述将其他字段留空，否则，在<em class="kg"> ~/处创建一个新文件。aws/凭证</em>与您自己的AWS访问密钥&amp;密钥。</p><p id="5840" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建一个新的仪表板，并向面板添加新图形，选择<strong class="je hv"> AWS/EC2 </strong>作为<em class="kg">名称空间</em>，选择<strong class="je hv"> CPUUtilization </strong>作为<em class="kg">度量</em>，并在<em class="kg">维度</em>字段中选择您想要监控的实例的<strong class="je hv">实例id </strong>:</p><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ki"><img src="../Images/c5dc7d7b4755ef678e8a9cb2ff8f2286.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nF_qQAsLL8Yw7SWP."/></div></div></figure><p id="0edd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">太好了！</p><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div class="fe ff kk"><img src="../Images/56e3dd69825403723f9ea2c5c70454dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*ihVssNT1egQafZlH."/></div></figure><p id="9bca" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们可以使用Grafana中一个名为“<strong class="je hv">查询变量</strong>的特性，而不是在查询中硬编码<em class="kg"> InstanceId </em>。创建一个新变量来保存AWS支持的区域列表:</p><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kl"><img src="../Images/a26b87f12fabcf8818a2ba4a29afd0c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WLhxFYK5sJwQB_3Z."/></div></div></figure><p id="aae4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">并且，创建第二个变量来存储每个选定AWS区域的实例id列表:</p><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff km"><img src="../Images/c24401b632627536ef1d16681e5e17f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ENaTrn2uDbe9CI6Z."/></div></div></figure><p id="723f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，返回到您的图表并更新查询，如下所示:</p><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kn"><img src="../Images/0872756482f44605285edfbbd17b7001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5xUDbJQWUGctzspg."/></div></div></figure><p id="eeed" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就这样，继续创建其他小部件:</p><figure class="ka kb kc kd fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ki"><img src="../Images/1206aa2336c417e3eebef536a38c76ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xeB1ikkMxB69V9UO."/></div></div></figure><p id="b4d9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">注意:你可以从<a class="ae kh" href="https://github.com/mlabouardy/grafana-dashboards" rel="noopener ugc nofollow" target="_blank"> GitHub </a>下载仪表盘。</p><p id="1068" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，您已经准备好为您的<strong class="je hv"> CloudWatch </strong>指标构建交互式动态仪表盘了。</p></div></div>    
</body>
</html>