<html>
<head>
<title>Create a MongoDB sharded cluster with SSL enabled</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个启用SSL的MongoDB分片集群</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/create-a-mongodb-sharded-cluster-with-ssl-enabled-dace56bc7a17?source=collection_archive---------5-----------------------#2018-03-24">https://medium.com/hackernoon/create-a-mongodb-sharded-cluster-with-ssl-enabled-dace56bc7a17?source=collection_archive---------5-----------------------#2018-03-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="a9cb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">大约两个月前，我开始认真地学习MongoDB。在Growthfunnel.io，我们使用MongoDB，我们需要扩展我们的系统，以支持大量数据(大约6TB以上)和高吞吐量。分片、数据库集群对我来说都是全新的，所以我开始学习。这篇文章的目的是与社区分享和验证我的知识。我不是这方面的专家。我只是分享我学到的东西。</p><p id="0a60" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">本教程一步一步地解释了如何创建MongoDB分片集群。我们将在一台机器上部署这个演示。</p><h1 id="e6da" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">先决条件:</strong></h1><ul class=""><li id="4c83" class="ko kp hu it b iu kq iy kr jc ks jg kt jk ku jo kv kw kx ky dt translated">MongoDB — 3.6.2</li><li id="9fc4" class="ko kp hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">OpenSSL</li><li id="3b00" class="ko kp hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">NodeJS</li><li id="022e" class="ko kp hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">尝试</li><li id="6f5d" class="ko kp hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">mongodb分片的基础知识</li></ul><h1 id="d6ec" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">什么是数据库分片？</strong></h1><p id="707c" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">分片是在多台机器上分割数据的过程，这些机器将大型数据库分成更小、更快、更容易管理的部分，称为数据分片。shard这个词的意思是整个集群的一小部分。</p><h1 id="cb24" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">我们的分片架构</strong></h1><p id="acf0" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">我们的分片集群将在一台机器上运行，每个组件将在单独的进程和端口上启动。该集群分为三个分片，每个分片包含两个数据成员和一个任意成员。每个碎片复制品具有:</p><ul class=""><li id="8f68" class="ko kp hu it b iu iv iy iz jc lh jg li jk lj jo kv kw kx ky dt translated">1个主要成员</li><li id="5cc8" class="ko kp hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">1个次要成员</li><li id="4da3" class="ko kp hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">1个任意成员</li></ul><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff lk"><img src="../Images/6c6d7962282a7ab0e306d22040a5d558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wbHmxITF0Lo9gKSpf8hHQ.png"/></div></div></figure><h1 id="4dd5" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">准备环境</strong></h1><h2 id="3804" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated">1.从<a class="ae jp" href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/" rel="noopener ugc nofollow" target="_blank">官方文档</a>安装MongoDB。</h2><h2 id="7ca3" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated">2.配置主机名</h2><p id="2563" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">将此行<code class="eh mk ml mm mn b">127.0.0.1 database.fluddi.com</code>追加到<code class="eh mk ml mm mn b">/etc/hosts</code>文件中；<code class="eh mk ml mm mn b">database.fluddi.com</code>将是我们的数据库主机名。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="df46" class="lw jr hu mn b fv ms mt l mu mv">echo '127.0.0.1 <!-- -->database.fluddi.com<!-- -->' | sudo tee --append /etc/hosts</span></pre><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff mw"><img src="../Images/a2ebc1848e46a9bdb598af2e40e367d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IvQFdukmeaJ5lthGapc91w.png"/></div></div></figure><h2 id="7a22" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated">3.确保数据目录和日志目录具有读写权限</h2><p id="4041" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">创建数据目录和日志目录，并拥有这些目录供您的用户读写。在我的例子中，我的用户和用户组名是<code class="eh mk ml mm mn b">vagrant</code>。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="e2a0" class="lw jr hu mn b fv ms mt l mu mv">mkdir -p /data/mongodb /var/log/mongodb/test-cluster<br/>sudo chown -R vagrant:vagrant /data/mongodb<br/>sudo chown -R vagrant:vagrant /var/log/mongodb/test-cluster</span></pre><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff mx"><img src="../Images/8c942950566e00749f8186b4e9ad6a87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FFRxjvPXezS2Xl1KovVZwQ.png"/></div></div></figure><h2 id="8139" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated">4.克隆<code class="eh mk ml mm mn b"><a class="ae jp" href="https://github.com/joynal/mongodb-sample-cluster" rel="noopener ugc nofollow" target="_blank">mongodb-sample-cluster</a></code>回购</h2><div class="my mz fm fo na nb"><a href="https://github.com/joynal/mongodb-sample-cluster" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab ej"><div class="nd ab ne cl cj nf"><h2 class="bd hv fv z el ng eo ep nh er et ht dt translated">joynal/MongoDB-样本-集群</h2><div class="ni l"><h3 class="bd b fv z el ng eo ep nh er et ek translated">MongoDB-样本-集群- MongoDB分片集群</h3></div><div class="nj l"><p class="bd b gc z el ng eo ep nh er et ek translated">github.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np lu nb"/></div></div></a></div><p id="f60f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">此报告包含群集的配置文件。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="fa6a" class="lw jr hu mn b fv ms mt l mu mv">git clone <a class="ae jp" href="https://github.com/joynal/mongodb-sample-cluster" rel="noopener ugc nofollow" target="_blank">https://github.com/joynal/mongodb-sample-cluster</a></span></pre><p id="119a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh mk ml mm mn b">confs</code>目录包含集群组件配置；您可以根据自己的需求进行定制。确保你的数据目录&amp;日志目录有读&amp;写权限。默认数据目录指向<code class="eh mk ml mm mn b">/data/mongodb/</code>上&amp;日志目录指向<code class="eh mk ml mm mn b">/var/log/mongodb/test-cluster/</code>上。</p><h1 id="d533" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">生成自签名SSL证书</strong></h1><h2 id="5d92" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated"><strong class="ak"> 1。生成认证机构</strong></h2><p id="866d" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">让我们为分片集群生成一个自签名证书，这仅用于本演示。对于生产使用，您的MongoDB部署应该使用由单个证书颁发机构生成和签名的有效证书。您或您的组织可以生成并维护一个独立的证书颁发机构，或者使用由第三方SSL供应商生成的证书。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="8188" class="lw jr hu mn b fv ms mt l mu mv">sudo mkdir -p /opt/mongodb</span></pre><p id="0d79" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在拥有这个目录，使用您的用户名和用户组名。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="dec4" class="lw jr hu mn b fv ms mt l mu mv">sudo chown -R vagrant:vagrant /opt/mongodb</span></pre><p id="b28b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好了，让我们创建一个认证中心。为CA证书生成一个私钥，并保持它非常安全。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="499d" class="lw jr hu mn b fv ms mt l mu mv">cd /opt/mongodb<br/>openssl genrsa -out CA.key 4096</span></pre><p id="5267" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在自行签署此证书。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="f882" class="lw jr hu mn b fv ms mt l mu mv">openssl req -new -x509 -days 1825 -key CA.key -out CA.crt</span></pre><p id="60f2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这将提示输入证书信息。</p><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff nq"><img src="../Images/c3e88150a54a016b3a033159e0edf54c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YFwpramBM0nI7Z2rRZy4rQ.png"/></div></div></figure><h2 id="fe36" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated"><strong class="ak"> 2。为集群成员生成证书</strong></h2><p id="cd41" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">生成私钥和CSR。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="fd57" class="lw jr hu mn b fv ms mt l mu mv">openssl genrsa -out certificate.key 4096<br/>openssl req -new -key <!-- -->certificate<!-- -->.key -out <!-- -->certificate<!-- -->.csr</span></pre><p id="dc1c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这将提示输入信息，确保域名支持通配符域。</p><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff nr"><img src="../Images/f415dcddf23a1af3ea7841ae28f09bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I9GErkojehdwUdIssUxBwg.png"/></div></div></figure><p id="368c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在自我签名。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="0f73" class="lw jr hu mn b fv ms mt l mu mv">openssl x509 -req -days 1825 -in <!-- -->certificate<!-- -->.csr -CA CA.crt -CAkey CA.key -set_serial 01 -out <!-- -->certificate<!-- -->.crt</span></pre><p id="488a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">输出将是这样的:</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="6857" class="lw jr hu mn b fv ms mt l mu mv">Signature ok<br/><a class="ae jp" href="mailto:subject=/C=BD/ST=Dhaka/L=Dhaka/O=Fluddi/OU=database/CN=*.fluddi.com/emailAddress=support@fluddi.com" rel="noopener ugc nofollow" target="_blank">subject=/C=BD/ST=Dhaka/L=Dhaka/O=Fluddi/OU=database/CN=*.fluddi.com/emailAddress=support@fluddi.com</a><br/>Getting CA Private Key</span></pre><p id="3494" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建<code class="eh mk ml mm mn b">.pem</code>文件。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="653e" class="lw jr hu mn b fv ms mt l mu mv">cat <!-- -->certificate<!-- -->.key <!-- -->certificate<!-- -->.crt &gt; <!-- -->certificate<!-- -->.pem</span></pre><h2 id="f3a6" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated"><strong class="ak"> 3。生成客户端证书</strong></h2><p id="d347" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">每个客户端证书必须具有唯一的不同于集群成员证书的SAN。否则，MongoDB会将其视为集群成员。每个证书都属于一个MongoDB x.509用户，<a class="ae jp" href="https://docs.mongodb.com/manual/tutorial/configure-x509-client-authentication/#client-x-509-certificate" rel="noopener ugc nofollow" target="_blank">更多详情</a>。</p><p id="694d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好了，让我们按照前面的步骤生成两个证书，只是要确保<strong class="it hv"> OU </strong>是不同的。</p><ul class=""><li id="6e19" class="ko kp hu it b iu iv iy iz jc lh jg li jk lj jo kv kw kx ky dt translated">对于Web应用程序</li></ul><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="abd0" class="lw jr hu mn b fv ms mt l mu mv">openssl genrsa -out client.key 4096<br/>openssl req -new -key client.key -out client.csr</span></pre><p id="8500" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">除了<strong class="it hv">和</strong>不同之外，其他都和会员证书一样。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="3704" class="lw jr hu mn b fv ms mt l mu mv">Organizational Unit Name (eg, section) []:webapp</span></pre><ul class=""><li id="7dd0" class="ko kp hu it b iu iv iy iz jc lh jg li jk lj jo kv kw kx ky dt translated">对于数据库管理员</li></ul><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="801f" class="lw jr hu mn b fv ms mt l mu mv">openssl genrsa -out admin-client.key 4096<br/>openssl req -new -key admin-client.key -out admin-client.csr</span></pre><p id="1ba1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一切都会和会员证一样，只是<strong class="it hv">欧</strong>会有所不同。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="97ce" class="lw jr hu mn b fv ms mt l mu mv">Organizational Unit Name (eg, section) []:appadmin</span></pre><p id="7cc4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在将所有文件权限改为只读。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="7856" class="lw jr hu mn b fv ms mt l mu mv">cd /opt/mongodb/<br/>chmod 400 *</span></pre><h1 id="d465" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">创建配置服务器副本集</h1><p id="9d41" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">创建数据目录，用你实际的数据库路径替换<code class="eh mk ml mm mn b">$DB_PATH</code>。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="9f6b" class="lw jr hu mn b fv ms mt l mu mv">mkdir -p $DB_PATH/config/rs0 $DB_PATH/config/rs1 $DB_PATH/config/rs2</span></pre><p id="b7c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">把目录改成<code class="eh mk ml mm mn b">mongodb-sample-cluster</code>代码回购，你就克隆好了。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="781f" class="lw jr hu mn b fv ms mt l mu mv">cd ~/mongodb-sample-cluster</span></pre><p id="dbe7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">启动配置服务器副本集的所有成员。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="7826" class="lw jr hu mn b fv ms mt l mu mv">mongod --config ./confs/config/r0.conf<br/>mongod --config ./confs/config/r1.conf<br/>mongod --config ./confs/config/r2.conf</span></pre><p id="ec5e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">连接到其中一个配置服务器。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="1e99" class="lw jr hu mn b fv ms mt l mu mv">mongo --port 57040 --ssl --host database.fluddi.com --sslPEMKeyFile /opt/mongodb/certificate.pem --sslCAFile /opt/mongodb/CA.pem</span></pre><p id="50dd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">初始化副本集。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="1f97" class="lw jr hu mn b fv ms mt l mu mv">rs.initiate({<br/>  _id: "cfg",<br/>  configsvr: true,<br/>  members: [<br/>    { _id : 0, host : "database.fluddi.com:57040" },<br/>    { _id : 1, host : "database.fluddi.com:57041" },<br/>    { _id : 2, host : "database.fluddi.com:57042" }<br/>  ]<br/>})</span></pre><h1 id="2b05" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">创建碎片副本集</h1><h2 id="ce89" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated"><strong class="ak">部署碎片0 </strong></h2><p id="ec6a" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">为复制副本实例创建数据目录。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="2e55" class="lw jr hu mn b fv ms mt l mu mv">mkdir -p /data/mongodb/shard0/rs0 /data/mongodb/shard0/rs1 /data/mongodb/shard0/rs2</span></pre><p id="f991" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">启动碎片副本集的每个成员。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="c16d" class="lw jr hu mn b fv ms mt l mu mv">mongod --config ./confs/shard0/r0.conf<br/>mongod --config ./confs/shard0/r1.conf<br/>mongod --config ./confs/shard0/r2.conf</span></pre><p id="2e58" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">连接到碎片副本集的一个成员。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="780d" class="lw jr hu mn b fv ms mt l mu mv">mongo --port 37017 --ssl --host database.fluddi.com --sslPEMKeyFile /opt/mongodb/certificate.pem --sslCAFile /opt/mongodb/CA.pem</span></pre><p id="6e5a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">初始化副本集。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="c401" class="lw jr hu mn b fv ms mt l mu mv">rs.initiate({<br/>  _id: "s0",<br/>  members: [<br/>    { _id : 0, host : "database.fluddi.com:37017" },<br/>    { _id : 1, host : "database.fluddi.com:37018" },<br/>    { _id : 2, host : "database.fluddi.com:37019", arbiterOnly: true }<br/>  ]<br/>})</span></pre><p id="09f0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它将返回如下内容:</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="51a0" class="lw jr hu mn b fv ms mt l mu mv">{"ok": 1}</span></pre><h2 id="e9bb" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated"><strong class="ak">部署碎片1 </strong></h2><p id="e98f" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">创建数据目录，用实际的db路径替换<code class="eh mk ml mm mn b">$DB_PATH</code>。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="f265" class="lw jr hu mn b fv ms mt l mu mv">mkdir -p $DB_PATH/shard1/rs0 $DB_PATH/shard1/rs1 $DB_PATH/shard1/rs2</span></pre><p id="a7b3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">启动碎片副本集的每个成员。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="d822" class="lw jr hu mn b fv ms mt l mu mv">mongod --config ./confs/shard1/r0.conf<br/>mongod --config ./confs/shard1/r1.conf<br/>mongod --config ./confs/shard1/r2.conf</span></pre><p id="c211" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">连接到碎片副本集的一个成员。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="859c" class="lw jr hu mn b fv ms mt l mu mv">mongo --port 47017 --ssl --host database.fluddi.com --sslPEMKeyFile /opt/mongodb/certificate.pem --sslCAFile /opt/mongodb/CA.pem</span></pre><p id="5fea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">初始化副本集。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="3482" class="lw jr hu mn b fv ms mt l mu mv">rs.initiate({<br/>  _id: "s1",<br/>  members: [<br/>    { _id : 0, host : "database.fluddi.com:47017" },<br/>    { _id : 1, host : "database.fluddi.com:47018" },<br/>    { _id : 2, host : "database.fluddi.com:47019", arbiterOnly: true }<br/>  ]<br/>})</span></pre><h2 id="0aec" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated"><strong class="ak">部署碎片2 </strong></h2><p id="5978" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">创建数据目录，用实际的db路径替换<code class="eh mk ml mm mn b">$DB_PATH</code>。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="f2e5" class="lw jr hu mn b fv ms mt l mu mv">mkdir -p $DB_PATH/shard2/rs0 $DB_PATH/shard2/rs1 $DB_PATH/shard2/rs2</span></pre><p id="43f7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">启动碎片副本集的每个成员。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="3f0b" class="lw jr hu mn b fv ms mt l mu mv">mongod --config ./confs/shard2/r0.conf<br/>mongod --config ./confs/shard2/r1.conf<br/>mongod --config ./confs/shard2/r2.conf</span></pre><p id="a1ce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">连接到碎片副本集的一个成员。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="7b0a" class="lw jr hu mn b fv ms mt l mu mv">mongo --port 57017 --ssl --host database.fluddi.com --sslPEMKeyFile /opt/mongodb/certificate.pem --sslCAFile /opt/mongodb/CA.pem</span></pre><p id="ae79" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">初始化副本集。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="df1e" class="lw jr hu mn b fv ms mt l mu mv">rs.initiate({<br/>  _id: "s2",<br/>  members: [<br/>    { _id : 0, host : "database.fluddi.com:57017" },<br/>    { _id : 1, host : "database.fluddi.com:57018" },<br/>    { _id : 2, host : "database.fluddi.com:57019", arbiterOnly: true }<br/>  ]<br/>})</span></pre><h1 id="c890" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">将一个<code class="eh mk ml mm mn b">mongos</code>连接到集群</h1><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="090e" class="lw jr hu mn b fv ms mt l mu mv">mongos --config ./confs/mongos/m1.conf</span></pre><p id="0d55" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">查看mongod和mongos进程。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="a8d5" class="lw jr hu mn b fv ms mt l mu mv">ps aux | grep mongo</span></pre><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff ns"><img src="../Images/0be391a99c445622ae525acd2d27bd46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dam0h_4PfCLCQ2YyqUMtUQ.png"/></div></div></figure><p id="47d1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们准备添加数据库和碎片集合。</p><h1 id="beb1" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">向集群添加碎片</strong></h1><p id="4128" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">将mongo shell连接到mongo。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="09aa" class="lw jr hu mn b fv ms mt l mu mv">mongo --port 27018 --ssl --host database.fluddi.com --sslPEMKeyFile /opt/mongodb/certificate.pem --sslCAFile /opt/mongodb/CA.pem</span></pre><h2 id="5367" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated">1.创建管理员用户</h2><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="9276" class="lw jr hu mn b fv ms mt l mu mv">db.getSiblingDB("admin").createUser(<br/>  {<br/>    user: "admin",<br/>    pwd: "grw@123",<br/>    roles: [<br/>      { role: "userAdminAnyDatabase", db: "admin" },<br/>      { role : "clusterAdmin", db : "admin" }<br/>    ]<br/>  }<br/>)</span></pre><p id="57eb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们认证，</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="702a" class="lw jr hu mn b fv ms mt l mu mv">db.getSiblingDB("admin").auth("admin", "grw@123")</span></pre><h2 id="f5ab" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated">2.添加碎片成员</h2><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="ae34" class="lw jr hu mn b fv ms mt l mu mv">sh.addShard("s0/database.fluddi.com:37017")<br/>sh.addShard("s1/database.fluddi.com:47017")<br/>sh.addShard("s2/database.fluddi.com:57017")</span></pre><h2 id="db4e" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated">3.为webapp和管理添加x509用户</h2><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="5146" class="lw jr hu mn b fv ms mt l mu mv">db.getSiblingDB("$external").runCommand(<br/>  {<br/>    createUser: "<a class="ae jp" href="mailto:emailAddress=support@fluddi.com" rel="noopener ugc nofollow" target="_blank">emailAddress=support@fluddi.com</a>,CN=*.fluddi.com,OU=appadmin,O=Fluddi,L=Dhaka,ST=Dhaka,C=BD",<br/>    roles: [<br/>      { role : "clusterAdmin", db : "admin" },<br/>      { role: "dbOwner", db: "fluddi" },<br/>    ],<br/>    writeConcern: { w: "majority" , wtimeout: 5000 }<br/>  }<br/>)</span><span id="a6fe" class="lw jr hu mn b fv nt mt l mu mv">db.getSiblingDB("$external").runCommand(<br/>  {<br/>    createUser: "<a class="ae jp" href="mailto:emailAddress=support@fluddi.com" rel="noopener ugc nofollow" target="_blank">emailAddress=support@fluddi.com</a>,CN=*.fluddi.com,OU=webapp,O=Fluddi,L=Dhaka,ST=Dhaka,C=BD",<br/>    roles: [<br/>      { role: "readWrite", db: "fluddi" },<br/>    ],<br/>    writeConcern: { w: "majority" , wtimeout: 5000 }<br/>  }<br/>)</span></pre><h1 id="5f84" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">为数据库启用分片</h1><p id="b5b6" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">在对集合进行分片之前，必须为集合的数据库启用分片。为数据库启用分片不会重新分发数据，但可以对数据库中的集合进行分片。</p><p id="fe0b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦为数据库启用了分片，MongoDB就会为该数据库分配一个主分片，在分片开始之前，MongoDB会将所有数据存储在这个主分片中。</p><p id="2f07" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在数据库上启用分片，在这个演示中，我使用的名称是<code class="eh mk ml mm mn b">fluddi</code></p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="3784" class="lw jr hu mn b fv ms mt l mu mv">sh.enableSharding("fluddi")</span></pre><h1 id="975c" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">碎片收集</strong></h1><h2 id="180d" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated">1.将收藏品分成碎片</h2><p id="81d3" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">您需要在每个集合的基础上启用分片。确定您将使用什么作为碎片密钥。您对分片键的选择会影响分片的效率。</p><p id="f62b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在使用客户端证书连接到mongos并进行身份验证。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="15e9" class="lw jr hu mn b fv ms mt l mu mv">mongo --port 27018 --ssl --host database.fluddi.com --sslPEMKeyFile /opt/mongodb/admin-client.pem --sslCAFile /opt/mongodb/CA.pem</span></pre><p id="ba6f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">验证用户，</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="a732" class="lw jr hu mn b fv ms mt l mu mv">db.getSiblingDB("$external").auth(<br/>    {<br/>      mechanism: "MONGODB-X509",<br/>      user: "emailAddress=support@fluddi.com,CN=*.fluddi.com,OU=appadmin,O=Fluddi,L=Dhaka,ST=Dhaka,C=BD"<br/>    }<br/>  )</span></pre><p id="4efe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<code class="eh mk ml mm mn b">fluddi</code>数据库中创建收藏。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="3331" class="lw jr hu mn b fv ms mt l mu mv">use fluddi<br/>db.createCollection("visitors")</span></pre><p id="9a8b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建访问者集合的索引。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="087b" class="lw jr hu mn b fv ms mt l mu mv">db.visitors.ensureIndex({"siteId": 1, "_id": 1})</span></pre><p id="b2ab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们分享这些收藏品。我在选择一个组合键。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="e277" class="lw jr hu mn b fv ms mt l mu mv">sh.shardCollection("fluddi.visitors", {"siteId": 1, "_id": 1})</span></pre><p id="539f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">检查集群状态。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="e759" class="lw jr hu mn b fv ms mt l mu mv">sh.status()</span></pre><p id="0205" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">样本输出:</p><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff nu"><img src="../Images/1628fde054ee349e775b0abffb2a5e86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TflETVi1vbkrM5txLcFKEg.png"/></div></div></figure><h2 id="a18a" class="lw jr hu bd js lx ly lz jw ma mb mc ka jc md me ke jg mf mg ki jk mh mi km mj dt translated"><strong class="ak"> 2。修改块大小</strong></h2><p id="73aa" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">出于演示目的，请减小块大小。否则，您将需要生成大量数据。这只是为了演示，不要在生产中这样做。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="2b43" class="lw jr hu mn b fv ms mt l mu mv">use config<br/>db.settings.save( { _id:"chunksize", value: 8 } )</span></pre><p id="7543" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在块大小将是8MB。</p><h1 id="e57c" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated"><strong class="ak">生成一些虚拟数据(可选)</strong></h1><p id="6c0c" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">转到<code class="eh mk ml mm mn b">mongodb-sample-cluster</code>代码目录，你克隆的。</p><ul class=""><li id="0617" class="ko kp hu it b iu iv iy iz jc lh jg li jk lj jo kv kw kx ky dt translated">配置。env文件，遵循. env.example</li><li id="6ddc" class="ko kp hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">安装软件包，使用<code class="eh mk ml mm mn b">npm i</code>或<code class="eh mk ml mm mn b">yarn</code></li><li id="87d3" class="ko kp hu it b iu kz iy la jc lb jg lc jk ld jo kv kw kx ky dt translated">运行<code class="eh mk ml mm mn b">node index.js</code>，这将生成50000条访客记录</li></ul><p id="5f20" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在再次使用客户端证书连接到&amp; authenticate。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="c141" class="lw jr hu mn b fv ms mt l mu mv">mongo --port 27018 --ssl --host database.fluddi.com --sslPEMKeyFile /opt/mongodb/admin-client.pem --sslCAFile /opt/mongodb/CA.pem</span></pre><p id="a49c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">验证用户，</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="cc19" class="lw jr hu mn b fv ms mt l mu mv">db.getSiblingDB("$external").auth(<br/>    {<br/>      mechanism: "MONGODB-X509",<br/>      user: "emailAddress=support@fluddi.com,CN=*.fluddi.com,OU=appadmin,O=Fluddi,L=Dhaka,ST=Dhaka,C=BD"<br/>    }<br/>  )</span></pre><p id="8cb7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">检查集群状态。</p><pre class="ll lm ln lo fq mo mn mp mq aw mr dt"><span id="86c7" class="lw jr hu mn b fv ms mt l mu mv">sh.status()</span></pre><p id="d7e8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">样本输出:</p><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff nv"><img src="../Images/5c7f058e633ff1b89ee11dfe75010f29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzpO4CGiEUGz1yxpgry6YQ.png"/></div></div></figure><h1 id="fb47" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">绑定IP地址</h1><p id="a4d8" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">如果你在远程机器上部署了所有的东西，并且想要从你的计算机访问数据库，或者你想要从另一个服务器连接一个web应用，你需要绑定IP地址。将<code class="eh mk ml mm mn b">bindIp</code>改为<code class="eh mk ml mm mn b">0.0.0.0</code>。现在，mongos将监听系统上配置的所有接口。</p><p id="2d65" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在绑定其他IP地址之前，考虑<a class="ae jp" href="https://docs.mongodb.com/manual/administration/security-checklist/#checklist-auth" rel="noopener ugc nofollow" target="_blank">启用访问控制</a>和<a class="ae jp" href="https://docs.mongodb.com/manual/administration/security-checklist/" rel="noopener ugc nofollow" target="_blank">安全清单</a>中列出的其他安全措施，以防止未授权访问。</p><h1 id="e7ec" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">术语</h1><p id="c09d" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated"><strong class="it hv">副本集:</strong>一组维护相同数据集的mongod进程。<br/> <strong class="it hv">主:</strong>副本成员接受写入。<br/> <strong class="it hv">辅助:</strong>(通过操作日志)从主服务器获取并复制变更。</p><p id="0fec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">感谢阅读。希望你们喜欢这篇文章，并得到了这个想法。在我的<a class="ae jp" href="https://github.com/joynal/mongodb-sample-cluster" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">代码回购</strong> </a> <strong class="it hv">，</strong>中，我包含了一个init脚本来自动化整个分片设置过程，看看吧。</p><div class="my mz fm fo na nb"><a href="https://github.com/joynal/mongodb-sample-cluster" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab ej"><div class="nd ab ne cl cj nf"><h2 class="bd hv fv z el ng eo ep nh er et ht dt translated">joynal/MongoDB-样本-集群</h2><div class="ni l"><h3 class="bd b fv z el ng eo ep nh er et ek translated">MongoDB-样本-集群- MongoDB分片集群</h3></div><div class="nj l"><p class="bd b gc z el ng eo ep nh er et ek translated">github.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np lu nb"/></div></div></a></div><h1 id="26f1" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">信用</h1><p id="b0b4" class="pw-post-body-paragraph ir is hu it b iu kq iw ix iy kr ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">我从下面的链接中借用了一些文字，因为它比我的版本更适合。</p><ol class=""><li id="0145" class="ko kp hu it b iu iv iy iz jc lh jg li jk lj jo nw kw kx ky dt translated"><a class="ae jp" href="http://searchcloudcomputing.techtarget.com/definition/sharding" rel="noopener ugc nofollow" target="_blank">http://search cloud computing . tech target . com/definition/sharding</a></li><li id="19d9" class="ko kp hu it b iu kz iy la jc lb jg lc jk ld jo nw kw kx ky dt translated"><a class="ae jp" href="https://cloudmesh.github.io/introduction_to_cloud_computing/class/vc_sp15/mongodb_cluster.html" rel="noopener ugc nofollow" target="_blank">https://cloud mesh . github . io/introduction _ to _ cloud _ computing/class/VC _ sp15/MongoDB _ cluster . html</a></li></ol><figure class="ll lm ln lo fq lp"><div class="bz el l di"><div class="nx ny l"/></div></figure></div></div>    
</body>
</html>