<html>
<head>
<title>Writing UI Tests Using Page Object Models With NightwatchJS Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用页面对象模型编写UI测试</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/writing-ui-tests-using-page-object-models-with-nightwatchjs-part-ii-da2d15d02322?source=collection_archive---------9-----------------------#2018-03-25">https://medium.com/hackernoon/writing-ui-tests-using-page-object-models-with-nightwatchjs-part-ii-da2d15d02322?source=collection_archive---------9-----------------------#2018-03-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="b0fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我的博客记录了我作为一名技术人员进入硅谷的经历。我是一个有色人种的怪人，性别不合群，移民，曾被收养的年轻人。我来自一个非传统的<a class="ae jp" href="https://hackernoon.com/tagged/coding" rel="noopener ugc nofollow" target="_blank">编码</a>背景。在成为城市公立学校系统的一名教师之前，我在大学里学习了一些CS课程，最终主修了人文学科。向青少年教授web开发让我对编码产生了兴趣。从编程学校毕业后，我开始在旧金山的初创公司工作。我的博客一半是关于技术主题，另一半是关于平等和技术访问(我的旅程)。</p><p id="e960" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我们使用页面<a class="ae jp" href="https://hackernoon.com/tagged/object-model" rel="noopener ugc nofollow" target="_blank">对象模型</a>重写代码之前，让我们让这些测试更有趣一点。让我们<code class="eh jq jr js jt b">validate</code>为链接导航。</p><figure class="ju jv jw jx fq jy"><div class="bz el l di"><div class="jz ka l"/></div></figure><p id="b057" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将测试我们可以点击一个链接，它将导航到新的页面。在这个新页面上，我们将通过在该页面上查找一个项目来验证导航工作。不过这一次，不是用<a class="ae jp" href="http://toolsqa.com/software-testing/manual-testing/" rel="noopener ugc nofollow" target="_blank">手动测试</a>这个过程，而是让我们变得更棒，</p><figure class="ju jv jw jx fq jy"><div class="bz el l di"><div class="kb ka l"/></div></figure><h1 id="6cc8" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated"><a class="ae jp" href="https://smartbear.com/learn/automated-testing/what-is-automated-testing/" rel="noopener ugc nofollow" target="_blank">让我们实现自动化吧！</a></h1><p id="e98b" class="pw-post-body-paragraph ir is hu it b iu la iw ix iy lb ja jb jc lc je jf jg ld ji jj jk le jm jn jo hn dt translated">首先，让我们弄清楚用户需要采取什么步骤来验证我们的测试。不要跳过这一步。这一步非常重要。它允许我们思考我们希望浏览器如何与UI交互。这些步骤将帮助我们在我们的框架中为浏览器编写命令。</p><figure class="ju jv jw jx fq jy"><div class="bz el l di"><div class="lf ka l"/></div></figure><p id="7293" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">手动检查将确保我们的代码工作得更好，更少出错。因此，让我们概述一下浏览器需要接受的命令。</p><p id="4c35" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">浏览器命令—酱实验室页面</p><ol class=""><li id="4378" class="lg lh hu it b iu iv iy iz jc li jg lj jk lk jo ll lm ln lo dt translated">去酱油实验室的网站/导航到它的网址</li><li id="ed52" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">找到链接</li><li id="aaf1" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">单击该链接</li></ol><p id="1213" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">浏览器命令——酱实验室第二页</p><ol class=""><li id="36be" class="lg lh hu it b iu iv iy iz jc li jg lj jk lk jo ll lm ln lo dt translated">转到酱油实验室的第二页/导航到新的网址</li><li id="e020" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">在页面上查找项目</li></ol><p id="e213" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们将命令写入一个页面对象。创建一个名为<code class="eh jq jr js jt b">page_objects</code>的新目录和一个新的Sauce Labs页面对象。</p><pre class="ju jv jw jx fq lu jt lv lw aw lx dt"><span id="298b" class="ly kd hu jt b fv lz ma l mb mc">mkdir -p /test/page_objects &amp;&amp; touch sauceLabs.js</span></pre><p id="4445" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">根据<a class="ae jp" href="http://nightwatchjs.org/guide" rel="noopener ugc nofollow" target="_blank"> Nightwatch的语法，</a>让我们使用一个标准对象。让我们在文件的顶部创建一个命令列表。</p><pre class="ju jv jw jx fq lu jt lv lw aw lx dt"><span id="3718" class="ly kd hu jt b fv lz ma l mb mc">const sauceLabCommands = {<br/>  clickLink: function(){<br/>    this.waitForElementVisible('@link', 1000)<br/>      .waitForElementVisible('@link', 1000)<br/>      .click('@link')<br/>      .api.pause(1000)<br/>    return this;<br/>  }<br/>};<br/><br/>module.exports = {<br/>  commands: [sauceLabCommands],<br/>  url: function() {<br/>    return this.api.launchUrl + '/test/guinea-pig';<br/>  },<br/>  elements: {<br/>    link: {<br/>      selector: 'a[href="/test-guinea-pig2.html"]'<br/>    }<br/>  }<br/>};</span></pre><p id="743f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们告诉NightwatchJS我们的页面对象在哪里，以及我们希望它打开的url。</p><pre class="ju jv jw jx fq lu jt lv lw aw lx dt"><span id="49d0" class="ly kd hu jt b fv lz ma l mb mc">"src_folders": [<br/>  "test/ui_tests"<br/>],<br/>"page_objects_path": "test/page_objects",</span><span id="ecae" class="ly kd hu jt b fv md ma l mb mc">//the google url<br/>"test_settings": {<br/>  "default": {<br/>    "launch_url": "https://saucelabs.com",</span></pre><p id="16ba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是我们目前的测试。</p><pre class="ju jv jw jx fq lu jt lv lw aw lx dt"><span id="6973" class="ly kd hu jt b fv lz ma l mb mc">module.exports = {<br/>  "Validate Sauce Labs' Page Title": function(browser) {<br/>     browser<br/>       .url('https://saucelabs.com')<br/>       .waitForElementVisible('body')<br/>       .assert.title('I am a page title - Sauce Labs')<br/>       .saveScreenshot('saucelabs.png')<br/>       .end();  <br/>   }<br/>};</span></pre><p id="8650" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们创建两个测试，一个验证Sauce Labs的页面已经加载，另一个验证Sauce Labs的链接。让我们重写它来使用我们的页面对象。</p><pre class="ju jv jw jx fq lu jt lv lw aw lx dt"><span id="e420" class="ly kd hu jt b fv lz ma l mb mc">require('../../nightwatch.conf.js');<br/><br/>module.exports = {<br/>  "Validate Sauce Labs' Page Has Loaded": function(browser) {<br/>    const sauceLabs = browser.page.sauceLabs();<br/><br/>    sauceLabs.navigate()<br/>      .waitForElementVisible('body', 1000)<br/>      .assert.title('I am a page title - Sauce Labs')<br/>  },<br/><br/>  "Validate Sauce Labs' Link Navigation": function(browser) {<br/>    const sauceLabs = browser.page.sauceLabs();<br/><br/>    sauceLabs.navigate()<br/>      .waitForElementVisible('@link', 1000)<br/>      .clickLink();<br/><br/>//navigate to the new page<br/>//search for an element on that new page</span><span id="cd8f" class="ly kd hu jt b fv md ma l mb mc">  }<br/>};</span></pre><p id="f199" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们还没完。我们必须确保能够导航到搜索结果页面对象。让我们为搜索结果创建一个页面对象。</p><pre class="ju jv jw jx fq lu jt lv lw aw lx dt"><span id="447f" class="ly kd hu jt b fv lz ma l mb mc">cd page_objects<br/>touch sauceLabsTwo.js</span></pre><p id="732a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们编写新的<code class="eh jq jr js jt b">sauceLabsTwo</code>页面对象。</p><pre class="ju jv jw jx fq lu jt lv lw aw lx dt"><span id="884e" class="ly kd hu jt b fv lz ma l mb mc">module.exports = {<br/>  url: function() {<br/>    return this.api.launchUrl + '/test-guinea-pig2.html';<br/>  },<br/>  elements: {<br/>    div: {<br/>      selector:<br/>        '#i_am_an_id'<br/>    }<br/>  }<br/>};</span></pre><p id="8602" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们完成2个测试的代码编写。</p><pre class="ju jv jw jx fq lu jt lv lw aw lx dt"><span id="f28b" class="ly kd hu jt b fv lz ma l mb mc">//navigate to the new page<br/>const sauceLabs2 = browser.page.sauceLabsTwo();</span><span id="7445" class="ly kd hu jt b fv md ma l mb mc">//search for an element on that new page<br/>sauceLabs2<br/>  .waitForElementVisible('@div', 1000)<br/>  .assert.visible('@div');</span><span id="16f4" class="ly kd hu jt b fv md ma l mb mc">browser.end();</span></pre><p id="2191" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好了，让我们开始测试吧</p><pre class="ju jv jw jx fq lu jt lv lw aw lx dt"><span id="97a9" class="ly kd hu jt b fv lz ma l mb mc">npm test</span></pre><p id="bb4b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您应该看到一个自动浏览器打开，单击一个链接并导航到一个新页面。如果一切顺利，您应该会看到通过测试的绿色检查！</p><figure class="ju jv jw jx fq jy"><div class="bz el l di"><div class="me ka l"/></div></figure><figure class="ju jv jw jx fq jy"><div class="bz el l di"><div class="mf ka l"/></div></figure></div></div>    
</body>
</html>