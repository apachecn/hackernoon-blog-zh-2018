<html>
<head>
<title>How and why I built Hamoni Sync — A realtime app state synchronisation SDK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何和为什么构建Hamoni Sync——一个实时应用状态同步SDK</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/https-medium-com-pmbanugo-how-and-why-i-built-hamoni-sync-3951aba4bdf3?source=collection_archive---------32-----------------------#2018-03-27">https://medium.com/hackernoon/https-medium-com-pmbanugo-how-and-why-i-built-hamoni-sync-3951aba4bdf3?source=collection_archive---------32-----------------------#2018-03-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/c48413e8a336653e256bbd63878b7c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGFfcxgKT-tK4Sdk-Xq4_A.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/photos/yEAOfWSdzgM?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Pankaj Patel</a> on <a class="ae jg" href="https://unsplash.com/search/photos/vs-code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0ed1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">实时应用无处不在。从即时通讯应用到文档协作软件和游戏。您可能已经使用开源库构建了应用程序，如<a class="ae jg" href="https://www.asp.net/signalr" rel="noopener ugc nofollow" target="_blank"> SignalR </a>、<a class="ae jg" href="https://socket.io/" rel="noopener ugc nofollow" target="_blank"> SocketIO </a>或其他一些商业产品。我使用过SignalR和SocketIO，最近在最近的ProductHunt黑客马拉松中用SocketIO构建了一个<a class="ae jg" href="https://www.producthunt.com/upcoming/hamoni" rel="noopener ugc nofollow" target="_blank">聊天SDK </a>。</p><h1 id="8ced" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">我想解决的问题</h1><p id="2ce3" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">过去，我和一些同事不得不围绕SocketIO和SignalR等实时引擎设计状态逻辑。大多数情况下，这是一个需要实时仪表板的项目。这些实现有相似的逻辑或架构，感觉像是从头开始重复设计。我想要一种方法:</p><ol class=""><li id="121d" class="li lj hu jj b jk jl jo jp js lk jw ll ka lm ke ln lo lp lq dt translated">轻松将实时状态同步添加到任何应用程序。</li><li id="6ac7" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">避免围绕插座室和事件从头开始设计，以及处理客户端断开连接和重新连接时发生的情况。</li><li id="f269" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">一个我可以集成到移动和网络应用中的SDK。</li><li id="a87d" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">处理基础设施问题的服务。</li></ol><h1 id="72b4" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">我建造的东西</h1><p id="f12d" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">所以我构建了<a class="ae jg" href="https://www.hamoni.tech/" rel="noopener ugc nofollow" target="_blank"> Hamoni Sync </a>，一个作为服务的实时状态同步。</p><p id="1699" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">它提供了SDK来为web或移动设备添加实时状态同步。我当时只做了web SDK。它将您的应用程序状态保存在云中，并可以作为您的应用程序的真实来源。当客户端重新连接时，它会与服务器重新同步。</p><p id="6c88" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">您可以使用它来实时同步您的应用程序状态。您可以构建实时仪表盘，管理游戏排行榜或任何其他游戏状态，以及实时数据可视化或图表。</p><h1 id="c4b9" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">技术堆栈</h1><p id="f077" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">在构建过程中，我使用了ReactJS、NodeJS、RollUp、SocketIO、CouchDB、AWS Lambda、AWS API Gateway、Amazon Cognito、AWS Amplify、AWS ElasticBeanstalk、Gitbook、Git。</p><ol class=""><li id="4a50" class="li lj hu jj b jk jl jo jp js lk jw ll ka lm ke ln lo lp lq dt translated"><strong class="jj hv">源码控制</strong>:我用的是Git和GitLab。我使用GitLab是因为免费计划允许我拥有私有库。</li><li id="dfc4" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated"><strong class="jj hv">数据库</strong>:我需要一个NoSQL，并选择了CouchDB，因为它有一个冲突解决策略，我想以后用它来处理这个项目的自动冲突解决。我使用IBM Cloudant的托管CouchDB实例，因为我不想自己管理数据库。</li><li id="559a" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">后端:有几个开源的实时引擎，SocketIO似乎更受欢迎。我选择SocketIO是因为我熟悉SocketIO，它有Swift和Java的客户端库，我想用它们来构建这些语言的SDK，这样我的解决方案就可以在移动设备上运行。我还使用AWS Lambda和API gateway来构建仪表板使用的API。我假设我会对实时系统和API有不同的伸缩需求，所以我不想把它们放在同一个服务器上。为了节省成本，我将它们分开并使用了无服务器架构。</li><li id="72bd" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated"><strong class="jj hv">前端</strong>:我在用<a class="ae jg" href="https://mdbootstrap.com/react" rel="noopener ugc nofollow" target="_blank"> MDB Bootstrap </a>的React with Material Design组件。我想到了使用Preact，但决定使用react，因为AWS Amplify有一个React的集成包，我需要用它来管理web应用程序的认证逻辑。它也可以和Preact一起工作，但是我不想花时间去尝试看看它是否工作。</li><li id="50ea" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated"><strong class="jj hv">认证</strong>:我用的是亚马逊Cognito和AWS Amplify。Amazon Cognito用于用户帐户管理，并作为一个库来处理React应用程序中的身份验证。使用这些服务轻而易举。</li><li id="8ce9" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated"><strong class="jj hv">文档</strong>:我正在用SDK构建一个服务，所以它需要有好的文档。我问过WeAllJS slack组的人，他们给了我一些选择。其中一个人继续做了一个<a class="ae jg" href="https://github.com/jenniferlynparsons/awesome-writing" rel="noopener ugc nofollow" target="_blank">工具清单</a>来考虑。我不得不在<a class="ae jg" href="https://www.gitbook.com/" rel="noopener ugc nofollow" target="_blank"> Gitbook </a>、<a class="ae jg" href="http://www.sphinx-doc.org/en/stable/" rel="noopener ugc nofollow" target="_blank">斯芬克斯</a>和<a class="ae jg" href="https://github.com/lord/slate" rel="noopener ugc nofollow" target="_blank">石板</a>之间做出选择。Sphinx要求我安装我不使用的工具，而且我当时也不想学习重构的文本格式。Gitbook和Slate支持我所熟悉的markdown。我使用Gitbook是因为我喜欢它的显示方式，并且允许我应用主题。我想在我的下一个项目中，我会尝试slate，因为它易于使用和设置。</li><li id="e873" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated"><strong class="jj hv">云提供商</strong>:我使用AWS是因为我通过参加ProductHunt黑客马拉松获得了1000美元的积分。我还使用IBM Cloudant作为托管数据库提供商。</li><li id="10aa" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">托管:我从get.tech购买了域名，并使用Netlify托管网站、文档和仪表板。</li><li id="bc1a" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated"><strong class="jj hv"> SDK打包</strong>:我用ES6写了我的代码，用Babel trans pile到ES5。我使用RollUp来捆绑它，以便在浏览器中使用。我认为汇总文档使入门变得容易，它最适合库作者打包他们的库。我不记得第一次尝试Webpack时有这么简单。</li></ol><h1 id="cfa0" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">建造的过程</h1><p id="a1e7" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">我在3月1日开始着手这个项目，目标是在3月23日完成所有的工作并发布。那总共是20天，因为我星期天不工作。</p><p id="429d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我从仪表板开始。用create-react-app和一个材质设计react库引导前端。添加了与Amazon Cognito和AWS Amplify的认证。然后，我创建了通过API gateway公开的Lambda函数，用于创建和查看应用程序。</p><p id="0468" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">完成后，我转移到JavaScript SDK和后端工作。我编写了第一个特性，它允许创建我称之为值原语的东西。它花了大约8个小时来建立，然后使它更容易使其余的目标功能。截至3月10日，我已经有了预期的功能。</p><p id="03e4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">随着主要功能的运行，接下来的事情是创建一个样例应用程序和文档来指导人们如何使用该产品。我花了几天时间完成文档的初稿。到3月17日，我已经完成了文档并制作了2个示例应用程序。编写代码似乎是容易的部分。编写文档比我计划的时间稍长。鉴于目前的进展，剩下的工作就是部署到生产环境中。我买了一个域名，并使用Netlify部署了网站和仪表盘。然后，我完成了部署到AWS和发布到npm。</p><h1 id="5d6e" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">我面临的挑战</h1><p id="c382" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">这段旅程中最困难的部分是通过文档和网站找到合适的词语来传达项目的意图。学习和使用我在这个项目中使用的AWS服务也很困难。AWS Cognito和Amplify并不难用，但其他的很难用。也许文档对我来说很难理解。</p><h1 id="2912" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">主要学习内容</h1><p id="ae0b" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">关键的学习是知道如何使用各种AWS服务。我还必须学习使用RollUp来打包JavaScript模块，以及如何部署到npm。如果我有什么不同的做法，那就是使用不同的React组件进行材质设计，可能还会使用Slate进行文档记录。</p><h1 id="4bd8" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">最后的想法和下一步</h1><p id="78dc" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">旅途很有趣，我学到了很多。我期待着看到这个项目如何起飞。我将继续努力，因为我已经为它计划了其他功能，例如，允许用户看到一个应用程序的当前连接数。我希望得到反馈，看看人们如何使用它，以及他们希望看到增加或删除哪些功能。</p><p id="233f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">尝试一下，给你的应用一个实时提升！随时联系，让我知道你的想法。</p><p id="9115" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">查看<a class="ae jg" href="https://docs.hamoni.tech/quick-start/javascript-quickstart.html" rel="noopener ugc nofollow" target="_blank">快速入门指南</a>查看工作示例</p><h1 id="a35e" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">链接</h1><ul class=""><li id="9ce5" class="li lj hu jj b jk ld jo le js lw jw lx ka ly ke lz lo lp lq dt translated"><a class="ae jg" href="https://www.hamoni.tech/" rel="noopener ugc nofollow" target="_blank">网站</a>🚀</li><li id="6e0c" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke lz lo lp lq dt translated"><a class="ae jg" href="https://docs.hamoni.tech/" rel="noopener ugc nofollow" target="_blank">文档</a></li><li id="62ab" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke lz lo lp lq dt translated"><a class="ae jg" href="https://docs.hamoni.tech/quick-start/javascript-quickstart.html" rel="noopener ugc nofollow" target="_blank">快速入门指南</a></li></ul></div></div>    
</body>
</html>