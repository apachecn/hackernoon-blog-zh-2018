<html>
<head>
<title>Building simple Point of Sale system with Node.js &amp; React.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Node.js &amp; React.js构建简单的销售点系统</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-simple-point-of-sale-system-with-node-js-react-js-a0e51059ba33?source=collection_archive---------1-----------------------#2018-03-31">https://medium.com/hackernoon/building-simple-point-of-sale-system-with-node-js-react-js-a0e51059ba33?source=collection_archive---------1-----------------------#2018-03-31</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/cd828588205272e70ec797e0d0a09de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Stdu1qSeLpGv_oKI7lDtBA.png"/></div></div></figure><figure class="jd je jf jg fq iv fe ff paragraph-image"><a href="https://a.paddle.com/v2/click/16413/40334?link=1227"><div class="fe ff jc"><img src="../Images/6802842226d0a799c5729f09590db3a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PWGRrB_SaEUlnfe_4RhxQ.png"/></div></a></figure><p id="ff6b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">构建实时应用程序是令人兴奋的，我一直对无需重新加载就能更新页面的想法很感兴趣。在本教程中，我们将使用node.js和react.js创建一个实时销售点系统</p><p id="ee71" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae kf" href="https://github.com/krissnawat/simple-pos-in-node" rel="noopener ugc nofollow" target="_blank">获取源代码</a>并在此查看<a class="ae kf" href="http://mysterious-plateau-79413.herokuapp.com" rel="noopener ugc nofollow" target="_blank">演示</a></p><p id="c369" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">本教程将包括三个部分:</p><p id="072c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">第一部分(后端)</strong></p><ol class=""><li id="c096" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke kl km kn ko dt translated">框架描述</li><li id="8d6e" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">从头开始构建节点应用程序</li><li id="6ec6" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">邮递员测试</li></ol><p id="4d3d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">第二部分(前端)</strong> <br/> 1。创建模板React应用程序。<br/> 2。使用代码描述创建路线和视图。</p><p id="e3fd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于本教程，我推荐使用<a class="ae kf" href="https://code.visualstudio.com/download" rel="noopener ugc nofollow" target="_blank"> Vscode编辑器</a>。</p><p id="28c9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">框架描述和安装</strong></p><p id="d94d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">下面是我们将使用的库和框架:</p><p id="db51" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae kf" href="https://github.com/louischatriot/nedb" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv"> nedb </strong> </a> : NeDB与SQLite非常相似，它是一个更大的数据库系统的较小的可嵌入版本。NeDB是一个模仿MongoDB的较小的NoSQL数据存储。</p><p id="69d4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae kf" href="https://socket.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jj hv">Socket . io</strong></a>:Socket。IO支持基于事件的实时双向通信。它可以在任何平台、浏览器或设备上运行，同样注重可靠性和速度。<br/><a class="ae kf" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jj hv">express</strong></a>:Express是Node.js的一个快速、非个性化、极简的web框架，Express的特性将使我们能够创建我们的web服务器。<br/><strong class="jj hv">async</strong><br/><a class="ae kf" href="https://nodemon.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jj hv">Nodemon</strong></a>:Nodemon检查源代码中的更改，并自动重启服务器。<br/><strong class="jj hv">body-parser</strong>:body-parser提取传入请求流的整个主体部分，并在req.body上公开它。<br/> <strong class="jj hv"> http </strong> : http允许Node.js通过超文本传输协议(Http)传输数据。</p><p id="2066" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们继续用node.js创建后端，我假设您已经安装了<a class="ae kf" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">节点和NPM</a>。</p><p id="ea0d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">**从头开始构建节点应用**</p><p id="564a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在本教程中，我们将从头开始创建节点应用程序(快速应用程序)。也可以使用<a class="ae kf" href="http://www.embeddedjs.com/" rel="noopener ugc nofollow" target="_blank"> ejs模板</a>自动完成。</p><p id="d9ac" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">通过命令行界面(CLI)创建一个名为<code class="eh ku kv kw kx b">real-time-pos-system</code>的目录</p><p id="df91" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">mkdir real-rime-pos-system</code></p><p id="feff" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">通过CLI访问文件夹，因此:</p><p id="e722" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">cd real-time-pos-system</code></p><p id="34a8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在你的<code class="eh ku kv kw kx b">real-time-pos-system</code>文件夹中，从命令行创建名为<code class="eh ku kv kw kx b">server</code>的新文件夹</p><p id="bdc3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">mkdir server</code></p><p id="1757" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们安装我们的依赖项:</p><p id="94d2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">npm init</code></p><p id="45d9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">按下<code class="eh ku kv kw kx b">enter</code>按钮，询问以下问题:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="9bf0" class="lc ld hu kx b fv le lf l lg lh">package name: (server) Press Enter<br/>version: (1.0.0) Press Enter<br/>description:    Node.js app that connect the react-pos app to the Database <br/>entry point:(index.js) Press Enter<br/>test command:     Press Enter<br/>git repository: Press Enter<br/>keywords:   Press Enter<br/>author: Enter Your Name<br/>license: (ISC) MIT</span></pre><p id="5ba1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">您将看到以下消息:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="bef9" class="lc ld hu kx b fv le lf l lg lh">{<br/>    "name": "server"<br/>    version: "1.0.0"<br/>    "description": "Node.js app that connect the react-pos app to the Database <br/>    "main" : "index.js",<br/>    "scripts": {<br/>       test": "echo \"Error: no test specified\ specified\" &amp;&amp; exit 1"<br/>},<br/>"author": "Your Name",<br/>"license": "MIT"<br/>}</span><span id="bf2b" class="lc ld hu kx b fv li lf l lg lh">Is this ok?(yes) yes</span></pre><p id="fbca" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">安装以下依赖项</strong>:</p><p id="bbbf" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">npm install express --save</code></p><p id="8904" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">npm install http --save</code></p><p id="8bc5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">npm install nodemon --save</code></p><p id="2b83" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">npm install nedb --save</code></p><p id="9fed" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">使用编辑器在<code class="eh ku kv kw kx b">real-time-pos-system</code>文件夹中创建一个名为<code class="eh ku kv kw kx b">index.js</code>的文件。</p><p id="8b48" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">index.js</code>是我们的node应用程序的入口点，正如你所看到的，它位于我们应用程序的根目录中。</p><p id="2279" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在您的<code class="eh ku kv kw kx b">index.js</code>文件中插入以下代码</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="c2d6" class="lc ld hu kx b fv le lf l lg lh">var express = require("express"),<br/>  http = require("http"),<br/>  port = 80,<br/>  app = require("express")(),<br/>  server = http.createServer(app),<br/>  bodyParser = require("body-parser"),<br/>  io = require("socket.io")(server),<br/>  liveCart;</span><span id="d79c" class="lc ld hu kx b fv li lf l lg lh">console.log("Real time POS running");<br/>console.log("Server started");<br/>app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: false }));</span><span id="aa70" class="lc ld hu kx b fv li lf l lg lh">app.all("/*", function(req, res, next) {<br/>  // CORS headers<br/>  res.header("Access-Control-Allow-Origin", "*"); // restrict it to the required domain<br/>  res.header("Access-Control-Allow-Methods", "GET,PUT,POST,DELETE,OPTIONS");<br/>  // Set custom headers for CORS<br/>  res.header(<br/>    "Access-Control-Allow-Headers",<br/>    "Content-type,Accept,X-Access-Token,X-Key"<br/>  );<br/>  if (req.method == "OPTIONS") {<br/>    res.status(200).end();<br/>  } else {<br/>    next();<br/>  }<br/>});</span><span id="8605" class="lc ld hu kx b fv li lf l lg lh">app.get("/", function(req, res) {<br/>  res.send(" Real time POS web app running.");<br/>});</span><span id="32a0" class="lc ld hu kx b fv li lf l lg lh">app.use("/api/inventory", require("./api/inventory"));<br/>app.use("/api", require("./api/transactions"));</span><span id="7c39" class="lc ld hu kx b fv li lf l lg lh">// Websocket logic for Live Cart<br/>io.on("connection", function(socket) {<br/>  socket.on("cart-transaction-complete", function() {<br/>    socket.broadcast.emit("update-live-cart-display", {});<br/>  });</span><span id="3b8a" class="lc ld hu kx b fv li lf l lg lh">  // on page load, show user current cart<br/>  socket.on("live-cart-page-loaded", function() {<br/>    socket.emit("update-live-cart-display", liveCart);<br/>  });</span><span id="09a7" class="lc ld hu kx b fv li lf l lg lh">  // when client connected, make client update live cart<br/>  socket.emit("update-live-cart-display", liveCart);</span><span id="6e10" class="lc ld hu kx b fv li lf l lg lh">  // when the cart data is updated by the POS<br/>  socket.on("update-live-cart", function(cartData) {<br/>    // keep track of it<br/>    liveCart = cartData;</span><span id="9535" class="lc ld hu kx b fv li lf l lg lh">    // broadcast updated live cart to all websocket clients<br/>    socket.broadcast.emit("update-live-cart-display", liveCart);<br/>  });<br/>});</span><span id="da1f" class="lc ld hu kx b fv li lf l lg lh">server.listen(port, () =&gt; console.log(`Listening on port ${port}`));</span></pre><p id="bc67" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> index.js解释</strong></p><p id="ad49" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个文件是我们的node express应用程序的入口点。它由处理浏览器的请求和响应的路由组成。</p><p id="a398" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">下面是分配给变量的依赖关系。</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="c563" class="lc ld hu kx b fv le lf l lg lh">var express = require("express"),<br/>  http = require("http"),<br/>  port = 80,<br/>  app = require("express")(),<br/>  server = http.createServer(app),<br/>  bodyParser = require("body-parser"),<br/>  io = require("socket.io")(server),<br/>  liveCart</span></pre><p id="0ea2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">下面，express变量<code class="eh ku kv kw kx b">app</code>用于允许使用http请求体将数据发送到数据库。</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="090a" class="lc ld hu kx b fv le lf l lg lh">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: false }))</span></pre><p id="e3c3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">以下是代表库存和交易路线的导入文件。</p><p id="80e1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.use("/api/inventory", require("./api/inventory"))</code></p><p id="06b1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.use("/api/transactions", require("./api/transactions"))</code></p><p id="d666" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">跨源资源共享(CORS)是一种机制，它允许从提供第一资源的域之外的另一个域请求网页上的受限资源(例如字体)。—维基百科</p><figure class="jd je jf jg fq iv fe ff paragraph-image"><a href="https://amzn.to/2BOts8x"><div class="ab fr cl lj"><img src="../Images/18c7abf777f18063c845ba31e19476cd.png" data-original-src="https://miro.medium.com/v2/format:webp/1*YSpYdwS1LyEJIgUtMnDYxg.png"/></div></a></figure><p id="6936" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">下面，节点应用程序被限制为使用CORS内的资源，并允许使用指定的方法<code class="eh ku kv kw kx b">GET</code> <code class="eh ku kv kw kx b">PUT</code> <code class="eh ku kv kw kx b">POST</code> <code class="eh ku kv kw kx b">DELETE</code>和<code class="eh ku kv kw kx b">OPTIONS</code>。</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="0974" class="lc ld hu kx b fv le lf l lg lh">app.all("/*", function(req, res, next) {<br/>  // CORS headers<br/>  res.header("Access-Control-Allow-Origin", "*"); // restrict it to the required domain<br/>  res.header("Access-Control-Allow-Methods", "GET,PUT,POST,DELETE,OPTIONS");<br/>  // Set custom headers for CORS<br/>  res.header(<br/>    "Access-Control-Allow-Headers",<br/>    "Content-type,Accept,X-Access-Token,X-Key"<br/>  );<br/>  if (req.method == "OPTIONS") {<br/>    res.status(200).end();<br/>  } else {<br/>    next();<br/>  }<br/>});</span></pre><p id="1c54" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">下面是节点app默认路由</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="d2c9" class="lc ld hu kx b fv le lf l lg lh">app.get("/", function(req, res) {<br/>  res.send(" Real time POS web app running.");<br/>});</span></pre><p id="2798" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Live Cart的Websocket逻辑</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="5e21" class="lc ld hu kx b fv le lf l lg lh">io.on("connection", function(socket) {<br/>  socket.on("cart-transaction-complete", function() {<br/>    socket.broadcast.emit("update-live-cart-display", {});<br/>  });</span></pre><p id="92ef" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在页面加载时，给用户当前购物车</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="e0ac" class="lc ld hu kx b fv le lf l lg lh">socket.on("live-cart-page-loaded", function() {<br/>    socket.emit("update-live-cart-display", liveCart);<br/>  });</span></pre><p id="efeb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在页面加载时，让客户端更新实时购物车</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="6d79" class="lc ld hu kx b fv le lf l lg lh">socket.emit("update-live-cart-display", liveCart)</span></pre><p id="f9a7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">当购物车数据被POS更新并跟踪它时</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="24d5" class="lc ld hu kx b fv le lf l lg lh">socket.on("update-live-cart", function(cartData) {<br/>    liveCart = cartData;</span></pre><p id="4ae3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">向所有websocket客户端广播更新的实时购物车</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="22ab" class="lc ld hu kx b fv le lf l lg lh">socket.broadcast.emit("update-live-cart-display", liveCart);<br/> });</span></pre><p id="5b9a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们继续，在<code class="eh ku kv kw kx b">server</code>目录中创建一个目录:</p><p id="658d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">mkdir api</code></p><p id="3140" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在api文件夹中创建两个名为<code class="eh ku kv kw kx b">inventory.js</code>和<code class="eh ku kv kw kx b">transactions.js</code>的文件</p><p id="83aa" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">将下面的代码插入到您的<code class="eh ku kv kw kx b">inventory.js</code>中:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="a41c" class="lc ld hu kx b fv le lf l lg lh">var app = require("express")();<br/>var server = require("http").Server(app);<br/>var bodyParser = require("body-parser");<br/>var Datastore = require("nedb");<br/>var async = require("async");</span><span id="d7be" class="lc ld hu kx b fv li lf l lg lh">app.use(bodyParser.json());</span><span id="4c07" class="lc ld hu kx b fv li lf l lg lh">module.exports = app;</span><span id="4880" class="lc ld hu kx b fv li lf l lg lh">// Creates  Database<br/>var inventoryDB = new Datastore({<br/>  filename: "./server/databases/inventory.db",<br/>  autoload: true<br/>});</span><span id="744f" class="lc ld hu kx b fv li lf l lg lh">// GET inventory<br/>app.get("/", function(req, res) {<br/>  res.send("Inventory API");<br/>});</span><span id="7057" class="lc ld hu kx b fv li lf l lg lh">// GET a product from inventory by _id<br/>app.get("/product/:productId", function(req, res) {<br/>  if (!req.params.productId) {<br/>    res.status(500).send("ID field is required.");<br/>  } else {<br/>    inventoryDB.findOne({ _id: req.params.productId }, function(err, product) {<br/>      res.send(product);<br/>    });<br/>  }<br/>});</span><span id="4746" class="lc ld hu kx b fv li lf l lg lh">// GET all inventory products<br/>app.get("/products", function(req, res) {<br/>  inventoryDB.find({}, function(err, docs) {<br/>    console.log("sending inventory products");<br/>    res.send(docs);<br/>  });<br/>});</span><span id="3dc3" class="lc ld hu kx b fv li lf l lg lh">// Create inventory product<br/>app.post("/product", function(req, res) {<br/>  var newProduct = req.body;</span><span id="3ce2" class="lc ld hu kx b fv li lf l lg lh">  inventoryDB.insert(newProduct, function(err, product) {<br/>    if (err) res.status(500).send(err);<br/>    else res.send(product);<br/>  });<br/>});</span><span id="1d29" class="lc ld hu kx b fv li lf l lg lh">app.delete("/product/:productId", function(req, res) {<br/>  inventoryDB.remove({ _id: req.params.productId }, function(err, numRemoved) {<br/>    if (err) res.status(500).send(err);<br/>    else res.sendStatus(200);<br/>  });<br/>});</span><span id="1c04" class="lc ld hu kx b fv li lf l lg lh">// Updates inventory product<br/>app.put("/product", function(req, res) {<br/>  var productId = req.body._id;</span><span id="d0f0" class="lc ld hu kx b fv li lf l lg lh">  inventoryDB.update({ _id: productId }, req.body, {}, function(<br/>    err,<br/>    numReplaced,<br/>    product<br/>  ) {<br/>    if (err) res.status(500).send(err);<br/>    else res.sendStatus(200);<br/>  });<br/>});</span><span id="2dac" class="lc ld hu kx b fv li lf l lg lh">app.decrementInventory = function(products) {<br/>  async.eachSeries(products, function(transactionProduct, callback) {<br/>    inventoryDB.findOne({ _id: transactionProduct._id }, function(<br/>      err,<br/>      product<br/>    ) {<br/>      // catch manually added items (don't exist in inventory)<br/>      if (!product || !product.quantity_on_hand) {<br/>        callback();<br/>      } else {<br/>        var updatedQuantity =<br/>          parseInt(product.quantity_on_hand) -<br/>          parseInt(transactionProduct.quantity);</span><span id="5ea7" class="lc ld hu kx b fv li lf l lg lh">        inventoryDB.update(<br/>          { _id: product._id },<br/>          { $set: { quantity_on_hand: updatedQuantity } },<br/>          {},<br/>          callback<br/>        );<br/>      }<br/>    });<br/>  });<br/>};</span></pre><p id="036e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> inventory.js解释</strong> <br/>将必要的依赖关系赋给变量<code class="eh ku kv kw kx b">app</code>、<code class="eh ku kv kw kx b">server</code>、<code class="eh ku kv kw kx b">bodyParser</code>和<code class="eh ku kv kw kx b">Datastore</code>。<code class="eh ku kv kw kx b">app.use(bodyParser.json())</code>将允许http请求的主体发送到数据库。</p><p id="12d2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">一个库存变量<code class="eh ku kv kw kx b">inventoryDB</code>被赋予一个我们之前创建的<br/> <strong class="jj hv"> nedb </strong>变量<code class="eh ku kv kw kx b">Datastore</code>的实例。<code class="eh ku kv kw kx b">DataStore</code> <br/>实例有两个选项<code class="eh ku kv kw kx b">filename</code>指定数据库的路径和自动加载，如果设置为true，自动加载数据库。</p><p id="c63d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.get("/, function(req, res)</code>功能是库存数据库的默认路径。</p><p id="3b50" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.get("/product/:/productId</code>功能使应用程序能够使用其ID从库存数据库中获取产品。</p><p id="4531" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.get("/products", function(req, res)</code>函数从库存数据库中获取所有产品。</p><p id="facb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.post("/product", function(req, res)</code>功能用于将库存产品保存到数据库中。</p><p id="c943" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.delete("/product/:productId", function(req, res)</code>用于删除使用产品ID的产品。</p><p id="3453" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.put("/product", function(req, res)</code>使用产品ID更新产品。</p><p id="5b8b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们继续，将以下代码插入到您的<code class="eh ku kv kw kx b">transaction.js</code>文件中:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="1628" class="lc ld hu kx b fv le lf l lg lh">var app 	= require('express')()<br/>var server 	= require('http').Server(app)<br/>var bodyParser = require('body-parser')<br/>var Datastore = require('nedb')</span><span id="bd9d" class="lc ld hu kx b fv li lf l lg lh">var Inventory = require('./inventory')</span><span id="43ea" class="lc ld hu kx b fv li lf l lg lh">app.use(bodyParser.json())</span><span id="7112" class="lc ld hu kx b fv li lf l lg lh">module.exports = app</span><span id="bd29" class="lc ld hu kx b fv li lf l lg lh">// Create Database<br/>var Transactions = new Datastore({ <br/>	filename: './server/databases/transactions.db', <br/>	autoload: true <br/>})</span><span id="32bf" class="lc ld hu kx b fv li lf l lg lh">app.get('/', function (req, res) {<br/>	res.send('Transactions API')<br/>})</span><span id="c4eb" class="lc ld hu kx b fv li lf l lg lh">// GET all transactions<br/>app.get('/all', function (req, res) {</span><span id="d683" class="lc ld hu kx b fv li lf l lg lh">	Transactions.find({}, function (err, docs) {<br/>		res.send(docs)<br/>	})<br/>})</span><span id="d182" class="lc ld hu kx b fv li lf l lg lh">// GET all transactions<br/>app.get('/limit', function (req, res) {</span><span id="39db" class="lc ld hu kx b fv li lf l lg lh">	var limit = parseInt(req.query.limit, 10)<br/>	if (!limit) limit = 5</span><span id="27a9" class="lc ld hu kx b fv li lf l lg lh">	Transactions.find({}).limit(limit).sort({ date: -1 }).exec(function (err, docs) {<br/>	  res.send(docs)<br/>	})<br/>})</span><span id="c8d9" class="lc ld hu kx b fv li lf l lg lh">// GET total sales for the current day<br/>app.get('/day-total', function (req, res) {</span><span id="4df5" class="lc ld hu kx b fv li lf l lg lh">	// if date is provided<br/>	if (req.query.date) {<br/>		startDate = new Date(req.query.date)<br/>		startDate.setHours(0,0,0,0)</span><span id="5296" class="lc ld hu kx b fv li lf l lg lh">		endDate = new Date(req.query.date)<br/>		endDate.setHours(23,59,59,999)<br/>	}<br/>	else {</span><span id="e876" class="lc ld hu kx b fv li lf l lg lh">		// beginning of current day<br/>		var startDate = new Date()<br/>		startDate.setHours(0,0,0,0)</span><span id="1300" class="lc ld hu kx b fv li lf l lg lh">		// end of current day<br/>		var endDate = new Date()<br/>		endDate.setHours(23,59,59,999)	<br/>	}<br/></span><span id="7655" class="lc ld hu kx b fv li lf l lg lh">	Transactions.find({ date: { $gte: startDate.toJSON(), $lte: endDate.toJSON() } }, function (err, docs) {<br/>		<br/>		var result = {<br/>			date: startDate<br/>		}</span><span id="404a" class="lc ld hu kx b fv li lf l lg lh">		if (docs) {</span><span id="55a6" class="lc ld hu kx b fv li lf l lg lh">			var total = docs.reduce(function (p, c) {<br/>				return p + c.total<br/>			}, 0.00)</span><span id="d0e1" class="lc ld hu kx b fv li lf l lg lh">			result.total = parseFloat(parseFloat(total).toFixed(2))</span><span id="1bea" class="lc ld hu kx b fv li lf l lg lh">			res.send(result)<br/>		}<br/>		else {<br/>			result.total = 0<br/>			res.send(result)<br/>		}<br/>	})	<br/>})</span><span id="10e4" class="lc ld hu kx b fv li lf l lg lh">// GET transactions for a particular date<br/>app.get('/by-date', function (req, res) {<br/>	<br/>	var startDate = new Date(2018, 2, 21)<br/>	startDate.setHours(0,0,0,0)</span><span id="73ce" class="lc ld hu kx b fv li lf l lg lh">	var endDate = new Date(2015, 2, 21)<br/>	endDate.setHours(23,59,59,999)</span><span id="65ec" class="lc ld hu kx b fv li lf l lg lh">	Transactions.find({ date: { $gte: startDate.toJSON(), $lte: endDate.toJSON() } }, function (err, docs) {<br/>		if (docs)<br/>			res.send(docs)<br/>	})<br/>})</span><span id="4369" class="lc ld hu kx b fv li lf l lg lh">// Add new transaction<br/>app.post('/new', function (req, res) {</span><span id="7433" class="lc ld hu kx b fv li lf l lg lh">	var newTransaction = req.body<br/>	<br/>	Transactions.insert(newTransaction, function (err, transaction) {<br/>		if (err) <br/>			res.status(500).send(err)<br/>		else {<br/>			res.sendStatus(200)<br/>			Inventory.decrementInventory(transaction.products)<br/>		} <br/>	})<br/>})</span><span id="0376" class="lc ld hu kx b fv li lf l lg lh">// GET a single transaction<br/>app.get('/:transactionId', function (req, res) {</span><span id="dbc6" class="lc ld hu kx b fv li lf l lg lh">	Transactions.find({ _id: req.params.transactionId }, function (err, doc) {<br/>		if (doc)<br/>			res.send(doc[0])<br/>	})<br/>})</span></pre><p id="d16b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> transaction.js解释</strong> <br/>必要的依赖关系如前所述被分配给变量。</p><p id="d5e3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如前所述，使用<strong class="jj hv"> nedb </strong>变量<code class="eh ku kv kw kx b">Datastore</code>用filename和autoload创建一个事务变量。</p><p id="938d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.get("/, function(req, res)</code>函数是<code class="eh ku kv kw kx b">transactions</code>数据库的默认路径。</p><p id="ebd0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.get('/all', function (req, res)</code>函数从事务数据库中检索所有事务。</p><p id="8cbc" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.get('/limit', function (req, res)</code>函数检索具有指定限额的交易。</p><p id="11e9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.get('/day-total', function (req, res)</code>函数获取当天的总销售额。</p><p id="94b5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.get('/by-date', function (req, res)</code>函数用于获取特定日期的交易</p><p id="9678" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.post('/new', function (req, res))</code>功能用于新增一笔交易</p><p id="f0cd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">app.get('/:transactionId', function (req, res)</code>函数用于检索单笔交易。</p><p id="c9a2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">要使用CLI从根目录启动Node app，请键入命令</strong>:</p><p id="67a4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">nodemon index.js</code></p><p id="c094" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在后端部分结束</p><div class="lk ll fm fo lm ln"><a href="https://a.paddle.com/v2/click/16413/40334?link=1227" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab ej"><div class="lp ab lq cl cj lr"><h2 class="bd hv fv z el ls eo ep lt er et ht dt translated">VSCode高级用户|学习Visual Studio代码|视频课程</h2><div class="lu l"><h3 class="bd b fv z el ls eo ep lt er et ek translated">在使用Sublime Text 10年后，我转向了vs code——大家都在谈论的新的开源跨平台编辑器…</h3></div><div class="lv l"><p class="bd b gc z el ls eo ep lt er et ek translated">a.paddle.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb ja ln"/></div></div></a></div><h1 id="2c9d" class="mc ld hu bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my dt translated">前端部分</h1><p id="1da3" class="pw-post-body-paragraph jh ji hu jj b jk mz jm jn jo na jq jr js nb ju jv jw nc jy jz ka nd kc kd ke hn dt translated">我们将完成以下任务:</p><p id="bd20" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">1.创建模板React应用程序。<br/> 2。使用代码描述创建路线和视图。</p><p id="a882" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">参见<a class="ae kf" href="https://github.com/kels-orien/real-time-pos-system" rel="noopener ugc nofollow" target="_blank">此处</a>了解我们将使用的源代码<br/>框架:</p><p id="e31a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">axios是一个基于Promise的HTTP客户端，用于浏览器和node.js。</p><p id="d3f6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Bootstrap 是一个免费的开源库，包含用于设计网站和网络应用的HTML和CSS设计模板。</p><p id="fb8c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> React-Bootstrap </strong>是用React构建的Bootstrap 3组件。</p><p id="960d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">是一个轻量级的JavaScript日期库，用于解析、验证、操作和格式化日期。</p><p id="9d67" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> React </strong>是一个用于构建用户界面的JavaScript库。</p><p id="7094" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">创建模板React App </strong></p><p id="e7f9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">确保您已经安装了<a class="ae kf" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">节点和NPM </a>。</p><p id="e877" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">通过命令行界面(CLI)检查节点和Npm版本</p><p id="680e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">node -v</code></p><p id="b883" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">npm -v</code></p><p id="7f64" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">使用CLI访问我们在第1部分中使用的<code class="eh ku kv kw kx b">real-time-pos-folder</code>,使用npm全局创建react应用程序:</p><p id="9b1f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于npm版本5.1或更低版本<br/> <code class="eh ku kv kw kx b">npm install -g create-react-app</code></p><p id="5566" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">要创建您的应用程序，运行一个命令<br/>NPM install create-react-app react-pos</p><p id="7a1d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于npm版本5.2及更高版本<br/> <code class="eh ku kv kw kx b">npx install -g create-react-app</code></p><p id="1e8c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">要创建我们的约会日程安排应用程序，运行一个命令<br/> <code class="eh ku kv kw kx b">npx install create-react-app react-pos</code></p><p id="9304" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">您的应用程序的目录如下所示:</p><p id="ea79" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">react-pos<br/><code class="eh ku kv kw kx b">├── README.md</code><br/><code class="eh ku kv kw kx b">├── node_modules</code><br/><code class="eh ku kv kw kx b">├── package.json</code><br/><code class="eh ku kv kw kx b">├── .gitignore</code><br/><code class="eh ku kv kw kx b">├── public</code><br/><code class="eh ku kv kw kx b">│ └── favicon.ico</code><br/><code class="eh ku kv kw kx b">│ └── index.html</code><br/><code class="eh ku kv kw kx b">│ └── manifest.json</code><br/><code class="eh ku kv kw kx b">└── src</code><br/><code class="eh ku kv kw kx b">└── App.css</code><br/><code class="eh ku kv kw kx b">└── App.js</code><br/><code class="eh ku kv kw kx b">└── App.test.js</code><br/><code class="eh ku kv kw kx b">└── index.css</code><br/><code class="eh ku kv kw kx b">└── index.js</code><br/><code class="eh ku kv kw kx b">└── logo.svg</code><br/><code class="eh ku kv kw kx b">└── registerServiceWorker.js</code></p><p id="8842" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">通过CLI <br/> <code class="eh ku kv kw kx b">npm start</code>以开发模式启动项目</p><p id="50e1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">使用<br/> <code class="eh ku kv kw kx b">cd react-pos</code>访问您的应用目录</p><p id="8898" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">安装以下依赖项:<br/> <code class="eh ku kv kw kx b">npm install bootstrap</code></p><p id="fc6c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">npm install react-bootstrap</code></p><p id="1ab5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">npm install axios</code></p><p id="bda8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">npm install moment</code></p><p id="f42e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">创建路线和视图</strong></p><p id="62f8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们将从创建路线开始</p><p id="2765" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先用下面的代码编辑根目录中的<code class="eh ku kv kw kx b">App.js</code>:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="890e" class="lc ld hu kx b fv le lf l lg lh">import React from "react";<br/>import Header from "./js/components/Header";<br/>import Main from "./js/components/Main";</span><span id="b72d" class="lc ld hu kx b fv li lf l lg lh">const App = () =&gt; (<br/>  &lt;div&gt;<br/>    &lt;Main /&gt;<br/>  &lt;/div&gt;<br/>);</span><span id="101b" class="lc ld hu kx b fv li lf l lg lh">export default App;</span></pre><p id="d59c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">同时更新根目录中的<code class="eh ku kv kw kx b">index.js</code>:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="265f" class="lc ld hu kx b fv le lf l lg lh">import React from "react";<br/>import { render } from "react-dom";<br/>import { BrowserRouter } from "react-router-dom";<br/>import registerServiceWorker from "./registerServiceWorker";<br/>import "./index.css";<br/>import "bootstrap/dist/css/bootstrap.css";<br/>import { makeRoutes } from "./routes";<br/>import App from "./App";</span><span id="60ad" class="lc ld hu kx b fv li lf l lg lh">render(<br/>  &lt;BrowserRouter&gt;<br/>    &lt;App /&gt;<br/>  &lt;/BrowserRouter&gt;,<br/>  document.getElementById("root")<br/>);<br/>registerServiceWorker();</span></pre><p id="53dc" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">您可能想知道<code class="eh ku kv kw kx b">Main</code>和<code class="eh ku kv kw kx b">Header</code>组件，但是我们很快就会创建它们:</p><p id="1c0a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在react-pos应用程序的“src”文件夹目录中创建以下路径:</p><p id="059c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">js/components</code></p><p id="e05b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">使用以下代码在<code class="eh ku kv kw kx b">js/components</code>文件夹中创建Main.js:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="0574" class="lc ld hu kx b fv le lf l lg lh">import React from "react";<br/>import { Switch, Route } from "react-router-dom";<br/>import Inventory from "./Inventory";<br/>import Pos from "./Pos";<br/>import Transactions from "./Transactions";<br/>import LiveCart from "./LiveCart";</span><span id="e90a" class="lc ld hu kx b fv li lf l lg lh">const Main = () =&gt; (<br/>  &lt;main&gt;<br/>    &lt;Switch&gt;<br/>      &lt;Route exact path="/" component={Pos} /&gt;<br/>      &lt;Route path="/inventory" component={Inventory} /&gt;<br/>      &lt;Route path="/transactions" component={Transactions} /&gt;<br/>      &lt;Route path="/livecart" component={LiveCart} /&gt;<br/>    &lt;/Switch&gt;<br/>  &lt;/main&gt;<br/>);</span><span id="5e33" class="lc ld hu kx b fv li lf l lg lh">export default Main;</span></pre><p id="bb47" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">注意我们的<code class="eh ku kv kw kx b">Main.js</code>组件不是一个类；相反，它是一个功能组件。准确地说是箭头功能。我们正在使用函数创建路线。</p><p id="5153" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们为应用程序的导航创建我们的<code class="eh ku kv kw kx b">Header.js</code>组件</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="caf6" class="lc ld hu kx b fv le lf l lg lh">import React from "react";<br/>import { Link } from "react-router-dom";</span><span id="df82" class="lc ld hu kx b fv li lf l lg lh">// The Header creates links that can be used to navigate<br/>// between routes.<br/>const Header = () =&gt; (<br/>  &lt;div className="text-center"&gt;<br/>    &lt;h1&gt;<br/>      &lt;a href="/#/"&gt;Real Time Point POS&lt;/a&gt;<br/>    &lt;/h1&gt;</span><span id="7dcb" class="lc ld hu kx b fv li lf l lg lh">    &lt;ul className="nav-menu"&gt;<br/>      &lt;li className="lead"&gt;<br/>        &lt;Link to="/inventory"&gt;Inventory&lt;/Link&gt;<br/>      &lt;/li&gt;<br/>      &lt;li className="lead"&gt;<br/>        &lt;Link to="/"&gt;POS&lt;/Link&gt;<br/>      &lt;/li&gt;<br/>      &lt;li className="lead"&gt;<br/>        &lt;Link to="/transactions"&gt;Transactions&lt;/Link&gt;<br/>      &lt;/li&gt;<br/>      &lt;li className="lead"&gt;<br/>        &lt;Link to="/livecart"&gt;LiveCart&lt;/Link&gt;<br/>      &lt;/li&gt;<br/>    &lt;/ul&gt;<br/>  &lt;/div&gt;<br/>);</span><span id="9cc4" class="lc ld hu kx b fv li lf l lg lh">export default Header;</span></pre><p id="bc99" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">随着我们的继续，你会注意到<code class="eh ku kv kw kx b">Header</code>组件包含在所有父组件中。</p><p id="37cb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在让我们创建我们的视图，让我们从<code class="eh ku kv kw kx b">src/js/component/</code>文件夹中的<code class="eh ku kv kw kx b">Inventory.js</code>组件开始。</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="74ee" class="lc ld hu kx b fv le lf l lg lh">import React, { Component } from "react";<br/>import "./App.css";<br/>import Header from "./Header";<br/>import Product from "./Product";<br/>import axios from "axios";</span><span id="de69" class="lc ld hu kx b fv li lf l lg lh">const HOST = "<a class="ae kf" href="http://localhost/" rel="noopener ugc nofollow" target="_blank">http://localhost:80</a>";</span><span id="6bc1" class="lc ld hu kx b fv li lf l lg lh">class Inventory extends Component {<br/>  constructor(props) {<br/>    super(props);</span><span id="af7f" class="lc ld hu kx b fv li lf l lg lh">    this.state = { products: [] };<br/>  }<br/>  componentWillMount() {<br/>    var url = HOST + `/api/inventory/products`;<br/>    axios.get(url).then(response =&gt; {<br/>      this.setState({ products: response.data });<br/>    });<br/>  }<br/>  render() {<br/>    var { products } = this.state;</span><span id="005e" class="lc ld hu kx b fv li lf l lg lh">    var renderProducts = () =&gt; {<br/>      if (products.length === 0) {<br/>        return &lt;p&gt;{products}&lt;/p&gt;;<br/>      }<br/>      return products.map(product =&gt; &lt;Product {...product} /&gt;);<br/>    };</span><span id="092f" class="lc ld hu kx b fv li lf l lg lh">    return (<br/>      &lt;div&gt;<br/>        &lt;Header /&gt;</span><span id="3c22" class="lc ld hu kx b fv li lf l lg lh">        &lt;div class="container"&gt;<br/>          &lt;a<br/>            href="#/inventory/create-product"<br/>            class="btn btn-success pull-right"<br/>          &gt;<br/>            &lt;i class="glyphicon glyphicon-plus" /&gt; Add New Item<br/>          &lt;/a&gt;<br/>          &lt;br /&gt;<br/>          &lt;br /&gt;</span><span id="1bd9" class="lc ld hu kx b fv li lf l lg lh">          &lt;table class="table"&gt;<br/>            &lt;thead&gt;<br/>              &lt;tr&gt;<br/>                &lt;th scope="col"&gt;Name&lt;/th&gt;<br/>                &lt;th scope="col"&gt;Price&lt;/th&gt;<br/>                &lt;th scope="col"&gt;Quantity on Hand&lt;/th&gt;<br/>                &lt;th /&gt;<br/>              &lt;/tr&gt;<br/>            &lt;/thead&gt;<br/>            &lt;tbody&gt;{renderProducts()}&lt;/tbody&gt;<br/>          &lt;/table&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}</span><span id="ca57" class="lc ld hu kx b fv li lf l lg lh">export default Inventory;</span></pre><p id="d9dc" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">注意，我们为上面的<code class="eh ku kv kw kx b">inventory</code>组件使用了一个类。<code class="eh ku kv kw kx b">componentWillMount</code>是一种用于修改组件状态的生命周期方法，在这种特殊情况下，我们通过在第1部分中创建的Node.js Express应用程序从库存数据库中检索产品。使用<code class="eh ku kv kw kx b">setState</code>将响应分配给产品阵列。所有这些都是在页面完全加载之前完成的。</p><p id="5d0b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">render</code>函数将在DOM(文档对象模型)中显示我们的UI元素。<code class="eh ku kv kw kx b">renderFunction</code>检查产品数组并在DOM中显示结果。</p><p id="abdd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们继续讨论<code class="eh ku kv kw kx b">POS.js</code>组件。<code class="eh ku kv kw kx b">Pos</code>组件将允许用户添加价格的购物车项目。购物车会实时更新。</p><p id="c3e0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在<code class="eh ku kv kw kx b">src/js/component/</code>文件夹中创建一个<code class="eh ku kv kw kx b">Pos.js</code>文件:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="1237" class="lc ld hu kx b fv le lf l lg lh">import React, { Component } from "react";<br/>import "./App.css";<br/>import Header from "./Header";<br/>import io from "socket.io-client";<br/>import axios from "axios";<br/>import moment from "moment";<br/>import { Modal, Button } from "react-bootstrap";<br/>import LivePos from "./LivePos";</span><span id="df81" class="lc ld hu kx b fv li lf l lg lh">const HOST = "<a class="ae kf" href="http://localhost/" rel="noopener ugc nofollow" target="_blank">http://localhost:80</a>";<br/>let socket = io.connect(HOST);</span><span id="14ce" class="lc ld hu kx b fv li lf l lg lh">class Pos extends Component {<br/>  constructor(props) {<br/>    super(props);<br/>    this.state = {<br/>      items: [],<br/>      quantity: 1,<br/>      id: 0,<br/>      open: true,<br/>      close: false,<br/>      addItemModal: false,<br/>      checkOutModal: false,<br/>      amountDueModal: false,<br/>      totalPayment: 0,<br/>      total: 0,<br/>      changeDue: 0,<br/>      name: "",<br/>      price: 0<br/>    };<br/>    this.handleSubmit = this.handleSubmit.bind(this);<br/>    this.handleName = this.handleName.bind(this);<br/>    this.handlePrice = this.handlePrice.bind(this);<br/>    this.handlePayment = this.handlePayment.bind(this);<br/>    this.handleQuantityChange = this.handleQuantityChange.bind(this);<br/>    this.handleCheckOut = this.handleCheckOut.bind(this);<br/>  }<br/>  componentDidUpdate() {<br/>    if (this.state.items.length !== 0) {<br/>      socket.emit("update-live-cart", this.state.items);<br/>    }<br/>  }<br/>  handleSubmit = e =&gt; {<br/>    e.preventDefault();<br/>    this.setState({ addItemModal: false });</span><span id="41d8" class="lc ld hu kx b fv li lf l lg lh">    const currentItem = {<br/>      id: this.state.id++,<br/>      name: this.state.name,<br/>      price: this.state.price,<br/>      quantity: this.state.quantity<br/>    };<br/>    var items = this.state.items;<br/>    items.push(currentItem);<br/>    this.setState({ items: items });<br/>  };<br/>  handleName = e =&gt; {<br/>    this.setState({ name: e.target.value });<br/>  };<br/>  handlePrice = e =&gt; {<br/>    this.setState({ price: e.target.value });<br/>  };<br/>  handlePayment = () =&gt; {<br/>    this.setState({ checkOutModal: false });<br/>    var amountDiff =<br/>      parseInt(this.state.total, 10) - parseInt(this.state.totalPayment, 10);<br/>    if (this.state.total &lt;= this.state.totalPayment) {<br/>      this.setState({ changeDue: amountDiff });<br/>      this.setState({ receiptModal: true });<br/>      this.handleSaveToDB();<br/>      this.setState({ items: [] });<br/>      this.setState({ total: 0 });<br/>    } else {<br/>      this.setState({ changeDue: amountDiff });<br/>      this.setState({ amountDueModal: true });<br/>    }<br/>  };<br/>  handleQuantityChange = (id, quantity) =&gt; {<br/>    var items = this.state.items;<br/>    for (var i = 0; i &lt; items.length; i++) {<br/>      if (items[i].id === id) {<br/>        items[i].quantity = quantity;<br/>        this.setState({ items: items });<br/>      }<br/>    }<br/>  };<br/>  handleCheckOut = () =&gt; {<br/>    this.setState({ checkOutModal: true });<br/>    var items = this.state.items;<br/>    var totalCost = 0;<br/>    for (var i = 0; i &lt; items.length; i++) {<br/>      var price = items[i].price * items[i].quantity;<br/>      totalCost = parseInt(totalCost, 10) + parseInt(price, 10);<br/>    }<br/>    this.setState({ total: totalCost });<br/>  };<br/>  handleSaveToDB = () =&gt; {<br/>    const transaction = {<br/>      date: moment().format("DD-MMM-YYYY HH:mm:ss"),<br/>      total: this.state.total,<br/>      items: this.state.items<br/>    };<br/>    axios.post(HOST + "/api/new", transaction).catch(err =&gt; {<br/>      console.log(err);<br/>    });<br/>  };<br/>  render() {<br/>    var { quantity, modal, items } = this.state;</span><span id="ca55" class="lc ld hu kx b fv li lf l lg lh">    var renderAmountDue = () =&gt; {<br/>      return (<br/>        &lt;Modal show={this.state.amountDueModal}&gt;<br/>          &lt;Modal.Header closeButton&gt;<br/>            &lt;Modal.Title&gt;Amount&lt;/Modal.Title&gt;<br/>          &lt;/Modal.Header&gt;<br/>          &lt;Modal.Body&gt;<br/>            &lt;h3&gt;<br/>              Amount Due:<br/>              &lt;span class="text-danger"&gt;{this.state.changeDue}&lt;/span&gt;<br/>            &lt;/h3&gt;<br/>            &lt;p&gt;Customer payment incomplete; Correct and Try again&lt;/p&gt;<br/>          &lt;/Modal.Body&gt;<br/>          &lt;Modal.Footer&gt;<br/>            &lt;Button onClick={() =&gt; this.setState({ amountDueModal: false })}&gt;<br/>              close<br/>            &lt;/Button&gt;<br/>          &lt;/Modal.Footer&gt;<br/>        &lt;/Modal&gt;<br/>      );<br/>    };<br/>    var renderReceipt = () =&gt; {<br/>      return (<br/>        &lt;Modal show={this.state.receiptModal}&gt;<br/>          &lt;Modal.Header closeButton&gt;<br/>            &lt;Modal.Title&gt;Receipt&lt;/Modal.Title&gt;<br/>          &lt;/Modal.Header&gt;<br/>          &lt;Modal.Body&gt;<br/>            &lt;h3&gt;<br/>              Total:<br/>              &lt;span class="text-danger"&gt;{this.state.totalPayment}&lt;/span&gt;<br/>            &lt;/h3&gt;<br/>            &lt;h3&gt;<br/>              Change Due:<br/>              &lt;span class="text-success"&gt;{this.state.changeDue}&lt;/span&gt;<br/>            &lt;/h3&gt;<br/>          &lt;/Modal.Body&gt;<br/>          &lt;Modal.Footer&gt;<br/>            &lt;Button onClick={() =&gt; this.setState({ receiptModal: false })}&gt;<br/>              close<br/>            &lt;/Button&gt;<br/>          &lt;/Modal.Footer&gt;<br/>        &lt;/Modal&gt;<br/>      );<br/>    };</span><span id="0aaa" class="lc ld hu kx b fv li lf l lg lh">    var renderLivePos = () =&gt; {<br/>      if (items.length === 0) {<br/>        return &lt;p&gt; No products added&lt;/p&gt;;<br/>      } else {<br/>        return items.map(<br/>          item =&gt; (<br/>            &lt;LivePos {...item} onQuantityChange={this.handleQuantityChange} /&gt;<br/>          ),<br/>          this<br/>        );<br/>      }<br/>    };</span><span id="c9d3" class="lc ld hu kx b fv li lf l lg lh">    return (<br/>      &lt;div&gt;<br/>        &lt;Header /&gt;<br/>        &lt;div class="container"&gt;<br/>          &lt;div class="text-center"&gt;<br/>            &lt;span class="lead"&gt;Total&lt;/span&gt;<br/>            &lt;br /&gt;<br/>            &lt;span class="text-success checkout-total-price"&gt;<br/>              ${this.state.total}<br/>              &lt;span /&gt;<br/>            &lt;/span&gt;<br/>            &lt;div&gt;<br/>              &lt;button<br/>                class="btn btn-success lead"<br/>                id="checkoutButton"<br/>                onClick={this.handleCheckOut}<br/>              &gt;<br/>                &lt;i class="glyphicon glyphicon-shopping-cart" /&gt;<br/>                &lt;br /&gt;<br/>                &lt;br /&gt;<br/>                C&lt;br /&gt;<br/>                h&lt;br /&gt;<br/>                e&lt;br /&gt;<br/>                c&lt;br /&gt;<br/>                k&lt;br /&gt;<br/>                o&lt;br /&gt;<br/>                u&lt;br /&gt;<br/>                t<br/>              &lt;/button&gt;<br/>              &lt;div className="modal-body"&gt;<br/>                &lt;Modal show={this.state.checkOutModal}&gt;<br/>                  &lt;Modal.Header closeButton&gt;<br/>                    &lt;Modal.Title&gt;Checkout&lt;/Modal.Title&gt;<br/>                  &lt;/Modal.Header&gt;<br/>                  &lt;Modal.Body&gt;<br/>                    &lt;div ng-hide="transactionComplete" class="lead"&gt;<br/>                      &lt;h3&gt;<br/>                        Total:<br/>                        &lt;span class="text-danger"&gt; {this.state.total} &lt;/span&gt;<br/>                      &lt;/h3&gt;</span><span id="4e8f" class="lc ld hu kx b fv li lf l lg lh">                      &lt;form<br/>                        class="form-horizontal"<br/>                        name="checkoutForm"<br/>                        onSubmit={this.handlePayment}<br/>                      &gt;<br/>                        &lt;div class="form-group"&gt;<br/>                          &lt;div class="input-group"&gt;<br/>                            &lt;div class="input-group-addon"&gt;$&lt;/div&gt;<br/>                            &lt;input<br/>                              type="number"<br/>                              id="checkoutPaymentAmount"<br/>                              class="form-control input-lg"<br/>                              name="payment"<br/>                              onChange={event =&gt;<br/>                                this.setState({<br/>                                  totalPayment: event.target.value<br/>                                })<br/>                              }<br/>                              min="0"<br/>                            /&gt;<br/>                          &lt;/div&gt;<br/>                        &lt;/div&gt;</span><span id="15ad" class="lc ld hu kx b fv li lf l lg lh">                        &lt;p class="text-danger"&gt;Enter payment amount.&lt;/p&gt;<br/>                        &lt;div class="lead" /&gt;<br/>                        &lt;Button<br/>                          class="btn btn-primary btn-lg lead"<br/>                          onClick={this.handlePayment}<br/>                        &gt;<br/>                          Print Receipt<br/>                        &lt;/Button&gt;<br/>                      &lt;/form&gt;<br/>                    &lt;/div&gt;<br/>                  &lt;/Modal.Body&gt;<br/>                  &lt;Modal.Footer&gt;<br/>                    &lt;Button<br/>                      onClick={() =&gt; this.setState({ checkOutModal: false })}<br/>                    &gt;<br/>                      Close<br/>                    &lt;/Button&gt;<br/>                  &lt;/Modal.Footer&gt;<br/>                &lt;/Modal&gt;<br/>              &lt;/div&gt;<br/>            &lt;/div&gt;<br/>          &lt;/div&gt;<br/>          {renderAmountDue()}<br/>          {renderReceipt()}<br/>          &lt;table class="pos table table-responsive table-striped table-hover"&gt;<br/>            &lt;thead&gt;<br/>              &lt;tr&gt;<br/>                &lt;td colspan="6" class="text-center"&gt;<br/>                  &lt;span class="pull-left"&gt;<br/>                    &lt;button<br/>                      onClick={() =&gt; this.setState({ addItemModal: true })}<br/>                      class="btn btn-default btn-sm"<br/>                    &gt;<br/>                      &lt;i class="glyphicon glyphicon-plus" /&gt; Add Item<br/>                    &lt;/button&gt;<br/>                  &lt;/span&gt;<br/>                  &lt;Modal show={this.state.addItemModal} onHide={this.close}&gt;<br/>                    &lt;Modal.Header closeButton&gt;<br/>                      &lt;Modal.Title&gt;Add item(Product)&lt;/Modal.Title&gt;<br/>                    &lt;/Modal.Header&gt;<br/>                    &lt;Modal.Body&gt;<br/>                      &lt;form<br/>                        ref="form"<br/>                        onSubmit={this.handleSubmit}<br/>                        class="form-horizontal"<br/>                      &gt;<br/>                        &lt;div class="form-group"&gt;<br/>                          &lt;label class="col-md-2 lead" for="name"&gt;<br/>                            Name<br/>                          &lt;/label&gt;<br/>                          &lt;div class="col-md-8 input-group"&gt;<br/>                            &lt;input<br/>                              class="form-control"<br/>                              name="name"<br/>                              required<br/>                              onChange={this.handleName}<br/>                            /&gt;<br/>                          &lt;/div&gt;<br/>                        &lt;/div&gt;<br/>                        &lt;div class="form-group"&gt;<br/>                          &lt;label class="col-md-2 lead" for="price"&gt;<br/>                            Price<br/>                          &lt;/label&gt;<br/>                          &lt;div class="col-md-8 input-group"&gt;<br/>                            &lt;div class="input-group-addon"&gt;$&lt;/div&gt;</span><span id="6eb7" class="lc ld hu kx b fv li lf l lg lh">                            &lt;input<br/>                              type="number"<br/>                              step="any"<br/>                              min="0"<br/>                              onChange={this.handlePrice}<br/>                              class="form-control"<br/>                              name="price"<br/>                              required<br/>                            /&gt;<br/>                          &lt;/div&gt;<br/>                        &lt;/div&gt;</span><span id="1fd0" class="lc ld hu kx b fv li lf l lg lh">                        &lt;p class="text-danger"&gt;Enter price for item.&lt;/p&gt;<br/>                      &lt;/form&gt;<br/>                    &lt;/Modal.Body&gt;<br/>                    &lt;Modal.Footer&gt;<br/>                      &lt;Button onClick={this.handleSubmit}&gt;Add&lt;/Button&gt;<br/>                      &lt;Button<br/>                        onClick={() =&gt; this.setState({ addItemModal: false })}<br/>                      &gt;<br/>                        Cancel<br/>                      &lt;/Button&gt;<br/>                    &lt;/Modal.Footer&gt;<br/>                  &lt;/Modal&gt;<br/>                &lt;/td&gt;<br/>              &lt;/tr&gt;<br/>              &lt;tr class="titles"&gt;<br/>                &lt;th&gt;Name&lt;/th&gt;<br/>                &lt;th&gt;Price&lt;/th&gt;<br/>                &lt;th&gt;Quantity&lt;/th&gt;<br/>                &lt;th&gt;Tax&lt;/th&gt;<br/>                &lt;th&gt;Total&lt;/th&gt;<br/>                &lt;th /&gt;<br/>              &lt;/tr&gt;<br/>            &lt;/thead&gt;<br/>            &lt;tbody&gt;{renderLivePos()}&lt;/tbody&gt;<br/>          &lt;/table&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}</span><span id="90b9" class="lc ld hu kx b fv li lf l lg lh">export default Pos;</span></pre><p id="619e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">Pos</code>组件使用户能够将商品添加到购物车，通过结账接受付款，打印收据并保存到数据库。</p><p id="8334" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">每次组件更新时，<code class="eh ku kv kw kx b">componentDidUpdate</code>生命周期方法用于检查<code class="eh ku kv kw kx b">items</code>数组的状态。如果<code class="eh ku kv kw kx b">item</code>阵列包含一个或多个产品，则使用<code class="eh ku kv kw kx b">socket.io</code>实时更新<code class="eh ku kv kw kx b">LiveCart</code>。</p><p id="0578" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">handleSubmit</code>函数将一个项目添加到项目数组中。</p><p id="0b3b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">handlePrice</code>函数使用<code class="eh ku kv kw kx b">setState</code>将物品的当前价格分配给价格变量</p><p id="ad81" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">handleName</code>函数使用<code class="eh ku kv kw kx b">setState</code>将项目的当前名称分配给名称变量</p><p id="a5a9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">handlePayment</code>功能根据总成本检查客户为商品支付的金额。</p><p id="8a99" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">handleQuantityChange</code>函数是子组件<code class="eh ku kv kw kx b">LivePos</code>的一个道具，当用户增加或减少一个物品的数量时，它会更新这个数量。</p><p id="5c0e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">handleCheckout</code>函数计算顾客购买商品的总成本，并使用setState更新<code class="eh ku kv kw kx b">total</code>。</p><p id="cad6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">renderLivePos</code>函数使用子组件<code class="eh ku kv kw kx b">LivePos</code>呈现添加到项目数组中的项目。</p><p id="37ae" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">renderReceipt</code>显示确认支付的模式。</p><p id="b9df" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">renderAmountDue</code>显示一个通知用户未完成支付的模式。</p><p id="643c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">LivePos</code>是<code class="eh ku kv kw kx b">Pos</code>组件的子组件。它显示添加到<code class="eh ku kv kw kx b">Pos</code>组件中的每个项目。<code class="eh ku kv kw kx b">LivePos</code>也称为表示组件。检查源代码<a class="ae kf" href="https://github.com/kels-orien/real-time-pos-system/blob/master/react-pos/src/js/components/LivePos.js" rel="noopener ugc nofollow" target="_blank">代码</a>这个组件</p><p id="8821" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">handleSaveToDB</code>函数将交易保存到数据库中</p><p id="002c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们继续讨论Livecart组件:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="b444" class="lc ld hu kx b fv le lf l lg lh">import React, { Component } from "react";<br/>import "./App.css";<br/>import io from "socket.io-client";<br/>import Header from "./Header";<br/>import axios from "axios";<br/>import RecentTransactions from "./RecentTransactions";<br/>import LiveTransactions from "./LiveTransactions";<br/>import moment from "moment";</span><span id="4ecc" class="lc ld hu kx b fv li lf l lg lh">const HOST = "<a class="ae kf" href="http://localhost/" rel="noopener ugc nofollow" target="_blank">http://localhost:80</a>";<br/>var url = HOST + `/api//day-total/`;<br/>class LiveCart extends Component {<br/>  constructor(props) {<br/>    super(props);<br/>    this.state = { transactions: [], liveTransactions: [] };<br/>  }<br/>  componentWillMount() {<br/>    // console.dir(socket);<br/>    axios.get(url).then(response =&gt; {<br/>      this.setState({ transactions: response.data });<br/>      console.log("response", response.data);<br/>    });</span><span id="7eeb" class="lc ld hu kx b fv li lf l lg lh">    var socket = io.connect(HOST);</span><span id="4bff" class="lc ld hu kx b fv li lf l lg lh">    socket.on("update-live-cart-display", liveCart =&gt; {<br/>      this.setState({ liveTransactions: liveCart });<br/>    });<br/>  }<br/>  componentWillUnmount() {<br/>    // socket.disconnect();<br/>    // alert("Disconnecting Socket as component will unmount");<br/>  }<br/>  render() {<br/>    var { transactions, liveTransactions } = this.state;<br/>    var renderRecentTransactions = () =&gt; {<br/>      if (transactions.length === 0) {<br/>        return &lt;p&gt;No recent transactions available&lt;/p&gt;;<br/>      } else {<br/>        return transactions.map(transaction =&gt; (<br/>          &lt;RecentTransactions {...transaction} /&gt;<br/>        ));<br/>      }<br/>    };<br/>    var renderDate = () =&gt; {<br/>      return moment().format("DD-MMM-YYYY HH:mm:ss");<br/>    };<br/>    var renderLiveTransactions = () =&gt; {<br/>      if (liveTransactions.length === 0) {<br/>        return (<br/>          &lt;div&gt;<br/>            &lt;div class="col-md-5 pull-right"&gt;<br/>              &lt;div&gt;<br/>                &lt;div class="alert alert-warning text-center" role="alert"&gt;<br/>                  &lt;strong&gt;Not Active:&lt;/strong&gt; No items added at the moment.<br/>                &lt;/div&gt;<br/>              &lt;/div&gt;<br/>            &lt;/div&gt;<br/>          &lt;/div&gt;<br/>        );<br/>      } else {<br/>        return liveTransactions.map(liveTransaction =&gt; (<br/>          &lt;LiveTransactions {...liveTransaction} /&gt;<br/>        ));<br/>      }<br/>    };<br/>    return (<br/>      &lt;div&gt;<br/>        &lt;Header /&gt;<br/>        &lt;div class="livecart"&gt;<br/>          &lt;div class="col-md-5 pull-right"&gt;<br/>            &lt;div class="panel panel-primary"&gt;<br/>              &lt;div class="panel-heading text-center lead"&gt;{renderDate()}&lt;/div&gt;</span><span id="4d33" class="lc ld hu kx b fv li lf l lg lh">              &lt;table class="receipt table table-hover"&gt;<br/>                &lt;thead&gt;<br/>                  &lt;tr class="small"&gt;<br/>                    &lt;th&gt; Quantity &lt;/th&gt;<br/>                    &lt;th&gt; Product &lt;/th&gt;<br/>                    &lt;th&gt; Price &lt;/th&gt;<br/>                  &lt;/tr&gt;<br/>                &lt;/thead&gt;<br/>                &lt;tbody&gt;{renderLiveTransactions()}&lt;/tbody&gt;<br/>              &lt;/table&gt;<br/>            &lt;/div&gt;<br/>          &lt;/div&gt;<br/>          &lt;div class="col-md-5 pull-left"&gt;<br/>            &lt;div class="panel panel-default"&gt;<br/>              &lt;div class="panel-heading lead text-center"&gt;<br/>                Recent Transactions<br/>              &lt;/div&gt;</span><span id="eade" class="lc ld hu kx b fv li lf l lg lh">              &lt;div class="panel-body"&gt;<br/>                &lt;div class="text-center"&gt;<br/>                  &lt;span&gt;Today's Sales&lt;/span&gt;<br/>                  &lt;br /&gt;<br/>                  &lt;span class="text-success checkout-total-price"&gt;<br/>                    $&lt;span /&gt;<br/>                  &lt;/span&gt;<br/>                &lt;/div&gt;</span><span id="30ac" class="lc ld hu kx b fv li lf l lg lh">                &lt;table class="table table-hover table-striped"&gt;<br/>                  &lt;thead&gt;<br/>                    &lt;tr&gt;<br/>                      &lt;th&gt;Time&lt;/th&gt;<br/>                      &lt;th&gt;Total&lt;/th&gt;<br/>                    &lt;/tr&gt;<br/>                  &lt;/thead&gt;<br/>                  &lt;tbody&gt;{renderRecentTransactions()}&lt;/tbody&gt;<br/>                &lt;/table&gt;<br/>              &lt;/div&gt;<br/>            &lt;/div&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}</span><span id="09b1" class="lc ld hu kx b fv li lf l lg lh">export default LiveCart;</span></pre><p id="cc4a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">LiveCart</code>组件呈现最近和当前的事务。</p><p id="d399" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在<code class="eh ku kv kw kx b">ComponentWillMount</code>上，检索最近的交易，然后使用<code class="eh ku kv kw kx b">socket.io-client</code>检索livecart上的当前商品</p><p id="20ca" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">render</code>函数显示DOM的用户界面。<code class="eh ku kv kw kx b">renderRecentTransactions</code>子<br/>组件用于呈现最近保存到数据库中的事务。<code class="eh ku kv kw kx b">renderLiveTransactions</code>也是用于呈现当前交易的子组件。<code class="eh ku kv kw kx b">renderRecentTransactions</code>和<code class="eh ku kv kw kx b">renderLiveTransactions</code>都是表示性组件。</p><p id="eb29" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们转到事务组件:</p><pre class="jd je jf jg fq ky kx kz la aw lb dt"><span id="e02c" class="lc ld hu kx b fv le lf l lg lh">import React, { Component } from "react";<br/>import "./App.css";<br/>import Header from "./Header";<br/>import CompleteTransactions from "./CompleteTransactions";<br/>import axios from "axios";</span><span id="3743" class="lc ld hu kx b fv li lf l lg lh">const HOST = "<a class="ae kf" href="http://localhost/" rel="noopener ugc nofollow" target="_blank">http://localhost:80</a>";<br/>const url = HOST + `/api/all`;</span><span id="dde8" class="lc ld hu kx b fv li lf l lg lh">class Transactions extends Component {<br/>  constructor(props) {<br/>    super(props);<br/>    this.state = { transactions: [] };<br/>  }<br/>  componentWillMount() {<br/>    axios.get(url).then(response =&gt; {<br/>      this.setState({ transactions: response.data });<br/>      console.log("response:", response.data);<br/>    });<br/>  }<br/>  render() {<br/>    var { transactions } = this.state;</span><span id="646f" class="lc ld hu kx b fv li lf l lg lh">    var rendertransactions = () =&gt; {<br/>      if (transactions.length === 0) {<br/>        return &lt;p&gt;No Transactions found&lt;/p&gt;;<br/>      }<br/>      return transactions.map(transaction =&gt; (<br/>        &lt;CompleteTransactions {...transaction} /&gt;<br/>      ));<br/>    };</span><span id="51ca" class="lc ld hu kx b fv li lf l lg lh">    return (<br/>      &lt;div&gt;<br/>        &lt;Header /&gt;<br/>        &lt;div class="text-center"&gt;<br/>          &lt;span class=""&gt;Today's Sales&lt;/span&gt;<br/>          &lt;br /&gt;<br/>          &lt;span class="text-success checkout-total-price"&gt;<br/>            $ &lt;span /&gt;<br/>          &lt;/span&gt;<br/>        &lt;/div&gt;</span><span id="ad64" class="lc ld hu kx b fv li lf l lg lh">        &lt;br /&gt;<br/>        &lt;br /&gt;</span><span id="2844" class="lc ld hu kx b fv li lf l lg lh">        &lt;table class="table table-hover table-striped"&gt;<br/>          &lt;thead&gt;<br/>            &lt;tr&gt;<br/>              &lt;th&gt;Time&lt;/th&gt;<br/>              &lt;th&gt;Total&lt;/th&gt;<br/>              &lt;th&gt;Products&lt;/th&gt;<br/>              &lt;th&gt;Open&lt;/th&gt;<br/>            &lt;/tr&gt;<br/>          &lt;/thead&gt;<br/>          &lt;tbody&gt;{rendertransactions()}&lt;/tbody&gt;<br/>        &lt;/table&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}</span><span id="4072" class="lc ld hu kx b fv li lf l lg lh">export default Transactions;</span></pre><p id="1873" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在<code class="eh ku kv kw kx b">componentWillMount</code>上所有的交易和从数据库中检索。</p><p id="a0b3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ku kv kw kx b">rendertransactions</code>功能显示使用<code class="eh ku kv kw kx b">CompleteTransactions</code>在线组件的所有交易。有关“CompleteTransactions”的更多信息，请参见源代码。</p><p id="dddc" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们已经成功地建立了实时销售点系统的前端和后端。我希望你玩得开心。</p><figure class="jd je jf jg fq iv fe ff paragraph-image"><a href="https://a.paddle.com/v2/click/16413/40334?link=1227"><div class="fe ff jc"><img src="../Images/6802842226d0a799c5729f09590db3a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PWGRrB_SaEUlnfe_4RhxQ.png"/></div></a></figure><h2 id="400e" class="lc ld hu bd md ne nf ng mh nh ni nj ml js nk nl mp jw nm nn mt ka no np mx nq dt translated">结束语:</h2><p id="ba1b" class="pw-post-body-paragraph jh ji hu jj b jk mz jm jn jo na jq jr js nb ju jv jw nc jy jz ka nd kc kd ke hn dt translated">我在<a class="ae kf" href="http://reactninja.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv"> React Ninja </strong> </a>上发表React、React Native以及其他一切与web开发相关的文章。一定要在<a class="ae kf" href="https://twitter.com/reactninjaio" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv">推特</strong> </a>上关注我。</p><p id="b7dd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">加入我们的<a class="ae kf" href="https://reactninja.io/subscribe-our-newsletter/" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv">简讯</strong> </a> <strong class="jj hv"> </strong>获取最新最棒的内容，让你成为更好的开发者。</p><h2 id="d189" class="lc ld hu bd md ne nf ng mh nh ni nj ml js nk nl mp jw nm nn mt ka no np mx nq dt translated">如果这篇文章有帮助，请点击拍手👏按钮下面几下，以示支持！⬇⬇</h2></div></div>    
</body>
</html>