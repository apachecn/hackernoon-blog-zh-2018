<html>
<head>
<title>How To Set Up Scheduling In GRUB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在GRUB中设置调度</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-set-up-scheduling-in-grub-224d56371e71?source=collection_archive---------37-----------------------#2018-04-02">https://medium.com/hackernoon/how-to-set-up-scheduling-in-grub-224d56371e71?source=collection_archive---------37-----------------------#2018-04-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/638f3528b35832b5bceb71b1792aa114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1R-vOkG13O-znBJpRY6wQ.jpeg"/></div></div></figure><div class=""/><p id="6219" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ka" href="https://en.wikipedia.org/wiki/GNU_GRUB#Version_2_(GRUB)" rel="noopener ugc nofollow" target="_blank"> GRUB 2 </a>将很多功能外包成模块。这使得只加载所需的函数成为可能，因此更小的核心映像也是可能的。您还可以使用这些模块来扩展GRUB，例如在GRUB中实现调度。这使得在特定时间启动特定的操作系统成为可能。</p><p id="6515" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您将获得所有可用模块的列表</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="e2ea" class="kk kl if kg b fv km kn l ko kp">$ ls /boot/grub/i386-pc/</span></pre><h1 id="be39" class="kq kl if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">在GRUB中配置调度</h1><p id="42db" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">对于GRUB中的调度，您需要模块<code class="eh ls lt lu kg b">datehook</code>。这允许访问GRUB中的以下变量:</p><ul class=""><li id="979c" class="lv lw if je b jf jg jj jk jn lx jr ly jv lz jz ma mb mc md dt translated">天</li><li id="eb22" class="lv lw if je b jf me jj mf jn mg jr mh jv mi jz ma mb mc md dt translated">小时</li><li id="fc22" class="lv lw if je b jf me jj mf jn mg jr mh jv mi jz ma mb mc md dt translated">分钟</li><li id="bc52" class="lv lw if je b jf me jj mf jn mg jr mh jv mi jz ma mb mc md dt translated">第二</li><li id="5c66" class="lv lw if je b jf me jj mf jn mg jr mh jv mi jz ma mb mc md dt translated">月</li><li id="3f50" class="lv lw if je b jf me jj mf jn mg jr mh jv mi jz ma mb mc md dt translated">工作日</li><li id="0ab8" class="lv lw if je b jf me jj mf jn mg jr mh jv mi jz ma mb mc md dt translated">年</li></ul><p id="2a0d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所有这些值都基于BIOS中设置的时间和日期(通常是主板硬件时钟)。在GRUB中设置调度时，您必须记住这一点。</p><p id="b280" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用以下命令，您可以获得GRUB菜单中所有菜单项的列表:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="f976" class="kk kl if kg b fv km kn l ko kp">$ grep -E ‘^menuentry|^submenu’ /boot/grub/grub.cfg | cut -d ‘“‘ -f2 | cut -d “‘“ -f2</span></pre><p id="a2cb" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">第一个条目的编号为0，第二个条目的编号为1，依此类推。</p><p id="a623" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来打开文件<strong class="je ig"><em class="mj">/boot/grub/grub . CFG</em></strong>，在文件开头添加以下几行:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="3e4d" class="kk kl if kg b fv km kn l ko kp">insmod datehook</span><span id="044b" class="kk kl if kg b fv mk kn l ko kp"># Add an extra zero for minute 0–9, so MINUTE is always double-digit<br/>if[ $MINUTE -lt 10 ]; then PADDING="0"; else PADDING=""; fi<br/>TIME=$HOUR$PADDING$MINUTE</span><span id="fe81" class="kk kl if kg b fv mk kn l ko kp"># Start Ubuntu by default<br/>set default=0</span><span id="c88a" class="kk kl if kg b fv mk kn l ko kp"># Start Windows 10 from 5:00 p.m. to 11:00 p.m.<br/>if[ $TIME -ge 1700 -a $TIME -lt 2300 ]; then<br/>  set default=3<br/>fi</span></pre><p id="23e0" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">开始时，会为小于10的分钟插入一个额外的零，因此分钟数始终是两位数。然后，我们构造一个新的变量<code class="eh ls lt lu kg b">TIME</code>，它具有HHMM格式的当前时间。这些现在可以用来在GRUB中实现调度。</p><p id="af48" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Ubuntu应该默认启动，但是晚上Windows 10优先。可能有必要调整时间，因为时区UTC通常是在BIOS中设置的。</p><h1 id="bbcb" class="kq kl if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">结论</h1><p id="7278" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">以上更改仅在下一次执行<code class="eh ls lt lu kg b">update-grub</code>前有效。要永久保留GRUB中的更改，您应该在<strong class="je ig"> /etc/grub.d/ </strong>中用这段代码创建一个模板。</p><p id="3c52" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们使用这个选项来更好地管理学校的电脑。Ubuntu默认在白天启动，但是在晚上我们让Linbo启动，这样<a class="ae ka" href="https://openschoolsolutions.org/linbo-remote-manage-school-computers/" rel="noopener ugc nofollow" target="_blank">电脑就可以更新或者提供一个新的镜像</a>。</p></div><div class="ab cl ml mm hc mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hn ho hp hq hr"><p id="076b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="mj">原载于2018年4月2日</em><a class="ae ka" href="https://openschoolsolutions.org/set-up-scheduling-in-grub/" rel="noopener ugc nofollow" target="_blank"><em class="mj">【openschoolsolutions.org】</em></a><em class="mj">。</em> <strong class="je ig"> <em class="mj">注册</em> </strong> <em class="mj">订阅我们的时事通讯，获取免费的PDF格式，并为您的课堂提供出色的开源应用程序，或者在Twitter上关注</em><a class="ae ka" href="https://twitter.com/OpenSchoolZ" rel="noopener ugc nofollow" target="_blank"><em class="mj">@ OpenSchoolZ</em></a><em class="mj">。</em></p></div></div>    
</body>
</html>