<html>
<head>
<title>Know Shell Scripting !!!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解Shell脚本！！！</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/know-shell-scripting-202b2fbe03a8?source=collection_archive---------5-----------------------#2018-04-03">https://medium.com/hackernoon/know-shell-scripting-202b2fbe03a8?source=collection_archive---------5-----------------------#2018-04-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/19c4622b76ba5194b853944c37c3bdff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*APImi56Dl2kUYs7NysmtEg.jpeg"/></div></figure><p id="f311" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">什么是<a class="ae jw" href="https://hackernoon.com/tagged/shell-scripting" rel="noopener ugc nofollow" target="_blank"> shell脚本</a>？它为shell编写一系列命令来执行它们。什么是贝壳？一个操作系统有两个主要组成部分外壳和内核，外壳所做的是解释命令，然后执行它们。</p><p id="7705" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在本文中，我将带您经历编写shell/bash脚本的旅程。什么是空壳<a class="ae jw" href="https://hackernoon.com/tagged/script" rel="noopener ugc nofollow" target="_blank">剧本</a>？它是一个脚本或文件，其中写有一系列命令，可以由shell读取和执行。一个shell脚本有一个<strong class="ja hv">。<em class="jx">sh</em>T7】分机。Bash代表(Bourne Again SHell)。Bash不同于shell。它是使用最多的UNIX shell。在本文中，我们将编写bash脚本。</strong></p><p id="06eb" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">让我们创建最简单的脚本。</p><ol class=""><li id="e178" class="jy jz hu ja b jb jc jf jg jj ka jn kb jr kc jv kd ke kf kg dt translated">我们将创建一个文件first.sh(您可以使用任何文本编辑器)</li><li id="d127" class="jy jz hu ja b jb kh jf ki jj kj jn kk jr kl jv kd ke kf kg dt translated">第一行会是<strong class="ja hv"> #！/bin/sh </strong>(它告诉解释器这是一个bash脚本<strong class="ja hv">)。</strong></li><li id="1380" class="jy jz hu ja b jb kh jf ki jj kj jn kk jr kl jv kd ke kf kg dt translated">我们将编写一个命令<strong class="ja hv"> ls </strong>(列出目录中的子文件夹)</li></ol><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="8fae" class="kv kw hu kr b fv kx ky l kz la"><em class="jx">#! /bin/sh<br/></em>ls</span></pre><p id="9f9b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">然后要运行这个脚本，首先在shell中编写<strong class="ja hv">bash</strong>T16】first . sh。所以，我们写了我们的第一个shell脚本，简单吗？你可能会想这有什么用，比如说我们必须一次又一次地手动编写一系列命令。我们可以只在shell脚本中编写命令，然后运行shell脚本，而不是运行一系列命令。</p><p id="c52e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">假设，您必须将一个提交推送到您的git存储库。我们可以编写一个shell脚本来自动化整个过程，而不是一个接一个地编写命令。创建文件git.sh</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="2afa" class="kv kw hu kr b fv kx ky l kz la">#! /bin/sh <br/>git add .<br/>git commit -m $1<br/>git push origin master</span></pre><p id="697a" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在上面的脚本中，我们自动化了将提交推送到回购的整个过程。我在上面的代码中使用了$1，它就像是用户将提供的输入的占位符<em class="jx">一样。要运行这个脚本，编写<strong class="ja hv">bash git . sh‘初始提交’</strong>。这里的“初始提交”将放在$1。</em></p><p id="bc5a" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们不是手动编写git命令，而是通过运行脚本来自动化这个过程。让我们深入研究一下shell脚本。</p><h2 id="e768" class="kv kw hu bd lb lc ld le lf lg lh li lj jj lk ll lm jn ln lo lp jr lq lr ls lt dt translated">评论</h2><p id="7c32" class="pw-post-body-paragraph iy iz hu ja b jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ly jt ju jv hn dt translated">shell脚本中的注释后跟#。</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="21d5" class="kv kw hu kr b fv kx ky l kz la"># This is a comment.</span></pre><h2 id="878f" class="kv kw hu bd lb lc ld le lf lg lh li lj jj lk ll lm jn ln lo lp jr lq lr ls lt dt translated">变量</h2><p id="cd2e" class="pw-post-body-paragraph iy iz hu ja b jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ly jt ju jv hn dt translated">变量是使用=</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="ac38" class="kv kw hu kr b fv kx ky l kz la">MY_NAME='Morty' #No spaces </span></pre><p id="5387" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">使用<strong class="ja hv"> $ </strong>符号访问变量。</p><h2 id="0bc7" class="kv kw hu bd lb lc ld le lf lg lh li lj jj lk ll lm jn ln lo lp jr lq lr ls lt dt translated"><strong class="ak">回音</strong></h2><p id="732d" class="pw-post-body-paragraph iy iz hu ja b jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ly jt ju jv hn dt translated">Echo用于在shell中显示语句。这就像c语言中的<em class="jx"> printf </em>。</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="14bb" class="kv kw hu kr b fv kx ky l kz la">MY_NAME='Morty' <br/>echo "My name is $MY_NAME"</span><span id="81f1" class="kv kw hu kr b fv lz ky l kz la"># My name is Morty</span></pre><h2 id="113c" class="kv kw hu bd lb lc ld le lf lg lh li lj jj lk ll lm jn ln lo lp jr lq lr ls lt dt translated"><strong class="ak">条件语句</strong></h2><p id="d556" class="pw-post-body-paragraph iy iz hu ja b jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ly jt ju jv hn dt translated">让我们看看bash脚本中的if else语句是什么样子的。</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="af56" class="kv kw hu kr b fv kx ky l kz la">if [[condition]];<br/>then<br/># write the <em class="jx">then instructions here<br/>else<br/></em># write the else <em class="jx">instructions here<br/>fi</em></span></pre><p id="53b6" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">要了解更多关于bash的语法，<a class="ae jw" href="https://devhints.io/bash" rel="noopener ugc nofollow" target="_blank"> <strong class="ja hv">查看这里</strong> </a>。</p><figure class="km kn ko kp fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff ma"><img src="../Images/1207510d2cd596484d03b18d258c83d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-R7w1nBDPb6HRCN1pc-4A.jpeg"/></div></div></figure><p id="5dcf" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">总结一下我们所学到的，让我们编写一个bash脚本，它自动执行heroku命令来创建一个heroku应用程序并将其推送到heroku。<br/>创建一个文件<strong class="ja hv"> deploy.sh </strong>。</p><p id="7f3c" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们首先需要检查的是应用程序名称是否已被占用。我们可以通过向应用名称的<strong class="ja hv"> url </strong>发送请求来检查它，并通过检查响应来检查应用名称是否存在。CURL命令允许我们这样做。<strong class="ja hv"> <em class="jx">收拢</em> </strong>命令在这里为我们提供了一个响应。让我们看看如何，</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="9b3f" class="kv kw hu kr b fv kx ky l kz la"><em class="jx">#! /bin/sh</em></span><span id="f554" class="kv kw hu kr b fv lz ky l kz la">CURL_RESPONSE=`curl -s -o /dev/null -w "%{http_code}" 'https://www.youtube.com/'`</span><span id="aeb8" class="kv kw hu kr b fv lz ky l kz la">echo $CURL_RESPONSE    #200</span></pre><p id="9ff6" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果响应为404，则该应用名称不存在。如果响应为404，则运行heroku命令，否则将显示“App已经存在”。第一步是使用应用程序名称创建请求的url。</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="c47f" class="kv kw hu kr b fv kx ky l kz la">#! /bin/sh</span><span id="d0d3" class="kv kw hu kr b fv lz ky l kz la">HTTP='https://'<br/>APP_NAME=$1<br/>DOMAIN='.herokuapp.com'</span><span id="444b" class="kv kw hu kr b fv lz ky l kz la">REQ_URL=$HTTP$APP_NAME$DOMAIN<em class="jx"><br/></em>echo $REQ_URL</span><span id="f391" class="kv kw hu kr b fv lz ky l kz la"><em class="jx"># REQ_URL = </em><a class="ae jw" href="http://newname.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"><em class="jx">http://newname.herokuapp.com/</em></a></span></pre><p id="1629" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">下一步是使用curl命令检查响应，就像我们上面做的那样。然后在404响应上运行heroku命令。完整的代码将如下所示</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="2629" class="kv kw hu kr b fv kx ky l kz la">#! /bin/sh</span><span id="9d3b" class="kv kw hu kr b fv lz ky l kz la">HTTP='https://'<br/>APP_NAME=$1<br/>DOMAIN='.herokuapp.com'</span><span id="1979" class="kv kw hu kr b fv lz ky l kz la">REQ_URL=$HTTP$APP_NAME$DOMAIN<br/><em class="jx"># REQ_URL = </em><a class="ae jw" href="http://newname.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"><em class="jx">http://newname.herokuapp.com/</em></a><em class="jx"><br/></em>echo $REQ_URL</span><span id="30f3" class="kv kw hu kr b fv lz ky l kz la">CURL_RESPONSE=`curl -s -o /dev/null -w "%{http_code}" $REQ_URL`</span><span id="8ee1" class="kv kw hu kr b fv lz ky l kz la">echo $CURL_RESPONSE       <em class="jx">#404,200,502,000</em></span><span id="686a" class="kv kw hu kr b fv lz ky l kz la">if [[ $CURL_RESPONSE -eq 404 ]];   <em class="jx">#app doesn't exist</em></span><span id="c616" class="kv kw hu kr b fv lz ky l kz la">then<br/>heroku create $APP_NAME<br/>git add .<br/>git commit -m $2<br/>git push heroku master</span><span id="410c" class="kv kw hu kr b fv lz ky l kz la">else<br/>echo App already exists<br/>fi</span></pre><p id="d498" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">运行这个:</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="b24a" class="kv kw hu kr b fv kx ky l kz la">bash deploy.sh firstapp "first commit"</span></pre><p id="9b71" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这个脚本可以用于您想要在heroku上部署的任何项目。Shell脚本自动化了整个过程。Hope，你学了一些shell脚本。如果你做到了，请尽情鼓掌，并跟随我了解更多。</p><figure class="km kn ko kp fq iv"><div class="bz el l di"><div class="mf mg l"/></div></figure></div></div>    
</body>
</html>