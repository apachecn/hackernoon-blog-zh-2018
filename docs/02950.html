<html>
<head>
<title>How to send Bitcoin Lightning Network Payments using the terminal</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用终端发送比特币闪电网络支付</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-send-bitcoin-lightning-network-payments-for-0-00013-usd-fees-1f525153ee9?source=collection_archive---------16-----------------------#2018-04-03">https://medium.com/hackernoon/how-to-send-bitcoin-lightning-network-payments-for-0-00013-usd-fees-1f525153ee9?source=collection_archive---------16-----------------------#2018-04-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="258f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在本指南中，我将带你通过使用<a class="ae jp" href="https://hackernoon.com/tagged/bitcoin" rel="noopener ugc nofollow" target="_blank">比特币</a>的第二层<a class="ae jp" href="https://hackernoon.com/tagged/lightning-network" rel="noopener ugc nofollow" target="_blank">闪电网络</a>使用<strong class="it hv"> testnet </strong>进行演示来完成支付。我们将使用命令行，因为我发现这是使用网络最可靠的方式，这样做可以让您更深入地了解网络是如何运行的。</p><h1 id="b245" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">先决条件</h1><p id="a4a3" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">你可以访问一个闪电节点。正在运行<code class="eh kt ku kv kw b">bitcoind</code>和<code class="eh kt ku kv kw b">lightningd</code>并同步到测试网区块链2。已安装blockstream的<a class="ae jp" href="https://github.com/ElementsProject/lightning" rel="noopener ugc nofollow" target="_blank"> c-lightning </a> cli工具<code class="eh kt ku kv kw b">lightning-cli</code>，并可在其<code class="eh kt ku kv kw b">$PATH</code>中访问。</p><p id="0552" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你还需要设置一个的话，看看我的<a class="ae jp" href="https://andrewgriffithsonline.com/blog/180330-how-to-setup-a-lightning-node" rel="noopener ugc nofollow" target="_blank">设置闪电网络节点指南</a>。</p><h1 id="1f5f" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">1.生成地址和资金钱包</h1><p id="13a6" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">第1层BTC交易= 1。等待时间= 60分钟。</p><p id="4368" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建新地址。</p><p id="37a1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">去<a class="ae jp" href="https://testnet.manu.backend.hamburg/faucet" rel="noopener ugc nofollow" target="_blank"> testnet水龙头</a>给自己发点比特币。提示—使用chrome获得使用IPV6的70%奖励！</p><p id="ebc9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">点击下方出现的交易ID链接，将带您进入<a class="ae jp" href="https://testnet.blockchain.info/" rel="noopener ugc nofollow" target="_blank">区块链浏览器</a>，了解交易详情。</p><p id="9ee1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你需要等待6次确认——大约1小时后，资金才会出现在你的钱包里。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="4516" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli listfunds<br/>{<br/> "outputs": [{<br/>  "txid": "d30ad72742d5c05343f65a1f78a90191f7b13341ed309cad0297a4e2fd3f0196",<br/>  "output": 1,<br/>  "value": 64849668,<br/>  "status": "confirmed"<br/> }]<br/>}</span></pre><figure class="kx ky kz la fq ll fe ff paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="fe ff lk"><img src="../Images/22a050cc7c237a850511e7adada7ed7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6qdL6JhR_JTV_kFo.png"/></div></div></figure><h1 id="9d4d" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">2.连接到一个同行并创建一个支付通道</h1><p id="13b7" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">第1层BTC交易= 1。等待时间= 60分钟。</p><p id="facc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了在网络上进行支付，您首先需要连接到网络。如何找到另一个要连接的节点？前往Acinq的<a class="ae jp" href="https://explorer.acinq.co/" rel="noopener ugc nofollow" target="_blank">闪电网络浏览器</a>。</p><p id="db3e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">寻找一个良好连接的同行(一个有很多渠道)，并复制其URI。我最初在几个节点上超时了，只要继续尝试，你会找到一个立即连接的节点。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="5077" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli connect 03e5f9d1935c67a029bf0a26af5f63109f4f4c45993a8f45177a8f2f39bcb46144 77.58.162.148 9735</span><span id="7274" class="lf jr hu kw b fv ls lh l li lj">$ lightning-cli list peers<br/>{<br/> "state": "GOSSIPING",<br/> "id": "03e5f9d1935c67a029bf0a26af5f63109f4f4c45993a8f45177a8f2f39bcb46144",<br/> "alias": "IslandDSP",<br/> "netaddr": ["84.246.200.122:9735"],<br/> "connected": true<br/>}</span></pre><p id="8434" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，我们将与刚刚连接的对等方创建一个支付通道。打开和关闭通道需要与主区块链进行交互，所以我们希望为它提供一笔可观的资金(以毫秒计)，以便我们可以使用它进行多次支付。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="24aa" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli fundchannel 03e5f9d1935c67a029bf0a26af5f63109f4f4c45993a8f45177a8f2f39bcb46144 50000 </span><span id="9881" class="lf jr hu kw b fv ls lh l li lj">$ lightning-cli listpeers<br/>{<br/> "id": "03e5f9d1935c67a029bf0a26af5f63109f4f4c45993a8f45177a8f2f39bcb46144",<br/> "connected": true,<br/> "netaddr": ["84.246.200.122:9735"],<br/> "alias": "IslandDSP",<br/> "color": "68f442",<br/> "channels": [{<br/>    "state": "CHANNELD_AWAITING_LOCKIN",<br/>    "owner": "lightning_channeld",<br/>    "channel_id": "958b3bd04adb40fd8ff0700a0b24e0298a2ac265273c08ed0218af38140ba678",<br/>    "funding_txid": "78a60b1438af1802ed083c2765c22a8a29e0240b0a70f08ffd40db4ad03b8b95",<br/>    "msatoshi_to_us": 500000000,<br/>    "msatoshi_total": 500000000,<br/>    "dust_limit_satoshis": 546,<br/>    "max_htlc_value_in_flight_msat": 18446744073709552000,<br/>    "channel_reserve_satoshis": 0,<br/>    "htlc_minimum_msat": 0,<br/>    "their_to_self_delay": 6,<br/>    "our_to_self_delay": 144,<br/>    "to_self_delay": 6,<br/>    "max_accepted_htlcs": 483,<br/>    "status": ["CHANNELD_AWAITING_LOCKIN:Funding needs more confirmations."],</span></pre><p id="1f5c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">再次，在<a class="ae jp" href="https://testnet.blockchain.info/" rel="noopener ugc nofollow" target="_blank">比特币测试网浏览器</a>中搜索<code class="eh kt ku kv kw b">txid</code>，并等待3-6次确认，然后通道才被视为开放。如果是，您应该会看到状态更改为<code class="eh kt ku kv kw b">CHANNELD_NORMAL</code>。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="d90c" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli listpeers<br/>{<br/> "peers": [{<br/>  "id": "03e5f9d1935c67a029bf0a26af5f63109f4f4c45993a8f45177a8f2f39bcb46144",<br/>  "connected": true,<br/>  "netaddr": ["84.246.200.122:9735"],<br/>  "alias": "IslandDSP",<br/>  "color": "3399ff",<br/>  "channels": [{<br/>   "state": "CHANNELD_NORMAL",<br/>   "owner": "lightning_channeld",<br/>   "short_channel_id": "1289768:416:0",<br/>   "channel_id": "ba95c71228ce3f57e25f6ac9c4a7418a52a056435b2276dd47437c7521ebda8e",<br/>   "funding_txid": "8edaeb21757c4347dd76225b4356a0528a41a7c4c96a5fe2573fce2812c795ba",<br/>   "msatoshi_to_us": 100000000,<br/>   "msatoshi_total": 100000000,<br/>   "dust_limit_satoshis": 546,<br/>   "max_htlc_value_in_flight_msat": 18446744073709552000,<br/>   "channel_reserve_satoshis": 0,<br/>   "htlc_minimum_msat": 0,<br/>   "their_to_self_delay": 6,<br/>   "our_to_self_delay": 144,<br/>   "to_self_delay": 6,<br/>   "max_accepted_htlcs": 483,<br/>   "status": ["CHANNELD_NORMAL:Funding transaction locked. Channel announced."],<br/>   "in_payments_offered": 0,<br/>   "in_msatoshi_offered": 0,<br/>   "in_payments_fulfilled": 0,<br/>   "in_msatoshi_fulfilled": 0,<br/>   "out_payments_offered": 0,<br/>   "out_msatoshi_offered": 0,<br/>   "out_payments_fulfilled": 0,<br/>   "out_msatoshi_fulfilled": 0<br/>  }]<br/> }]<br/>}</span></pre><figure class="kx ky kz la fq ll fe ff paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="fe ff lk"><img src="../Images/e0ba0942bd328cf6356f6f57f8a03c7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KiiF8qfCXQ1iMjto.png"/></div></div></figure><h1 id="09bc" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">3.生成付款申请</h1><p id="ecd5" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">现在我们已经建立了一个确定的渠道，我们可以开始使用闪电网络进行交易。</p><p id="88f5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">转到<a class="ae jp" href="https://yalls.org/" rel="noopener ugc nofollow" target="_blank">Y’alls</a>上的一篇文章，点击“继续阅读”按钮生成付款请求。这实际上是一张序列化发票。解码它，以检查你没有被多收费！</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="b048" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli decodepay lntb1500n1pdvp7t9pp5k5mvp8u045pdnumnt89cdc7l90lpvff7sjzkrvawg93ju3mgg3nsdp62fjkzepqg9e8g6trd3jn5gzfyp9kummhyptksmeq2dshgmmndp5jqjtnp5cqzyskw8lzg7w4hcfyhncczcaexlpx3tdefm0vjnh9dkqev23g94tdta8jjqzp87v6r9q8xwe3mnjf0tryaa7zkxxj4gwgfcqea32j0x069qqsjyjhz<br/>{<br/> "currency": "tb",<br/> "timestamp": 1522596197,<br/> "created_at": 1522596197,<br/> "expiry": 3600,<br/> "payee": "039cc950286a8fa99218283d1adc2456e0d5e81be558da77dd6e85ba9a1fff5ad3",<br/> "msatoshi": 150000,<br/> "description": "Read Article: I Know Who Satoshi Is\r",<br/> "min_final_cltv_expiry": 144,<br/> "payment_hash": "b536c09f8fad02d9f37359cb86e3df2bfe16253e848561b3ae41632e47684467",<br/> "signature": "3045022100b38ff123ceadf0925e78c0b1dc9be13456dca76f64a772b6c0cb151416ab6afa022079480209fccd0ca0399d98ee724bd63277be158c69550e42700cf62a93ccfd14"<br/>}</span></pre><figure class="kx ky kz la fq ll fe ff paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="fe ff lt"><img src="../Images/7c33dfec5c7c547342f76827e2e83714.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-KKgM4anW0w-rT4I.png"/></div></div></figure><h1 id="3ee8" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">4.付款</h1><p id="1bd9" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">第2层BTC事务= 1。等待时间=毫秒。</p><p id="964f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，我们已经做好了进行第二层比特币交易的一切准备，交易应该立即得到确认。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="a4c0" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli pay lntb1500n1pdvp7t9pp5k5mvp8u045pdnumnt89cdc7l90lpvff7sjzkrvawg93ju3mgg3nsdp62fjkzepqg9e8g6trd3jn5gzfyp9kummhyptksmeq2dshgmmndp5jqjtnp5cqzyskw8lzg7w4hcfyhncczcaexlpx3tdefm0vjnh9dkqev23g94tdta8jjqzp87v6r9q8xwe3mnjf0tryaa7zkxxj4gwgfcqea32j0x069qqsjyjhz<br/>{<br/> "code": 206,<br/> "message": "Fee 1100 is 0.733333% of payment 150000; max fee requested is 0.500000%",<br/> "data": {<br/>  "fee": 1100,<br/>  "feepercent": 0.733333,<br/>  "msatoshi": 150000,<br/>  "maxfeepercent": 0.500000,<br/>  "getroute_tries": 6,<br/>  "sendpay_tries": 0,<br/>  "failures": []<br/> }<br/>}</span></pre><p id="2ee0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">回到Y'alls，点击“检查付款”按钮显示文章。不幸的是，这对我不起作用。当我在命令行上检查时，我发现确实没有付款。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="7af1" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli listpayments<br/>{ "payments": [] }</span></pre><p id="f4cb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了解决这个问题，我试图直接与Y 'alls创建一个支付渠道(当他们为您创建发票以继续阅读时，他们的地址被列为“同行”)。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="c9fe" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli connect 039cc950286a8fa99218283d1adc2456e0d5e81be558da77dd6e85ba9a1fff5ad3 34.200.252.146</span><span id="1019" class="lf jr hu kw b fv ls lh l li lj">$ lightning-cli fundchannel 039cc950286a8fa99218283d1adc2456e0d5e81be558da77dd6e85ba9a1fff5ad3 500000<br/>{<br/> "code": -1,<br/> "message": "received ERROR channel 3795216ba4a257a1f36f1062af58b4513ad82dac90d298e45ca83271e67cf1d6: Unacceptable channel constraints: minimum HTLC value is too large: 0"<br/>}</span></pre><p id="cf9e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">显然，这是一个已知的<a class="ae jp" href="https://github.com/ElementsProject/lightning/issues/1213" rel="noopener ugc nofollow" target="_blank">错误</a>与<code class="eh kt ku kv kw b"><a class="ae jp" href="https://github.com/lightningnetwork/lnd" rel="noopener ugc nofollow" target="_blank">lnd</a></code>，你们必须使用他们的闪电守护进程。</p><p id="f254" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">作为备用计划，我们将使用web lightning钱包向自己付款。转到<a class="ae jp" href="https://htlc.me/" rel="noopener ugc nofollow" target="_blank"> htlc.me </a>生成一个钱包，然后点击“接收”选项卡，请求支付0.0001 tBTC(0.65 tUSD美元)。复制序列化发票，并在付款前进行检查。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="4380" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli decodepay lntb100u1pdvzzc4pp5h55942ehdpy5g70sty9mnvt3k2wlvt4ucnctnellau8drhaew8lsdqqcqzyswv3n3vyzx9uua4tjl8ttcp5fp7srn80zywvg4vses6fj4q9n3v846mgkuu648u37venf93znkckadjejvddv04vyq5l2krx486z23ysqhcrxg6<br/>{<br/> "currency": "tb",<br/> "timestamp": 1522600725,<br/> "created_at": 1522600725,<br/> "expiry": 3600,<br/> "payee": "03193d512b010997885b232ecd6b300917e5288de8785d6d9f619a8952728c78e8",<br/> "msatoshi": 10000000,<br/> "description": "",<br/> "min_final_cltv_expiry": 144,<br/> "payment_hash": "bd285aab3768494479f0590bb9b171b29df62ebcc4f0b9e7ffef0ed1dfb971ff",<br/> "signature": "30440220732338b0823179ced572f9d6bc06890fa0399de223988ab21986932a80b38b0f02205d6d16e73553f23e666692c453b62dd6cb32635ac7d584053eab0cd53e84a892"<br/>}</span></pre><p id="8ce1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这一次，当我尝试付款时，我收到了多个错误。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="c310" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli pay lntb100u1pdvzzc4pp5h55942ehdpy5g70sty9mnvt3k2wlvt4ucnctnellau8drhaew8lsdqqcqzyswv3n3vyzx9uua4tjl8ttcp5fp7srn80zywvg4vses6fj4q9n3v846mgkuu648u37venf93znkckadjejvddv04vyq5l2krx486z23ysqhcrxg6<br/>{<br/> "failures": [{<br/>    "type": "FAIL_PAYMENT_REPLY",<br/>    "erring_index": 1,<br/>    "failcode": 4103...</span></pre><p id="703f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，当我刷新htlc.me的网页时，我发现支付已经成功了。在控制台检查确认付款已经完成。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="f75a" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli listpayments<br/>{<br/> "payments": [{<br/>  "id": 1,<br/>  "payment_hash": "bd285aab3768494479f0590bb9b171b29df62ebcc4f0b9e7ffef0ed1dfb971ff",<br/>  "destination": "03193d512b010997885b232ecd6b300917e5288de8785d6d9f619a8952728c78e8",<br/>  "msatoshi": 10000000,<br/>  "msatoshi_sent": 10002020,<br/>  "timestamp": 1522601027,<br/>  "created_at": 1522601027,<br/>  "status": "complete",<br/>  "payment_preimage": "3e75637befbeec9e7056a4103a06d652cd3cdee9134de69799d8b39c6b1f714c"<br/> }]<br/>}</span></pre><p id="4ba9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们发了一笔款项，只支付了2020毫希的交易费(在撰写本文时为0.00013美元)！</p><p id="30c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，让我们尝试与<a class="ae jp" href="https://htlc.me/" rel="noopener ugc nofollow" target="_blank"> htlc.me </a>直接连接，这样我们就不会在支付时出现任何控制台错误。从上面的<code class="eh kt ku kv kw b">decodepay</code>命令输出中复制<code class="eh kt ku kv kw b">payee</code> id，并在<a class="ae jp" href="https://explorer.acinq.co/#/n/03193d512b010997885b232ecd6b300917e5288de8785d6d9f619a8952728c78e8" rel="noopener ugc nofollow" target="_blank"> lightning网络浏览器</a>中搜索它。复制URI，然后连接到它，并创建一个频道。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="e9fd" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli connect 03193d512b010997885b232ecd6b300917e5288de8785d6d9f619a8952728c78e8 34.201.11.250 9735</span><span id="f426" class="lf jr hu kw b fv ls lh l li lj">$ lightning-cli fundchannel 03193d512b010997885b232ecd6b300917e5288de8785d6d9f619a8952728c78e8 500000</span></pre><p id="4035" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不幸的是，我们需要等待事务在区块链上确认，以便通道变得可用。</p><p id="2ca5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一小时后，我们可以看到通道已经建立—状态为<code class="eh kt ku kv kw b"><strong class="it hv">CHANNELD_NORMAL</strong></code>。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="68c1" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli listpeers<br/>{<br/> "id": "03193d512b010997885b232ecd6b300917e5288de8785d6d9f619a8952728c78e8",<br/> "connected": true,<br/> "netaddr": ["34.201.11.250:9735"],<br/> "alias": "htlc.me",<br/> "color": "854cc5",<br/> "channels": [{<br/>  "state": "CHANNELD_NORMAL",<br/>  "owner": "lightning_channeld",<br/>  "short_channel_id": "1289949:56:0",<br/>  "channel_id": "20dd321c23224b2022f62f59602efc311a8ad63c4481fcd210ef8dade88e8064",<br/>  "funding_txid": "64808ee8ad8def10d2fc81443cd68a1a31fc2e60592ff622204b22231c32dd20",<br/>  "msatoshi_to_us": 500000000,<br/>  "msatoshi_total": 500000000,<br/>  "dust_limit_satoshis": 546,<br/>  "max_htlc_value_in_flight_msat": 18446744073709552000,<br/>  "channel_reserve_satoshis": 0,<br/>  "htlc_minimum_msat": 0,<br/>  "their_to_self_delay": 6,<br/>  "our_to_self_delay": 144,<br/>  "to_self_delay": 6,<br/>  "max_accepted_htlcs": 483,<br/>  "status": ["CHANNELD_NORMAL:Funding transaction locked."],<br/>  "in_payments_offered": 0,<br/>  "in_msatoshi_offered": 0,<br/>  "in_payments_fulfilled": 0,<br/>  "in_msatoshi_fulfilled": 0,<br/>  "out_payments_offered": 0,<br/>  "out_msatoshi_offered": 0,<br/>  "out_payments_fulfilled": 0,<br/>  "out_msatoshi_fulfilled": 0<br/> }]<br/>}</span></pre><p id="4d10" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在在<a class="ae jp" href="https://htlc.me/" rel="noopener ugc nofollow" target="_blank"> htlc.me </a>上生成另一张发票，这次是0.00020000 tBTC(1.31 tUSD)，并在付款前检查详细信息是否正确。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="f116" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli decodepay lntb200u1pdvzvf8pp5tyjfw9ma9uj8hhrhqvmum9vzvaun45qg6mmesu3c08zkhmgl44ssdqqcqzysah4qe4zef3rssusa42cyx0gxxq6q06g50m38w7chz50en80dfh45fj7kdgpx474udehq22mv2pwxfky66kdjdrw88z34w8hjjdjdu6sq6zy2a4</span></pre><p id="f25b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后付款。</p><pre class="kx ky kz la fq lb kw lc ld aw le dt"><span id="e16c" class="lf jr hu kw b fv lg lh l li lj">$ lightning-cli pay lntb200u1pdvzvf8pp5tyjfw9ma9uj8hhrhqvmum9vzvaun45qg6mmesu3c08zkhmgl44ssdqqcqzysah4qe4zef3rssusa42cyx0gxxq6q06g50m38w7chz50en80dfh45fj7kdgpx474udehq22mv2pwxfky66kdjdrw88z34w8hjjdjdu6sq6zy2a4<br/>{<br/> "id": 2,<br/> "payment_hash": "592497177d2f247bdc770337cd958267793ad008d6f798723879c56bed1fad61",<br/> "destination": "03193d512b010997885b232ecd6b300917e5288de8785d6d9f619a8952728c78e8",<br/> "msatoshi": 20000000,<br/> "msatoshi_sent": 20000000,<br/> "timestamp": 1522610489,<br/> "created_at": 1522610489,<br/> "status": "complete",<br/> "payment_preimage": "1e2767675a227c7f8d57252bfe67d6324829c267f3df38396b4d2bb79a27dfd6",<br/> "getroute_tries": 1,<br/> "sendpay_tries": 1,<br/> "route": [{<br/>  "id": "03193d512b010997885b232ecd6b300917e5288de8785d6d9f619a8952728c78e8",<br/>  "channel": "1289949:56:0",<br/>  "msatoshi": 20000000,<br/>  "delay": 144<br/> }],<br/> "failures": []<br/>}</span></pre><p id="4e49" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这次没有控制台错误。您在<a class="ae jp" href="https://htlc.me/" rel="noopener ugc nofollow" target="_blank"> htlc.me </a>的网络钱包应该会立即检测到付款。您现在应该能够立即以类似的低费用进行任何数量的后续支付，直到您耗尽您渠道中的资金或到期。</p><figure class="kx ky kz la fq ll fe ff paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="fe ff lu"><img src="../Images/e78b21d5c567ac8e0bdf5a0452bf8f80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pOQYkzI4MiETDvsY.png"/></div></div></figure><h1 id="3df5" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">结论</h1><p id="68b9" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">如您所见，testnet上的节点至少可以说是粗略的。三个主要的lightning软件实现(lnd、c-lightning、eclair)都还处于早期开发阶段，所以存在一些bug并不奇怪。但这至少会让你对未来当网络更大，运行网络的软件更成熟时，交易会变得多么便宜和快捷有所了解。</p></div><div class="ab cl lv lw hc lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hn ho hp hq hr"><p id="65c8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="mc">最初发布于</em><a class="ae jp" href="https://andrewgriffithsonline.com/blog/guide-to-make-lightning-network-payments" rel="noopener ugc nofollow" target="_blank"><em class="mc">andrewgriffithsonline</em></a><em class="mc"/></p><figure class="kx ky kz la fq ll"><div class="bz el l di"><div class="md me l"/></div></figure></div></div>    
</body>
</html>