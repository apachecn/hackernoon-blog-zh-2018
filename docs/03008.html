<html>
<head>
<title>SDKs Could be the Trojan Horse for Millions of IPhones</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SDK可能成为数百万部IPhones的特洛伊木马</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/sdks-could-be-the-trojan-horse-for-millions-of-iphones-3d67a3a8be93?source=collection_archive---------13-----------------------#2018-04-05">https://medium.com/hackernoon/sdks-could-be-the-trojan-horse-for-millions-of-iphones-3d67a3a8be93?source=collection_archive---------13-----------------------#2018-04-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/9182ddc23de95e2f94485e2d412d9f86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7cJZoABhT7OaAVrd29b3w.png"/></div></div></figure><p id="b645" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">约翰·多恩曾经说过:“没有人是一座孤岛。”如果他生活在21世纪，他可能会对软件说同样的话。从表面上看，程序似乎是完全不同的实体，实际上是由其他开发商和公司制造的许多其他组件组成的。</p><p id="0ae7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">互联网上有数以百万计的第三方库和软件开发工具包(SDK)。开发人员下载它们并将其集成到他们的软件中，从而在构建特性和功能时节省时间。没有必要为他们想做的每一件事重新发明轮子。</p><p id="09c9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但是它们也是安全的致命弱点吗？湾区安全专家费利克斯·克劳斯检查了几个最流行的SDK，发现<a class="ae ka" href="https://krausefx.com/blog/trusting-sdks" rel="noopener ugc nofollow" target="_blank">许多缺乏传输级安全</a>。或者，更简单地说，它们是以一种不安全的方式提供的，允许恶意的第三方截取和修改内容。</p><h1 id="e05f" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">你的应用是草</h1><p id="136d" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">在我们继续之前，我想说Krause的研究是平台不可知的。它影响了所有种类的软件。<a class="ae ka" href="https://thenextweb.com/topic/windows/" rel="noopener ugc nofollow" target="_blank">窗户</a>。Linux。马科斯。<a class="ae ka" href="https://thenextweb.com/topic/android/" rel="noopener ugc nofollow" target="_blank">安卓</a>。<a class="ae ka" href="https://thenextweb.com/topic/ios/" rel="noopener ugc nofollow" target="_blank"> iOS </a>。阿米加可能也是。</p><p id="c405" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">也就是说，在这一部分，我将谈论iOS应用程序，因为它对大多数人来说都很熟悉，也因为它是一个特别有趣的案例研究。这也恰好是克劳斯感兴趣的主要领域，也是他大部分研究的基础平台。</p><p id="fbef" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们假设你想用恶意软件感染一百万个iPhone用户。我不知道为什么，但你知道。这是一个棘手的问题。首先，苹果对iOS的封锁比诺克斯堡还要严格。抓住一个iOS零日也是不可能的；那些起价在六到七位数之间。</p><p id="6201" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以，作为最后的手段，你偷偷给开发人员一个被攻破的SDK，然后他们把危险的代码插入到他们的应用程序中(我们将在后面讨论这是如何工作的)。然后你或多或少地得到了王国的钥匙。虽然苹果的killjoy沙盒停止了真正的乐趣，但恶意代码仍然可以访问:</p><ul class=""><li id="058b" class="le lf hu je b jf jg jj jk jn lg jr lh jv li jz lj lk ll lm dt translated">应用程序可以访问的任何文件和文件夹</li><li id="28b3" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">该应用程序可以访问的任何权限(你好，麦克风和定位服务！)</li><li id="c4fb" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">属于app的<a class="ae ka" href="https://thenextweb.com/topic/icloud/" rel="noopener ugc nofollow" target="_blank"> iCloud </a>容器</li><li id="11c1" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">应用程序可以访问的所有钥匙串数据</li><li id="085a" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">应用程序和远程服务器之间交换的所有信息。</li></ul><p id="fe56" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">呀。简而言之，你可以把一个表面上合法的应用程序变成一台奥威尔式的间谍机器，记录下其中的每一次点击——每一次按键。它甚至可以记录用户去过哪里。它可以获得证书，这些证书可以卖给其他坏演员。</p><p id="9765" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">而这一切都是以难以想象的规模完成的。一个单独的SDK可能会获得数百个应用程序，而每个应用程序又会吸引成千上万的用户。</p><h1 id="672c" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">这是如何工作的</h1><p id="cf3f" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">中间人攻击并不新鲜。这项研究不是关于它们的，而是关于软件的重要部分是如何传输的，以及这如何影响更广泛的软件安全生态系统。然而，了解这种攻击是如何进行的是很重要的。</p><p id="eb33" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这种攻击需要第三方将自己定位在开发人员的计算机和网络的其余部分之间，或者定位在网络和提供SDK下载的服务器之间。这允许他们观察和修改从计算机到外部世界的流量。如果你好奇的话，可以在克劳斯的博客上阅读更好的技术细节。</p><p id="511c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">受害者可能在任何地方:旅馆、咖啡馆或机场。没关系。一旦攻击者被定位，他们就可以开始提供伪造的SDK。Krause指出，替换HTML文档中的文本是微不足道的。因此，他们可以将下载页面上的链接位置改为指向其他地方。</p><p id="0e4e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Krause给出的一个例子探索了将Localytics的SDK的位置改为一个视觉上相似的、不太可能引起怀疑的位置。看看你是否能发现不同之处:</p><ul class=""><li id="9b7b" class="le lf hu je b jf jg jj jk jn lg jr lh jv li jz lj lk ll lm dt translated">https://s3.amazonaws.com/localytics-sdk/sdk.zip<a class="ae ka" href="https://s3.amazonaws.com/localytics-sdk/sdk.zip" rel="noopener ugc nofollow" target="_blank"/></li><li id="03f7" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">【https://s3.amazonaws.com/localytics-sdk-binaries/sdk.zip T4】</li></ul><p id="c09c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">前者是合法的SDK，而包含“localytics-sdk-binaries”的是为恶意代码服务的。</p><p id="05d4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">克劳斯还创建了一个概念验证，允许他实时切换ZIP文件和二进制文件的内容。这是通过一种叫做sslstrip的工具将加密格式的流量降级为没有这种保护的格式来实现的。一步一步来，这是如何工作的:</p><ul class=""><li id="f1b7" class="le lf hu je b jf jg jj jk jn lg jr lh jv li jz lj lk ll lm dt translated">开发人员下载SDK</li><li id="d009" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">然后修改它，插入他们自己的恶意代码</li><li id="cb55" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">攻击者压缩代码。</li><li id="2c29" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">攻击者监视网络流量，等待开发人员下载SDK。</li><li id="573e" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">然后，它们用自己的有效负载替换任何匹配特定模式的ZIP文件。</li></ul><h1 id="addf" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">供应商正在提供不安全的SDK</h1><p id="a35f" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">Krause的研究强调的攻击途径是一种威胁，因为一件事:供应商正在以一种完全不安全的方式提供SDK。</p><p id="def8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">克劳斯查看了41个最流行的SDK。其中13个可能容易受到中间人攻击，而5个根本没有提供安全下载SDK的方法。其中许多都属于知名科技公司。</p><p id="b357" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">以亚马逊为例(值得称道的是，它在三个工作日内就解决了这个问题)。这家总部位于西雅图的科技巨头通过极不安全的HTTP提供AWS(亚马逊网络服务)SDK下载。</p><p id="b4a8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">另一个主要的SDK提供商Localytics(也解决了这个问题)有一个链接到其SDK的未加密文档子网站。如前所述，攻击者可能截获了该链接，并将其替换为恶意的替代链接。</p><p id="de88" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">根据道德披露程序，Krause给了受影响的SDK开发人员一个有意义的机会在披露前解决问题。这意味着他联系了每个组织内的相关利益相关者，并给他们三个月的时间来解决问题，直到他满意为止。</p><p id="e1a8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个问题很容易解决。与许多需要数周时间调查的漏洞不同，供应商只需确保他们的SDK通过加密渠道下载。</p><p id="8a84" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然而，令人沮丧的是，供应商未能采取任何有意义的行动。在这篇文章发表的五天前，Krause写信告诉我，近三分之二受影响的SDK提供商未能保护他们的SDK下载。他说:</p><blockquote class="ls lt lu"><p id="a7c3" class="jc jd lv je b jf jg jh ji jj jk jl jm lw jo jp jq lx js jt ju ly jw jx jy jz hn dt translated"><em class="hu">我刚刚浏览了列表，检查了SDK提供商是否修复了他们的网站:</em></p><p id="77e7" class="jc jd lv je b jf jg jh ji jj jk jl jm lw jo jp jq lx js jt ju ly jw jx jy jz hn dt translated"><em class="hu">我在2017年11月和12月通知了所有受影响的人，给他们足够的时间来解决这个问题，然后再公开发表博客。在13个受影响的SDK中，1个在三个工作日内解决了问题，4个在一个月内解决了问题，8个SDK在本文发布时仍易受此攻击。仍然受到影响的SDK提供商没有回复我的电子邮件，或者只是回复说“我们会调查这件事”——他们都在最常用的50个SDK中。</em></p><p id="ed7a" class="jc jd lv je b jf jg jh ji jj jk jl jm lw jo jp jq lx js jt ju ly jw jx jy jz hn dt translated"><em class="hu">这令人震惊……</em></p></blockquote><h1 id="b19a" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">软件食物链</h1><p id="8455" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">仔细想想，软件和你可能在超市买的一块牛排没什么不同。你购买它时认为它可以安全食用。要做到这一点，需要在制造过程的每个阶段都进行适当的处理。从农场到餐桌，每个人都需要做好自己的工作。</p><p id="cf8a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">软件有点像。最终用户从他们的超市(在这个场景中，是应用程序商店)购买一个软件，并假设它不会伤害他们。但是为了让这个假设成为现实，每个人都需要遵守安全最佳实践:不仅仅是开发人员。</p><p id="6b45" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="lv">这个故事由</em> <a class="ae ka" href="https://thenextweb.com/author/matthewhughes/" rel="noopener ugc nofollow" target="_blank"> <em class="lv">马修·休斯、</em> </a> <em class="lv">撰写，最初发表在</em><a class="ae ka" href="https://thenextweb.com/security/2018/02/15/want-hack-million-iphones-target-sdks-finds-security-researcher/" rel="noopener ugc nofollow" target="_blank"><em class="lv">Next Web上。</em>T11】</a></p></div></div>    
</body>
</html>