<html>
<head>
<title>What is the math behind elliptic curve cryptography?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">椭圆曲线加密背后的数学原理是什么？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3?source=collection_archive---------0-----------------------#2018-04-07">https://medium.com/hackernoon/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3?source=collection_archive---------0-----------------------#2018-04-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/6e9123f9af20b63fc8b661a62078c3b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*4dcCrlQfGqZECDLy-25fnw.png"/></div></figure><h1 id="f19c" class="iy iz hu bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv dt translated">介绍</h1><p id="3230" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">有人给你寄比特币，就是把比特币寄到你的地址。如果你想花掉寄到你地址的比特币，你可以创建一个交易，并指定你的比特币应该去哪里。这样的交易可能看起来像:</p><pre class="ku kv kw kx fq ky kz la lb aw lc dt"><span id="ea65" class="ld iz hu kz b fv le lf l lg lh">Transfer 5 bitcoin from 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa (your address) to 12c6DSiU4Rq3P4ZxziKxzrL5LmMBrzjrJX (the recipient address).</span></pre><p id="69de" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">当然，任何人都可以创建一个看起来像上面这样的交易，所以如果它被添加到区块链，那么不管你喜欢与否，你都会损失30，000多美元。幸运的是，这样的交易不属于区块链，因为它缺少有效的数字签名。通过添加数字签名，可以证明您知道地址1a 1 ZP 1 EP 5 qgefi 2 dmptftl 5 SLM V7 div fn对应的私钥。如果你不知道相应的私钥，那么你可能不应该告诉人们通过那个地址给你发送比特币，因为你无法花费任何发送到那里的比特币！</p><p id="0c28" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">当您为自己创建比特币地址(或任何其他加密货币的地址/账户)时，您首先生成私钥。从私钥，你计算相应的公钥，并通过散列公钥，你得到你的地址。希望您不能先选择一个地址，然后再从中确定私钥，否则您可以使用相同的方法确定任何地址的私钥。Satoshi的地址是什么？</p><h2 id="8e85" class="ld iz hu bd ja ln lo lp je lq lr ls ji kh lt lu jm kl lv lw jq kp lx ly ju lz dt translated">公钥密码学</h2><p id="8dce" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">公钥、私钥和数字签名构成了公钥加密的基本组成部分。无论使用什么数学基础来实现公钥密码系统，它都必须满足以下条件，至少对于我们的目的来说是这样:</p><ol class=""><li id="384d" class="ma mb hu jy b jz li kd lj kh mc kl md kp me kt mf mg mh mi dt translated">导出对应于给定公钥的私钥在计算上是不可行的。</li><li id="7eb7" class="ma mb hu jy b jz mj kd mk kh ml kl mm kp mn kt mf mg mh mi dt translated">有可能证明一个人知道对应于公钥的私钥，而在此过程中不泄露关于私钥的任何有用信息。此外，这种证明可以通过需要验证特定消息的方式来构建。这样，证据就形成了该消息的数字签名。</li></ol><p id="8005" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">实现公钥加密的一种方法是使用椭圆曲线。另一种方法是RSA，它围绕着质数。大多数加密货币——包括比特币和以太坊——都使用椭圆曲线，因为256位椭圆曲线私钥与3072位RSA私钥一样安全。较小的密钥更易于管理和使用。</p><h1 id="fd5e" class="iy iz hu bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv dt translated">椭圆曲线加密</h1><p id="01f2" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">什么是椭圆曲线？椭圆曲线由满足以下形式的方程的所有点组成:</p><p id="d8a5" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">y = x +ax+b</p><p id="f48c" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">其中4a +27b ≠ 0(这是避免<a class="ae mo" href="http://mathworld.wolfram.com/SingularPoint.html" rel="noopener ugc nofollow" target="_blank">奇点</a>所需要的)。</p><p id="c02d" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">以下是一些椭圆曲线示例:</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div class="fe ff mp"><img src="../Images/856669aa161022cff67b210cac81427a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/0*-8m7N8igyKR2oOUS.gif"/></div></figure><p id="5ced" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">注意上面所有的椭圆曲线都是关于x轴对称的。这对于每条椭圆曲线都是正确的，因为椭圆曲线的方程是:</p><p id="46b2" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">y = x +ax+b</p><p id="b842" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">如果你取两边的平方根，你会得到:</p><p id="877c" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">y = √x +ax+b</p><p id="a44b" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">所以如果a=27，b=2，你代入x=2，你会得到y= 8，从而得到点(2，-8)和(2，8)。</p><p id="ddd1" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">比特币、以太坊和许多其他加密货币使用的椭圆曲线称为secp256k1。secp256k1曲线的方程式为y = x +7。这条曲线看起来像:</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/6e9123f9af20b63fc8b661a62078c3b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*4dcCrlQfGqZECDLy-25fnw.png"/></div></figure><p id="d1fa" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">Satoshi为<a class="ae mo" href="https://bitcointalk.org/index.php?topic=2699.msg37328#msg37328" rel="noopener ugc nofollow" target="_blank">选择了secp256k1没有特别的原因</a>。</p><h2 id="dff9" class="ld iz hu bd ja ln lo lp je lq lr ls ji kh lt lu jm kl lv lw jq kp lx ly ju lz dt translated">点加法</h2><p id="3170" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">你知道怎么把两个数相加得到第三个数吗？您可以将椭圆曲线上的两个点相加，得到曲线上的第三个点。</p><p id="273c" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">要将椭圆曲线上的两点相加，首先要找到通过这两点的直线。然后确定该直线与曲线在第三点的交点。然后你将第三个点反射到x轴上(例如，将y坐标乘以-1 ),你得到的任何点都是前两个点相加的结果。</p><p id="72e0" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">让我们来看一个例子。假设您想将以下两点加在一起:</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff mq"><img src="../Images/0bec7bb1a7b91778bf7150911eb7c2ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2dMrXCboesXX9BcXHYHMwA.png"/></div></div></figure><p id="e354" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">首先，你找到穿过两点的线:</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff mq"><img src="../Images/ede553432e652732bdb11347f9852a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luGABZzpkW5AstetbWnA3w.png"/></div></div></figure><p id="c8ff" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">然后你找到曲线上与直线相交的第三点:</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff mq"><img src="../Images/d4e73d9b021eb6783d4920a96c01ef73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XDkvG91Bi_aaqWA29JSqVw.png"/></div></div></figure><p id="2528" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">然后你在x轴上反射这个点:</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff mq"><img src="../Images/141678af33e77c0b6a7fcedd0e48622e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dErGh_rL2ExM6AX-Rtyb7w.png"/></div></div></figure><p id="79dd" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">因此，P+Q=R。</p><p id="7a4c" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">为了正确地实现椭圆曲线加密，我们在曲线上指定一个基点，并且只将该点添加到自身，而不是将任意两个点相加。</p><p id="7942" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">例如，假设我们有以下以P为基点的曲线:</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff mq"><img src="../Images/adbc54fece2b4d85ec60466fca2e81cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZX2leoe9L1f3-H89B2-krA.png"/></div></div></figure><p id="aa41" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">最初，我们有P，或1p。</p><p id="f703" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">现在让我们把P加上它本身。首先我们要找到穿过P和P的那条线的方程，这样的线有无穷多条！在这种特殊情况下，我们选择切线。</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff mq"><img src="../Images/21690173e26fc7caaf95e87e6cf4bf96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wrHCr_gV3UfSr1fz9jibw.png"/></div></div></figure><p id="a9ec" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">现在我们找到这条线相交的“第三”点，并将其反射到x轴上。</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff mq"><img src="../Images/04bc20891c4b00eb56b161b89f8cffa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ffYKgW-4_Paxve3G1HIJXw.png"/></div></div></figure><p id="1403" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">因此，P加上自身，或P+P，等于2p。</p><p id="81d0" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">如果我们再次将P加到自身上，我们将计算P加到自身上，或者P+P+P。结果将是3p。为了计算3p，我们可以将P和2p加在一起。</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff mq"><img src="../Images/061320d591e1387aea3878474eecffda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3u4bRa2Nbb4fQWW1Bn7TIQ.png"/></div></div></figure><p id="e47d" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">我们可以继续把P加到它本身来计算4p和5p等等。</p><p id="4ea6" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">secp256k1曲线使用的基点具有以下x和y坐标:</p><p id="ee95" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">x坐标:5506626302227734366957871889516853432625060345377594175500187360389116729240</p><p id="011d" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">y坐标:<br/>2267051002075816978083085，13050704，18441，2735383，3804，2844，2755，3757，3748，2845，2845</p><p id="f36d" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">在上面的例子中，使用了一个不同的基点，这样所有的点添加操作都适合一个小窗口。</p><h2 id="7b49" class="ld iz hu bd ja ln lo lp je lq lr ls ji kh lt lu jm kl lv lw jq kp lx ly ju lz dt translated">加速点加法</h2><p id="bca0" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">计算10p需要多少步？看起来需要九个步骤，因为10p是</p><p id="bf38" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">P+P+P+P+P+P+P+P+P+P+P</p><p id="b7b3" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">这需要九个点加法运算。</p><p id="a1f6" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">原来只需要四个步骤就可以计算出10p。这是因为以下属性适用于点加法:</p><p id="59f7" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">NP+RP =(n+r)P</p><p id="5b50" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">例如:</p><p id="166b" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">4p+6p =(4+6)P = 10p</p><p id="12f8" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">因此，快速计算10p的方法如下:</p><p id="31d7" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">P+P = 2p</p><p id="2583" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">2p+2p = 4p</p><p id="5810" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">4p+4p = 8p</p><p id="d86b" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">2p+8p = 10p</p><p id="19b8" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">这仅需要四次点加法运算。</p><p id="97ed" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">计算x P需要多少步，其中x是一个随机的256位整数？在这种情况下，x的范围可以是从0到1.1579209e+77。</p><p id="bc16" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">事实证明，计算x P永远不会需要510次以上的加法运算。原因如下。首先，计算以下系列:</p><p id="f7fd" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">2⁰•P，2p，2p，2p，2⁴•P，2⁵•P，2⁶•P，…，2 ⁵⁵•P.</p><p id="7a9a" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">你可以用255个点的加法运算来计算上面的数列，因为有256个点，把当前点加到它本身就可以从一个点得到下一个点。这是因为2^n•P+2^n•P = 2^(n+1)•P.给出了第一点2⁰•P。2⁰•P=1•P=P.</p><p id="c479" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">下一步是求x的二进制展开式，比如x是246，二进制展开式就是2⁷ + 2⁶ + 2⁵ + 2⁴ +2 + 2 = 246。然后我们把x的二进制展开式乘以p:2⁷•P+2⁶•p+2⁵•p+2⁴•p+2p+2p .然后我们简单地把所有这些点加在一起得到246 p .我们不必计算单独的点2p，2p，…，2⁷•p，因为我们前面已经计算过了。</p><p id="f927" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">最多x的二进制扩展将包含256个元素(2⁰高达2个⁵⁵)，因此我们将永远不必将超过256个点相加在一起，因此，第二步将需要最多255个点加法运算。因此，计算x P最多需要255+255=510次加法运算。</p><h1 id="e079" class="iy iz hu bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv dt translated">椭圆曲线密码中的私钥和公钥</h1><p id="fe68" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">假设我计算XP，其中x是一个随机的256位整数。结果将是曲线上的某个点。让我们称之为x点。</p><p id="a878" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">如果我给你X，你能确定X吗？换句话说，你能确定我把P加了多少次才能得到曲线上的点X吗？假设你知道P是什么，也知道我用的是什么曲线。</p><p id="3f0d" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">事实证明，即使你有一台超级计算机，你也不可能算出x。没有已知的算法来确定x，因此您唯一的选择是继续将p与自身相加，直到得到x，或者继续从x中减去p，直到得到p。平均而言，x将介于0和2 ⁵⁶-1之间，约为2 ⁸.因此，不管你用什么方法，平均要用2次⁸点加法运算来确定x。即使你的计算机每秒能做一万亿次点加法运算，而且你从宇宙开始就一直在运行你的计算机，你现在也只能做2⁹⁸点加法运算。2⁹⁸/2 ⁸ =1/1073741824.</p><p id="47a8" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">如果从中间开始呢？你可以在510步或更少的时间内计算出2个⁸•P。平均来说，x与2 ⁸的距离并不比与0或2 ⁵⁶-1的距离更近，因为x是随机的，所以从哪里开始并不重要——平均来说，你仍然需要做2次⁸点加法运算。</p><h2 id="f7ba" class="ld iz hu bd ja ln lo lp je lq lr ls ji kh lt lu jm kl lv lw jq kp lx ly ju lz dt translated">私钥和公钥</h2><p id="3387" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">所以，因为有人无法求出给定X的X，其中X = x，所以让X成为你的私钥，X成为你的公钥可能会比较方便。你的私钥将是一个随机的256位整数，而你的公钥将是椭圆曲线上一个点的x和y坐标。这将满足私钥和公钥的以下属性:</p><p id="692a" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">"从计算上推导出对应于给定公钥的私钥是不可行的."</p><p id="acfb" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">此外，虽然我们还没有讨论这一点，但向某人证明你知道X，而不透露任何关于X的有用信息是可能的。也就是说，你可以向某人展示你知道你必须将P加到它本身多少次才能得到X，而不直接告诉他们X是什么。</p><h1 id="a767" class="iy iz hu bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv dt translated">更新椭圆曲线模型</h1><p id="82a2" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">在我们开始向某人证明你知道x之前，我们应该更新我们的椭圆曲线模型。</p><p id="b056" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">我们当前模型的一个问题是，XP可能导致一个点的x和y坐标不能存储在标准的512位公钥中。x或y坐标可能太长。</p><p id="2274" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">解决方法是在有限域上定义我们的椭圆曲线。基本上，我们将确保只有整数点，并且一个点的坐标可以达到多大是有限制的。</p><p id="4118" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">为此，我们进行了转型</p><p id="231c" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">y = x +ax+b</p><p id="61a4" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">到</p><p id="6183" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">y mod p = (x + ax + b) mod p</p><p id="dc6c" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">其中p是某个质数(p是质数，以确保加法和乘法运算总是可以撤消)。</p><p id="781e" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">在secp256k1中，p是小于2 ⁵⁶.的最大素数</p><p id="3980" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">我们的椭圆曲线现在看起来像这样:</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div class="fe ff mv"><img src="../Images/06b7319993cd536f030948e8d7a64d53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*AD8StsqpNtsV41gK08U75g.png"/></div></figure><p id="e80f" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">请注意，仍然有一条对称的水平线。</p><p id="7c7a" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">那么，当你把两个点加在一起，这两个点之间的线在与第三个点相交之前超出了界限，会发生什么呢？你把线绕在边界上！</p><figure class="ku kv kw kx fq iv fe ff paragraph-image"><div class="fe ff mw"><img src="../Images/a6ac6d8a644d549d6ef69cd84751fe29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*sd7awmC89BsBpEtC-NbSpw.png"/></div></figure><p id="3a74" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">在上图中，你可以看到将P和Q相加需要将P和Q之间的线环绕边界几次。</p><p id="517e" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">尽管我们的模型发生了这些变化，我们到目前为止所讨论的一切仍然适用。</p><h1 id="1f45" class="iy iz hu bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv dt translated">如何证明自己认识x</h1><p id="52b8" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">那么如果你计算X = x，其中X是一个随机的256位整数，你如何向某人证明你知道X对应的X，而不泄露任何关于X的有用信息呢？</p><p id="cb43" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">您可以使用前面的点加法属性:</p><p id="a71b" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">NP+RP =(n+r)P</p><p id="138b" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">我们将稍微修改一下:</p><p id="4c49" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">hash(m，RP)NP+RP =(hash(m，RP)* n+r)P</p><p id="4e15" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">如果你展开上面等式的右边，你会得到左边，所以上面的等式对任何m，r和n都成立。</p><p id="0697" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">如果我们设NP = X会发生什么？我们将有:</p><p id="95b9" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">哈希(m，RP)X+RP =(哈希(m，RP)* n+r)P</p><p id="b362" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">如果NP = X，则n=x，因此我们有:</p><p id="01f0" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">hash(m，RP)X+RP =(hash(m，RP)* X+r)</p><p id="085c" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">现在我们要做如下替换:R = r，s=hash(m，R)*x+r。</p><p id="3466" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">所以现在我们有:</p><p id="133e" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">hash(m，R)X+R = sp</p><p id="f08d" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">好了，这里是主张:如果你能提供一个满足上式的m，R，s，那么这就证明你知道了方程中X对应的X，其中XP = X。</p><p id="264a" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">为此，必须满足以下两个条件:</p><ol class=""><li id="056b" class="ma mb hu jy b jz li kd lj kh mc kl md kp me kt mf mg mh mi dt translated">如果你知道x，那么你应该能够提供m，R和s的工作值。</li><li id="b6d5" class="ma mb hu jy b jz mj kd mk kh ml kl mm kp mn kt mf mg mh mi dt translated">如果你不知道x，那么你应该不能提供m，R和s的工作值。</li></ol><p id="32c6" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">如果您知道X，您可以清楚地得出m、R和s的工作值。为m和R选择随机值，然后计算R = r和s=hash(m)*x+r。如果您将这些值代入hash(m，R)X+R = sp，则您会得到:</p><p id="374f" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">hash(m，RP)XP+RP =(hash(m，RP)* x+r)P</p><p id="1a4e" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">这是我们之前说过的方程，适用于任何m，r和n(在这种情况下x是n)。</p><p id="3d4b" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">不知道x怎么办？你能给出m、R和s的工作值吗？问题是，您必须求解hash(m，R)X+R = sp。基本上，您必须为具有特定哈希值的哈希找到一个输入，这是不可能的，或者至少在计算上是不可行的，因为加密哈希函数的<a class="ae mo" href="https://en.wikipedia.org/wiki/Preimage_attack" rel="noopener ugc nofollow" target="_blank">原像抵抗属性</a>。</p><p id="2a63" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">因此，提供m、R和s的工作值的唯一方法是使用X来计算它们。因此，您可以通过提供满足hash(m，R)X+R = sp的m、R和s的值来证明您知道与公钥X一起使用的私钥X。</p><h2 id="cfd5" class="ld iz hu bd ja ln lo lp je lq lr ls ji kh lt lu jm kl lv lw jq kp lx ly ju lz dt translated">你通过证明你认识x来透露任何关于x的有用信息吗？</h2><p id="d99a" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">如果你提供了m、R和s的工作值，你能从这些值中收集到任何关于x的有用信息吗？</p><p id="901e" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">m和R与x无关，所以那些值不能揭示任何关于x的有用信息。</p><p id="6ac1" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">我们知道s=hash(m，R)*x+r，有人能从s计算出x吗？</p><p id="63c4" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">为此，他们必须求解x=(s-r)/hash(m，R)。</p><p id="8d01" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">因为他们不知道R，他们不能从s计算x。他们不能从R = r(他们被给定R)的事实中获得R，因为这与确定P必须与自身相加多少次才能获得R是一样的，这与阻止某人从x确定x的计算不可行问题是一样的。</p><p id="c964" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">s也不透露任何关于x的信息，比如“x一定小于yadda yadda”。如果R是随机生成的，我们允许hash(m，R)*x+r溢出，因此R可以是任何256位整数，那么s的值是完全随机的，这意味着s可以是任何256位整数。一个随机的256位整数可以告诉你相当于新西兰GDP的x值。</p><h2 id="ef8a" class="ld iz hu bd ja ln lo lp je lq lr ls ji kh lt lu jm kl lv lw jq kp lx ly ju lz dt translated">数字签名</h2><p id="cfd4" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">m、R和s可用于证明知道对应于X的X，其中X = x。验证证明需要将m、R和s插入hash(m，R)X+R = sp。我们是否可以这样做，即验证成功需要特定的消息，以便证明(m、R和s)形成该消息的数字签名？是啊！</p><p id="362e" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">设m是特定消息，R和s是该消息的数字签名。只有当特定消息m被插入到验证等式中时，验证过程才会成功。如果插入不同的m值，那么hash(m，R)X+R = sp的左侧将无法等于右侧，因为s是使用不同的消息计算的。</p><p id="7cab" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">因此，通过提供m的数字签名R和s，可以证明他们知道对应于特定消息m的公钥X的私钥X。</p><p id="6e83" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">对于加密货币，消息将是交易的未签名部分。如果您曾经研究过交易的数字签名，它通常是R (R是曲线上的一个点)的x坐标与s (s是一个看似随机的256位整数)连接在一起，经过编码并转换为十六进制。</p><h1 id="c254" class="iy iz hu bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv dt translated">结论</h1><p id="c208" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">如果你想获得一个比特币地址或以太坊账户，你生成一个随机的256位整数x，x就是你的私钥。然后，使用secp256k1曲线的参数计算X = x。x将是你的公钥。您的公钥可以安全地给出，不能用来确定您的私钥。如果你散列你的公钥，你将获得你的地址。</p><p id="cd8a" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">当你想把比特币或者以太从你的地址发到另一个地址，你就创建了一个交易。您将m设置为该事务的无符号部分，并根据该m计算R和s，然后将R和s附加到该事务。在您广播您的事务后，任何节点都能够验证m(事务的未签名部分)、R和s满足hash(m，R)X+R = sp。这当然假设您也将X包括在您的事务中，因为您的公钥不能从您的地址中确定。对于以太坊，不是提供X，而是提供v，这允许我们从R和s中确定X。</p><h2 id="d4f8" class="ld iz hu bd ja ln lo lp je lq lr ls ji kh lt lu jm kl lv lw jq kp lx ly ju lz dt translated">结束了</h2><p id="fbce" class="pw-post-body-paragraph jw jx hu jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hn dt translated">嗯，就这样结束了！如果你已经做到了这一步，并且理解了几乎所有的事情，那么恭喜你！如果你想要一个更高层次的椭圆曲线加密的解释(更数学)，那么看看这个<a class="ae mo" href="http://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gentle-introduction/" rel="noopener ugc nofollow" target="_blank">链接</a>。这是我的第一篇文章，如果有错误请告诉我，并留下反馈。</p><p id="7f3d" class="pw-post-body-paragraph jw jx hu jy b jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt hn dt translated">感谢阅读！</p></div></div>    
</body>
</html>