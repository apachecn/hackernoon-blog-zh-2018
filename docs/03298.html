<html>
<head>
<title>Read Arduino Serial Monitor Using NodeJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NodeJS读取Arduino串行监视器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/arduino-serial-data-796c4f7d27ce?source=collection_archive---------1-----------------------#2018-04-15">https://medium.com/hackernoon/arduino-serial-data-796c4f7d27ce?source=collection_archive---------1-----------------------#2018-04-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/6d287ff6c10bee208f7b32a0d9d924e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_rCAOtdJqRoqKVXUDtS5dQ.jpeg"/></div></div></figure><blockquote class="jc jd je"><p id="922d" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这是一篇关于如何从arduino读取串口值到in <a class="ae ke" href="https://hackernoon.com/tagged/nodejs" rel="noopener ugc nofollow" target="_blank"> NodeJS </a>的简短教程文章。</p></blockquote><h1 id="cb98" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated"><strong class="ak">动机</strong></h1><p id="f36e" class="pw-post-body-paragraph jf jg hu ji b jj ld jl jm jn le jp jq lf lg jt ju lh li jx jy lj lk kb kc kd hn dt translated">因此，在我参与的一个项目中，我必须从我的节点控制台中的串行监视器获取数据，然后使用web套接字在基于web的应用程序中显示数据。但是，我很难弄清楚如何获取数据，我探索并找到了<a class="ae ke" href="https://www.npmjs.com/package/serialport" rel="noopener ugc nofollow" target="_blank"> serialport </a> npm模块，但它给出的输出是缓冲区的形式，不是我想要的确切单词。花了一些时间后，我终于明白了如何去做。因此，我分享这一点，以便它可以帮助任何人试图这样做。</p><h1 id="cbdb" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">arduino和其他外设如何与笔记本电脑通信？</h1><p id="2689" class="pw-post-body-paragraph jf jg hu ji b jj ld jl jm jn le jp jq lf lg jt ju lh li jx jy lj lk kb kc kd hn dt translated">在大多数情况下，答案是“串行通信”。在串行通信中，数据可以通过电线“串行”逐位发送。<br/>下图一目了然，清晰地展示了串行和并行通信。</p><figure class="lm ln lo lp fq iv fe ff paragraph-image"><div class="fe ff ll"><img src="../Images/fecdca6dcd82a3ad77c6a57c131d8d22.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/0*LDHcLKIlt4CeYDaZ.gif"/></div></figure><p id="40f1" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">记住这篇文章的主要焦点，我将在这里停止讨论，直接进入正题。不过，如果你想了解更多关于串行通信的内容，可以参考<a class="ae ke" href="https://en.wikipedia.org/wiki/Serial_communication" rel="noopener ugc nofollow" target="_blank">维基百科</a>如果你想了解arduino中的串行通信，可以参考arduino 的<a class="ae ke" href="https://www.arduino.cc/reference/en/language/functions/communication/serial/" rel="noopener ugc nofollow" target="_blank">官网。</a></p><h1 id="2c98" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">关于我的项目！</h1><p id="6d74" class="pw-post-body-paragraph jf jg hu ji b jj ld jl jm jn le jp jq lf lg jt ju lh li jx jy lj lk kb kc kd hn dt translated">我用arduino做了一个自来水浪费检测系统。这是基于一个简单的想法，结合雨水模块和超声波传感器。</p><figure class="lm ln lo lp fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lq"><img src="../Images/9df56eca1d1e622010f31408dfb8c2cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_cr6t9PZ9in90YoKqNaCeg.png"/></div></div></figure><p id="a9f4" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated"><strong class="ji hv">超声波传感器与水浪费检测有什么关系？<br/> </strong>很简单，使用雨水模块，我在感应是否有水滴落在上面，但是，即使水滴落在雨水模块上，也不能得出浪费水的结论。可能的情况是，一个人正在从水龙头喝水，不知何故一些水落在模块上。显然，我不想在这种情况下启动我的水浪费检测系统。<br/>因此，为了防止错误输出，当雨滴模块感应到水浪费时，超声波传感器用于检测附近是否有人。这个想法很简单，如果水龙头是关着的，这意味着水没有被浪费(天才！)，如果水龙头是开着的，一个人在它的附近(比如70厘米)，这也意味着水没有被浪费(这个人可能正在使用)。但是，如果水龙头开着，附近没有人，这显然意味着水被浪费了，探测器现在可以发出警报。</p><figure class="lm ln lo lp fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lr"><img src="../Images/5ba57407d7622594d66fa509d6596ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zy1w7g5Jydl8Led9tVwgnw.png"/></div></div></figure><p id="9859" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">因此，基本上这个项目结合使用雨滴模块和超声波传感器来检测水的浪费。<br/> <a class="ae ke" href="https://drive.google.com/file/d/1K2GR_Udl4kT7z_0gJZtiB2dLcLeIOvwo/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里下载代码</a></p><h1 id="096d" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">所需输出…</h1><figure class="lm ln lo lp fq iv fe ff paragraph-image"><div class="fe ff ls"><img src="../Images/8577252a5297af9de4012d3759f61335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/1*jJ0HMB2ggT8cIOVRkTD60w.gif"/></div></figure><p id="e3b1" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">这是串行监视器上的输出，我打算在我的节点服务器上获取，然后使用web sockets，给出关于tap的实时更新。让我们为它写一个脚本:)</p><p id="35cd" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">一个很好的问题是，我们能把硬件和JavaScript结合起来吗？最初，JS并不打算与硬件一起使用，但是现在这种语言已经取得了很大的进步，是的，它可以被使用。<br/>阅读这篇有趣的文章:<a class="ae ke" href="http://www.voodootikigod.com/nodebots-the-rise-of-js-robotics/" rel="noopener ugc nofollow" target="_blank">node bots——JS机器人的崛起</a>。</p><h1 id="b94d" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">入门—安装串行端口库</h1><p id="2f5f" class="pw-post-body-paragraph jf jg hu ji b jj ld jl jm jn le jp jq lf lg jt ju lh li jx jy lj lk kb kc kd hn dt translated">serialport库为结合硬件项目和JavaScript提供了强大的支持。</p><blockquote class="jc jd je"><p id="9077" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">想象一个你可以编写JavaScript来控制搅拌机、灯、安全系统甚至机器人的世界。没错——机器人！感谢Node Serialport，这个世界就在这里。</p></blockquote><p id="d983" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">访问<a class="ae ke" href="https://www.npmjs.com/package/serialport" rel="noopener ugc nofollow" target="_blank">此链接</a>获取完整的API文档。</p><p id="53f5" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">所以，首先，就像我们对待任何节点模块一样，我们会安装它。</p><pre class="lm ln lo lp fq lt lu lv lw aw lx dt"><span id="01eb" class="ly kg hu lu b fv lz ma l mb mc">$ npm install --save serialport</span></pre><p id="0f31" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">这个节点模块下载完了，我们终于可以开始了:)</p><h1 id="f32c" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">打开端口并读取值</h1><p id="3399" class="pw-post-body-paragraph jf jg hu ji b jj ld jl jm jn le jp jq lf lg jt ju lh li jx jy lj lk kb kc kd hn dt translated">就像在arduino程序中一样，在任何真正的通信发生之前，我们需要打开端口。这可以通过下面这段代码来完成。</p><pre class="lm ln lo lp fq lt lu lv lw aw lx dt"><span id="544b" class="ly kg hu lu b fv lz ma l mb mc">var SerialPort = require('serialport');</span><span id="58e8" class="ly kg hu lu b fv md ma l mb mc">var serialPort = new SerialPort('/dev/ttyACM0', {<br/>    baudrate: 9600<br/>});</span></pre><p id="b96e" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">您必须写下您的端口名称，而不是<code class="eh me mf mg lu b">/dev/ttyACM0</code>。它在windows上类似于<code class="eh me mf mg lu b">COM17</code>，或者在基于UNIX的系统上类似于上面提到的。</p><p id="8ac6" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">既然端口已经打开，我们终于可以插入arduino并使用下面的代码获取数据了。</p><pre class="lm ln lo lp fq lt lu lv lw aw lx dt"><span id="2d5a" class="ly kg hu lu b fv lz ma l mb mc">// Switches the port into "flowing mode"<br/>serialPort.on('data', function (data) {<br/>    console.log('Data:', data);<br/>});</span><span id="13b7" class="ly kg hu lu b fv md ma l mb mc">// Read data that is available but keep the stream from entering //"flowing mode"<br/>serialPort.on('readable', function () {<br/>    console.log('Data:', port.read());<br/>});</span></pre><p id="7d79" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated"><strong class="ji hv">牛逼！！！我们已经完成了代码，让我们尝试一下。</strong></p><pre class="lm ln lo lp fq lt lu lv lw aw lx dt"><span id="d567" class="ly kg hu lu b fv lz ma l mb mc">$ node filename.js</span></pre><figure class="lm ln lo lp fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mh"><img src="../Images/a331e2b0e976e2ed2daa5cbd4e36a04c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*YaqEWElskjJhE6QXcVP4QA.gif"/></div></div><figcaption class="mi mj fg fe ff mk ml bd b be z ek">Wait! What!?</figcaption></figure><p id="66d4" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">这就是我之前所说的。它不是给出文本，而是给出数据缓冲区。</p><p id="b04c" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated"><strong class="ji hv">不用担心！</strong> <br/>文本数据很容易解析获得。使用下面给出的代码来这样做！</p><pre class="lm ln lo lp fq lt lu lv lw aw lx dt"><span id="fd28" class="ly kg hu lu b fv lz ma l mb mc">// Require the serialport node module<br/>var serialport = require('serialport');<br/>var SerialPort = serialport.SerialPort;</span><span id="20fc" class="ly kg hu lu b fv md ma l mb mc">// Open the port<br/>var port = new SerialPort("/dev/ttyACM0", {<br/>    baudrate: 9600,<br/>    parser: serialport.parsers.readline("\n")<br/>});</span><span id="0393" class="ly kg hu lu b fv md ma l mb mc">// Read the port data<br/>port.on("open", function () {<br/>    console.log('open');<br/>    port.on('data', function(data) {<br/>        console.log(data);<br/>    });<br/>});</span></pre><p id="eaf4" class="pw-post-body-paragraph jf jg hu ji b jj jk jl jm jn jo jp jq lf js jt ju lh jw jx jy lj ka kb kc kd hn dt translated">好吧，让我们运行这段代码！</p><figure class="lm ln lo lp fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mh"><img src="../Images/d4a7db6d470fefb275558c87e3840d3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pd6nV0roRZUunSDPLpAeLA.gif"/></div></div><figcaption class="mi mj fg fe ff mk ml bd b be z ek">Yay! It worked!</figcaption></figure><h1 id="8821" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">结论</h1><p id="f586" class="pw-post-body-paragraph jf jg hu ji b jj ld jl jm jn le jp jq lf lg jt ju lh li jx jy lj lk kb kc kd hn dt translated">本文主要是关于JavaScript和硬件的，重点是使用NodeJs与串口通信。希望它能帮助你，以防你像我一样被困在数据缓冲区中。</p><blockquote class="jc jd je"><p id="3b61" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">非常感谢你保持冷静，一直读到最后。<br/>一切顺利，快乐编码！<br/>有任何疑问或者需要任何帮助都可以联系我:<br/>邮箱:madhavbahl10@gmail.com<br/>网页:<a class="ae ke" href="http://www.madhavbahl.tech/" rel="noopener ugc nofollow" target="_blank">http://www.madhavbahl.tech/</a>T6】Github:<a class="ae ke" href="https://github.com/MadhavBahlMD" rel="noopener ugc nofollow" target="_blank">https://github.com/MadhavBahlMD</a>T9】LinkedIn:<a class="ae ke" href="https://www.linkedin.com/in/madhavbahl/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/madhavbahl/</a></p></blockquote><figure class="lm ln lo lp fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure></div></div>    
</body>
</html>