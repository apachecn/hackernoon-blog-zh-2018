<html>
<head>
<title>Don’t be fooled — Deceptive Cryptocurrency Price Predictions Using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要被愚弄-使用深度学习的欺骗性加密货币价格预测</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/dont-be-fooled-deceptive-cryptocurrency-price-predictions-using-deep-learning-bf27e4837151?source=collection_archive---------1-----------------------#2018-04-16">https://medium.com/hackernoon/dont-be-fooled-deceptive-cryptocurrency-price-predictions-using-deep-learning-bf27e4837151?source=collection_archive---------1-----------------------#2018-04-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="a0f3" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">为什么你应该谨慎对待神经网络交易</h2></div><p id="2953" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">所以我建立了一个深度神经网络来预测比特币的价格——它惊人地准确。</p><p id="2cb1" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">好奇？</p><p id="01b1" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">自己看预测结果。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kf"><img src="../Images/6253dcdbbf01e88a6183176b23e7f932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yvJxjj91bptjak3Xy3i1oQ.png"/></div></div></figure><p id="ef8d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">看起来很准确，不是吗？</p><p id="652d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在你问之前:是的，上面的评估是在看不见的测试数据上执行的——只有先前的数据被用来训练模型(后面有更多细节)。</p><p id="a044" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">所以这是一台我可以用来致富的赚钱机器！</p><p id="1152" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对吗？</p><p id="fc92" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">事实上，我给你的是上述型号的<a class="ae kr" href="https://github.com/neocortex/lstm-bitcoin-prediction" rel="noopener ugc nofollow" target="_blank">代码</a>，这样你就可以自己使用了…</p><h2 id="039d" class="ks kt hu bd ku kv kw kx ky kz la lb lc js ld le lf jw lg lh li ka lj lk ll lm dt translated">好的，<em class="ln">停在那里</em>。不要这样做。</h2><p id="291a" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">我重复一遍:<em class="lt">不要做！</em>不要用来交易。</p><p id="ebf9" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">不要被骗了。</p><p id="1d96" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这些结果完全是骗人的。</p><p id="5fb2" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我解释一下。</p><h1 id="4e75" class="lu kt hu bd ku lv lw lx ky ly lz ma lc ja mb jb lf jd mc je li jg md jh ll me dt translated">好得难以令人相信</h1><p id="c65b" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">在过去的几周和几个月里，我遇到了许多文章，它们采取了与这里介绍的方法类似的方法，并显示了类似于上面的加密货币价格预测图。</p><p id="194e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">价格预测看似惊人的准确性应该会立即敲响警钟。</p><p id="ddbe" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这些结果显然好得令人难以置信。</p><blockquote class="mf"><p id="38ce" class="mg mh hu bd mi mj mk ml mm mn mo ke ek translated">"当一件事看起来好得不真实时，它通常是真实的."—艾米·罗森</p></blockquote><p id="79a0" class="pw-post-body-paragraph jj jk hu jl b jm mp iv jo jp mq iy jr js mr ju jv jw ms jy jz ka mt kc kd ke hn dt translated">在下面，我想证明为什么会这样。</p><p id="9249" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">不要误解我——我的意图不是要破坏那些文章中的工作。他们是好的，应该得到掌声。事实上，这些方法中有许多是非常精确的——从技术上讲<em class="lt"/>。</p><p id="be27" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">本文的目的是揭示为什么这些模型在实践中是错误的，以及为什么它们的预测不一定适合在实际交易中使用。</p><p id="38ef" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">那么到底为什么会这样呢？让我们仔细看看。</p><h1 id="9453" class="lu kt hu bd ku lv lw lx ky ly lz ma lc ja mb jb lf jd mc je li jg md jh ll me dt translated">使用LSTMs预测比特币的价格</h1><p id="fff9" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">为了解释，让我带你看一个例子，构建一个多维<a class="ae kr" href="https://en.wikipedia.org/wiki/Long_short-term_memory" rel="noopener ugc nofollow" target="_blank">长短期记忆(LSTM) </a>神经网络来预测比特币的价格，产生你在上面看到的预测结果。</p><p id="ee31" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">LSTMs是一种特殊的<a class="ae kr" href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/" rel="noopener ugc nofollow" target="_blank">递归神经网络(RNN) </a>，特别适用于时间序列问题。因此，当试图预测加密货币价格和股票市场时，它们变得很受欢迎。</p><blockquote class="mu mv mw"><p id="38ca" class="jj jk lt jl b jm jn iv jo jp jq iy jr mx jt ju jv my jx jy jz mz kb kc kd ke hn dt translated">对于LSTMs的深入介绍，我推荐<a class="ae kr" href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">这篇</a>和<a class="ae kr" href="http://blog.echen.me/2017/05/30/exploring-lstms/" rel="noopener ugc nofollow" target="_blank">这篇</a>文章。</p></blockquote><p id="2093" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于LSTM的当前实现，我使用了Python和Keras。<em class="lt">(在我的Github </em>  <em class="lt">上可以找到对应的Jupyter笔记本，代码完整</em> <a class="ae kr" href="https://github.com/neocortex/lstm-bitcoin-prediction" rel="noopener ugc nofollow" target="_blank"> <em class="lt">)。)</em></a></p><h2 id="d6d8" class="ks kt hu bd ku kv kw kx ky kz la lb lc js ld le lf jw lg lh li ka lj lk ll lm dt translated">1.获取数据</h2><p id="021c" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">首先，我获取了历史比特币价格数据(你也可以对任何其他加密货币这样做)。为此，我使用了来自<a class="ae kr" href="http://www.cryptocompare.com" rel="noopener ugc nofollow" target="_blank"> cryptocompare </a>的API:</p><pre class="kg kh ki kj fq na nb nc nd aw ne dt"><span id="b5d6" class="ks kt hu nb b fv nf ng l nh ni">import json<br/>import requests<br/>import pandas as pd</span><span id="d086" class="ks kt hu nb b fv nj ng l nh ni">endpoint = 'https://min-api.cryptocompare.com/data/histoday'<br/>res = requests.get(endpoint + '?fsym=BTC&amp;tsym=USD&amp;limit=2000')<br/>hist = pd.DataFrame(json.loads(res.content)['Data'])<br/>hist = hist.set_index('time')<br/>hist.index = pd.to_datetime(hist.index, unit='s')<br/>hist.head()</span></pre><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nk"><img src="../Images/176b5b1c8fd20a205e118bd89e5d515c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gwv75WlIOyoarOPgtTyu-w.png"/></div></div><figcaption class="nl nm fg fe ff nn no bd b be z ek">A snapshot of historic Bitcoin price data.</figcaption></figure><p id="fd9d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">瞧，过去<em class="lt"> 2000 </em>天的历史每日BTC数据，从<em class="lt">2012–10–10</em>到<em class="lt">2018–04–04</em>。</p><h2 id="297e" class="ks kt hu bd ku kv kw kx ky kz la lb lc js ld le lf jw lg lh li ka lj lk ll lm dt translated">2.列车测试分离</h2><p id="0f33" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">然后，我将数据分成<em class="lt">训练</em>和<em class="lt">测试</em>组。我使用了数据的最后<em class="lt"> 10% </em>进行测试，将<em class="lt">2017–09–14上的数据进行拆分。</em>此日期之前的所有数据用于训练，此日期之后的所有数据用于测试训练好的模型。下面，我绘制了我们数据框架的<code class="eh np nq nr nb b">close</code>列，这是我打算预测的每日收盘价。</p><pre class="kg kh ki kj fq na nb nc nd aw ne dt"><span id="bcda" class="ks kt hu nb b fv nf ng l nh ni">def train_test_split(df, test_size=0.1):<br/>    split_row = len(df) - int(test_size * len(df))<br/>    train_data = df.iloc[:split_row]<br/>    test_data = df.iloc[split_row:]<br/>    return train_data, test_data</span><span id="f694" class="ks kt hu nb b fv nj ng l nh ni">def line_plot(line1, line2, label1=None, label2=None, title=''):<br/>    fig, ax = plt.subplots(1, figsize=(16, 9))<br/>    ax.plot(line1, label=label1, linewidth=2)<br/>    ax.plot(line2, label=label2, linewidth=2)<br/>    ax.set_ylabel('price [USD]', fontsize=14)<br/>    ax.set_title(title, fontsize=18)<br/>    ax.legend(loc='best', fontsize=18)</span><span id="bb33" class="ks kt hu nb b fv nj ng l nh ni">train, test = train_test_split(hist, test_size=0.1)<br/>line_plot(train.close, test.close, 'training', 'test', 'BTC')</span></pre><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff ns"><img src="../Images/429ff76ee0c190dee6bd79bda4ff6ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QxmJoou38hM0CBIZ_n2mrg.png"/></div></div><figcaption class="nl nm fg fe ff nn no bd b be z ek">Train-test split of historic Bitcoin price data</figcaption></figure><h2 id="235e" class="ks kt hu bd ku kv kw kx ky kz la lb lc js ld le lf jw lg lh li ka lj lk ll lm dt translated">3.构建模型</h2><p id="9566" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">为了训练LSTM，数据被分成<code class="eh np nq nr nb b">7</code>天的窗口(这个数字是任意的，我在这里简单地选择了一周),并且在每个窗口内，我将数据归一化为<em class="lt">零基数</em>，即每个窗口的第一个条目是<code class="eh np nq nr nb b">0</code>,并且所有其他值表示相对于第一个值的变化。因此，我预测价格<em class="lt">变化</em>，而不是绝对价格。</p><pre class="kg kh ki kj fq na nb nc nd aw ne dt"><span id="1f11" class="ks kt hu nb b fv nf ng l nh ni">def normalise_zero_base(df):<br/>    """ Normalise dataframe column-wise to reflect changes with<br/>        respect to first entry.<br/>    """<br/>    return df / df.iloc[0] - 1</span><span id="4182" class="ks kt hu nb b fv nj ng l nh ni">def extract_window_data(df, window=7, zero_base=True):<br/>    """ Convert dataframe to overlapping sequences/windows of<br/>        length `window`.<br/>    """<br/>    window_data = []<br/>    for idx in range(len(df) - window):<br/>        tmp = df[idx: (idx + window)].copy()<br/>        if zero_base:<br/>            tmp = normalise_zero_base(tmp)<br/>        window_data.append(tmp.values)<br/>    return np.array(window_data)</span><span id="d76a" class="ks kt hu nb b fv nj ng l nh ni">def prepare_data(df, window=7, zero_base=True, test_size=0.1):<br/>    """ Prepare data for LSTM. """<br/>    # train test split<br/>    train_data, test_data = train_test_split(df, test_size)<br/>    <br/>    # extract window data<br/>    X_train = extract_window_data(train_data, window, zero_base)<br/>    X_test = extract_window_data(test_data, window, zero_base)<br/>    <br/>    # extract targets<br/>    y_train = train_data.close[window:].values<br/>    y_test = test_data.close[window:].values<br/>    if zero_base:<br/>        y_train = y_train / train_data.close[:-window].values - 1<br/>        y_test = y_test / test_data.close[:-window].values - 1</span><span id="9509" class="ks kt hu nb b fv nj ng l nh ni">    return train_data, test_data, X_train, X_test, y_train, y_test</span><span id="8a6c" class="ks kt hu nb b fv nj ng l nh ni">train, test, X_train, X_test, y_train, y_test = prepare_data(hist)</span></pre><p id="c396" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我使用了一个简单的神经网络，它有一个由<code class="eh np nq nr nb b">20</code>神经元组成的LSTM层，一个<code class="eh np nq nr nb b">0.25</code>的漏失因子，一个具有单个<em class="lt">线性</em>激活函数的密集层。此外，我使用<em class="lt">平均绝对误差(MAE) </em>作为损失函数和<em class="lt"> Adam </em>优化器。</p><p id="dded" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我用批量大小为<code class="eh np nq nr nb b">4</code>的<code class="eh np nq nr nb b">50</code>个时期来训练网络。</p><blockquote class="mu mv mw"><p id="ab16" class="jj jk lt jl b jm jn iv jo jp jq iy jr mx jt ju jv my jx jy jz mz kb kc kd ke hn dt translated">注意:网络架构和所有参数的选择是任意的，我没有对它们进行优化，因为这不是本文的重点。</p></blockquote><pre class="kg kh ki kj fq na nb nc nd aw ne dt"><span id="30b2" class="ks kt hu nb b fv nf ng l nh ni">def build_lstm_model(input_data, output_size, neurons=20,<br/>                     activ_func='linear', dropout=0.25,<br/>                     loss='mae', optimizer='adam'):<br/>    model = Sequential()</span><span id="003d" class="ks kt hu nb b fv nj ng l nh ni">    model.add(LSTM(neurons, input_shape=(<br/>              input_data.shape[1], input_data.shape[2])))<br/>    model.add(Dropout(dropout))<br/>    model.add(Dense(units=output_size))<br/>    model.add(Activation(activ_func))</span><span id="b774" class="ks kt hu nb b fv nj ng l nh ni">    model.compile(loss=loss, optimizer=optimizer)<br/>    return model</span><span id="6379" class="ks kt hu nb b fv nj ng l nh ni">model = build_lstm_model(X_train, output_size=1)<br/>history = model.fit(X_train, y_train, epochs=50, batch_size=4)</span></pre><h2 id="d614" class="ks kt hu bd ku kv kw kx ky kz la lb lc js ld le lf jw lg lh li ka lj lk ll lm dt translated">4.结果</h2><p id="a10b" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">使用经过训练的模型对遗漏的测试集进行预测，我们获得了本文开头所示的图表。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kf"><img src="../Images/6253dcdbbf01e88a6183176b23e7f932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yvJxjj91bptjak3Xy3i1oQ.png"/></div></div></figure><p id="2099" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">那么这些结果到底有什么问题呢？</p><p id="6380" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为什么不应该用这个模型进行实际交易呢？</p><p id="b3fe" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们仔细看看，放大到剧情的最后<em class="lt"> 30 </em>天。</p><pre class="kg kh ki kj fq na nb nc nd aw ne dt"><span id="f1f0" class="ks kt hu nb b fv nf ng l nh ni">targets = test[target_col][window:]<br/>preds = model.predict(X_test).squeeze()<br/># convert change predictions back to actual price<br/>preds = test.close.values[:-window] * (preds + 1)<br/>preds = pd.Series(index=targets.index, data=preds)</span><span id="fbbb" class="ks kt hu nb b fv nj ng l nh ni">n = 30</span><span id="809f" class="ks kt hu nb b fv nj ng l nh ni">line_plot(targets[-n:], preds[-n:], 'actual', 'prediction')</span></pre><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nt"><img src="../Images/ee9365db81a64d364d2a56a504b2b3f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2pp2jUtD_l8yFJroM7brIQ.png"/></div></div></figure><p id="1a85" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">看到了吗？</p><p id="e7f4" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">你可能已经猜对了，这个模型的根本缺陷是<em class="lt">对于某一天的预测，它主要是使用前一天的值。</em></p><p id="70f4" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv">这条预测线似乎只不过是实际价格的一个变化版本。</strong></p><p id="7dbc" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">事实上，如果我们调整预测，将它们移动一天，这个观察结果会变得更加明显。</p><pre class="kg kh ki kj fq na nb nc nd aw ne dt"><span id="40c1" class="ks kt hu nb b fv nf ng l nh ni">line_plot(targets[-n:][:-1], preds[-n:].shift(-1))</span></pre><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nu"><img src="../Images/aa66ac199073395e225f42dcd6484caf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qH2OyEuuK8eyzd-LymJlXw.png"/></div></div></figure><p id="3965" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如您所见，我们突然观察到实际数据和预测之间几乎完美匹配，这表明模型实际上是在学习前一天的价格。</p><p id="e2e3" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这些结果正是我在许多使用LSTMs单点预测的例子中看到的。</p><p id="1717" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为了使这一点更清楚，让我们计算模型预测的预期<em class="lt">回报</em>，并与实际回报进行比较。</p><pre class="kg kh ki kj fq na nb nc nd aw ne dt"><span id="9b80" class="ks kt hu nb b fv nf ng l nh ni">actual_returns = targets.pct_change()[1:]<br/>predicted_returns = preds.pct_change()[1:]</span></pre><p id="d96c" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">查看实际和预测的回报，无论是原始形式还是应用了<em class="lt"> 1个工作日的</em>后，我们都得到了相同的观察结果。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nv"><img src="../Images/87276020b8c6ecc87c44a25a8d6e3759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mgNqrOu95SJ2E4Er0Ae6Og.png"/></div></div><figcaption class="nl nm fg fe ff nn no bd b be z ek">Actual and predicted returns. In the left plot predictions are adjusted by a day.</figcaption></figure><p id="eeec" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">实际上，如果我们计算原始预测和按日调整的实际和预测收益之间的相关性，我们可以得出以下结论:</p><pre class="kg kh ki kj fq na nb nc nd aw ne dt"><span id="727a" class="ks kt hu nb b fv nf ng l nh ni">fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(18, 9))</span><span id="f502" class="ks kt hu nb b fv nj ng l nh ni"># actual correlation<br/>corr = np.corrcoef(actual_returns, predicted_returns)[0][1]<br/>ax1.scatter(actual_returns, predicted_returns, color='k')<br/>ax1.set_title('r = {:.2f}'.format(corr), fontsize=18)</span><span id="1036" class="ks kt hu nb b fv nj ng l nh ni"># shifted correlation<br/>shifted_actual = actual_returns[:-1]<br/>shifted_predicted = predicted_returns.shift(-1).dropna()<br/>corr = np.corrcoef(shifted_actual, shifted_predicted)[0][1]<br/>ax2.scatter(shifted_actual, shifted_predicted, color='k')<br/>ax2.set_title('r = {:.2f}'.format(corr));</span></pre><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nw"><img src="../Images/677bd62ffc8ce6f4e6adf127024b4055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EUUkLmTeUufq8WI1Quodbw.png"/></div></div></figure><p id="0da4" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">从上面的图中可以看出，实际回报和预测回报是不相关的。只有在对预测应用了<em class="lt"> 1天移位</em>之后，我们才能获得与实际比特币数据的回报高度相关的回报。</p><h1 id="87b3" class="lu kt hu bd ku lv lw lx ky ly lz ma lc ja mb jb lf jd mc je li jg md jh ll me dt translated">摘要</h1><p id="3e8d" class="pw-post-body-paragraph jj jk hu jl b jm lo iv jo jp lp iy jr js lq ju jv jw lr jy jz ka ls kc kd ke hn dt translated">这篇博文的目标是解决我在过去几个月中遇到的许多使用深度神经网络预测加密货币和股票市场价格的例子——这些例子采用了与这里使用的方法类似的方法:使用历史价格数据实现LSTM来预测未来的结果。我已经证明了为什么这些模型不一定适用于实际交易。</p><p id="f9f0" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">是的，网络能够有效地学习。但它最终使用了一种策略，在这种策略中，预测一个接近前一个值的值在最小化平均绝对误差方面被证明是成功的。</p><p id="2cd5" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然而，无论预测在损失误差方面有多准确，在实践中，仅基于<em class="lt">历史价格数据</em>的单点预测模型的结果仍然很难实现，并且对交易不是特别有用。</p><p id="411b" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">不用说，实现价格预测有用的LSTMs的更复杂的方法可能确实存在。使用更多数据以及优化网络架构和超参数是一个开始。然而，在我看来，除了历史价格之外，整合数据和特征还有更大的潜力。毕竟，金融界早就知道“<a class="ae kr" href="http://www.businessinsider.com/mutual-fund-performance-persistence-2014-7?IR=T" rel="noopener ugc nofollow" target="_blank">过去的表现不是未来结果的指标</a>”。</p><p id="3c77" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">加密货币可能也是如此。</p><p id="ec2c" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="lt">免责声明:这不是财务建议。这篇文章和给出的模型仅用于教育目的。不要用它来交易或做投资决定。</em></p><figure class="kg kh ki kj fq kk"><div class="bz el l di"><div class="nx ny l"/></div></figure></div></div>    
</body>
</html>