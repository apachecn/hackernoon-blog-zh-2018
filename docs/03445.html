<html>
<head>
<title>uPort Transactions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">上传交易记录</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/uport-transactions-d5b171f7068f?source=collection_archive---------10-----------------------#2018-04-19">https://medium.com/hackernoon/uport-transactions-d5b171f7068f?source=collection_archive---------10-----------------------#2018-04-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/b3860e763cf4d87e0c8efa21aaed485e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8mOyRf4ePSDZjsxS8qUPFA.png"/></div></div></figure><div class=""/><p id="2c12" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您使用<a class="ae ka" href="https://hackernoon.com/tagged/uport" rel="noopener ugc nofollow" target="_blank"> uPort </a>为您的<a class="ae ka" href="https://hackernoon.com/tagged/smart-contract" rel="noopener ugc nofollow" target="_blank">智能合约</a>签署交易，您会注意到，如果您在Etherscan.io上检查，您找不到任何关于该合约交易的痕迹。这是因为用于Rinkeby的Etherscan不提供关于内部交易的信息。当我们在<a class="ae ka" href="http://www.diwala.io" rel="noopener ugc nofollow" target="_blank">排灯节</a>开发我们的分散式技能验证平台时，我们面临这个问题，并认为记录这个问题是有用的，因为这对其他开发人员也是有用的。在这篇文章中，我试图提供一些关于如果有人使用uPort签署交易的交易过程的细节，以及获取内部交易细节的可能方法。</p><p id="8f25" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">需要记住的重要一点是，当您使用uPort进行身份管理时，您的私钥存储在您的移动设备中，绝不会暴露给外界。因此，区块链的任何交易都应该通过您的移动设备进行。这可能与本文没有直接关系，但是当您使用uPort设计系统时，它会非常有帮助。</p><h2 id="f252" class="kb kc if bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">与uPort的交易之旅</h2><p id="432b" class="pw-post-body-paragraph jc jd if je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">DApp: 通常一笔交易是在DApp内部形成的。然后，通过二维码或深层链接，交易将被传输到您设备中的uPort应用程序。</p><p id="5326" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"> uPort App: </strong>使用uPort App内部的私钥对交易进行签名，并发送给TxRelay contract。</p><p id="5e46" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"> TxRelay: </strong>从uPort应用程序接收交易，如果您使用uPort应用程序返回的交易哈希，您将看到该交易。顾名思义，一旦收到消息，TxRelay会将消息中继到MetaIdetityManager智能合同。</p><p id="e560" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig"> MetaIdentityManager: </strong>该契约提供了在发送方不拥有任何以太网的情况下发送事务的方法。这个契约最终将事务转发到它的最终目的地，也就是您想首先调用的自定义契约。</p><h2 id="3f5f" class="kb kc if bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">查看发送到智能合同的数据</h2><p id="5b5f" class="pw-post-body-paragraph jc jd if je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">一旦提交了一个事务(没有uPort ),并且它成功地到达网络中的目的地，就可以通过调用Web3.js方法<strong class="je ig"><em class="lb">web 3 . eth . get transaction</em></strong>来提取与该事务相关的所有数据，并使用类似于<strong class="je ig"><em class="lb"/></strong><a class="ae ka" href="https://github.com/ConsenSys/abi-decoder" rel="noopener ugc nofollow" target="_blank"><strong class="je ig">ABI-decoder</strong></a><strong class="je ig"><em class="lb">的库来解码其数据参数。</em></strong></p><p id="0ffb" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">原因是，在幕后，uPort应用程序不会将交易直接发送到您的合同，而是通过<strong class="je ig"> <em class="lb"> TxRelay </em> </strong>和<strong class="je ig"><em class="lb">meta identity manager</em></strong>合同进行路由。</p><p id="4699" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因此，要查看通过与uPort签约发送到您合同中的实际数据，需要遵循以下步骤。</p><ol class=""><li id="894a" class="lc ld if je b jf jg jj jk jn le jr lf jv lg jz lh li lj lk dt translated">通过提供事务哈希，使用<strong class="je ig"><em class="lb">web 3 . eth . get transaction</em></strong>拉事务</li><li id="c957" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">使用<a class="ae ka" href="https://github.com/ConsenSys/abi-decoder" rel="noopener ugc nofollow" target="_blank"> <strong class="je ig"> abi-decoder </strong> </a>与<strong class="je ig"> <em class="lb"> TxRelay </em> </strong>约定的abi解码数据</li><li id="6d50" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">从步骤2接收的数据属性的值，应该被输入到<a class="ae ka" href="https://github.com/ConsenSys/abi-decoder" rel="noopener ugc nofollow" target="_blank"><strong class="je ig">abi-decoder</strong></a><strong class="je ig"/>但是这次用的是<strong class="je ig"><em class="lb">meta identity manager</em></strong>的ABI</li><li id="c002" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">最后，从步骤3接收的数据属性的值应该被输入到<a class="ae ka" href="https://github.com/ConsenSys/abi-decoder" rel="noopener ugc nofollow" target="_blank"><strong class="je ig">abi-解码器</strong> </a> <strong class="je ig"> </strong>中，但是这次使用的是<strong class="je ig">目标契约</strong>的ABI</li></ol><h2 id="cba9" class="kb kc if bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">摘要</h2><p id="e543" class="pw-post-body-paragraph jc jd if je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">从uPort应用程序签署的交易在到达目标合约之前会遍历多个合约。因此，您使用事务哈希获得的数据应该使用相关的智能契约ABI进行递归解码，以将数据释放给目标契约。你可以在<a class="ae ka" href="http://www.google.com" rel="noopener ugc nofollow" target="_blank"> uPort消息解码器</a>上尝试一下，或者使用<a class="ae ka" href="https://github.com/Diwala/eth-internal-transaction-disecter/tree/master/examples" rel="noopener ugc nofollow" target="_blank">简单节点模块</a>进行开发。您可以找到一个由Snorre完成的更通用的模块，您可以采用这个库来查看任何智能合同的内部交易。</p><div class="ht hu fm fo hv lq"><a rel="noopener follow" target="_blank" href="/diwala/uport-internaltransactions-c8fc4e31d9"><div class="lr ab ej"><div class="ls ab lt cl cj lu"><h2 class="bd ig fv z el lv eo ep lw er et ie dt translated">上传内部交易</h2><div class="lx l"><h3 class="bd b fv z el lv eo ep lw er et ek translated">因此，我们一直在为我们的平台使用uPort，并发现对内部事务的支持…</h3></div><div class="ly l"><p class="bd b gc z el lv eo ep lw er et ek translated">medium.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me ib lq"/></div></div></a></div><h2 id="8f01" class="kb kc if bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">资源</h2><ol class=""><li id="45c6" class="lc ld if je b jf kw jj kx jn mf jr mg jv mh jz lh li lj lk dt translated">可重用库(<a class="ae ka" href="https://github.com/Diwala/eth-internal-transaction-disecter" rel="noopener ugc nofollow" target="_blank"> GitHub </a>、<a class="ae ka" href="https://www.npmjs.com/package/eth-internal-transaction-disecter" rel="noopener ugc nofollow" target="_blank"> NPM </a>、<a class="ae ka" href="https://github.com/Diwala/eth-internal-transaction-disecter/tree/master/examples" rel="noopener ugc nofollow" target="_blank">样本</a>)</li><li id="0c2c" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated"><a class="ae ka" href="https://disect.diwala.io/" rel="noopener ugc nofollow" target="_blank">在线工具</a></li><li id="09bb" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated"><a class="ae ka" href="https://rinkeby.etherscan.io/address/0x87ea811785c4bd30fc104c2543cf8ed90f7eeec7#code" rel="noopener ugc nofollow" target="_blank"><strong class="je ig"><em class="lb">meta identity manager</em></strong>契约和来自以太扫描</a> (Rinkeby)的ABI</li><li id="56cb" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated"><a class="ae ka" href="https://rinkeby.etherscan.io/address/0xda8c6dce9e9a85e6f9df7b09b2354da44cb48331#code" rel="noopener ugc nofollow" target="_blank"> <strong class="je ig"> <em class="lb"> TxRelay </em> </strong>契约</a> <a class="ae ka" href="https://rinkeby.etherscan.io/address/0x87ea811785c4bd30fc104c2543cf8ed90f7eeec7#code" rel="noopener ugc nofollow" target="_blank">和ABI </a> <a class="ae ka" href="https://rinkeby.etherscan.io/address/0xda8c6dce9e9a85e6f9df7b09b2354da44cb48331#code" rel="noopener ugc nofollow" target="_blank">来自以太扫描</a> (Rinkeby)</li><li id="7315" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated"><a class="ae ka" href="https://github.com/ConsenSys/abi-decoder" rel="noopener ugc nofollow" target="_blank"> ABI解码器库</a></li><li id="5564" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated"><a class="ae ka" href="https://github.com/uport-project/uport-identity" rel="noopener ugc nofollow" target="_blank"> uPort项目</a></li><li id="6525" class="lc ld if je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated"><a class="ae ka" href="https://github.com/uport-project/specs/" rel="noopener ugc nofollow" target="_blank">支持白皮书</a></li></ol><figure class="mi mj mk ml fq hw"><div class="bz el l di"><div class="mm mn l"/></div></figure></div></div>    
</body>
</html>