<html>
<head>
<title>Simple guide on how to generate ROC plot for Keras classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为Keras分类器生成ROC图的简单指南</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/simple-guide-on-how-to-generate-roc-plot-for-keras-classifier-2ecc6c73115a?source=collection_archive---------0-----------------------#2018-04-21">https://medium.com/hackernoon/simple-guide-on-how-to-generate-roc-plot-for-keras-classifier-2ecc6c73115a?source=collection_archive---------0-----------------------#2018-04-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/a459955bb3effb0d3ea2afa7ed0e6217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YRURgQJYz2av_ekc.jpg"/></div></div></figure><p id="75c2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">阅读本指南后，您将知道如何通过ROC和AUC评估Keras分类器:</p><ul class=""><li id="545b" class="ka kb hu je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">为二元分类器生成ROC图；在此过程中应用交叉验证。</li><li id="0af3" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">计算AUC并使用它来比较分类器性能。</li><li id="0384" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">将ROC分析应用于多类分类。创建ROC来评估单个类和整体分类性能。</li></ul><p id="7a96" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> <em class="ko">完整</em> </strong> <a class="ae kp" href="https://github.com/Tony607/ROC-Keras" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> <em class="ko">源代码</em> </strong> </a> <strong class="je hv"> <em class="ko">本教程可在我的GitHub上获得。</em>T13】</strong></p><h1 id="6fe3" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">ROC和AUC是什么，能做什么？</h1><p id="74d4" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated"><em class="ko">它们是什么？</em></p><p id="e51a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">来自维基百科:<strong class="je hv">接收器工作特性</strong>曲线又称ROC是一个图示，说明了<a class="ae kp" href="https://en.wikipedia.org/wiki/Binary_classifier" rel="noopener ugc nofollow" target="_blank">二元分类器</a>系统在区分阈值变化时的诊断能力。这里的临界点是“二元分类器”和“可变阈值”。我还将向您展示如何通过一对一方法绘制多标签分类器的ROC。</p><p id="ac83" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">曲线下面积</strong>，又名AUC是该面积在该ROC曲线下的百分比，范围在0~1之间。</p><p id="a442" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">他们能做什么？</p><p id="90d5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ROC是可视化二元分类器性能的一种很好的方式，AUC是通过评估关于两个类别分离的排名来总结分类器性能的一个单一数字。<strong class="je hv"> </strong>越高越好。</p><p id="7c1b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在接下来的两节中，我将向您展示如何绘制ROC并计算Keras分类器的AUC，包括二元和多标签分类器。</p><h1 id="efdb" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">二元分类器的ROC，AUC</h1><p id="1e1b" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">首先，我们用Sklearn的<strong class="je hv"> make_classification() </strong>函数生成一些训练/测试数据。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="d828" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，让我们像往常一样构建和训练一个Keras分类器模型。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="d769" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，我们对保留的测试数据调用<strong class="je hv"> model.predict </strong>来生成概率值。之后，使用概率和地面真实标签生成绘制ROC曲线所需的两个数据数组对:</p><ul class=""><li id="0c05" class="ka kb hu je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">fpr: <strong class="je hv">每个可能阈值的假阳性率</strong></li><li id="646c" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">tpr: <strong class="je hv">每个可能阈值的真阳性率</strong></li></ul><p id="41a9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们可以调用sklearn的<strong class="je hv"> roc_curve() </strong>函数来生成这两个。下面是实现它们的代码。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="396c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">AUC值也可以这样计算。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="f66e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了使图看起来更有意义，让我们训练另一个二元分类器，并在同一图中稍后将其与我们的Keras分类器进行比较。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="edd4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，让我们为这两个分类器绘制ROC图。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="87cb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">结果如下:</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/c42d1069ac28caab51ae1617089ef63a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/0*zn1I3Qb6KGwdYJ_Q.jpg"/></div></figure><p id="3df1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如您所见，给定AUC度量，Keras分类器优于其他分类器。</p><h1 id="86a6" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">类别分类器的ROC，AUC</h1><p id="400f" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">ROC曲线延伸到三类或更多类的问题，这就是所谓的一对多方法。</p><p id="7c12" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">例如，如果我们有三个类，我们将创建三条ROC曲线，</p><p id="e5d5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于每一个类，我们将其作为正类，其余类共同分组为负类。</p><ul class=""><li id="d987" class="ka kb hu je b jf jg jj jk jn kc jr kd jv ke jz kf kg kh ki dt translated">1级与2级和3级</li><li id="6c6f" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">2级与1级和3级</li><li id="f89b" class="ka kb hu je b jf kj jj kk jn kl jr km jv kn jz kf kg kh ki dt translated">3级与1级和2级</li></ul><p id="f6ff" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们从创建一些带有3个类输出的训练/测试数据开始。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="5bda" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，我们像以前一样建立和训练分类Keras分类器。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="674e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">训练模型后，我们可以用它来预测测试输入，并绘制3个类别的ROC图。</p><p id="14b2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在此之前，让我们定义度量标准来评估所有类的整体性能。有两个略有不同的指标，微观和宏观平均。</p><p id="3699" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在“微平均”中，我们将从k类模型的各个真阳性、真阴性、假阳性和假阴性计算性能，例如精度:</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff ma"><img src="../Images/184ad80eb9a8bf0dfb17d05cc340b3a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/0*_3q55ZRlIRKEq__R.png"/></div></figure><p id="e1f3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在宏观平均法中，我们对每个班级的表现进行平均:</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff mb"><img src="../Images/b9a93848d9ae7c30633ca4ac984ea2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/0*PMJy_1PyIhzUZRzL.png"/></div></figure><p id="70c4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下面是绘制ROC曲线和AUC值的代码。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="2d2d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是结果，第二个图是图表左上角的放大图。</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/bd7196b31a8624975b7454ce16922b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/0*SukbOETuUdT_A413.jpg"/></div></figure><p id="bce1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以看到，对于每个类别，它们的ROC和AUC值略有不同，这很好地表明了我们的模型在分类单个类别方面有多好。</p><h1 id="284a" class="kq kr hu bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">总结和进一步阅读</h1><p id="aa23" class="pw-post-body-paragraph jc jd hu je b jf lo jh ji jj lp jl jm jn lq jp jq jr lr jt ju jv ls jx jy jz hn dt translated">在本教程中，我们介绍了如何使用ROC曲线和AUC值评估二元和分类Keras分类器。</p><p id="0cce" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">ROC曲线可视化了测试集上的排名器或概率模型的质量，而没有承诺分类阈值。我们还学习了如何计算AUC值，以帮助我们评估分类器的性能。</p><p id="b652" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你想了解更多关于ROC的知识，你可以阅读它的维基百科页面，<a class="ae kp" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic" rel="noopener ugc nofollow" target="_blank">接收器工作特性</a>，它向你展示了如何通过迭代不同的阈值来绘制曲线。</p><p id="ffdf" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此外，在计算ROC上查看<a class="ae kp" href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html" rel="noopener ugc nofollow" target="_blank"> Sklearn的API文档</a>有助于进一步了解如何使用该功能。</p><p id="4973" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以在我的GitHub repo中找到这个教程的<a class="ae kp" href="https://github.com/Tony607/ROC-Keras" rel="noopener ugc nofollow" target="_blank">源代码</a>。</p></div><div class="ab cl md me hc mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="hn ho hp hq hr"><p id="e2c6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ko">原载于</em><a class="ae kp" href="https://www.dlology.com/blog/simple-guide-on-how-to-generate-roc-plot-for-keras-classifier/" rel="noopener ugc nofollow" target="_blank"><em class="ko">www.dlology.com</em></a><em class="ko">。</em></p></div></div>    
</body>
</html>