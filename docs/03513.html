<html>
<head>
<title>Today I learned — +-0, NaN and Object.is in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">今天我学习了JavaScript中的+-0，NaN和Object.is</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/til-about-0-nan-and-object-is-in-javascript-a75d0b63691e?source=collection_archive---------21-----------------------#2018-04-22">https://medium.com/hackernoon/til-about-0-nan-and-object-is-in-javascript-a75d0b63691e?source=collection_archive---------21-----------------------#2018-04-22</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="a2a0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">过去几天我在<a class="ae jp" href="https://en.wikipedia.org/wiki/Cluj-Napoca" rel="noopener ugc nofollow" target="_blank">克卢日纳波卡</a>，在那里我在<a class="ae jp" href="https://jsheroes.io/" rel="noopener ugc nofollow" target="_blank">优秀JSHeroes大会</a>上发言。在Mathias Bynens 的演讲<a class="ae jp" href="https://www.youtube.com/watch?v=HULaOA5oJMY" rel="noopener ugc nofollow" target="_blank">“JS开发人员的V8内幕”</a>(录音来自另一个事件)中，我看到了一个非常有趣的代码片段。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="3369" class="jz ka hu jv b fv kb kc l kd ke">Object.is(-0, +0);</span></pre><p id="99ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这一行在两个方面很吸引人——让我们来看看。</p><h1 id="4c47" class="kf ka hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">JavaScript中存在的两个零</h1><p id="6890" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">第一个事实是，JavaScript中的数字遵循IEEE浮点运算标准。这个标准有几种变体，JavaScript使用基于64位的“双精度”,也称为“binary64”。</p><p id="b9b5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">IEEE 754定义<a class="ae jp" href="https://en.wikipedia.org/wiki/IEEE_754#Formats" rel="noopener ugc nofollow" target="_blank">一个符号、一个有效数字和一个指数来描述每个有限数字</a>。理解这是如何工作的可能需要一些时间，但重要的事实是JavaScript数字中有一位(符号位)定义了一个数字是正还是负，这意味着<code class="eh lh li lj jv b">0</code>也可以是负的。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="900c" class="jz ka hu jv b fv kb kc l kd ke">const posNumber = 1;<br/>const negNumber = -1;<br/>const posZero = +0;<br/>const negZero = -0;</span></pre><p id="38f7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我对发现负零的第一反应是，我的代码中肯定没有这些，但是，当我对<code class="eh lh li lj jv b">-0.23</code>进行舍入时，我也会以负零结束，这使得负零更有可能也出现在我的JavaScript中。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="9767" class="jz ka hu jv b fv kb kc l kd ke">Math.round(-0.23); // -0</span></pre><p id="d9f9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当你想比较正负0时，这变得很有趣，因为它们被同等对待。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="153e" class="jz ka hu jv b fv kb kc l kd ke">-0 === +0 // true</span></pre><p id="5fe1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://twitter.com/abdulapopoola" rel="noopener ugc nofollow" target="_blank"> AbdulFattah Popoola </a>写了<a class="ae jp" href="https://abdulapopoola.com/2016/12/19/why-javascript-has-two-zeros-0-and-0/" rel="noopener ugc nofollow" target="_blank">一篇很好的文章</a>，如果你感兴趣的话,<a class="ae jp" href="https://github.com/getify/You-Dont-Know-JS/blob/master/types%20%26%20grammar/ch2.md#zeros" rel="noopener ugc nofollow" target="_blank">在“你不知道的JavaScript”系列文章</a>中甚至有一个关于正负零的章节，会有更多的细节。</p><p id="837b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="lk">旁注:可以用除法和由此产生的</em> <code class="eh lh li lj jv b"><em class="lk">Infinity</em></code> <em class="lk">来区分</em> <code class="eh lh li lj jv b"><em class="lk">-0</em></code> <em class="lk">和</em> <code class="eh lh li lj jv b"><em class="lk">0</em></code> <em class="lk">。</em></p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="0565" class="jz ka hu jv b fv kb kc l kd ke">1 / -0 === -Infinity    // true <br/>1 / 0 === Infinity      // true<br/>-Infinity !== Infinity  // true</span></pre><h1 id="2dc8" class="kf ka hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">Object.is —比较没有怪癖？</h1><p id="edd6" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">所以，和<code class="eh lh li lj jv b">===</code>的严格对比，没有抓住两个零不一样的事实。你可能知道<code class="eh lh li lj jv b">NaN</code>也不等于<code class="eh lh li lj jv b">NaN</code>。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="f0c5" class="jz ka hu jv b fv kb kc l kd ke">NaN === NaN // false </span><span id="4f42" class="jz ka hu jv b fv ll kc l kd ke">// you can use Number.isNaN as an alternative<br/>Number.isNaN(NaN) // true</span></pre><p id="f0a6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这些机会就是<code class="eh lh li lj jv b">Object.is</code>开始发挥作用的时候。在大多数情况下，它的行为与<code class="eh lh li lj jv b">===</code>相同，但它包括一些小的“改进”,使事情变得更有逻辑。</p><pre class="jq jr js jt fq ju jv jw jx aw jy dt"><span id="727d" class="jz ka hu jv b fv kb kc l kd ke">Object.is(-0, 0); // false <br/>Object.is(NaN, NaN); // true</span></pre><p id="c300" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这样做的缺点是，不是每个人都知道<code class="eh lh li lj jv b">-0</code>的存在，这意味着对于<code class="eh lh li lj jv b">-0.23</code>的舍入来说，<code class="eh lh li lj jv b">0</code>和<code class="eh lh li lj jv b">-0</code>之间的差异可能会导致难以发现的错误。这大概就是它在JavaScript中通常被忽略的原因。</p><p id="724b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我第一次看到<code class="eh lh li lj jv b">Object.is</code>是在Mathias的幻灯片中，它似乎不经常被使用。</p><p id="00fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我马上想到的一个问题是<code class="eh lh li lj jv b">Object.is</code>是否和<code class="eh lh li lj jv b">===</code>一样快。我创建了一个快速JSPerf 来看看<code class="eh lh li lj jv b">Object.is</code>和<code class="eh lh li lj jv b">===</code>相比表现如何。在Safari和Firefox中<code class="eh lh li lj jv b">Object.is</code>似乎比<code class="eh lh li lj jv b">===</code>慢很多，而在Chrome中差不多。那太有意思了！</p><p id="07ab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果有人对性能测试有意见，请告诉我。浏览器内部极其复杂，有时测试中发生的优化会使整个事情无效。</p><p id="2579" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你在你的源代码中使用<code class="eh lh li lj jv b">Object.is</code>，我也很乐意在这里！:)</p></div><div class="ab cl lm ln hc lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hn ho hp hq hr"><p id="df5c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="lk">原载于</em><a class="ae jp" href="https://www.stefanjudis.com/today-i-learned/0-nan-and-object-is-in-javascript/" rel="noopener ugc nofollow" target="_blank"><em class="lk">www.stefanjudis.com</em></a><em class="lk">。</em></p><figure class="jq jr js jt fq lt"><div class="bz el l di"><div class="lu lv l"/></div></figure></div></div>    
</body>
</html>