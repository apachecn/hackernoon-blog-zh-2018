<html>
<head>
<title>Setting up apollo-link-state for Multiple Stores</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为多个商店设置阿波罗链接状态</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/setting-up-apollo-link-state-for-multiple-stores-4cf54fdb1e00?source=collection_archive---------9-----------------------#2018-04-23">https://medium.com/hackernoon/setting-up-apollo-link-state-for-multiple-stores-4cf54fdb1e00?source=collection_archive---------9-----------------------#2018-04-23</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/3fd21c05ff0418da226f5691a32f2249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QYzDGdv3mQ21BdrSmy5mIA.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Take a look into your future 🔮</figcaption></figure><p id="f7e1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我想谈谈如何设置<code class="eh ke kf kg kh b">apollo-link-state</code>来支持多个商店而不互相干扰。</p><p id="6648" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在我的上一篇文章中，我们讨论了如何设置基本用途的<code class="eh ke kf kg kh b">apollo-link-state</code>:</p><div class="ki kj fm fo kk kl"><a rel="noopener follow" target="_blank" href="/@bnchrch/storing-local-state-in-react-with-apollo-link-state-738f6ca45569"><div class="km ab ej"><div class="kn ab ko cl cj kp"><h2 class="bd hv fv z el kq eo ep kr er et ht dt translated">在与apollo-link-state的反应中存储本地状态</h2><div class="ks l"><h3 class="bd b fv z el kq eo ep kr er et ek translated">特别感谢Peggy Rayzis围绕该产品所做的出色工作和交流。</h3></div><div class="kt l"><p class="bd b gc z el kq eo ep kr er et ek translated">medium.com</p></div></div><div class="ku l"><div class="kv l kw kx ky ku kz ja kl"/></div></div></a></div><p id="4724" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在本教程中，这是我们要拍摄的月亮:</p><ol class=""><li id="e9d6" class="la lb hu ji b jj jk jn jo jr lc jv ld jz le kd lf lg lh li dt translated">将<code class="eh ke kf kg kh b">withClientState</code>移动到自己的文件中。</li><li id="d729" class="la lb hu ji b jj lj jn lk jr ll jv lm jz ln kd lf lg lh li dt translated">将特定的解析器和突变移到它们自己的文件中。</li><li id="70ef" class="la lb hu ji b jj lj jn lk jr ll jv lm jz ln kd lf lg lh li dt translated">写一个优雅的方式将多个商店合并在一起。</li><li id="637e" class="la lb hu ji b jj lj jn lk jr ll jv lm jz ln kd lf lg lh li dt translated">在之前的演示中添加了一个新的Notes特性。</li></ol><p id="ea5b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我们开始吧！🚀🌙</p><h1 id="72de" class="lo lp hu bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml dt translated">我在使用<code class="eh ke kf kg kh b">apollo-link-state</code>时最大的问题</h1><p id="c9c4" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">首先，我想谈谈我们正在努力解决的问题。</p><p id="e1aa" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">归结起来，<code class="eh ke kf kg kh b">CreateClientState</code>只期望<code class="eh ke kf kg kh b">defaults</code>有一个值，而<code class="eh ke kf kg kh b">Mutations.resolvers</code>有一个值，如果你有不止一个想要存储的对象，这是不兼容的。</p><figure class="ms mt mu mv fq iv fe ff paragraph-image"><div class="fe ff mr"><img src="../Images/80ac5e8ed3dd9aa65e13868cdf099fcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*wv4uF4rHQcEpytbC3AXUkQ.png"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">This will get unruly fast</figcaption></figure><p id="40ae" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这是不兼容的，因为它迫使我们将多个逻辑上分离的特性的<code class="eh ke kf kg kh b">resolvers</code>和<code class="eh ke kf kg kh b">defaults</code>保存在一个地方。或者，如果每次我们创建一个单独的文件时，都强制我们显式地从该文件中引用一个<code class="eh ke kf kg kh b">resolver</code> / <code class="eh ke kf kg kh b">default</code>。</p><p id="c3bc" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这是不好的，在一个中型到大型的应用程序中，这是一个让你的逻辑难以追踪的好方法。</p><h1 id="c659" class="lo lp hu bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml dt translated">我们如何解决这个问题</h1><p id="a956" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">谢天谢地，解决这个问题真的很简单！它包括以下内容:</p><h2 id="10ea" class="mw lp hu bd lq mx my mz lu na nb nc ly jr nd ne mc jv nf ng mg jz nh ni mk nj dt translated">1.移动<code class="eh ke kf kg kh b">CreateClientStore out of </code>我们的<code class="eh ke kf kg kh b">client.js file</code></h2><p id="6532" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">将您的客户端存储的配置移动到它自己的文件中，以帮助强调这是我们的应用程序中非常具体和非常重要的一部分。</p><p id="22fc" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我们的新<code class="eh ke kf kg kh b">client.js</code>应该是这样的:</p><figure class="ms mt mu mv fq iv"><div class="bz el l di"><div class="nk nl l"/></div></figure><h2 id="4636" class="mw lp hu bd lq mx my mz lu na nb nc ly jr nd ne mc jv nf ng mg jz nh ni mk nj dt translated">2.将我们的默认值、解析器和<code class="eh ke kf kg kh b">@client</code>查询移动到它们自己的文件中</h2><p id="e833" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">将特定功能领域的<code class="eh ke kf kg kh b">defaults</code>和<code class="eh ke kf kg kh b">resolvers</code>分解到它们自己的“存储”文件中，以帮助确保随着应用程序的增长，代码在逻辑上处于同一位置。</p><figure class="ms mt mu mv fq iv"><div class="bz el l di"><div class="nk nl l"/></div></figure><h2 id="b789" class="mw lp hu bd lq mx my mz lu na nb nc ly jr nd ne mc jv nf ng mg jz nh ni mk nj dt translated">3.用洛达什魔法🧙‍把它绑在一起</h2><p id="46de" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">最后，我们使用lodash的一些助手将每个<code class="eh ke kf kg kh b">store</code>文件的导出合并成一个。这允许我们在单独的文件中定义<code class="eh ke kf kg kh b">resolvers</code>和<code class="eh ke kf kg kh b">defaults</code>，并在配置期间将它们放在一起。</p><p id="a740" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><em class="nm">具体看一下</em> <code class="eh ke kf kg kh b"><em class="nm">mergeGet</em></code> <em class="nm">函数，看看这是如何发生的。</em></p><figure class="ms mt mu mv fq iv"><div class="bz el l di"><div class="nk nl l"/></div></figure><h1 id="7471" class="lo lp hu bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml dt translated">添加另一个特性变得很容易</h1><p id="01fc" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">现在我们已经有了上面的基础设施，添加第二个特性就像添加第100个特性一样简单。</p><p id="95c1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我们通过向应用程序添加一个自由形式的注释字段来测试这个语句。</p><h2 id="fdec" class="mw lp hu bd lq mx my mz lu na nb nc ly jr nd ne mc jv nf ng mg jz nh ni mk nj dt translated">1.创建便笺存储</h2><p id="2f3a" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">几乎与上面的Todo商店相同。</p><figure class="ms mt mu mv fq iv"><div class="bz el l di"><div class="nk nl l"/></div></figure><h2 id="50d8" class="mw lp hu bd lq mx my mz lu na nb nc ly jr nd ne mc jv nf ng mg jz nh ni mk nj dt translated">2.连接新商店</h2><p id="7d3b" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">将新商店导入<code class="eh ke kf kg kh b">CreateClientStore.js</code>并添加到我们的<code class="eh ke kf kg kh b">STORES</code>。</p><figure class="ms mt mu mv fq iv"><div class="bz el l di"><div class="nk nl l"/></div></figure><h2 id="bf30" class="mw lp hu bd lq mx my mz lu na nb nc ly jr nd ne mc jv nf ng mg jz nh ni mk nj dt translated">3.创建注释组件</h2><p id="b3bd" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">现在，我们已经创建了商店，是时候使用它了。</p><figure class="ms mt mu mv fq iv"><div class="bz el l di"><div class="nk nl l"/></div></figure><h2 id="379c" class="mw lp hu bd lq mx my mz lu na nb nc ly jr nd ne mc jv nf ng mg jz nh ni mk nj dt translated">4.添加到app.js</h2><p id="fbe5" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">最后，将我们的新组件添加到我们的<code class="eh ke kf kg kh b">&lt;App/&gt;</code>容器中。</p><figure class="ms mt mu mv fq iv"><div class="bz el l di"><div class="nk nl l"/></div></figure><h1 id="c5ba" class="lo lp hu bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml dt translated">看看它的实际效果！</h1><p id="f7cb" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">现在，您应该能够运行更新演示，并看到我们的新笔记的功能在运行。简单。</p><figure class="ms mt mu mv fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nn"><img src="../Images/8e548b9cf4c9e076f41a1e808f0e28e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BJijaIyTykiMJ1Z4QKIERw.png"/></div></div></figure><h1 id="b430" class="lo lp hu bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml dt translated">包裹</h1><p id="09e1" class="pw-post-body-paragraph jg jh hu ji b jj mm jl jm jn mn jp jq jr mo jt ju jv mp jx jy jz mq kb kc kd hn dt translated">我想把这个放出来，因为我认为这个维持地方政府的阿波罗版本有一些真正的潜力，作为一个年轻的项目，它得到的支持越多，我们就越应该看到它是否会发展壮大。</p><p id="5aea" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">支持一个项目的一部分是学习如何使用它和学习如何改进它。我希望这有助于做到这两点！</p><p id="1eeb" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">编码快乐！</p><blockquote class="no"><p id="0c65" class="np nq hu bd nr ns nt nu nv nw nx kd ek translated">🧞‍这是开源的！你可以在Github 上找到它</p><p id="05ec" class="np nq hu bd nr ns nt nu nv nw nx kd ek translated">❤️ <strong class="ak">我只写编程和远程工作。如果你</strong> <a class="ae ny" href="https://www.twitter.com/bnchrch" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">在Twitter上关注我</strong> </a> <strong class="ak">我不会浪费你的时间。</strong></p></blockquote></div></div>    
</body>
</html>