<html>
<head>
<title>How we Built pythonjobs.github.io in a week</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们如何在一周内构建pythonjobs.github.io</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-pythonjobs-github-io-6119cd708802?source=collection_archive---------6-----------------------#2018-04-28">https://medium.com/hackernoon/building-pythonjobs-github-io-6119cd708802?source=collection_archive---------6-----------------------#2018-04-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="d4e9" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">现代开源工具令人惊叹</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/cad2628875b7d86e3e909e9e0387f76d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YX04w-q4aEOO_XT2kleYRg.png"/></div></div></figure><p id="d72b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">不久前，一些同事(@ salimfhadley和@lordmauve)提到了他们的一个想法:</p><blockquote class="kr ks kt"><p id="b380" class="jv jw ku jx b jy jz iv ka kb kc iy kd kv kf kg kh kw kj kk kl kx kn ko kp kq hn dt translated">构建一个使用git pull请求提交新工作的工作网站有多难？</p></blockquote><p id="722d" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">当时，python.org就业委员会已经停机维护了近一年，没有任何明显的免费、适度的地方来列出或查看工作机会。巧合的是，在那个时候，我们的雇主正在招聘，我们都参与了这个过程。</p><p id="aea1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">他们的想法是建立一个静态网站，使用GitHub pull请求来管理提交。</p><p id="a24b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这个想法很棒，原因有很多:</p><ul class=""><li id="7202" class="ky kz hu jx b jy jz kb kc ke la ki lb km lc kq ld le lf lg dt translated">有很多工具和服务可以让管理陌生人的变更请求变得容易</li><li id="954b" class="ky kz hu jx b jy lh kb li ke lj ki lk km ll kq ld le lf lg dt translated">整个过程是公开的、透明的，并且很容易理解</li><li id="8efc" class="ky kz hu jx b jy lh kb li ke lj ki lk km ll kq ld le lf lg dt translated">稍微多一点技术含量的提交过程自然会吸引更多有技术意识的提交者。</li><li id="2d39" class="ky kz hu jx b jy lh kb li ke lj ki lk km ll kq ld le lf lg dt translated">都是自由奔跑！(除了一些库存图像成本和我们的个人时间)</li></ul><p id="9d56" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">大约在接下来的一周，我们构建了<a class="ae lm" href="https://pythonjobs.github.io" rel="noopener ugc nofollow" target="_blank">https://python jobs . github . io</a></p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff ln"><img src="../Images/d799f4d1f927a58c1fe3dcd2bfc90ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XBQncMFBToB6YDeHqWyphQ.png"/></div></div><figcaption class="lo lp fg fe ff lq lr bd b be z ek">Screenshot of the pythonjobs.github.io front page</figcaption></figure><p id="538c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">它在很多方面都非常成功:</p><ul class=""><li id="587a" class="ky kz hu jx b jy jz kb kc ke la ki lb km lc kq ld le lf lg dt translated">尽管没有广告或推广(除了刚开始的时候)，我们每周都会收到几份申请，并且有持续几年的稳定流量。</li><li id="584c" class="ky kz hu jx b jy lh kb li ke lj ki lk km ll kq ld le lf lg dt translated">这是我们推出几周后，python.org官方就业委员会上线的一个因素😎。</li></ul><h1 id="ffc4" class="ls lt hu bd lu lv lw lx ly lz ma mb mc ja md jb me jd mf je mg jg mh jh mi mj dt translated">静态站点</h1><p id="8368" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">该网站是使用python jekyll的替代品<a class="ae lm" href="https://github.com/hyde/hyde" rel="noopener ugc nofollow" target="_blank"> hyde </a>构建的(hyde的开发进度一直很慢，它的文档也有点少，所以我会犹豫是否在新项目中使用它，但它非常适合我们的目的)。</p><p id="bfa7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">广告商使用<a class="ae lm" href="https://hackernoon.com/tagged/github" rel="noopener ugc nofollow" target="_blank"> GitHub </a> pull request UI提交pull请求:每个列表都是一个单独的Markdown文件(扩展名为. html):</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mp"><img src="../Images/29be16cadb90a3a0a9e2c7a8a865ae03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aP033GA-KYGc1mhQrXOSbw.png"/></div></div></figure><p id="f30f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">带有YAML标题和降价内容:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mq"><img src="../Images/5ee59c37465fc0cfb634ec0bf83adf2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cRX5x7vMe7WHfDSvSVyC1w.png"/></div></div></figure><p id="cd3b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">一旦合并了一个变更，就使用一个<a class="ae lm" href="http://travis-ci.org" rel="noopener ugc nofollow" target="_blank"> Travis </a>作业构建站点，并自动部署。</p><h1 id="9a7d" class="ls lt hu bd lu lv lw lx ly lz ma mb mc ja md jb me jd mf je mg jg mh jh mi mj dt translated">适度</h1><p id="6fac" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">手动检查大型yaml/markdown文件既耗时又容易出错，因此我们构建了一组测试，对每个pull请求运行这些测试，以确保基本检查通过(我们仍然手动检查每个提交的内容，但更多的是关于文本内容，而不是语法)。</p><p id="7de4" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这是作为在jobs目录中的每个节点上运行的hyde pluign实现的，并检查许多事情。例如，已经提供了联系人姓名:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mr"><img src="../Images/2bf12fa6351abdf14ad62ee184920ba2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*awA7qdC-6BVVRssIHXy4ew.png"/></div></div><figcaption class="lo lp fg fe ff lq lr bd b be z ek">Excerpt from our <a class="ae lm" href="https://github.com/pythonjobs/template/blob/master/hyde/jobcheck.py" rel="noopener ugc nofollow" target="_blank">job testing script</a></figcaption></figure><p id="f4b9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如果其中任何一项没有通过，那么与任何CI测试一样，拉请求会被标记为失败，阻止我们盲目批准它。</p><p id="b34e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们遇到的一个问题是，导致失败的实际错误可能非常隐蔽。失败的原因显示在travis构建日志中，作为回溯，带有友好的消息，但是..</p><p id="7bb9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">大多数给我们发广告的人都是招聘人员，或者非技术性的招聘经理。通常这是他们第一次和GitHub打交道。为了达到创建PR的阶段，他们已经不得不掌握许多不熟悉的概念(git/github、markdown、yaml、pull requests等等..).要求他们意识到(没有明确的指示)他们必须点击构建失败日志，解析输出直到他们找到回溯，然后提取相关信息是一个步骤(或者10！)太远了。</p><p id="3d42" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这让我最近增加了一个工具，可以用友好的细节直接评论公关(类似于<a class="ae lm" href="https://www.travisbuddy.com/" rel="noopener ugc nofollow" target="_blank">https://www.travisbuddy.com/</a>)。评论以友好、易懂的方式解释了测试失败的原因:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff ms"><img src="../Images/c6915ee5d813bd9f6b42cd2986697ed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*baAW-tEH7CtI_ItyGYdeig.png"/></div></div></figure><p id="4ea9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">当测试通过时，会有另一个脚本使用phantomjs和selenium抓取清单的屏幕截图，并将那个<a class="ae lm" href="https://github.com/pythonjobs/jobs/pull/327#issuecomment-384467178" rel="noopener ugc nofollow" target="_blank">作为注释</a>发布，以使审查更容易。</p><h1 id="3a3c" class="ls lt hu bd lu lv lw lx ly lz ma mb mc ja md jb me jd mf je mg jg mh jh mi mj dt translated">基础设施</h1><p id="32b0" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">我们使用三个git repos来运行pythonjobs。这看起来比需要的更复杂，但是旨在保持提交过程简单:</p><ul class=""><li id="ef1f" class="ky kz hu jx b jy jz kb kc ke la ki lb km lc kq ld le lf lg dt translated"><a class="ae lm" href="https://github.com/pythonjobs/jobs" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv"> jobs </strong> </a> <strong class="jx hv"> : </strong>只是保存了jobs列表文件，以及一些travis相关的脚本。这是提交者创建列表时必须与之交互的唯一回购。</li><li id="aab2" class="ky kz hu jx b jy lh kb li ke lj ki lk km ll kq ld le lf lg dt translated"><a class="ae lm" href="https://github.com/pythonjobs/template" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv">模板</strong> </a>:拥有所有与hyde相关的代码，用于生成完整的静态站点、图形资源、构建脚本等。</li><li id="6c99" class="ky kz hu jx b jy lh kb li ke lj ki lk km ll kq ld le lf lg dt translated"><a class="ae lm" href="https://github.com/pythonjobs/pythonjobs.github.io" rel="noopener ugc nofollow" target="_blank"><strong class="jx hv">python jobs . github . io</strong></a>:包含生成的静态站点，由github页面直接托管。</li></ul><p id="51b9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">构建脚本根据需要整合并合并回购:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mt"><img src="../Images/aaa944f7c73dd7cd548e88a2992e7466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7T63XTpxSJ2Q2pptUc4nBA.png"/></div></div></figure><p id="003c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">当PR合并到master时，同一个CI作业将结果提交到输出repo:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mu"><img src="../Images/d91a7644f495a54e37d05a9a177f5f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sbuMWkpnZAKmmNmOpzzFew.png"/></div></div></figure><p id="b5e8" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">Github为我们处理所有剩下的事情，几秒钟后，这些变化就可以在网上看到了。</p><p id="15a1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们通过使用travis安全环境变量来保存github密钥，从而将更改推送到实时回购。不幸的是，出于良好的原因，您不能在来自非成员的pull请求中使用安全环境变量(他们可能会更改travis脚本，使其打印出秘密)</p><p id="f134" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">为了解决这个问题，有一些简单的Amazon lambda函数来处理测试PR时生成的注释。</p><h1 id="2c32" class="ls lt hu bd lu lv lw lx ly lz ma mb mc ja md jb me jd mf je mg jg mh jh mi mj dt translated">搜索</h1><p id="3dac" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">尽管这是一个静态网站，没有服务器代码，但我们可以对所有职位列表进行全文搜索:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mv"><img src="../Images/8bf45583207b37e586f51afc0549af6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZ-gRief1g-ZjruYKwLsOA.png"/></div></div></figure><p id="9d33" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这与Sphinx客户端搜索的实现非常相似(我后来才知道)。在构建期间，<a class="ae lm" href="https://github.com/pythonjobs/template/blob/master/hyde/siteindex.py" rel="noopener ugc nofollow" target="_blank">一个脚本</a>查看每个工作列表，并从广告中的每个单词构建一个紧凑的基于JSON的前缀树。</p><p id="f402" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">使用<a class="ae lm" href="https://hackernoon.com/tagged/python" rel="noopener ugc nofollow" target="_blank"> python </a> <a class="ae lm" href="https://pypi.org/project/stemming/1.0/" rel="noopener ugc nofollow" target="_blank">词干库</a>对单词进行词干处理，并根据单词出现的位置进行评分(标题中的单词得分高于正文中的单词)。</p><p id="b87a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然后，这个前缀树被输出为JSON文件，由浏览器读取，并用于提供实时搜索功能。JSON首先包含每个作业的数组，然后是作为一组嵌套映射的前缀树。每个映射叶为作业名称数组提供一个索引和一个相应的分数:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mw"><img src="../Images/cd70e86b21b3a5cfdf34e17d1412b717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sfgQzOR1l3pL4Uqor9Y37Q.png"/></div></div></figure><p id="9a79" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在这个例子中，单词<strong class="jx hv"> jack </strong>出现在<em class="ku"> Job2 </em>中，得分为1。而<strong class="jx hv"> java </strong>在<em class="ku"> Job0 </em>中出现两次(得分2)，在<em class="ku"> Job1 </em>中出现一次</p><p id="808a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">突出显示是在客户端通过简单的基于正则表达式的工作列表搜索完成的。</p><h1 id="a0ee" class="ls lt hu bd lu lv lw lx ly lz ma mb mc ja md jb me jd mf je mg jg mh jh mi mj dt translated">位置</h1><p id="9d0a" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">我们要求提交者给我们一个基于文本的位置(美国华盛顿)，不要太在意那个位置有多精确(有些公司不喜欢公开发布确切的位置)。在此基础上，我们生成了所有活动职位列表的google maps视图:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mx"><img src="../Images/a4c3552fc95bc364b93bd96f9bda629b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Tp3XwmkqvH1Go1ucaZ_KQ.png"/></div></div></figure><p id="a87e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">那么，我们如何从“伦敦的伦敦桥”到地图上的一个标记呢？</p><p id="f304" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">google geocoding api可以将位置名称转换成google maps所需的经纬度坐标，因此构建脚本会对每个招聘广告进行查询，以找到它的确切位置。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff my"><img src="../Images/8a3767cac553e5a40ab6ed5a838575ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2tyIsRCfgcAHpUCa7yr7w.png"/></div></div></figure><p id="8803" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">因为这是在公共场合进行的，我们不能使用秘密的API密钥来查询这些位置，所以Google很快抑制了这些请求。为了避免这种情况，jobcheck脚本使用N+1缓存，其中先前查询的结果存储在<a class="ae lm" href="http://pythonjobs.github.io/media/geo.json" rel="noopener ugc nofollow" target="_blank">站点呈现的输出</a>中，并用于确保我们在每次构建时只查询新位置(几乎总是只有1个位置)。</p><p id="f5c7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然后，这些数据被转换成maps.html页面中的内联JS数据，这样我们就可以在页面加载时用标记填充地图。</p><h1 id="42e1" class="ls lt hu bd lu lv lw lx ly lz ma mb mc ja md jb me jd mf je mg jg mh jh mi mj dt translated">开源代码库</h1><p id="6722" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">GitHub是，也应该是，主要是一个代码托管站点。它做得很好。GitHub页面旨在允许一些文档和轻量级主机支持代码项目。</p><p id="f475" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">Pythonjobs不是这两者之一，所以我提前询问了GitHub我们这样做是否合适。他们非常支持这个想法，他们友好的回复让这个网站的建立变得非常愉快。</p><p id="7bc7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">作为开放的一部分，Sal的一个想法是强制所有提交的内容都要标明被雇佣公司的名称。虽然这给一些招聘人员带来了问题，但它的好处是让一切都变得简单，几乎没有模糊的语言或对地点的担忧。</p><h1 id="da02" class="ls lt hu bd lu lv lw lx ly lz ma mb mc ja md jb me jd mf je mg jg mh jh mi mj dt translated">摘要</h1><p id="630f" class="pw-post-body-paragraph jv jw hu jx b jy mk iv ka kb ml iy kd ke mm kg kh ki mn kk kl km mo ko kp kq hn dt translated">事实上，我们三个人可以在大约一周内免费建立一个网站列表，并在最少参与的情况下运行几年，这充分说明了当今开源项目可用的免费工具的质量和可用性。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mz na l"/></div></figure></div></div>    
</body>
</html>