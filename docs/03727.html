<html>
<head>
<title>Riding the Printer Pwnie</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">骑着打印机Pwnie</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/riding-the-printer-pwnie-fa9f4ce822ed?source=collection_archive---------11-----------------------#2018-04-30">https://medium.com/hackernoon/riding-the-printer-pwnie-fa9f4ce822ed?source=collection_archive---------11-----------------------#2018-04-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="f276" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">在互联网上轻松发现黑客打印机</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff jj"><img src="../Images/d9472ee42cb4aaf24883d9a51cdc4f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*QnLUWzBoUJ-VL55mgxf4SA.png"/></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Printers, a perfect attack pivot on your network</figcaption></figure><p id="458f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">快乐的黑客在互联网上与大开打印机同乐</strong></p><p id="131e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">目前，我正在完成一本关于如何最大限度发挥Censys.io潜力的书。Censys是一个搜索引擎，有点像谷歌，但不是真的。它更像Shodan，它可以索引互联网上的设备和网络。密歇根大学的一个项目，它是为计算机科学家设计的，不管那意味着什么。Censys将横幅抓取，尝试命名系统或网站上运行的服务和端口。Censys Python库用于与API进行交互。<br/> <br/> Censys将返回:<br/>IP地址的摘要页面<br/> 谷歌地图<br/> 端口打开<br/> 证书信息<br/> 检查心脏出血漏洞<br/> 横幅抓取<br/> 执行StartTLS启动<br/>zenmap每周扫描“FTP、SSH、Telnet、SMTP、DNS、HTTP、Siemens、S7、POP3、IMAP、HTTPS、SMTP、MODBUS、IMPAS、POP3S、UPnP</p><p id="3b79" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在研究这本书时，这些可爱的打印机宝石开始出现在搜索结果中。Censys.io非常深入，还可以将标签应用到它找到的设备或系统上。这种巧妙的方法可以发现启用了默认web服务且从未配置密码的Brother或Dell品牌的Brother打印机。没有密码的默认不安全设置。互联网总能传递信息。世界上最有价值的商品，打印机墨水，正处于危险之中。</p><p id="b63d" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">值得注意的是，利用Censys.io并不是发现这些美景的唯一方法。使用带有Censys、Shodan、Google、Startpage、DuckDuckGo和其他搜索引擎扫描或索引的Dorking，可以很容易地发现易受攻击的系统。一旦找到打印机，攻击者就可以通过互联网或网络更改密码，从而授予攻击者完全控制权。通过利用内置的兄弟管理工具，打印机可以进一步被用作攻击暴露网络的支点。哥哥好心地内置了一些优秀的诊断工具。</p><p id="3835" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这些易受攻击的系统主要是通过Censys基于网络的界面发现的。但是，使用Censys Python库和API连接或者我的一个自定义PowerShell工具连接到ZMap组件。此外，诸如Recon NG、Metasploit with Censys和Nmap脚本之类的工具可以连接到Censys.io API键，以连接更多其他pen测试工具。大多数打印机在端口80，HTTP上托管网页，但有些在端口443，HTTPS。我在搜索和扫描时使用了这两个端口。</p><p id="78c7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv"> Censys多金鸡</strong></p><p id="71ff" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如果从未设置密码，几种不同的模型在HTML主体中都有警告。使用Censys只查看HTML正文，而不是像Google Dorking那样查看HTML标题。</p><p id="c453" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv"> 80.http.get.body </strong></p><p id="8145" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">% 22请% 26% 2332% 3b配置% 26% 2332% 3b密码%22 </strong></p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff kr"><img src="../Images/bade6f4f77efb3df5bbc665625140144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*cbZ1YFdkX5VM0VAou1U_UA.png"/></div></figure><p id="f010" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">使用带有另一个Censys字段的报告函数<strong class="jx hv"> 80.http.get.title </strong>。打印机的型号在主机报告中返回。</p><p id="a812" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv"> 80.http.get.title.raw </strong></p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="fe ff ks"><img src="../Images/5b28dcf81d5e4b8278ee53ae1971f41d.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*sh5nFNlg68UcFJyWWpmiCQ.png"/></div></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Over three thousand printers with model :)</figcaption></figure><p id="3686" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">通过管理工具连接和控制打印机</strong></p><p id="306a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">哥哥有一个神奇的小管理应用，2017年更新。它可以发现你提供的列表上的任何兄弟打印机。一旦该工具找到兼容的兄弟打印机，不需要密码或登录即可连接。首先是本地测试打印机。另外两个是通过Censys发现的。输入IP地址、范围、它扫描的内容，以及它找到的任何连接内容。如果他们是邪恶的，他们可以做的事情。这个工具提供了一个极好的访问级别，使它成为一个双重用途的软件。允许它被用来行善或作恶😈</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff kx"><img src="../Images/9fc228edea6597aab35d3b6a6f6fb2c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*YcEFGXtPS8YAWcOlcHDMkQ.png"/></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Even tells you the status, sweet</figcaption></figure><p id="9bdd" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">兼容的兄弟工具型号</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="fe ff ky"><img src="../Images/1ca06e0d887c328c2f45dc68eaec92aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cTXF_TvhWFUExHru6qiDTQ.png"/></div></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Loads of ‘em</figcaption></figure><p id="c7be" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">向任何兄弟打印机发送远程PRN文件，无需认证</strong></p><p id="786e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">PRN文件是一个<a class="ae kz" href="https://www.computerworld.com/article/2545878/malware-vulnerabilities/hp-printer-drivers-hit-with-funlove-virus.html" rel="noopener ugc nofollow" target="_blank">打印机驱动文件</a>。2000年&amp; 2006年，当惠普网站上的打印机驱动文件被<a class="ae kz" href="https://www.computerworld.com/article/2545878/malware-vulnerabilities/hp-printer-drivers-hit-with-funlove-virus.html" rel="noopener ugc nofollow" target="_blank">感染</a>时，他们脸上挂着鸡蛋。病毒安装的时间:</p><p id="f3b9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">尝试重新启动电脑。在Windows NT机器上，它试图更改系统设置</p><p id="44a1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">虽然和以前的攻击类型不同。你可以对司机做很多淘气的事情。Windows 64系统需要签名的驱动程序。但是，有一些方法可以避免这种情况。我爱PowerShell，出于进攻目的。有一些PowerShell脚本可以帮助绕过这一要求。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff la"><img src="../Images/cf90e18da60bf7cfbe6ca40f10c92332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*UE1ZK_pfleAyR1VQeJ1ORw.gif"/></div></figure><p id="b62b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">没有登录，只是附上管理工具，然后你可以发送一个PRN格式的文件。这应该适用于任何兼容的打印机。在我的打印机上测试一个文件后，它出了故障，然后关机。它花费了无数次的电源周期和打印机的完全复位来恢复它。在我的搭档到家之前，我正焦急地修理它。我不能再黑房子里的硬件了，甚至连Roomba也不行:-(</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff kr"><img src="../Images/8e051e6c7194daedc144487289b3feb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*CGPT2dt4iYASYTCNlRGGxw.png"/></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">You can make your own PRN file</figcaption></figure><p id="d674" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv"> ZAP路径横向</strong></p><p id="1f3a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">一旦你有了IP地址，你就可以测试打印机了。您可以使用OWASP的ZAP工具并扫描打印机的web服务。基本扫描发现了一个登录URL路径横向漏洞。ZAP能找到这么多，一个帖子能找到的太多了。还可以制作一个呆子，用来检测互联网上的打印机。使用参数在URL中查找“/general/status.html”，然后使用附加参数进行优化。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff lb"><img src="../Images/17982d8b7698f94285b0256f5e73a2e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*pjQhHYqIsA2wW4G6AEOg7Q.png"/></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Parameter = loginurl happy hacker joy joy</figcaption></figure><p id="db43" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv"> XSS和未确认的现场乐趣</strong></p><p id="8eb1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">打印机网络界面似乎没有经过那么好的安全测试。我的打印机不是最新的耗油大户。然而，考虑到其他可利用的和易受攻击的组件；值得怀疑的是，打印机网络接口是否出于安全目的进行了测试。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="fe ff lc"><img src="../Images/c88f02a5ea3582d37cdf474e73a9dfd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NrnByvPa8LjmXpRdZFCjeQ.png"/></div></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Input</figcaption></figure><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="fe ff ld"><img src="../Images/ed7b9024a7496e25f213b1d7c697e7c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yfnboxopdeYHEjJ67o_PRA.png"/></div></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Accepts field submission</figcaption></figure><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="fe ff le"><img src="../Images/6870a8febef7e79dc6a2ded24bdc8573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UbM0IaB3q9JtqsWa9pM1tw.png"/></div></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">You can call me Mr. &lt;script&gt;alert(1)&lt;/script&gt; ;-)</figcaption></figure><p id="bfef" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">远程文件包含</strong></p><p id="c63e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">几个网页上的Brother表单中的登录字段没有充分清理或过滤危险的用户输入。通过修改字段、外部网页和文件；此外，还可以执行其他恶意活动。此漏洞还会绕过任何登录权限。</p><p id="aec0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">修改表单元素后重新播放，因为它接受URL。我可能会让它打开不良文件和其他东西。我用ZAP和Fiddler 4作为代理来测试和证明。用户代理字符串无关紧要。</p><p id="28e9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">易受攻击的请求(1.2.3.4假冒IP)</p><p id="0780" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">【http://1.2.3.4/general/status.html邮报】T2 HTTP/1.1</p><p id="2270" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">主持人:12.3.4</p><p id="978b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">用户代理:Mozilla/5.0(Windows NT 6.3；Win64x64rv:57.0)壁虎/20100101火狐/57.0</p><p id="8652" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">接受:text/html，application/xhtml+xml，application/XML；q=0.9，*/*；q=0.8</p><p id="f2e3" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">接受-语言:en-US，en；q=0.5</p><p id="41f1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">接受编码:gzip，deflate</p><p id="d706" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">推荐人:http://1.2.3.4/general/contact.html</p><p id="e227" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">内容类型:<strong class="jx hv">应用程序/x-www-form-urlencoded </strong></p><p id="db64" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">内容长度:45</p><p id="95b1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">DNT: 1</p><p id="b9ca" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">连接:保持活动</p><p id="0c0a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">升级-不安全-请求:1</p><p id="11c2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">Ncb = ZAP</strong>&amp;<strong class="jx hv">loginurl = https % 3A % 2F % 2fwww . Reddit . com</strong></p><p id="71e4" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">HTTP/1.1 200没问题</p><p id="2e79" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">你收到的是Reddit或Google或任何你想通过打印机网络接口部分打开的东西。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff lf"><img src="../Images/897cf77ab36a1f6a765ff0863eba1f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*l--r9BhjSQh4dQn9-HCK7A.png"/></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Yummy</figcaption></figure><p id="2fa5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">结论</strong></p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="fe ff lg"><img src="../Images/b2e690f9c3d5dc78c3c59430c6abf9d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-3ysKLf0Kt45dt1_IfuXQ.png"/></div></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Hope one of these isn't exposing something important, like a hospital network…..</figcaption></figure><p id="81a4" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">利用打印机作为攻击工具不是理论上的，而是一个有趣且潜在的诱人目标。打印机连接到您的网络，它们有关于您的网络的信息，有时内置的管理工具可以双重使用，并可用作更深入网络的秘密攻击点。打印机和多功能扫描仪通常在安全测试、修补、风险评估或安全策略中被忽略。没有打印机防病毒或下一代打印机入侵保护系统，并且出于安全目的通常只有有限的可用日志。Censys.io编写了标记检测到的打印机设备的功能是有原因的。</p><p id="d0da" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">回到2017年，我开始尝试向哥哥报告这些问题，但无济于事。可悲的是，哥哥没有回应，也没有臭虫赏金计划。提供给CERT作为漏洞报告。打印机并不超级性感，但它们可以为具有想象力的攻击者提供一个可爱的支点。攻击者只需要幸运一次。每次都要运气好。不要让它变得容易，用密码保护你的打印机，限制暴露给外界。拜托，看在上帝的份上，不要相信那个诡计多端的塑料墨水杀手。</p><p id="d07b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">留个鼓掌(或者<strong class="jx hv"> 50+ </strong>)和a请随意评论。</p></div></div>    
</body>
</html>