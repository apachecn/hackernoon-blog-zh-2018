<html>
<head>
<title>3 Kinds of Parentheses: Are you a RegEx Master?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">3种括号:你是正则表达式大师吗？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/3-kinds-of-parentheses-are-you-a-regex-master-6b10eb4f41e8?source=collection_archive---------16-----------------------#2018-05-03">https://medium.com/hackernoon/3-kinds-of-parentheses-are-you-a-regex-master-6b10eb4f41e8?source=collection_archive---------16-----------------------#2018-05-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/c4639b9752a4a0906490f5df88c62109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*k9XzjEHqKsdL1hcW.jpg"/></div></div></figure><p id="27c4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您曾经花时间编写代码，那么毫无疑问，您已经滥用了正则表达式，直到它们变成一堆难以理解的字符，可能会给真正的解析器带来麻烦。即便如此，当我得知正则表达式中有3种不同的括号，而不仅仅是2种时，我还是很惊讶。</p><p id="a4f9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">不，2不是左和右，聪明的家伙。</p><p id="d32d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">三种类型的括号是文字括号、捕获括号和非捕获括号。你可能知道如何捕捉括号。您也可以识别文字括号。让大多数人感到困惑的是非捕获括号，以及围绕多重和嵌套捕获括号的语义。(真正的正则表达式大师，请按住“但是等等，还有更多！”为结论)。</p><h2 id="9432" class="ka kb hu bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku dt translated">文字括号</h2><p id="5cbc" class="pw-post-body-paragraph jc jd hu je b jf kv jh ji jj kw jl jm jn kx jp jq jr ky jt ju jv kz jx jy jz hn dt translated">文字括号就是你想要匹配的文字。假设您想要匹配形式为<code class="eh la lb lc ld b">(xxx)yyy-zzzz</code>的美国电话号码。您可以将正则表达式写成<code class="eh la lb lc ld b">/\(\d{3})\d{3}-\d{4}/</code>。请注意，我们必须键入<code class="eh la lb lc ld b">\(</code>，而不仅仅是一个裸体的<code class="eh la lb lc ld b">(</code>。这是因为原始括号启动了一个捕获或非捕获组。如果我们想匹配文本中的文字括号，我们必须用<code class="eh la lb lc ld b">\</code>对其进行转义。</p><h2 id="26f9" class="ka kb hu bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku dt translated">捕捉括号</h2><p id="09ad" class="pw-post-body-paragraph jc jd hu je b jf kv jh ji jj kw jl jm jn kx jp jq jr ky jt ju jv kz jx jy jz hn dt translated">你可能也写了一些捕获括号，不管你是否打算捕获。这些括号不是用来匹配文本中的文字<code class="eh la lb lc ld b">()</code>，而是用来在正则表达式中将字符分组，以便我们可以应用其他运算符，如<code class="eh la lb lc ld b">+</code>、<code class="eh la lb lc ld b">*</code>、<code class="eh la lb lc ld b">?</code>或<code class="eh la lb lc ld b">{n}</code>。</p><p id="8e3f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">例如，如果我们只想匹配字符串<code class="eh la lb lc ld b">can</code>或<code class="eh la lb lc ld b">can’t</code>，我们可以写<code class="eh la lb lc ld b">/can('t)?/</code>。我们在这里需要括号，因为<code class="eh la lb lc ld b">/can't?/</code>将只匹配字符串<code class="eh la lb lc ld b">can’</code>和<code class="eh la lb lc ld b">can’t</code>，而不是我们想要的。</p><figure class="lf lg lh li fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff le"><img src="../Images/af339eea172c75f53bb0a0109758285d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JJzp-NubIvZ1Myn5.jpg"/></div></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek">Photo by <a class="ae ln" href="https://unsplash.com/photos/13PjNBaDMcg?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">David Clode</a> on <a class="ae ln" href="https://unsplash.com/search/photos/butterfly?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="77ff" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然而，这里还发生了别的事情。这些被称为捕捉括号是有原因的——即它们捕捉任何与它们所包含的表达式相匹配的内容，供程序以后使用。继续这个可以/不可以的例子，在JavaScript中我们得到:</p><pre class="lf lg lh li fq lo ld lp lq aw lr dt"><span id="2fe8" class="ka kb hu ld b fv ls lt l lu lv">const match = /can('t)?/.exec("We can't do it!");<br/> console.log(match[0]); // prints the match "can't"<br/> console.log(match[1]); // prints captured "'t"</span></pre><p id="1311" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这里，<code class="eh la lb lc ld b">match[1]</code>包含由括号捕获的项目。现在这有点无趣，因为我们真的不关心与单词<code class="eh la lb lc ld b">can’t</code>分开的<code class="eh la lb lc ld b">‘t </code>。</p><p id="3bff" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">电话号码的例子变得更加有趣。在JavaScript中，我们可以提取美国风格电话号码的区号，如下所示:</p><pre class="lf lg lh li fq lo ld lp lq aw lr dt"><span id="9868" class="ka kb hu ld b fv ls lt l lu lv">const match = /\((\d{3})\)\d{3}-\d{4}/.exec("(303)555-1212");<br/>console.log(match[0]); // (303)555-1212<br/>console.log(match[1]); // 303</span></pre><p id="47ce" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们仔细看看这个正则表达式中发生了什么，<code class="eh la lb lc ld b">/\((\d{3})\)\d{3}-\d{4}/</code>。它几乎与我们在文字括号示例中使用的表达式相同，但是这次我在这对文字括号中添加了一组捕获括号。这告诉正则表达式引擎记住捕获括号内的匹配部分。这个捕获的匹配就是我们在<code class="eh la lb lc ld b">match[1]</code>中找到的。注意，整个电话号码匹配都在<code class="eh la lb lc ld b">match[0]</code>中。这个小例子展示了捕捉括号的强大功能。上面，我们用它从一个电话号码中提取了一个区号。我们可以用它来提取各种文本——穷人的解析器。</p><figure class="lf lg lh li fq iv fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/c610bdf2bc01e2926cae3b17b5e7dcfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*P4nj9fJjSeJ9-c0rwSZqlg.png"/></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek"><a class="ae ln" href="https://xkcd.com/327/" rel="noopener ugc nofollow" target="_blank">“Exploits of a Mom”</a> from <a class="ae ln" href="http://www.xkcd.com" rel="noopener ugc nofollow" target="_blank">XKCD</a></figcaption></figure><p id="554d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">作为另一个简单的例子，我们可以使用捕捉括号通过<code class="eh la lb lc ld b">/(\D+) (\D+)/</code>提取名字和姓氏。<code class="eh la lb lc ld b">match[1]</code>会有名字，<code class="eh la lb lc ld b">match[2]</code>会有姓氏，假设你和鲍比·表的名字不匹配(见漫画)，或者有多余的空格要处理。</p><h2 id="5c20" class="ka kb hu bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku dt translated">非捕获括号</h2><p id="f544" class="pw-post-body-paragraph jc jd hu je b jf kv jh ji jj kw jl jm jn kx jp jq jr ky jt ju jv kz jx jy jz hn dt translated">现在，我们来看第三种括号——非捕获括号。有时候，您需要在一个正则表达式中将事物组合在一起，但是您不想捕获匹配，就像上面的can/can示例一样。为了避免捕获<code class="eh la lb lc ld b">‘t</code>，我们写<code class="eh la lb lc ld b">/can(?:'t)?/</code>。在这里，我们得到的是完整的匹配，没有子匹配。</p><p id="7346" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh la lb lc ld b">(?:</code>是一个特殊的序列，它开始一个带括号的组，就像<code class="eh la lb lc ld b">(</code>一样，但是正则表达式引擎被告知，不要费心捕捉组中的匹配，只需使用它作为操作符优先级。让我们看一个更复杂的例子，在这个例子中，忽略带括号的组是有用的。</p><p id="7e6a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们扩展电话号码正则表达式，允许前缀为<code class="eh la lb lc ld b">mobile</code>或<code class="eh la lb lc ld b">office</code>。只捕捉括号，看起来像<code class="eh la lb lc ld b">match = /((mobile|office) )?\((\d{3})\)\d{3}-\d{4}/.exec(...)</code>。(这还高深莫测吗？).问题是我们要提取的区号在<code class="eh la lb lc ld b">match[3]</code>里。(至于为什么，我将把它作为一个练习留给读者。)这是令人困惑的，也是不必要的，因为在这个例子中，除了区号之外，我们不关心注释或任何其他东西。要仅捕获区号，我们可以:</p><pre class="lf lg lh li fq lo ld lp lq aw lr dt"><span id="f7c3" class="ka kb hu ld b fv ls lt l lu lv">const re = /(?:(?:mobile|office) )?\((\d{3})\)\d{3}-\d{4}/;<br/>const match = re.exec('mobile (303)555-1212');<br/>console.log(match[0]); //mobile (303)555-1212<br/>console.log(match[1]); //303</span></pre><p id="7c61" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">注意注释周围的两组非捕获括号<code class="eh la lb lc ld b">(?:</code>，但是在区域代码周围使用了常规的捕获括号。</p><blockquote class="lx"><p id="90f5" class="ly lz hu bd ma mb mc md me mf mg jz ek translated"><strong class="ak">有些人在遇到问题时会想<br/>“我知道，我会用正则表达式。”现在他们有两个问题。</strong></p><p id="60bb" class="ly lz hu bd ma mb mc md me mf mg jz ek translated"><a class="ae ln" href="https://www.jwz.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ak">——杰米·扎温克西</strong> </a></p></blockquote><h2 id="67fe" class="ka kb hu bd kc kd mh kf kg kh mi kj kk jn mj km kn jr mk kp kq jv ml ks kt ku dt translated">但是等等，还有呢！</h2><p id="4517" class="pw-post-body-paragraph jc jd hu je b jf kv jh ji jj kw jl jm jn kx jp jq jr ky jt ju jv kz jx jy jz hn dt translated">现在你有了，三种括号，字面的，捕捉的和非捕捉的——<code class="eh la lb lc ld b">\(</code>，<code class="eh la lb lc ld b">(</code>，<code class="eh la lb lc ld b">(?:</code>。我们可能应该比现在更多地使用<code class="eh la lb lc ld b">(?:</code>，但是我发现它很难阅读，所以只要<code class="eh la lb lc ld b">(</code>不会导致任何性能问题或对现有正则表达式的语义改变(通过改变寻找相关组匹配所需的索引)，我将跳过额外的<code class="eh la lb lc ld b">?:</code>。我不确定这是否是最佳实践，但是让我们面对现实吧，正则表达式已经很难读懂了。</p><p id="ca91" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">真正的正则表达式大师知道还有其他类型的括号也使用<code class="eh la lb lc ld b">(?</code>语法。唉，我实际上不是正则表达式专家，所以我将让您去搜索其他资源来了解这些内容，因为许多本机正则表达式库不支持它们，JavaScript就是其中之一。<a class="ae ln" href="https://www.regular-expressions.info/named.html" rel="noopener ugc nofollow" target="_blank">命名的正则表达式组</a>是其中最有用的。</p></div></div>    
</body>
</html>