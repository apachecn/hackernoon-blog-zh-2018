<html>
<head>
<title>Cleaning up Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">清理码头工人</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/cleaning-up-docker-f14edd6fcf4c?source=collection_archive---------6-----------------------#2018-05-04">https://medium.com/hackernoon/cleaning-up-docker-f14edd6fcf4c?source=collection_archive---------6-----------------------#2018-05-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/04a6b218434afe95924d653a2ef68432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C6BkVKRpoVK_Pq1TLqlSkQ.png"/></div></div></figure><p id="af50" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">随着Docker在开发中运行时间的推移，我们往往会积累大量未使用的图像。有时是为了测试、研究或尝试有趣的新东西。在容器中运行新软件总是很酷，为我们这些对不断学习新技术感兴趣的人带来了新的可能性。缺点是大量珍贵的固态硬盘内存被很少使用或未使用的图像占用，更糟糕的是我们几乎没有注意到。但是Docker公司的人做了一项伟大的工作，记录了Docker的所有事情。</p><p id="9582" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">向<code class="eh ka kb kc kd b">system</code>命令问好，它是docker管理命令的一部分，非常棒。<code class="eh ka kb kc kd b">system</code>命令提供了从磁盘使用到系统范围的信息，是不是很酷。</p><h1 id="ef44" class="ke kf hu bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated"><strong class="ak">磁盘用法使用</strong> <code class="eh ka kb kc kd b"><strong class="ak">df</strong></code> <strong class="ak">命令:</strong></h1><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="c473" class="lk kf hu kd b fv ll lm l ln lo">$ docker system df</span></pre><p id="39bf" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">返回类似这样的内容，</p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="dd7d" class="lk kf hu kd b fv ll lm l ln lo">TYPE              TOTAL     ACTIVE     SIZE         RECLAIMABLE<br/>Images            35        6          8.332GB      7.364GB (88%)<br/>Containers        12        12         417.6MB      0B (0%)<br/>Local Volumes     67        2          2.828GB      2.828GB (100%)<br/>Build Cache                            0B           0B</span></pre><p id="38e3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">注意<code class="eh ka kb kc kd b">Reclaimable</code>这是您可以恢复的大小，它是通过从总图像大小中减去活动图像的大小来计算的。</p></div><div class="ab cl lp lq hc lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hn ho hp hq hr"><p id="c995" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">实时事件使用</strong> <code class="eh ka kb kc kd b"><strong class="je hv">events</strong></code> <strong class="je hv">命令:</strong></p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="e13c" class="lk kf hu kd b fv ll lm l ln lo">$ docker system events</span></pre><p id="4047" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">根据Docker对象类型，从服务器返回实时事件列表。</p><p id="b8b3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">格式化输出</p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="628c" class="lk kf hu kd b fv ll lm l ln lo">$ docker system events <!-- -->--format 'Type={{.Type}}  Status={{.Status}}  ID={{.ID}}'</span></pre><p id="0142" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者简单地将输出格式化为JSON</p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="07c1" class="lk kf hu kd b fv ll lm l ln lo">$ docker system events --format '{{json .}}'</span></pre></div><div class="ab cl lp lq hc lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hn ho hp hq hr"><p id="5888" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">系统范围信息使用</strong> <code class="eh ka kb kc kd b"><strong class="je hv">info</strong></code> <strong class="je hv">命令:</strong></p><p id="f6ef" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">另一个获取所有系统相关信息的很酷的命令是<code class="eh ka kb kc kd b">info</code>命令。你会惊讶地发现你能获得的信息量。</p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="efde" class="lk kf hu kd b fv ll lm l ln lo">$ docker system info</span></pre></div><div class="ab cl lp lq hc lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hn ho hp hq hr"><p id="4ac0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">使用</strong> <code class="eh ka kb kc kd b"><strong class="je hv">prune</strong></code> <strong class="je hv">命令删除未使用的数据:</strong></p><p id="d3ff" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们已经有了所有需要的信息，是时候清理了，但是要小心不要在半睡眠状态下使用这个命令。</p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="ee9a" class="lk kf hu kd b fv ll lm l ln lo">$ docker system prune<br/>WARNING! This will remove:<br/>        - all stopped containers<br/>        - all networks not used by at least one container<br/>        - all dangling images<br/>        - all build cache<br/>Are you sure you want to continue? [y/N]</span></pre><p id="669a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此外，我们可以删除我们想要的，使用以下任何命令，大饱眼福女士们先生们。</p><pre class="lc ld le lf fq lg kd lh li aw lj dt"><span id="e052" class="lk kf hu kd b fv ll lm l ln lo">$ docker system prune -a --volumes<br/>$ docker image prune<br/>$ docker container prune<br/>$ docker volume prune<br/>$ docker network prune</span></pre><p id="e07a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">上面所有的命令都会提示确认，所以在发出这些命令之前，用冷水洗脸或者喝一杯浓咖啡；).</p></div></div>    
</body>
</html>