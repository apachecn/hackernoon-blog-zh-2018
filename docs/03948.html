<html>
<head>
<title>I Wrote a Go Script to Generate Gists, Here’s What I Learned</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我写了一个Go脚本来生成Gists，下面是我学到的东西</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/i-wrote-a-go-script-to-generate-gists-heres-what-i-learned-bca86435c878?source=collection_archive---------8-----------------------#2018-05-08">https://medium.com/hackernoon/i-wrote-a-go-script-to-generate-gists-heres-what-i-learned-bca86435c878?source=collection_archive---------8-----------------------#2018-05-08</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/83b03cb611205e51a0540d3b9c52a4df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O8T5gA50sco8Kp_d."/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">That’s not a gopher, its a badger. Photo by <a class="ae jg" href="https://unsplash.com/@hansveth?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Hans Veth</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7988" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">写博客并把它们发布到不同的平台上会有很多忙碌的工作。</p><p id="221d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">例如，我通常通过在代码编辑器中创建一个markdown文件来开始写一篇文章。在我写这篇文章的时候，我会插入代码片段和图片，让内容更容易理解。</p><p id="cafb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然而，当我需要将同样的降价发布到<a class="ae jg" rel="noopener" href="/@iwilsonq">媒体</a>时，问题出现了。虽然他们的文本编辑器很漂亮，但是在那里复制粘贴我的markdown文件并不完全安全。</p><p id="38b6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">以下是一些问题:</p><ul class=""><li id="f25c" class="kf kg hu jj b jk jl jo jp js kh jw ki ka kj ke kk kl km kn dt translated">粘贴时，反勾号中的代码字(如<code class="eh ko kp kq kr b">fields</code>或<code class="eh ko kp kq kr b">someFunction</code>)的格式不正确</li><li id="0170" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke kk kl km kn dt translated">较大的代码块目前不支持语法突出显示</li></ul><pre class="kx ky kz la fq lb kr lc ld aw le dt"><span id="7bd6" class="lf lg hu kr b fv lh li l lj lk">function doSomething() { <br/>  return function(name) { <br/>    return 'Hello ' + name<br/>  }<br/>}</span></pre><ul class=""><li id="65d7" class="kf kg hu jj b jk jl jo jp js kh jw ki ka kj ke kk kl km kn dt translated">用<strong class="jj hv">粗体</strong>或<em class="ll">斜体</em>表示的单词保持它们的样式，但不会从我的减价文件中包装它们的*s中分离出来</li></ul><p id="2143" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这是粘贴的3个要点的截图:</p><figure class="kx ky kz la fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lm"><img src="../Images/bd05d564796501890d4860c5a9b2819d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hrQJ5rjnUZB5wgfXQB78vA.png"/></div></div></figure><p id="beca" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">可以说我懒，但是写完一篇2500+字的帖子，我必须:</p><ul class=""><li id="a1ea" class="kf kg hu jj b jk jl jo jp js kh jw ki ka kj ke kk kl km kn dt translated">仔细检查每一行，确保我的语法有意义。</li><li id="0c5e" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke kk kl km kn dt translated">确保我的代码示例工作，因为我的一些文章是教程。</li><li id="c16f" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke kk kl km kn dt translated">通过<a class="ae jg" href="https://gist.github.com/" rel="noopener ugc nofollow" target="_blank"> Github Gists </a>让我的代码看起来很漂亮，这样就带来了一个全新的标签尺寸问题。</li><li id="d151" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke kk kl km kn dt translated">清理每一个降价风格的超链接，从突出显示的单词和短语中删除多余的星号或反勾号。</li></ul><p id="a433" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这变成了<strong class="jj hv">排空</strong>。试图制作可以在多个网站上交叉发布的内容需要做大量的工作。在一个网站上发布内容需要做大量的工作。</p><p id="05c3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为什么我不干脆屈服，只在<a class="ae jg" href="https://dev.to/iwilsonq" rel="noopener ugc nofollow" target="_blank"> dev.to </a>或<a class="ae jg" href="http://ianwilson.io" rel="noopener ugc nofollow" target="_blank">我自己的网站</a>上发帖，在那里我只需要粘贴我的降价文件？</p><p id="d3e0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">因为那不是我的nind。我必须在互联网上无所不在。</p><h1 id="7c74" class="ln lg hu bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj dt translated">清理代码片段</h1><p id="c9f1" class="pw-post-body-paragraph jh ji hu jj b jk mk jm jn jo ml jq jr js mm ju jv jw mn jy jz ka mo kc kd ke hn dt translated">先从最下面挂着的果子抓起，也就是清理那些代码片段。我们如何做到这一点？</p><p id="6eff" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">那么，强力的方法就是像平常一样复制和粘贴，去掉表示代码块的反勾号，按“CMD+option+6”来创建一个中等的代码块，然后处理代码块中笨拙的换行符和制表符。不要忘记，在媒体编辑器中的标签不像在代码编辑器中那样工作。</p><p id="cc43" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">没有。我不会再那样做了。</p><p id="a732" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">下一个选项是手动创建Github gists，它将代码格式化委托给Github。我们甚至可以从中突出语法。</p><p id="2baf" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然而，在我最近的测试中，gists的标签大小似乎默认为8。这里有一个我刚刚粘贴到一个要点中的例子，<em class="ll">特别是在编辑器中设置大小为2 </em>的空间。</p><figure class="kx ky kz la fq iv"><div class="bz el l di"><div class="mp mq l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Argh! Nobody uses size-8 tabs, Github</figcaption></figure><p id="58fe" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">似乎解决这个问题的唯一方法是用空格(在我的例子中是两个空格)替换所有的制表符。在本例中，我可以手动完成这项工作。如果只有一个片段需要清理，那还不错。</p><p id="30e5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">缺点是每个制表符都必须用空格替换。我的上一篇文章有18个JavaScript代码片段。这是一次悲惨的编辑经历。</p><h1 id="e28f" class="ln lg hu bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj dt translated">Gist生成器简介</h1><p id="00c3" class="pw-post-body-paragraph jh ji hu jj b jk mk jm jn jo ml jq jr js mm ju jv jw mn jy jz ka mo kc kd ke hn dt translated">* <em class="ll">我希望我能想出一个更酷的名字</em></p><p id="3331" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我决定利用我的开发能力，利用Github API来创建gists。这个用Go编写的脚本将如下进行:</p><ol class=""><li id="f9d1" class="kf kg hu jj b jk jl jo jp js kh jw ki ka kj ke mr kl km kn dt translated">读入降价文件</li><li id="eb80" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke mr kl km kn dt translated">解析像“go”或“javascript”这样的语言片段</li><li id="6348" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke mr kl km kn dt translated">为每个片段创建一个要点</li><li id="ab16" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke mr kl km kn dt translated">保留一个引用片段和要点的对象</li><li id="cbbc" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke mr kl km kn dt translated">用它们各自的要点URL替换这些片段</li><li id="2658" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke mr kl km kn dt translated">写入一个新的markdown文件，将代码片段替换为gists for Medium</li></ol><p id="594b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你对查看源代码感兴趣，你可以在这里查看回购<a class="ae jg" href="https://github.com/iwilsonq/gist-generator" rel="noopener ugc nofollow" target="_blank"/>。在我决定向任何人出售它之前，我想把一些测试放在一起，但无论如何它都是开源的。</p><p id="a529" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">目前的用法是这样的:</p><pre class="kx ky kz la fq lb kr lc ld aw le dt"><span id="8ebb" class="lf lg hu kr b fv lh li l lj lk">./gist-generator -f example.md -token &lt;GITHUB_ACCESS_TOKEN&gt;</span></pre><p id="3237" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">运行这个脚本后，我们得到了一个名为<code class="eh ko kp kq kr b">example.medium.md</code>的文件，这意味着这是我们理想中发布在medium上的文件，包含要点片段和所有内容。</p><p id="cb88" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果我创建一个web客户端来使用这个脚本，用户将使用他们的Github帐户进行签名，省去了手动生成个人访问令牌并将其粘贴到CLI中的步骤。</p><p id="b77b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这是一件很好的事情，但是现在还不在我的考虑范围内——让我们来看看一些更紧迫的问题。</p><h1 id="8d10" class="ln lg hu bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj dt translated">遇到的问题</h1><p id="39b8" class="pw-post-body-paragraph jh ji hu jj b jk mk jm jn jo ml jq jr js mm ju jv jw mn jy jz ka mo kc kd ke hn dt translated">在写这个剧本的时候，我在几个地方遇到了麻烦。</p><p id="5f71" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">其中一个问题是处理将要创建的要点的格式。在我的markdown代码片段中看起来不错的东西在gist中不一定好看。</p><p id="5c50" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在第一遍中，由于换行和过大的制表符，我有过多的空白。通过迭代代码片段中的字节，我可以删除不必要的换行符并用空格替换制表符。这里有一个例子:</p><figure class="kx ky kz la fq iv"><div class="bz el l di"><div class="mp mq l"/></div></figure><p id="f71f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在我为这个脚本编写的所有Go代码中，为什么我要显示换行符和制表符的修剪？</p><p id="4df9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这是因为空白问题是最容易产生最大结果的问题。</p><p id="e45f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">还有一些较低层次的问题，涉及如何最好地解析文件或使用字节缓冲区构建字符串。我可能会在未来的帖子中解决这个问题，因为它值得拥有自己的解决方案——Go有许多强大的内置方法，仅靠医生是不够的。</p><h1 id="0e11" class="ln lg hu bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj dt translated">经验教训和未来项目</h1><p id="85da" class="pw-post-body-paragraph jh ji hu jj b jk mk jm jn jo ml jq jr js mm ju jv jw mn jy jz ka mo kc kd ke hn dt translated">我喜欢这个项目有几个原因:</p><ul class=""><li id="e6db" class="kf kg hu jj b jk jl jo jp js kh jw ki ka kj ke kk kl km kn dt translated">它足够小，不会太吓人</li><li id="339a" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke kk kl km kn dt translated">最终目标很明确也很实际:提高我博客文章的质量</li><li id="7f9f" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke kk kl km kn dt translated">我有机会练习开发一个Go命令行工具</li><li id="1cb0" class="kf kg hu jj b jk ks jo kt js ku jw kv ka kw ke kk kl km kn dt translated">它可以很容易地融入类似博客生产力工具的生态系统</li></ul><p id="2d3e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">关于最后一点，我意思是要点生成步骤可以是几个步骤中的一个。</p><p id="6113" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我可以写一个类似的脚本，从博客文本中删除多余的减价字符。通过<a class="ae jg" rel="noopener" href="/@andymcfee/how-to-import-markdown-into-medium-c06dc981bd96">这篇文章</a>，我发现了部分完成这一步的方法。</p><p id="6df0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Medium允许导入一个粘贴在gist中的markdown文件(因为它需要一个URL)。这使得它能够正确处理反勾号和星号换行的单词。它甚至可以处理文本中的超链接。</p><p id="e8ff" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为了处理语法错误，我可以添加一个步骤，或许可以调用一个简单的语法上的<em class="ll"> ish </em> API。如果开源解决方案还不存在，这可能是另一个未来项目的想法。</p><p id="cc35" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我甚至可以创建一个仪表板，如果我的脚本中的一个错误导致其中任何一个错误，它将允许我轻松地删除gists。目前的<a class="ae jg" href="https://gist.github.com/" rel="noopener ugc nofollow" target="_blank">官方要点仪表盘</a>在编辑或删除要点时效率相当低。</p><p id="b395" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">最后，我一直在思考一个基于云的markdown编辑器的想法，这个编辑器可以在手机上使用。你知道，当我在迪斯尼排队等着编辑我的一篇文章的时候。这种时候。</p><h1 id="a790" class="ln lg hu bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj dt translated">包扎</h1><p id="ea29" class="pw-post-body-paragraph jh ji hu jj b jk mk jm jn jo ml jq jr js mm ju jv jw mn jy jz ka mo kc kd ke hn dt translated">这么多事要做，时间却这么少。我想我的下一步是讨论关于从markdown引入故事的其他美学问题。</p><p id="8418" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在这一点上，任何减少编写技术内容所涉及的摩擦的项目都是有价值的。</p><p id="4da3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个项目源于我想消除大量冗余编辑带来的一些痛苦。有些问题是由于对平台不熟悉造成的，有些是由于平台的实际限制造成的。</p><p id="f4a4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">撰写这样的文章并着手类似的项目可以解决这两个问题:您可以一直了解该平台的能力，同时改进其不足之处。</p><p id="1cac" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">毫无疑问，以生产力的名义，这是一次很棒的学习经历。</p><p id="8073" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">同样，这里的<a class="ae jg" href="https://github.com/iwilsonq/gist-generator" rel="noopener ugc nofollow" target="_blank">是项目回购的链接，如果你想研究它是如何工作的。</a></p></div><div class="ab cl ms mt hc mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="hn ho hp hq hr"><p id="504c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">好奇更多帖子或者妙语连珠？给我一些掌声，在<a class="ae jg" rel="noopener" href="/@iwilsonq">媒体</a>、<a class="ae jg" href="https://github.com/iwilsonq" rel="noopener ugc nofollow" target="_blank"> Github </a>和<a class="ae jg" href="https://twitter.com/iwilsonq" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我吧！</p></div></div>    
</body>
</html>