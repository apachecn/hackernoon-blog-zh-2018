<html>
<head>
<title>Atomic Swaps Simply Explained: How to Swap Cryptocurrencies without a Middleman</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">原子互换简单地解释了:如何在没有中间人的情况下交换加密货币</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/atomic-swaps-simply-explained-how-to-swap-cryptocurrencies-without-a-middleman-6cd29680c32e?source=collection_archive---------3-----------------------#2018-05-10">https://medium.com/hackernoon/atomic-swaps-simply-explained-how-to-swap-cryptocurrencies-without-a-middleman-6cd29680c32e?source=collection_archive---------3-----------------------#2018-05-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="4fc8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想买卖<a class="ae jp" href="https://hackernoon.com/tagged/cryptocurrency" rel="noopener ugc nofollow" target="_blank">加密货币</a>，目前你只有一个好的选择:使用集中交易所。</p><p id="b2f6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">出于这个原因，我们制作了<a class="ae jp" href="https://www.hodlbot.io/?utm_source=medium&amp;utm_medium=blog&amp;utm_campaign=atomic-swaps" rel="noopener ugc nofollow" target="_blank"> HodlBot，这是一个算法机器人，可以自动多样化为前20种加密货币</a>，与币安等交易所兼容。</p><p id="ca45" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是当然有更好的方法来交换加密货币。集中式交易所存在一些大问题。首先，就在过去的几个月里，我们经历了两次交易所黑客攻击，黑客偷走了价值5亿美元的NEM币和1.7亿美元的纳米币。而且不仅仅是黑客。交易所收取高额的取款费和交易费，让密码交易员损失惨重。</p><p id="4e08" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最具讽刺意味的是，加密货币给了我们一种点对点的货币交易方式，但我们仍然需要通过第三方进行交易。</p><p id="d530" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">crypto的思想家们一直在努力解决这个问题。在他们别出心裁的解决方案中，最有前途的一个被称为原子交换。</p><h2 id="ed1d" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">什么是原子交换？</h2><p id="9595" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">原子互换是不同加密货币之间的点对点互换，不需要中间人。单词“<a class="ae jp" href="https://en.wikipedia.org/wiki/Atomicity_(database_systems)" rel="noopener ugc nofollow" target="_blank">原子</a>”是一个奇特的计算机科学术语，意思是它们要么完全发生，要么根本不发生。</p><p id="d716" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">令人惊讶的是，原子性允许人们在不信任对方的情况下进行交换。让我们通过一个真实的故事来探索它是如何工作的。</p><h2 id="11fe" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">用美钞兑换金币</h2><p id="2cc2" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">鲍勃的祖父去世了，他继承了一小袋24克拉的金币。他在网上查了一下，发现它们可能价值3万美元。他决定卖掉它们。</p><p id="fd8c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在第一次尝试中，他把他们带到了一个昏暗的当铺。可以预见的是，店主给他报了一个可怕的价格，这将使桌子上剩下几千美元。</p><figure class="kr ks kt ku fq kv fe ff paragraph-image"><div class="fe ff kq"><img src="../Images/4f345208ee765ecb6b9149d392653c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*qh-lAAAW6QN9QHLaBh6IZg.jpeg"/></div><figcaption class="ky kz fg fe ff la lb bd b be z ek">Oh Rick</figcaption></figure><p id="4fb7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">经过一番考虑，他认为直接卖给另一个人比通过商店或经纪人要好得多。</p><p id="7a47" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">他在一个在线论坛上点击了一会儿，接触到一个名叫爱丽丝的女人，她想以27，000美元的现金购买他的硬币。得分！但是经过一番反复之后，事情变得很明显:他们都不信任对方，不会先把自己的份额寄出去。</p><p id="da2d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那么他们会怎么做呢？他们在这个虚构的世界里使用了一种新发明，叫做超级安全互换。这些利用了一种叫做超级保险箱的东西，一种看起来像微波炉的保险箱。每个都有一扇门，一扇窗和一个开门的按钮，两个连在一起做超级安全的交换。</p><h2 id="b4f2" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">超级安全的互换是如何运作的</h2><p id="d82a" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">爱丽丝和鲍勃都把他们的超级保险箱从家里拿出来，搬到街上。</p><figure class="kr ks kt ku fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff lc"><img src="../Images/5d7466a16935cfbe44c8ebeac278c5a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6t2eqt1B-itqHnyiSn5amg.jpeg"/></div></div><figcaption class="ky kz fg fe ff la lb bd b be z ek">Warning: Super Safes do not have the ability to heat up food.</figcaption></figure><p id="3da3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">他们把它们连接在一起。从此时起，只有同时按下两个保险箱上的按钮，它们的门才会打开。</p><p id="fdae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Alice和Bob将他们的物品(分别是现金和硬币)放入保险箱，然后关上。他们分享自己的位置，然后找到通往对方保险箱的路。到达后，他们从保险箱的窗口偷看，检查里面是否有正确的物品。如果他们对内容满意，他们就按下按钮。</p><p id="05ce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果他们都按下按钮，表明他们同意交换，两个安全门都会弹出。爱丽丝可以拿走鲍勃的金币，鲍勃可以拿走爱丽丝的现金，他们都可以开心地离开。</p><p id="081f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是如果爱丽丝或鲍勃不想再进行交换，他们就不会按下按钮。两个保险箱都不会打开，两个人都拿不到对方的东西。</p><p id="b3ec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">没有人能偷，因为交换要么完全发生，要么根本不发生。有了超级保险箱，他们就可以进行交易，不需要中间人，也不需要互相信任。</p><h2 id="a924" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">原子交换，解释</h2><figure class="kr ks kt ku fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff lh"><img src="../Images/17f3a4a977b1875cadba4bca155b03d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mmKIgQ_e78AFgNjCi961NQ.png"/></div></div></figure><p id="cc62" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">假设鲍勃有0.05个比特币，他想和爱丽丝交换1个以太。让我们看看如何使用原子交换来实现这一点。</p><p id="ef54" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">回想一下超级安全的互换，我们需要一个容器来装钱并上锁。为此，我们使用一种特殊类型的<a class="ae jp" href="https://blockgeeks.com/guides/smart-contracts/" rel="noopener ugc nofollow" target="_blank">智能契约</a>，称为<em class="li">锁</em>。</p><h2 id="d0a3" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">爱丽丝做了一个锁</h2><p id="5c3f" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">hashlock是一种智能合约，它锁定硬币，直到某个“秘密密码”被揭示。</p><p id="95ad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Alice使用以下步骤制作一个:</p><ol class=""><li id="272c" class="lj lk hu it b iu iv iy iz jc ll jg lm jk ln jo lo lp lq lr dt translated">选择一个叫做<em class="li">原像</em>的大随机数。这是“秘密密码”。</li><li id="93d3" class="lj lk hu it b iu ls iy lt jc lu jg lv jk lw jo lo lp lq lr dt translated">使用这个原像计算另一个数，称为<em class="li">散列</em>。</li><li id="9ce7" class="lj lk hu it b iu ls iy lt jc lu jg lv jk lw jo lo lp lq lr dt translated">创建一个智能协定来发送Bob 1 Ether，用这个哈希锁定。只有当Bob能够展示映射到hash的原像时，硬币才会被释放。</li></ol><p id="93aa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在步骤2中从原映像计算散列很容易，但是在给定散列的情况下计算原映像几乎是不可能的。这意味着鲍勃不能解开硬币，除非爱丽丝给他原像。</p><p id="95b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这类似于把现金锁在超级保险箱里。</p><figure class="kr ks kt ku fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff lx"><img src="../Images/c1cc8d5f705cb1d8c07e189cd34384f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5gs4pu1vDWAuLJqOUAW-Mg.png"/></div></div><figcaption class="ky kz fg fe ff la lb bd b be z ek">Initial transaction</figcaption></figure><h2 id="9557" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">鲍勃回报</h2><p id="4ebe" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">Bob检查Alice是否发送了一个以太网的hashlock契约。他可以通过观察公众<a class="ae jp" href="https://hackernoon.com/tagged/blockchain" rel="noopener ugc nofollow" target="_blank">区块链</a>来证实这一点。此后，Bob向Alice发送了一份价值0.05比特币的hashlock合同，该合同由Alice使用的hash锁定。这将两个交易锁定在一起，类似于超级安全交换中的链接保险箱。</p><figure class="kr ks kt ku fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff lx"><img src="../Images/9b54309b7e1b684bfcfcea17cd9bc877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Pss6UW_PIL_8CmAgvF8UQ.png"/></div></div><figcaption class="ky kz fg fe ff la lb bd b be z ek">Reciprocal transaction</figcaption></figure><h2 id="2897" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">解开硬币</h2><p id="f21e" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">当爱丽丝想要解锁鲍勃发给她的<a class="ae jp" href="https://hackernoon.com/tagged/bitcoin" rel="noopener ugc nofollow" target="_blank">比特币</a>时，她需要使用原像(秘密密码)来解锁。</p><p id="b07a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是当她这么做的时候，这个原像就会出现在<a class="ae jp" href="https://hackernoon.com/tagged/blockchain" rel="noopener ugc nofollow" target="_blank">区块链</a>上，成为公共信息。然后，Bob可以用它来解锁Alice的以太，因为锁定两个合同使用的是同一个哈希。</p><p id="a997" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以你可以看到，就像在超级安全的交换中一样，这种交换是自动发生的。要么交易对双方都成功执行，要么根本不成交。</p><p id="cb59" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是有一个很大的问题我们没有考虑到:如果爱丽丝从来没有展示过解锁鲍勃比特币的原像呢？那么这两份合同将永远锁定。</p><h2 id="ffe1" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">为失败的交换退款</h2><p id="9a6e" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">发生这个问题是因为我们没有办法在失败的情况下回滚交换。</p><p id="9034" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以让我们加上一条:如果24小时后爱丽丝还没有显示原图像，那么退还两个合同。这被称为<em class="li">时间锁</em>。</p><figure class="kr ks kt ku fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff ly"><img src="../Images/2d78b6ca674055791c3030c5e6892c76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dG6y3d3UpZvGPB8_poyQyg.png"/></div></div><figcaption class="ky kz fg fe ff la lb bd b be z ek">Hashlocked transactions with timelock</figcaption></figure><p id="e430" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，如果爱丽丝在24小时内没有显示出原像，鲍勃可以拿回他的0.05比特币，爱丽丝可以拿回她的1以太。</p><p id="be36" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">听起来不错，对吧？但爱丽丝仍有可能造成危险。</p><h2 id="68c1" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">给爱丽丝更长的时间锁</h2><p id="1132" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">假设Alice等待了23小时55分钟，直到她使用原像解锁Bob的合同。那么Bob只有5分钟来解锁Alice的合同。如果互联网连接(或其他)问题阻止Bob这样做，那么Alice的合同将被退还。爱丽丝偷了鲍勃的比特币。</p><p id="d847" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">解决办法？将爱丽丝合同的退款延迟加倍至48小时。如果爱丽丝等24小时，鲍勃还有24小时解锁。</p><figure class="kr ks kt ku fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="fe ff lz"><img src="../Images/de6d88ee2d69328b8a42d62e7986b3dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b-oMla886HAGaqcW1USp5Q.png"/></div></div><figcaption class="ky kz fg fe ff la lb bd b be z ek">The final product</figcaption></figure><p id="fc25" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这就是:一个全功能的原子交换！</p><h2 id="5204" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">缺点</h2><p id="95f5" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">原子交换有很大的潜力，但也有问题:</p><ol class=""><li id="b4f3" class="lj lk hu it b iu iv iy iz jc ll jg lm jk ln jo lo lp lq lr dt translated">它们很慢(除非你用类似<a class="ae jp" href="http://lightning.network" rel="noopener ugc nofollow" target="_blank">闪电网</a>的东西)。</li><li id="5133" class="lj lk hu it b iu ls iy lt jc lu jg lv jk lw jo lo lp lq lr dt translated">主流钱包或交易所尚不支持它们。</li><li id="e582" class="lj lk hu it b iu ls iy lt jc lu jg lv jk lw jo lo lp lq lr dt translated">它们不适用于不支持智能合约的加密货币。</li></ol><p id="31c9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，这些问题将随着时间的推移而得到解决。随着他们这样做，通过中介交换密码将成为过去。</p><h2 id="bf7e" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">未来</h2><p id="0c91" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">原子互换只是交换问题解决方案的一部分。我们还需要分散的交易所:交易所不是由一个人拥有，而是由一个网络拥有，从而防止单点故障。</p><p id="b918" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">作为一家公司，我们的使命是让每个人都能轻松管理加密组合。因此，我们目前只支持大众交易所，因为大多数人都在那里。</p><p id="0f3f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然而，我们认为，在向去中心化的世界转变的过程中，原子掉期等去中心化的交易技术将变得越来越重要。</p><figure class="kr ks kt ku fq kv"><div class="bz el l di"><div class="ma mb l"/></div></figure></div></div>    
</body>
</html>