<html>
<head>
<title>Why I’m automatically deleting my old tweets using AWS Lambda</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我会用AWS Lambda自动删除我的旧推文</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/why-im-automatically-deleting-my-old-tweets-using-aws-lambda-44f237982d95?source=collection_archive---------7-----------------------#2018-05-10">https://medium.com/hackernoon/why-im-automatically-deleting-my-old-tweets-using-aws-lambda-44f237982d95?source=collection_archive---------7-----------------------#2018-05-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/1ca115497f463bab4ec18497a7633ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g1pmPaZgQ3vJAQe_Nh6Ejw.jpeg"/></div></div></figure><div class=""/><p id="485e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ka">读者您好！这篇文章(以及我所有的文章)的更新版本在我的网站上免费提供:</em><a class="ae kb" href="https://victoria.dev" rel="noopener ugc nofollow" target="_blank"><em class="ka">Victoria . dev</em></a><em class="ka">—感谢阅读！</em></p><p id="02e9" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从现在开始，我的微博是短暂的。这就是为什么我要删除我所有的旧推文和免费的AWS Lambda功能。</p><h1 id="5103" class="kc kd if bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">材料和意见</h1><p id="ee94" class="pw-post-body-paragraph jc jd if je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">我成为一个只有一个袋子的流浪者才一年半多一点。在那之前，我像大多数人一样住在公寓或房子里。我拥有家具，比我严格需要的更多的衣服，和足够的“东西”来填满至少几个移动的箱子。如果我去别的地方生活，为了学校、家庭或工作而搬家，我会收拾好所有的东西随身携带。这些年来，我积累了越来越多的东西。</p><p id="185a" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">采纳许多人所谓的极简主义生活方式迅速改变了我长期以来的许多观点。放弃我所有的东西(这个想法我曾经认为原则上很有趣，但实际上有点可笑)已经变得很正常了。现在，对我来说，不拥有我不经常使用的东西是很正常的。我不会在墙上的架子上放满旧书、旧盘子、旧衣服或童年玩具，因为这些东西对我来说已经不再重要了。相反，我只是保留美好的回忆。</p><p id="4f66" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">想象一下，我仍然住在一所房子里。想象一下，在那个房子里，冰箱上，有一幅我六岁时画的画。在这幅画的右下角，用绿色蜡笔潦草地写着“西兰花是哑巴——维基，6岁。”</p><p id="9c8c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你在我家看到冰箱上的那幅画，你会认为“西兰花是愚蠢的”这句话准确地表达了我对西兰花的看法吗？当然不是。我写这个的时候才六岁。我有足够的时间改变主意。</p><h1 id="ea99" class="kc kd if bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">社交媒体不是社交媒体</h1><p id="8b36" class="pw-post-body-paragraph jc jd if je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">我有一个朋友，我们从幼儿园就认识了。我们一起上了小学，这些年来，我们偶尔会说话和见面。我们都是成年人了。有时当我们聊天时，我们会想起年轻时的一些有趣的记忆。就记忆的本质而言，我并不幻想我们回忆起的东西会被准确地叙述出来。我们对发生的事情的印象——我们犯的错误和胜利的时刻——被我们从那时起的经历和我们学到的所有东西所影响。在学校同事的生日聚会上的尴尬时刻成为一个孩子学习社交的例子，而不是当时可能感觉的尴尬的世界末日。</p><p id="00bb" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这就是记忆的工作原理。从某种意义上来说，它应该更新。生活在小社区的人们记得他们的邻居很多年前做过的事情，但是在他们现在的邻居是谁以及他们目前的关系是什么的背景下回忆这些事情。这种对历史的重新着色是人们如何治愈创伤、T2如何做出正确决定、T4如何社交的重要组成部分。</p><p id="6804" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">社交媒体不会这样做。你保存完好的五天前或五年前的推文可以绝对准确地回忆起来。对于大多数人来说，这并不是特别令人担忧。我们倾向于在推特上谈论一些非常平凡的事情——当我们感到无聊并希望有人注意到我们时突然想到的事情。就个人而言，通常情况下，我们的旧推文是相当微不足道的。然而，总的来说，它们相当完整地描绘了一个人随机的、无意中说出的想法。这就是问题所在。</p><p id="129b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对社交媒体和推特上写的东西做出的假设，与你上周对某人记事本上的涂鸦做出的假设截然不同。我不想去猜测为什么——我只是看到了足够多的案例，有人因为几年前发布的东西而被公开鞭打，我知道这确实发生了。这太奇怪了。如果你不认为上周的笔记本涂鸦或几十年前的蜡笔画反映了现在某人的本质，为什么你会认为一条旧推文反映了呢？</p><p id="be33" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你已经不是上个月的那个你了——你所看到的、读到的、理解的和学到的东西，都以某种微小的方式改变了你。虽然一个人可能在一生中的大部分时间里都有相同的自我意识和身份，但这种意识也会随着时间的推移而增长和变化。我们改变我们的观点，我们的欲望，我们的习惯。我们不是停滞不前的存在，我们不应该让我们自己被描述成停滞不前的存在，不管是多么无意的。</p><h1 id="fab6" class="kc kd if bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">短暂的推文</h1><p id="9fde" class="pw-post-body-paragraph jc jd if je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">如果你今天看我的Twitter个人资料页面，你会发现那里的推文比你的手指还少(我希望)。我正在使用<a class="ae kb" href="https://github.com/hivickylai/ephemeral" rel="noopener ugc nofollow" target="_blank">短命</a>——一个我为在<a class="ae kb" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a>上使用而编写的轻量级实用程序——删除我几天前的所有推文。我这样做的原因和我不保存不再使用的东西是一样的——那些东西对我来说不再相关了。也不代表我。</p><p id="08c4" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">组成periodic的代码是用Go写的。AWS Lambda为每个Lambda函数创建了一个环境，所以periodic为您的私人Twitter API密钥和您希望保留的tweets的最大年龄(以小时表示)利用环境变量，如<code class="eh lf lg lh li b">72h</code>。</p><pre class="lj lk ll lm fq ln li lo lp aw lq dt"><span id="4684" class="lr kd if li b fv ls lt l lu lv">var (<br/>	consumerKey       = getenv("TWITTER_CONSUMER_KEY")<br/>	consumerSecret    = getenv("TWITTER_CONSUMER_SECRET")<br/>	accessToken       = getenv("TWITTER_ACCESS_TOKEN")<br/>	accessTokenSecret = getenv("TWITTER_ACCESS_TOKEN_SECRET")<br/>	maxTweetAge       = getenv("MAX_TWEET_AGE")<br/>	logger            = log.New()<br/>)</span><span id="e893" class="lr kd if li b fv lw lt l lu lv">func getenv(name string) string {<br/>	v := os.Getenv(name)<br/>	if v == "" {<br/>		panic("missing required environment variable " + name)<br/>	}<br/>	return v<br/>}</span></pre><p id="04eb" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个程序使用了<a class="ae kb" href="https://github.com/ChimeraCoder/anaconda" rel="noopener ugc nofollow" target="_blank"> anaconda </a>库。它获取您的时间线，达到Twitter API的每个请求200条推文的限制，然后将每条推文的创建日期与您的<code class="eh lf lg lh li b">MAX_TWEET_AGE</code>变量进行比较，以确定它是否足够旧，可以删除。删除所有过期推文后，Lambda函数终止。</p><pre class="lj lk ll lm fq ln li lo lp aw lq dt"><span id="a2af" class="lr kd if li b fv ls lt l lu lv">func deleteFromTimeline(api *anaconda.TwitterApi, ageLimit time.Duration) {<br/>	timeline, err := getTimeline(api)</span><span id="572c" class="lr kd if li b fv lw lt l lu lv">if err != nil {<br/>		log.Error("Could not get timeline")<br/>	}<br/>	for _, t := range timeline {<br/>		createdTime, err := t.CreatedAtTime()<br/>		if err != nil {<br/>			log.Error("Couldn't parse time ", err)<br/>		} else {<br/>			if time.Since(createdTime) &gt; ageLimit {<br/>				_, err := api.DeleteTweet(t.Id, true)<br/>				log.Info("DELETED: Age - ", time.Since(createdTime).Round(1*time.Minute), " - ", t.Text)<br/>				if err != nil {<br/>					log.Error("Failed to delete! ", err)<br/>				}<br/>			}<br/>		}<br/>	}<br/>	log.Info("No more tweets to delete.")</span><span id="3e31" class="lr kd if li b fv lw lt l lu lv">}</span></pre><p id="ca1e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">点击阅读完整代码<a class="ae kb" href="https://github.com/hivickylai/ephemeral/blob/master/main.go" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9640" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于这样的用例，AWS Lambda有一个免费层，不需要任何成本。如果您是任何级别的开发人员，那么熟悉它是非常有用的工具。关于如何设置一个Lambda函数来为你发tweets的完整截图，你可以阅读这篇文章。短命的设置是相同的，它只是有相反的功能。:)</p><p id="95e1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我从亚当·德雷克的<a class="ae kb" href="https://github.com/adamdrake/harold" rel="noopener ugc nofollow" target="_blank">哈罗德</a>那里获得了短命，这是一个Twitter工具，除了保持你的时间表整洁之外，它还有许多有用的功能。如果你一次要删除超过200条推文，请首先使用Harold。您可以从终端运行带有<code class="eh lf lg lh li b">deletetimeline</code>标志的Harold。</p><p id="503f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">出于情感，你可能想在删除之前<a class="ae kb" href="https://twitter.com/settings/your_twitter_data" rel="noopener ugc nofollow" target="_blank">下载你所有的推文</a>。</p><h1 id="f2ad" class="kc kd if bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">为什么要使用Twitter？</h1><p id="4089" class="pw-post-body-paragraph jc jd if je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">预计到这个问题，让我说，是的，除了作为我的Lambda函数填充和清空的桶之外，我确实使用Twitter。它有它的好处，大部分与我认为它最初的预期目的有关:作为一种接近即时的交流手段，将简短、易理解的信息传达给广泛的人群。</p><p id="04c1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我用它来跟踪现在正在发生的事情。我用它来评论、取笑和同情我现在关注的人发的微博。通过将我的时间表限制在最近几天，我觉得我使用Twitter更像是它的本意:一种加入对话并了解世界上正在发生什么的方式<em class="ka"/>——而不仅仅是另一个积累更多“东西”的地方</p></div><div class="ab cl lx ly hc lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hn ho hp hq hr"><p id="57eb" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">感谢阅读！如果你想了解更多关于我如何用科技让生活变得更美好的信息，你可以在这里和Twitter上关注我。对于用拙劣的食物涂鸦解释的编码概念(和语法高亮！)去VickyLai.com的<a class="ae kb" href="https://vickylai.com" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="5b6d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我希望你今天过得非常愉快。:)</p></div></div>    
</body>
</html>