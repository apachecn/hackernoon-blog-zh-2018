<html>
<head>
<title>Building a Music Streaming App using React Native</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React Native构建音乐流应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-a-music-streaming-app-using-react-native-6d0878a13ba4?source=collection_archive---------1-----------------------#2018-05-14">https://medium.com/hackernoon/building-a-music-streaming-app-using-react-native-6d0878a13ba4?source=collection_archive---------1-----------------------#2018-05-14</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="8f41" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://facebook.github.io/react-native/" rel="noopener ugc nofollow" target="_blank"> React Native </a>是一个使用<a class="ae jp" href="https://facebook.github.io/react/" rel="noopener ugc nofollow" target="_blank"> React </a>和Javascript构建原生应用的框架。在这篇文章中，我将介绍构建一个类似于<a class="ae jp" href="https://www.spotify.com/" rel="noopener ugc nofollow" target="_blank"> Spotify </a>的音乐流的过程。真正酷的是，完全相同的代码将适用于iOS和Android，应用程序将是100 %原生的(没有网络浏览量或任何东西)。</p><p id="83a2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将构建“正在播放”屏幕，在Spotify上看起来是这样的:</p><div class="jq jr js jt fq ab cb"><figure class="ju jv jw jx jy jz ka paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/ef87f9ee9877099c3e9085aff4e730ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*4cxeuIozZHnTfzXfipwsmQ.jpeg"/></div></figure><figure class="ju jv jw jx jy jz ka paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/7f6699c3e7f21669c5e894bfde4433af.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*SKs6OUyKtcRBs8w_6p4u1g.jpeg"/></div></figure><figure class="ju jv kh jx jy jz ka paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/c6cb1f012b934f3d735d200c4bca3a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*hSsVfO6-0zGBSzmk-I-3aQ.png"/></div><figcaption class="ki kj fg fe ff kk kl bd b be z ek km di kn ko">Somebody stole my car radio, so now I’m gonna steal Spotify’s UI.</figcaption></figure></div><p id="3030" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">由于我不是设计师，而且我真的很喜欢Spotify简洁的设计，我们将把它作为构建播放器的参考。在第三张图片中，我在<a class="ae jp" href="http://www.apple.com/in/mac/keynote/" rel="noopener ugc nofollow" target="_blank"> Keynote </a>中打开了一个截图，并在整个图片上添加了标尺，以精确测量位置、边距、字体大小等。对于UI中所有不同的元素。我们将使用这些度量来设计我们自己的应用程序的UI。</p><p id="f1f4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们有了一个(偷来的)设计，我们准备开始编码。因此，让我们创建一个新的React原生项目。打开终端窗口，运行以下命令:</p><pre class="jq jr js jt fq kp kq kr ks aw kt dt"><span id="183f" class="ku kv hu kq b fv kw kx l ky kz">$ npm install react-native-cli@latest<br/>$ react-native init ReactMusic</span></pre><p id="9f99" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">唷！那花了一段时间，不是吗？我们现在<em class="la">几乎</em>准备好了，只需要再运行几个命令:</p><pre class="jq jr js jt fq kp kq kr ks aw kt dt"><span id="7de1" class="ku kv hu kq b fv kw kx l ky kz">$ react-native run-ios      # Launch an iOS emulator and run the app<br/>$ android avd &amp;             # Launch an Android emulator<br/>$ react-native run-android  # Run the app on the Android emulator<br/>$ subl .                    # Open up the project in Sublime Text</span></pre><p id="b21b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果最后一个命令对你不起作用，只需在你选择的任何编辑器中打开“ReactMusic”目录，或者执行<a class="ae jp" href="https://www.sublimetext.com/docs/3/osx_command_line.html" rel="noopener ugc nofollow" target="_blank">这个</a>。您的应用程序应该在两个模拟器上启动并运行，您的屏幕应该如下所示:</p><figure class="jq jr js jt fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="fe ff lb"><img src="../Images/e09f2c666738dac6c4e1f5201e2d9db3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYR1wUBxsxmw3goPsgFDTQ.png"/></div></div></figure><p id="3e0d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">打开<code class="eh lc ld le kq b">index.ios.js</code>和<code class="eh lc ld le kq b">index.android.js</code>。你会注意到它们有相同的代码。我们要摆脱这一切，从头开始。让我们在项目的根目录下创建一个名为<code class="eh lc ld le kq b">app</code>的目录。然后用下面的代码创建一个文件<code class="eh lc ld le kq b">app/App.js</code>:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div></figure><p id="382f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，我们可以删除<code class="eh lc ld le kq b">index.ios.js</code>和<code class="eh lc ld le kq b">index.android.js</code>中的所有代码，并简单地在它们中呈现组件<code class="eh lc ld le kq b">App</code>:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div></figure><p id="7af3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您重新加载模拟器(iOS的Cmd+R，Android的Fn+F2)，您现在应该会看到一个黑色的屏幕，上面有一些白色的文本。您还可以在模拟器中设置实时重载，以便在每次进行更改后保存文件时自动重载Javascript。</p><p id="330c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果我们回头再看一下UI，我们可以看到它由5个主要部分组成:</p><figure class="jq jr js jt fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="fe ff lh"><img src="../Images/298f134ec8d170590f8e1c776eaa6545.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_A_oT7gT1AgvePDhTBlVlw.png"/></div></div></figure><p id="77f9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将为每个部分创建一个组件，从标题开始，它实际上只是一个标题和两个按钮。我们将使用<a class="ae jp" href="https://facebook.github.io/react-native/docs/touchableopacity.html#content" rel="noopener ugc nofollow" target="_blank"> TouchableOpacity </a>来渲染按钮。在项目的根目录下创建一个目录“img”来存储图标和图像。你可以从谷歌的<a class="ae jp" href="https://design.google.com/icons/" rel="noopener ugc nofollow" target="_blank">材质图标</a>集合中获得标题图标。下载“键盘向下箭头”和“音乐排队”图标，并将文件从图标集的“ios”目录复制到项目的“img”目录。你可以在这里了解更多关于渲染图像和图标的信息<a class="ae jp" href="https://facebook.github.io/react-native/docs/images.html#content" rel="noopener ugc nofollow" target="_blank">。下面是Header的代码:</a></p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div><figcaption class="ki kj fg fe ff kk kl bd b be z ek">Link to <a class="ae jp" href="https://gist.github.com/aakashns/6aadc5e8d2b01b660bedeb7187bdac29" rel="noopener ugc nofollow" target="_blank">full code</a></figcaption></figure><p id="5cb7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了简洁起见，我省略了导入和样式。按照要点下面的描述中的链接查看完整代码。您可以将这段代码放在<code class="eh lc ld le kq b">app/Header.js</code>中，然后导入并使用<code class="eh lc ld le kq b">app/App.js</code>中的Header组件:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div></figure><p id="145f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，我们有一个非常简单的组件来显示专辑封面:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div><figcaption class="ki kj fg fe ff kk kl bd b be z ek">Here is the <a class="ae jp" href="https://gist.github.com/aakashns/fcbaad68c605ff2fd6364cfcc89372ca" rel="noopener ugc nofollow" target="_blank">full code</a>.</figcaption></figure><p id="9e19" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，我们有曲目标题和艺术家:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div><figcaption class="ki kj fg fe ff kk kl bd b be z ek">Here is the <a class="ae jp" href="https://gist.github.com/aakashns/ac09a78c4f72619c81793509279c752d" rel="noopener ugc nofollow" target="_blank">full code</a>.</figcaption></figure><p id="a579" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于搜索栏，我们将使用react-native-slider，它有更好的跨平台样式选项。</p><pre class="jq jr js jt fq kp kq kr ks aw kt dt"><span id="09e3" class="ku kv hu kq b fv kw kx l ky kz">$ npm install --save react-native-slider</span></pre><p id="870d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后，我们可以实现搜索栏:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div><figcaption class="ki kj fg fe ff kk kl bd b be z ek">Here is the <a class="ae jp" href="https://gist.github.com/aakashns/35cab39237cf958cc735bd423537f62b" rel="noopener ugc nofollow" target="_blank">full code</a></figcaption></figure><p id="c86f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们也为控件添加一个组件:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div><figcaption class="ki kj fg fe ff kk kl bd b be z ek">Here is the <a class="ae jp" href="https://gist.github.com/aakashns/3c7ffb64be5ab24d7e15fcf4a539ea36" rel="noopener ugc nofollow" target="_blank">full code</a>.</figcaption></figure><p id="5bc7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，我们可以将所有这些无状态组件放在App.js中，以检查UI并对其进行测试:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div></figure><p id="5be6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是一个对比，左边是Spotify的截图，右边是我们的应用:</p><div class="jq jr js jt fq ab cb"><figure class="ju jv li jx jy jz ka paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/5a42fce81ba4fa2ced3689ccfd1bd5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*SKs6OUyKtcRBs8w_6p4u1g.jpeg"/></div></figure><figure class="ju jv lj jx jy jz ka paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/638a41946242a6d7f037e66828f56b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/1*UIh7o0ZHB3OoxKXV9otOeg.gif"/></div></figure><figure class="ju jv lk jx jy jz ka paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/a6a36a10003ac4ee39b90f6dc68da1cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*aT75qaNTCDojDWKiPpIJxg.png"/></div></figure></div><p id="9994" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不算太坏，嗯？现在为了实际播放音频，我们将使用react-native-video。下面是它的使用方法:</p><pre class="jq jr js jt fq kp kq kr ks aw kt dt"><span id="0dfa" class="ku kv hu kq b fv kw kx l ky kz">$ npm install react-native-video — save<br/>$ npm install -g rnpm<br/>$ rnpm link react-native-video<br/>$ react-native run-ios<br/>$ react-native run-android</span></pre><p id="aa20" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在让我们在名为Player的组件中连接播放和暂停按钮:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div><figcaption class="ki kj fg fe ff kk kl bd b be z ek">Full code <a class="ae jp" href="https://gist.github.com/aakashns/1e991c96e46ae4fa61970c670b5a4a2b" rel="noopener ugc nofollow" target="_blank">is here</a></figcaption></figure><p id="2485" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们可以通过定义几首曲目在应用程序中使用它:</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="lf lg l"/></div></figure><p id="61bb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">只要再多做一点工作，我们就可以把所有的按钮连接起来。经过这一切，我们将到达</p><figure class="jq jr js jt fq jv"><div class="bz el l di"><div class="ll lg l"/></div></figure><p id="185c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就是这样！你可以在这里找到这篇博文的完整代码:</p><div class="lm ln fm fo lo lp"><a href="https://github.com/aakashns/reactmusic" rel="noopener  ugc nofollow" target="_blank"><div class="lq ab ej"><div class="lr ab ls cl cj lt"><h2 class="bd hv fv z el lu eo ep lv er et ht dt translated">aakashns/ReactMusic</h2><div class="lw l"><h3 class="bd b fv z el lu eo ep lv er et ek translated">ReactMusic -使用React Native制作的类似Spotify的音乐播放器界面</h3></div><div class="lx l"><p class="bd b gc z el lu eo ep lv er et ek translated">github.com</p></div></div><div class="ly l"><div class="lz l ma mb mc ly md kf lp"/></div></div></a></div></div></div>    
</body>
</html>