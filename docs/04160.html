<html>
<head>
<title>Effective End 2 End Testing in JavaScript with CodeceptJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CodeceptJS在JavaScript中进行有效的2端测试</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/effective-end-2-end-testing-in-javascript-with-codeceptjs-37c8d7d6a928?source=collection_archive---------6-----------------------#2018-05-16">https://medium.com/hackernoon/effective-end-2-end-testing-in-javascript-with-codeceptjs-37c8d7d6a928?source=collection_archive---------6-----------------------#2018-05-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/caad447a2131d8841e596221bac83101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_OZPYJAdq4IuOXmG5dGC2A.png"/></div></div></figure><p id="a8da" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现代<a class="ae ka" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> JavaScript </a>中有多种工具专注于端到端测试。然而，当你需要选择一种工具时，你可以花一周的时间来评估不同工具的利弊。你应该考虑它们的特性、语法、可维护性，最后，你仍然怀疑你是否做了正确的选择。选择一个库会使您的测试绑定到它的实现，因为JS中所有的end 2 end测试工具都有自己的语法。</p><p id="80c7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">比方说，你想用Selenium运行测试，然后你发现它们运行得太慢，你刚刚了解到Google Chrome有一个新工具Puppeteer，它允许更快地进行测试。如果您决定迁移您的测试，您将需要重写它们。多痛苦啊！</p><p id="c64d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这让我们想到了CodeceptJS的第一个关键思想。<strong class="je hv">你的测试不应该绑定到你的执行引擎上。无论你选择硒或木偶戏你的测试应该看起来几乎一样。</strong>但是等一下……什么是<a class="ae ka" href="https://codecept.io" rel="noopener ugc nofollow" target="_blank">代码概念</a>？</p><h1 id="71be" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">CodeceptJS简介</h1><p id="ac9f" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">你猜对了！CodeceptJS是一个测试框架。但与其他JavaScript测试工具不同，它使用最流行的JS库来驱动您的浏览器，并在其上添加高级API。这就是为什么为webdriverio编写的测试可以在量角器或木偶师中执行。</p><p id="15fa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你感觉到一个引擎的局限性，你可以很容易地切换到另一个。而第二个关键思想，高级API呢？</p><p id="769d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们展示代码:</p><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="li lj l"/></div></figure><p id="d59c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如您所见，<strong class="je hv">测试非常容易阅读。甚至非技术人员也能看懂</strong>。</p><p id="110f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">例如，当你需要填写一个字段时，你可以指定该字段的名称、占位符或标签，CodeceptJS会帮你找到。不需要脆弱而冗长的CSS或XPath定位器，如果你的HTML设计正确，你可以通过语义值匹配元素:</p><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="li lj l"/></div></figure><p id="de88" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您是经验丰富的JavaScript开发人员，您会注意到这段代码中的一些不寻常之处。测试场景中没有连锁调用。所有的动作都是一个一个写成一个线性的场景。</p><p id="22d3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">真的，没有承诺，没有等待？它是如何工作的？</p><h1 id="56f0" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">不-等待？</h1><p id="e75b" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">问题不在于让事情工作，问题在于编写干净的可维护的测试。JavaScript是一种非常富于表现力的语言，然而，用几十个<code class="eh lk ll lm ln b">then</code>或<code class="eh lk ll lm ln b">await</code>调用来维护代码库并不是一项简单的任务。或者大脑专注于处理承诺，而不是测试场景本身。这就是CodeceptJS帮助我们减少视觉噪音的原因。由于测试在大多数情况下是线性的，我们不需要知道承诺，现代的<a class="ae ka" href="https://hackernoon.com/tagged/software" rel="noopener ugc nofollow" target="_blank">软件</a>足够智能，可以自己处理所有的承诺。</p><p id="8bc5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">所以承诺由CodeceptJS处理，为你提供同步风格体验</strong>。然而，当您需要中断承诺链并从浏览器上下文中获取一些值时，您仍然可以使用<code class="eh lk ll lm ln b">async/await</code>:</p><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="li lj l"/></div></figure><p id="d48c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是CodeceptJS测试中需要异步函数的唯一原因。你应该在乎承诺的唯一事实是。</p><h1 id="a7d7" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">编写测试</h1><p id="998b" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">首先，我们需要<a class="ae ka" href="https://codecept.io/quickstart/" rel="noopener ugc nofollow" target="_blank">安装CodeceptJS </a>。要开始测试，我们需要选择引擎(WebDriverIO，量角器，木偶师，噩梦),并指定所有测试的基本URL。让我们在这里测试一下每个开发者都非常熟悉的东西:<a class="ae ka" href="https://github.com" rel="noopener ugc nofollow" target="_blank">https://github.com</a>。</p><p id="b2a7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对“github.com”的第一次测试可以从两行开始:</p><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="li lj l"/></div></figure><p id="bc51" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh lk ll lm ln b">I.amOnPage(‘/’); </code> —在基础url打开网站(<code class="eh lk ll lm ln b">`<a class="ae ka" href="https://github.com`+`/`" rel="noopener ugc nofollow" target="_blank">https://github.com`+`/`</a></code> ) <br/> <code class="eh lk ll lm ln b">pause()</code> —中断执行并切换到交互式shell模式</p><h1 id="0d89" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">交互式外壳</h1><p id="b612" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">在这种模式下，您可以并行使用浏览器，并通过简单的命令对其进行控制。键入“click”并选择一个元素，以查看是否可以通过这种方式定位元素，并且可以实际单击该元素。如果命令通过—将其添加到您的测试中。如果没有，请使用不同的定位器重试。</p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lo"><img src="../Images/c1bc05b0459a6386bdd4d56232c3fa52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GstZT1nTWMGbaBc7pt48bA.png"/></div></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">Interactive shell in action</figcaption></figure><p id="5ef8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因此，在交互式Shell模式下工作时，您可以写下一个完整的测试。</p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lt"><img src="../Images/915ff02993ee2cf98f34f0f86e29476e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwu8R-RQdMU4IRu4lrMkBQ.png"/></div></div></figure><p id="3600" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">同样在调试期间，您可以在每一行中放一个<code class="eh lk ll lm ln b">pause()</code>并切换到交互式shell。这个特性甚至在无头模式下也能工作。使用交互式shell比用断点调试应用程序更强大。</p><h1 id="6fd7" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">场景驱动测试</h1><p id="645e" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">测试被设计成由一个角色，即与系统交互的用户讲述的场景。当使用“codecept run — steps”命令执行此类测试时，您将看到实际的分步输出，以及某个步骤失败时的失败</p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lu"><img src="../Images/eeda8dbd2788873370a9de22305a686e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KY7YLLFQIgyRd-7Epa3bAg.png"/></div></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">Step-by-step output when running tests</figcaption></figure><p id="0e58" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在报告中，您将始终看到哪个步骤失败了，作为对每个失败测试的奖励，最后一页的屏幕截图将被获取，以便您可以轻松地查看哪里出错并修复它。</p><h1 id="7170" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">更多测试！</h1><p id="4e0f" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">如您所见，CodeceptJS非常容易上手。此外，CodeceptJS是一个成熟的框架，您可以继续使用它。它提供了对页面对象的原生支持，它拥有为您的测试管理数据的工具，支持在多种浏览器中进行测试(多会话测试)，并且由于高级API，您甚至可以用其他语言编写测试！</p><p id="e29e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">不，那应该是JavaScript。但是你可以用除了英语之外的其他语言编写测试！</p><p id="a4a5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">来点葡萄牙语测试怎么样？</p><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="li lj l"/></div></figure><p id="54d6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">也支持其他翻译。</p><p id="ce40" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">CodeceptJS还可以用Appium执行移动测试，并行运行测试，还有……嗯，这远远超出了入门帖子。所以你应该自己去发现。</p><p id="796f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你从来不喜欢端到端测试——试试<a class="ae ka" href="http://codecept.io" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">CodeceptJS</strong></a><strong class="je hv">这让测试变得有趣而有效。</strong></p><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="lv lj l"/></div></figure></div></div>    
</body>
</html>