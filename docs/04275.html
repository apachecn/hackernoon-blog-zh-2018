<html>
<head>
<title>Consistent modelling of Serverless long-running background tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无服务器长期运行后台任务的一致建模</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/consistent-modelling-of-serverless-long-running-background-tasks-2f686c872f8c?source=collection_archive---------1-----------------------#2018-05-20">https://medium.com/hackernoon/consistent-modelling-of-serverless-long-running-background-tasks-2f686c872f8c?source=collection_archive---------1-----------------------#2018-05-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><h1 id="8d94" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">预热</h1><p id="9b72" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在上一篇文章中，我提出了一种新的方法来实现<a class="ae kn" href="https://hackernoon.com/tagged/serverless" rel="noopener ugc nofollow" target="_blank">无服务器</a>架构规范。在这篇文章中，我认为当前的建模实践使用了太有限的词汇，并且产生了没有一致语义的工件:</p><div class="ko kp fm fo kq kr"><a rel="noopener follow" target="_blank" href="/@asher.sterkin/documenting-serverless-architectures-69bf63fc67b0"><div class="ks ab ej"><div class="kt ab ku cl cj kv"><h2 class="bd hv fv z el kw eo ep kx er et ht dt translated">无服务器架构语言</h2><div class="ky l"><h3 class="bd b fv z el kw eo ep kx er et ek translated">我们能做得更好吗？</h3></div><div class="kz l"><p class="bd b gc z el kw eo ep kx er et ek translated">medium.com</p></div></div><div class="la l"><div class="lb l lc ld le la lf lg kr"/></div></div></a></div><p id="1a63" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">作为运行样本，我选择了MakirOto应用程序，它由IL <a class="ae kn" href="https://hackernoon.com/tagged/aws" rel="noopener ugc nofollow" target="_blank"> AWS </a>解决方案架构师团队在最近的<a class="ae kn" href="https://youtu.be/OAo1qwXMqug?list=PLhr1KZpdzukcpd__tGf2QNsnjyachcXEI" rel="noopener ugc nofollow" target="_blank"> AWS Tel Aviv Summit </a>上展示:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div class="ab fr cl lr"><img src="../Images/b8f7cbb7fa04f8a67ca5600babb866d5.png" data-original-src="https://miro.medium.com/v2/0*VKJmL_tWMi3n-Dv3."/></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">MakirOto Application</figcaption></figure><p id="c099" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">由于对MakirOto前端组件应用了新的建模方法，因此产生了以下高级流程模型:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff lx"><img src="../Images/d5c290deac85535aa565d6e4fc79e931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jLAEIGzjXkW2fRRZ0Dl49A.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">MakirOto Process Model so far</figcaption></figure><p id="7135" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">在此图中:</p><ul class=""><li id="daa3" class="mc md hu jr b js lh jw li ka me ke mf ki mg km mh mi mj mk dt translated">虚线矩形代表服务，实现为<a class="ae kn" href="https://hackernoon.com/tagged/aws" rel="noopener ugc nofollow" target="_blank"> AWS </a>云形成栈</li><li id="5745" class="mc md hu jr b js ml jw mm ka mn ke mo ki mp km mh mi mj mk dt translated">箭头表示不同堆栈的计算和资源之间的可见性和访问权限</li></ul><p id="e7cc" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">第一篇文章是关于在线服务建模的。在这篇文章中，我将仔细研究长期运行的后台进程的一致性建模。</p><p id="6c96" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">为此，我将使用另一个MakirOto组件——数据收集器。该组件负责抓取社交网络，以获取关于用户联系和兴趣的重要信息。</p><h1 id="372a" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">MakirOto数据收集器:起点</h1><p id="f16a" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">这是在<a class="ae kn" href="https://youtu.be/E5Tc1uGzEEM?list=PLhr1KZpdzukcpd__tGf2QNsnjyachcXEI" rel="noopener ugc nofollow" target="_blank">会议</a>期间展示的数据收集器架构:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff mq"><img src="../Images/c87b4dc285a23f7931aa4b450b1b2f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vU3zR-qHfWxNLcTel-SZ0A.jpeg"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">MakirOto Data Collector</figcaption></figure><p id="6ad8" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">在此图中，一些图标代表计算和资源:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div class="fe ff mr"><img src="../Images/626e5e296f3be2f2c9a6a07e3b95a438.png" data-original-src="https://miro.medium.com/v2/resize:fit:274/format:webp/1*AT3np5vx2BDMhYHI-bKArg.png"/></div></figure><p id="2a15" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">，而其他仍然代表AWS服务:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div class="fe ff ms"><img src="../Images/c22caf6deaee2df761930e1651c8505c.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*mWagxUn2t2VL-sZiXMPj3w.png"/></div></figure><p id="d5bc" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">连接线没有任何明确的语义。</p><p id="1313" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">让我们看看我们是否可以不花太多力气来改进它:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff mq"><img src="../Images/ef5bf101e31e3e315d0e25cb68979b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hRdX3OnEeMew9ZQ5QVZrTg.jpeg"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">MakirOto Data Collector Process Model</figcaption></figure><p id="bda1" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">这确实是一种进步。在这里，每个图标代表</p><ul class=""><li id="a1c4" class="mc md hu jr b js lh jw li ka me ke mf ki mg km mh mi mj mk dt translated">计算过程实例:AWS Lambda、阶跃函数、Fargate服务)</li><li id="e7e4" class="mc md hu jr b js ml jw mm ka mn ke mo ki mp km mh mi mj mk dt translated">或者是完全管理的资源:S3桶、SQS队列</li></ul><p id="7a18" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">每个箭头表示可见性和访问权限(不是控制或数据流！).</p><p id="5505" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">尽管这个图现在在语义上是一致的，但是仍然很难推理。它有太多的盒子，太多的联系，太多不相关的概念组合在一页上。现在还很难说这个组件到底是做什么的，以及它与系统的其他部分有什么关系。</p><p id="81b6" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">为了取得进展，我们需要将这个图分成更小的块。先说爬虫。</p><h1 id="b192" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">马基罗托履带车</h1><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff mt"><img src="../Images/9967a2278acf383c6399c9f97125964e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WoRzTl45XW7JoLLxFKlVLw.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">MakirOto Crawler Process Model</figcaption></figure><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff mq"><img src="../Images/7f510e43b78a07d6fb9ad1a5bcb16544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zTr_q0u8tJmwPU_incDIJQ.jpeg"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">MakirOto Crawler Typical Event Sequence</figcaption></figure><p id="2133" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">有了这两张图，我们对正在发生的事情有了更好的理解，并可以开始评估替代方案。</p><p id="ba51" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">为无服务器架构引入一致的建模语言的全部目的是支持对多个清晰表达的备选方案进行系统评估。</p><p id="f9f7" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">理想情况下，每个模型元素都必须经过仔细检查、论证，并与可能的替代方案进行比较。虽然由于时间的限制，这并不总是可能的，但是架构语言必须完全支持这样的过程。</p><p id="b0c0" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">让我们从工人Fargate服务开始。</p><h1 id="2dc8" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">AWS Fargate —一等无服务器公民</h1><p id="3eb5" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">虽然AWS还没有正式承认，但是AWS <a class="ae kn" href="https://hackernoon.com/tagged/swrverless" rel="noopener ugc nofollow" target="_blank">无服务器</a>从业者越来越一致认为AWS Fargate服务是无服务器领域的一等公民。</p><p id="c3d5" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">AWS Lambda和AWS Fargate构成了相同“成本与控制权衡”的两种备选解决方案。作为AWS Lambda，AWS Fargate模型没有打破不直接管理服务器的主要约束。</p><p id="68f1" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">下表总结了两个选项之间的差异:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff mu"><img src="../Images/5b069fb926c24a48c4c6aeccf420e410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aICQSmjYCvkcRcUqr607-A.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">AWS Lambda vs AWS Fargate</figcaption></figure><p id="013a" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">您可能会在这里找到一些关于AWS Lambda性能的有趣分析:</p><div class="ko kp fm fo kq kr"><a href="https://read.acloud.guru/comparing-aws-lambda-performance-when-using-node-js-java-c-or-python-281bef2c740f" rel="noopener  ugc nofollow" target="_blank"><div class="ks ab ej"><div class="kt ab ku cl cj kv"><h2 class="bd hv fv z el kw eo ep kx er et ht dt translated">比较使用Node.js、Java、C#或Python时的AWS Lambda性能</h2><div class="ky l"><h3 class="bd b fv z el kw eo ep kx er et ek translated">当使用AWS Lambda支持的不同编程语言时，一个函数的执行有多大不同？</h3></div><div class="kz l"><p class="bd b gc z el kw eo ep kx er et ek translated">read.acloud.guru</p></div></div><div class="la l"><div class="mv l lc ld le la lf lg kr"/></div></div></a></div><p id="84ba" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">还有这里:</p><div class="ko kp fm fo kq kr"><a href="https://read.acloud.guru/comparing-aws-lambda-performance-of-node-js-python-java-c-and-go-29c1163c2581" rel="noopener  ugc nofollow" target="_blank"><div class="ks ab ej"><div class="kt ab ku cl cj kv"><h2 class="bd hv fv z el kw eo ep kx er et ht dt translated">Node.js、Python、Java、C#和Go的AWS Lambda性能比较</h2><div class="ky l"><h3 class="bd b fv z el kw eo ep kx er et ek translated">AWS Lambda支持的所有五种编程语言的最新运行时性能基准</h3></div><div class="kz l"><p class="bd b gc z el kw eo ep kx er et ek translated">read.acloud.guru</p></div></div><div class="la l"><div class="mw l lc ld le la lf lg kr"/></div></div></a></div><p id="c6ea" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">您可能会在这里找到一份关于迁移到AWS Fargate的有趣体验报告:</p><div class="ko kp fm fo kq kr"><a rel="noopener follow" target="_blank" href="/@shimont/migrating-to-aws-ecs-fargate-in-production-5bf9cb4c2b44"><div class="ks ab ej"><div class="kt ab ku cl cj kv"><h2 class="bd hv fv z el kw eo ep kx er et ht dt translated">在生产环境中迁移到AWS ECS Fargate🚀</h2><div class="ky l"><h3 class="bd b fv z el kw eo ep kx er et ek translated">继我在2018年特拉维夫AWS峰会上的讲话之后，我将分享我们的端到端生产迁移之旅…</h3></div><div class="kz l"><p class="bd b gc z el kw eo ep kx er et ek translated">medium.com</p></div></div><div class="la l"><div class="mx l lc ld le la lf lg kr"/></div></div></a></div><p id="3740" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">对于员工来说，选择Fargate而不是Lambda的主要原因是，从社交网络下载大量内容，尤其是照片，可能需要5分钟以上。此外，有时由于外部API的限制，这个过程不能中断。</p><p id="064b" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">然而，请注意，当用户群增长到一定规模以上时，爬行过程将一直工作——为现有用户刷新社交网络数据，同时为新用户进行初始下载。在稳定状态下，几乎不会有空闲来支付。</p><p id="1831" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">Crawler任务队列也是合理的——例如，当注册了太多新用户时，爬行请求可能会突发。这个队列是平滑这些突发的好方法。</p><p id="b107" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">然而，第二个Fargate服务Poller提出了一些问题。它的唯一目的是定期检查AWS步骤功能是否有挂起的活动任务，并向Crawler任务队列发送相应的爬行任务规范。那不会一直发生，我们要为闲置买单。</p><p id="bba7" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">什么，有别的选择吗？非常简单——用Lambda函数将爬行任务请求发送到队列:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff my"><img src="../Images/cbb84446141d35240a87d728ca05f01a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rCRSamvNB1r91Nd78uyEow.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">Invoking a Lambda Function to Submit a Crawler Task</figcaption></figure><p id="6317" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">请注意命名中一些微妙而重要的变化。就我个人而言，我总是更喜欢特定领域的具体名称，而不是通用但信息量较少的名称，如Poler、Worker、Manager、Dispatcher、Init、Update等等。</p><p id="cc95" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">在每个爬行序列结束时，Crawler Fargate服务直接更新数据收集器的挂起活动状态。真的有道理吗？为什么爬虫微服务需要知道是由一个Step函数编排的？这似乎是不必要的耦合。有什么替代方案吗？一种可能是使用AWS SNS主题来表示爬行任务已经结束:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff mq"><img src="../Images/78b725d2b20648871af5b49fb0cf1c73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4O2HJs66qadZcoFcukKGvQ.jpeg"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">Introducing Crawler Task Status Notification</figcaption></figure><p id="d46f" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">一个很好的副作用是，我们现在可以为其他目的跟踪爬行进度，比如监控。</p><p id="357e" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">AWS SNS并不是唯一一种可能的通知机制。您将在此找到更详细的分析:</p><div class="ko kp fm fo kq kr"><a href="https://medium.freecodecamp.org/how-to-choose-the-best-event-source-for-pub-sub-messaging-with-aws-lambda-31ca4db9be69" rel="noopener  ugc nofollow" target="_blank"><div class="ks ab ej"><div class="kt ab ku cl cj kv"><h2 class="bd hv fv z el kw eo ep kx er et ht dt translated">如何使用AWS Lambda为发布/订阅消息选择最佳事件源</h2><div class="ky l"><h3 class="bd b fv z el kw eo ep kx er et ek translated">AWS为实现消息传递模式提供了丰富的选项，如发布/订阅(通常简称为…</h3></div><div class="kz l"><p class="bd b gc z el kw eo ep kx er et ek translated">medium.freecodecamp.org</p></div></div><div class="la l"><div class="mz l lc ld le la lf lg kr"/></div></div></a></div><p id="1296" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">目前的设计还有另一个微妙的问题。为了理解它是什么，我们需要看一下爬虫服务实现模型:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff na"><img src="../Images/7c9af8065d49d91ff5e185f1f8795375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RL73RYi7HJMG8UK3pKVVPg.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">Crawler Service Implementation Model</figcaption></figure><p id="c710" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">这违反了<a class="ae kn" href="https://en.wikipedia.org/wiki/Open/closed_principle" rel="noopener ugc nofollow" target="_blank">开-关原则</a>，该原则规定系统应该<strong class="jr hv">支持添加新功能而不修改现有功能</strong>。</p><p id="db2d" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">从上面的实现模型可以看出，每次我们决定:</p><ul class=""><li id="a79a" class="mc md hu jr b js lh jw li ka me ke mf ki mg km mh mi mj mk dt translated">支持新的社交网络</li><li id="3fa6" class="mc md hu jr b js ml jw mm ka mn ke mo ki mp km mh mi mj mk dt translated">从现有数据中提取更多数据</li><li id="a7df" class="mc md hu jr b js ml jw mm ka mn ke mo ki mp km mh mi mj mk dt translated">升级到某个API的新版本</li></ul><p id="b5ab" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">引入所有这些变化将危及整个服务的运行稳定性。</p><p id="62d2" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">一种替代方法是将每个社交网络的爬行过程封装到一个单独的服务中:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff nb"><img src="../Images/45d94e1e2604cab1c5fab7de5ee7492a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bHInG-tgxrIhaW_31J3sw.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">Individual Crawler Service per Social Network</figcaption></figure><p id="48ef" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">这张图表看起来有点复杂。让我们将其压缩为一个高层次的概述:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff nc"><img src="../Images/e369674ee1b7dd3f10042e8f450da143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r6mYrdDdP2PNhpImlsf-Mw.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">MakirOto Crawler High-Level Structure</figcaption></figure><p id="1d1f" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">现在，单独的社交网络爬虫可以被单独记录。例如:</p><figure class="lm ln lo lp fq lq fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff nd"><img src="../Images/400cdf8b59969f58d615b5d8ce91fb98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a8MWaztmpxIr7U7fvC08ZQ.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek">MakirOto Facebook Crawler</figcaption></figure><p id="27e2" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">我们在指定一个在AWS Fargate服务之上实现的无服务器长期运行后台任务的架构方面取得了良好的进展。</p><p id="42eb" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">为了完成这幅图，我们还需要查看长期运行的工作流流程，有时称为Saga，使用AWS Step函数实现。在MakirOto应用程序的情况下，我们需要更仔细地了解数据收集器服务的内部细节。我将在下一篇文章中讨论这个话题。</p><h1 id="306b" class="ir is hu bd it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo dt translated">结束语</h1><p id="b09c" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">架构过程主要是评估多种选择，并以清晰明确的方式交流决策。如果没有多种选择，我们就有从工程滑向意识形态的风险，这对企业不利。</p><p id="df16" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">为了能够评估多个备选方案并传达最终决策，我们需要精确地指定它们。为此，我们需要一种合适的语言。</p><p id="8216" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">我们目前使用的是基于非常有限的词汇和不一致的语义。出于这个原因，我开始在P. Kruchten的开创性工作的基础上寻找另一种选择:</p><figure class="lm ln lo lp fq lq"><div class="bz el l di"><div class="ne nf l"/></div></figure><p id="cb3b" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">通过编写语法书来发展一门新语言是一项无望的任务。语言是生物。要发展一种语言，你必须说它，写散文和诗歌。如果有必要的话，开些糟糕的玩笑。</p><p id="6008" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">在无服务器架构的情况下，这意味着分析案例研究并使用这种新语言复述他们的故事。越多越好。</p><p id="d236" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">这是我在MakirOto应用程序中开始做的事情。IL AWS解决方案架构师团队非常出色地挑选了一个非常好的示例应用程序。这个应用程序将继续为另外两个帖子提供很好的素材。在那之后，我可能会开始寻找其他地方，包括分析贴有“无服务器”标签的中型帖子。</p><p id="f428" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">无服务器架构语言的当前版本(我该叫它SAL吗？)远非完美。它肯定需要经历多次修改。我个人认为只有通过社区的共同努力才能成功。过早的固定或，但愿不会，商业化将是一个致命的打击。</p><p id="b2d4" class="pw-post-body-paragraph jp jq hu jr b js lh ju jv jw li jy jz ka lj kc kd ke lk kg kh ki ll kk kl km hn dt translated">如果你有一个案例研究，你想尝试用这种新兴的语言复述，给我写信。否则，请继续关注下一篇文章。无论如何，我都想听听你的想法。</p><figure class="lm ln lo lp fq lq"><div class="bz el l di"><div class="ng nf l"/></div></figure></div></div>    
</body>
</html>