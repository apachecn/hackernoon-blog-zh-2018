<html>
<head>
<title>Creating a library of React components using Create React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Create React App创建React组件库</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/creating-a-library-of-react-components-using-create-react-app-without-ejecting-d182df690c6b?source=collection_archive---------1-----------------------#2018-05-21">https://medium.com/hackernoon/creating-a-library-of-react-components-using-create-react-app-without-ejecting-d182df690c6b?source=collection_archive---------1-----------------------#2018-05-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/c91aafd857125c8f7690d8fa84a93802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y35T8mhTSj992NIXwGwC6w.png"/></div></div></figure><p id="5d5b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">更新</strong>:您可以使用npm包<code class="eh ka kb kc kd b"><a class="ae ke" href="https://www.npmjs.com/package/create-component-lib" rel="noopener ugc nofollow" target="_blank">create-component-lib</a></code>来自动化这篇博文中描述的所有步骤。</p><div class="kf kg fm fo kh ki"><a href="https://www.npmjs.com/package/create-component-lib" rel="noopener  ugc nofollow" target="_blank"><div class="kj ab ej"><div class="kk ab kl cl cj km"><h2 class="bd hv fv z el kn eo ep ko er et ht dt translated">创建组件库</h2><div class="kp l"><h3 class="bd b fv z el kn eo ep ko er et ek translated">创建可以发布到npm的React组件库</h3></div><div class="kq l"><p class="bd b gc z el kn eo ep ko er et ek translated">www.npmjs.com</p></div></div><div class="kr l"><div class="ks l kt ku kv kr kw ja ki"/></div></div></a></div><p id="7dec" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Create React App 是创建和开发React应用程序的最佳工具。只需一点点工作，它还可以用来创建一个React组件库，可以发布到<code class="eh ka kb kc kd b">npm</code>并在其他React应用程序中使用。你需要做的是:</p><p id="ab94" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">1.使用<code class="eh ka kb kc kd b">create-react-app</code>创建一个新项目:</p><pre class="kx ky kz la fq lb kd lc ld aw le dt"><span id="b99d" class="lf lg hu kd b fv lh li l lj lk">create-react-app simple-component-library</span></pre><p id="57d8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">2.删除<code class="eh ka kb kc kd b">src/</code>中的所有文件，用一些启动代码创建一个新的<code class="eh ka kb kc kd b">index.js</code>文件:</p><figure class="kx ky kz la fq iv"><div class="bz el l di"><div class="ll lm l"/></div><figcaption class="ln lo fg fe ff lp lq bd b be z ek">src/index.js</figcaption></figure><p id="fcef" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">3.创建一个新文件夹<code class="eh ka kb kc kd b">src/lib</code>，并将React组件放入其中。<code class="eh ka kb kc kd b">src/lib</code>将作为发布到<code class="eh ka kb kc kd b">npm</code>的模块的根文件夹。下面是一个示例组件的代码:</p><figure class="kx ky kz la fq iv"><div class="bz el l di"><div class="ll lm l"/></div><figcaption class="ln lo fg fe ff lp lq bd b be z ek">src/lib/TextInput.js</figcaption></figure><p id="a0c4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">样式可以内联完成，也可以在单独的CSS文件中完成:</p><figure class="kx ky kz la fq iv"><div class="bz el l di"><div class="ll lm l"/></div><figcaption class="ln lo fg fe ff lp lq bd b be z ek">src/lib/TextInput.css</figcaption></figure><p id="60da" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，为了便于导入，组件可以从<code class="eh ka kb kc kd b">src/lib</code>导出:</p><figure class="kx ky kz la fq iv"><div class="bz el l di"><div class="ll lm l"/></div><figcaption class="ln lo fg fe ff lp lq bd b be z ek">src/lib/index.js</figcaption></figure><p id="2688" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">可选地，你也可以<a class="ae ke" href="https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/template/README.md#running-tests" rel="noopener ugc nofollow" target="_blank">为<code class="eh ka kb kc kd b">src/lib</code>中的组件编写测试</a>:</p><figure class="kx ky kz la fq iv"><div class="bz el l di"><div class="ll lm l"/></div><figcaption class="ln lo fg fe ff lp lq bd b be z ek">src/lib/TextInput.test.js</figcaption></figure><p id="9a0c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">4.<em class="lr">(可选)</em>使用<code class="eh ka kb kc kd b">src/index.js</code>中的组件创建开发期间测试和调试的示例。任何放置在<code class="eh ka kb kc kd b">src/lib</code>之外的代码都不会发布到<code class="eh ka kb kc kd b">npm</code>。以下是<code class="eh ka kb kc kd b">TextInput</code>的用法示例:</p><figure class="kx ky kz la fq iv"><div class="bz el l di"><div class="ll lm l"/></div><figcaption class="ln lo fg fe ff lp lq bd b be z ek">src/index.js</figcaption></figure><p id="56b5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">运行<code class="eh ka kb kc kd b">npm start</code>并导航至<code class="eh ka kb kc kd b">http://localhost:3000</code>查看结果。</p><figure class="kx ky kz la fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ls"><img src="../Images/00091195364c7374a6d33a14ba2153d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hWDXWzgqZROc_A2VOVdDlQ.png"/></div></div><figcaption class="ln lo fg fe ff lp lq bd b be z ek">It works (duh!)</figcaption></figure><p id="4c01" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">提示:使用<code class="eh ka kb kc kd b"><a class="ae ke" href="https://github.com/FormidableLabs/react-live" rel="noopener ugc nofollow" target="_blank">react-live</a></code>创建一个可实时编辑的文档站点！</p><p id="58ea" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">5.使用命令<code class="eh ka kb kc kd b">npm i babel-cli --save-dev</code>安装<code class="eh ka kb kc kd b"><a class="ae ke" href="https://babeljs.io/docs/usage/cli/" rel="noopener ugc nofollow" target="_blank">babel-cli</a></code>,并在项目的根目录下创建一个文件<code class="eh ka kb kc kd b">.babelrc</code>,内容如下:</p><pre class="kx ky kz la fq lb kd lc ld aw le dt"><span id="13a4" class="lf lg hu kd b fv lh li l lj lk">{<br/>  "presets": [["react-app", { "absoluteRuntime": false }]]<br/>}</span></pre><p id="c856" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">6.用以下内容替换<code class="eh ka kb kc kd b">package.json</code>中的<code class="eh ka kb kc kd b">build</code>脚本:</p><pre class="kx ky kz la fq lb kd lc ld aw le dt"><span id="6742" class="lf lg hu kd b fv lh li l lj lk">"build": "rm -rf dist &amp;&amp; NODE_ENV=production babel src/lib --out-dir dist --copy-files --ignore __tests__,spec.js,test.js,__snapshots__"</span></pre><p id="5836" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">命令<code class="eh ka kb kc kd b">npm run build</code>现在将把<code class="eh ka kb kc kd b">src/lib</code>中的代码(忽略测试和快照)传输到文件夹<code class="eh ka kb kc kd b">dist</code>中。</p><p id="8d60" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">7.从<code class="eh ka kb kc kd b">package.json</code>上拆下管路<code class="eh ka kb kc kd b">"private": true</code>。同时从依赖关系中移除<code class="eh ka kb kc kd b">react-scripts</code>、<code class="eh ka kb kc kd b">react</code>和<code class="eh ka kb kc kd b">react-dom</code>，并将它们移动到<code class="eh ka kb kc kd b"><a class="ae ke" href="https://docs.npmjs.com/files/package.json#devdependencies" rel="noopener ugc nofollow" target="_blank">devDependencies</a></code>。此外，您还可以在<code class="eh ka kb kc kd b"><a class="ae ke" href="https://docs.npmjs.com/files/package.json#peerdependencies" rel="noopener ugc nofollow" target="_blank">peerDependencies</a></code>中添加<code class="eh ka kb kc kd b">react</code>和<code class="eh ka kb kc kd b">react-dom</code>。</p><p id="bf5d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">8.为了准备发布，将下列行添加到<code class="eh ka kb kc kd b">package.json</code>:</p><pre class="kx ky kz la fq lb kd lc ld aw le dt"><span id="c914" class="lf lg hu kd b fv lh li l lj lk">  "main": "dist/index.js",<br/>  "module": "dist/index.js",<br/>  "files": [ "dist", "README.md" ],<br/>  "repository": {<br/>    "type": "git",<br/>    "url": "URL_OF_YOUR_REPOSITORY"<br/>  }</span></pre><p id="d05a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">9.移除默认的<code class="eh ka kb kc kd b">README.md</code>文件，并创建一个包含库信息的新文件。</p><pre class="kx ky kz la fq lb kd lc ld aw le dt"><span id="8be7" class="lf lg hu kd b fv lh li l lj lk"># simple-component-library<br/>A library of React components created using `create-react-app`.</span><span id="df02" class="lf lg hu kd b fv lt li l lj lk">## Installation<br/>Run the following command:<br/>`npm install simple-component-library`</span></pre><p id="b12e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">10.<a class="ae ke" href="https://docs.npmjs.com/getting-started/publishing-npm-packages" rel="noopener ugc nofollow" target="_blank">发布到</a> <code class="eh ka kb kc kd b"><a class="ae ke" href="https://docs.npmjs.com/getting-started/publishing-npm-packages" rel="noopener ugc nofollow" target="_blank">npm</a></code>！</p><pre class="kx ky kz la fq lb kd lc ld aw le dt"><span id="bd87" class="lf lg hu kd b fv lh li l lj lk">npm run publish</span></pre><p id="5344" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就是这样！现在，您可以使用命令<code class="eh ka kb kc kd b">npm install simple-component-library</code>安装这个库，并在使用Create React App创建的任何项目中使用它。以下是本文的完整代码:</p><div class="kf kg fm fo kh ki"><a href="https://github.com/aakashns/simple-component-library" rel="noopener  ugc nofollow" target="_blank"><div class="kj ab ej"><div class="kk ab kl cl cj km"><h2 class="bd hv fv z el kn eo ep ko er et ht dt translated">aakashns/简单组件库</h2><div class="kp l"><h3 class="bd b fv z el kn eo ep ko er et ek translated">这个例子演示了使用Create React App创建React组件库</h3></div><div class="kq l"><p class="bd b gc z el kn eo ep ko er et ek translated">github.com</p></div></div><div class="kr l"><div class="lu l kt ku kv kr kw ja ki"/></div></div></a></div><p id="c639" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以克隆存储库，并以此为起点跳过一些步骤。希望有帮助！</p></div></div>    
</body>
</html>