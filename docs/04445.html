<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/implementing-firebaseauthstatelistener-using-shared-prefrences-in-flutter-b42e12f81eb2?source=collection_archive---------3-----------------------#2018-05-26">https://medium.com/hackernoon/implementing-firebaseauthstatelistener-using-shared-prefrences-in-flutter-b42e12f81eb2?source=collection_archive---------3-----------------------#2018-05-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><h2 id="c110" class="hs ht hu bd hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq dt translated">åœ¨Flutterä¸­ä½¿ç”¨å…±äº«é¦–é€‰é¡¹å®ç°FirebaseAuthStateListenerã€‚</h2><p id="7509" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb ie jc jd je ii jf jg jh im ji jj jk jl hn dt translated">ä½ å¥½ï¼ŒâœŒï¸ï¼Œ</p><p id="d6bc" class="pw-post-body-paragraph ir is hu it b iu jm iw ix iy jn ja jb ie jo jd je ii jp jg jh im jq jj jk jl hn dt translated">æˆ‘ä¸€ä¸ªæœˆå‰å¼€å§‹é¢¤æŠ–ã€‚æˆ‘åœ¨Flutterä¸­å¼€å‘äº†å‡ ä¸ªå°åº”ç”¨ï¼Œæ¯”å¦‚èŠå¤©åº”ç”¨<a class="ae jr" href="https://github.com/im-minion/Flutter-Chat-App" rel="noopener ugc nofollow" target="_blank">ã€</a><a class="ae jr" href="https://github.com/im-minion/Flutter-Blog-App-Firebase" rel="noopener ugc nofollow" target="_blank">åšå®¢åº”ç”¨</a>ç­‰ç­‰ã€‚æˆ‘å¯¹æåˆ°çš„ä¸¤ä¸ªåº”ç”¨ç¨‹åºéƒ½ä½¿ç”¨äº†<a class="ae jr" href="https://hackernoon.com/tagged/firebase" rel="noopener ugc nofollow" target="_blank"> Firebase </a>ã€‚æˆ‘åœ¨åˆ¶ä½œåšå®¢åº”ç”¨ç¨‹åºæ—¶æ„è¯†åˆ°çš„ä¸€ä»¶äº‹æ˜¯å…³äºfirebase auth state listenerã€‚åœ¨flutter+firebaseä¸­ï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°åƒåœ¨Android<a class="ae jr" href="https://hackernoon.com/tagged/android" rel="noopener ugc nofollow" target="_blank">ä¸­é‚£æ ·çš„firebaseèº«ä»½éªŒè¯çŠ¶æ€ç›‘å¬å™¨ã€‚(æˆæƒçŠ¶æ€ç›‘å¬å™¨æ£€æŸ¥å¹¶æŒç»­ç›‘æ§ç”¨æˆ·çš„å­˜åœ¨çŠ¶æ€ï¼Œå¹¶åˆ†åˆ«æ˜¾ç¤ºAndroidæ–¹é¢çš„å±å¹•æˆ–æ´»åŠ¨)</a></p><p id="6732" class="pw-post-body-paragraph ir is hu it b iu jm iw ix iy jn ja jb ie jo jd je ii jp jg jh im jq jj jk jl hn dt translated">å› æ­¤ï¼Œä¸ºäº†è·å¾—ç”¨æˆ·çš„å½“å‰çŠ¶æ€ï¼Œå¹¶åœ¨Flutterä¸­æ˜¾ç¤ºç›¸åº”çš„æ”¯æ¶æˆ–ææ–™åº”ç”¨ç¨‹åºæˆ–ä»»ä½•ç›¸åº”çš„ç»„ä»¶ï¼Œæˆ‘åœ¨Flutterä¸­ä½¿ç”¨äº†<a class="ae jr" href="https://pub.dartlang.org/packages/shared_preferences" rel="noopener ugc nofollow" target="_blank">â€œå…±äº«é¦–é€‰é¡¹â€</a>åº“</p><p id="28ed" class="pw-post-body-paragraph ir is hu it b iu jm iw ix iy jn ja jb ie jo jd je ii jp jg jh im jq jj jk jl hn dt translated">æˆ‘ç›®å‰å·²ç»ä½¿ç”¨äº†è°·æ­Œè®¤è¯ï¼Œä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ æƒ³è¦çš„è®¤è¯æ–¹æ³•ã€‚</p><p id="b08c" class="pw-post-body-paragraph ir is hu it b iu jm iw ix iy jn ja jb ie jo jd je ii jp jg jh im jq jj jk jl hn dt translated">åœ¨<a class="ae jr" href="https://github.com/im-minion/Flutter-Blog-App-Firebase" rel="noopener ugc nofollow" target="_blank"> Flutteråšå®¢åº”ç”¨</a>ä¸­ï¼Œæˆ‘å£°æ˜äº†ä¸¤ä¸ªè„šæ‰‹æ¶ï¼Œå³ã€‚loginScaffoldå’ŒhomeScaffoldã€‚å¹¶æ ¹æ®æˆæƒçŠ¶æ€å¯¹å®ƒä»¬è¿›è¡Œäº†æ›´æ”¹ã€‚<br/>å¦‚æœç”¨æˆ·å·²ç»ç™»å½•ï¼Œåˆ™æ˜¾ç¤ºä¸»é¡µæ–‡ä»¶å¤¹ï¼Œå¦åˆ™æ˜¾ç¤ºç™»å½•æ–‡ä»¶å¤¹ã€‚ä¹‹åï¼Œå¦‚æœç™»å½•æˆåŠŸï¼ŒloginScaffoldå°†è¢«homeScaffoldæ›¿æ¢ã€‚</p><p id="724c" class="pw-post-body-paragraph ir is hu it b iu jm iw ix iy jn ja jb ie jo jd je ii jp jg jh im jq jj jk jl hn dt translated">ä½¿ç”¨å…±äº«é¦–é€‰é¡¹ç›‘å¬èº«ä»½éªŒè¯çŠ¶æ€çš„æ­¥éª¤:</p><h2 id="b016" class="hs ht hu bd hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq dt translated">1.å°†åº“æ·»åŠ åˆ°pubspec.yamlå¹¶åœ¨HomePage.dartä¸­å¯¼å…¥</h2><pre class="js jt ju jv fq jw jx jy jz aw ka dt"><span id="0755" class="hs ht hu jx b fv kb kc l kd ke"><strong class="jx kf">dependencies:<br/>  flutter:<br/>    sdk: </strong>flutter</span><span id="f466" class="hs ht hu jx b fv kg kc l kd ke">  <strong class="jx kf">cupertino_icons: </strong>^0.1.0<br/>  <strong class="jx kf">shared_preferences: "^0.4.0"<br/>  .<br/>  .<br/>  .</strong></span></pre><p id="182b" class="pw-post-body-paragraph ir is hu it b iu jm iw ix iy jn ja jb ie jo jd je ii jp jg jh im jq jj jk jl hn dt translated">ç„¶åå¯¼å…¥åˆ°HomePage.dartä½œä¸º</p><pre class="js jt ju jv fq jw jx jy jz aw ka dt"><span id="9744" class="hs ht hu jx b fv kb kc l kd ke">import â€˜package:shared_preferences/shared_preferences.dartâ€™;</span></pre><h2 id="f6e4" class="hs ht hu bd hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq dt translated">2.åˆ›å»ºå…±äº«é¦–é€‰é¡¹çš„å®ä¾‹ï¼Œå¹¶æ£€æŸ¥å…¶ä¸­æ˜¯å¦å­˜åœ¨å€¼:</h2><p id="7579" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb ie jc jd je ii jf jg jh im ji jj jk jl hn dt translated">å¯¹äºä¸»å±å¹•ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªmaterialåº”ç”¨ç¨‹åºï¼Œå…¶â€œhome:â€å±æ€§å–å†³äºç”¨æˆ·çš„å½“å‰çŠ¶æ€ï¼Œè¿™æ„å‘³ç€å¦‚æœç”¨æˆ·ç™»å½•ï¼Œå®ƒå°†æ˜¾ç¤ºhomeScaffoldï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æ˜¾ç¤ºloginScaffoldã€‚<br/>å¦‚ä¸‹:(ä»£ç ä¸è¨€è‡ªæ˜:)</p><pre class="js jt ju jv fq jw jx jy jz aw ka dt"><span id="b4e9" class="hs ht hu jx b fv kb kc l kd ke"><strong class="jx kf">class </strong>HomePage <strong class="jx kf">extends </strong>StatefulWidget {<br/>  @override<br/>  HomePageState createState() =&gt; <strong class="jx kf">new </strong>HomePageState();<br/>}<br/><br/><strong class="jx kf">class </strong>HomePageState <strong class="jx kf">extends </strong>State&lt;HomePage&gt; {<br/>  bool <strong class="jx kf">loggedIn </strong>= <strong class="jx kf">false</strong>;  // this will check status</span><span id="025e" class="hs ht hu jx b fv kg kc l kd ke">Future&lt;Null&gt; _function() <strong class="jx kf">async </strong>{<br/>  <br/>    /**<br/>    This Function will be called every single time<br/>    when application is opened and it will check <br/>    if the value inside Shared Preference exist or not<br/>    **/</span><span id="1eef" class="hs ht hu jx b fv kg kc l kd ke">    SharedPreferences prefs;<br/>    prefs = <strong class="jx kf">await </strong>SharedPreferences.<em class="kh">getInstance</em>();<br/>    <strong class="jx kf">this</strong>.setState(() {<br/>      <strong class="jx kf">if </strong>(prefs.getString(<strong class="jx kf">"username"</strong>) != <strong class="jx kf">null</strong>) {<br/>        <strong class="jx kf">loggedIn </strong>= <strong class="jx kf">true</strong>;<br/>      } <strong class="jx kf">else </strong>{<br/>        <strong class="jx kf">loggedIn </strong>= <strong class="jx kf">false</strong>;<br/>      }<br/>    });<br/>  }  <br/>  . . . .</span><span id="7b89" class="hs ht hu jx b fv kg kc l kd ke">  Scaffold homeScaffold = /*define as required*/;<br/>  Scaffold loginScaffold = /*define as required*/;</span><span id="2100" class="hs ht hu jx b fv kg kc l kd ke">  @override<br/>  Widget build(BuildContext context) {<br/><strong class="jx kf">    return new </strong>MaterialApp(<br/>      title: <strong class="jx kf">"SimpleBlogApp"</strong>,<br/>      home: <strong class="jx kf">loggedIn </strong>? homeScaffold : loginScaffold);<br/>  }<br/>  ....<br/>  <br/>  @override<br/>  <strong class="jx kf">void </strong>initState() {<br/>    <strong class="jx kf">super</strong>.initState();<br/>    <strong class="jx kf">this</strong>._function();<br/>    ....<br/>  }<br/>}</span></pre><h2 id="f123" class="hs ht hu bd hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq dt translated">3.ç‚¹å‡»ç™»å½•æ—¶ï¼Œå°†è°ƒç”¨_ensureLoggedIn()å‡½æ•°/æ–¹æ³•ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å°†ä»–ä»¬çš„ç”¨æˆ·idã€ç”¨æˆ·åã€ç”¨æˆ·ä¸ªäººèµ„æ–™å›¾åƒå’Œç”¨æˆ·ç”µå­é‚®ä»¶IDå­˜å‚¨åœ¨å…±äº«é¦–é€‰é¡¹ä¸­ï¼Œå¹¶ä½¿<strong class="ak"> loggedIn </strong>å˜é‡ä¸ºçœŸ:</h2><pre class="js jt ju jv fq jw jx jy jz aw ka dt"><span id="c6cb" class="hs ht hu jx b fv kb kc l kd ke">Future&lt;Null&gt; _ensureLoggedIn() <strong class="jx kf">async </strong>{<br/>  <br/>  SharedPreferences prefs;<br/>  prefs = <strong class="jx kf">await </strong>SharedPreferences.<em class="kh">getInstance</em>();<br/>  <br/>  ........<br/>  <br/>  //sign in the user here and if it is successful then do following <br/>  <br/>  prefs.setString(<strong class="jx kf">"username"</strong>, user.<strong class="jx kf">displayName</strong>);<br/>  prefs.setString(<strong class="jx kf">"userid"</strong>, user.<strong class="jx kf">id</strong>);<br/>  prefs.setString(<strong class="jx kf">"useremail"</strong>, user.<strong class="jx kf">email</strong>);<br/>  prefs.setString(<strong class="jx kf">"userphotourl"</strong>, user.<strong class="jx kf">photoUrl</strong>);<br/>  <strong class="jx kf">this</strong>.setState(() {<br/>  /*<br/>     updating the value of <strong class="jx kf">loggedIn to true </strong>so it will <br/>     automatically trigger the screen to display homeScaffold.<br/>  */<br/>    <strong class="jx kf">loggedIn </strong>= <strong class="jx kf">true</strong>;<br/>    <strong class="jx kf">......</strong><br/>  });<br/>}</span></pre><h2 id="3fe7" class="hs ht hu bd hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq dt translated">5.å½“ç”¨æˆ·æ³¨é”€æ—¶ï¼Œå°†å…±äº«é¦–é€‰é¡¹æ¸…é™¤ä¸º:</h2><pre class="js jt ju jv fq jw jx jy jz aw ka dt"><span id="d972" class="hs ht hu jx b fv kb kc l kd ke">Future&lt;Null&gt; logoutUser() <strong class="jx kf">async </strong>{<br/>  <em class="kh">//logout user<br/>  </em>SharedPreferences prefs;<br/>  prefs = <strong class="jx kf">await </strong>SharedPreferences.<em class="kh">getInstance</em>();<br/>  <strong class="jx kf">await </strong>googleSignIn.signOut();<br/>  prefs.clear();<br/>  prefs.commit();<br/>  <strong class="jx kf">this</strong>.setState(() {<br/>  /*<br/>     updating the value of <strong class="jx kf">loggedIn to false </strong>so it will <br/>     automatically trigger the screen to display loginScaffold.<br/>  */<br/>    <strong class="jx kf">loggedIn </strong>= <strong class="jx kf">false</strong>;<br/>  });<br/>}</span></pre><p id="2cd5" class="pw-post-body-paragraph ir is hu it b iu jm iw ix iy jn ja jb ie jo jd je ii jp jg jh im jq jj jk jl hn dt translated">ä½ å¯ä»¥åœ¨GitHubä¸ŠæŸ¥çœ‹<a class="ae jr" href="https://github.com/im-minion/Flutter-Blog-App-Firebase" rel="noopener ugc nofollow" target="_blank"> Flutteråšå®¢app </a>é¡¹ç›®é‡Œé¢çš„<a class="ae jr" href="https://github.com/im-minion/Flutter-Blog-App-Firebase/blob/master/lib/HomePage.dart" rel="noopener ugc nofollow" target="_blank"> HomePage.dart </a>æ–‡ä»¶ã€‚ä»£ç ä»…å–è‡ªè¯¥æ–‡ä»¶ã€‚</p><p id="1179" class="pw-post-body-paragraph ir is hu it b iu jm iw ix iy jn ja jb ie jo jd je ii jp jg jh im jq jj jk jl hn dt translated">å¯¹äºæˆ‘çš„æ›´å¤šé¢¤æŒ¯é¡¹ç›®ï¼Œçœ‹çœ‹æˆ‘çš„<a class="ae jr" href="https://github.com/im-minion/" rel="noopener ugc nofollow" target="_blank"> GitHubç®€ä»‹</a>ã€‚</p><p id="9b61" class="pw-post-body-paragraph ir is hu it b iu jm iw ix iy jn ja jb ie jo jd je ii jp jg jh im jq jj jk jl hn dt translated">å¿«ä¹ç¼–ç ğŸ˜<br/> ThanksâœŒï¸ğŸ™‚</p><figure class="js jt ju jv fq ki"><div class="bz el l di"><div class="kj kk l"/></div></figure></div></div>    
</body>
</html>