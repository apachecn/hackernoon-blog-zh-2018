<html>
<head>
<title>How to Use OpenCV in React Native for Image Processing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React Native中使用OpenCV进行图像处理</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-use-opencv-in-react-native-for-image-processing-db997e73678c?source=collection_archive---------5-----------------------#2018-05-28">https://medium.com/hackernoon/how-to-use-opencv-in-react-native-for-image-processing-db997e73678c?source=collection_archive---------5-----------------------#2018-05-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/99625b279d9860a747edca2bea642e46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bb_Jz-VbqQ-VcgpwdrbykQ.png"/></div></div></figure><p id="9b76" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您曾经想知道如何使用OpenCV和React Native处理您的图像，那么您来对地方了。</p><p id="9532" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">OpenCV与<a class="ae ka" href="https://brainhub.eu/blog/difference-react-js-react-native-react-vr/" rel="noopener ugc nofollow" target="_blank"> React Native </a>一起使您能够<strong class="je hv">处理移动设备上的图像</strong>(您很可能想要处理您设备的摄像头拍摄的图像)。</p><p id="4484" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">其中最大的<strong class="je hv">优势</strong>是:</p><ul class=""><li id="44d7" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">容易实现。</li><li id="1ef7" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">好用。</li><li id="f564" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">互联网上有很多教程和OpenCV的官方文档。</li><li id="339d" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">你的移动应用程序的大小只会大十几兆字节。</li></ul><p id="f34e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我向你展示我如何使用OpenCV和React Native一步一步地处理我的图像，但首先要做一些介绍。</p><h1 id="b31c" class="kp kq hu bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">OpenCV是什么？</h1><p id="7cd4" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">OpenCV <strong class="je hv">(开源计算机视觉库)</strong>是一个开源的计算机视觉和机器学习软件库。OpenCV旨在为计算机视觉应用提供一个公共基础设施，并加速机器感知在商业产品中的应用。</p><p id="eca6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该库拥有超过<strong class="je hv"> 2500种优化算法</strong>，包括一套全面的经典和最先进的计算机视觉和机器学习算法。</p><p id="bc2e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这些算法可用于检测和识别人脸、识别物体、对视频中的人类动作进行分类、跟踪相机运动、跟踪运动物体、提取物体的3D模型、从立体相机产生3D点云、将图像拼接在一起以产生整个场景的高分辨率图像、从图像数据库中找到相似的图像、从使用闪光灯拍摄的图像中去除红眼、跟随眼球运动、识别风景并建立标记以用增强现实覆盖它等。</p><p id="445f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">OpenCV拥有超过47000人的社区，预计下载次数超过1400万次。</p><p id="8678" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该图书馆被公司、研究团体和政府机构广泛使用。</p><p id="0590" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">OpenCV是用C++原生编写的。</p><p id="5747" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">自2010年OpenCV被移植到Android环境后，它允许在移动应用程序开发中使用该库的全部功能。</p><p id="3400" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">2012年，OpenCV开发团队积极致力于增加对iOS的扩展支持。从版本2.4.2 (2012)开始提供完全集成。</p><p id="b050" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> React Native </strong>最早是脸书在2015年发布的<a class="ae ka" href="https://brainhub.eu/blog/famous-apps-built-with-react-native/" rel="noopener ugc nofollow" target="_blank">。React Native让你</a><a class="ae ka" href="https://brainhub.eu/technology/react-native-development" rel="noopener ugc nofollow" target="_blank">只用JavaScript就能构建移动应用</a>。它使用与React相同的设计，允许您从声明性组件构建丰富的移动UI。</p><h1 id="48d9" class="kp kq hu bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">React Native和OpenCV是好朋友！</h1><p id="b829" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">如果我们在谷歌上搜索“react native opencv ”,我们会发现以下链接:</p><ul class=""><li id="ebd9" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated"><a class="ae ka" href="https://github.com/ma-pe/react-native-opencv" rel="noopener ugc nofollow" target="_blank">GitHub—ma-PE/React-native-OpenCV:OpenCV Bindings for React…</a>'<br/>正如文件中的第一句话所说:“目前正在开发中🙂为OpenCV反应本地绑定。但是没有React本机绑定。”此外，它是不完整的，上传500多MB的OpenCV库不是一个好主意。</li><li id="c6e2" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://github.com/wix/react-native-camera-kit/issues/88" rel="noopener ugc nofollow" target="_blank">我可以在react native中使用openCV吗？？问题#88 wix/react-native … </a> ' <br/>关于React Native和OpenCV的一个未解问题。</li><li id="7809" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://github.com/opencv/opencv/issues/8681" rel="noopener ugc nofollow" target="_blank">opencv/opencv—GitHub</a>’<br/>链接库的一个问题是一开始并没有指明如何做。</li><li id="fac7" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://www.reddit.com/r/reactnative/comments/7iu5ad/newbie_react_native_with_opencv/" rel="noopener ugc nofollow" target="_blank">(新手)用OpenCV:React Native-Reddit</a>’<br/>反应原生，答案是可能的，但没有如何做的例子。</li></ul><h1 id="4012" class="kp kq hu bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">这个教程是关于什么的？</h1><p id="cff9" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">在本教程中，我们将构建一个示例项目，其中<strong class="je hv">使用设备的摄像头</strong>拍摄照片，<strong class="je hv">使用本机代码</strong>对其进行处理，并且<strong class="je hv">返回所拍摄图像模糊或清晰的信息</strong>。</p><p id="e7e5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">用普通的JavaScript来做是非常低效的。JavaScript不足以完成非常繁重的计算。</p><p id="4e23" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">请注意，我们绝不是Java或Objective-C开发人员，因此我们的Java/Objective-C代码可能远远不够好。如果你想对此课题有所贡献，请联系我们。</p></div><div class="ab cl ls lt hc lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hn ho hp hq hr"><h1 id="6fbb" class="kp kq hu bd kr ks lz ku kv kw ma ky kz la mb lc ld le mc lg lh li md lk ll lm dt translated">OpenCV基础准备</h1><p id="810d" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated"><strong class="je hv">第一步:</strong> <code class="eh me mf mg mh b">react-native init reactNativeOpenCvTutorial</code></p><p id="65c4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第二步:</strong>在你的项目目录中运行<code class="eh me mf mg mh b">downloadAndInsertOpenCV.sh</code>脚本(<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/downloadAndInsertOpenCV.sh" rel="noopener ugc nofollow" target="_blank">可以在这里找到)</a>它下载并插入Android和iOS的openCV文件。文件中的路径可能不符合您的偏好，因此您可能需要更改它们。</p></div><div class="ab cl ls lt hc lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hn ho hp hq hr"><h1 id="6e82" class="kp kq hu bd kr ks lz ku kv kw ma ky kz la mb lc ld le mc lg lh li md lk ll lm dt translated">Android教程</h1><p id="d82b" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated"><strong class="je hv">第一步:</strong>在Android Studio中打开你的项目。</p><p id="31ad" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">第二步:按照Android Studio中的提示同步你的项目。</p><p id="5097" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第三步:</strong>下载<a class="ae ka" href="https://opencv.org/releases.html" rel="noopener ugc nofollow" target="_blank">最新版本的OpenCV for Android </a>。我的情况是3.4.1。</p><p id="404a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第四步:</strong>导入OpenCV到Android Studio:从<code class="eh me mf mg mh b">File -&gt; New -&gt; Import Module</code>开始，在解压后的OpenCV档案中选择<code class="eh me mf mg mh b">sdk/java</code>文件夹。</p><p id="8cc7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第五步:</strong>更新导入的OpenCV模块下的<code class="eh me mf mg mh b">build.gradle</code>，更新4个字段以匹配您项目的<code class="eh me mf mg mh b">build.gradle</code>:</p><ul class=""><li id="4048" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">编译版本</li><li id="2669" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">构建工具版本</li><li id="5c8f" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">minSdkVersion</li><li id="b2e8" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">targetSdkVersion。</li></ul><p id="d280" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第六步:</strong>添加模块依赖:</p><p id="72f9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh me mf mg mh b">Application -&gt; Module Settings</code>，并选择<code class="eh me mf mg mh b">Dependencies</code>选项卡。点击底部的<code class="eh me mf mg mh b">+</code>图标，选择<code class="eh me mf mg mh b">Module Dependency</code>，选择导入的OpenCV模块。</p><p id="8bee" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于Android Studio v1.2.2，要在项目视图中访问<code class="eh me mf mg mh b">Module Settings</code>，右键单击依赖模块并选择<code class="eh me mf mg mh b">Open Module Settings</code>。</p><p id="353e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">打开<code class="eh me mf mg mh b">Module Settings</code>。</p><figure class="mj mk ml mm fq iv fe ff paragraph-image"><div class="fe ff mi"><img src="../Images/76bfddd748286dd6a5335790269c35b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*hr26lZFFdIIsv6QdeCzxqQ.png"/></div></figure><p id="7775" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">点击<code class="eh me mf mg mh b">+</code>，选择<code class="eh me mf mg mh b">Module Dependency</code>，从列表中选择OpenCV库。</p><figure class="mj mk ml mm fq iv fe ff paragraph-image"><div class="fe ff mn"><img src="../Images/a1e7b4e5bef2c95ccc0b527d463f64b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*zVo0CumvnHI5Zas0AMH3xw.png"/></div></figure><p id="f89d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第七步:<code class="eh me mf mg mh b">android/app/src/java</code>里面的</strong>创建一个名为即<code class="eh me mf mg mh b">com.reactlibrary</code>的包。</p><p id="cba9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">步骤8: 用适当的权限更新您的清单:</p><pre class="mj mk ml mm fq mo mh mp mq aw mr dt"><span id="0a85" class="ms kq hu mh b fv mt mu l mv mw">&lt;uses-permission android:name=”android.permission.CAMERA” /&gt;<br/>&lt;uses-permission android:name=”android.permission.READ_EXTERNAL_STORAGE” /&gt;<br/>&lt;uses-permission android:name=”android.permission.WRITE_EXTERNAL_STORAGE” /&gt;</span></pre><p id="e9de" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">参见<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/android/app/src/main/AndroidManifest.xml" rel="noopener ugc nofollow" target="_blank">整体文件</a>。</p><p id="0b62" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第9步:</strong>在你新创建的包里面创建一个文件<code class="eh me mf mg mh b">RNOpenCvLibraryModule.java</code>，然后<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/android/app/src/main/java/com/reactlibrary/RNOpenCvLibraryModule.java" rel="noopener ugc nofollow" target="_blank">填充它，如下图所示</a>。</p><p id="ad8e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第10步:</strong>在你新创建的包里面创建一个名为<code class="eh me mf mg mh b">RNOpenCvLibraryPackage.java</code>的文件<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/android/app/src/main/java/com/reactlibrary/RNOpenCvLibraryPackage.java" rel="noopener ugc nofollow" target="_blank">如下图所示</a>。</p><p id="7d1c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">步骤11: </strong>在您的<code class="eh me mf mg mh b">MainApplication.java</code>文件中添加适当的导入，将您的OpenCV包添加到列表中，并将适当的代码添加到<code class="eh me mf mg mh b">MainApplication</code>类中，如下所示:</p><pre class="mj mk ml mm fq mo mh mp mq aw mr dt"><span id="0470" class="ms kq hu mh b fv mt mu l mv mw">Imports:</span><span id="5602" class="ms kq hu mh b fv mx mu l mv mw">import com.reactlibrary.RNOpenCvLibraryPackage;<br/>import org.opencv.android.BaseLoaderCallback;<br/>import org.opencv.android.LoaderCallbackInterface;<br/>import org.opencv.android.OpenCVLoader;<br/>import android.util.Log;</span></pre><p id="6b8d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将<code class="eh me mf mg mh b">new RNOpenCvLibraryPackage()</code>添加到您的包列表中。</p><figure class="mj mk ml mm fq iv fe ff paragraph-image"><div class="fe ff my"><img src="../Images/ddd196722a82fb34f2ec82907984406f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ivoQUnu52nFOnsOMP_RuXg.png"/></div></figure><p id="cb08" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将<code class="eh me mf mg mh b">BaseLoaderCallback</code>添加到您的<code class="eh me mf mg mh b">MainApplication</code>类中:</p><figure class="mj mk ml mm fq iv fe ff paragraph-image"><div class="fe ff my"><img src="../Images/8a15776d519aede7fa5518c4e3a162be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*HojcpCnQdbHYjdJMbKNeyQ.png"/></div></figure><p id="9fe7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此外，向您的<code class="eh me mf mg mh b">MainApplication</code>类添加以下回调:</p><figure class="mj mk ml mm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mz"><img src="../Images/3918abc293fa4b9f8c94a80f4520295c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yGLc2xhL95S0DtrvTa3JJg.png"/></div></div></figure><p id="e81d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此处见<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/android/app/src/main/java/com/reactnativeopencvtutorial/MainApplication.java" rel="noopener ugc nofollow" target="_blank">整体文件。</a></p></div><div class="ab cl ls lt hc lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hn ho hp hq hr"><h1 id="380f" class="kp kq hu bd kr ks lz ku kv kw ma ky kz la mb lc ld le mc lg lh li md lk ll lm dt translated">iOS教程</h1><p id="0535" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated"><strong class="je hv">第一步:</strong>在XCode中打开iOS项目。</p><p id="3fba" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第二步:</strong>将<code class="eh me mf mg mh b">opencv2.framework</code>添加到你的<code class="eh me mf mg mh b">Linked Frameworks and Libraries</code>中。</p><figure class="mj mk ml mm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff na"><img src="../Images/dea26553881d9fb8dc8b4bc4a7f55c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eCLbenIjZ9-wLAIg9nCrfw.png"/></div></div></figure><p id="80ca" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">第三步:在iOS目录中创建新群组。我把它命名为“OpenCV”。</p><p id="d3e4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第四步:</strong>添加一个. pch文件，插入OpenCV目录。</p><p id="713e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第五步:</strong>给你的<code class="eh me mf mg mh b">.pch</code>文件添加合适的内容——这里显示的<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/ios/OpenCV/PrefixHeader.pch" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="8e5b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第六步:</strong>创建一个名为<code class="eh me mf mg mh b">RNOpenCvLibrary.h</code>的文件，<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/ios/OpenCV/RNOpenCvLibrary.h" rel="noopener ugc nofollow" target="_blank">如下图</a>填写。</p><p id="53eb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第七步:</strong>创建一个名为<code class="eh me mf mg mh b">RNOpenCvLibrary.mm</code>的文件，<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/ios/OpenCV/RNOpenCvLibrary.mm" rel="noopener ugc nofollow" target="_blank">如下图所示</a>。</p><p id="3171" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第八步:</strong>将<code class="eh me mf mg mh b">Precompile Prefix Header</code>设置为<code class="eh me mf mg mh b">Yes</code>，并像这样设置<code class="eh me mf mg mh b">Prefix Header path</code>:</p><figure class="mj mk ml mm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff na"><img src="../Images/0000643cbec2f7d3116320bd0f95afe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dh3S2_tvGWq0J8_eCiUSIQ.png"/></div></div></figure><p id="8e67" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第9步:</strong>将以下内容添加到您的<code class="eh me mf mg mh b">Info.plist</code>文件中:</p><pre class="mj mk ml mm fq mo mh mp mq aw mr dt"><span id="299a" class="ms kq hu mh b fv mt mu l mv mw">&lt;key&gt;NSCameraUsageDescription&lt;/key&gt;<br/>&lt;string&gt;Your message to user when the camera is accessed for the first time&lt;/string&gt;<br/>&lt;key&gt;NSPhotoLibraryAddUsageDescription&lt;/key&gt;<br/>&lt;string&gt;Your message to user when the photo library is accessed for the first time&lt;/string&gt;</span></pre><p id="9b1d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">参见<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/ios/reactNativeOpencvTutorial/Info.plist" rel="noopener ugc nofollow" target="_blank">整体文件</a>。</p></div><div class="ab cl ls lt hc lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hn ho hp hq hr"><h1 id="01b4" class="kp kq hu bd kr ks lz ku kv kw ma ky kz la mb lc ld le mc lg lh li md lk ll lm dt translated">最后一部分— JavaScript</h1><p id="8b1a" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated"><strong class="je hv">第一步:</strong>在你的src文件夹中创建一个名为<code class="eh me mf mg mh b">NativeModules</code>的文件夹和一个名为<code class="eh me mf mg mh b">OpenCV.js,</code>的文件，并填入:</p><pre class="mj mk ml mm fq mo mh mp mq aw mr dt"><span id="e89d" class="ms kq hu mh b fv mt mu l mv mw">import { NativeModules } from ‘react-native’;</span><span id="8bf7" class="ms kq hu mh b fv mx mu l mv mw">export default NativeModules.RNOpenCvLibrary;</span></pre><p id="8cfa" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">参见<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/src/NativeModules/OpenCV.js" rel="noopener ugc nofollow" target="_blank">整体文件</a>。</p><p id="2111" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第二步:</strong>我们将使用一些第三方库进行快速设置。打开终端并键入:</p><pre class="mj mk ml mm fq mo mh mp mq aw mr dt"><span id="ca86" class="ms kq hu mh b fv mt mu l mv mw">npm i –save react-native-svg<br/>npm i –save react-native-camera<br/>npm i –save react-native-easy-toast</span></pre><p id="d7b0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第三步:</strong>别忘了链接库:<code class="eh me mf mg mh b">react-native link</code>。</p><p id="4c77" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将使用这个文件作为参考。</p><p id="4ce9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在第126行，我们设置了摄像头，在第135行，我们创建了一个可触摸的元素来处理拍照。拍照由拍照功能处理。它拍摄一张照片，将数据保存在本地状态，并继续检查照片是否模糊。函数<code class="eh me mf mg mh b">proceedWithCheckingBlurryImage</code>使用本地函数<code class="eh me mf mg mh b">checkForBlurryImage</code>并返回一个简单的信息:照片是否模糊。</p><p id="d2eb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">第四步:</strong>注意:如果遇到Android连接相机的构建问题，参考我的<a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial/blob/master/android/build.gradle" rel="noopener ugc nofollow" target="_blank"> build.gradle文件</a>，尤其是<code class="eh me mf mg mh b">maven { url “<a class="ae ka" href="https://jitpack.io" rel="noopener ugc nofollow" target="_blank">https://jitpack.io</a>” }</code>行，在Android Studio中重新同步项目。</p><p id="eb03" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您有与Google Play服务相关的错误，请在GitHub 上查看此<a class="ae ka" href="https://github.com/facebook/react-native/issues/18479" rel="noopener ugc nofollow" target="_blank">问题。</a></p><p id="8b3b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您有与react-native-camera相关的错误，请检查主分支，在<code class="eh me mf mg mh b">package.json</code>中更改版本，如下所示:</p><pre class="mj mk ml mm fq mo mh mp mq aw mr dt"><span id="6d85" class="ms kq hu mh b fv mt mu l mv mw">“react-native-camera”: “git+<a class="ae ka" href="https://git@github.com/react-native-community/react-native-camera" rel="noopener ugc nofollow" target="_blank">https://git@github.com/react-native-community/react-native-camera</a>"</span></pre></div><div class="ab cl ls lt hc lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hn ho hp hq hr"><h1 id="ae39" class="kp kq hu bd kr ks lz ku kv kw ma ky kz la mb lc ld le mc lg lh li md lk ll lm dt translated">示例结果</h1><p id="ac4b" class="pw-post-body-paragraph jc jd hu je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">一张清晰的照片。我们会收到照片的预览，并可以选择使用它或重复它。</p><figure class="mj mk ml mm fq iv fe ff paragraph-image"><div class="fe ff mi"><img src="../Images/094a7b47a8a6038e5e91ed33f830c372.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*v2DKHp9bRrs8qxSryvQTGQ.png"/></div></figure><p id="43cb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一张模糊的照片。我们收到一条提示信息，通知我们照片模糊不清，必须重复拍摄。</p><figure class="mj mk ml mm fq iv fe ff paragraph-image"><div class="fe ff mi"><img src="../Images/04377dcbfcfd7acfc635a045d3a00ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*ZMAWia16O85sKiQZlbkg7w.png"/></div></figure><p id="1d6b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">别忘了看看我们GitHub </strong>  <strong class="je hv">上的</strong> <a class="ae ka" href="https://github.com/brainhubeu/reactNativeOpencvTutorial" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">最终产品！</strong></a></p></div><div class="ab cl ls lt hc lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hn ho hp hq hr"><h2 id="5e1f" class="ms kq hu bd kr nb nc nd kv ne nf ng kz jn nh ni ld jr nj nk lh jv nl nm ll nn dt translated">参考资料:</h2><ul class=""><li id="a5b3" class="kb kc hu je b jf ln jj lo jn no jr np jv nq jz kg kh ki kj dt translated"><a class="ae ka" href="https://stackoverflow.com/questions/27406303/opencv-in-android-studio" rel="noopener ugc nofollow" target="_blank">在Android Studio中为Android设置OpenCV</a>(stack overflow)</li><li id="de48" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://kurtjacobs.weebly.com/computer-vision/up-and-running-with-opencv-30-for-ios" rel="noopener ugc nofollow" target="_blank">在XCode中为iOS设置OpenCV</a>(博文)</li><li id="6523" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://facebook.github.io/react-native/docs/native-modules-ios.html" rel="noopener ugc nofollow" target="_blank">React Native的原生模块</a> (GitHub)</li><li id="69e8" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="http://answers.opencv.org/question/16927/detect-if-image-is-blurry/" rel="noopener ugc nofollow" target="_blank">用于检查提供的图像是否模糊的原生Java代码</a> (OpenCV官方)</li><li id="622d" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://stackoverflow.com/questions/24080123/opencv-with-laplacian-formula-to-detect-image-is-blur-or-not-in-ios" rel="noopener ugc nofollow" target="_blank">用于检查提供的图像是否模糊的本机目标C代码</a> (StackOverflow)</li><li id="3da8" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://opencv.org/about.html" rel="noopener ugc nofollow" target="_blank"> OpenCV官网</a> (OpenCV官方)</li></ul></div><div class="ab cl ls lt hc lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hn ho hp hq hr"><p id="5b1e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="nr">这是发表在Brainhub的博客</em> <a class="ae ka" href="https://brainhub.eu/blog/opencv-react-native-image-processing/" rel="noopener ugc nofollow" target="_blank"> <em class="nr">这里</em> </a> <em class="nr">。</em></p><p id="6d84" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">查看我们的其他React原生故事，如“<a class="ae ka" href="https://medium.freecodecamp.org/how-to-deliver-a-react-native-app-to-the-client-e58421e7272e" rel="noopener ugc nofollow" target="_blank">如何向客户端交付React原生应用</a>”!</p><p id="cd6f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">寻求帮助打造你的</strong><a class="ae ka" href="https://brainhub.eu/technology/react-native-development" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">React Native</strong></a><strong class="je hv">还是</strong><a class="ae ka" href="https://brainhub.eu/technology/react-js-development" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">React</strong></a><strong class="je hv">应用？</strong> <a class="ae ka" href="https://brainhub.eu/contact" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">降我们一行</strong> </a> <strong class="je hv">。</strong></p></div></div>    
</body>
</html>