<html>
<head>
<title>Machine Learning for the ISIC Cancer Classification Challenge #2: Deep learning on AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ISIC癌症分类挑战#2的机器学习:AWS上的深度学习</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/transfer-learning-in-the-cloud-for-the-isic-cancer-classification-challenge-e0898bffcc52?source=collection_archive---------9-----------------------#2018-05-28">https://medium.com/hackernoon/transfer-learning-in-the-cloud-for-the-isic-cancer-classification-challenge-e0898bffcc52?source=collection_archive---------9-----------------------#2018-05-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="103a" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">使用基于云的基础设施黑色素瘤分类从未如此简单</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/3cca4e731dcca93c3d6075ff7a15f89f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HBJ4FEUBR2AjFBunyjN_WQ.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">The Inception V3 architecture we’ll train for this post. <a class="ae jz" href="https://www.packtpub.com/mapt/book/big_data_and_business_intelligence/9781786466587/8/ch08lvl1sec48/inception-v3" rel="noopener ugc nofollow" target="_blank">Image source</a>.</figcaption></figure><p id="eefc" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">这是一个关于为ISIC挑战赛构建基本迁移学习模型的教程。这是我的第一个ISIC挑战赛帖子的续集，你可以在这里找到<a class="ae jz" href="https://hackernoon.com/machine-learning-for-isic-skin-cancer-classification-challenge-part-1-ccddea4ec44a" rel="noopener ugc nofollow" target="_blank"><strong class="kc hv"/></a><strong class="kc hv">，但也可以独立阅读。</strong></p><p id="ba35" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">众所周知，过去几年图像分类的技术水平一直由卷积神经网络(CNN)技术主导，这些技术是在数百万的大规模数据集上训练的。然而，在医学成像领域，数据集仍然相对较小。在黑色素瘤分类中，大多数数据集数以千计的样本，一些论文试图用更少的样本进行分类，但在这样小的数据集上训练的分类器很少能很好地推广。成功的黑色素瘤分类系统，如<a class="ae jz" href="https://www.nature.com/articles/nature21056" rel="noopener ugc nofollow" target="_blank">这个发表在<em class="kw"> Nature </em> </a> <em class="kw"> </em>上的系统，已经采用迁移学习来帮助克服有限的训练规模。</p><p id="5281" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">迁移学习的工作原理是将在大型数据集上学习到的一些参数用于较小的数据集。在图像识别中，这涉及“冻结”来自预训练CNN的一些卷积层的参数，以用作特征提取器，然后针对新问题重新训练网络的最终完全连接层，希望在先前数据集上学习的特征提取将证明对新问题有用。</p><p id="9bdb" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">在这篇文章中，我不会过多关注CNN和迁移学习背后的理论，但如果你不熟悉，我可以推荐一些资源。相反，我想把重点放在建立和改进迁移学习模式的过程上。首先，我们将讨论ISIC挑战本身以及云在构建分类器中可以发挥的作用。然后我们将在AWS上重新训练一个典型的迁移学习模型，并对其进行分析。最后，我们还将简单介绍一些技巧，例如可以为您带来顶级性能的堆叠。</p><p id="aeba" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">在这篇文章的后面，我将链接到所有相关的代码，所以如果你已经有了一个AWS帐户，你应该能够在几分钟的开发时间内复制这些工作。</p><p id="e32a" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">对于我们的数据集，我们将关注<a class="ae jz" href="https://challenge.kitware.com/#challenge/5aab46f156357d5e82b00fe5" rel="noopener ugc nofollow" target="_blank"> ISIC黑色素瘤分类挑战</a>。</p><blockquote class="kx ky kz"><p id="db6e" class="ka kb kw kc b kd ke iv kf kg kh iy ki la kk kl km lb ko kp kq lc ks kt ku kv hn dt translated">如果你对ISIC挑战的更多背景感兴趣，比<a class="ae jz" href="https://hackernoon.com/tagged/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>更新，或者你只是想看看在没有提到基础设施的情况下，该挑战的基本分类系统会是什么样子，请查看我以前的帖子，在那里我<a class="ae jz" href="https://hackernoon.com/machine-learning-for-isic-skin-cancer-classification-challenge-part-1-ccddea4ec44a" rel="noopener ugc nofollow" target="_blank">为2017年的挑战</a>建立了一个基本的主成分分析+决策树模型。</p></blockquote><p id="7531" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">按照这篇文章中的步骤，我假设你已经<a class="ae jz" href="https://aws.amazon.com/premiumsupport/knowledge-center/create-and-activate-aws-account/" rel="noopener ugc nofollow" target="_blank">创建了一个AWS账户</a>，你已经<a class="ae jz" href="https://docs.aws.amazon.com/cli/latest/userguide/installing.html" rel="noopener ugc nofollow" target="_blank">安装了AWS CLI </a>，并且<a class="ae jz" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-environment.html" rel="noopener ugc nofollow" target="_blank">将凭证作为环境变量</a>导出到本地。甚至不需要本地安装Tensorflow！一些基本的AWS知识在这里是有用的(例如什么是EC2和CloudFormation)，但不是必需的。</p><h1 id="6b25" class="ld le hu bd lf lg lh li lj lk ll lm ln ja lo jb lp jd lq je lr jg ls jh lt lu dt translated">数据集</h1><p id="d87d" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">ISIC刚刚发布了他们的<a class="ae jz" href="https://challenge2018.isic-archive.com/" rel="noopener ugc nofollow" target="_blank"> 2018挑战</a>。今年，分类挑战从关注是否活检(二元分类)转变为包括7种不同类型病变的完全多类分类问题。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff ma"><img src="../Images/2fc305a90ab21d40867373d2539b8781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4FAOGvw2vyK9U3e8jSLQXw.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">The full list of lesion types types to classify in the ISIC dataset. We’ll be focusing on Melanoma vs. non-Melanoma.</figcaption></figure><p id="fffc" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">今年国际标准行业分类挑战的理想指标是七向分类准确性，而不是往年的AUC。然而，为了保持结果与我之前的帖子一致，<strong class="kc hv">在这篇帖子</strong>中，我仍然只讨论良性与恶性分类。改变结果以获得7向精度只需要改变目录结构，我将在后面的文章中描述。提交仍然需要提供黑素瘤相对于rest的AUC值，但它不再是目标指标。</p><h1 id="6a23" class="ld le hu bd lf lg lh li lj lk ll lm ln ja lo jb lp jd lq je lr jg ls jh lt lu dt translated">为什么要在云端训练？</h1><p id="c25a" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">在我们进入代码之前，这里有几件事情激发了这种方法(没有特定的顺序):</p><ol class=""><li id="bd57" class="mb mc hu kc b kd ke kg kh kj md kn me kr mf kv mg mh mi mj dt translated">我们将在本帖中使用的迁移学习脚本冻结了CNN的所有卷积层，因此它可以在普通CPU上完成。然而，微调CNN的一些卷积层通常是这种规模的数据集的最佳方法，由于需要训练的参数数量增加，因此需要使用高端GPU。在下面您将看到的方法中，使用支持GPU的实例就像在模板中交换掉<code class="eh mk ml mm mn b">InstanceType</code>以使用<a class="ae jz" href="https://aws.amazon.com/ec2/instance-types/p2/" rel="noopener ugc nofollow" target="_blank"> P2实例</a>而不是<code class="eh mk ml mm mn b">t2.medium</code><em class="kw">T5】实例一样简单。请记住，P2实例非常昂贵！当你用完它们的时候，你需要小心地把它们关掉。</em></li><li id="d83d" class="mb mc hu kc b kd mo kg mp kj mq kn mr kr ms kv mg mh mi mj dt translated">如果您需要训练一组模型，或者需要并行运行多个实验(对于K-folds)，为每个实验旋转一个实例就像重新运行下一节中的少量命令一样简单，但对于云形成堆栈来说名称不同。给每个栈取一个不同的名字也可以让你很容易地管理你的实验和它们相关的基础设施。</li><li id="e146" class="mb mc hu kc b kd mo kg mp kj mq kn mr kr ms kv mg mh mi mj dt translated">使用预装了所有主要<a class="ae jz" href="https://hackernoon.com/tagged/deep-learning" rel="noopener ugc nofollow" target="_blank">深度学习</a>框架的AMI将为我们节省大量可能浪费在配置上的时间。当不同的实验需要不同的库或框架时，我们将能够使用相同的代码独立于所有其他实验来支持任何实验。</li><li id="c0da" class="mb mc hu kc b kd mo kg mp kj mq kn mr kr ms kv mg mh mi mj dt translated">如果你像我一样，不想让你的电脑开几个小时，这种方法会让你开始训练模型，然后走开。</li><li id="18b7" class="mb mc hu kc b kd mo kg mp kj mq kn mr kr ms kv mg mh mi mj dt translated">使用一个<a class="ae jz" href="https://aws.amazon.com/cloudformation/" rel="noopener ugc nofollow" target="_blank"> CloudFormation </a>模板将让我们对我们的基础设施进行版本控制，并将实例转化为一个单一的命令。这也将使获取实例的IP变得更加容易。如果我们想要一个像S3桶一样的东西来存放我们的模型，那也应该放在这里。</li></ol><h1 id="562d" class="ld le hu bd lf lg lh li lj lk ll lm ln ja lo jb lp jd lq je lr jg ls jh lt lu dt translated">基础设施</h1><p id="9d13" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">在这篇文章中，我们将使用AMI在AWS EC2实例上训练我们的模型。我们还将在AWS CloudFormation中模板化我们的所有代码。</p><p id="18a5" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">在你执行下面的代码之前，请记住，因为你正在安装真正的硬件，所以它会从你的AWS账户中扣钱。</strong></p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mt mu l"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">The CloudFormation template we’ll use to start our EC2 instance. Including a CloudFormation mapping for the different AMI <code class="eh mk ml mm mn b">ImageId</code>s in each region is a best practice I left out of the above template for brevity.</figcaption></figure><p id="228b" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我发现这种方法的唯一问题是<code class="eh mk ml mm mn b">ImageId </code>参数很难追踪。如果您在寻找另一个地区的特定图像ID时遇到问题，请告诉我，我可以帮助您(这实际上是一个非常棘手的过程)。<code class="eh mk ml mm mn b">ImageId</code>也会定期更新，所以如果这个过时了，请告诉我。</p><p id="411b" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">下面是设置该模板的方法(假设您的AWS凭据存储为环境变量，并且您安装了AWS CLI):</p><p id="bc52" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我假设你已经让<a class="ae jz" href="https://stedolan.github.io/jq/download/" rel="noopener ugc nofollow" target="_blank"> JQ安装了</a>。它将让我们更容易地在shell中解析JSON，并且安装非常简单。</p><p id="663d" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">首先在本地安装上述模板，然后执行以下命令:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mt mu l"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Some commands to spin up our instance and ssh into it.</figcaption></figure><h1 id="1737" class="ld le hu bd lf lg lh li lj lk ll lm ln ja lo jb lp jd lq je lr jg ls jh lt lu dt translated">下载数据</h1><p id="58fc" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">我下载数据的过程包括浏览<a class="ae jz" href="https://isic-archive.com/#images" rel="noopener ugc nofollow" target="_blank"> ISIC image gallery </a>以了解它，使用gallery上的“下载元数据”选项下载数据集的元数据(我使用gallery过滤了“SONIC”数据集，原因您将在下面看到)，然后运行几个我自己的脚本来下载图像数据并将其转换为合适的格式。</p><p id="6c74" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我在Github 上整合了一个<a class="ae jz" href="https://github.com/evankozliner/image-downloader" rel="noopener ugc nofollow" target="_blank">小仓库，其中包含我用来下载数据集的脚本。我更喜欢这种方法，因为我使用EC2盒子来运行我的分类器，除了本地的测试数据之外，我没有太多的用处。另一种方法是从他们的ISIC网站下载图片，然后<code class="eh mk ml mm mn b">scp</code>把它们放到你的EC2盒子里，但是这要花更长的时间(而且不能利用多重处理)。</a></p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mt mu l"/></div></figure><h2 id="0706" class="mv le hu bd lf mw mx my lj mz na nb ln kj nc nd lp kn ne nf lr kr ng nh lt ni dt translated">该数据集中的一个“问题”</h2><p id="87e6" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">如果您通过我上面描述的API下载图像，您可能需要考虑从“SONIC”数据集中过滤元数据。SONIC是一个9000幅图像的大型数据集，包含儿童中完全良性的葡萄胎。不仅包括声波样本会严重偏向良性病变，而且我在数据集中看到的所有图像似乎都包括这个大的彩色圆圈，分类器将学习诊断为良性。我第一次运行这个分类器时，无意中包含了这个数据集，并在良性/恶性比例为60/40的情况下，在90年代中期获得了一些可疑的高精度，所以不要犯我的错误。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff nj"><img src="../Images/1ba10d4267641014820817988a0cd8c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*g8O_eByZgu_gLkSxH6jHyQ.png"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Some benign mole images from the “SONIC” dataset. All images in the SONIC dataset look like these and have the same labels. Some preprocessing could make these images valuable, but they’re not useful as they are.</figcaption></figure><h1 id="6657" class="ld le hu bd lf lg lh li lj lk ll lm ln ja lo jb lp jd lq je lr jg ls jh lt lu dt translated">训练分类器</h1><p id="23a4" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">当我最初写这篇教程时，我考虑过给它添加一个更复杂的模型，但是已经有很多优秀的教程在做这件事，所以我想把重点放在这里的基础设施上。现在你已经有了一个预装了所有流行的深度学习库的AMI，你可以进行任何你想做的实验，所以你在神经网络上找到的任何其他教程都应该在这个实例上工作(我在“下一步”中链接了一些)。</p><p id="48e3" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">在本教程的剩余部分，我将向您展示快速迁移学习模型是如何执行的。有一个<a class="ae jz" href="https://github.com/tensorflow/hub/tree/master/examples/image_retraining" rel="noopener ugc nofollow" target="_blank">图像再训练样本</a>,<a class="ae jz" href="https://www.tensorflow.org/tutorials/image_retraining" rel="noopener ugc nofollow" target="_blank">Tensorflow提供了一个关于</a>的教程，非常适合快速查看基本的迁移学习结果，但如果你想将迁移学习模型包括在一个集合中，对你的网络进行微调，或者任何超出查看准确度的分析，你需要稍微修改它，或者如果你对tensor flow不够了解，可以考虑另一个解决方案，如Keras。</p><p id="3419" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">如果您想对模型进行一些更细粒度的分析，我在Github 上有一个<a class="ae jz" href="https://github.com/evankozliner/tensorflow" rel="noopener ugc nofollow" target="_blank"> Tensorflow fork，我在其中添加了生成ROC曲线所必需的日志记录，我在“分析我们的结果”中展示了这些日志记录。分叉整个Tensorflow回购在这里并不完全必要，但它确实有助于强调脚本不是我的工作。</a></p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mt mu l"/></div></figure><h1 id="f809" class="ld le hu bd lf lg lh li lj lk ll lm ln ja lo jb lp jd lq je lr jg ls jh lt lu dt translated">分析您的结果</h1><p id="a49b" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">ROC曲线是衡量我们在数据集不平衡的2类分类问题中的性能的一种很好的方法。通常，我们还会对我们的模型在人为增加假阳性率时的表现感兴趣。在ISIC挑战中，我们对低假阳性率感兴趣，因为这相当于低不必要的活检率。在我之前关于ISIC挑战的文章中，我对ROC曲线进行了更深入的研究，但是对于那些不熟悉的人来说，ROC是不同分类阈值下的真阳性率和假阳性率的曲线图；它是通过选择分类阈值并重新计算模型在测试集上达到的真阳性率和假阳性率来构建的。roc通常通过其曲线下面积(AUC)来判断。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nk"><img src="../Images/c59e13a51b1146f813dbf71ac9806a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*brDmvRwmosoHuSnbKGSe6A.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">This ROC curve for our model on the holdout set. It achieves .86 AUC with no preprocessing techniques applied and achieved an 80% test accuracy with a 60/40 benign/malignant data split. Running this classifier with a large dataset (100k+ images) been known to yield AUCs as high as .96.</figcaption></figure><p id="a2b1" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">将这个模型与以前的帖子进行比较并不完全公平，因为它是用更大的数据集训练的，但即使没有任何数据扩充、集成或微调，我们也比以前的模型高出06 AUC，而且这个模型更容易构建。这个模型仍然有可能没有我上一篇文章中讨论的PCA到决策树模型表现得更好，所以在实践中对它进行一些交叉验证是明智的。因为模型需要一些时间来训练，交叉验证是并行运行几个AWS实例可以派上用场的另一个地方(您需要使用不同的训练/测试数据集来训练每个实例上的分类器，以完成交叉验证)。</p><h1 id="4c24" class="ld le hu bd lf lg lh li lj lk ll lm ln ja lo jb lp jd lq je lr jg ls jh lt lu dt translated">改进您的分类器</h1><p id="b00c" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">0.86的AUC还不错，但还算不上世界级，顶级报纸往往在90年代中期。增加我们AUC的最简单的解决方案是获得更多的图像，但鉴于此，我认为讨论一些接下来的步骤来尝试从分类器中挤出更多的图像可能是好的。我在m <a class="ae jz" href="https://hackernoon.com/machine-learning-for-isic-skin-cancer-classification-challenge-part-1-ccddea4ec44a" rel="noopener ugc nofollow" target="_blank"> y以前的帖子</a>中也谈到了一些，我在那里提到的任何技术也将有助于提高CNN的得分。</p><h2 id="8afa" class="mv le hu bd lf mw mx my lj mz na nb ln kj nc nd lp kn ne nf lr kr ng nh lt ni dt translated">微调</h2><p id="381a" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">微调是在迁移学习的同时重新训练不仅仅是神经网络的最终完全连接层的过程。在图像分类中，除了最终完全连接的层之外，这通常还涉及额外重新训练卷积层。这对于像ISIC这样的图像分类问题特别有用，因为CNN后来的卷积层倾向于应用更多特定于数据集的特征提取，如果它们来自像ImageNet这样的数据集，对我们来说就不太可能有用。</p><p id="c001" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">如果你对微调一个模型感兴趣，最好不要使用我在这篇文章中使用的脚本，而先使用像<a class="ae jz" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>这样的高级库。在Keras中，取消冻结和微调一些后续卷积层的过程比在Tensorflow等框架中更简单。您仍然可以按照我上面描述的方式利用AWS AMI，但是正如我前面提到的，最好在微调时在类似P2实例的东西上训练模型，因为在解冻网络的某些层时，如果没有GPU，训练将会明显变慢。</p><p id="788a" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">这里有一个关于如何在Keras中实现这一点的<a class="ae jz" href="https://flyyufelix.github.io/2016/10/03/fine-tuning-in-keras-part1.html" rel="noopener ugc nofollow" target="_blank">优秀教程系列</a>。</p><h2 id="ca01" class="mv le hu bd lf mw mx my lj mz na nb ln kj nc nd lp kn ne nf lr kr ng nh lt ni dt translated">预处理</h2><p id="f098" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">除了标准化等标准技术之外，图像分割可能是通常应用于黑色素瘤分类的最有用的预处理技术。分割图像通过去除可能欺骗分类器的噪声来改善AUC。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nl"><img src="../Images/9901d01769d48057f4ba322016c66815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fYbe9QV51sGEKj4OE1DYVA.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">In segmentation a “mask” (left) is found for the image, and the coordinates of the mask are used to “crop” the image (right). Reference: <a class="ae jz" href="https://upcommons.upc.edu/bitstream/handle/2117/105582/analytics3-Marques.pdf?sequence=1&amp;isAllowed=y" rel="noopener ugc nofollow" target="_blank"><em class="nm">Jack Burdick, et all</em></a><em class="nm">. This helps the classifier by removing background noise on the image.</em></figcaption></figure><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nn"><img src="../Images/447d05906ada162a2ea47f4d82ed6eb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U8LkeTFyyY8MRDjkqdzhaA.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Here’s an empirical experiment out of Florida Atlantic University that suggests that partial segmentation is ideal for CNN models. Reference: <a class="ae jz" href="https://upcommons.upc.edu/bitstream/handle/2117/105582/analytics3-Marques.pdf?sequence=1&amp;isAllowed=y" rel="noopener ugc nofollow" target="_blank"><em class="nm">Jack Burdick, et all</em></a></figcaption></figure><p id="bd8e" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">分割本身是一个单独的挑战，这是各种卷积架构被证明是最先进的另一个例子。阈值处理等传统图像分割方法在这里仍然有用，但根据我的经验，当遇到头发等常见的“干扰”时，它们会遇到麻烦。</p><h2 id="8352" class="mv le hu bd lf mw mx my lj mz na nb ln kj nc nd lp kn ne nf lr kr ng nh lt ni dt translated">合奏</h2><p id="ad5c" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">使用一群学习者是另一种流行的方法。集成学习器通过多个分类器运行新的示例，然后通常通过某种加权投票来组合结果。您将需要单独训练(和交叉验证)集合中的每个分类器，所以这就是使用AWS之类的工具旋转任意数量的服务器的能力变得非常有价值的地方。</p><p id="7823" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">对于如何合奏，你有很大的选择余地；以下是我见过的一些成功的合奏:</p><ul class=""><li id="6a8c" class="mb mc hu kc b kd ke kg kh kj md kn me kr mf kv no mh mi mj dt translated">传统的机器学习技术用手工制作的功能和深度学习方法训练，就像我在这篇文章中描述的那样。</li><li id="1b67" class="mb mc hu kc b kd mo kg mp kj mq kn mr kr ms kv no mh mi mj dt translated">不同深度学习架构的合集(比如VGG16和Inception V3)。</li><li id="ccbf" class="mb mc hu kc b kd mo kg mp kj mq kn mr kr ms kv no mh mi mj dt translated">集成，其中一个分类器在分割图像上训练，另一个在完整图像上训练。</li><li id="1aa9" class="mb mc hu kc b kd mo kg mp kj mq kn mr kr ms kv no mh mi mj dt translated">使用线性近似组合的独立二元分类器的集合。例如使用皮肤角化病对其他分类器以及黑色素瘤对其他分类器。</li></ul><p id="08f0" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">这里有一个很好的关于卷积网络系综的教程。</p><p id="dc1b" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">请记住，如果您希望通过组合模型来获得任何信息，您会希望模型在训练集上的结果是不相关的。</p><p id="c8a1" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">另一个考虑是<a class="ae jz" href="https://www.kdnuggets.com/2017/02/stacking-models-imropved-predictions.html" rel="noopener ugc nofollow" target="_blank">堆码车型</a>；这实质上是在训练好的分类器集合的输出上训练另一个分类器。我还没有看到很多论文为ISIC滥用这种技术，所以这可能是一个很有希望的领域。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff np"><img src="../Images/da28fc22566a06fa82bb93ef99b28b46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tyFc2IeAidDywxX_Gbmp5Q.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">A diagram from an excellent KD nuggests tutorial on stacking. Written by Burak Himmetoglu of UC Santa Barbara. <a class="ae jz" href="https://www.kdnuggets.com/2017/02/stacking-models-imropved-predictions.html" rel="noopener ugc nofollow" target="_blank">Link</a></figcaption></figure><p id="5c77" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">当然，没有人说你不能微调，利用分段图像，<em class="kw">和</em>合奏；)</p><h1 id="84c1" class="ld le hu bd lf lg lh li lj lk ll lm ln ja lo jb lp jd lq je lr jg ls jh lt lu dt translated">结束语</h1><p id="3bd7" class="pw-post-body-paragraph ka kb hu kc b kd lv iv kf kg lw iy ki kj lx kl km kn ly kp kq kr lz kt ku kv hn dt translated">如果你已经做到这一步，感谢你的阅读！我希望你知道如何在AWS上训练一个基本的深度学习分类器，以及如何用一些更先进的技术来改进它。</p><p id="c185" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">使用完后，记得删除堆栈，否则您将被收取超出预期时间的费用。</strong></p><p id="854a" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">如果你在任何地方发现任何错误，请告诉我！我可能还没有尽可能多地校对这本书。</p><p id="6feb" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">如果你自己正在尝试ISIC挑战，我很想知道你的结果和你在尝试什么。请通过Medium、Twitter或evankozliner@gmail.com联系我。我非常期待看到2018年的论文:)</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nq mu l"/></div></figure></div></div>    
</body>
</html>