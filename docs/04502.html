<html>
<head>
<title>From VanillaJS to Vue.js: A refactoring tale</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从VanillaJS到Vue.js:重构的故事</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/from-vanillajs-to-vue-js-a-refactoring-tale-846bee20ba3d?source=collection_archive---------6-----------------------#2018-05-29">https://medium.com/hackernoon/from-vanillajs-to-vue-js-a-refactoring-tale-846bee20ba3d?source=collection_archive---------6-----------------------#2018-05-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/c7b70ff41283db0066a05df0036635b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*erFf_FR6qTUm0xW9."/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/@oskaryil?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Oskar Yildiz</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2ec2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>是一个构建web应用的框架。它有一个反应系统，允许您建模和管理您的应用程序状态，这样当数据改变时，它会反映在UI中，而您不必查询DOM。如果您已经用普通JavaScript或jQuery构建了应用程序，那么您知道您需要查询DOM元素并更新它们，以便显示一些数据或显示一些其他应用程序状态。</p><p id="06b9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于大型应用程序来说，这变得难以管理。上周，我花了几个小时学习一些基本的东西，并在一个用vanilla JS构建的附带项目中采用了它。我想和你们分享我的一些心得，并一起比较代码的不同之处。<a class="ae jg" href="https://github.com/pmbanugo/shopping-list" rel="noopener ugc nofollow" target="_blank">项目</a>是一个购物清单<a class="ae jg" href="https://developer.mozilla.org/en-US/Apps/Progressive" rel="noopener ugc nofollow" target="_blank">渐进式网络应用</a>，它使用<a class="ae jg" href="http://hood.ie/" rel="noopener ugc nofollow" target="_blank">帽衫</a>。</p><figure class="kg kh ki kj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kf"><img src="../Images/a2f18e7f1f29911245234c2225ae3274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IQwcaQVsQOhiwzqV.png"/></div></div></figure><p id="f9b4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你想继续，你可以下载Vanilla JS的<a class="ae jg" href="https://github.com/pmbanugo/shopping-list" rel="noopener ugc nofollow" target="_blank">源代码</a>，我会向你展示我是如何在Vue中添加的(如果你想了解我是如何用Vanilla JS、Hoodie和Service Worker构建这个应用的，请点击这个<a class="ae jg" href="https://www.twilio.com/blog/2018/03/practical-introduction-pwa-node-hoodie-offline-first.html" rel="noopener ugc nofollow" target="_blank">链接</a>)。</p><h1 id="5350" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">添加项目</h1><p id="9feb" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated">该应用程序允许用户将购物项目添加到他们的购物清单中。这是在公共文件夹的<code class="eh ln lo lp lq b">index.html</code>中完成的。第92行到第124行包含这样的标记:</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="6da8" class="lv kl hu lq b fv lw lx l ly lz">&lt;div&gt;<br/>  &lt;div class="mdl-grid center-items"&gt;<br/>  &lt;div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"&gt;<br/>      &lt;input class="mdl-textfield__input" type="text" id="new-item-name"&gt;<br/>      &lt;label class="mdl-textfield__label" for="new-item-name"&gt;Item Name&lt;/label&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"&gt;<br/>      &lt;input class="mdl-textfield__input" type="number" id="new-item-cost"&gt;<br/>      &lt;label class="mdl-textfield__label" for="new-item-cost"&gt;Item Cost&lt;/label&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"&gt;<br/>      &lt;input class="mdl-textfield__input" type="number" id="new-item-quantity"&gt;<br/>      &lt;label class="mdl-textfield__label" for="new-item-quantity"&gt;Quantity&lt;/label&gt;<br/>  &lt;/div&gt;<br/>  &lt;/div&gt;</span><span id="321f" class="lv kl hu lq b fv ma lx l ly lz">  &lt;div class="mdl-grid center-items"&gt;<br/>  &lt;button id="add-item" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored"&gt;<br/>      Add Item<br/>  &lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="3613" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">处理数据收集和保存数据的代码在文件<code class="eh ln lo lp lq b">public/js/src/index.js</code>中。第28行的函数<code class="eh ln lo lp lq b">saveNewItem()</code>从输入元素收集值并保存条目。然后绑定到<code class="eh ln lo lp lq b">add-item</code>按钮的click事件。代码如下:</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="f0b1" class="lv kl hu lq b fv lw lx l ly lz">function saveNewitem() {<br/>  let name = document.getElementById("new-item-name").value;<br/>  let cost = document.getElementById("new-item-cost").value;<br/>  let quantity = document.getElementById("new-item-quantity").value;<br/>  let subTotal = cost * quantity;<br/>  if (name &amp;&amp; cost &amp;&amp; quantity) {<br/>    hoodie.store.withIdPrefix("item").add({<br/>      name: name,<br/>      cost: cost,<br/>      quantity: quantity,<br/>      subTotal: subTotal<br/>    });<br/>    document.getElementById("new-item-name").value = "";<br/>    document.getElementById("new-item-cost").value = "";<br/>    document.getElementById("new-item-quantity").value = "";<br/>  } else {<br/>    let snackbarContainer = document.querySelector("#toast");<br/>    snackbarContainer.MaterialSnackbar.showSnackbar({<br/>      message: "All fields are required"<br/>    });<br/>  }<br/>}</span><span id="7188" class="lv kl hu lq b fv ma lx l ly lz">document.getElementById("add-item").addEventListener("click", saveNewitem);</span></pre><h1 id="49b6" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">切换到Vue</h1><p id="dfa1" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated">采用Vue的第一件事就是在你的页面上添加一个对Vue的引用。我把这个加到<code class="eh ln lo lp lq b">index.html</code>里如下:</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="4c57" class="lv kl hu lq b fv lw lx l ly lz">&lt;script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"&gt;&lt;/script&gt;</span></pre><p id="872a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我还添加了一个id为<code class="eh ln lo lp lq b">app</code>的<code class="eh ln lo lp lq b">div</code>元素来包围body标签中的每个页面元素。这是必要的，因为当我们初始化一个Vue实例时，我们需要告诉它我们希望它控制应用程序的哪个部分。通过这样做，我告诉它管理该块中的所有内容。我修改了标记以使用一些Vue指令。Vue指令是带有<code class="eh ln lo lp lq b">v-</code>前缀的特殊属性。下面是更新后的标记</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="734f" class="lv kl hu lq b fv lw lx l ly lz">&lt;form v-on:submit.prevent="onSubmit"&gt;<br/>  &lt;div class="mdl-grid center-items"&gt;<br/>    &lt;div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"&gt;<br/>      &lt;input class="mdl-textfield__input" type="text" id="new-item-name" v-model="name"&gt;<br/>      &lt;label class="mdl-textfield__label" for="new-item-name"&gt;Item Name&lt;/label&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"&gt;<br/>      &lt;input class="mdl-textfield__input" type="number" id="new-item-cost" v-model.number="cost"&gt;<br/>      &lt;label class="mdl-textfield__label" for="new-item-cost"&gt;Item Cost&lt;/label&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"&gt;<br/>      &lt;input class="mdl-textfield__input" type="number" id="new-item-quantity" v-model.number="quantity"&gt;<br/>      &lt;label class="mdl-textfield__label" for="new-item-quantity"&gt;Quantity&lt;/label&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;</span><span id="4f19" class="lv kl hu lq b fv ma lx l ly lz">  &lt;div class="mdl-grid center-items"&gt;<br/>    &lt;button id="add-item" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored"&gt;<br/>      Add Item<br/>    &lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/form&gt;</span></pre><p id="aa5d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ln lo lp lq b">v-on</code>指令用于监听DOM事件。在上面的代码中，它被用在form元素中来监听submit事件。它还使用了<code class="eh ln lo lp lq b">.prevent</code>修饰符，告诉<code class="eh ln lo lp lq b">v-on</code>指令在触发的事件上调用<code class="eh ln lo lp lq b">event.preventDefault()</code>。我们在输入元素上使用了<code class="eh ln lo lp lq b">v-model</code>指令。它用于在表单输入上创建双向数据绑定。它会根据输入类型自动选择正确的方式来更新元素。我们已经为成本和数量输入元素使用了<code class="eh ln lo lp lq b">.number</code>修饰符。它的作用是自动将输入元素的值转换成一个数字。这是因为即使类型设置为<code class="eh ln lo lp lq b">type=number</code>，该值也将始终返回字符串。所以我在这里使用的这些修饰语有助于减少一些额外的检查。</p><p id="cad5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我创建了一个新文件<code class="eh ln lo lp lq b">index-vue.js</code>来包含与<code class="eh ln lo lp lq b">index.js</code>中相同的代码，但是使用了Vue。下面是该文件中的代码，它创建了一个Vue实例，该实例具有处理表单事件和收集数据所需的属性。</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="6947" class="lv kl hu lq b fv lw lx l ly lz">const vm = new Vue({<br/>  el: "#app",<br/>  data: {<br/>    name: "",<br/>    cost: "",<br/>    quantity: ""<br/>  },<br/>  methods: {<br/>    onSubmit: function(event) {<br/>      if (this.name &amp;&amp; this.cost &amp;&amp; this.quantity) {<br/>        hoodie.store.withIdPrefix("item").add({<br/>          name: this.name,<br/>          cost: this.cost,<br/>          quantity: this.quantity,<br/>          subTotal: this.cost * this.quantity<br/>        });</span><span id="a279" class="lv kl hu lq b fv ma lx l ly lz">        this.name = "";<br/>        this.cost = "";<br/>        this.quantity = "";<br/>      } else {<br/>        const snackbarContainer = document.querySelector("#toast");<br/>        snackbarContainer.MaterialSnackbar.showSnackbar({<br/>          message: "All fields are required"<br/>        });<br/>      }<br/>    }<br/>  }<br/>});</span></pre><p id="b90e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在上面的代码块中，我创建了一个Vue实例，向它传递一个对象，告诉Vue如何设置应用程序。<code class="eh ln lo lp lq b">el</code>属性告诉它Vue将选择并定义其领域的DOM元素的id。正是在这个领域内，它选择Vue指令(以及其他与Vue相关的东西)，当它被初始化时，它为应用程序设置绑定和事件处理程序。</p><p id="3544" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ln lo lp lq b">data</code>属性包含应用程序状态。初始化Vue实例时，包含对象中的所有属性将被添加到Vue的反应系统中。当绑定到DOM的一个值改变时，正是这个反应系统导致UI更新。例如，使用<code class="eh ln lo lp lq b">v-model="name"</code>指令将<code class="eh ln lo lp lq b">name</code>属性绑定到名称输入元素。该指令在<code class="eh ln lo lp lq b">name</code>和输入元素之间建立了一个双向绑定，这样当在输入字段中添加或删除一个字符时，它会更新<code class="eh ln lo lp lq b">name</code>属性，这将导致输入的值反映<code class="eh ln lo lp lq b">name</code>的当前值。同样，绑定到<code class="eh ln lo lp lq b">name</code>的其他元素也会随着用户输入值而改变。</p><p id="7fa0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ln lo lp lq b">methods</code>属性包含函数。上面的代码定义了一个绑定到表单提交事件的<code class="eh ln lo lp lq b">onSubmit()</code>函数。</p><h1 id="3fce" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">显示保存的项目</h1><p id="7125" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated"><code class="eh ln lo lp lq b">onSubmit</code>功能将物品保存到帽衫中。我想在UI中显示添加到表格中的项目。Vanilla JS应用程序有以下标记:</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="8ac5" class="lv kl hu lq b fv lw lx l ly lz">&lt;div class="mdl-grid center-items"&gt;<br/>  &lt;table id="item-table" class="mdl-data-table mdl-js-data-table mdl-shadow--2dp"&gt;<br/>    &lt;thead&gt;<br/>      &lt;tr&gt;<br/>        &lt;th class="mdl-data-table__cell--non-numeric"&gt;Item Name&lt;/th&gt;<br/>        &lt;th class="mdl-data-table__cell--non-numeric"&gt;Cost&lt;/th&gt;<br/>        &lt;th class="mdl-data-table__cell--non-numeric"&gt;Quantity&lt;/th&gt;<br/>        &lt;th class="mdl-data-table__cell"&gt;Sub-total&lt;/th&gt;<br/>        &lt;th class="mdl-data-table__cell--non-numeric"&gt;<br/>          &lt;button class="mdl-button mdl-js-button mdl-button--icon"&gt;<br/>            &lt;i class="material-icons"&gt;delete&lt;/i&gt;<br/>          &lt;/button&gt;<br/>        &lt;/th&gt;<br/>      &lt;/tr&gt;<br/>    &lt;/thead&gt;<br/>    &lt;tbody&gt;</span><span id="a687" class="lv kl hu lq b fv ma lx l ly lz">    &lt;/tbody&gt;<br/>  &lt;/table&gt;<br/>&lt;/div&gt;<br/>&lt;div class="mdl-grid center-items"&gt;<br/>  &lt;div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"&gt;<br/>    &lt;input class="mdl-textfield__input" type="number" id="total-cost" readonly value="0"&gt;<br/>    &lt;label class="mdl-textfield__label" for="cost"&gt;Total Item Cost&lt;/label&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</span><span id="5d23" class="lv kl hu lq b fv ma lx l ly lz">&lt;script id="item-row" type="text/template"&gt;<br/>  &lt;tr id='{{row-id}}'&gt;      <br/>    &lt;td class="mdl-data-table__cell--non-numeric"&gt;{{name}}&lt;/td&gt;<br/>    &lt;td class="mdl-data-table__cell--non-numeric"&gt;{{cost}}&lt;/td&gt;<br/>    &lt;td class="mdl-data-table__cell--non-numeric"&gt;{{quantity}}&lt;/td&gt;<br/>    &lt;td class="mdl-data-table__cell"&gt;{{subTotal}}&lt;/td&gt;<br/>    &lt;td class="mdl-data-table__cell--non-numeric"&gt;<br/>          &lt;button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored"<br/>          onclick="pageEvents.deleteItem('{{item-id}}')"&gt;<br/>          &lt;i class="material-icons"&gt;remove&lt;/i&gt;<br/>          &lt;/button&gt;<br/>    &lt;/td&gt;<br/>  &lt;/tr&gt;<br/>&lt;/script&gt;</span></pre><p id="e452" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在上面的标记中，我使用了微模板，因为表格将包含动态数据，我想用真实数据替换一些占位符，并将其附加到DOM。</p><p id="8950" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">下面是添加项目时在UI中显示项目的代码:</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="5a4d" class="lv kl hu lq b fv lw lx l ly lz">function addItemToPage(item) {<br/>  if (document.getElementById(item._id)) return;<br/>  let template = document.querySelector("#item-row").innerHTML;<br/>  template = template.replace("{{name}}", item.name);<br/>  template = template.replace("{{cost}}", item.cost);<br/>  template = template.replace("{{quantity}}", item.quantity);<br/>  template = template.replace("{{subTotal}}", item.subTotal);<br/>  template = template.replace("{{row-id}}", item._id);<br/>  template = template.replace("{{item-id}}", item._id);<br/>  document.getElementById("item-table").tBodies[0].innerHTML += template;</span><span id="b4ac" class="lv kl hu lq b fv ma lx l ly lz">  let totalCost = Number.parseFloat(<br/>    document.getElementById("total-cost").value<br/>  );</span><span id="291a" class="lv kl hu lq b fv ma lx l ly lz">  document.getElementById("total-cost").value = totalCost + item.subTotal;<br/>}</span><span id="14d4" class="lv kl hu lq b fv ma lx l ly lz">hoodie.store.withIdPrefix("item").on("add", addItemToPage);</span></pre><p id="c18c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在上面的代码块中，它从DOM获取脚本模板，用实际数据替换占位符，然后将其附加到DOM。总成本也会计算出来并显示在用户界面上。</p><h1 id="7ced" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">Vue替代方案</h1><p id="8a9f" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated">过渡到Vue我从页面中移除了脚本模板，并更新了table元素以使用Vue的<code class="eh ln lo lp lq b">v-for</code>指令，该指令将遍历包含项目的数据属性。下面是标记</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="8ace" class="lv kl hu lq b fv lw lx l ly lz">&lt;div class="mdl-grid center-items"&gt;<br/>  &lt;table id="item-table" class="mdl-data-table mdl-js-data-table mdl-shadow--2dp"&gt;<br/>    &lt;thead&gt;<br/>      &lt;tr&gt;<br/>        &lt;th class="mdl-data-table__cell--non-numeric"&gt;Item Name&lt;/th&gt;<br/>        &lt;th class="mdl-data-table__cell--non-numeric"&gt;Cost&lt;/th&gt;<br/>        &lt;th class="mdl-data-table__cell--non-numeric"&gt;Quantity&lt;/th&gt;<br/>        &lt;th class="mdl-data-table__cell"&gt;Sub-total&lt;/th&gt;<br/>        &lt;th class="mdl-data-table__cell--non-numeric"&gt;<br/>          &lt;button class="mdl-button mdl-js-button mdl-button--icon"&gt;<br/>            &lt;i class="material-icons"&gt;delete&lt;/i&gt;<br/>          &lt;/button&gt;<br/>        &lt;/th&gt;<br/>      &lt;/tr&gt;</span><span id="edd6" class="lv kl hu lq b fv ma lx l ly lz">    &lt;/thead&gt;<br/>    &lt;tbody&gt;<br/>      &lt;tr v-for="item in items" :key="item._id"&gt;<br/>        &lt;td class="mdl-data-table__cell--non-numeric"&gt;{{ item.name}}&lt;/td&gt;<br/>        &lt;td class="mdl-data-table__cell--non-numeric"&gt;{{ item.cost}}&lt;/td&gt;<br/>        &lt;td class="mdl-data-table__cell--non-numeric"&gt;{{ item.quantity}}&lt;/td&gt;<br/>        &lt;td class="mdl-data-table__cell"&gt;{{ item.subTotal}}&lt;/td&gt;<br/>        &lt;td class="mdl-data-table__cell--non-numeric"&gt;<br/>          &lt;button @click="deleteRow(item._id)" class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored"&gt;<br/>            &lt;i class="material-icons"&gt;remove&lt;/i&gt;<br/>          &lt;/button&gt;<br/>        &lt;/td&gt;<br/>      &lt;/tr&gt;<br/>    &lt;/tbody&gt;<br/>  &lt;/table&gt;<br/>&lt;/div&gt;</span><span id="a3f3" class="lv kl hu lq b fv ma lx l ly lz">&lt;div class="mdl-grid center-items"&gt;<br/>  &lt;div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label"&gt;<br/>    &lt;!-- &lt;input class="mdl-textfield__input" type="number" id="total-cost" readonly value="0"&gt;<br/>    &lt;label class="mdl-textfield__label" for="cost"&gt;Total Item Cost&lt;/label&gt; --&gt;<br/>    &lt;h4&gt;Total Cost: {{ total }}&lt;/h4&gt;<br/>  &lt;/div&gt;</span><span id="0d59" class="lv kl hu lq b fv ma lx l ly lz">&lt;/div&gt;</span></pre><p id="f225" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在标记上没有很大的变化。我从之前的微模板中复制了内容，并使用了Vue指令和文本插值。我使用<code class="eh ln lo lp lq b">v-for</code>指令来呈现将从名为<code class="eh ln lo lp lq b">items</code>的数据属性中获取的项目列表。各列使用Vue的文本插值<code class="eh ln lo lp lq b">{{ item.name }}</code>渲染数据。这类似于我们在微模板中使用的占位符。总计使用文本插值显示在页面上。</p><p id="034d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">更新<code class="eh ln lo lp lq b">index-vue.js</code>中的JavaScript代码将会得到如下结果:</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="9269" class="lv kl hu lq b fv lw lx l ly lz">const vm = new Vue({<br/>  el: "#app",<br/>  data: {<br/>    name: "",<br/>    cost: "",<br/>    quantity: "",<br/>    items: []<br/>  },<br/>  computed: {<br/>    // a computed getter<br/>    total: function() {<br/>      // `this` points to the vm instance<br/>      return this.items.reduce(<br/>        (accumulator, currentValue) =&gt; accumulator + currentValue.subTotal,<br/>        0<br/>      );<br/>    }<br/>  },<br/>  methods: {<br/>    .....<br/>  }<br/>});</span><span id="dbff" class="lv kl hu lq b fv ma lx l ly lz">hoodie.store.withIdPrefix("item").on("add", item =&gt; vm.items.push(item));</span></pre><p id="cd6f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Vue改编要短得多，也简单得多。我在上面的代码中做的是添加一个数据属性<code class="eh ln lo lp lq b">items</code>，这是前面看到的<code class="eh ln lo lp lq b">v-for</code>指令中使用的。当一个项目被添加时，Hoodie会调用运行<code class="eh ln lo lp lq b">vm.items.push(item)</code>的函数来更新状态，而Vue的反应系统会自动更新用户界面。要计算总数，不需要跟踪DOM中的项目。我使用了一个在<code class="eh ln lo lp lq b">items</code>上运行reduce函数的计算属性。现在，有了Vue的反应式系统，只要这些值发生变化，UI就会更新。这里的好处是我不必担心代码中的DOM操作。因此，在更少的代码行中，我们实现了使用普通JS时需要更多代码的目标(我认为jQuery也是如此)。</p><h1 id="2375" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">将项目保存为列表</h1><p id="0362" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated">添加商品后，我想保存它们供以后参考，并能够添加另一个购物商品列表。我有一个按钮<code class="eh ln lo lp lq b">Save List</code>,它将收集项目，保存为一组带有帽衫的项目，并允许用户添加新的项目集。</p><p id="163d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">普通的JS版本将按钮绑定到一个click事件。下面是使它工作的标记和代码</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="4149" class="lv kl hu lq b fv lw lx l ly lz">//index.html<br/>&lt;div class="mdl-grid center-items"&gt;<br/>  &lt;button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" onclick="pageEvents.saveList()"&gt;<br/>    Save List<br/>  &lt;/button&gt;<br/>&lt;/div&gt;</span><span id="def2" class="lv kl hu lq b fv ma lx l ly lz">//index.js<br/>function saveList() {<br/>  let cost = 0;</span><span id="fee6" class="lv kl hu lq b fv ma lx l ly lz">  hoodie.store<br/>    .withIdPrefix("item")<br/>    .findAll()<br/>    .then(function(items) {<br/>      for (var item of items) {<br/>        cost += item.subTotal;<br/>      }</span><span id="45ed" class="lv kl hu lq b fv ma lx l ly lz">      //store the list<br/>      hoodie.store.withIdPrefix("list").add({<br/>        cost: cost,<br/>        items: items<br/>      });</span><span id="d029" class="lv kl hu lq b fv ma lx l ly lz">      //delete the items<br/>      hoodie.store<br/>        .withIdPrefix("item")<br/>        .remove(items)<br/>        .then(function() {<br/>          //clear the table<br/>          document.getElementById("item-table").tBodies[0].innerHTML = "";</span><span id="71d5" class="lv kl hu lq b fv ma lx l ly lz">          //notify the user<br/>          var snackbarContainer = document.querySelector("#toast");<br/>          snackbarContainer.MaterialSnackbar.showSnackbar({<br/>            message: "List saved succesfully"<br/>          });<br/>        })<br/>        .catch(function(error) {<br/>          //notify the user<br/>          var snackbarContainer = document.querySelector("#toast");<br/>          snackbarContainer.MaterialSnackbar.showSnackbar({<br/>            message: error.message<br/>          });<br/>        });<br/>    });<br/>}</span><span id="c0ad" class="lv kl hu lq b fv ma lx l ly lz">window.pageEvents = {<br/>  deleteItem: deleteItem,<br/>  saveList: saveList<br/>  ....<br/>};</span></pre><h1 id="56cc" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">Vue替代方案</h1><p id="5800" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated">切换到Vue并不需要太多的区别。我仍然必须绑定到一个click事件，并在初始化期间将事件处理程序方法添加到Vue options对象的methods属性中。</p><p id="0bb3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">下面是它的标记:</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="73f6" class="lv kl hu lq b fv lw lx l ly lz">&lt;div class="mdl-grid center-items"&gt;<br/>  &lt;button @click="saveList" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored"&gt;<br/>    Save List<br/>  &lt;/button&gt;<br/>&lt;/div&gt;</span></pre><p id="3495" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh ln lo lp lq b">@click="saveList"</code>是<code class="eh ln lo lp lq b">v-on:click=saveList"</code>的简写，用于监听DOM事件。普通JS版本中相同的<code class="eh ln lo lp lq b">saveList</code>函数被添加到Vue对象的methods属性中。</p><h1 id="f45a" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">导航栏</h1><p id="9f7a" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated">既然物品可以保存为列表，我希望看到一段时间内每个列表的总成本的历史记录。它将在另一页，看起来像下图所示</p><figure class="kg kh ki kj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kf"><img src="../Images/63ea5a6f32bfc38566354363203974fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*v8o1D8VghiJrrF89.png"/></div></div></figure><p id="d287" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个页面在<code class="eh ln lo lp lq b">public/history.html</code>中有标记，在<code class="eh ln lo lp lq b">public/js/src/history.js</code>中有控制页面的代码。这个页面与顶部的导航栏<code class="eh ln lo lp lq b">index.html</code>有一些相同的代码。导航栏包含不同页面的链接，点击时会弹出登录或注册对话框的<code class="eh ln lo lp lq b">Login</code>和<code class="eh ln lo lp lq b">Register</code>链接，以及<code class="eh ln lo lp lq b">Signout</code>按钮。</p><p id="8541" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在使用普通JS的应用程序版本中，我在两个页面中复制了相同的HTML标记。下面是导航栏的标记:</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="71f3" class="lv kl hu lq b fv lw lx l ly lz">&lt;header class="mdl-layout__header"&gt;<br/>    &lt;div class="mdl-layout__header-row"&gt;<br/>    &lt;!-- Title --&gt;<br/>    &lt;span class="mdl-layout-title"&gt;Shopping List&lt;/span&gt;<br/>    &lt;!-- Add spacer, to align navigation to the right --&gt;<br/>    &lt;div class="mdl-layout-spacer"&gt;&lt;/div&gt;<br/>    &lt;!-- Navigation. We hide it in small screens. --&gt;<br/>    &lt;nav class="mdl-navigation mdl-layout--large-screen-only"&gt;<br/>        &lt;a class="mdl-navigation__link" href="index.html"&gt;Home&lt;/a&gt;<br/>        &lt;a class="mdl-navigation__link" href="history.html"&gt;History&lt;/a&gt;<br/>        &lt;a onclick="pageEvents.showLogin()" style="cursor: pointer" class="mdl-navigation__link login"&gt;Login&lt;/a&gt;<br/>        &lt;a onclick="pageEvents.showRegister()" style="cursor: pointer" class="mdl-navigation__link register"&gt;Register&lt;/a&gt;<br/>        &lt;a onclick="pageEvents.signout()" style="cursor: pointer" class="mdl-navigation__link logout"&gt;Logout&lt;/a&gt;<br/>    &lt;/nav&gt;<br/>    &lt;/div&gt;<br/>&lt;/header&gt;<br/>&lt;div class="mdl-layout__drawer"&gt;<br/>    &lt;span class="mdl-layout-title"&gt;Shopping List&lt;/span&gt;<br/>    &lt;nav class="mdl-navigation"&gt;<br/>    &lt;a class="mdl-navigation__link" href="index.html"&gt;Home&lt;/a&gt;<br/>    &lt;a class="mdl-navigation__link" href="history.html"&gt;History&lt;/a&gt;<br/>    &lt;a onclick="pageEvents.showLogin()" style="cursor: pointer" class="mdl-navigation__link login"&gt;Login&lt;/a&gt;<br/>    &lt;a onclick="pageEvents.showRegister()" style="cursor: pointer" class="mdl-navigation__link register"&gt;Register&lt;/a&gt;<br/>    &lt;a onclick="pageEvents.signout()" style="cursor: pointer" class="mdl-navigation__link logout"&gt;Logout&lt;/a&gt;<br/>    &lt;/nav&gt;<br/>&lt;/div&gt;</span></pre><p id="915f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">从标记中可以看到，当单击登录、注册和注销的链接时，它们调用各自的方法。这些页面事件处理程序在<code class="eh ln lo lp lq b">index.js</code>中定义</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="591d" class="lv kl hu lq b fv lw lx l ly lz">import * as shared from "shared.js";</span><span id="e3ff" class="lv kl hu lq b fv ma lx l ly lz">....</span><span id="1b01" class="lv kl hu lq b fv ma lx l ly lz">shared.updateDOMLoginStatus();<br/>window.pageEvents = {<br/>  showLogin: shared.showLoginDialog,<br/>  showRegister: shared.showRegisterDialog,<br/>  signout: shared.signOut<br/>};</span><span id="d403" class="lv kl hu lq b fv ma lx l ly lz">The actual functions that gets called are defined in `shared.js`. Below are the functions in `shared.js` responsible for the navigation bar:<br/></span><span id="a09b" class="lv kl hu lq b fv ma lx l ly lz">//register dialog element<br/>let loginDialog = document.querySelector("#login-dialog");<br/>dialogPolyfill.registerDialog(loginDialog);<br/>let registerDialog = document.querySelector("#register-dialog");<br/>dialogPolyfill.registerDialog(registerDialog);</span><span id="5f54" class="lv kl hu lq b fv ma lx l ly lz">let showLoginDialog = function() {<br/>  loginDialog.showModal();<br/>};</span><span id="b2d3" class="lv kl hu lq b fv ma lx l ly lz">let showRegisterDialog = function() {<br/>  registerDialog.showModal();<br/>};</span><span id="1a52" class="lv kl hu lq b fv ma lx l ly lz">let showAnonymous = function() {<br/>  document.getElementsByClassName("login")[0].style.display = "inline";<br/>  document.getElementsByClassName("login")[1].style.display = "inline";<br/>  document.getElementsByClassName("register")[0].style.display = "inline";<br/>  document.getElementsByClassName("register")[1].style.display = "inline";<br/>  document.getElementsByClassName("logout")[0].style.display = "none";<br/>  document.getElementsByClassName("logout")[1].style.display = "none";<br/>};</span><span id="fb9c" class="lv kl hu lq b fv ma lx l ly lz">let showLoggedIn = function() {<br/>  document.getElementsByClassName("login")[0].style.display = "none";<br/>  document.getElementsByClassName("login")[1].style.display = "none";<br/>  document.getElementsByClassName("register")[0].style.display = "none";<br/>  document.getElementsByClassName("register")[1].style.display = "none";<br/>  document.getElementsByClassName("logout")[0].style.display = "inline";<br/>  document.getElementsByClassName("logout")[1].style.display = "inline";<br/>};</span><span id="010b" class="lv kl hu lq b fv ma lx l ly lz">let updateDOMLoginStatus = () =&gt; {<br/>  hoodie.account.get("session").then(function(session) {<br/>    if (!session) {<br/>      // user is singed out<br/>      showAnonymous();<br/>    } else if (session.invalid) {<br/>      // user is signed in, but session is no longer authenticated<br/>      showAnonymous();<br/>    } else {<br/>      // user is signed in<br/>      showLoggedIn();<br/>    }<br/>  });<br/>};</span><span id="264b" class="lv kl hu lq b fv ma lx l ly lz">let signOut = function() {<br/>  hoodie.account<br/>    .signOut()<br/>    .then(function() {<br/>      showAnonymous();<br/>      let snackbarContainer = document.querySelector("#toast");<br/>      snackbarContainer.MaterialSnackbar.showSnackbar({<br/>        message: "You logged out"<br/>      });<br/>      location.href = location.origin;<br/>    })<br/>    .catch(function() {<br/>      let snackbarContainer = document.querySelector("#toast");<br/>      snackbarContainer.MaterialSnackbar.showSnackbar({<br/>        message: "Could not logout"<br/>      });<br/>    });<br/>};</span><span id="55d1" class="lv kl hu lq b fv ma lx l ly lz">export {<br/>  signOut,<br/>  showRegisterDialog,<br/>  showLoginDialog,<br/>  updateDOMLoginStatus<br/>};</span></pre><p id="3d3d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这段代码导出了在<code class="eh ln lo lp lq b">index.js</code>中使用的函数。<code class="eh ln lo lp lq b">showLoginDialog()</code>和<code class="eh ln lo lp lq b">showRegisterDialog()</code>功能分别显示登录和注册模式。<code class="eh ln lo lp lq b">signout()</code>功能将用户注销并调用<code class="eh ln lo lp lq b">showAnonymous()</code>，隐藏<code class="eh ln lo lp lq b">Logout</code>链接，仅显示<code class="eh ln lo lp lq b">Register</code>和<code class="eh ln lo lp lq b">Login</code>链接。函数<code class="eh ln lo lp lq b">updateDOMLoginStatus</code>检查用户是否通过验证，并显示适当的链接。这个函数在页面加载时被调用。</p><p id="c1d2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">实现共享导航栏需要复制标记和查询DOM元素，并应用CSS来显示和隐藏导航栏中的链接。我们来看看Vue的替代方案。</p><h1 id="002e" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">Vue备选方案</h1><p id="29d9" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated">许多web应用程序都有跨页面相同的部分，例如导航标题。这些应该被抽象成某种容器或组件。Vue提供了所谓的组件，可以用来解决这个例子中导航栏的问题。Vue组件是独立的，可重复使用。</p><p id="de25" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">转到Vue组件，我创建了一个新文件<code class="eh ln lo lp lq b">shared-vue.js</code>。在它里面，我为导航栏定义了一个Vue组件，如下所示:</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="1ba3" class="lv kl hu lq b fv lw lx l ly lz">Vue.component("navigation", {<br/>  props: ["isLoggedIn", "toggleLoggedIn"],<br/>  template: `&lt;div&gt;<br/>              &lt;header class="mdl-layout__header"&gt;<br/>        &lt;div class="mdl-layout__header-row"&gt;<br/>          &lt;!-- Title --&gt;<br/>          &lt;span class="mdl-layout-title"&gt;Shopping List&lt;/span&gt;<br/>          &lt;!-- Add spacer, to align navigation to the right --&gt;<br/>          &lt;div class="mdl-layout-spacer"&gt;&lt;/div&gt;<br/>          &lt;!-- Navigation. We hide it in small screens. --&gt;<br/>          &lt;nav class="mdl-navigation mdl-layout--large-screen-only"&gt;<br/>            &lt;a class="mdl-navigation__link" href="index.html"&gt;Home&lt;/a&gt;<br/>            &lt;a class="mdl-navigation__link" href="history.html"&gt;History&lt;/a&gt;<br/>            &lt;a v-show="!isLoggedIn" @click="showLogin" style="cursor: pointer" class="mdl-navigation__link login"&gt;Login&lt;/a&gt;<br/>            &lt;a v-show="!isLoggedIn" @click="showRegister" style="cursor: pointer" class="mdl-navigation__link register"&gt;Register&lt;/a&gt;<br/>            &lt;a v-show="isLoggedIn" @click="logout" style="cursor: pointer" class="mdl-navigation__link logout"&gt;Logout&lt;/a&gt;<br/>          &lt;/nav&gt;<br/>        &lt;/div&gt;<br/>      &lt;/header&gt;<br/>      &lt;div class="mdl-layout__drawer"&gt;<br/>        &lt;span class="mdl-layout-title"&gt;Shopping List&lt;/span&gt;<br/>        &lt;nav class="mdl-navigation"&gt;<br/>          &lt;a class="mdl-navigation__link" href="index.html"&gt;Home&lt;/a&gt;<br/>          &lt;a class="mdl-navigation__link" href="history.html"&gt;History&lt;/a&gt;<br/>          &lt;a v-show="!isLoggedIn" @click="showLogin" style="cursor: pointer" class="mdl-navigation__link login"&gt;Login&lt;/a&gt;<br/>          &lt;a v-show="!isLoggedIn" @click="showRegister" style="cursor: pointer" class="mdl-navigation__link register"&gt;Register&lt;/a&gt;<br/>          &lt;a v-show="isLoggedIn" @click="logout" style="cursor: pointer" class="mdl-navigation__link logout"&gt;Logout&lt;/a&gt;<br/>        &lt;/nav&gt;<br/>      &lt;/div&gt;<br/>            &lt;/div&gt;`,<br/>  methods: {<br/>    showLogin: function() {<br/>      const loginDialog = document.querySelector("#login-dialog");<br/>      dialogPolyfill.registerDialog(loginDialog);<br/>      loginDialog.showModal();<br/>    },<br/>    showRegister: function() {<br/>      const registerDialog = document.querySelector("#register-dialog");<br/>      dialogPolyfill.registerDialog(registerDialog);<br/>      registerDialog.showModal();<br/>    },<br/>    logout: function() {<br/>      hoodie.account<br/>        .signOut()<br/>        .then(() =&gt; {<br/>          this.toggleLoggedIn();<br/>        })<br/>        .catch(error =&gt; {<br/>          alert("Could not logout");<br/>        });<br/>    }<br/>  }<br/>});</span></pre><p id="7ee9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在上面的代码中，我们用一个选项对象注册了一个名为<code class="eh ln lo lp lq b">navigation</code>的Vue组件，该对象类似于我们在创建Vue实例时使用的对象。第一个属性是<a class="ae jg" href="https://vuejs.org/v2/guide/components.html#Passing-Data-to-Child-Components-with-Props" rel="noopener ugc nofollow" target="_blank"> <strong class="jj hv">道具</strong> </a> <strong class="jj hv">。</strong> Props是一种向组件传递数据的方式。一个组件可以定义它自己的数据，但是如果一个应用程序状态需要在不同的组件中使用，就要使用props。<code class="eh ln lo lp lq b">isLoggedIn</code> props保存一个布尔值，显示用户是否通过验证。</p><p id="8975" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">第二个属性<code class="eh ln lo lp lq b">template</code>包含将在页面中显示的标记。除了我们使用了两个Vue指令，<code class="eh ln lo lp lq b">v-show</code>和<code class="eh ln lo lp lq b">@click</code>之外，该标记几乎与上一节中的普通JS替代方法完全一样。<code class="eh ln lo lp lq b">v-show</code>属性用于条件渲染。这里我告诉它当<code class="eh ln lo lp lq b">isLoggedIn</code>为真时显示<code class="eh ln lo lp lq b">Logout</code>链接，或者当它为假时显示<code class="eh ln lo lp lq b">Login</code>和<code class="eh ln lo lp lq b">Register</code>链接。Vue还提供了用于条件渲染的<code class="eh ln lo lp lq b">v-if</code>和<code class="eh ln lo lp lq b">v-else</code>，你可以在这里阅读关于它们的更多信息<a class="ae jg" href="https://vuejs.org/v2/guide/conditional.html" rel="noopener ugc nofollow" target="_blank">。属性是<code class="eh ln lo lp lq b">v-on:click</code>指令的简写。我已经将<code class="eh ln lo lp lq b">showLogin</code>、<code class="eh ln lo lp lq b">showRegister</code>和<code class="eh ln lo lp lq b">logout</code>设置为各个链接的点击事件的事件处理程序。</a></p><p id="c4e4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这些函数在methods属性中定义。成功注销后的<code class="eh ln lo lp lq b">logout</code>函数调用传递给该组件的道具<code class="eh ln lo lp lq b">this.toggleLoggedIn()</code>。这将执行传递给props的函数，并且预计会改变<code class="eh ln lo lp lq b">isLoggedIn</code> props的值，这是该组件不能修改的。当它改变时，Vue的反应系统会相应地更新DOM。</p><p id="cd71" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">该组件作为自定义元素添加到<code class="eh ln lo lp lq b">index.html</code>中。我将删除第59行到第84行的导航栏标记，并替换为以下内容</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="95ae" class="lv kl hu lq b fv lw lx l ly lz">&lt;navigation v-bind:is-logged-in="isLoggedIn" v-bind:toggle-logged-in="toggleLoggedIn"&gt;&lt;/navigation&gt;</span></pre><p id="9cd1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在JavaScript代码中，我们声明了props <code class="eh ln lo lp lq b">isLoggedIn</code>和<code class="eh ln lo lp lq b">toggleLoggedIn</code>，但是当传递props时，这些值使用它们的kebab大小写的等价物。这是因为HTML属性不区分大小写。我已经使用了<code class="eh ln lo lp lq b">v-bind</code>指令来动态传递这些属性的值。如果没有这个指令，它将作为一个静态值被传递，组件将接收字符串<code class="eh ln lo lp lq b">isLoggedIn</code>而不是一个布尔值。我们也可以用简写的<code class="eh ln lo lp lq b">:</code>来代替<code class="eh ln lo lp lq b">v-bind</code>，它也可以重写为<code class="eh ln lo lp lq b">&lt;navigation :is-logged-in="isLoggedIn" :toggle-logged-in="toggleLoggedIn"&gt;&lt;/navigation&gt;</code></p><p id="d255" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">值<code class="eh ln lo lp lq b">isLoggedIn</code>是应用状态，<code class="eh ln lo lp lq b">toggleLoggedIn</code>是在<code class="eh ln lo lp lq b">index-vue.js</code>中的Vue实例中声明的方法，如下所示</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="0b64" class="lv kl hu lq b fv lw lx l ly lz">const vm = new Vue({<br/>  el: "#app",<br/>  data: {<br/>    name: "",<br/>    cost: "",<br/>    quantity: "",<br/>    items: [],<br/>    isLoggedIn: false<br/>  },<br/>  computed: {<br/>    .....//collapsed code<br/>  },<br/>  methods: {<br/>    toggleLoggedIn: function() {<br/>      this.isLoggedIn = !this.isLoggedIn;<br/>    },<br/>    ......//collapsed code<br/>  }<br/>});</span><span id="dbe8" class="lv kl hu lq b fv ma lx l ly lz">.....//collapsed code</span><span id="1133" class="lv kl hu lq b fv ma lx l ly lz">hoodie.account.get("session").then(function(session) {<br/>  if (!session) {<br/>    // user is singed out<br/>    vm.isLoggedIn = false;<br/>  } else if (session.invalid) {<br/>    vm.isLoggedIn = false;<br/>  } else {<br/>    // user is signed in<br/>    vm.isLoggedIn = true;<br/>  }<br/>});</span></pre><p id="432b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">使用Vue替代方案，我已经消除了重复的标记，如果将来我需要对它进行任何更改，我将从一个位置完成，这是使用Vue组件完成的。我不再需要遍历/查询DOM来根据身份验证状态选择显示或隐藏哪些元素。</p><h1 id="7a2c" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">登录对话框</h1><p id="2c26" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated"><code class="eh ln lo lp lq b">Login</code>和<code class="eh ln lo lp lq b">Register</code>链接显示了一个允许用户输入用户名和密码进行认证的模式。两者的标记都像导航栏一样跨页面复制。这可以在<code class="eh ln lo lp lq b">index.html</code>的第171至244行和<code class="eh ln lo lp lq b">history.html</code>的第100至158行中看到。</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="b23c" class="lv kl hu lq b fv lw lx l ly lz">&lt;dialog id="login-dialog" class="mdl-dialog"&gt;<br/>  &lt;h4 class="mdl-dialog__title"&gt;Login&lt;/h4&gt;<br/>  &lt;div class="mdl-dialog__content"&gt;<br/>    &lt;div class="mdl-grid center-items"&gt;<br/>      &lt;!-- Simple Textfield --&gt;<br/>      &lt;div class="mdl-textfield mdl-js-textfield"&gt;<br/>        &lt;input class="mdl-textfield__input" type="text" id="login-username"&gt;<br/>        &lt;label class="mdl-textfield__label" for="login-username"&gt;Username&lt;/label&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="mdl-grid center-items"&gt;<br/>      &lt;!-- Simple Textfield --&gt;<br/>      &lt;div class="mdl-textfield mdl-js-textfield"&gt;<br/>        &lt;input class="mdl-textfield__input" type="password" id="login-password"&gt;<br/>        &lt;label class="mdl-textfield__label" for="login-password"&gt;Password&lt;/label&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="mdl-grid center-items"&gt;<br/>      &lt;!-- Simple Textfield --&gt;<br/>      &lt;div class="mdl-textfield mdl-js-textfield"&gt;<br/>        &lt;span id="login-error"&gt;&lt;/span&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="mdl-dialog__actions"&gt;<br/>    &lt;button onclick="pageEvents.closeLogin()" type="button" class="mdl-button close"&gt;Cancel&lt;/button&gt;<br/>    &lt;button onclick="pageEvents.login()" type="button" class="mdl-button"&gt;Login&lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/dialog&gt;</span><span id="2833" class="lv kl hu lq b fv ma lx l ly lz">&lt;dialog id="register-dialog" class="mdl-dialog"&gt;<br/>  &lt;h4 class="mdl-dialog__title"&gt;Login&lt;/h4&gt;<br/>  &lt;div class="mdl-dialog__content"&gt;<br/>    &lt;div class="mdl-grid center-items"&gt;<br/>      &lt;!-- Simple Textfield --&gt;<br/>      &lt;div class="mdl-textfield mdl-js-textfield"&gt;<br/>        &lt;input class="mdl-textfield__input" type="text" id="register-username"&gt;<br/>        &lt;label class="mdl-textfield__label" for="register-username"&gt;Username&lt;/label&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="mdl-grid center-items"&gt;<br/>      &lt;!-- Simple Textfield --&gt;<br/>      &lt;div class="mdl-textfield mdl-js-textfield"&gt;<br/>        &lt;input class="mdl-textfield__input" type="password" id="register-password"&gt;<br/>        &lt;label class="mdl-textfield__label" for="register-password"&gt;Password&lt;/label&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>    &lt;div class="mdl-grid center-items"&gt;<br/>      &lt;!-- Simple Textfield --&gt;<br/>      &lt;div class="mdl-textfield mdl-js-textfield"&gt;<br/>        &lt;span id="register-error"&gt;&lt;/span&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>  &lt;div class="mdl-dialog__actions"&gt;<br/>    &lt;button onclick="pageEvents.closeRegister()" type="button" class="mdl-button close"&gt;Cancel&lt;/button&gt;<br/>    &lt;button onclick="pageEvents.register()" type="button" class="mdl-button"&gt;Register&lt;/button&gt;<br/>  &lt;/div&gt;<br/>&lt;/dialog&gt;</span></pre><p id="1176" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">处理登录和注册的代码在<code class="eh ln lo lp lq b">shared.js</code>中定义，并在<code class="eh ln lo lp lq b">index.js</code>中使用</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="f590" class="lv kl hu lq b fv lw lx l ly lz">//shared.js</span><span id="804f" class="lv kl hu lq b fv ma lx l ly lz">//register dialog element<br/>let loginDialog = document.querySelector("#login-dialog");<br/>dialogPolyfill.registerDialog(loginDialog);<br/>let registerDialog = document.querySelector("#register-dialog");<br/>dialogPolyfill.registerDialog(registerDialog);</span><span id="62c7" class="lv kl hu lq b fv ma lx l ly lz">let closeLoginDialog = function() {<br/>  loginDialog.close();<br/>};</span><span id="82fe" class="lv kl hu lq b fv ma lx l ly lz">let closeRegisterDialog = function() {<br/>  registerDialog.close();<br/>};</span><span id="895b" class="lv kl hu lq b fv ma lx l ly lz">let showAnonymous = function() {<br/>  ...<br/>};</span><span id="7f7b" class="lv kl hu lq b fv ma lx l ly lz">let showLoggedIn = function() {<br/>  ....<br/>};</span><span id="ebdd" class="lv kl hu lq b fv ma lx l ly lz">let signOut = function() {<br/>  ....<br/>};</span><span id="2771" class="lv kl hu lq b fv ma lx l ly lz">let updateDOMLoginStatus = () =&gt; {<br/>  ....<br/>};</span><span id="9ce3" class="lv kl hu lq b fv ma lx l ly lz">let login = function() {<br/>  let username = document.querySelector("#login-username").value;<br/>  let password = document.querySelector("#login-password").value;</span><span id="7828" class="lv kl hu lq b fv ma lx l ly lz">  hoodie.account<br/>    .signIn({<br/>      username: username,<br/>      password: password<br/>    })<br/>    .then(function() {<br/>      showLoggedIn();<br/>      closeLoginDialog();</span><span id="eedc" class="lv kl hu lq b fv ma lx l ly lz">      let snackbarContainer = document.querySelector("#toast");<br/>      snackbarContainer.MaterialSnackbar.showSnackbar({<br/>        message: "You logged in"<br/>      });<br/>    })<br/>    .catch(function(error) {<br/>      console.log(error);<br/>      document.querySelector("#login-error").innerHTML = error.message;<br/>    });<br/>};</span><span id="ff39" class="lv kl hu lq b fv ma lx l ly lz">let register = function() {<br/>  let username = document.querySelector("#register-username").value;<br/>  let password = document.querySelector("#register-password").value;<br/>  let options = { username: username, password: password };</span><span id="f9cd" class="lv kl hu lq b fv ma lx l ly lz">  hoodie.account<br/>    .signUp(options)<br/>    .then(function(account) {<br/>      return hoodie.account.signIn(options);<br/>    })<br/>    .then(account =&gt; {<br/>      showLoggedIn();<br/>      closeRegisterDialog();<br/>      return account;<br/>    })<br/>    .catch(function(error) {<br/>      console.log(error);<br/>      document.querySelector("#register-error").innerHTML = error.message;<br/>    });<br/>};</span><span id="0c2c" class="lv kl hu lq b fv ma lx l ly lz">export {<br/>  register,<br/>  login,<br/>  closeRegisterDialog,<br/>  closeLoginDialog,<br/>  ...<br/>};</span></pre><p id="bb18" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> index.js </strong></p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="d3c7" class="lv kl hu lq b fv lw lx l ly lz">//index.js</span><span id="5eef" class="lv kl hu lq b fv ma lx l ly lz">window.pageEvents = {<br/>  closeLogin: shared.closeLoginDialog,<br/>  showLogin: shared.showLoginDialog,<br/>  closeRegister: shared.closeRegisterDialog,<br/>  showRegister: shared.showRegisterDialog,<br/>  login: shared.login,<br/>  register: shared.register,<br/>  signout: shared.signOut<br/>};</span></pre><h1 id="a14b" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">Vue备选方案</h1><p id="27dd" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated">当切换到Vue时，我为登录和注册组件使用了单独的组件。下面是登录对话框的组件注册</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="a15c" class="lv kl hu lq b fv lw lx l ly lz">Vue.component("login-dialog", {<br/>  data: function() {<br/>    return {<br/>      username: "",<br/>      password: ""<br/>    };<br/>  },<br/>  props: ["toggleLoggedIn"],<br/>  template: `&lt;dialog id="login-dialog" class="mdl-dialog"&gt;<br/>      &lt;h4 class="mdl-dialog__title"&gt;Login&lt;/h4&gt;<br/>      &lt;div class="mdl-dialog__content"&gt;<br/>        &lt;div class="mdl-grid center-items"&gt;<br/>          &lt;!-- Simple Textfield --&gt;<br/>          &lt;div class="mdl-textfield mdl-js-textfield"&gt;<br/>            &lt;input v-model="username" class="mdl-textfield__input" type="text" id="login-username"&gt;<br/>            &lt;label class="mdl-textfield__label" for="login-username"&gt;Username&lt;/label&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>        &lt;div class="mdl-grid center-items"&gt;<br/>          &lt;!-- Simple Textfield --&gt;<br/>          &lt;div class="mdl-textfield mdl-js-textfield"&gt;<br/>            &lt;input v-model="password" class="mdl-textfield__input" type="password" id="login-password"&gt;<br/>            &lt;label class="mdl-textfield__label" for="login-password"&gt;Password&lt;/label&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>        &lt;div class="mdl-grid center-items"&gt;<br/>          &lt;!-- Simple Textfield --&gt;<br/>          &lt;div class="mdl-textfield mdl-js-textfield"&gt;<br/>            &lt;span id="login-error"&gt;&lt;/span&gt;<br/>          &lt;/div&gt;<br/>        &lt;/div&gt;<br/>      &lt;/div&gt;<br/>      &lt;div class="mdl-dialog__actions"&gt;<br/>        &lt;button @click="closeLogin" type="button" class="mdl-button close"&gt;Cancel&lt;/button&gt;<br/>        &lt;button @click="login" type="button" class="mdl-button"&gt;Login&lt;/button&gt;<br/>      &lt;/div&gt;<br/>    &lt;/dialog&gt;`,<br/>  methods: {<br/>    closeLogin: function() {<br/>      const loginDialog = document.querySelector("#login-dialog");<br/>      dialogPolyfill.registerDialog(loginDialog);<br/>      loginDialog.close();<br/>    },<br/>    login: function(event) {<br/>      hoodie.account<br/>        .signIn({<br/>          username: this.username,<br/>          password: this.password<br/>        })<br/>        .then(() =&gt; {<br/>          this.toggleLoggedIn();<br/>          this.closeLogin();<br/>        })<br/>        .catch(error =&gt; {<br/>          console.log(error);<br/>          document.querySelector("#login-error").innerHTML = "Error loggin in";<br/>        });<br/>    }<br/>  }<br/>});</span></pre><p id="793e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">它注册了数据、属性、模板和方法，作为传递给<code class="eh ln lo lp lq b">Vue.component()</code>的选项对象的属性。然后在页面上，我用Vue的自定义元素替换标记</p><pre class="kg kh ki kj fq lr lq ls lt aw lu dt"><span id="57d9" class="lv kl hu lq b fv lw lx l ly lz">//index.html<br/>&lt;login-dialog v-bind:toggle-logged-in="toggleLoggedIn"&gt;&lt;/login-dialog&gt;</span></pre><p id="5ace" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">类似的步骤也适用于我跳过的注册对话框。</p><p id="1069" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为了避免显示重复的Vue语法，我还跳过了显示应用程序的某些部分。如果你想了解我是如何一步一步构建整个应用程序的，请点击这个<a class="ae jg" href="https://www.twilio.com/blog/2018/03/practical-introduction-pwa-node-hoodie-offline-first.html" rel="noopener ugc nofollow" target="_blank">链接</a>。它还解释了一些概念，如<a class="ae jg" href="https://developers.google.com/web/fundamentals/primers/service-workers/" rel="noopener ugc nofollow" target="_blank">服务工作者</a>和<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API" rel="noopener ugc nofollow" target="_blank">推送API。</a></p><h1 id="bc17" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">结论</h1><p id="414b" class="pw-post-body-paragraph jh ji hu jj b jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka lm kc kd ke hn dt translated">到目前为止，我已经向您展示了我在从Vanilla JS迁移到Vue.js时对我的应用程序所做的一些更改。如果您刚刚学会如何使用HTML、CSS和JavaScript(或jQuery)构建web应用程序，那么开始使用Vue并不复杂。您不需要了解ES6或理解任何构建步骤就可以开始。在使用Vue时，我实现了更少的代码重复和更好的代码组织。我只介绍了开始使用Vue需要了解的基本知识，但是当然Vue还有更多。在以后的文章中，我将继续深入探讨更多的概念，并希望分享如何用它构建一个相当复杂的单页面应用程序。</p><p id="05f6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">您可以使用下面的链接在GitHub上找到Vanilla JS和Vue.js应用程序的完整代码。</p><ul class=""><li id="68f6" class="mb mc hu jj b jk jl jo jp js md jw me ka mf ke mg mh mi mj dt translated"><a class="ae jg" href="https://github.com/pmbanugo/shopping-list" rel="noopener ugc nofollow" target="_blank">购物清单—香草JS </a></li><li id="105a" class="mb mc hu jj b jk mk jo ml js mm jw mn ka mo ke mg mh mi mj dt translated"><a class="ae jg" href="https://github.com/pmbanugo/shopping-list-vue" rel="noopener ugc nofollow" target="_blank">购物清单— Vue.js </a></li></ul><blockquote class="mp mq mr"><p id="5360" class="jh ji ms jj b jk jl jm jn jo jp jq jr mt jt ju jv mu jx jy jz mv kb kc kd ke hn dt translated">也在<a class="ae jg" href="https://dev.to/pmbanugo/from-vanillajs-to-vuejs-a-guide-to-vue-essentials-5gii" rel="noopener ugc nofollow" target="_blank">发展到</a>上分享</p></blockquote></div><div class="ab cl mw mx hc my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="hn ho hp hq hr"><p id="d001" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Peter Mbanugo对线下优先感兴趣。他目前的项目是<a class="ae jg" href="https://www.hamoni.tech/" rel="noopener ugc nofollow" target="_blank"><em class="ms">Hamoni Sync</em></a><em class="ms">，一个实时应用状态同步服务。在Twitter上随时可以通过</em><a class="ae jg" href="mailto:p.mbanugo@yahoo.com" rel="noopener ugc nofollow" target="_blank"><em class="ms">p.mbanugo@yahoo.com</em></a><em class="ms">或</em> <a class="ae jg" href="https://twitter.com/p_mbanugo" rel="noopener ugc nofollow" target="_blank"> <em class="ms"> @p_mbanugo联系到他。</em> </a></p></div></div>    
</body>
</html>