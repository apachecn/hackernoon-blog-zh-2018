<html>
<head>
<title>How to make your Javascript code run faster</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何让你的Javascript代码运行得更快</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-make-your-javascript-code-faster-8989869d41af?source=collection_archive---------10-----------------------#2018-05-31">https://medium.com/hackernoon/how-to-make-your-javascript-code-faster-8989869d41af?source=collection_archive---------10-----------------------#2018-05-31</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="9e20" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">很久以前，在2011年，我写了我的第一个DNI(西班牙ID) <a class="ae jp" href="https://blog.singuerinc.com/javascript/actionscript3/validators/dni/nie/nif/2011/06/17/tip-validar-un-dninienif-de-espana-con-actionscript/" rel="noopener ugc nofollow" target="_blank">验证脚本</a>。我是用<a class="ae jp" href="https://hackernoon.com/tagged/actionscript" rel="noopener ugc nofollow" target="_blank">的动作脚本</a>完成的。</p><p id="7923" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">几年后，在Flash时代之后，我<a class="ae jp" href="https://blog.singuerinc.com/javascript/validation/spain/dni/nie/nif/regex/2014/08/06/code-day-006-spain-dni-validation/" rel="noopener ugc nofollow" target="_blank">用Javascript重写了它</a>。</p><p id="79d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最近，我进入了一个功能性很强的<a class="ae jp" href="https://hackernoon.com/tagged/programming" rel="noopener ugc nofollow" target="_blank">编程</a>学习过程，作为一个目标，我建议自己创建一个新的模块来应用我所学到的东西。</p><p id="303a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">结果(我认为不是太遵循FP范式)是:</p><h2 id="a19e" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">更好的DNI</h2><div class="kl km fm fo kn ko"><a href="https://github.com/singuerinc/better-dni/" rel="noopener  ugc nofollow" target="_blank"><div class="kp ab ej"><div class="kq ab kr cl cj ks"><h2 class="bd hv fv z el kt eo ep ku er et ht dt translated">辛格莱公司/更好的dni</h2><div class="kv l"><h3 class="bd b fv z el kt eo ep ku er et ek translated">更好-dni -最快的西班牙dni(聂/ NIF)验证</h3></div><div class="kw l"><p class="bd b gc z el kt eo ep ku er et ek translated">github.com</p></div></div></div></a></div><p id="57fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">很快我发现有很多模块在做同样的事情…</p><p id="1000" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">复制别人已经做的有点无聊，所以我把我的目标改为</p><blockquote class="kx"><p id="5680" class="ky kz hu bd la lb lc ld le lf lg jo ek translated">”创建更快的模块来验证DNI”</p></blockquote><p id="b585" class="pw-post-body-paragraph ir is hu it b iu lh iw ix iy li ja jb jc lj je jf jg lk ji jj jk ll jm jn jo hn dt translated">在这个过程中，我发现了很多提高代码速度的方法，虽然有时候看起来有点丑，其中一些方法让代码速度提高了一倍。</p><blockquote class="lm ln lo"><p id="ee24" class="ir is lp it b iu iv iw ix iy iz ja jb lq jd je jf lr jh ji jj ls jl jm jn jo hn dt translated">请注意，根据浏览器+CPU+等，您可能会得到不同的结果。我的发现基本基于Chrome/Node。我会说，你应该在不同的环境中测试你的代码，看看哪里可以优化。</p></blockquote><p id="3b06" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下是我的发现:</p><h1 id="0e49" class="lt jr hu bd js lu lv lw jw lx ly lz ka ma mb mc kd md me mf kg mg mh mi kj mj dt translated">str.substr() vs str.slice()</h1><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="5197" class="jq jr hu mp b fv mt mu l mv mw">'0123456789'.slice(-9); // =&gt; '123456789'<br/>'0123456789'.substr(-9); // =&gt; '123456789'</span></pre><p id="b735" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">胜者:<strong class="it hv">切</strong> / x21更快！/ <a class="ae jp" href="https://jsperf.com/better-dni-slice-vs-substr/1" rel="noopener ugc nofollow" target="_blank">测试</a></p><h1 id="9779" class="lt jr hu bd js lu lv lw jw lx ly lz ka ma mb mc kd md me mf kg mg mh mi kj mj dt translated">toLowerCase()与toUpperCase()</h1><p id="6ee3" class="pw-post-body-paragraph ir is hu it b iu mx iw ix iy my ja jb jc mz je jf jg na ji jj jk nb jm jn jo hn dt translated">我必须承认，我以前从未想过为什么一种方法会比另一种方法快。我正在研究V8代码，看起来https://github.com/v8/v8/blob/master/src/string-case.cc#L16是这个问题的答案。</p><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="aa98" class="jq jr hu mp b fv mt mu l mv mw">'A'.toLowerCase(); // =&gt; 'a'</span><span id="dd9c" class="jq jr hu mp b fv nc mu l mv mw">'a'.toUpperCase(); // =&gt; 'A'</span></pre><p id="4201" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果需要比较两个字符串，这尤其有用。</p><p id="ae7d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在比较它们之前，最好把它们转换成小写。</p><p id="423e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">获胜者:<strong class="it hv"> toLowerCase </strong> /稍快/ <a class="ae jp" href="https://jsperf.com/better-dni-lower-case-vs-upper-case/1" rel="noopener ugc nofollow" target="_blank">测试</a></p><figure class="mk ml mm mn fq ne fe ff paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="fe ff nd"><img src="../Images/81d1626dc87afd45a17616db55ffef27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQjccedT8iMRt8M6EgPfnw.jpeg"/></div></div><figcaption class="nl nm fg fe ff nn no bd b be z ek">Random image related to speed. You need one in all posts. Photo by <a class="ae jp" href="https://unsplash.com/photos/ukTd6UiQbLQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">James Traf</a> on <a class="ae jp" href="https://unsplash.com/search/photos/fast?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="93a6" class="lt jr hu bd js lu lv lw jw lx ly lz ka ma mb mc kd md me mf kg mg mh mi kj mj dt translated">indexOf()与对象属性</h1><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="2f7f" class="jq jr hu mp b fv mt mu l mv mw">const y = 'xyz'.indexOf('y'); // =&gt; 1</span><span id="0f06" class="jq jr hu mp b fv nc mu l mv mw">const y = {x: 0, y: 1, z: 2}['y'] // =&gt; 1</span></pre><p id="cb6b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">获胜者:<strong class="it hv">指标</strong> /略快/ <a class="ae jp" href="https://jsperf.com/better-dni-index-of-vs-obj-prop/1" rel="noopener ugc nofollow" target="_blank">测试</a></p><h1 id="b312" class="lt jr hu bd js lu lv lw jw lx ly lz ka ma mb mc kd md me mf kg mg mh mi kj mj dt translated">字符串连接与模板文字</h1><p id="4954" class="pw-post-body-paragraph ir is hu it b iu mx iw ix iy my ja jb jc mz je jf jg na ji jj jk nb jm jn jo hn dt translated">我不知道为什么我认为模板文字比简单的字符串连接更复杂。</p><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="9d34" class="jq jr hu mp b fv mt mu l mv mw">const x = 'x';</span><span id="ba0d" class="jq jr hu mp b fv nc mu l mv mw">'yyy' + x;</span><span id="6aee" class="jq jr hu mp b fv nc mu l mv mw">`yyy${x}`; // faster</span></pre><p id="0d5d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">获胜者:<strong class="it hv">模板文字</strong> /稍快/ <a class="ae jp" href="https://jsperf.com/better-dni-str-concat-vs-str-template/1" rel="noopener ugc nofollow" target="_blank">测试</a></p><h1 id="52f9" class="lt jr hu bd js lu lv lw jw lx ly lz ka ma mb mc kd md me mf kg mg mh mi kj mj dt translated">转换为数字</h1><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="ca23" class="jq jr hu mp b fv mt mu l mv mw">parseInt('1234', 10); // =&gt; 1234</span><span id="abc4" class="jq jr hu mp b fv nc mu l mv mw">+'1234'; // =&gt; 1234</span></pre><p id="6c04" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">赢家:<strong class="it hv">+签</strong> / x6.12快！/ <a class="ae jp" href="https://jsperf.com/better-dni-convert-to-number/1" rel="noopener ugc nofollow" target="_blank">测试</a></p><h1 id="585b" class="lt jr hu bd js lu lv lw jw lx ly lz ka ma mb mc kd md me mf kg mg mh mi kj mj dt translated">Math.floor()与按位移位</h1><p id="6976" class="pw-post-body-paragraph ir is hu it b iu mx iw ix iy my ja jb jc mz je jf jg na ji jj jk nb jm jn jo hn dt translated">我从这篇<a class="ae jp" href="http://blog.blakesimpson.co.uk/read/58-fastest-alternative-to-math-floor-in-javascript" rel="noopener ugc nofollow" target="_blank">博文</a>中获得了一些灵感。</p><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="76b7" class="jq jr hu mp b fv mt mu l mv mw">Math.floor(1.123456789); // =&gt; 1</span><span id="6a51" class="jq jr hu mp b fv nc mu l mv mw">1.123456789 &lt;&lt; 0; // =&gt; 1</span></pre><p id="e9c8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">赢家:<strong class="it hv">按位移位</strong> /在jsperf中速度略快但Math.floor()在我的MacBook Pro中表现要好得多。/ <a class="ae jp" href="https://jsperf.com/better-dni-floor-vs-bitwise/1" rel="noopener ugc nofollow" target="_blank">测试</a></p></div><div class="ab cl np nq hc nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="hn ho hp hq hr"><h1 id="a35b" class="lt jr hu bd js lu nw lw jw lx nx lz ka ma ny mc kd md nz mf kg mg oa mi kj mj dt translated">可以帮助您的代码运行得更快的其他技巧</h1><h2 id="17cf" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">提示1</h2><p id="575b" class="pw-post-body-paragraph ir is hu it b iu mx iw ix iy my ja jb jc mz je jf jg na ji jj jk nb jm jn jo hn dt translated">先做简单的验证，然后尽快返回。看看这些片段:</p><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="3a0c" class="jq jr hu mp b fv mt mu l mv mw">if(someComplexValidation(value) &amp;&amp; value.length !== 9) return;</span></pre><p id="3ebc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">相对</p><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="8c2b" class="jq jr hu mp b fv mt mu l mv mw">if(value.length !== 9 &amp;&amp; someComplexValidation(value)) return;</span></pre><p id="aa78" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">是同一个代码，对吗？首先进行“简单的”验证，这样如果第一次验证没有通过，您的代码就不会运行和返回。</p><h2 id="9dfe" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">提示2</h2><p id="1c5c" class="pw-post-body-paragraph ir is hu it b iu mx iw ix iy my ja jb jc mz je jf jg na ji jj jk nb jm jn jo hn dt translated">避免使用像“toUpperCase()”这样昂贵的方法，尝试使用聪明的替代方法:</p><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="3921" class="jq jr hu mp b fv mt mu l mv mw">const n = 'XYZ'.indexOf('y'.toUpperCase()); // =&gt; 2</span></pre><p id="79ac" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">相对</p><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="3eb3" class="jq jr hu mp b fv mt mu l mv mw">const n = 'XYZxyz'.indexOf('y') % 3; // =&gt; 2</span></pre><h2 id="ecd9" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">提示3</h2><p id="66fa" class="pw-post-body-paragraph ir is hu it b iu mx iw ix iy my ja jb jc mz je jf jg na ji jj jk nb jm jn jo hn dt translated">如果您知道用不同的方法可以达到相同的结果，请针对每个具体情况找到更好的方法:</p><pre class="mk ml mm mn fq mo mp mq mr aw ms dt"><span id="039b" class="jq jr hu mp b fv mt mu l mv mw">const x1 = 'xyz'.substr(0, 1); // =&gt; 'x'</span><span id="cf2e" class="jq jr hu mp b fv nc mu l mv mw">const x2 = 'xyz'[0]; // =&gt; 'x'</span><span id="9fbb" class="jq jr hu mp b fv nc mu l mv mw">const x3 = 'xyz'.slice(0, 1); // =&gt; 'x'</span></pre><p id="b993" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我希望这能帮助你优化你的代码！</p><p id="b159" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你想有所贡献，让它更快吗？打开一个拉式请求:</p><div class="kl km fm fo kn ko"><a href="https://github.com/singuerinc/better-dni/" rel="noopener  ugc nofollow" target="_blank"><div class="kp ab ej"><div class="kq ab kr cl cj ks"><h2 class="bd hv fv z el kt eo ep ku er et ht dt translated">辛格莱公司/更好的dni</h2><div class="kv l"><h3 class="bd b fv z el kt eo ep ku er et ek translated">更好-dni -最快的西班牙dni(聂/ NIF)验证</h3></div><div class="kw l"><p class="bd b gc z el kt eo ep ku er et ek translated">github.com</p></div></div></div></a></div><figure class="mk ml mm mn fq ne"><div class="bz el l di"><div class="ob oc l"/></div></figure></div></div>    
</body>
</html>