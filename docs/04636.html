<html>
<head>
<title>Manage your Drupal 8 site configurations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">管理您的Drupal 8站点配置</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/manage-your-drupal-8-site-configurations-18408257efc2?source=collection_archive---------6-----------------------#2018-06-01">https://medium.com/hackernoon/manage-your-drupal-8-site-configurations-18408257efc2?source=collection_archive---------6-----------------------#2018-06-01</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/2c97a8d2b14af4e35789a9adfd27a970.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l97zx_0oAAm6zNvM.jpg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek"><a class="ae jg" href="http://clc.la/drupal_config" rel="noopener ugc nofollow" target="_blank">By ADCI Solutions</a></figcaption></figure><p id="f2ed" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">部署和<strong class="jj hv">配置管理</strong>是每个项目中非常常见但又非常重要的部分。这些过程在<strong class="jj hv"> Drupal 7 </strong>中太痛苦了。Drupal 7将所有配置和内容一起存储在一个数据库中。要管理配置，您可能已经使用了功能、Strongarm和其他相关模块的组合。这些模块提供了一种将配置打包到特殊“特性”Drupal模块中的方法。</p><p id="8c09" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> Drupal 8 </strong>提供了一种完全不同的管理配置的方式。这个想法是，几乎所有的配置都可以存储在文件中，而不是存储在数据库中。它允许开发人员轻松地在开发和现场站点之间移动设置。</p><p id="7caa" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在本文中，我们将深入研究一个新的配置管理系统，并学习如何从开发环境中迁移您的配置。因此，我们将开发一个基本的工作流程，帮助您在不同环境之间保持配置同步。</p><p id="6019" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在我们开始之前，我们应该确定你的网站的哪一部分可以在新系统的帮助下导出。</p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><h1 id="66bb" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">管理配置。不满足</h1><p id="9315" class="pw-post-body-paragraph jh ji hu jj b jk lk jm jn jo ll jq jr js lm ju jv jw ln jy jz ka lo kc kd ke hn dt translated">其实除了内容，一切都是配置。按照这种想法，认为新的配置管理系统可以帮助将内容从开发网站转移到生产网站是错误的。使用新系统，您可以管理:</p><ul class=""><li id="a26d" class="lp lq hu jj b jk jl jo jp js lr jw ls ka lt ke lu lv lw lx dt translated">模块设置和状态</li><li id="75ef" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">内容类型和设置</li><li id="3aa2" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">块类型和设置</li><li id="5e87" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">许可</li><li id="40e6" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">视图</li><li id="4ed7" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">主题设置</li><li id="04b3" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">诸如此类</li></ul><p id="9af5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">以下内容视为内容，无法管理:</p><ul class=""><li id="71b8" class="lp lq hu jj b jk jl jo jp js lr jw ls ka lt ke lu lv lw lx dt translated">节点</li><li id="221f" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">用户</li><li id="c004" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">自定义块及其内容</li><li id="b636" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">其他实体内容</li></ul><p id="6d32" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">要将内容从dev转移到prod，您可能必须考虑迁移系统，但这是一个完全不同的故事。</p><p id="d0b9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们来看看运行中的配置管理系统。</p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><h1 id="f358" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">基本设置和准备</h1><p id="02a5" class="pw-post-body-paragraph jh ji hu jj b jk lk jm jn jo ll jq jr js lm ju jv jw ln jy jz ka lo kc kd ke hn dt translated">配置管理功能由“配置管理器”核心模块提供。确保它已启用。之后，一个新的管理页面将会出现:/admin/config/development/configuration。</p><p id="498a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">此页面允许您:</p><ul class=""><li id="6200" class="lp lq hu jj b jk jl jo jp js lr jw ls ka lt ke lu lv lw lx dt translated">导入和导出配置(完整归档或单个归档)；</li><li id="ffd5" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke lu lv lw lx dt translated">同步配置。</li></ul><p id="e63b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">即时可用的Drupal 8网站配置存储在DB的“config”表中。这样做是出于<a class="ae jg" href="https://goo.gl/Y4jhSp" rel="noopener ugc nofollow" target="_blank">性能和安全原因</a>。这个新系统允许我们导出完整的网站配置，并将其存储在YAML文件中。</p><p id="5a91" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在开始使用配置之前，让我们配置一个文件夹，我们将在其中存储我们的配置YAML文件。该文件夹在setting.php文件中配置:</p><pre class="md me mf mg fq mh mi mj mk aw ml dt"><span id="d8e0" class="mm kn hu mi b fv mn mo l mp mq">$config_directories['sync'] = 'sites/default/files/config_HASH/sync';</span></pre><p id="e0ed" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这里的HASH是在安装阶段生成的长HASH；它有助于保护配置免受web访问。</p><p id="dab6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在我们可以手动或使用Drush导出活动网站配置:<em class="mr"> drush config-export </em>(或<em class="mr"> drush cex </em>)。我们坚持Drupal方式，并将在本文中使用Drush。</p><p id="9577" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们在这一点上停下来想一想。几乎所有的网站配置现在都可以作为YAML文件使用。这是什么意思？耶！这意味着我们可以在版本控制系统下存储您的配置YAML文件！</p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><h1 id="6f4b" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">Git和Drush的基本工作流程</h1><p id="0ccd" class="pw-post-body-paragraph jh ji hu jj b jk lk jm jn jo ll jq jr js lm ju jv jw ln jy jz ka lo kc kd ke hn dt translated">我们几乎可以肯定，您的sites/default/files文件夹被版本控制系统忽略了。没有吗？尽快做:)</p><p id="26ab" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">建议将您的config文件夹移动到与您的docroot目录相同的级别(的同级)(它完全阻止对它的web访问)。这并不总是可能的，您可以将其移动到与公共文件文件夹相同的级别(sites/default/files)。</p><p id="76ad" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">只需移动文件夹并更改setting.php文件:</p><pre class="md me mf mg fq mh mi mj mk aw ml dt"><span id="ad53" class="mm kn hu mi b fv mn mo l mp mq">$config_directories['sync'] = 'sites/default/config_HASH/sync';</span></pre><p id="a04c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">运行<strong class="jj hv"> Drush </strong>命令后，将会创建YAML文件，您可以提交它们。让我们回到管理界面。</p><figure class="md me mf mg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ms"><img src="../Images/3d353c5ac37dcc289b22f29c9428f211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bkmn7pxO3QwfRf5P.jpg"/></div></div></figure><p id="faf1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在此阶段，没有配置更改，因为我们刚刚导出了当前活动的配置。让我们改变网站上的一些东西(例如网站名称)，看看会发生什么。</p><figure class="md me mf mg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ms"><img src="../Images/95597724405bd0bc1f439cecba721f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qh2pOwdwfS1UbMhm.jpg"/></div></div></figure><p id="e700" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以看到一个配置项(文件)被更改了。现在我们可以看到变化:</p><figure class="md me mf mg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ms"><img src="../Images/cf4d87c225695339ce9ca5d9d78c275f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2evhU9HOHFaSP_7f.jpg"/></div></div></figure><p id="3586" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">图片里有什么？</p><p id="c2e9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">阶段配置是保存在YAML文件中的配置。</p><p id="a309" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">活动配置是存储在数据库中的当前网站配置。</p><p id="c50e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在这一点上，理解出口和进口的区别是非常重要的。</p><p id="679c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">导出</strong>用于获取数据库中定义的所有配置，并将其保存为YAML文件。</p><p id="200a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> Import </strong>执行相反的操作:它将YAML文件中的配置导入到DB中。</p><p id="7a49" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在我们的示例中，如果您使用“import all button”或运行<em class="mr">drush config-import</em>(<em class="mr">drush CIM</em>)命令来运行导入，它将从YAML文件(stage config)中清除对某个州的站点名称更改。</p><p id="592e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果我们想要更改我们的暂存配置，我们必须运行导出。之后，适当的YAML文件将被更改，我们可以提交更改。</p><p id="ca5f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">总而言之，将变更从您的开发环境转移到实际环境的基本工作流程如下:</p><p id="1cb1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在开发网站上:</p><ol class=""><li id="e69a" class="lp lq hu jj b jk jl jo jp js lr jw ls ka lt ke mt lv lw lx dt translated">安装配置管理模块，配置同步文件夹，导出活动配置并提交。</li><li id="2bb6" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke mt lv lw lx dt translated">改变配置。</li><li id="caba" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke mt lv lw lx dt translated">使用命令<em class="mr"> drush cex </em>导出更改</li><li id="ab0b" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke mt lv lw lx dt translated">提交和推送更改:<em class="mr"> git提交</em>和<em class="mr"> git推送</em></li></ol><p id="c102" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在实时网站上:</p><ol class=""><li id="673c" class="lp lq hu jj b jk jl jo jp js lr jw ls ka lt ke mt lv lw lx dt translated">拉改变的配置:<em class="mr"> git拉</em></li><li id="846e" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke mt lv lw lx dt translated">将更改导入实时网站活动配置:<em class="mr"> drush cim </em></li></ol><p id="10c1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">因此，我们的开发和实时网站只需几个简单的步骤就能实现同步。</p><figure class="md me mf mg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/754d3256b012896e5c7ea70e3668d52a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pcnAovkh74G91tKD.jpg"/></div></div></figure></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><h1 id="e34c" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">结论</h1><p id="17cf" class="pw-post-body-paragraph jh ji hu jj b jk lk jm jn jo ll jq jr js lm ju jv jw ln jy jz ka lo kc kd ke hn dt translated">Drupal 8使用新的配置管理系统，努力使导出和导入站点配置的过程更加容易。在本文中，我们研究了一个基本的工作流，它允许在开发和实际环境之间保持配置同步。我希望这个工作流程能够帮助您改进部署过程。</p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><h1 id="5651" class="km kn hu bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj dt translated">相关(有帮助的)模块/发行版</h1><ol class=""><li id="2302" class="lp lq hu jj b jk lk jo ll js mu jw mv ka mw ke mt lv lw lx dt translated"><a class="ae jg" href="https://www.drupal.org/project/features" rel="noopener ugc nofollow" target="_blank">特性</a>:允许您捆绑配置，以便在另一个站点上重用。必须有一个Drupal 8发行版的模块。</li><li id="6f60" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke mt lv lw lx dt translated"><a class="ae jg" href="https://www.drupal.org/project/config_installer" rel="noopener ugc nofollow" target="_blank">配置安装器</a> : Drupal配置文件，允许从现有配置安装一个站点。</li><li id="ff64" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke mt lv lw lx dt translated"><a class="ae jg" href="https://www.drupal.org/project/config_tools" rel="noopener ugc nofollow" target="_blank">配置工具</a>:自动将配置更改提交给git。</li><li id="dda3" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke mt lv lw lx dt translated"><a class="ae jg" href="https://www.drupal.org/project/config_readonly" rel="noopener ugc nofollow" target="_blank">配置只读模式</a>:允许通过管理用户界面锁定任何配置更改。</li><li id="9dbd" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke mt lv lw lx dt translated"><a class="ae jg" href="https://www.drupal.org/project/config_devel" rel="noopener ugc nofollow" target="_blank">配置开发</a> t:帮助开发配置。</li><li id="b9ca" class="lp lq hu jj b jk ly jo lz js ma jw mb ka mc ke mt lv lw lx dt translated"><a class="ae jg" href="https://www.drupal.org/project/config_sync" rel="noopener ugc nofollow" target="_blank">配置同步器</a>:提供从更新的模块、主题或发行版安全导入站点配置的方法。</li></ol></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><p id="6a2c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mr">原发布于</em><a class="ae jg" href="http://clc.la/drupal_config1" rel="noopener ugc nofollow" target="_blank"><em class="mr">ADCI解决方案网站</em> </a> <em class="mr">。</em></p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><figure class="md me mf mg fq iv fe ff paragraph-image"><div class="ab fr cl mx"><img src="../Images/73bcb62bbfda355e913e5b86e2193e46.png" data-original-src="https://miro.medium.com/v2/format:webp/1*5kC2KhUXG-R8C8-59J1RCA.png"/></div></figure><p id="f79a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">在社交网络上关注我们:</strong> <a class="ae jg" href="https://twitter.com/ADCISolutions" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae jg" href="https://www.facebook.com/adcisolutions/" rel="noopener ugc nofollow" target="_blank">脸书</a> | <a class="ae jg" href="https://www.linkedin.com/company/adci-solutions/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a></p><div class="my mz fm fo na nb"><a href="http://clc.la/drupal_config_json" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab ej"><div class="nd ab ne cl cj nf"><h2 class="bd hv fv z el ng eo ep nh er et ht dt translated">如何从Drupal 8站点发送JSON数据？- Drupal stories:一个内部人员的观点- Medium</h2><div class="ni l"><h3 class="bd b fv z el ng eo ep nh er et ek translated">想象一种情况:您的移动应用程序需要使用JSON从Drupal 8上的站点获取一些信息。为什么…</h3></div><div class="nj l"><p class="bd b gc z el ng eo ep nh er et ek translated">clc.la</p></div></div><div class="nk l"><div class="nl l nm nn no nk np ja nb"/></div></div></a></div></div></div>    
</body>
</html>