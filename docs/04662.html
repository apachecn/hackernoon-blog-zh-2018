<html>
<head>
<title>How to Build Forms Dynamically in React/Redux?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React/Redux中动态构建表单？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-build-forms-dynamically-in-react-redux-e3a6c89a3406?source=collection_archive---------1-----------------------#2018-06-02">https://medium.com/hackernoon/how-to-build-forms-dynamically-in-react-redux-e3a6c89a3406?source=collection_archive---------1-----------------------#2018-06-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="f8fb" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">包含演示和源代码的分步指南</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/b4760b23e248ddc257de7e2fd32a197b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fA3YPy07b5_4JHS5HMorsw.jpeg"/></div></div></figure><p id="ce4d" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如今，将长表单拆分成多步向导、实时客户端验证、初始化数据以及使部分/字段依赖于其他字段可见，这些都不会让任何人感到惊讶。它现在是“必备”了。否则，使用复杂的表单会感觉尴尬和痛苦。在<a class="ae kr" href="http://productcrafters.io/" rel="noopener ugc nofollow" target="_blank"> ProductCrafters </a>中，我们使用<strong class="jx hv"> Redux </strong>进行状态管理，所以选择最好的包进行表单管理是合乎逻辑的。<a class="ae kr" href="http://redux-form.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jx hv">Redux-Form</strong></a><strong class="jx hv">(GitHub上的约10k颗星星)</strong>包含所有列出的特性和更多特性，如标准化数据的工具、字段数组等等。使用了两年多之后，我们对它非常满意。</p><p id="64d6" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们正面临着客户要求有部分甚至100%的动态形式。我们从我们的金融科技应用客户那里收到了这样的请求。最近，我们收到了一个类似的heathlcare应用程序请求。含义、表单结构和验证规则将从服务器获取；应根据这些数据创建表单(或向导)<em class="ks">,无需在客户端进行任何更改</em>。在这篇文章中，<strong class="jx hv">我想分享自己构建这种动态表单向导的经验。</strong></p><p id="9eec" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">下面是<a class="ae kr" href="https://productcrafters.github.io/Dynamic-Redux-Form-Wizard/" rel="noopener ugc nofollow" target="_blank">演示</a>:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><a href="https://productcrafters.github.io/Dynamic-Redux-Form-Wizard/"><div class="fe ff kt"><img src="../Images/c483fb7f5c5c6d523b5336763701035c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GazIFScm6pAo9Y3Nh3V2Q.png"/></div></a></figure><h2 id="d8ef" class="ku kv hu bd kw kx ky kz la lb lc ld le ke lf lg lh ki li lj lk km ll lm ln lo dt translated">步骤1:呈现单个动态字段</h2><p id="8260" class="pw-post-body-paragraph jv jw hu jx b jy lp iv ka kb lq iy kd ke lr kg kh ki ls kk kl km lt ko kp kq hn dt translated">下面是以Redux形式呈现字段的常用方法:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="b0f0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们需要指定字段名，以及应该呈现它的单个组件(输入、复选框、选择等)，标签是可选的，但我喜欢有一个既能描述字段又能显示字段的单个组件。</p><p id="a584" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">首先，我创建了示例服务器响应模拟，以呈现该字段:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="1b1b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">为了简化本教程，我将省略获取数据和解析JSON。我们将使用解析后的模拟。</p><p id="e1c2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">使用这些数据来给<code class="eh lw lx ly lz b">&lt;Field&gt;</code>提供全功能输入。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="6802" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在上面的代码中，我没有使用标准的HTML5 <code class="eh lw lx ly lz b">&lt;input /&gt;</code>。有自定义创建的组件。并且<code class="eh lw lx ly lz b">stringToComponentMapper</code>使用json数据中的键帮助选择正确的组件。如果你以前从未使用过redux-form，就使用默认的HTML 5元素:“input”、“checkbox”、“select”。</p><h2 id="97c6" class="ku kv hu bd kw kx ky kz la lb lc ld le ke lf lg lh ki li lj lk km ll lm ln lo dt translated">步骤2:创建动态部分</h2><p id="2ff1" class="pw-post-body-paragraph jv jw hu jx b jy lp iv ka kb lq iy kd ke lr kg kh ki ls kk kl km lt ko kp kq hn dt translated">Redux-form有一个很酷的特性——<strong class="jx hv">form section</strong>。它允许将一个实体的公共字段组合在一起。</p><blockquote class="ma mb mc"><p id="55ea" class="jv jw ks jx b jy jz iv ka kb kc iy kd md kf kg kh me kj kk kl mf kn ko kp kq hn dt translated"><code class="eh lw lx ly lz b"><em class="hu">FormSection</em></code>组件使得将表单分割成更小的组件变得容易，这些组件可以在多个表单之间重用。它通过在任意深度的<code class="eh lw lx ly lz b"><em class="hu">Field</em></code>、<code class="eh lw lx ly lz b"><em class="hu">Fields</em></code>和<code class="eh lw lx ly lz b"><em class="hu">FieldArray</em></code>孩子的名字前面加上<code class="eh lw lx ly lz b"><em class="hu">name</em></code>属性中指定的值来实现。</p></blockquote><p id="d514" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这是我们之前写的:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="e368" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">用<code class="eh lw lx ly lz b">&lt;FormSection /&gt;</code>:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="35c5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我对模拟数据做了一些修改，提取了有自己名字的<code class="eh lw lx ly lz b">section</code>对象，并将之前的内容移到了<code class="eh lw lx ly lz b">fields</code>中:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="c16a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在我们可以很容易地渲染表单部分。<code class="eh lw lx ly lz b">FormGenerator</code>通过prop接收数据并在其上循环。然后每个部分在其字段上循环。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="48d1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">提取<code class="eh lw lx ly lz b">SectionList</code>和<code class="eh lw lx ly lz b">SectionRenderer</code>组件以避免<code class="eh lw lx ly lz b">jsx</code>中的代码是有意义的。我在这里这样做不是为了让代码更短，而是为了关注动态UI。</p><h2 id="14c7" class="ku kv hu bd kw kx ky kz la lb lc ld le ke lf lg lh ki li lj lk km ll lm ln lo dt translated">步骤3:动态表单向导</h2><p id="a75b" class="pw-post-body-paragraph jv jw hu jx b jy lp iv ka kb lq iy kd ke lr kg kh ki ls kk kl km lt ko kp kq hn dt translated">让我们对之前的模拟进行更改:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="fa9e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在让我们添加两个文件:</p><p id="e429" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv"> WizardProdiver.js </strong> —将记住当前向导页面并管理页面更改。在这个例子中，我还试验了最新的React上下文，如果这对你来说是新的，<a class="ae kr" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank">阅读官方文档</a>。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="0c2c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">并且<strong class="jx hv"> PageTemplate.js </strong>将使用<strong class="jx hv"> FormGenerator </strong>并在其周围创建一个表单:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="be9b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">最后，我们在<strong class="jx hv"> Wizard.js </strong>中将所有东西包装在一起:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lu lv l"/></div></figure><figure class="jk jl jm jn fq jo fe ff paragraph-image"><a href="https://calendly.com/oleg-kalyta/30min"><div class="fe ff mg"><img src="../Images/c7ddd5f9e3396b00e331a22f308f2c72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8W03UNXryP_fZWSZ_k8T5A.png"/></div></a></figure><p id="c9d9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">示例代码:</p><div class="mh mi fm fo mj mk"><a href="https://github.com/ProductCrafters/Dynamic-Redux-Form-Wizard" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab ej"><div class="mm ab mn cl cj mo"><h2 class="bd hv fv z el mp eo ep mq er et ht dt translated">product crafters/动态还原表单向导</h2><div class="mr l"><h3 class="bd b fv z el mp eo ep mq er et ek translated">在GitHub上创建一个帐户，为动态表单向导的开发做出贡献。</h3></div><div class="ms l"><p class="bd b gc z el mp eo ep mq er et ek translated">github.com</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my jt mk"/></div></div></a></div><p id="b107" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这里有一个<a class="ae kr" href="https://productcrafters.github.io/Dynamic-Redux-Form-Wizard/" rel="noopener ugc nofollow" target="_blank">演示</a>。</p><p id="8092" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在本文的报告中，您可能还会发现简单的正则表达式验证。这是非常基本的动态形式。在真实的项目中，我们有更严格的要求，例如，特定字段或部分的可见性的动态规则。这可能是本文第二部分的主题:)</p></div><div class="ab cl mz na hc nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="hn ho hp hq hr"><p id="353e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">附言🚀我的团队<strong class="jx hv">使用React/React Native在3年内构建生产应用</strong>。我们帮助初创公司的创始人将他们的想法付诸实践。项目需要帮助吗？✉️<a class="ae kr" href="mailto:oleg@productcrafters.io" rel="noopener ugc nofollow" target="_blank">Oleg @ product crafters . io</a></p></div></div>    
</body>
</html>