<html>
<head>
<title>How to install and secure MongoDB in Amazon EC2 in minutes?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何分分钟在亚马逊EC2中安装并保护MongoDB？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-install-and-secure-mongodb-in-amazon-ec2-in-minutes-90184283b0a1?source=collection_archive---------2-----------------------#2018-06-02">https://medium.com/hackernoon/how-to-install-and-secure-mongodb-in-amazon-ec2-in-minutes-90184283b0a1?source=collection_archive---------2-----------------------#2018-06-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="d548" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">在本帖中，我们将在Amazon EC2实例中安装MongoDB，并使用身份验证机制保护它。</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/4bb5c5229fedd53d888abb0d6420cdfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ce0gUe0LbnhL7ebnDGTp5w.png"/></div></div></figure><p id="f4df" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">只有当一个人知道安全工作的重要性时，他才知道安全的重要性。</p><blockquote class="kr ks kt"><p id="ea12" class="jv jw ku jx b jy jz iv ka kb kc iy kd kv kf kg kh kw kj kk kl kx kn ko kp kq hn dt translated">据说超过30%的MongoDB数据库及其连接是不安全的。</p></blockquote><p id="7d1a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">你不想保护它吗？当然，每个人都喜欢保护他们托管的任何东西。让我们开始实施吧。</p><p id="5f23" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">MongoDB站点中的步骤不足以让一个noob成功完成这些步骤。这发生在我个人身上。在浏览了近数百篇帖子后，我最终决定完美地记录下来，因为我知道<strong class="jx hv">分享是关爱</strong>。如果你在这篇文章中发现任何困难，请随时评论。我会尽快回复你。</p><p id="e526" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我假设您已经知道Amazon Web services，并且对EC2知之甚少。如果你不是，不要担心。我在下面的帖子中创建了一个关于AWS(Amazon Web Services)和EC2实例设置的教程。请求你经历同样的事情。</p><div class="ky kz fm fo la lb"><a rel="noopener follow" target="_blank" href="/@balasubramanim/make-your-amazon-ec2-instance-up-and-running-5d645c2a1f03"><div class="lc ab ej"><div class="ld ab le cl cj lf"><h2 class="bd hv fv z el lg eo ep lh er et ht dt translated">启动并运行您的Amazon EC2实例。</h2><div class="li l"><h3 class="bd b fv z el lg eo ep lh er et ek translated">在这一部分，我们将创建一个Amazon帐户EC2实例，并通过SSH连接到该实例。</h3></div><div class="lj l"><p class="bd b gc z el lg eo ep lh er et ek translated">medium.com</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp jt lb"/></div></div></a></div><h2 id="c383" class="lq lr hu bd ls lt lu lv lw lx ly lz ma ke mb mc md ki me mf mg km mh mi mj mk dt translated">让我们安装MongoDB。</h2><p id="a848" class="pw-post-body-paragraph jv jw hu jx b jy ml iv ka kb mm iy kd ke mn kg kh ki mo kk kl km mp ko kp kq hn dt translated">一旦您准备好了终端，让我们开始在其中安装MongoDB。由于我们将在几分钟内完成安装，如果您需要，我会要求您浏览参考资料部分的以下链接，了解下面提到的命令的详细用法。</p><p id="345a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">步骤1 </strong>:导入包管理系统使用的公钥。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="cb27" class="lq lr hu mr b fv mv mw l mx my">sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 2930ADAE8CAF5059EE73BB4B58712A2291FA4AD5</span></pre><p id="63a6" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">第二步</strong>:为MongoDB创建一个列表文件。(适用于Ubuntu 16.04)</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="de20" class="lq lr hu mr b fv mv mw l mx my">echo “deb [ arch=amd64,arm64 ] <a class="ae mz" href="https://repo.mongodb.org/apt/ubuntu" rel="noopener ugc nofollow" target="_blank">https://repo.mongodb.org/apt/ubuntu</a> xenial/mongodb-org/3.6 multiverse” | sudo tee /etc/apt/sources.list.d/mongodb-org-3.6.list</span></pre><p id="3e9f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">第三步</strong>:重新加载本地包数据库。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="3d18" class="lq lr hu mr b fv mv mw l mx my">sudo apt-get update</span></pre><p id="9742" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">第四步</strong>:安装MongoDB包。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="1775" class="lq lr hu mr b fv mv mw l mx my">sudo apt-get install -y mongodb-org</span></pre><p id="e126" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这将安装MongoDB的最新稳定版本。</p><p id="7396" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">就这样，我们已经在我们的Amazon EC2实例中安装了MongoDB最新的稳定版本。</p><blockquote class="kr ks kt"><p id="7fa3" class="jv jw ku jx b jy jz iv ka kb kc iy kd kv kf kg kh kw kj kk kl kx kn ko kp kq hn dt translated">在下面的过程中，我们将首先创建一个<code class="eh na nb nc mr b"><em class="hu">admin</em></code>，他通常对您的数据库有根访问权限，然后<code class="eh na nb nc mr b"><em class="hu">admin</em></code>将创建一个<code class="eh na nb nc mr b"><em class="hu">user</em></code>，他可以被创建为具有特定角色和对特定数据库的访问权限。最后，我们将使用<code class="eh na nb nc mr b"><em class="hu">user</em></code>凭证连接到我们的数据库并开始处理它。</p></blockquote><h2 id="56d9" class="lq lr hu bd ls lt lu lv lw lx ly lz ma ke mb mc md ki me mf mg km mh mi mj mk dt translated">让我们开始MongoDB</h2><p id="5d81" class="pw-post-body-paragraph jv jw hu jx b jy ml iv ka kb mm iy kd ke mn kg kh ki mo kk kl km mp ko kp kq hn dt translated"><strong class="jx hv">第一步</strong>:启动MongoDB。发出以下命令启动<code class="eh na nb nc mr b"><a class="ae mz" href="https://docs.mongodb.com/manual/reference/program/mongod/#bin.mongod" rel="noopener ugc nofollow" target="_blank">mongod</a></code>。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="c210" class="lq lr hu mr b fv mv mw l mx my">sudo service mongod start</span></pre><p id="6fdb" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">步骤2 </strong>:通过键入以下命令，验证MongoDB是否已经成功启动。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="b66b" class="lq lr hu mr b fv mv mw l mx my">cat /var/log/mongodb/mongod.log</span></pre><p id="ec34" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">确保你在最后找到下面的线。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="5b6c" class="lq lr hu mr b fv mv mw l mx my">[initandlisten] waiting for connections on port 27017</span></pre><p id="bdbf" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">就是这样。您现在正在远程实例中成功运行MongoDB实例。</p><p id="dba1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">注意:</strong>发出以下命令停止<code class="eh na nb nc mr b"><a class="ae mz" href="https://docs.mongodb.com/manual/reference/program/mongod/#bin.mongod" rel="noopener ugc nofollow" target="_blank">mongod</a></code>(不需要时不要执行)</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="5146" class="lq lr hu mr b fv mv mw l mx my">sudo service mongod stop</span></pre><p id="6724" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">注意:</strong>发出以下命令重启<code class="eh na nb nc mr b"><a class="ae mz" href="https://docs.mongodb.com/manual/reference/program/mongod/#bin.mongod" rel="noopener ugc nofollow" target="_blank">mongod</a></code>(不需要时不要执行)</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="e3dc" class="lq lr hu mr b fv mv mw l mx my">sudo service mongod restart</span></pre><h2 id="d8cc" class="lq lr hu bd ls lt lu lv lw lx ly lz ma ke mb mc md ki me mf mg km mh mi mj mk dt translated">是时候保护你的MongoDB了。</h2><p id="d6c1" class="pw-post-body-paragraph jv jw hu jx b jy ml iv ka kb mm iy kd ke mn kg kh ki mo kk kl km mp ko kp kq hn dt translated">在MongoDB部署上启用访问控制会强制执行身份验证，要求用户标识自己的身份。当访问启用了访问控制的MongoDB部署时，用户只能执行由其角色决定的操作。</p><p id="a2a3" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">下面的过程首先将用户管理员添加到不带访问控制的MongoDB实例中，然后启用访问控制。</p><p id="136e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">门禁？—是的，当您使用AccessControl运行MongoDB时，您会说，启动安全的MongoDB实例。</p><p id="9a50" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><code class="eh na nb nc mr b">admin</code> —该用户可以管理用户和角色，如:创建用户、授予或撤销用户角色、创建或修改自定义角色。</p><h2 id="d453" class="lq lr hu bd ls lt lu lv lw lx ly lz ma ke mb mc md ki me mf mg km mh mi mj mk dt translated">程序</h2><p id="0ee1" class="pw-post-body-paragraph jv jw hu jx b jy ml iv ka kb mm iy kd ke mn kg kh ki mo kk kl km mp ko kp kq hn dt translated"><strong class="jx hv">第一步</strong>:创建一个存放数据的目录，并设置权限。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="4551" class="lq lr hu mr b fv mv mw l mx my">//Creating a path to store DB data.</span><span id="3001" class="lq lr hu mr b fv nd mw l mx my">sudo mkdir -p /data/db</span><span id="68b6" class="lq lr hu mr b fv nd mw l mx my">//Giving yourself permission to write in that folder.<br/> <br/>sudo chown $USER /data/db</span></pre><p id="dfb3" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如果你在设置这个文件夹和权限时有任何困难，你可以参考这个<a class="ae mz" href="https://stackoverflow.com/questions/7948789/mongodb-mongod-complains-that-there-is-no-data-db-folder" rel="noopener ugc nofollow" target="_blank"> StackOverflow </a>链接。</p><p id="ee6b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">第二步</strong>:无访问控制启动MongoDB。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="8092" class="lq lr hu mr b fv mv mw l mx my">mongod --port 27017 --dbpath /data/db</span></pre><p id="aee8" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">第三步</strong>:让MongoDB实例在这个终端实例上运行。现在让我们在另一个远程终端实例(比如终端2)上工作，这样我们将在创建一个用户后来回切换，并重启Mongo实例。</p><p id="1c09" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">打开一个新的终端并连接到您的EC2实例。现在我们将在Mongo Shell上工作，它用于在您创建的数据库中运行命令或查询。</p><p id="f8c8" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在我们将通过发出下面的命令来创建Mongo Shell。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="c282" class="lq lr hu mr b fv mv mw l mx my">mongo --port 27017</span></pre><p id="4dc7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，您的终端将看起来像下面的图像，这是准备运行命令。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff ne"><img src="../Images/09ee273f02563cbb8e0a780cab74363c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y6Q-Ky8_xqF0F4NttKxWig.png"/></div></div><figcaption class="nf ng fg fe ff nh ni bd b be z ek">Mongo Shell</figcaption></figure><p id="1995" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">第四步</strong>:创建用户管理员(<code class="eh na nb nc mr b">admin</code></p><p id="2c80" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在<code class="eh na nb nc mr b">admin</code>数据库中，添加一个角色为<code class="eh na nb nc mr b"><a class="ae mz" href="https://docs.mongodb.com/manual/reference/built-in-roles/#userAdminAnyDatabase" rel="noopener ugc nofollow" target="_blank">userAdminAnyDatabase</a></code>的用户。该数据库充当admin DB，我们创建它只是为了进行身份验证。</p><p id="ef24" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">发出以下命令切换到admin DB，即使您还没有创建它。当您发出该命令时，它将自动创建。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="e61e" class="lq lr hu mr b fv mv mw l mx my">use admin</span></pre><p id="9cd0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">切换到admin DB后，让我们通过发出以下命令来创建一个<code class="eh na nb nc mr b">admin</code>。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="56e1" class="lq lr hu mr b fv mv mw l mx my">db.createUser({user: "admin", pwd: "adminUser123", roles: [{role: "userAdminAnyDatabase", db: "admin"}]})</span></pre><p id="2e93" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">它被美化为(在美化的命令之上，不要运行两次)</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="e4bd" class="lq lr hu mr b fv mv mw l mx my">db.createUser(<br/> {<br/> user: “admin”,<br/> pwd: “adminUser123”,<br/> roles: [ { role: “userAdminAnyDatabase”, db: “admin” } ]<br/> }<br/>)</span></pre><p id="32af" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在您已经创建了一个名为<code class="eh na nb nc mr b">admin</code>的用户，其角色为<code class="eh na nb nc mr b">userAdminAnyDatabase</code>。</p><p id="5f9a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">按下<code class="eh na nb nc mr b">Ctrl+C</code>断开mongo外壳。</p><p id="b693" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">步骤5 </strong>:切换回运行它的旧mongod实例(终端1)。让我们使用访问控制重新启动MongoDB实例，以获得对数据库的管理员访问权。请记住，您现在开始使用访问控制来启动Mongo实例。</p><p id="4197" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">使用<code class="eh na nb nc mr b">--auth</code>命令行选项重新启动<code class="eh na nb nc mr b"><a class="ae mz" href="https://docs.mongodb.com/manual/reference/program/mongod/#bin.mongod" rel="noopener ugc nofollow" target="_blank">mongod</a></code>实例。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="4ede" class="lq lr hu mr b fv mv mw l mx my">mongod --auth --port 27017 --dbpath /data/db</span></pre><p id="fc68" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">步骤6 </strong>:切换回终端2 (mongo shell实例)。</p><p id="5dff" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">通过发出以下命令，以用户管理员的身份进行连接和身份验证。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="427a" class="lq lr hu mr b fv mv mw l mx my">mongo --port 27017 -u "admin" -p "adminUser123" --authenticationDatabase "admin"</span></pre><p id="55bc" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">步骤7 </strong>:根据部署需要创建额外的用户(<code class="eh na nb nc mr b">user</code>)。</p><p id="c5e4" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">一旦被认证为用户管理员，使用<code class="eh na nb nc mr b"><a class="ae mz" href="https://docs.mongodb.com/manual/reference/method/db.createUser/#db.createUser" rel="noopener ugc nofollow" target="_blank">db.createUser()</a></code>创建额外的用户。您可以将任何<a class="ae mz" href="https://docs.mongodb.com/manual/core/security-built-in-roles/" rel="noopener ugc nofollow" target="_blank">内置角色</a>或<a class="ae mz" href="https://docs.mongodb.com/manual/core/security-user-defined-roles/" rel="noopener ugc nofollow" target="_blank">自定义角色</a>分配给用户。以下操作将用户<code class="eh na nb nc mr b">myTester</code>添加到<code class="eh na nb nc mr b">test</code>数据库中，该用户在<code class="eh na nb nc mr b">test</code>数据库中拥有<code class="eh na nb nc mr b"><a class="ae mz" href="https://docs.mongodb.com/manual/reference/built-in-roles/#readWrite" rel="noopener ugc nofollow" target="_blank">readWrite</a></code>角色</p><p id="ecb2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">发出以下命令创建一个名为<code class="eh na nb nc mr b">test</code>的数据库并使用它。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="7efd" class="lq lr hu mr b fv mv mw l mx my">use test</span></pre><p id="aed2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在让我们在这个数据库中创建一个用户，为她/他分配特定的角色。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="8843" class="lq lr hu mr b fv mv mw l mx my">db.createUser({user: "user", pwd: "user123", roles: [{role: "readWrite", db: "test"}]})</span></pre><p id="79f0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">它被美化为(在美化的命令之上，不要运行两次)</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="c770" class="lq lr hu mr b fv mv mw l mx my">db.createUser(<br/>  {<br/>    user: "user",<br/>    pwd: "user123",<br/>    roles: [ { role: "readWrite", db: "test" } ]<br/>  }<br/>)</span></pre><p id="3a3f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，您已经成功地创建了一个具有特定角色和数据库访问权限的用户。</p><p id="6a45" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">步骤8 </strong>:现在连接并认证为<code class="eh na nb nc mr b">user</code>。</p><p id="667f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，通过在同一个Mongo Shell中发出以下命令，连接到具有用户角色的实例。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="c64c" class="lq lr hu mr b fv mv mw l mx my">mongo --port 27017 -u "user" -p "user123" --authenticationDatabase "test"</span></pre><p id="626a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在，您已经安全地通过了名为<code class="eh na nb nc mr b">test</code>的数据库用户身份验证。如果您想执行一些查询操作，您可以发出下面的命令并立即测试。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="3e49" class="lq lr hu mr b fv mv mw l mx my">db.foo.insert( { x: 1, y: 1 } )</span></pre><p id="fcb0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">它创建了一个名为<code class="eh na nb nc mr b">foo</code>的集合，并在其中插入了前面提到的JSON。</p><h2 id="0ed1" class="lq lr hu bd ls lt lu lv lw lx ly lz ma ke mb mc md ki me mf mg km mh mi mj mk dt translated">通过蒙戈URI连接字符串连接。</h2><p id="b1db" class="pw-post-body-paragraph jv jw hu jx b jy ml iv ka kb mm iy kd ke mn kg kh ki mo kk kl km mp ko kp kq hn dt translated">下面给出了使用mongoose模块从Node.js服务器安全连接到该实例所需的连接字符串。</p><pre class="jk jl jm jn fq mq mr ms mt aw mu dt"><span id="ec92" class="lq lr hu mr b fv mv mw l mx my">mongodb://user:user123@localhost:27017/test</span></pre><p id="1f59" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">是的。您已经在远程服务器上安全地安装和配置了MongoDB。让我们休息一会儿。</p><p id="e1e5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在下一篇教程中，让我们使用<a class="ae mz" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>并创建一个映像，并自动完成这一过程，这样，在任何情况下，只需一个Docker映像就可以在一条命令中安装并保护MongoDB。</p><p id="3259" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">谢谢你。</p></div><div class="ab cl nj nk hc nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="hn ho hp hq hr"><p id="01f9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">参考资料:</p><div class="ky kz fm fo la lb"><a href="https://docs.mongodb.com/manual/tutorial/enable-authentication/" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab ej"><div class="ld ab le cl cj lf"><h2 class="bd hv fv z el lg eo ep lh er et ht dt translated">启用Auth - MongoDB手动</h2><div class="li l"><h3 class="bd b fv z el lg eo ep lh er et ek translated">您可以在启用访问控制之前或之后创建用户。如果您在创建任何之前启用了访问控制…</h3></div><div class="lj l"><p class="bd b gc z el lg eo ep lh er et ek translated">docs.mongodb.com</p></div></div><div class="lk l"><div class="nq l lm ln lo lk lp jt lb"/></div></div></a></div><div class="ky kz fm fo la lb"><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab ej"><div class="ld ab le cl cj lf"><h2 class="bd hv fv z el lg eo ep lh er et ht dt translated">在Ubuntu上安装MongoDB社区版- MongoDB手册</h2><div class="li l"><h3 class="bd b fv z el lg eo ep lh er et ek translated">由于旧版本的Ubuntu 16.04 POWER软件包中存在锁省略错误，您必须升级…</h3></div><div class="lj l"><p class="bd b gc z el lg eo ep lh er et ek translated">docs.mongodb.com</p></div></div><div class="lk l"><div class="nr l lm ln lo lk lp jt lb"/></div></div></a></div></div></div>    
</body>
</html>