<html>
<head>
<title>ML Programming Made [too much] Easy — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ML编程让[太多]变得简单—第2部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/ml-programming-made-too-much-easy-part-2-13a2dc9e5e91?source=collection_archive---------19-----------------------#2018-06-08">https://medium.com/hackernoon/ml-programming-made-too-much-easy-part-2-13a2dc9e5e91?source=collection_archive---------19-----------------------#2018-06-08</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="54bc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">机器学习(ML)，尤其是人工神经网络(ANN)，是我们今天可以使用的强大工具——你可以在<a class="ae jp" rel="noopener" href="/@alonn24/ml-programming-made-too-much-easy-part-1-cf9171e41dfb">第一部分</a>中读到关于它的所有内容。给定训练数据集，我们可以训练一个模型，该模型将为我们提供某些特征的预测，如预测给定平方英尺、卧室数量等的房价。如果你缺乏关于ML或ANN的知识，请阅读<a class="ae jp" rel="noopener" href="/@alonn24/ml-programming-made-too-much-easy-part-1-cf9171e41dfb">第1部分</a>，它解释了什么是ANN及其构建模块。接下来，我们将了解如何使用Tensorflow构建、训练和预测模型。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/ff5477769d90b8834e4e277fcabcc28a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cp4qxFRYWHwCacam"/></div></div></figure><p id="48fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Tensorflow是一个开源的ML框架，供每个人使用。Tensorflow试图让简单的事情变得简单，让复杂的事情变得可行。通过Tensorflow，可以使用简单的python API轻松创建、训练和预测人工神经网络。</p><p id="5a93" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要创建一个ANN模型，首先我们需要创建一个输入层，其输入节点的数量与我们要提供给模型的输入参数的数量一样多。接下来，我们需要创建隐藏层，它将为模型提供持久存储所需数据所需的深度，最后，我们需要创建输出层，它包括输出所需的所有节点。所有层的权重和偏差都将被初始化，并准备进行优化。我们还需要陈述其他已知参数，如损失函数、训练优化策略，可能还有一个日志记录器。</p><p id="64c9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下是用python编写的张量流人工神经网络模型的示例:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kc kd l"/></div></figure><p id="ff46" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看起来相当苛刻，让我们深入探讨，打破这里的复杂性。首先，我们有两个初始化函数——一个用于权重，一个用于偏差。zero_weights函数创建一个从一层到另一层的初始权重变量，zero _ biases为所有可用节点创建一个偏差变量。</p><p id="f770" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，我们将从输入层开始创建ANN中的所有层。假设我们的输入有9个变量，我们创建一个新的tf变量，从0到9，因为它是第一层。然后我们再创建3个隐藏层，50个节点-&gt; 100个节点-&gt; 50个节点，命名为“层1”，“层2”和“层3”。接下来，我们创建只有一个输出的输出层。最后，我们创建损失函数，命名为成本，这是损失函数的另一个名称。损失函数将通过均方根来测量，以找到与期望值最接近的值，优化策略是adam，它是一种随机优化方法。这是目前已知的最佳策略。</p><p id="92d9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了训练一个新创建的模型，我们需要向它提供训练数据集。随着训练过程的发展，权重和偏差变得更加精确，以优化输入组合并减少损失函数。</p><p id="9a3c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是一个给定X输入和Y预期输出的模型训练示例:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kc kd l"/></div></figure><p id="0dc7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，模型只是一个保存我们之前创建的所有变量的对象。Df是数据帧，值是预期的输出列。x将是值列旁边的所有内容，Y将只是Y列。现在，我们运行优化器50个时段，每个时段将输入所有数据集并执行优化器以优化结果。然后，在每个时期之后，我们将计算损失函数，并观察它随着时间的推移而减少。</p><p id="16d6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们必须用新的测试数据集来验证创建的模型。测试数据集必须是模型之前没有看到的新数据集，并且将向我们显示误差保持较低，因为它可能由于各种原因产生错误的结果。其中一个原因可能是当模型被训练为适合特定训练数据集时发生的过度拟合。例如，它可能是由太多的纪元引起的。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff ke"><img src="../Images/f3995a31a24281c815347abedddfe7a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*eap-Ox0qwOEOorYP"/></div></figure><p id="66d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建Tensorflow模型需要大约35行代码，其中包含大量样板代码、默认值和需要指定的最佳实践。Keras是一个试图解决这个问题的新工具。Keras是构建在Tensorflow等其他框架之上的高级API，提供了几乎不费吹灰之力就能构建ANN模型的能力。</p><p id="62d3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">相比之下，同样的Tensorflow模型可以用Keras用6行代码构建:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="kc kd l"/></div></figure><p id="deb9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Keras提供了该实现的简化版本，旨在提供快速实验参考。虽然Keras是轻量级的，但它提供了很好的定制级别，我们今天不仅可以用它来做实验，还可以用它来实现生产级别的特性。实现要好得多，所有的最佳实践都是在幕后实现的。使用Keras和建立ann比你想象的要快得多。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kf"><img src="../Images/833156ccd343edd5a3d695361670eb9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5vuvSdSYg_JU35SV"/></div></div></figure></div></div>    
</body>
</html>