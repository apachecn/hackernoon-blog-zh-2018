<html>
<head>
<title>How to Build a Smart Chatbot Assistant with ChatEngine and IBM Watson Assistant</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用ChatEngine和IBM Watson Assistant搭建智能聊天机器人助手</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-build-a-smart-chatbot-assistant-with-chatengine-and-ibm-watson-assistant-ffe3f43436b8?source=collection_archive---------9-----------------------#2018-06-12">https://medium.com/hackernoon/how-to-build-a-smart-chatbot-assistant-with-chatengine-and-ibm-watson-assistant-ffe3f43436b8?source=collection_archive---------9-----------------------#2018-06-12</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="4120" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">Pubnub与IBM Watson相结合，可以让开发人员和企业主通过创建智能助手来为您解答简单的问题，从而简化他们的工作。</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/3c16841de64c07aab800f81314744457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGnQJqaw9usCcgYqnmXisA.png"/></div></div></figure><p id="53af" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">聊天机器人，无论是客服人员还是网上商店的购物助理，都已经成为我们与企业互动的常见方式。智能机器人和助手是许多企业的前线，现在是建立解决问题的智能方法的最佳时机。</p><p id="48e4" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">你可能想知道是否有可能创造一个你自己的智能助手。简单的回答是肯定的，这正是我们今天要通过聊天引擎和<a class="ae kr" href="https://www.ibm.com/watson/services/conversation/" rel="noopener ugc nofollow" target="_blank"> IBM沃森助手</a>完成的。我们的机器人将回答那些希望了解更多关于<a class="ae kr" href="https://hackernoon.com/tagged/pubnub" rel="noopener ugc nofollow" target="_blank"> PubNub </a>信息的人的基本问题，但是你的机器人可以按照你的意愿进行训练和定制。我们也将向您展示如何做到这一点。</p><p id="0854" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这里有完整的GitHub回购项目。T9】</p><p id="d7af" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">你还需要注册Pubnub！T13】</p><h1 id="584c" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">它是如何工作的👩‍💻</h1><p id="c8c2" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">在我们进入代码之前，让我们根据我们的用户将如何与我们的助手交互来绘制逻辑。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff lp"><img src="../Images/a63e1cc0d56c438d8d046839d524ed0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9SfYlMP0_YnmjIcY.jpg"/></div></div></figure><p id="7422" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">首先，用户通过聊天引擎提出一个问题，然后向我们的聊天助手发送一条消息。我们有两个ChatEngine连接的原因是为了确保我们的bot可以同时处理多个连接。在我们的具体案例中，我们将在同一个客户端上创建聊天机器人，但在理想情况下，让聊天机器人在单独的客户端上运行是一个好主意。</p><p id="0471" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">一旦机器人通过ChatEngine接收到消息，它就将消息发送给<a class="ae kr" href="https://www.pubnub.com/products/functions/" rel="noopener ugc nofollow" target="_blank"> PubNub函数</a>。这背后的目标是减少我们拥有的后端代码量，只关注重要的事情——体验。函数是我们将消息传递应用程序连接到IBM Watson Assistant服务的方式。</p><p id="f491" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在我们的<a class="ae kr" href="https://www.pubnub.com/docs/blocks-catalog" rel="noopener ugc nofollow" target="_blank"> BLOCKS目录</a>中，有一个<a class="ae kr" href="https://www.pubnub.com/docs/blocks-catalog/pubnub-tutoring-bot" rel="noopener ugc nofollow" target="_blank"> IBM Assistant BLOCK </a>，它需要一点配置，一旦配置完成，它将被连接到IBM Watson。该函数将查询Watson并得到回复，然后将回复发送给我们的客户。</p><h1 id="f0f2" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">ChatEngine和Watson入门</h1></div><div class="ab cl lq lr hc ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hn ho hp hq hr"><h2 id="6d6a" class="lx kt hu bd ku ly lz ma ky mb mc md lc ke me mf le ki mg mh lg km mi mj li mk dt translated">配置聊天引擎🚒</h2><p id="9092" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">为聊天机器人构建聊天界面和后端是一件既有挑战性又耗时的事情。我们将使用ChatEngine来缓解这一问题，这是一个基于PubNub的框架，使跨平台构建变得轻而易举。</p><p id="697f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">首先必须在PubNub中配置一个新的ChatEngine应用程序。你可以在我们的ChatEngine quickstart  中<a class="ae kr" href="https://www.pubnub.com/docs/tutorials/chatengine#step-one-pubnub-keys" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv">做到这一点，它将为你提供你的pub/sub密钥以及为ChatEngine配置你的密钥集。</strong></a></p><h2 id="51b3" class="lx kt hu bd ku ly lz ma ky mb mc md lc ke me mf le ki mg mh lg km mi mj li mk dt translated">沃森+积木🍫</h2><p id="67f5" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">一旦我们配置了ChatEngine，我们就可以开始构建我们的助手了。</p><p id="a9eb" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">首先，在我们的ChatEngine模块中创建一个新函数。我们可以将这个函数称为“assistant”，有一个“On Request”事件，并将我们的通道名设为“Assistant”。添加了新函数后，我们可以继续添加代码来连接到IBM Assistant。</p><p id="b8cc" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这实际上是在<a class="ae kr" href="https://www.pubnub.com/docs/blocks-catalog/pubnub-tutoring-bot" rel="noopener ugc nofollow" target="_blank"> IBM Assistant块</a>中可用的代码的一个版本，但是稍微做了一些修改，以便我们可以使它适合我们的交互模型。特别是，如果我们看第55-65行，我们会发现我们处理回应的方式和从客户那里获取数据的方法已经改变。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ml mm l"/></div></figure><p id="1e7e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">你会注意到，在上面的函数代码中，我们使用保险库来访问我们的模块可用的某些密钥。我们需要在我们的金库中再添加三把钥匙，这三把钥匙可以在设置Watson时找到。</p><p id="6435" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">沃森配置</strong>🤸</p><p id="859c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">前往沃森<a class="ae kr" href="https://console.bluemix.net/registration/" rel="noopener ugc nofollow" target="_blank">领取钥匙。如果你还没有，请在你的Bluemix控制台</a>上<a class="ae kr" href="https://console.bluemix.net/catalog/services/watson-assistant-formerly-conversation" rel="noopener ugc nofollow" target="_blank">设置一个Watson实例。您将看到，使用新的Watson资源，您将拥有一个用户名和密码。查看它们，并将其插入到我们刚刚创建的助手功能中的vault中。我们需要的下一个键是workspaceID，我们可以转到Bluemix控制台中的启动工具并创建一个工作区。</a></p><p id="cf0d" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在这里，我们可以从头开始创建一个工作区，也可以使用一个示例。对于这个例子，让我们以客户服务为例。进入工作区后，我们可以打开侧面的汉堡菜单，进入“改善”选项卡。在页面顶部附近，我们应该会看到一个凭据按钮，单击该按钮可以获得我们的workspaceID。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mn"><img src="../Images/9f6d9d4029302866d95f6784d4422611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OQLJZge-K11x68Ub.png"/></div></div></figure><p id="ba85" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在我们有了钥匙，我们的保险库应该是这样的。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mn"><img src="../Images/cdc2f4897ecf1c3284036863138dc0ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yEgLyOErlOO7bPxZ.png"/></div></div></figure><p id="1d68" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">此时，我们已经让应用程序的齿轮工作了。我们创建了一个结构，该结构将从我们的机器人接收消息，并将这些数据发送给我们的助手，还将我们的助手连接起来，以便这些消息可以得到有意义的响应。</p><p id="804b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">让我们开始开发我们的客户端及其接口。</p><h1 id="3b90" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">我，我的机器人，还有我🤖</h1><p id="1c23" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">从客户的角度来看，我们要做两件事。第一个是用户可以提交消息的输入，第二个是可以将数据发送给我们的函数的机器人。理想情况下，我们应该将这两个组件分开，但是为了简单起见，我们将它们都运行在同一个客户端上。</p><p id="3312" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">首先，让我们通过使用create-react-app工具创建一个基本的React项目。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="b85a" class="lx kt hu mp b fv mt mu l mv mw">$ npx create-react-app Watson-Assistan</span></pre><p id="4472" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如果你的npm版本低于5.2，请随意使用<code class="eh mx my mz mp b">npm</code>而不是<code class="eh mx my mz mp b">npx</code>。两者之间的区别基于安装的范围以及命令是否是一次性的。如果你需要更多信息，请阅读<a class="ae kr" href="https://blog.npmjs.org/post/162869356040/introducing-npx-an-npm-package-runner" rel="noopener ugc nofollow" target="_blank"> npm的博客</a>。</p><p id="e4f7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">该文件夹现在应该已经设置好了，让我们导航到它。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="2b85" class="lx kt hu mp b fv mt mu l mv mw">cd Watson-Assistant/</span></pre><p id="a100" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">太好了！我们的项目树应该看起来像这样。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="f8cc" class="lx kt hu mp b fv mt mu l mv mw">|-- Watson-Assistant <br/>    |-- .gitignore <br/>    |-- README.md <br/>    |-- package-lock.json <br/>    |-- package.json <br/>    |-- public <br/>    |  |-- favicon.ico <br/>    |  |-- index.html <br/>    |  |-- manifest.json <br/>    |-- src <br/>    |-- App.css <br/>    |-- App.js <br/>    |-- App.test.js <br/>    |-- index.css <br/>    |-- index.js <br/>    |-- logo.svg <br/>    |-- registerServiceWorker.js</span></pre><p id="0481" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在这里，我们将拿出create-react-app工具为我们留下的一些样板文件。</p><p id="5088" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们可以干掉<code class="eh mx my mz mp b">logo.svg</code>和<code class="eh mx my mz mp b">registerServiceWorker.js</code>。除了清理我们的项目，没有什么特别的原因，但是如果你觉得你需要更多地了解为什么服务人员文件会在那里，看看主GitHub repo上的这个<a class="ae kr" href="https://github.com/facebook/create-react-app/issues/2398" rel="noopener ugc nofollow" target="_blank">问题</a>。</p><p id="4814" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">清理完我们的目录后，我们的结构应该像这样。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="7a38" class="lx kt hu mp b fv mt mu l mv mw">|-- Watson-Assistant <br/>    |-- .gitignore <br/>    |-- package-lock.json <br/>    |-- package.json <br/>    |-- public <br/>    |   |-- favicon.ico <br/>    |   |-- index.html <br/>    |   |-- manifest.json <br/>    |-- src <br/>    |-- index.css <br/>    |-- index.js</span></pre><p id="2890" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在让我们来看看我们的大部分应用程序将要放置的文件:<em class="na"/><a class="ae kr" href="https://github.com/nxsyed/commun-ai/blob/master/src/index.js" rel="noopener ugc nofollow" target="_blank"><em class="na">index . js</em></a>。</p><p id="8b9f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们将从生命周期和我们将在浏览器中呈现的内容开始。首先，确保我们的包中有ChatEngine。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="07d8" class="lx kt hu mp b fv mt mu l mv mw">$ npm i chat-engine</span></pre><p id="82b8" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在这一点上，我还建议在GitHub 上查看我的<a class="ae kr" href="https://github.com/nxsyed/commun-ai/blob/master/package.json" rel="noopener ugc nofollow" target="_blank"> package.json文件。在这里，您可以完全跟随，而不会破坏您的代码。我会尽量确保我解释了我使用的每个包，这样你就能更好地理解每样东西是如何适应的。</a></p><p id="6247" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">现在我们有了包，让我们开始编码吧。</p><p id="3924" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">要创建我们的客户端，我们需要向我们的ChatEngine客户端提供我们之前制作的ChatEngine应用程序的密钥。在<a class="ae kr" href="http://admin.pubnub.com/?utm_source=Syndication&amp;utm_medium=Medium&amp;utm_campaign=SYN-CY18-Q2-Medium-Jun-12" rel="noopener ugc nofollow" target="_blank"> PubNub管理仪表板</a>上选择我们的应用，然后选择我们的密钥集，我们就可以获得发布和订阅密钥。然后，我们可以像这样创建我们的客户机对象。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="939b" class="lx kt hu mp b fv mt mu l mv mw">const ChatClient = ChatEngineCore.create({ <br/>    publishKey: 'pub-c-e1295433-4475-476d-9e37-4bdb84dacba0',    subscribeKey: 'sub-c-890a0b26-6451-11e8-90b6-8e3ee2a92f04'<br/>},{ <br/>    globalChannel: 'watson-assistant' <br/>});</span></pre><p id="4883" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">因为我们在同一个客户端上创建聊天客户端和聊天机器人，所以我们将复制它，但是将名称改为聊天机器人。</p><p id="1d8e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们建立的每个连接都有一个用户名也很好，所以让我们为用户名创建一个模板，如下所示:</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="68f7" class="lx kt hu mp b fv mt mu l mv mw">const now = new Date().getTime(); const username = ['user', now].join('-');</span></pre><p id="b4c5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">将我们的用户和聊天机器人连接到我们的聊天引擎。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="613c" class="lx kt hu mp b fv mt mu l mv mw">ChatClient.connect(username, { signedOnTime: now }); ChatBot.connect(`${now}bot`, { signedOnTime: now });</span></pre><p id="1782" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">创建我们的聊天类，看看不同的生命周期方法。</p><p id="da1a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">构造函数是一个很好的起点，在这里我们将为我们的聊天实例分配变量。我们也可以初始化所有我们想存储在状态中的变量。</p><p id="9f70" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">就我个人而言，我想用这个<a class="ae kr" href="https://www.npmjs.com/package/react-clippy" rel="noopener ugc nofollow" target="_blank">反应-剪辑包</a>作为我们的助手。我们可以使用不同的动画角色来展示我们的信息并制作动画。对于Clippy，我们需要一个可以播放的动画，所以我将在我的状态中定义它。我们还需要用户给出的输入和我们从函数中得到的响应。</p><p id="6526" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv"> <em class="na">注:此贴与微软无关，他们与此</em> </strong>无关</p><p id="10e7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">最后，我们的构造函数看起来像这样。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="6e1a" class="lx kt hu mp b fv mt mu l mv mw">constructor() { super(); this.chat = new ChatClient.Chat(`${now}chat`); <br/>this.bot = new ChatBot.Chat(`${now}chat`); <br/>this.state = { <br/>    reply: 'Ask Me Something!', <br/>    chatInput: '', <br/>    animation: 'Congratulate' }; <br/>}</span></pre><p id="71b5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在进一步讨论之前，最好对render函数做进一步的阐述。我们知道我们将接受输入，所以我们需要某种输入框。同样，我们将显示一个响应，我将添加精彩的剪辑。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="56e4" class="lx kt hu mp b fv mt mu l mv mw">render() { <br/>   return ( <br/>     &lt;div style={container}&gt; <br/>       &lt;div style={{height:100, width:100}}&gt; <br/>          &lt;p&gt; {this.state.reply} &lt;/p&gt; </span><span id="c9a7" class="lx kt hu mp b fv nb mu l mv mw">          &lt;Clippy <br/>             actor={ 'Clippy' } <br/>             animation={ this.state.animation } /&gt; </span><span id="7dfe" class="lx kt hu mp b fv nb mu l mv mw">          &lt;input <br/>             id = "chat-input" <br/>             type = "text" <br/>             name = "" <br/>             value = { this.state.chatInput } <br/>             onChange = { this.setChatInput } <br/>             onKeyPress = { this.handleKeyPress } /&gt; </span><span id="925f" class="lx kt hu mp b fv nb mu l mv mw">          &lt;input <br/>             type = "button" <br/>             onClick = { this.sendChat } <br/>             value = "Send Chat" /&gt; <br/>       &lt;/div&gt; <br/>     &lt;/div&gt; ); }</span></pre><p id="6e92" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">还有几个其他的函数来完成聊天类中的一些功能，比如按回车键来发送消息，但是我会让你自己去探索。我们现在要看的是发送消息部分。有两个功能，它们直接关系到我们项目的工作流程。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="430f" class="lx kt hu mp b fv mt mu l mv mw">sendChat = () =&gt; { <br/>  if (this.state.chatInput) { <br/>    this.chat.emit('message', { <br/>      text: this.state.chatInput, <br/>      channel: `${now}chat` <br/>    }); <br/>    this.setState({ chatInput: '' }) <br/>    this.setState({ animation: 'Processing', reply: '' }); } <br/>} <br/>componentDidMount() { <br/>  this.bot.on('message', (payload) =&gt; {      axios.get(`https://pubsub.pubnub.com/v1/blocks/sub-key/sub-c-890a0b26-6451-11e8-90b6-8e3ee2a92f04/chat? question=${payload.data.text}`) .then(response =&gt; { this.setState({ animation: 'Writing', reply: response.data }); }); <br/>  }); <br/>}</span></pre><p id="0a7b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">sendChat功能允许用户向机器人发送消息。请注意我们是如何发出信息的，我们是如何根据时间来定义通道的。这使得每次聊天都可以在自己的私人会话中进行，这样我们就不会打断其他客户可能正在进行的对话。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nc"><img src="../Images/6adda69ef376b491f8e1e9118b9be2cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Ey7jOkDvzaMnb5ESywkMdg.gif"/></div></div></figure><p id="f762" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们还需要确保我们的机器人监听传入的消息。因此，当聊天组件已经安装，我们需要确保我们的机器人发送消息给我们的功能，然后用消息更新我们的组件。为了完成这个请求，我使用了axios包，你可以在这里了解更多信息。</p><p id="6115" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">最后一步。我们需要确保一旦我们的ChatEngine连接建立，我们就呈现我们的聊天组件。我们可以通过将它添加到文件的底部来做到这一点。</p><pre class="jk jl jm jn fq mo mp mq mr aw ms dt"><span id="aa51" class="lx kt hu mp b fv mt mu l mv mw">ChatClient.on('$.ready', () =&gt; { <br/>   ChatBot.on('$.ready', () =&gt; { <br/>     ReactDOM.render( &lt;Chat /&gt; , document.getElementById('root') );     }); <br/>});</span></pre><h1 id="2fa5" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">我们的聊天机器人开始运行了！🏃‍</h1><p id="0de3" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">这是构建更独特的东西的一个很好的起点。探索IBM Assistant的文档来训练我们的机器人变得更聪明，并且在它们的响应中更有深度，这绝对是一个好主意。ChatEngine可以做很多很酷的事情来与人和服务即时联系。我很想看看你接下来会做什么🙂。</p><h1 id="9c77" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">在Twitter / Instagram上关注我！@nxsyed </h1></div><div class="ab cl lq lr hc ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hn ho hp hq hr"><p id="0f13" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><em class="na">最初发表于</em><a class="ae kr" href="https://www.pubnub.com/blog/chatengine-chatbot-ibm-watson-assistant-tutorial/?utm_source=Syndication&amp;utm_medium=Medium&amp;utm_campaign=SYN-CY18-Q2-Medium-Jun-12" rel="noopener ugc nofollow" target="_blank">T5【www.pubnub.com】</a><em class="na">。</em></p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nd mm l"/></div></figure></div></div>    
</body>
</html>