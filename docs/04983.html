<html>
<head>
<title>Setting Up Your Machine for ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为ML设置您的机器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/setting-up-your-machine-for-ml-919cfcd4e18d?source=collection_archive---------21-----------------------#2018-06-12">https://medium.com/hackernoon/setting-up-your-machine-for-ml-919cfcd4e18d?source=collection_archive---------21-----------------------#2018-06-12</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="58d0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">作为一名软件工程出身的人，我认为在进入<em class="jp">机器学习</em>之前，我应该做的第一件事就是安装我的电脑。我天真地以为可能只需要几个小时。我完全错了。</p><p id="e7cb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我想用anaconda和CUDA sdk的正确版本设置pytorch。这应该是一个相当简单的练习。幸运的是，我所有的机器都有NVIDIA GPUs。所以我认为这只是一个安装正确软件的问题，我应该很快就能完成。</p><p id="d70e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">哦..哦..没那么快。</p><h2 id="6abc" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated"><strong class="ak"> MacBook Pro </strong></h2><p id="78b1" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">首先，我试用了装有NVIDIA GeForce 750m的mac book pro。安装完所有东西后，conda  env创建失败</p><pre class="kq kr ks kt fq ku kv kw kx aw ky dt"><span id="c8ea" class="jq jr hu kv b fv kz la l lb lc">conda env create<br/>Solving environment: failed</span><span id="0af4" class="jq jr hu kv b fv ld la l lb lc">ResolvePackageNotFound:<br/>  - cuda90</span></pre><p id="9437" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">几次尝试之后，我意识到Mac可能是最难设置的环境。</p><h2 id="4701" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">Ubuntu 16.04</h2><p id="bb62" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">接下来，我转移到运行Ubuntu 16.04的Linux桌面上。这台机器甚至无法安装NVIDIA驱动程序。这是一个装有很多软件的旧装置。我安装的任何东西都可能会弄坏别的东西，所以随它去吧。</p><h2 id="ec5e" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">Windows 10</h2><p id="b43a" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">然后我搬到了我的Windows 10桌面。这台机器很新，只有6个多月，我很少使用它。于是，我装了NVIDIA驱动，SDK，Anaconda，git。然后我运行了下面的代码来测试pytorch和CUDA是否能工作。</p><pre class="kq kr ks kt fq ku kv kw kx aw ky dt"><span id="33e1" class="jq jr hu kv b fv kz la l lb lc">&gt;&gt;&gt; import torch<br/>&gt;&gt;&gt; torch.cuda.is_available()<br/>True<br/>&gt;&gt;&gt; x = torch.randn( 4, 5 )<br/>&gt;&gt;&gt; print( x )<br/>tensor([[-0.1285, -0.2369, -0.3363,  0.1386,  0.1244],<br/>        [ 0.1818, -2.0207,  1.9165, -1.4153,  0.3645],<br/>        [-0.5384,  0.4833, -1.0172, -0.2509, -1.3831],<br/>        [ 1.9053, -1.7572, -0.0098, -0.0333, -1.8762]])<br/>&gt;&gt;&gt; device = torch.device("cuda")<br/>&gt;&gt;&gt; y = torch.ones_like( x , device=device )<br/>C:\Users\nsankaran\AppData\Local\conda\conda\envs\torch2\lib\site-packages\torch\cuda\__init__.py:116: UserWarning:<br/>    Found GPU0 NVS 510 which is of cuda capability 3.0.<br/>    PyTorch no longer supports this GPU because it is too old.</span><span id="0280" class="jq jr hu kv b fv ld la l lb lc">warnings.warn(old_gpu_warn % (d, name, major, capability[1]))<br/>THCudaCheck FAIL file=c:\programdata\miniconda3\conda-bld\pytorch_1524546371102\work\aten\src\thc\generic/THCTensorMath.cu line=15 error=48 : no kernel image is available for execution on the device<br/>Traceback (most recent call last):<br/>  File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br/>RuntimeError: cuda runtime error (48) : no kernel image is available for execution on the device at c:\programdata\miniconda3\conda-bld\pytorch_1524546371102\work\aten\src\thc\generic/THCTensorMath.cu:15</span></pre><p id="3a59" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">某些张量运算无法在GPU上执行。看起来这是一个问题，直到最后一步，Windows 10看起来非常有希望。</p><p id="9afd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这一点上，我已经花了15个多小时，没有明确和简单的方法来安装我需要的软件。我认为安装我的机器很难。</p><h2 id="62b8" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">图纸空间(云GPU)</h2><p id="ef14" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">与此同时，我用<a class="ae lh" href="https://www.paperspace.com/" rel="noopener ugc nofollow" target="_blank">paperspace.com</a>创建了一个账户，并试图创建一个支持GPU的虚拟机。但是，paperspace不起作用。我想使用<code class="eh le lf lg kv b">fastai</code>模板或<code class="eh le lf lg kv b">linux</code>模板。两者都没有。</p><figure class="kq kr ks kt fq lj fe ff paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="fe ff li"><img src="../Images/821a1a140ed0985833329070a550b51c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WBxI1C5aXot2h8kRoqFSAQ.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">Paperspace GPU request dialog</figcaption></figure><p id="af08" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我请求了几次GPU，但是没有任何反应。所以我认为paperspace还没有准备好。在这一点上，我是完全绝望的。</p><h2 id="f0e8" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">Ubuntu 16.04(再次)</h2><p id="a463" class="pw-post-body-paragraph ir is hu it b iu kl iw ix iy km ja jb jc kn je jf jg ko ji jj jk kp jm jn jo hn dt translated">我还有一台运行Ubuntu 16.04的NVIDIA GPU笔记本电脑。我想为什么不再试一次。</p><p id="921b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">到这个时候，我确切地知道需要做什么。所以我开始系统地安装软件，</p><ul class=""><li id="9053" class="lu lv hu it b iu iv iy iz jc lw jg lx jk ly jo lz ma mb mc dt translated">下载了NVIDIA GPU <a class="ae lh" href="https://www.geforce.com/drivers/results/134859" rel="noopener ugc nofollow" target="_blank">驱动</a></li><li id="02e5" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated">用于Ubundu 16.04的CUDA SDK<a class="ae lh" href="https://developer.nvidia.com/cuda-downloads?target_os=Linux&amp;target_arch=x86_64&amp;target_distro=Ubuntu&amp;target_version=1604&amp;target_type=deblocal" rel="noopener ugc nofollow" target="_blank">指令</a></li><li id="46f4" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated">安装CUDNN <a class="ae lh" href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html" rel="noopener ugc nofollow" target="_blank">指令</a></li><li id="7910" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated">为Python 3.6安装Anaconda】指令</li><li id="7c1b" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated">为Linux，Conda，Python 3.6和Cuda 9.1安装pytorch。Pytorch生成了简单的一行脚本来安装</li></ul><pre class="kq kr ks kt fq ku kv kw kx aw ky dt"><span id="a16f" class="jq jr hu kv b fv kz la l lb lc">conda create --name torch<br/>source activate torch<br/>conda install pytorch torchvision cuda91 -c pytorch</span></pre><p id="14f8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所有这些步骤都进展顺利。现在是测试时间。为了测试，我使用了下面的代码。</p><pre class="kq kr ks kt fq ku kv kw kx aw ky dt"><span id="7e97" class="jq jr hu kv b fv kz la l lb lc">import torch</span><span id="32fa" class="jq jr hu kv b fv ld la l lb lc">if torch.cuda.is_available():<br/>    print("cuda is available")</span><span id="d2c4" class="jq jr hu kv b fv ld la l lb lc">x = torch.randn( 4, 5 )<br/>    print( "x=\n", x )</span><span id="1546" class="jq jr hu kv b fv ld la l lb lc">device = torch.device("cuda")<br/>    y = torch.ones_like( x, device=device )<br/>    z = y.to( device )</span><span id="000a" class="jq jr hu kv b fv ld la l lb lc">a = y +z <br/>    print( "a=\n", a )<br/>    print( "a.to(\"cpu\")\n", a.to("cpu", torch.double) )</span><span id="a7ff" class="jq jr hu kv b fv ld la l lb lc">else:<br/>    print( "cuda is not available")</span></pre><p id="50af" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是结果，</p><pre class="kq kr ks kt fq ku kv kw kx aw ky dt"><span id="64e1" class="jq jr hu kv b fv kz la l lb lc">cuda is available<br/>x=<br/> tensor([[-1.1355, -1.0563,  1.1290,  0.5870, -1.4088],<br/>        [ 0.0311,  1.4285, -0.7489, -0.3020, -1.1053],<br/>        [-0.6777, -0.3300, -0.1201, -0.0400, -0.7543],<br/>        [-0.3388,  0.8496, -0.1594, -0.3230,  1.0891]])<br/>a=<br/> tensor([[ 2.,  2.,  2.,  2.,  2.],<br/>        [ 2.,  2.,  2.,  2.,  2.],<br/>        [ 2.,  2.,  2.,  2.,  2.],<br/>        [ 2.,  2.,  2.,  2.,  2.]], device='cuda:0')<br/>a.to("cpu")<br/> tensor([[ 2.,  2.,  2.,  2.,  2.],<br/>        [ 2.,  2.,  2.,  2.,  2.],<br/>        [ 2.,  2.,  2.,  2.,  2.],<br/>        [ 2.,  2.,  2.,  2.,  2.]], dtype=torch.float64)</span></pre><p id="dd12" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">终于在第四次尝试中成功了。</p><h2 id="8525" class="jq jr hu bd js jt ju jv jw jx jy jz ka jc kb kc kd jg ke kf kg jk kh ki kj kk dt translated">我的建议</h2><ul class=""><li id="e22f" class="lu lv hu it b iu kl iy km jc mi jg mj jk mk jo lz ma mb mc dt translated">使用更新的Windows 10或Ubuntu 16.04安装</li><li id="9ab9" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated">按照提供的顺序安装软件</li><li id="781b" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated">希望一切正常</li></ul><p id="2b78" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是真棒有Linux笔记本电脑安装与ML的东西。</p></div></div>    
</body>
</html>