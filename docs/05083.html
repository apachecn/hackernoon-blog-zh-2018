<html>
<head>
<title>Creating a Carousel Using Only Jade(Pug), Javascript, jQuery and CSS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">仅使用Jade(Pug)、Javascript、jQuery和CSS创建一个旋转木马</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/creating-a-carousel-using-only-jade-pug-javascript-jquery-and-css-b69576eca9a2?source=collection_archive---------12-----------------------#2018-06-16">https://medium.com/hackernoon/creating-a-carousel-using-only-jade-pug-javascript-jquery-and-css-b69576eca9a2?source=collection_archive---------12-----------------------#2018-06-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="191f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">步骤1:在页面中创建div，它将包含carousel元素</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="37b6" class="jy jz hu ju b fv ka kb l kc kd">.gallery<br/> .gallery-main<br/>   .gallery-main-image<br/>    img(src=”/images/gallery3.jpg”)<br/>   .gallery-filmstrip<br/>    a(href=””)<br/>     img(src=”/images/gallery1.jpg”)<br/>    a(href=””)<br/>     img(src=”/images/gallery2.jpg”)<br/>    a(href=””)<br/>     img(src=”/images/gallery3.jpg”)<br/>    a(href=””)<br/>     img(src=”/images/gallery4.jpg”)<br/>    a(href=””)<br/>     img(src=”/images/gallery5.jpg”)</span></pre><p id="0f93" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">步骤2:为你的转盘中的所有元素设置样式:</p><p id="c22c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">显示的图像库:</p><ul class=""><li id="3130" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">所选图像显示周围的div</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="5475" class="jy jz hu ju b fv ka kb l kc kd">/*set styles for the wrapper around the image that will be displayed on click*/</span><span id="5fea" class="jy jz hu ju b fv kn kb l kc kd">.gallery { <br/>  background-color: black;<br/>}</span><span id="460a" class="jy jz hu ju b fv kn kb l kc kd">.gallery &gt; .gallery-main { <br/>  position: relative; <br/>  height: 400px; <br/>  overflow: hidden;<br/>}</span></pre><ul class=""><li id="fe4d" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">包含图像本身的div的div</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="5901" class="jy jz hu ju b fv ka kb l kc kd">/*set styles for the inner container for the image that will be displayed on click*/</span><span id="fb6a" class="jy jz hu ju b fv kn kb l kc kd">.gallery &gt; .gallery-main &gt; .gallery-main-image { <br/>  position: absolute; <br/>  top: 0; bottom: 0; <br/>  right: 0; left: 0;<br/>}</span></pre><ul class=""><li id="1bfa" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">图像本身</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="c172" class="jy jz hu ju b fv ka kb l kc kd">/*set styles for the image itself*/</span><span id="8450" class="jy jz hu ju b fv kn kb l kc kd">.gallery &gt; .gallery-main &gt; .gallery-main-image &gt; img { <br/>  display: block; <br/>  margin: 0 auto; <br/>  max-height: 100%; <br/>  max-width: 100%; <br/>  height: 400px;<br/>}</span></pre><p id="9986" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">包含要显示的图像缩略图的连续画面:</p><ul class=""><li id="4222" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">电影胶片的容器</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="a1f5" class="jy jz hu ju b fv ka kb l kc kd">/*set styles for the filmstrip container*/</span><span id="7b54" class="jy jz hu ju b fv kn kb l kc kd">.gallery &gt; .gallery-filmstrip { <br/>  position: relative; <br/>  height: 280px; <br/>  margin-top: 10px;<br/>}</span></pre><ul class=""><li id="43bf" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">电影里的一切</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="ee08" class="jy jz hu ju b fv ka kb l kc kd">/*set styles for everything inside the filmstrip container*/</span><span id="756a" class="jy jz hu ju b fv kn kb l kc kd">.gallery &gt; .gallery-filmstrip &gt; * { <br/>  position: absolute; <br/>  top: 0; <br/>  left: 0;<br/>}</span></pre><ul class=""><li id="5fae" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">将幻灯片中的所有内容放在中间</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="1723" class="jy jz hu ju b fv ka kb l kc kd">/*position everything inside the filmstrip in the center*/<br/>.gallery &gt; .gallery-filmstrip &gt; * { <br/>  position: absolute; <br/>  top: 0; <br/>  left: 0;<br/>}</span></pre><ul class=""><li id="ff39" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">连续画面中图像的动画</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="2557" class="jy jz hu ju b fv ka kb l kc kd">/*set animation class to the filmstrip on click*/<br/>.gallery &gt; .gallery-filmstrip-animated &gt; * { <br/>  transition: transform 1s, opacity 1s;<br/>}</span></pre><ul class=""><li id="eff8" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">为容器中的所有图像设置高度和宽度</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="d70b" class="jy jz hu ju b fv ka kb l kc kd">/*set a height and width for the gallery filmstrip images*/<br/>.gallery &gt; .gallery-filmstrip img { <br/>  height: 200px; <br/>  width: 200px;<br/>}</span></pre><p id="1a5d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">第三步:使用<a class="ae ko" href="https://hackernoon.com/tagged/jquery" rel="noopener ugc nofollow" target="_blank"> jQuery </a>和<a class="ae ko" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> Javascript </a>创建函数，这将允许你使用刚刚创建的样式和动画遍历你的图像。</p><ul class=""><li id="451f" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">初始化图库</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="08dc" class="jy jz hu ju b fv ka kb l kc kd">const initializeGallery = function() {<br/> positionGalleryFilmstrip(0, false)</span><span id="4032" class="jy jz hu ju b fv kn kb l kc kd">$(‘.gallery-filmstrip &gt; *’).on(‘click’, function(event) {<br/>  event.preventDefault();<br/>  const cell = $(this);<br/>  const index = cell.index()<br/>  console.log(‘CLICKED’, index)<br/>  positionGalleryFilmstrip(index-2)<br/>  })<br/> }</span><span id="b042" class="jy jz hu ju b fv kn kb l kc kd">initializeGallery()</span></pre><ul class=""><li id="e4e8" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">确定将在电影胶片中可见的索引，并使用偏移量来确保无论我们在哪个索引上，结果都是0，1，2，3，4。我们如何通过使用for循环和模运算来做到这一点</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="44b5" class="jy jz hu ju b fv ka kb l kc kd">const visibleIndicies = function(totalNumberOfCells, numberOfVisibleCells, offset){<br/> let visible = []<br/> for (let index = 0; index &lt; numberOfVisibleCells; index++) {<br/> visible[index] = (index+offset) % totalNumberOfCells<br/> }<br/> return visible<br/>}</span></pre><ul class=""><li id="dfcd" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">根据每个位置在胶片上的位置，确定其Z索引、不透明度和变换</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="095a" class="jy jz hu ju b fv ka kb l kc kd">const zIndexForPosition = function(position){<br/> return (<br/>   (position === 0 || position === 4) ? 1 :<br/>   (position === 1 || position === 3) ? 2 :<br/>   3<br/>  )<br/> }<br/> <br/>const opacityForPosition = function(position){<br/> return (<br/>  (position === 0 || position === 4) ? 0.4 :<br/>  (position === 1 || position === 3) ? 0.7 :<br/>  1<br/>  )<br/> }<br/> <br/>const transformForPosition = function(position){<br/> return ({<br/>  0: ‘translateX(160px) translateY(31px) scale(.8)’,<br/>  1: ‘translateX(300px) translateY(31px) scale(1)’,<br/>  2: ‘translateX(500px) translateY(31px) scale(1.3)’,<br/>  3: ‘translateX(700px) translateY(31px) scale(1)’,<br/>  4: ‘translateX(860px) translateY(31px) scale(.8)’,<br/>  })[position]<br/> }</span></pre><ul class=""><li id="894e" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">根据图像(单元格)在胶片显示窗格(数组)中的位置确定其索引</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="61cb" class="jy jz hu ju b fv ka kb l kc kd">const visibleIndicies = function(totalNumberOfCells, numberOfVisibleCells, offset) {<br/> let visible = []<br/> for (let index = 0; index &lt; numberOfVisibleCells; index++) {<br/>  visible[index] = (index+offset) % totalNumberOfCells<br/> }<br/> return visible<br/>}</span></pre><ul class=""><li id="e332" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">该函数最复杂的部分——定位图像，使其将css样式应用于包含5个图像元素的数组中显示的特定索引</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="beee" class="jy jz hu ju b fv ka kb l kc kd">const positionGalleryFilmstrip = function(offset, animate=true){<br/> const filmstrip = $(‘.gallery-filmstrip’)<br/> const numberOfCells = 5;<br/> const cells = filmstrip.children()<br/> if (offset &lt; 0) offset += cells.length<br/> const visibleCells = visibleIndicies(cells.length, numberOfCells,  <br/> offset)<br/> if (animate){<br/>  filmstrip.addClass(‘gallery-filmstrip-animated’)<br/> }else{<br/>  filmstrip.removeClass(‘gallery-filmstrip-animated’)<br/> }<br/> cells.each(function(index){<br/>  const cell = $(this)<br/>  let position = visibleCells.indexOf(index)<br/>  if (isBefore(index, visibleCells, cells.length)){<br/>   cell.css({<br/>    display: ‘block’,<br/>    zIndex: ‘0’,<br/>    opacity: ‘0’,<br/>    transform: ‘translateX(100px) translateY(31px) scale(.6)’,<br/>  })<br/> }else if (isAfter(index, visibleCells, cells.length)){<br/>   cell.css({<br/>    display: ‘block’,<br/>    zIndex: ‘0’,<br/>    opacity: ‘0’,<br/>    transform: ‘translateX(890px) translateY(31px) scale(.6)’,<br/>  })<br/> }else if (position === -1){<br/>   cell.css({<br/>    display: ‘none’,<br/>    zIndex: ‘0’,<br/>   opacity: ‘1’,<br/>   transform: ‘’,<br/>  })<br/> }else{<br/>   cell.css({<br/>    display: ‘block’,<br/>    zIndex: zIndexForPosition(position),<br/>    opacity: opacityForPosition(position),<br/>    transform: transformForPosition(position),<br/>  })<br/> }<br/> if (position === 2){<br/> const src = cell.find(‘&gt; img’).attr(‘src’)<br/> const image = $(‘&lt;img&gt;’).attr(‘src’, src)<br/> const gallery = filmstrip.closest(‘.gallery’)<br/> const galleryMain = gallery.find(‘&gt; .gallery-main’)<br/> const currentImageWrapper = galleryMain.find(‘.gallery-main-<br/> image:first’)<br/> const nextImageWrapper = currentImageWrapper.clone()<br/> const nextImage = nextImageWrapper.find(‘&gt; img’)<br/>  if (nextImage.attr(‘src’) === src) return;<br/>  nextImage.attr(‘src’, src)<br/>  galleryMain.prepend(nextImageWrapper)<br/>  currentImageWrapper.fadeOut(function(){<br/>  currentImageWrapper.remove()<br/>  })<br/>  }<br/>  })<br/> }</span></pre><p id="d62b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">哇哦。！这里发生了什么事？让我们打开它，一步一步地看一遍:</p><ul class=""><li id="effc" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">创建一个定位图库幻灯片的函数，并将其设置为animate=true</li><li id="98e2" class="ke kf hu it b iu kp iy kq jc kr jg ks jk kt jo kj kk kl km dt translated">分配一些变量，这些变量将包含连续画面元素、单元格数量以及连续画面的子元素</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="918a" class="jy jz hu ju b fv ka kb l kc kd">const positionGalleryFilmstrip = function(offset, animate=true){<br/> const filmstrip = $(‘.gallery-filmstrip’)<br/> const numberOfCells = 5;<br/> const cells = filmstrip.children()<br/>}</span></pre><ul class=""><li id="e726" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">如果偏移量小于零，那么我们要将单元格总数加到这个数量上。例如，如果我们的偏移量是-1，并且我们有一个长度为39的图像数组，那么我们的新偏移量将是38。</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="7ebf" class="jy jz hu ju b fv ka kb l kc kd">if (offset &lt; 0) offset += cells.length<br/> const visibleCells = visibleIndicies(cells.length, numberOfCells, offset)</span></pre><ul class=""><li id="f460" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">如果上述条件为真，这意味着单元格可见，则将新的偏移量、长度和单元格数量传递给函数visible index。然后我们将把这个函数的值存储到visibleCells中</li><li id="7a67" class="ke kf hu it b iu kp iy kq jc kr jg ks jk kt jo kj kk kl km dt translated">如果animate为真，那么我们会将动画类添加到电影胶片中，否则不添加该类</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="5702" class="jy jz hu ju b fv ka kb l kc kd">if (animate){<br/> filmstrip.addClass(‘gallery-filmstrip-animated’)<br/> }else{<br/> filmstrip.removeClass(‘gallery-filmstrip-animated’)<br/> }</span></pre><ul class=""><li id="325b" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">现在将下面的css样式应用于每个单元格，这将为每个单元格提供我们需要的不透明度、zIndex和变换功能，具体取决于它在电影胶片中的位置</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="d215" class="jy jz hu ju b fv ka kb l kc kd">cells.each(function(index){<br/> const cell = $(this)<br/> let position = visibleCells.indexOf(index)<br/> if (isBefore(index, visibleCells, cells.length)){<br/>  cell.css({<br/>   display: ‘block’,<br/>   zIndex: ‘0’,<br/>   opacity: ‘0’,<br/>   transform: ‘translateX(100px) translateY(31px) scale(.6)’,<br/> })<br/> } else if (isAfter(index, visibleCells, cells.length)){<br/>  cell.css({<br/>   display: ‘block’,<br/>   zIndex: ‘0’,<br/>   opacity: ‘0’,<br/>   transform: ‘translateX(890px) translateY(31px) scale(.6)’,<br/> })<br/> }else if (position === -1){<br/>   cell.css({<br/>    display: ‘none’,<br/>    zIndex: ‘0’,<br/>    opacity: ‘1’,<br/>    transform: ‘’,<br/>  })<br/> }else{<br/>   cell.css({<br/>    display: ‘block’,<br/>    zIndex: zIndexForPosition(position),<br/>    opacity: opacityForPosition(position),<br/>    transform: transformForPosition(position),<br/>  })<br/> }</span></pre><ul class=""><li id="689a" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">现在我们需要给图片分配属性，这样我们就可以淡入淡出了</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="8590" class="jy jz hu ju b fv ka kb l kc kd">if (position === 2){<br/> const src = cell.find(‘&gt; img’).attr(‘src’)<br/> const image = $(‘&lt;img&gt;’).attr(‘src’, src)<br/> const gallery = filmstrip.closest(‘.gallery’)<br/> const galleryMain = gallery.find(‘&gt; .gallery-main’)<br/> const currentImageWrapper = galleryMain.find(‘.gallery-main-image:first’)<br/> const nextImageWrapper = currentImageWrapper.clone()<br/> const nextImage = nextImageWrapper.find(‘&gt; img’)<br/> if (nextImage.attr(‘src’) === src) return;<br/> nextImage.attr(‘src’, src)<br/> galleryMain.prepend(nextImageWrapper)<br/> currentImageWrapper.fadeOut(function(){<br/> currentImageWrapper.remove()<br/> })<br/> }<br/> })<br/> }</span></pre><ul class=""><li id="0281" class="ke kf hu it b iu iv iy iz jc kg jg kh jk ki jo kj kk kl km dt translated">最后但同样重要的是，我们需要确定一个单元格是在单元格之前还是之后</li></ul><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="6f7b" class="jy jz hu ju b fv ka kb l kc kd">const isBefore = function(index, visibleCells, cellsLength){<br/> let beforeFirstIndex = visibleCells[0]-1<br/> if (beforeFirstIndex &lt; 0) beforeFirstIndex += cellsLength<br/> return index === beforeFirstIndex<br/> }</span><span id="10ab" class="jy jz hu ju b fv kn kb l kc kd">const isAfter = function(index, visibleCells, cellsLength){<br/> let afterLastIndex = visibleCells[visibleCells.length-1]+1<br/> if (afterLastIndex &gt; cellsLength) afterLastIndex -= cellsLength<br/> return index === afterLastIndex<br/> }</span></pre><figure class="jp jq jr js fq ku"><div class="bz el l di"><div class="kv kw l"/></div></figure></div></div>    
</body>
</html>