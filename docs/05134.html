<html>
<head>
<title>Scrabblr — A React game with react-dnd and react-flip-move</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">scrabbler——一个带有反应-拒绝和反应-翻转-移动的反应游戏</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/scrabblr-a-react-game-with-react-dnd-and-react-flip-move-40cfaac786e2?source=collection_archive---------21-----------------------#2018-06-18">https://medium.com/hackernoon/scrabblr-a-react-game-with-react-dnd-and-react-flip-move-40cfaac786e2?source=collection_archive---------21-----------------------#2018-06-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="1c18" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是我在React中实现的一个字谜/文字游戏的高级概述。这不是有史以来最漂亮的代码，但我对我的第一个基于浏览器的游戏很满意。</p><h1 id="fc22" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">拼字游戏(scrabbblr)—提高你的拼字技能，同时享受无穷乐趣</h1><figure class="kp kq kr ks fq kt fe ff paragraph-image"><a href="https://scrabblr.herokuapp.com/"><div class="fe ff ko"><img src="../Images/489965806abf2c46a639dcdba43cf6ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d4ldJrlOxFf2SABu9HNteg.png"/></div></a><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Click me to play Scrabblr!</figcaption></figure><p id="8734" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">背景</strong>——我在React.js里看动画解决方案，无意中发现了约书亚·科莫的<a class="ae kn" href="https://github.com/joshwcomeau/react-flip-move" rel="noopener ugc nofollow" target="_blank"> react-flip-move </a> <a class="ae kn" href="http://joshwcomeau.github.io/react-flip-move/examples/#/scrabble?_k=8l9xbo" rel="noopener ugc nofollow" target="_blank">演示</a>。我看到了用他酷酷的拖放和动画动作界面构建各种类似拼字游戏的潜力。</p><h1 id="5cf1" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated"><strong class="ak">技术挑战</strong></h1><h2 id="0fac" class="la jq hu bd jr lb lc ld jv le lf lg jz jc lh li kd jg lj lk kh jk ll lm kl ln dt translated">装饰者与巴别塔</h2><p id="7e4e" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">Joshua Comeau的<a class="ae kn" href="https://github.com/joshwcomeau/react-flip-move" rel="noopener ugc nofollow" target="_blank"> react-flip-move </a>需要函数装饰器；create-react-app的编译器Babel不支持的语言功能。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><a href="https://babeljs.io/docs/plugins/syntax-decorators/"><div class="fe ff lt"><img src="../Images/a4730a4772709400d1e7fc960b4c6fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*cQUivCI1ey-ysWHsIHPi6Q.png"/></div></a></figure><p id="4d49" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">包<a class="ae kn" href="https://github.com/timarney/react-app-rewired" rel="noopener ugc nofollow" target="_blank"> react-app-rewired </a>通过在不弹出的情况下覆盖create-react-app Webpack配置解决了这个问题(这对于像我这样不想处理Webpack的复杂性的新手来说是非常可怕的)。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff lu"><img src="../Images/dfe6d8bc5ea5122d4ce0b673c961abaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v3nHcvuopO0c8_UWPdF5YQ.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">config-overrides.js</figcaption></figure><p id="e367" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上面的代码允许我注入<a class="ae kn" href="https://github.com/loganfsmyth/babel-plugin-transform-decorators-legacy" rel="noopener ugc nofollow" target="_blank">transform-decorators-legacy</a>插件(没有弹出)来处理decorator。一个问题解决了，还有许多问题要解决。</p><h2 id="bfb6" class="la jq hu bd jr lb lc ld jv le lf lg jz jc lh li kd jg lj lk kh jk ll lm kl ln dt translated">创建游戏循环</h2><p id="5e3e" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">对我来说，区分酷的东西和“游戏”的是游戏循环的概念。</p><p id="fd2f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">主游戏循环从用户输入开始(点击按钮开始新游戏)。用户洗牌并找到单词。</p><p id="553c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">每次用户改变磁贴的位置，我都会检查是否有有效的单词。如果这个单词是有效的，我就给这个单词打分，然后用这个单词的分数来增加总分数。我还将这个单词添加到一个“找到的单词”数组中，以便将来再次找到它时不会重复计数。</p><p id="01a8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当用户找到所有可能的单词(参见下面所有可能匹配问题的实现)或放弃(点击投降按钮)时，游戏循环结束，出现结果模式。</p><p id="b6f5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">事实的数据或来源都包含在<code class="eh lz ma mb mc b">state</code>中，并通过新的React.context API传递给我的组件(以避免<a class="ae kn" href="https://itnext.io/compound-components-with-react-v16-3-6679c752bd56" rel="noopener ugc nofollow" target="_blank">钻柱</a>)。当新的游戏循环开始时，这些值都在<code class="eh lz ma mb mc b">state</code>中重置。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff lu"><img src="../Images/d5bf4b1ce0c9a8a37aa740166f13ce58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bYiJEArRuL_C42oqE1SKgA.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Method to initializes game loop inside the App component</figcaption></figure><h2 id="7ff6" class="la jq hu bd jr lb lc ld jv le lf lg jz jc lh li kd jg lj lk kh jk ll lm kl ln dt translated">访问图块位置以查找字符</h2><p id="daa1" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">这个问题花了我令人尴尬的很长时间才解决。格子矩阵中图块的(x，y)位置包含在<code class="eh lz ma mb mc b">state.tiles</code>中。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff md"><img src="../Images/ca319beaea771555093b0f7562de724f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FdqAvNOZcpvXwa-Z4zj15w.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Tiles are created with default properties and held in state</figcaption></figure><p id="d95a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我需要能够根据字母的位置从瓷砖上刮下字母，并组装一个字符串进行验证。我的解决方案是一个完全的黑客工作，我不会在这里展示它——它是我的Github上的App.js中的<code class="eh lz ma mb mc b">checkForWords()</code>方法，急需重构。</p><h2 id="7879" class="la jq hu bd jr lb lc ld jv le lf lg jz jc lh li kd jg lj lk kh jk ll lm kl ln dt translated">验证单词</h2><p id="4cb4" class="pw-post-body-paragraph ir is hu it b iu lo iw ix iy lp ja jb jc lq je jf jg lr ji jj jk ls jm jn jo hn dt translated">我还需要一种快速的方法来检查字符串是否是有效的英语单词。我考虑的<a class="ae kn" href="https://www.wordsapi.com/" rel="noopener ugc nofollow" target="_blank">免费字典API的</a>每天允许的请求数非常低，而且延迟很高。我需要一个解决方案，让我能够快速查看详尽的本地列表。在包含270，000多个键值对的字典上调用的<code class="eh lz ma mb mc b">Object.hasOwnProperty()</code>方法运行良好且快速。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff me"><img src="../Images/7d872669ded5ad259b987de5bce41d6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tkqUOK9wajv9UGEvqJ4Qsw.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Check a single word against the Scrabble dictionary</figcaption></figure><p id="19c3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面的代码是我的解决方案，在给定一个字母数组的情况下，查找所有可能的有效单词。这就是我如何计算向用户显示的剩余单词数，并知道何时结束游戏循环。</p><p id="fc8f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我最初的尝试，在没有利用<code class="eh lz ma mb mc b">Object.hasOwnProperty()</code>方法和速度优化的情况下，花了将近十秒来计算所有可能的有效单词。这个实现对用户来说几乎是即时的，并且在新的游戏循环开始时被调用。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mf"><img src="../Images/423956d2c9e3ee177179c0766f2d73b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*choRe7lPf7kjPpsUwJhtHw.png"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Find all possible valid English words given an array of letters</figcaption></figure><p id="86a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">结论</strong></p><p id="7296" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我学到了很多建设这个项目，我很自豪的结果；我的游戏运行速度快，看起来也不错。最后，我想添加OAuth和数据持久性，高分记录保存，以及用户设计的水平。</p><p id="2b66" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我仍然是编程和网页设计的新手——我很想在评论中听到你的评论/建议/批评。</p><p id="8876" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这里玩<a class="ae kn" href="https://scrabblr.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">scrabbler！</a></p></div><div class="ab cl mg mh hc mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hn ho hp hq hr"><div class="kp kq kr ks fq ab cb"><figure class="mn kt mo mp mq mr ms paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><img src="../Images/0f96a9075df72d56ebc5f0bfdcc443c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*S0H89POj_i2ndJSRFebGtg.png"/></div></figure><figure class="mn kt mo mp mq mr ms paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><img src="../Images/420176155be8e1679cfc41ccdcadc6f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Rp4dAQfFd6Oex9_DzSH_YA.png"/></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek mt di mu mv">Thanks for reading!</figcaption></figure></div><blockquote class="mw mx my"><p id="f92c" class="ir is mz it b iu iv iw ix iy iz ja jb na jd je jf nb jh ji jj nc jl jm jn jo hn dt translated"><em class="hu">阅读下一条:</em></p><p id="029e" class="ir is mz it b iu iv iw ix iy iz ja jb na jd je jf nb jh ji jj nc jl jm jn jo hn dt translated"><a class="ae kn" rel="noopener" href="/coding-overload/introduction-and-a-little-about-accessing-iexs-api-with-javascript-7ae4e8af79d6">介绍和一点关于用JavaScript访问IEX API的内容</a></p></blockquote></div></div>    
</body>
</html>