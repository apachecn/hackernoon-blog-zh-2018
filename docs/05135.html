<html>
<head>
<title>Automagical Architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动建筑</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/automagical-architecture-db9b61c828fb?source=collection_archive---------22-----------------------#2018-06-18">https://medium.com/hackernoon/automagical-architecture-db9b61c828fb?source=collection_archive---------22-----------------------#2018-06-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="9476" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一个现代创业公司的技术堆栈的分解，重点是JavaScript和简单性。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/2c99773a0ae533cdf5f7d15fc5fba437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1HaddRShQeK-PZdkkb0Pgg.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek"><a class="ae kg" href="https://automagical.ai/" rel="noopener ugc nofollow" target="_blank">Automagical</a>’s React-based storyboard editor.</figcaption></figure><h1 id="fbf3" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">概观</h1><p id="5f8f" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated"><a class="ae kg" href="https://automagical.ai/" rel="noopener ugc nofollow" target="_blank">automagic</a>是一个平台，它使从现有内容创建高质量的营销视频变得简单而有趣。</p><blockquote class="lk ll lm"><p id="a91d" class="ir is jp it b iu iv iw ix iy iz ja jb ln jd je jf lo jh ji jj lp jl jm jn jo hn dt translated">声明:我是Automagical的创始人兼首席技术官。</p></blockquote><p id="4432" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我想概述一下它的架构，并思考一下<strong class="it hv">工程简单性</strong>对一个产品的成功有多重要。</p><p id="ea42" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Automagical大量使用JavaScript，因为后端是用<a class="ae kg" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>编写的，前端是通过<a class="ae kg" href="https://github.com/facebook/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>标准用<a class="ae kg" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React.js </a>构建的。源代码由git作为monorepo在<a class="ae kg" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上管理，部署由极其简单的<a class="ae kg" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank">现在的</a>服务处理。</p><p id="f1de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">主后端数据存储是托管版本的<a class="ae kg" href="https://www.mongodb.com/cloud" rel="noopener ugc nofollow" target="_blank"> mongoDB </a>，两个托管的<a class="ae kg" href="https://redislabs.com/" rel="noopener ugc nofollow" target="_blank"> redis </a>实例分别用于存储用户认证令牌和异步任务信息。一个<a class="ae kg" href="https://github.com/Automattic/kue" rel="noopener ugc nofollow" target="_blank">异步任务队列</a>用于管理长时间运行的操作，如视频渲染和视频修剪。</p><p id="e35e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae kg" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云平台</a>用于长期存储(类似于AWS S3)和托管有一些特殊要求的视频渲染器组件。</p></div><div class="ab cl lq lr hc ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hn ho hp hq hr"><blockquote class="lx"><p id="31a2" class="ly lz hu bd ma mb mc md me mf mg jo ek translated">我们之所以能够用很少的工程师来扩展Instagram，很大程度上是因为我们选择了简单易懂、值得信赖的解决方案。(<a class="ae kg" href="https://hvops.com/articles/simplicity-is-key/" rel="noopener ugc nofollow" target="_blank">来源</a>)</p></blockquote><h1 id="fe3f" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks mh ku kv kw mi ky kz la mj lc ld le dt translated">服务</h1><p id="aa77" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">该平台分为以下逻辑服务。每项服务都可以根据使用情况进行水平扩展。</p><h2 id="1792" class="mk ki hu bd kj ml mm mn kn mo mp mq kr jc mr ms kv jg mt mu kz jk mv mw ld mx dt translated">后端API</h2><p id="c497" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">该服务提供了支持自动逻辑平台的核心后端API(<a class="ae kg" href="https://api.automagical.ai" rel="noopener ugc nofollow" target="_blank">https://API . auto magic . ai</a>)。这是一个<a class="ae kg" href="https://koajs.com/" rel="noopener ugc nofollow" target="_blank">Koa</a>web服务器，它公开了一个由前端webapps使用的REST API。它是通过<a class="ae kg" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank">现在</a>用单一命令部署的。</p><h2 id="e398" class="mk ki hu bd kj ml mm mn kn mo mp mq kr jc mr ms kv jg mt mu kz jk mv mw ld mx dt translated">后端队列</h2><p id="6112" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">该服务提供了一个异步任务<a class="ae kg" href="https://github.com/Automattic/kue" rel="noopener ugc nofollow" target="_blank">队列</a>工作器，用于呈现和处理其他长时间运行的任务。这是唯一托管在谷歌云平台上的服务，因为渲染器模块需要更多的计算资源。</p><h2 id="2b97" class="mk ki hu bd kj ml mm mn kn mo mp mq kr jc mr ms kv jg mt mu kz jk mv mw ld mx dt translated">前端Webapp</h2><p id="21eb" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">这项服务提供了核心的自动视频web app(<a class="ae kg" href="https://app.automagical.ai" rel="noopener ugc nofollow" target="_blank">https://app . automagic . ai</a>)，它是用<a class="ae kg" href="https://github.com/facebookincubator/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>构建的，用户可以在其中创建、编辑和呈现故事板。它是通过<a class="ae kg" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank">现在是</a>用单一命令部署的。</p><h2 id="dd2a" class="mk ki hu bd kj ml mm mn kn mo mp mq kr jc mr ms kv jg mt mu kz jk mv mw ld mx dt translated">前端营销网站</h2><p id="3445" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">该服务提供用<a class="ae kg" href="https://github.com/facebookincubator/create-react-app" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>构建的自动营销网站(<a class="ae kg" href="https://automagical.ai" rel="noopener ugc nofollow" target="_blank">https://automagic . ai</a>)。它是通过<a class="ae kg" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank">现在是</a>用单一命令部署的。</p></div><div class="ab cl lq lr hc ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hn ho hp hq hr"><h1 id="21cf" class="kh ki hu bd kj kk my km kn ko mz kq kr ks na ku kv kw nb ky kz la nc lc ld le dt translated">模块</h1><p id="edab" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">该平台还包括以下模块，这些模块封装了定义明确的核心功能。</p><h2 id="fec5" class="mk ki hu bd kj ml mm mn kn mo mp mq kr jc mr ms kv jg mt mu kz jk mv mw ld mx dt translated">渲染器模块</h2><p id="6f94" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">该模块由后端队列任务运行器使用。这是一个2D渲染器，用于将自动故事板转换成视频。它是使用Node.js、<a class="ae kg" href="https://github.com/stackgl/headless-gl" rel="noopener ugc nofollow" target="_blank"> headless-opengl </a>和<a class="ae kg" href="http://www.ffmpeg.org/" rel="noopener ugc nofollow" target="_blank"> FFmpeg </a>构建的。</p><h2 id="8a81" class="mk ki hu bd kj ml mm mn kn mo mp mq kr jc mr ms kv jg mt mu kz jk mv mw ld mx dt translated">总结模块</h2><p id="1f1b" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">后端API服务使用这个模块从html生成摘要。它使用各种度量、NLP和机器学习技术来从源文章中生成高质量的提取文本摘要。</p></div><div class="ab cl lq lr hc ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hn ho hp hq hr"><h1 id="c310" class="kh ki hu bd kj kk my km kn ko mz kq kr ks na ku kv kw nb ky kz la nc lc ld le dt translated">DevOps</h1><p id="50b4" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">一旦部署，Automagical被设计为以最少的维护运行。万一服务器崩溃，受影响的服务会自动重启，并使用<a class="ae kg" href="https://cloud.google.com/error-reporting/" rel="noopener ugc nofollow" target="_blank"> Google Cloud错误报告</a>记录一个错误。</p><p id="1ba9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所有环境机密，如条带访问密钥、数据库密码等。都由当地的<a class="ae kg" href="https://github.com/motdotla/dotenv" rel="noopener ugc nofollow" target="_blank">处理。env </a>文件，现在通过<a class="ae kg" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank">与代码一起部署</a>。为了能够运行和部署Automagical平台，新开发人员必须做的唯一一件事就是访问git monorepo和附带的私有。环境文件。</p><h2 id="4caf" class="mk ki hu bd kj ml mm mn kn mo mp mq kr jc mr ms kv jg mt mu kz jk mv mw ld mx dt translated">监视</h2><ul class=""><li id="2663" class="nd ne hu it b iu lf iy lg jc nf jg ng jk nh jo ni nj nk nl dt translated">每个API调用都用<a class="ae kg" href="https://cloud.google.com/trace/" rel="noopener ugc nofollow" target="_blank"> Google Cloud Trace </a>记录。</li><li id="5ff4" class="nd ne hu it b iu nm iy nn jc no jg np jk nq jo ni nj nk nl dt translated"><a class="ae kg" href="https://uptime.com/" rel="noopener ugc nofollow" target="_blank">正常运行时间</a>用于在服务不可用的情况下发送电子邮件和短信提醒。</li><li id="964e" class="nd ne hu it b iu nm iy nn jc no jg np jk nq jo ni nj nk nl dt translated"><a class="ae kg" href="https://analytics.google.com/analytics/web/" rel="noopener ugc nofollow" target="_blank"> Google Analytics </a>设置为监控营销网站和主webapp，因此您可以查看实时和历史流量数据。</li><li id="a8c0" class="nd ne hu it b iu nm iy nn jc no jg np jk nq jo ni nj nk nl dt translated">所有主要的webapp操作(如创建故事板、添加新场景、呈现视频等。)被发送到Google Analytics和<a class="ae kg" href="https://www.intercom.com/" rel="noopener ugc nofollow" target="_blank"> Intercom </a>，因此您可以跟踪特定用户通过应用程序的路径。</li></ul></div><div class="ab cl lq lr hc ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hn ho hp hq hr"><h1 id="b09c" class="kh ki hu bd kj kk my km kn ko mz kq kr ks na ku kv kw nb ky kz la nc lc ld le dt translated">外卖食品</h1><ul class=""><li id="83a8" class="nd ne hu it b iu lf iy lg jc nf jg ng jk nh jo ni nj nk nl dt translated">对于快速迭代来说，Node.js是一种优秀的编程语言，但是您仍然需要花时间去理解和勾画出系统的哪些部分应该隔离到单独的服务或模块中。</li><li id="edc3" class="nd ne hu it b iu nm iy nn jc no jg np jk nq jo ni nj nk nl dt translated">一旦你需要扩大规模，微服务是时尚和伟大的，但99%的早期创业公司不需要它们。从简单开始，着眼于应用中的逻辑、整体服务，只有在需要时才考虑增加解决方案的复杂性，如微服务和容器编排。</li><li id="e12e" class="nd ne hu it b iu nm iy nn jc no jg np jk nq jo ni nj nk nl dt translated">使用<a class="ae kg" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank"> Zeit now </a>进行部署已经取得了巨大的成功，让我们能够将精力集中在构建核心产品上，而忽略大多数围绕部署/扩展/编排的问题。它还具有如此简单的API，几乎没有供应商锁定，因此一旦我们需要扩展，我们可以评估最佳选项并快速改变路线。</li><li id="61db" class="nd ne hu it b iu nm iy nn jc no jg np jk nq jo ni nj nk nl dt translated">我们的工程消耗率非常低，大约每月500美元，其中大部分预算来自第三方API供应商。当考虑构建一个功能而不是购买一个等效的第三方API时，如果预算允许，尽可能倾向于使用SaaS API，这样你就可以专注于构建你的核心产品。如果这个成本成为了一个障碍，那么你只需要在需要的时候自己制作一个定制版本<em class="jp">。</em></li><li id="bc5a" class="nd ne hu it b iu nm iy nn jc no jg np jk nq jo ni nj nk nl dt translated">充实和执行一个<a class="ae kg" href="https://en.wikipedia.org/wiki/Minimum_viable_product" rel="noopener ugc nofollow" target="_blank"> MVP </a>是非常非常困难的。如果对某个特性或修饰项目是否应该出现在MVP中有任何疑问，跳过它，在花额外的时间开发之前，先和潜在客户验证你的产品。早期采用者更关心产品的想法及其未来的潜力，而不是具体的功能，他们的反馈对你的产品路线图的优先排序是非常宝贵的。这听起来很容易&amp;显而易见，但在实践中，保持这种心态需要大量的经验和持续的警惕。</li><li id="41bd" class="nd ne hu it b iu nm iy nn jc no jg np jk nq jo ni nj nk nl dt translated">在你确信你已经找到产品/市场的契合点之前，专注于保持你的工程努力尽可能的简单和轻便。在创业初期快速迭代产品变化的能力比其他技术问题重要得多。开发速度和可维护性之间的权衡需要经验来优化，即使是最好的工程师也倾向于在早期过多地使用过多的结构和过程。<a class="ae kg" href="https://en.wikipedia.org/wiki/KISS_principle" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">吻</strong> </a>。</li></ul><blockquote class="lx"><p id="c510" class="ly lz hu bd ma mb nr ns nt nu nv jo ek translated">工程中的一切都是交易&amp;接吻主宰一切。</p></blockquote><h1 id="067f" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks mh ku kv kw mi ky kz la mj lc ld le dt translated">摘要</h1><p id="c751" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">Automagical是一个现代的Node.js平台，精心设计，注重简单性。它分为几个主要服务:后端API、后端队列、前端webapp和前端营销网站。核心IP分为封装良好的组件，即渲染器模块和摘要模块。Zeit极其简单的<a class="ae kg" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank"> now </a>服务用于单命令部署，所有数据库(mongodb和redis)由第三方托管，便于维护。</p><p id="da94" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如需了解更多详情或具体问题，欢迎致电<a class="ae kg" href="mailto:dev@automagical.ai" rel="noopener ugc nofollow" target="_blank">dev @ automagic . ai</a>联系我们。</p><h2 id="9522" class="mk ki hu bd kj ml mm mn kn mo mp mq kr jc mr ms kv jg mt mu kz jk mv mw ld mx dt translated">在你走之前…</h2><p id="e375" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated"><em class="jp">如果您喜欢这篇文章，请点击👏下面，并与他人分享，这样他们也可以享受它。</em></p></div></div>    
</body>
</html>