<html>
<head>
<title>Auth Headers vs JWT vs Sessions — How to Choose the Right Auth Technique for APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">认证头vs JWT vs会话——如何为API选择正确的认证技术</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/auth-headers-vs-jwt-vs-sessions-how-to-choose-the-right-auth-technique-for-apis-57e15edd053?source=collection_archive---------25-----------------------#2018-06-18">https://medium.com/hackernoon/auth-headers-vs-jwt-vs-sessions-how-to-choose-the-right-auth-technique-for-apis-57e15edd053?source=collection_archive---------25-----------------------#2018-06-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="a496" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">认证REST APIs需要选择适合您的应用程序的正确API。有几种方法:</p><p id="add0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">单页应用程序有两种选择:</p><ul class=""><li id="75e1" class="jp jq hu it b iu iv iy iz jc jr jg js jk jt jo ju jv jw jx dt translated">基于会话</li><li id="8966" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx dt translated">基于令牌的认证</li></ul><p id="7cbc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">需要问的一组问题是:</p><ol class=""><li id="0a42" class="jp jq hu it b iu iv iy iz jc jr jg js jk jt jo kd jv jw jx dt translated">会话是否应该在到期前失效？如果是，则必须优先选择会话。</li><li id="7731" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated"><strong class="it hv">会话是否应该基于不活动而结束，而不是在固定时间后结束？</strong>如果是，则必须优先选择会话。</li><li id="d0c6" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated"><strong class="it hv">me功能应该被记住吗？</strong>如果是，则必须优先选择会话。</li><li id="5c39" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated"><strong class="it hv">移动应用程序会使用相同的API吗？</strong>如果是，则首选基于令牌的身份验证(但要确保为这些用例构建单独的API)</li><li id="d498" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated"><strong class="it hv">您的web框架能够抵御CSRF吗？如果答案是“否”或者如果您不知道CSRF是什么，则首选基于令牌的身份验证。</strong></li></ol><p id="a25f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果首选基于令牌的身份验证，请避免使用JSON Web令牌。JWT应该被用作一个简短的一次性令牌，而不是可以多次重用的令牌。或者，您可以创建一个随机令牌，将其存储在Redis/Memcached中，并在每次请求时验证它。</p><p id="738b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首选基于令牌的身份验证。</p><p id="2e08" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">移动应用程序不会自动维护和发送会话cookies。因此，与设置会话cookie相比，移动应用程序开发人员设置身份验证令牌要容易得多。</p><p id="26cd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">基于签名的机制也没有用，因为密钥不能嵌入到移动应用程序中。只有当你有另一个渠道，比如说二维码，来传递秘密时，你才能使用基于签名的机制。</p><p id="98e4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">存储在Redis或Memcached中的随机令牌是最理想的方法。确保在编程中使用加密安全的随机生成器。</p><p id="020a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从服务器端应用程序调用的API有三种选择，包括:</p><ul class=""><li id="0c69" class="jp jq hu it b iu iv iy iz jc jr jg js jk jt jo ju jv jw jx dt translated">基于https的基本身份验证</li><li id="bf63" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx dt translated">基于令牌的认证</li><li id="6f4c" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx dt translated">基于签名的认证</li></ul><ol class=""><li id="116d" class="jp jq hu it b iu iv iy iz jc jr jg js jk jt jo kd jv jw jx dt translated"><strong class="it hv">API会不会只供内部使用，只供你控制的应用使用，API本身价值低吗？</strong>如果是，只要您使用HTTPS，基本认证是可以接受的。</li><li id="4e72" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated"><strong class="it hv">你想让密钥长寿吗？</strong>如果是，因为密钥本身从不通过网络发送，所以采用基于签名的认证。</li><li id="3a38" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated"><strong class="it hv">您希望移动应用和网络应用使用相同的API吗？</strong>如果是，因为基于签名的身份验证要求客户端存储机密，所以最好使用基于令牌的身份验证。</li><li id="98e1" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated">你正在使用OAuth吗？如果是，决定已经为你做好了。OAuth 1使用基于签名的认证，而OAuth 2使用基于令牌的认证。</li><li id="962c" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated">你提供客户端库来访问你的API吗？如果是，最好使用基于签名的身份验证，因为您可以一次性编写加密代码，并将其提供给所有客户。</li></ol><p id="d932" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">JWT最适合一次性令牌。理想情况下，每次使用都必须生成一个新的JWT。<br/>可接受的用例:</p><ol class=""><li id="c602" class="jp jq hu it b iu iv iy iz jc jr jg js jk jt jo kd jv jw jx dt translated">服务器到服务器的API调用，其中客户端可以存储一个共享秘密，并为每个API调用生成一个新的JWT。</li><li id="12f6" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated">生成即将过期的链接，例如用于电子邮件验证的链接</li><li id="bdbd" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated">作为一个系统向登录用户提供对另一个系统的受限访问的方式。</li></ol><p id="647b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">仅当满足以下标准时，才应使用OAuth:</p><ol class=""><li id="7a05" class="jp jq hu it b iu iv iy iz jc jr jg js jk jt jo kd jv jw jx dt translated">消费者或特定于用户的数据由您的API公开</li><li id="3895" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated">您不信任的第三方开发人员正在访问一些特定于用户的数据</li><li id="a28d" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo kd jv jw jx dt translated">如果您想询问您的用户是否愿意与第三方开发者共享他们的数据</li></ol><p id="0c01" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果3个问题的答案都是“是”，那么您需要OAuth。</p></div><div class="ab cl ke kf hc kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hn ho hp hq hr"><p id="0038" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="kl">原载于2018年6月18日【hashedin.com】<a class="ae km" href="https://hashedin.com/auth-headers-vs-jwt-vs-sessions-choosing-right-auth-technique-for-apis/" rel="noopener ugc nofollow" target="_blank"><em class="kl"/></a><em class="kl">。</em></em></p></div></div>    
</body>
</html>