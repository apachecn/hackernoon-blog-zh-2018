<html>
<head>
<title>First impressions with ERC 725 and ERC 735 — identity and claims</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对ERC 725和ERC 735的第一印象——身份和主张</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/first-impressions-with-erc-725-and-erc-735-identity-and-claims-4a87ff2509c9?source=collection_archive---------1-----------------------#2018-06-25">https://medium.com/hackernoon/first-impressions-with-erc-725-and-erc-735-identity-and-claims-4a87ff2509c9?source=collection_archive---------1-----------------------#2018-06-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="f02d" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">为众筹销售实现简单的KYC索赔验证</h2></div><p id="2660" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv"> ℹ️这是2018年初出版的。从此，</strong> <a class="ae kf" href="https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hv"> LSP-6 </strong> </a> <strong class="jl hv">取代了ERC-735。一定要</strong> <a class="ae kf" href="https://github.com/lukso-network/LIPs/blob/main/LSPs/LSP-6-KeyManager.md" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hv">查出来</strong> </a> <strong class="jl hv">！</strong></p></div><div class="ab cl kg kh hc ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hn ho hp hq hr"><p id="7f9d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在<a class="ae kf" href="https://www.trustfractal.com/business/" rel="noopener ugc nofollow" target="_blank"> Fractal </a>，我们专注于从UX和法规遵从性的角度改善ICO体验。成功的ICO的关键之一是适当的参与资格验证(KYC、反洗钱、CFT、资本市场法规等)。因此，我们正在密切关注身份空间，关注诸如<a class="ae kf" href="https://sovrin.org/" rel="noopener ugc nofollow" target="_blank"> Sovrin </a>、<a class="ae kf" href="https://www.taqanu.com/" rel="noopener ugc nofollow" target="_blank"> Taqanu </a>、<a class="ae kf" href="https://www.uport.me/" rel="noopener ugc nofollow" target="_blank"> uPort </a>和<a class="ae kf" href="https://www.civic.com/" rel="noopener ugc nofollow" target="_blank"> Civic </a>等项目，并尝试潜在的集成。</p><p id="16ef" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="kn ko gr" href="https://medium.com/u/4b59b3ef14a2?source=post_page-----4a87ff2509c9--------------------------------" rel="noopener" target="_blank"> Fabian Vogelsteller </a>，薄雾浏览器和<a class="ae kf" href="https://github.com/ethereum/web3.js/" rel="noopener ugc nofollow" target="_blank"> web3.js </a>的创造者，正在为以太坊制定新的身份标准<a class="ae kf" href="https://github.com/ethereum/EIPs/issues/725" rel="noopener ugc nofollow" target="_blank"> ERC 725 </a>。当与他的另一个发明<a class="ae kf" href="https://github.com/ethereum/EIPs/issues/735" rel="noopener ugc nofollow" target="_blank"> ERC 735 </a>一起使用时，它是一个非常强大的处理链上真实身份的工具。</p><p id="fd68" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">受Nick Poulden的启发，他拿着这些标准的草稿，创造了一个很好的视觉演示，展示了它们是如何结合在一起的。</p><figure class="kq kr ks kt fq ku fe ff paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="fe ff kp"><img src="../Images/5a19addfa6b45efacf71b7747c2b82c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fwvt1sbeHiz7HRMz7FIOPQ.jpeg"/></div></div><figcaption class="lb lc fg fe ff ld le bd b be z ek">Photo by <a class="ae kf" href="https://unsplash.com/photos/OHnvp41aDzE?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">CMDR Shane</a> on <a class="ae kf" href="https://unsplash.com/search/photos/fingerprint?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="7e7e" class="lf lg hu bd lh li lj lk ll lm ln lo lp ja lq jb lr jd ls je lt jg lu jh lv lw dt translated">标准概述</h1><p id="2bb2" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">ERC 725和735最大的优点之一就是它们是开放的、社区驱动的、参与式的标准。它们也很容易理解，因为它们很小，是有针对性的标准，每个标准只做一件事，但做得很好:管理身份和对这些身份的声明。</p><h2 id="52c7" class="mc lg hu bd lh md me mf ll mg mh mi lp js mj mk lr jw ml mm lt ka mn mo lv mp dt translated">ERC 725:身份</h2><blockquote class="mq mr ms"><p id="db10" class="jj jk mt jl b jm jn iv jo jp jq iy jr mu jt ju jv mv jx jy jz mw kb kc kd ke hn dt translated">下面描述了人类、群体、物体和机器的唯一身份的标准功能。<br/>该身份可以持有签名动作(交易、文档、登录、访问等)和声明的密钥，这些动作和声明由第三方(发布者)证明和自证明(<a class="ae kf" href="https://github.com/ethereum/EIPs/issues/735" rel="noopener ugc nofollow" target="_blank"> #ERC735 </a>)，以及直接作用于区块链的代理功能。</p></blockquote><p id="9bd6" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ERC 725是在位于EVM的区块链(如以太坊)上通过智能合约发布和管理身份的标准。这个身份由它的链地址来表示。</p><p id="94ac" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以将几把钥匙与这个身份联系起来。这些键可以有不同的用途:标准目前提出了<code class="eh mx my mz na b">MANAGEMENT</code>、<code class="eh mx my mz na b">ACTION</code>、<code class="eh mx my mz na b">CLAIM</code>和<code class="eh mx my mz na b">ENCRYPTION</code>。密钥是公共地址的<code class="eh mx my mz na b">keccak256</code>，因此映射到外部拥有的账户(钱包)或智能合同。</p><p id="b0e5" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">另一个重要的概念是，ERC 725合约可以通过其<code class="eh mx my mz na b">execute</code> / <code class="eh mx my mz na b">approve</code>方法用作代理。如果第三方承认给定身份契约的合法性，它的所有者可以调用它的<code class="eh mx my mz na b">execute</code>与所述第三方进行交易，正如我们将在下面的KYC例子中看到的。</p><p id="c83e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">多个密钥在特权访问的上下文中特别有用。比如，假设这个身份不是针对个人的，而是针对一个组织的。持有较低特权密钥的成员可以向<code class="eh mx my mz na b">execute</code>提交事务，但是只有那些能够访问较高特权密钥的成员才能<code class="eh mx my mz na b">approve</code>执行那些事务。</p><p id="edb9" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以在这个兔子洞里走得更远。由于密钥也可以映射到智能合同而不是钱包，因此可能会实现进一步的访问要求。例如，拥有一个映射到一个<code class="eh mx my mz na b">AccessControl</code>契约的<code class="eh mx my mz na b">ACTION</code>键允许我们在这个契约中构建任意复杂的访问控制级别。这很重要，因为它保持了标准本身的简单性，同时支持所有可以想象的用例。</p><p id="133f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">另一个例子与撤销索赔有关。如果我们使用自己的身份对另一个身份进行声明，拥有几个<code class="eh mx my mz na b">CLAIM</code>密钥会很有用——删除其中任何一个都会导致相关声明失去有效性。</p><p id="470e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">举一个真实世界的例子，假设Mozilla有一个身份契约。除了Mozilla选择对该身份做的其他事情，Firefox软件团队可以持有属于该身份的一个密钥，在发布时用它来签署软件校验和。</p><p id="13b7" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于我们的KYC用例，如下所述，我们<a class="ae kf" href="https://github.com/ethereum/EIPs/issues/725#issuecomment-398750048" rel="noopener ugc nofollow" target="_blank">提出了一个对标准的变更</a>，这将使<code class="eh mx my mz na b">execute</code>成为一个<code class="eh mx my mz na b">payable</code>方法，允许我们转发以太事务来执行。另一种方法是使用两个独立的事务:首先将Ether发送到契约，然后用<code class="eh mx my mz na b">execute</code>移动它。</p><h2 id="5dc9" class="mc lg hu bd lh md me mf ll mg mh mi lp js mj mk lr jw ml mm lt ka mn mo lv mp dt translated">ERC 735:索赔持有人</h2><blockquote class="mq mr ms"><p id="f79d" class="jj jk mt jl b jm jn iv jo jp jq iy jr mu jt ju jv mv jx jy jz mw kb kc kd ke hn dt translated">下面描述了添加、删除和保留索赔的标准功能。这些声明可以由第三方(发行人)证明，也可以自我证明。</p><p id="02a8" class="jj jk mt jl b jm jn iv jo jp jq iy jr mu jt ju jv mv jx jy jz mw kb kc kd ke hn dt translated">这种标准化的索赔持有人接口将允许Dapps和智能合同检查索赔持有人的索赔。在这里，信任被转移给债权的发行人。</p></blockquote><p id="3e3c" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">ERC 735处理关于ERC 725身份的声明的管理。它通过依赖可信第三方对给定身份的声明，促进了信任网络的出现。</p><p id="8832" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这些索赔可能涉及多个主题，从生物特征数据到电子邮件帐户所有权。这对于我们的KYC用例特别有用，如下所述。作为ICO发行者，我们可以与受信任的KYC提供商合作来决定投资者是否有资格购买代币。</p><p id="1229" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为了让某人向其身份添加声明，他们必须首先向相关的可信第三方请求。这个第三方(声明发布者)将对包含三项内容的消息进行签名:身份的地址、声明主题以及可选的一些数据(例如，KYC数据的散列)。然后，身份所有者将该声明存储在他们的身份契约中(或者，声明发布者也可以自己添加声明，这必须得到身份所有者的批准)。</p><p id="6f8b" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">请注意，声明也可以自我证明，这对于许多其他用例来说已经足够了(对于没有严格KYC要求的简单应用程序，比如常规新闻网站，可以想到电子邮件和名称)。</p><h1 id="9dbe" class="lf lg hu bd lh li lj lk ll lm ln lo lp ja lq jb lr jd ls je lt jg lu jh lv lw dt translated">KYC为众筹销售索赔</h1><h2 id="ddd1" class="mc lg hu bd lh md me mf ll mg mh mi lp js mj mk lr jw ml mm lt ka mn mo lv mp dt translated">实体</h2><p id="fb0e" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">该演示考虑了以下实体。</p><ul class=""><li id="b1d6" class="nb nc hu jl b jm jn jp jq js nd jw ne ka nf ke ng nh ni nj dt translated"><a class="ae kf" href="http://swansonquotes.com/quotes/season07/ep-01-2017-good-building-development-co/#.Wyt2hhIzZ24" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hv">非常好</strong> </a>，一家希望颠覆房地产开发市场的建筑公司。</li><li id="e570" class="nb nc hu jl b jm nk jp nl js nm jw nn ka no ke ng nh ni nj dt translated"><strong class="jl hv"> Fractal ID </strong>，执行KYC/反洗钱检查的身份提供者。</li><li id="560f" class="nb nc hu jl b jm nk jp nl js nm jw nn ka no ke ng nh ni nj dt translated"><strong class="jl hv">投资人</strong>，谁需要清除KYC参与一个<strong class="jl hv">非常好的</strong>的ICO。</li></ul><h2 id="804a" class="mc lg hu bd lh md me mf ll mg mh mi lp js mj mk lr jw ml mm lt ka mn mo lv mp dt translated">流程概述</h2><p id="cefa" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">在编译完契约之后，我们的演示采取了以下步骤。</p><ol class=""><li id="c6fb" class="nb nc hu jl b jm jn jp jq js nd jw ne ka nf ke np nh ni nj dt translated"><strong class="jl hv">分形ID </strong>部署自己的身份契约。</li><li id="a9d5" class="nb nc hu jl b jm nk jp nl js nm jw nn ka no ke np nh ni nj dt translated"><strong class="jl hv"> Fractal ID </strong>在其身份契约中添加一个<code class="eh mx my mz na b">CLAIM</code>键。</li><li id="8160" class="nb nc hu jl b jm nk jp nl js nm jw nn ka no ke np nh ni nj dt translated"><strong class="jl hv">投资者</strong>部署其身份合约。</li><li id="0aeb" class="nb nc hu jl b jm nk jp nl js nm jw nn ka no ke np nh ni nj dt translated"><strong class="jl hv">投资人</strong>成功KYC后，<strong class="jl hv">分形ID </strong>为<strong class="jl hv">投资人</strong>签署KYC债权。</li><li id="bae9" class="nb nc hu jl b jm nk jp nl js nm jw nn ka no ke np nh ni nj dt translated"><strong class="jl hv">投资者</strong>将<strong class="jl hv">分形ID </strong>签署的KYC声明添加到他们的身份合同中。</li><li id="f14d" class="nb nc hu jl b jm nk jp nl js nm jw nn ka no ke np nh ni nj dt translated"><strong class="jl hv">非常好</strong>部署他们的代币和众筹合同。</li><li id="3f01" class="nb nc hu jl b jm nk jp nl js nm jw nn ka no ke np nh ni nj dt translated"><strong class="jl hv">投资者</strong>参与<strong class="jl hv">非常好</strong>的ICO，通过他们的身份合约转让给<strong class="jl hv">非常好</strong>的众筹合约。</li><li id="6303" class="nb nc hu jl b jm nk jp nl js nm jw nn ka no ke np nh ni nj dt translated"><strong class="jl hv">非常好的</strong>众筹合同确认<strong class="jl hv">投资人</strong>的身份合同包含<strong class="jl hv">分形ID </strong>在接受投资前的KYC债权。</li></ol><h2 id="4120" class="mc lg hu bd lh md me mf ll mg mh mi lp js mj mk lr jw ml mm lt ka mn mo lv mp dt translated">智能合同</h2><p id="cdcb" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">我将<a class="ae kf" href="https://github.com/OriginProtocol/identity-playground/tree/master/contracts" rel="noopener ugc nofollow" target="_blank"> Origin对标准的执行</a>作为这项工作的起点。我不得不<a class="ae kf" href="https://github.com/OriginProtocol/identity-playground/pull/11/files" rel="noopener ugc nofollow" target="_blank">稍微改变</a>的工作方式:由于上面描述的<code class="eh mx my mz na b">payable</code>问题，这个实现没有准备好将值传递给执行目标。为了清楚起见，这里有一个简单的契约继承图。</p><pre class="kq kr ks kt fq nq na nr ns aw nt dt"><span id="bee9" class="mc lg hu na b fv nu nv l nw nx">+---------------+     +---------------+<br/>|               |     |               |<br/>|    ERC 725    |     |    ERC 735    |<br/>|               |     |               |<br/>+-------+-------+     +-------+-------+<br/>        ^                     ^<br/>        |                     |<br/>+-------+-------+             |<br/>|               |             |<br/>|   KeyHolder   |             |<br/>|               |             |<br/>+-------+-------+             |<br/>        ^                     |<br/>        |                     |<br/>+-------+-------+             |<br/>|               |             |<br/>|  ClaimHolder  +-------------+<br/>|               |<br/>+---------------+</span></pre><p id="f65f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">代币和众筹合约被解除<a class="ae kf" href="https://github.com/OpenZeppelin/openzeppelin-solidity/" rel="noopener ugc nofollow" target="_blank"> OpenZeppelin Solidity </a>。</p><p id="1fdb" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为了部署这些契约并与之交互，我使用web3.js来构建一个简单的js脚本。(如果你好奇的话，这里有完整的回购协议</p><h2 id="9e59" class="mc lg hu bd lh md me mf ll mg mh mi lp js mj mk lr jw ml mm lt ka mn mo lv mp dt translated">步骤1/4 —部署身份契约</h2><p id="7e71" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated"><strong class="jl hv">分形ID </strong>和<strong class="jl hv">投资者</strong>都需要部署一份<code class="eh mx my mz na b">ClaimHolder</code>合约，以便持有他们所有的钥匙和claims⁴.该合同同时执行ERC 725和ERC 735。</p><p id="a202" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">部署后，<strong class="jl hv">分形ID </strong>将创建一个<code class="eh mx my mz na b">CLAIM</code>目的密钥。这是与KYC声明的签名相关的关键。</p><pre class="kq kr ks kt fq nq na nr ns aw nt dt"><span id="7f47" class="mc lg hu na b fv nu nv l nw nx">var fractalIdClaimsKey = web3.utils.keccak256(<br/>  fractalIdClaimsAccount<br/>);</span><span id="8db4" class="mc lg hu na b fv ny nv l nw nx">fractalIdClaimHolder.methods.addKey(<br/>  fractalIdClaimsKey,<br/>  KEY_PURPOSES.CLAIM,<br/>  KEY_TYPES.ECDSA,<br/>).send({<br/>  from: fractalIdAccount,<br/>  gas: 4612388,<br/>});</span></pre><p id="41fd" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如上所述，密钥是其控制账户地址的<code class="eh mx my mz na b">keccak256</code>散列。<strong class="jl hv"> Fractal ID </strong>调用<code class="eh mx my mz na b">ClaimHolder</code>契约(ERC 725)上的<code class="eh mx my mz na b">addKey</code>方法，传递给它这个键、键的<code class="eh mx my mz na b">purpose</code>和它的<code class="eh mx my mz na b">keyType</code>。</p><p id="638f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">最后，<strong class="jl hv">非常好的</strong>需要部署他们的代币和众筹合同，并将<code class="eh mx my mz na b">VeryGoodCoin</code>的所有权转移到<code class="eh mx my mz na b">VeryGoodCrowdsale</code>合同，因此它可以根据需要铸造代币来奖励贡献。</p><pre class="kq kr ks kt fq nq na nr ns aw nt dt"><span id="8c38" class="mc lg hu na b fv nu nv l nw nx">veryGoodCoin.methods.transferOwnership(<br/>  veryGoodCrowdsale.options.address,<br/>).send({<br/>  from: veryGoodAccount,<br/>});</span></pre><h2 id="3142" class="mc lg hu bd lh md me mf ll mg mh mi lp js mj mk lr jw ml mm lt ka mn mo lv mp dt translated">第2/4步—签署KYC索赔</h2><p id="f642" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">在<strong class="jl hv">投资人</strong>通过<strong class="jl hv">分形ID </strong>的<a class="ae kf" href="https://www.trustfractal.com/business/" rel="noopener ugc nofollow" target="_blank">在线KYC流程</a>后，<strong class="jl hv">分形ID </strong>签署KYC债权。</p><pre class="kq kr ks kt fq nq na nr ns aw nt dt"><span id="faa7" class="mc lg hu na b fv nu nv l nw nx">var hexedData = web3.utils.asciiToHex("Investor is VBR V0 legit.");<br/>var hashedDataToSign = web3.utils.soliditySha3(<br/>  investorClaimHolder.options.address,<br/>  CLAIM_TYPES.KYC,<br/>  hexedData,<br/>);<br/>var signature = await web3.eth.sign(<br/>  hashedDataToSign,<br/>  fractalClaimsAccount,<br/>);</span></pre><h2 id="6d43" class="mc lg hu bd lh md me mf ll mg mh mi lp js mj mk lr jw ml mm lt ka mn mo lv mp dt translated">第3/4步—将KYC债权添加到投资者合同中</h2><p id="8fe5" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated"><strong class="jl hv"> Fractal ID </strong>然后向<strong class="jl hv">投资者</strong>提供这份签名声明，投资者将其添加到他们的身份合同中。</p><pre class="kq kr ks kt fq nq na nr ns aw nt dt"><span id="a707" class="mc lg hu na b fv nu nv l nw nx">var claimIssuer = fractalIdClaimHolder.options.address;<br/>var addClaimABI = await investorClaimHolder.methods<br/>  .addClaim(<br/>    CLAIM_TYPES.KYC,<br/>    CLAIM_SCHEMES.ECDSA,<br/>    claimIssuer,<br/>    signature,<br/>    hexedData,<br/>    "<a class="ae kf" href="https://www.trustfractal.com/business/" rel="noopener ugc nofollow" target="_blank">https://www.trustfractal.com/business/</a>",<br/>  ).encodeABI();</span><span id="a2e7" class="mc lg hu na b fv ny nv l nw nx">investorClaimHolder.methods.execute(<br/>  investorClaimHolder.options.address,<br/>  0,<br/>  addClaimABI,<br/>).send({<br/>  gas: 4612388,<br/>  from: investorAccount,<br/>});</span></pre><p id="675e" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这是通过<code class="eh mx my mz na b">ClaimHolder</code>契约上的<code class="eh mx my mz na b">addClaim</code>方法(ERC 735)完成的，我们为其提供一个<code class="eh mx my mz na b">topic</code>、一个<code class="eh mx my mz na b">scheme</code>、<code class="eh mx my mz na b">issuer</code>、<code class="eh mx my mz na b">signature</code>、<code class="eh mx my mz na b">data</code>和一个<code class="eh mx my mz na b">uri</code> ⁵.</p><p id="b9d8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh mx my mz na b">execute</code>的工作方式如下。我们向它传递一个目的地址、一个以太值和一个序列化的方法调用。如果我们用<code class="eh mx my mz na b">MANAGEMENT</code>或<code class="eh mx my mz na b">ACTION</code>键调用它，请求就会被批准并执行。如果我们用一个其他用途的键调用它，一个更高特权的键必须随后批准执行。</p><h2 id="b3c4" class="mc lg hu bd lh md me mf ll mg mh mi lp js mj mk lr jw ml mm lt ka mn mo lv mp dt translated">步骤4/4 —参与ICO</h2><p id="761e" class="pw-post-body-paragraph jj jk hu jl b jm lx iv jo jp ly iy jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">为了让<strong class="jl hv">投资者</strong>参与ICO，我们也将使用<code class="eh mx my mz na b">execute</code>方式。这里的情况更容易理解:由于<strong class="jl hv"> Fractal ID </strong>的身份声明出现在<strong class="jl hv">投资者</strong>的身份契约上，并且<strong class="jl hv">非常好的</strong>众卖契约将检查消息发送者的KYC声明，该契约必须是调用者。</p><pre class="kq kr ks kt fq nq na nr ns aw nt dt"><span id="3059" class="mc lg hu na b fv nu nv l nw nx">var investABI = veryGoodCrowdsale.methods.buyTokens(<br/>  investorClaimHolder.options.address<br/>).encodeABI();</span><span id="342d" class="mc lg hu na b fv ny nv l nw nx">var investmentAmount = web3.utils.toWei("1", "ether");<br/>investorClaimHolder.methods.execute(<br/>  veryGoodCrowdsale.options.address,<br/>  investmentAmount,<br/>  investABI,<br/>).send({<br/>  gas: 4612388,<br/>  from: investorAccount,<br/>  value: investmentAmount,<br/>});</span></pre><p id="1c83" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在所有的检查都应该通过了，<strong class="jl hv">非常好的</strong>众筹合同将铸造新的代币，并将它们的所有权分配给<strong class="jl hv">投资者</strong>的身份合同！🎉</p></div><div class="ab cl kg kh hc ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hn ho hp hq hr"><p id="c5e0" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv"> <em class="mt">感谢</em> </strong> <em class="mt">至</em> <a class="kn ko gr" href="https://medium.com/u/4b59b3ef14a2?source=post_page-----4a87ff2509c9--------------------------------" rel="noopener" target="_blank"> <em class="mt">法比安·沃格斯泰勒</em> </a> <em class="mt">、雨果·佩肖托</em> <a class="kn ko gr" href="https://medium.com/u/22c33f1d4c05?source=post_page-----4a87ff2509c9--------------------------------" rel="noopener" target="_blank"> <em class="mt">若昂·格拉迪姆</em> </a> <em class="mt">阅读本帖草稿。</em></p><p id="df2d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv"> </strong> <em class="mt">更准确地说，</em> <code class="eh mx my mz na b"><em class="mt">keccak256</em></code> <em class="mt">只是标准推荐的非十六进制和长度超过32字节的密钥。</em></p><p id="d1c2" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv"> <em class="mt">分形ID </em> </strong> <em class="mt">也可以代表</em> <strong class="jl hv"> <em class="mt">投资者这样做。</em>T49】</strong></p><p id="aae8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv"> </strong> <em class="mt">还有一个ERC 725建议的流程，是让</em> <strong class="jl hv"> <em class="mt">分形ID </em> </strong> <em class="mt">调用</em> <code class="eh mx my mz na b"><em class="mt">addClaim</em></code> <em class="mt">上的</em> <strong class="jl hv"> <em class="mt">投资方</em> </strong> <em class="mt">合同。该索赔可以通过</em> <strong class="jl hv"> <em class="mt">投资人</em> </strong> <em class="mt">的身份合同立即受理，或者先经过审批程序。</em></p><p id="19e4" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv"> ⁴ </strong> <em class="mt">从技术上来说，一个</em> <code class="eh mx my mz na b"><em class="mt">KeyHolder</em></code> <em class="mt">契约对于</em> <strong class="jl hv"> <em class="mt">分形ID </em> </strong> <em class="mt">就足够了。</em></p><p id="5548" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv"> ⁵ </strong> <em class="mt">注意，我们使用</em> <code class="eh mx my mz na b"><em class="mt">encodeABI</em></code> <em class="mt">来序列化</em> <code class="eh mx my mz na b"><em class="mt">addClaim</em></code> <em class="mt">方法调用，并通过</em> <code class="eh mx my mz na b"><em class="mt">execute</em></code> <em class="mt">进行管道化。</em> <strong class="jl hv"> <em class="mt">投资者</em> </strong> <em class="mt">可以改为直接调用</em> <code class="eh mx my mz na b"><em class="mt">addClaim</em></code> <em class="mt">，使用账户映射到相应的权限。</em></p></div><div class="ab cl kg kh hc ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hn ho hp hq hr"><p id="e5d8" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jl hv">策划一个ICO？</strong>在<a class="ae kf" href="https://www.trustfractal.com/business/" rel="noopener ugc nofollow" target="_blank"> Fractal </a>大会上，我们提供了一个简单易用的launchpad解决方案，结合全面的客户身份识别服务(KYC/AML ),轻松成功地部署您的代币发行。</p></div></div>    
</body>
</html>