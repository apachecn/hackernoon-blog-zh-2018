<html>
<head>
<title>How to build powerful REST APIs blazingly fast with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js快速构建强大的REST APIs</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-build-powerful-rest-apis-blazingly-fast-with-node-js-86d6e55a5b34?source=collection_archive---------1-----------------------#2018-06-26">https://medium.com/hackernoon/how-to-build-powerful-rest-apis-blazingly-fast-with-node-js-86d6e55a5b34?source=collection_archive---------1-----------------------#2018-06-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/efe2a391f2cff21254be505c7e9adce1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYKqPVAB617KRYTMK7-34A.jpeg"/></div></div></figure><p id="b7dc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们面对现实吧，如果你是一个web开发人员，你要和API打交道。不管是自己写还是用别人的，都只是工作的一部分。REST APIs尤其常见。不幸的是，当谈到Javascript和Node.js的<a class="ae ka" href="https://twitter.com/nodejs/status/915607972918603776" rel="noopener ugc nofollow" target="_blank">狂野西部世界</a>时，编写RESTful APIs的<a class="ae ka" href="https://hackernoon.com/restful-api-designing-guidelines-the-best-practices-60e1d954e7c9" rel="noopener ugc nofollow" target="_blank">标准和良好实践</a>有时会被抛到脑后。</p><p id="bc55" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为什么？</p><ul class=""><li id="5a86" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">因为它“更容易”</li><li id="fd53" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">因为有时候“足够好”就够了</li><li id="b05c" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">因为每个人的“标准”可能不同</li><li id="a76d" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">…你说吧</li></ul><figure class="kp kq kr ks fq iv"><div class="bz el l di"><div class="kt ku l"/></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">don’t be that developer…</figcaption></figure><p id="5747" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这些都是编写弱代码的好理由吗？当然不是，但它们仍然存在。它的人性。“走捷径”太容易了，有时在时间紧迫的情况下，这似乎是不可避免的。相信我，我也经历过。那么对此能做些什么呢？好消息是，当你有了正确的工具集时，会有更好的开发方法，如果足够幸运，你甚至会发现“正确的”方法<strong class="je hv"> <em class="kz">是最简单的方法</em> </strong>。我花了很长时间才找到自己的发现之路。我希望通过分享我的故事，我可以让你(和你的API消费者)不那么心痛。以下是我学到的…</p><blockquote class="la"><p id="54b9" class="lb lc hu bd ld le lf lg lh li lj jz ek translated"><em class="lk">如果想直接进入正题，可以跳到</em> <strong class="ak"> <em class="lk">结果</em> </strong> <em class="lk">部分。或者参观</em><a class="ae ka" href="https://github.com/JKHeadley/rest-hapi" rel="noopener ugc nofollow" target="_blank">https://github.com/JKHeadley/rest-hapi</a></p></blockquote><figure class="lm ln lo lp lq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ll"><img src="../Images/41453e313576d7a331d1c61737d885fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*06tX3horiyy70zu9i4bQ1Q.jpeg"/></div></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">you’re in for a wild ride</figcaption></figure><h1 id="c121" class="lr ls hu bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo dt translated">故事</h1><p id="3a40" class="pw-post-body-paragraph jc jd hu je b jf mp jh ji jj mq jl jm jn mr jp jq jr ms jt ju jv mt jx jy jz hn dt translated">在过去的几年里，我一直在软件咨询公司Scal.io担任网页开发员。在此期间，我有幸学习了Node.js，并在多个应用程序上工作，这些应用程序都服务于RESTful APIs。起初一切似乎都很好。我的意思是，只要谷歌一下关于用Node.js构建RESTful API的任何教程，你就会发现大量关于如何在几分钟内建立并运行你自己的服务器的文章和视频。</p><p id="b399" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">哇！这东西很简单！(我以为)<em class="kz">至少一开始</em> …</p><p id="71e8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">没过多久，我就开始遇到问题了。</p><p id="45d2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">哦，你想要有效载荷验证？查询参数呢？我如何记录这些端点？我真的需要一遍又一遍地复制和粘贴这些路由处理程序吗？等等，你想用MongoDB，但是<a class="ae ka" href="https://hackernoon.com/the-problem-with-mongodb-d255e897b4b" rel="noopener ugc nofollow" target="_blank">还支持关系</a>？😳</p><p id="ee64" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">用Node.js编程非常灵活，这意味着即使是一个简单的任务也可以用许多不同的方法来解决。不幸的是，这意味着开发人员可以自由地<a class="ae ka" rel="noopener" href="/javascript-scene/the-single-biggest-mistake-programmers-make-every-day-62366b432308">过度复杂的事情</a>(我们倾向于这样做)。难怪当特性请求开始堆积时，API开发会失控。这可能很快变成一个丑陋的混乱，<strong class="je hv"> <em class="kz">尤其是</em> </strong>如果你试图与其他开发者协调。</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mu"><img src="../Images/550a0dd6e2d354861f3766d772ee2d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PfYC0YJCZAGjTaJ3kk2toQ.jpeg"/></div></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">the king of sanity?</figcaption></figure><p id="989c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在一起完成了几个项目后，我的一个优秀的开发人员<a class="ae ka" href="https://github.com/zacharyclaysmith" rel="noopener ugc nofollow" target="_blank">朋友</a>想出了(并实现了)基于我们的数据模型生成RESTful端点的好主意。我立刻喜欢上了它。现在，我们花了更多的时间关注应用的结构和业务逻辑，而不是一遍又一遍地编写CRUD端点。不仅如此，任何时候我们需要新的功能(比如过滤GET请求)时，我们只需要为所有端点编写一次就可以了！这感觉就像一个干燥的API天堂😆</p><p id="90d7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我知道我们正在做一些事情…</p><h1 id="2a8e" class="lr ls hu bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo dt translated">旅程</h1><p id="5b85" class="pw-post-body-paragraph jc jd hu je b jf mp jh ji jj mq jl jm jn mr jp jq jr ms jt ju jv mt jx jy jz hn dt translated">在我们完成这个项目后不久，我就开始研究如何利用我们已经创造的东西，把它变成一个有用的工具。最初的解决方案运行良好，但是它与项目紧密结合，仍然缺少大量的功能。我花了几天时间集思广益，重新编写代码。经过看似巨大的努力，我终于有了一个可行的解决方案。然而(像大多数开始一样)…这很尴尬。</p><p id="5f8b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个工具可以工作，但是它是作为一个框架存在的，你必须直接从GitHub (eww)中克隆出来。开发人员被迫围绕框架设计他们的项目，即使与我们最初的解决方案相比，它仍然缺乏很多功能。</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mv"><img src="../Images/23d0699c6b0b7c5e10f5fc681fe6ce01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mE6kQg2C80tBBP6Ez_ULQQ.png"/></div></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">I feels it tho!</figcaption></figure><p id="9098" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">幸运的是，事情才刚刚开始。我对这个项目仍然有自己的希望和梦想，现在它正式公开了，它开始慢慢地获得一些兴趣。随着开发人员给出反馈、提交问题，甚至有人开始投稿，开源的魔力开始显现！</p><p id="3930" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">不久之后，主要的改进就完成了，比如把这个项目变成了一个npm模块和一个T2 hapi服务器插件。我也有了一个惊人的机会(感谢<a class="ae ka" href="http://scal.io" rel="noopener ugc nofollow" target="_blank"> Scal.io </a>)在一些现实世界的项目中开发和使用这个工具。</p><p id="f43c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我一直相信这个项目的核心概念，但是通过我自己的经历来验证它的有用性是令人兴奋的。</p><figure class="kp kq kr ks fq iv"><div class="bz el l di"><div class="mw ku l"/></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">yessss</figcaption></figure><p id="7e17" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它改进得越多，我就越觉得我们真的挖掘到了RESTful API开发的金矿。最终的代码是一致的、健壮的，并且易于遵循(标准…耶！).不仅如此，以前需要几天或几周才能开发的东西现在只需几个小时就能完成！</p><h1 id="74cd" class="lr ls hu bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo dt translated">结果呢</h1><figure class="kp kq kr ks fq iv fe ff paragraph-image"><a href="https://github.com/JKHeadley/rest-hapi"><div class="fe ff mx"><img src="../Images/b8b34c105cb58abcd32b92c1090f4ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*fpvgfJJX0LjR74xVMZ3oUQ.png"/></div></a><figcaption class="kv kw fg fe ff kx ky bd b be z ek">rest-hapi</figcaption></figure><p id="ceee" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">经过近两年的努力工作和开发，我很高兴向web开发社区介绍rest-hapi v1。到目前为止，我们已经能够将许多有用的功能打包到该工具中，包括:</p><ul class=""><li id="d31d" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">在<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/middleware.html" rel="noopener ugc nofollow" target="_blank">中间件</a>的支持下，自动生成<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/creating-endpoints.html" rel="noopener ugc nofollow" target="_blank"> CRUD </a>和<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/associations.html" rel="noopener ugc nofollow" target="_blank">关联</a>端点</li><li id="a4de" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://github.com/hapijs/joi" rel="noopener ugc nofollow" target="_blank">joi</a>T16】验证</li><li id="55a1" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">路线级和文件级<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/authorization.html" rel="noopener ugc nofollow" target="_blank">授权</a></li><li id="e8c7" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">所有生成端点的<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/swagger-documentation.html" rel="noopener ugc nofollow" target="_blank"> Swagger docs </a></li><li id="798d" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/querying.html" rel="noopener ugc nofollow" target="_blank">查询参数</a>支持关联模型的搜索、排序、过滤、分页、嵌入</li><li id="938f" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">通过<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/audit-logs.html" rel="noopener ugc nofollow" target="_blank">审计日志</a>查看端点活动历史</li><li id="23c3" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">对<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/policies.html" rel="noopener ugc nofollow" target="_blank">政策的支持</a></li><li id="00f3" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated"><a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/duplicate-fields.html" rel="noopener ugc nofollow" target="_blank">重复字段</a></li><li id="00b6" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">支持<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/soft-delete.html" rel="noopener ugc nofollow" target="_blank">“软”删除</a></li><li id="339c" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">文档的可选<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/metadata.html" rel="noopener ugc nofollow" target="_blank">元数据</a></li><li id="48c7" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">mongose<a class="ae ka" href="https://jkheadley.github.io/rest-hapi/docs/mongoose-wrapper-methods.html" rel="noopener ugc nofollow" target="_blank">包装器方法</a></li><li id="8f07" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">…以及更多！</li></ul><p id="0971" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">只需几个简单的数据模型，您就可以立即生成数百个记录在案的可靠端点。看看这些例子:</p><figure class="kp kq kr ks fq iv fe ff paragraph-image"><a href="http://resthapi.com"><div class="fe ff my"><img src="../Images/2a2a31e5ebc66e85b13db8e636e7fd01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bJVbMI6QOhtxjGIl7O8MxA.gif"/></div></a><figcaption class="kv kw fg fe ff kx ky bd b be z ek">generating endpoints locally</figcaption></figure><figure class="kp kq kr ks fq iv fe ff paragraph-image"><a href="http://demo.resthapi.com"><div class="fe ff mz"><img src="../Images/83016964a7fe67346bb62be44701610d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_2YHCLAmT1HmDYn0IR4qSg.gif"/></div></a><figcaption class="kv kw fg fe ff kx ky bd b be z ek">querying the user collection and populating the user-role relationship</figcaption></figure><p id="e99a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从一开始，我们的目标就是开发一个工具，允许开发者以最小的开销构建强大的REST APIs，我相信我们已经做到了！我仍然对这个项目的未来充满希望和梦想，但是现在我为我们所取得的成就感到骄傲。</p><p id="e3d9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它是同类工具中唯一的吗？没有。</p><p id="41fc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它适合每种情况吗？当然不是！</p><p id="e371" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对你有用吗？我们希望你能<a class="ae ka" href="https://github.com/JKHeadley/rest-hapi" rel="noopener ugc nofollow" target="_blank">检查一下</a>并自己做出决定！我们希望听到您的反馈。如果你喜欢它，请在GitHub上给它一颗星😉</p><p id="4a6a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在以后的文章中，我将深入探讨rest-hapi背后的设计理念的更多细节，以及一些如何使用它来构建自己的优秀REST APIs的实际例子。</p><p id="2b10" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你想联系我，你可以通过推特<a class="ae ka" href="https://twitter.com/JKHeadley" rel="noopener ugc nofollow" target="_blank">、脸书</a><a class="ae ka" href="https://www.facebook.com/justinkheadley" rel="noopener ugc nofollow" target="_blank">、领英</a>或电子邮件<a class="ae ka" href="mailto:headley.justin@gmail.com" rel="noopener ugc nofollow" target="_blank">headley.justin@gmail.com</a>联系我。希望你喜欢这篇文章。感谢阅读！</p><h2 id="b655" class="na ls hu bd lt nb nc nd lx ne nf ng mb jn nh ni mf jr nj nk mj jv nl nm mn nn dt translated">如果你喜欢这篇文章，就把它拍下来。反馈总是很受欢迎。别忘了你最多可以鼓掌50次！❤</h2></div></div>    
</body>
</html>