<html>
<head>
<title>Building with NativeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NativeScript构建</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-with-nativescript-9e8e9d0e2fe5?source=collection_archive---------17-----------------------#2018-06-27">https://medium.com/hackernoon/building-with-nativescript-9e8e9d0e2fe5?source=collection_archive---------17-----------------------#2018-06-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="cc63" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">来自一家尝试将其应用于生产的初创公司的报告</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/80c206e1b7e20515b2a359903a863610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTBcnfIoY14bApp3NJs0fQ.jpeg"/></div></div></figure><p id="9ac2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">在TapChief，我们已经使用Angular个月了。我们已经很适应了。</p><p id="56c0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">作为一个由5名工程师组成的团队，我们在Django建立了一个REST后端，一个ElasticSearch服务器，以及两个不同的Angular产品。</p><p id="349b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">构建原生应用成为我们的一项关键业务需求，但我们没有资源为他们组建单独的团队。</p><p id="3a64" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">大约3周前，我们决定向前一步，使用NativeScript，这样我们就可以重用我们的角度知识，并为iOS和Android提供一个共享的代码库。随着我们继续开发应用程序，我们将分享我们的经验和知识。</p></div><div class="ab cl kr ks hc kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hn ho hp hq hr"><h2 id="3e90" class="ky kz hu bd la lb lc ld le lf lg lh li ke lj lk ll ki lm ln lo km lp lq lr ls dt translated">调用原生Android/iOS代码</h2><p id="5c4d" class="pw-post-body-paragraph jv jw hu jx b jy lt iv ka kb lu iy kd ke lv kg kh ki lw kk kl km lx ko kp kq hn dt translated">这被认为是NativeScript与Ionic或ReactNative的最大区别。可以把它想象成NativeScript已经构建了一个语言翻译器，可以把你的类型脚本代码直接转换成Java/Objective-C代码。</p><p id="3ed1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们立即怀疑这是否会像宣传的那样容易。因此，我们首先尝试的事情之一是将QuickBlox android和iOS SDKs集成到我们的应用程序中。</p><p id="ba84" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们必须将iOS SDK包装成一个nativescript插件，并创建一个叫做Podfile的东西。这是令人生畏的，因为我们没有一个人对iOS开发有任何了解，但是有足够的文档来说明这一点。最后，安装SDK需要创建一个这样的文件夹:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/27b55afbfe207a6974e304e1b6f1b5a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*QPPCv034927FHIieaTCFtQ.png"/></div></figure><p id="7c27" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">Podfile只有一行。</p><pre class="jk jl jm jn fq lz ma mb mc aw md dt"><span id="e993" class="ky kz hu ma b fv me mf l mg mh"># Podfile<br/>pod 'QuickBlox'</span></pre><p id="bcb6" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">package.json也同样简单。</p><pre class="jk jl jm jn fq lz ma mb mc aw md dt"><span id="850c" class="ky kz hu ma b fv me mf l mg mh"># package.json<br/>{<br/>  "name": "qb-ios-plugin",<br/>  "version": "0.0.1",<br/>  "nativescript": {<br/>    "platforms": {<br/>      "ios": "1.3.0"<br/>    }<br/>  }<br/>}</span></pre><p id="90ec" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然后运行<strong class="jx hv"> <em class="mi"> tns构建ios。</em>T3】</strong></p><p id="c01e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">然后可选运行<strong class="jx hv"><em class="mi">TNS _ TYPESCRIPT _ DECLARATIONS _ PATH = " $(pwd)/typings " TNS build ios<br/></em></strong>为所有调用iOS代码的TYPESCRIPT代码构建d.ts文件。</p><p id="e0c1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这在挖掘一个新库时非常有用，因为它向您精确地展示了所有方法和类的TypeScript版本是如何被引用的——请看下面代码示例中的“declare class QMServicesManager”</p><blockquote class="mj mk ml"><p id="946c" class="jv jw mi jx b jy jz iv ka kb kc iy kd mm kf kg kh mn kj kk kl mo kn ko kp kq hn dt translated">调用本机第三方iOS SDK代码的类型脚本代码示例</p></blockquote><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mp mq l"/></div><figcaption class="mr ms fg fe ff mt mu bd b be z ek">Comparing the TypeScript code with the corresponding Objective-C Code</figcaption></figure><p id="e072" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这是为SDK创建的自动生成的类型文件的一个片段。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mp mq l"/></div><figcaption class="mr ms fg fe ff mt mu bd b be z ek">Sample types d.ts file (auto-generated)</figcaption></figure><p id="12e9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如你所见，它与相应的本机代码非常相似。您通常可以猜测函数名。</p><p id="de51" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">NativeScript使用反射来理解iOS/Android代码，并为其构建typescript绑定。上面的Quickblox.d.ts就是这样一个绑定的例子。这意味着你不必等待别人来搭建桥梁来遮蔽你想要使用的第三方包。该桥是在构建时自动创建的！</p><p id="220c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这比我们预期的要容易得多，而且在一天之内拼凑出一个功能性的聊天服务集成令人难以置信地满意。尤其是你之前从来没有编码过Android或者iOS的时候！</p></div><div class="ab cl kr ks hc kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hn ho hp hq hr"><h2 id="72fd" class="ky kz hu bd la lb lc ld le lf lg lh li ke lj lk ll ki lm ln lo km lp lq lr ls dt translated">以打字打的文件</h2><p id="1dd6" class="pw-post-body-paragraph jv jw hu jx b jy lt iv ka kb lu iy kd ke lv kg kh ki lw kk kl km lx ko kp kq hn dt translated">就我个人而言，我非常喜欢静态打字。这使得深入他人的代码变得更加容易。同样，我们自己的角度代码库更容易维护。</p><p id="0827" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">如果我不能为我上面使用的iOS库生成类型，方法将会更加难以发现。</p><p id="f8c1" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">TypeScript代码最终看起来与它实际调用本机桥调用的Java代码非常相似。语言结构经常以相似的方式映射在一起，在这里使用TypeScript感觉很自然。</p><h2 id="93fb" class="ky kz hu bd la lb lc ld le lf lg lh li ke lj lk ll ki lm ln lo km lp lq lr ls dt translated">构建时间</h2><p id="cf42" class="pw-post-body-paragraph jv jw hu jx b jy lt iv ka kb lu iy kd ke lv kg kh ki lw kk kl km lx ko kp kq hn dt translated">我上班用的是MacBook 2016 (16GB Ram，SSD)。从头开始构建APK并将其加载到手机上的第一个周期大约需要一分钟。</p><p id="a84d" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">后续的增量构建轻而易举。它们只需要几秒钟。不知何故，LiveSync for NativeScript比Angular为web提供的增量编译更快！</p><p id="fb59" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我的一些同事用了4年的个人笔记本电脑，有8GB内存和一个硬盘。这使得构建极其缓慢。每个android版本从头开始需要大约15分钟，尽管LiveSync(增量版本)仍然只有几秒钟长。现在，所有人都有了全新的16 GB固态硬盘:)</p><h2 id="39f2" class="ky kz hu bd la lb lc ld le lf lg lh li ke lj lk ll ki lm ln lo km lp lq lr ls dt translated">模板化</h2><p id="68b4" class="pw-post-body-paragraph jv jw hu jx b jy lt iv ka kb lu iy kd ke lv kg kh ki lw kk kl km lx ko kp kq hn dt translated">我们的前端领导者Deepak编写了我们的大部分UI组件。我会督促他以后写他自己的文章。从我的角度来看，他花了大约3-4天的时间搜索UI文档，并花了整整一周的时间痛苦而缓慢地编写模板。但除此之外，他在Angular中的工作效率几乎和HTML一样高。</p><p id="35e5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">虽然XML代码在大部分地方都是一样的，但是还是有一些Android或iOS特有的逻辑隐藏在模板文件中。</p><p id="9e9c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">SCSS在我们有角度的代码库中构建我们的风格方面发挥了重要作用，并且能够使用SCSS和我们在那里学到的所有惯例，这使得我们在这里的工作变得容易得多。</p><h2 id="7fdf" class="ky kz hu bd la lb lc ld le lf lg lh li ke lj lk ll ki lm ln lo km lp lq lr ls dt translated">学习曲线</h2><p id="74df" class="pw-post-body-paragraph jv jw hu jx b jy lt iv ka kb lu iy kd ke lv kg kh ki lw kk kl km lx ko kp kq hn dt translated">学习基于XML的模板语言花了一段时间。作为一个从未开发过iOS应用程序的人，我不得不学习委托、安装库和其他小习惯。android也是如此，第一次编写插件需要一些工作。</p><p id="6d45" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">但除此之外，实际上其他一切都和Angular一样。我们只是浏览了一下教程，然后直接进入编码。如果你以前有过Angular的经验，这应该是一个非常容易的转变——在你感到有效率之前的一两个星期。</p><p id="a417" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">用Angular编写的服务逻辑几乎是复制粘贴到NativeScript代码库中的。尽管UI组件是从零开始编写的。Deepak一直专注于编写UI组件，而Abhijith和我一直在研究如何集成聊天、google-places、原生插件、编写富文本编辑器等等。我们5个人中只有3个人在开发NativeScript应用程序，我们看到了良好的进展。</p><p id="eae0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">文档很不错。在这和一些谷歌搜索之间，我们不需要直接接触社区来解决我们的问题。</p></div><div class="ab cl kr ks hc kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hn ho hp hq hr"><p id="55a6" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们对NativeScript很满意。有时感觉有点不可思议。有一个问题引起了社区的热烈讨论。Airbnb会在NativeScript上遇到同样的问题吗？— <a class="ae mv" rel="noopener" href="/airbnb-engineering/react-native-at-airbnb-the-technology-dafd0b43838"> Airbnb日落反应</a></p><p id="3108" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">他们最大的两个问题是<br/> <em class="mi"> 1。在Javascript <br/> 2中缺少输入。构建底层平台的本地桥是非常痛苦的</em></p><p id="c911" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">这些都是NativeScript的固有优势。我自己的经验有限，但我敢打赌，他们对NativeScript会有更好的体验。</p><p id="ee4d" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">更新:</strong></p><p id="ca12" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">我们在Github上为NativeScript制作了一个示例富文本编辑器。看看吧！</p><p id="bb2a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><a class="ae mv" href="https://github.com/aukris/nativescript-rich-text-example" rel="noopener ugc nofollow" target="_blank">https://github.com/aukris/nativescript-rich-text-example</a></p></div></div>    
</body>
</html>