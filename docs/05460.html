<html>
<head>
<title>Build Your Own IoT Smart Lock with Secure Access Management</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建您自己的物联网智能锁，提供安全的访问管理</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-your-own-iot-smart-lock-with-secure-access-management-955b31dbf97e?source=collection_archive---------14-----------------------#2018-06-28">https://medium.com/hackernoon/build-your-own-iot-smart-lock-with-secure-access-management-955b31dbf97e?source=collection_archive---------14-----------------------#2018-06-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/497c7070806989e9d4561afe61c63d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7WU7meVhuB8VlRTANi1w-A.png"/></div></div></figure><p id="3f46" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">自从人类试图锁好东西并保护他们的财产安全以来，窃贼(这里指的是黑客)就一直试图撬开这些锁。如果我们说你可以建立自己的智能锁，只允许<strong class="je hv">你</strong>能够打开它，听起来如何？</p><p id="aa43" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">今天的用户期望实时交互。PubNub让您可以轻松地将实时功能添加到您的应用程序中，而无需担心基础架构。您可以构建应用程序，让您的用户能够在移动设备、浏览器、桌面和服务器上进行实时互动。PubNub为<a class="ae ka" href="https://www.pubnub.com/solutions/iot/?utm_source=Syndication&amp;utm_medium=Medium&amp;utm_campaign=SYN-CY18-Q2-Medium-June-21" rel="noopener ugc nofollow" target="_blank">物联网和智能设备</a>提供实时通信，并为任何规模的物联网部署提供通信基础设施和API。而<a class="ae ka" href="https://www.pubnub.com/products/security-overview/?utm_source=Syndication&amp;utm_medium=Medium&amp;utm_campaign=SYN-CY18-Q2-Medium-June-21" rel="noopener ugc nofollow" target="_blank"> PubNub访问管理</a>让这一切变得安全。</p><p id="60ba" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此处提供了该项目的完整GitHub回购。 下面是它的演示:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="kf kg l"/></div></figure><h1 id="eb80" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">什么是PubNub访问管理器(PAM)？</h1><p id="617a" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">PubNub访问管理器通过提供基于令牌的授权扩展了PubNub的安全框架，允许在用户、设备和通道级别进行读写访问控制。PubNub Access Manager在物联网/家庭自动化设备管理系统中发挥着重要作用，在该系统中，安全数据在注册设备和物联网设备(如灯泡、传感器或锁)之间双向流动。</p><h1 id="8f1d" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">设置PAM</h1><p id="30c3" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">要访问PubNub Access Manager，您需要在PubNub <a class="ae ka" href="https://admin.pubnub.com/?utm_source=Syndication&amp;utm_medium=Medium&amp;utm_campaign=SYN-CY18-Q2-Medium-June-21" rel="noopener ugc nofollow" target="_blank">管理仪表板</a>中启用Access Manager(如果您还没有，请先注册)。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lk"><img src="../Images/f347824d380eaf1b2501ce5b638547f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vDa1Iex7zVgSeFzX.png"/></div></div></figure><p id="5349" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ll">将访问管理器设置为开</em></p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lk"><img src="../Images/0b02782af10e525a7610ac704b8a66df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CpPxrlvzXsaEDcxZ.png"/></div></div></figure><p id="4c53" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ll">键入ENABLE并点击“保存更改”</em></p><p id="2fd3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，您已经做好了向用户、组和通道授予访问权限的准备，这些用户、组和通道可以访问可以发送或接收的数据。</p><p id="f353" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">PAM完全按照授权许可方案运行，有3个访问级别:</p><ul class=""><li id="dcf0" class="lm ln hu je b jf jg jj jk jn lo jr lp jv lq jz lr ls lt lu dt translated">所有用户可以通过所有渠道访问</li><li id="8939" class="lm ln hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">所有用户通过特定频道进行访问</li><li id="d750" class="lm ln hu je b jf lv jj lw jn lx jr ly jv lz jz lr ls lt lu dt translated">特定用户通过特定频道的访问</li></ul><h1 id="1520" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">树莓派</h1><p id="fd1d" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">这里的想法是使用Raspberry Pi为一个简单的锁机制提供动力。你可以看看我们的PubNub博客，关于<a class="ae ka" href="https://www.pubnub.com/blog/2015-05-27-internet-of-things-101-getting-started-w-raspberry-pi/?utm_source=Syndication&amp;utm_medium=Medium&amp;utm_campaign=SYN-CY18-Q2-Medium-June-21" rel="noopener ugc nofollow" target="_blank">如何与Raspberry Pi </a>和<a class="ae ka" href="https://www.pubnub.com/blog/2015-07-22-getting-started-with-raspberry-pi-2-and-pubnub-in-python-programming-language/?utm_source=Syndication&amp;utm_medium=Medium&amp;utm_campaign=SYN-CY18-Q2-Medium-June-21" rel="noopener ugc nofollow" target="_blank">如何开始使用Raspberry Pi 2和Python。</a></p><p id="ff5e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">设置Raspberry Pi后，安装Python并使用以下命令将PubNub导入到您的设置中:</p><pre class="kb kc kd ke fq ma mb mc md aw me dt"><span id="f355" class="mf ki hu mb b fv mg mh l mi mj">pip install Pubnub</span></pre><h1 id="6a66" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">授予访问权限</h1><p id="35c9" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">为了正确执行PAM操作，您必须提供管理权限。为了执行管理功能，您需要将<code class="eh mk ml mm mb b">secret_key</code>与<code class="eh mk ml mm mb b">publish_key</code>和<code class="eh mk ml mm mb b">subscribe_key</code>包括在内。</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="mn kg l"/></div></figure><p id="debb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您的密钥将包含您的认证密钥<code class="eh mk ml mm mb b">authKey</code>。这个<code class="eh mk ml mm mb b">authKey</code>应该是你的设备独有的。在运行期间的任何时候，您都可以使用<code class="eh mk ml mm mb b">setAuthKey()</code>功能设置<code class="eh mk ml mm mb b">authKey</code>。</p><p id="2b70" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如前所述，在PAM中有3个访问级别。像许多其他“物联网”设备一样，智能锁容易受到互联网黑客的攻击。因此，使用PubNub访问管理器可以为您的智能锁提供的最高安全级别是通道+ authKey级别访问。</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="mn kg l"/></div></figure><p id="a76c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此示例授予auth_key在Raspberry频道中为“Valid_key”的用户5分钟的访问权限。如果用户没有访问权限并试图发布，他们会收到403错误。</p><p id="e61b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然而，如果您有权发布，您可以看到您的<a class="ae ka" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> JavaScript </a>授权代码的以下响应:</p><pre class="kb kc kd ke fq ma mb mc md aw me dt"><span id="57bf" class="mf ki hu mb b fv mg mh l mi mj">{ error: false, operation: 'PNAccessManagerGrant', statusCode: 200 }</span></pre><h1 id="cdea" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">解锁操作</h1><p id="d55a" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">向特定频道的用户授予权限后，您可以尝试将消息发布到设备上。如果用户被授权发布锁，您应该能够解锁设备。</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="mn kg l"/></div></figure><p id="2044" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您不是有效用户，或者如果您没有被授予访问权限并试图解除锁定，则在使用JavaScript时会出现以下错误:</p><pre class="kb kc kd ke fq ma mb mc md aw me dt"><span id="c56b" class="mf ki hu mb b fv mg mh l mi mj">{error: true, operation: "PNPublishOperation", statusCode: 403, errorData: Error: Forbidden at Request.&lt;anonymous&gt; (https://cdn.pubnub.com/sdk/javascript/pubnub.4.20.1.js:…, category: "PNAccessDeniedCategory"}</span></pre><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff mo"><img src="../Images/85f4a10c22b3ea2d48e89ad35d164de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*KSGZdh5sc5JqaHX3.png"/></div></figure><h1 id="eadb" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">包扎</h1><p id="08ed" class="pw-post-body-paragraph jc jd hu je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">使用Python在您的Raspberry Pi上设置<a class="ae ka" href="https://hackernoon.com/tagged/pubnub" rel="noopener ugc nofollow" target="_blank"> PubNub </a>既简单又直接。您可以使用PubNub Access Manager提供用户级的读或写访问权限，使您的锁高度安全。PubNub authKey确保只有您有权解锁物联网，使其更加安全可靠。</p><p id="e92c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在我们的下一部分，<a class="ae ka" href="https://www.pubnub.com/blog/implementing-google-oauth-2-and-pubnub-access-manager-with-smart-lock/?utm_source=Syndication&amp;utm_medium=Medium&amp;utm_campaign=SYN-CY18-Q2-Medium-June-21" rel="noopener ugc nofollow" target="_blank">我们添加了OAuth 2.0，使我们的应用更加安全</a>！</p></div><div class="ab cl mp mq hc mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hn ho hp hq hr"><p id="0652" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ll">最初发表于</em><a class="ae ka" href="https://www.pubnub.com/blog/iot-smart-lock-with-secure-access-management-raspberry-pi/?utm_source=Syndication&amp;utm_medium=Medium&amp;utm_campaign=SYN-CY18-Q2-Medium-June-21" rel="noopener ugc nofollow" target="_blank">T5【www.pubnub.com】</a><em class="ll">。</em></p><p id="f979" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ka" href="https://upscri.be/hackernoon/" rel="noopener ugc nofollow" target="_blank">https://upscri.be/hackernoon/</a></p></div></div>    
</body>
</html>