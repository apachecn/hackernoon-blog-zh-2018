<html>
<head>
<title>Neural networks for landing page optimization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于着陆页面优化的神经网络</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/neural-networks-for-landing-page-optimization-564153b4d120?source=collection_archive---------6-----------------------#2018-06-29">https://medium.com/hackernoon/neural-networks-for-landing-page-optimization-564153b4d120?source=collection_archive---------6-----------------------#2018-06-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="d6b2" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">通过强化学习将A/B测试提升到一个新的水平。</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/dc0db631288a1bf58828293303db1a0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qO0TC3QDV_gZGvtTHGEl3g.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">AI looking for optimal landing page version</figcaption></figure><h1 id="329c" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">为什么，什么和如何？</h1><p id="575e" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我想分享一些我用神经网络进行登陆页面多参数优化的实验。我已经考虑这个想法半年了，从自动化的角度来看，我觉得这个想法非常有趣。A/B测试占用了营销专家大量的时间，并且需要大量的流量才能运行良好。当一个小团队管理大量的登录页面时，这就变得很成问题，对于一些项目来说，这也是关于登录页面的“老化”——它们可能会因为促销或优惠的结束而变得过时。</p><p id="116a" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">有许多方法可以解决这个问题。老派的MVTs(多变量测试)在谷歌优化中完成，最终会在所有可能的登陆页面版本之间分割流量。如果你有3个变量要测试，这是没问题的。但是想象一下你测试3个标题，3个副标题，2个按钮颜色，2个标题图片和一些通用布局的版本。这很容易达到10k+独特的组合。因为您估计有50k的流量，目标是尽可能快地找到最佳或接近最佳的版本。你牺牲了纯粹的统计精度，试图达到尽可能多的转化率。</p><p id="305a" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">我知道一些潜在的方法。<strong class="kt hv">首先</strong>是将不同的特性视为独立的实体，想象你正在做一个单独的数字A/B测试。通过这种方式，您将很快获得一些结果，但是如果存在任何交叉特征相关性，您将会错过它们，并且您的解决方案将不是最优的。<strong class="kt hv">第二个</strong>是用遗传算法。有一些公司就是这么做的——<em class="ls"/><a class="ae lt" href="http://sentient.ai" rel="noopener ugc nofollow" target="_blank"><em class="ls">有情提升</em> </a> <em class="ls"> </em>比如。从他们的宣传材料来看，似乎他们使用了某种遗传算法。第三是使用<strong class="kt hv">多臂强盗</strong>理论。解决多臂土匪问题的方法之一是使用强化学习和神经网络。</p><p id="8205" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">让我们从简单的概述开始。</p><h2 id="7a6e" class="lu ka hu bd kb lv lw lx kf ly lz ma kj la mb mc kl le md me kn li mf mg kp mh dt translated">遗传算法</h2><p id="4a0e" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">遗传算法正在模仿自然选择过程。将不同的网页变化视为生物的特征——有些有助于生存，有些是中性的，有些会有负面影响。遗传算法的基本工作流程是这样的:</p><ul class=""><li id="bed4" class="mi mj hu kt b ku ln kx lo la mk le ml li mm lm mn mo mp mq dt translated">生成一些(比如说100个)具有随机特征集的不同后代(100个具有各种版本特征的登录页面)</li><li id="61e2" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">让流量流入其中，并测量转化率(从进化角度来看的存活率)。</li><li id="faef" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">计算所谓的健康分数——每个页面的表现如何</li><li id="a29b" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">选取20个表现最好的页面，提取它们的特征，并以一种新的方式混合它们。然后，在混合物中加入一些表现最差的20个页面的特性。可能会有罕见的“突变”被其他特征隐藏，这对多样性有好处。基于这些特征生成新的100页。</li><li id="c380" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">重复n次-&gt;盈利。</li></ul><p id="3a8f" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">虽然这个系统看起来不错，但我发现了一些我不喜欢的地方。</p><ul class=""><li id="cc8a" class="mi mj hu kt b ku ln kx lo la mk le ml li mm lm mn mo mp mq dt translated">它仍然需要大量的交通</li><li id="b7ae" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">在测试过程中，当用户档案/特征发生变化时(出现新的采集通道)，变化缓慢</li><li id="435d" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">它没有考虑用户配置文件(一天中的时间、浏览器、设备等)</li><li id="1230" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">它没有使用神经网络；-)</li></ul><p id="d3fd" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">所以，我决定建造一些NN驱动的2018风格的东西。我和一些做CPA营销的见不得人的家伙做了一笔交易:我会建立一个系统，他们会给我流量来测试它。双赢。CPA是这种系统的完美用例。</p><h1 id="e43c" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">研究阶段</h1><p id="5494" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我需要做的是用神经网络解决所谓的“多臂强盗”问题。据我所知，还有一些关于强化学习的很好的介绍，你可以在底部找到链接。我把这个项目归结为几个阶段，就像多臂强盗问题一样。</p><ul class=""><li id="eac2" class="mi mj hu kt b ku ln kx lo la mk le ml li mm lm mn mo mp mq dt translated">阶段0。有一个武器不多的赌场强盗。一个多臂强盗，每个臂(网站的不同功能)有一个稍微不同的支付概率(点击率)。你需要建立一个系统，在最少的尝试次数中找到表现最好的手臂，然后坚持一直玩这个手臂(展示这个版本的网站)。请记住，由于这个问题的概率性质，您的解决方案总有可能是错误的。但在现实世界里，多赚钱总是好的。</li><li id="865a" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">第一阶段。用户来了。赌场里住着很多多武装的土匪。不同的用户会玩不同的土匪，系统必须找到什么用户应该玩什么土匪。It登录页面类比这意味着不同的用户对您的登录页面有不同的反应，因此您必须根据用户特征向每个用户显示不同的页面。</li><li id="a7ca" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">第二阶段。时机来了。有很多房间有很多手的强盗，你必须通过每个房间和每个房间里的一个强盗。你的支付概率取决于你在每个房间的表现。这是一个完整版本的问题，当你有多步骤的销售过程-预登陆，登陆，电子邮件营销等。</li></ul><p id="d7ad" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">我将分享我对实现阶段0问题的见解。</p><h2 id="65ad" class="lu ka hu bd kb lv lw lx kf ly lz ma kj la mb mc kl le md me kn li mf mg kp mh dt translated">为什么只有阶段0？</h2><p id="43b9" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我的内心对解决每一步所需的流量过于乐观。我的CPA伙计们同意在一个登录页面上测试10-20k的流量，我认为这足以测试阶段0 +阶段1优化，但数学对我不利。对于阶段1，IMHO，将需要多一个数量级的流量。在系统调整和研究之后可能会更少。</p><h1 id="91f8" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">最近一次运行的结果</h1><p id="5644" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">在这里，我将描述系统在生产中的最新运行结果以及获得的一些见解。下面你会发现一些代码和实现细节，供精通技术的人使用。</p><p id="6f1d" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">所以，我们发起了一个50/50的分裂测试。50%是去静态登陆页面，50%是去神经引擎驱动的动态登陆页面。在最初的3-4天之后，我注意到我的神经解决方案已经达到了变化(局部最小值),它是确定的并且不会改变(基于损失和重量)。这发生在大约3-4k的流量之后。</p><p id="fb16" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">我变得好奇，想看看我是否会根据数据的纯统计得出同样的变化。我计算了每个变量的平均CTR，选择了表现最好的变量，并与ML建议的变量进行比较。<strong class="kt hv">让我大吃一惊的是，这些竟然有80%的不同！</strong> NN是在暗示完全不同的版本。<em class="ls">有意思……</em></p><p id="65ea" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">那好吧。我想，神经网络应该比简单的线性代数和我更聪明。为了进一步验证我的发现，我停止学习神经网络，并对3个版本进行了面对面的比较:</p><ul class=""><li id="936e" class="mi mj hu kt b ku ln kx lo la mk le ml li mm lm mn mo mp mq dt translated">100%随机变化</li><li id="aec9" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">静态版本，建议使用功能性能的简单比较(获得每个功能的最佳性能，并将它们合并到登录页面中)</li><li id="93df" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">神经网络建议的静态版本</li></ul><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mw"><img src="../Images/42d7012ad076bcca0de6fb741421e638.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hGPi4cNRg8G2rtJ5IGkZGQ.png"/></div></div></figure><p id="d7d5" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">如你所见，我一直等到随机和非随机选择之间的差异变得有统计学意义。所以，这里是主要的要点:</p><ul class=""><li id="d7ae" class="mi mj hu kt b ku ln kx lo la mk le ml li mm lm mn mo mp mq dt translated">基于神经网络的系统执行与简单的基于P的统计相同的操作</li><li id="7241" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">统计学和神经网络系统显示的变异有80%的不同。这可能意味着我没有收集足够的数据来区分两者的表现。</li><li id="bdda" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">有可能表现最好的登录页面不仅仅是表现最好的特征的总和，并且确实存在二级相关性。</li><li id="6941" class="mi mj hu kt b ku mr kx ms la mt le mu li mv lm mn mo mp mq dt translated">我们需要更多的数据。</li></ul><h1 id="87f8" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">构建系统</h1><p id="cc65" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">经过一番挖掘，我认定我的问题是典型的“AI”强化学习。再次，有一个很大的速成班，我会在底部提到它，我用了很多。我想让我的代码在生产中运行，Tensorflow是一个可以选择的框架。在我的日常工作中，我更喜欢MXNet，也看看它。几乎可以生产了。</p><h2 id="998a" class="lu ka hu bd kb lv lw lx kf ly lz ma kj la mb mc kl le md me kn li mf mg kp mh dt translated">神经网络</h2><p id="75fa" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我使用了一个简单的两层完全连接的网络，将一个静态变量作为输入，将登陆页面的每个特征的概率作为输出。如果输入不是静态的，而是可变的，根据用户的特征(时间、地理位置、语言等)，为阶段1系统修改是很容易的。</p><pre class="jk jl jm jn fq mx my mz na aw nb dt"><span id="55a5" class="lu ka hu my b fv nc nd l ne nf">size=[3,2,3,3]<br/>self.DummyState = tf.Variable([[0.1]])<br/><br/>output = slim.fully_connected(self.DummyState,a_size,\<br/>    biases_initializer=None, weights_initializer=tf.ones_initializer())<br/><br/>self.res = [tf.squeeze(slim.fully_connected(output, x, \<br/>                              biases_initializer=None, \<br/>                              activation_fn=tf.nn.sigmoid,<br/>                              weights_initializer=tf.ones_initializer(), <br/>                              scope='results'+str(i))) <br/>           for i, x in enumerate(size)]</span></pre><p id="4e16" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">这是我用过的一个网络。尺寸变量表示被测试的特征的数量和每个特征的变化的数量。</p><h2 id="cf71" class="lu ka hu bd kb lv lw lx kf ly lz ma kj la mb mc kl le md me kn li mf mg kp mh dt translated">生产运行</h2><p id="cdb5" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">为了在生产中运行系统，我使用了Sanic后端，Postgres作为SQL存储，Tensorflow作为推理引擎。系统的学习是在服务器上实时进行的。</p><p id="9de9" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">对于每个网站访问，我们要求后端系统的推理结果和页面的变化显示给这个用户，这是大约30毫秒的延迟。转换后，它与用户的页面版本相匹配。</p><p id="40a7" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">我在访问后使用15分钟的延迟(典型的转换窗口为5分钟)来决定访问是否成功，然后这个访问用于运行神经网络训练的一个步骤。在测试期间，我在衰减探索与剥削因子。最初，登录页面是100%随机生成的，每天随机与神经网络建议的比例逐渐下降，直到10天内达到0。</p><h1 id="e1e3" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">一些技巧</h1><p id="a719" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">为了构建系统，我需要某种虚拟测试环境，所以我构建了一个简单的脚本来模拟对网站的访问和转换。这一过程的基石是为每个登录页面的变化生成一个“隐藏”的转化率概率。最初，我假设每个独特的特性组合都有自己的CTR，并且所有的特性都完全相互依赖。这是一种失败的方法，网络通常无法找到具有有效流量的最佳解决方案。据我所知，这不是一个真实的案例，标题文字和下面3个卷轴的颜色之间没有太多的关联。</p><pre class="jk jl jm jn fq mx my mz na aw nb dt"><span id="d096" class="lu ka hu my b fv nc nd l ne nf">self.bandits = [np.random.random(*size)]</span></pre><p id="93e1" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">然后我决定简化环境，决定所有的特性都是线性独立的。这是一种过于简化的方法，但它足以调整超参数并确保系统找到正确的解决方案。</p><pre class="jk jl jm jn fq mx my mz na aw nb dt"><span id="6af6" class="lu ka hu my b fv nc nd l ne nf">self.bandits = [np.random.random(x)/50+0.95 for x in size]</span></pre><p id="86e6" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">在这里，创建正确的“隐藏”环境是一个关键的系统微调，需要一些额外的步骤。</p><h2 id="08b0" class="lu ka hu bd kb lv lw lx kf ly lz ma kj la mb mc kl le md me kn li mf mg kp mh dt translated">一些代码</h2><p id="bdcb" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我把我用来寻找超参数和测试神经网络部分的脚本分享给playground。</p><p id="fa69" class="pw-post-body-paragraph kr ks hu kt b ku ln iv kw kx lo iy kz la lp lc ld le lq lg lh li lr lk ll lm hn dt translated">感谢您的关注，欢迎提问，联系我，电话:<a class="ae lt" href="mailto:savsunenko.sasha@gmail.com" rel="noopener ugc nofollow" target="_blank">savsunenko.sasha@gmail.com</a></p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ng nh l"/></div></figure><h1 id="d6d9" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">参考书目</h1><div class="ni nj fm fo nk nl"><a rel="noopener follow" target="_blank" href="/emergent-future/simple-reinforcement-learning-with-tensorflow-part-0-q-learning-with-tables-and-neural-networks-d195264329d0"><div class="nm ab ej"><div class="nn ab no cl cj np"><h2 class="bd hv fv z el nq eo ep nr er et ht dt translated">使用Tensorflow的简单强化学习第0部分:使用表格和神经网络的Q学习</h2><div class="ns l"><h3 class="bd b fv z el nq eo ep nr er et ek translated">在我的强化学习系列教程中，我们将探索一系列的强化学习算法，称为…</h3></div><div class="nt l"><p class="bd b gc z el nq eo ep nr er et ek translated">medium.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz jt nl"/></div></div></a></div><div class="ni nj fm fo nk nl"><a href="https://towardsdatascience.com/solving-the-multi-armed-bandit-problem-b72de40db97c" rel="noopener follow" target="_blank"><div class="nm ab ej"><div class="nn ab no cl cj np"><h2 class="bd hv fv z el nq eo ep nr er et ht dt translated">解决多臂强盗问题</h2><div class="ns l"><h3 class="bd b fv z el nq eo ep nr er et ek translated">多臂土匪问题是一个经典的强化学习的例子，我们给了一个老虎机与n…</h3></div><div class="nt l"><p class="bd b gc z el nq eo ep nr er et ek translated">towardsdatascience.com</p></div></div><div class="nu l"><div class="oa l nw nx ny nu nz jt nl"/></div></div></a></div><div class="ni nj fm fo nk nl"><a href="https://www.datahubbs.com/multi_armed_bandits_reinforcement_learning_1/" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab ej"><div class="nn ab no cl cj np"><h2 class="bd hv fv z el nq eo ep nr er et ht dt translated">多臂强盗和强化学习1 -数据中心</h2><div class="ns l"><h3 class="bd b fv z el nq eo ep nr er et ek translated">多臂土匪问题是强化学习的一个很好的介绍。找出它们是关于什么的…</h3></div><div class="nt l"><p class="bd b gc z el nq eo ep nr er et ek translated">www.datahubbs.com</p></div></div><div class="nu l"><div class="ob l nw nx ny nu nz jt nl"/></div></div></a></div></div></div>    
</body>
</html>