<html>
<head>
<title>Managining Firebase database using Google Sheets via Google Apps Script.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Google Apps脚本使用Google Sheets管理Firebase数据库。</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/managining-firebase-database-using-google-sheets-via-google-apps-script-b87e5637b006?source=collection_archive---------7-----------------------#2018-07-03">https://medium.com/hackernoon/managining-firebase-database-using-google-sheets-via-google-apps-script-b87e5637b006?source=collection_archive---------7-----------------------#2018-07-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="3a28" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用Google Apps脚本对我来说是一次很好的学习。一个人可以自动化的事情，你可以用几行代码自动化某些功能的程度是惊人的。G Suite提供了各种工具来开始使用Google Apps脚本。</p><p id="e2f0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最近，我们推出了一个名为<a class="ae jp" href="http://paybackhub.com" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv"> Paybackhub </strong> </a>的返现平台，为购买他们喜爱的软件工具的客户提供专属返现。我们还在Paybackhub上推出了一个优惠页面，列出了软件工具等令人惊叹的优惠。处理这么多关于优惠和返现的数据绝非易事。每当我们有一家新公司加入时，在复杂的实时数据库中添加数据是很乏味的。此外，如果在更改值时出现错误，我们会付出很大代价。我们还希望有一种更简单的方法将公司安装到我们的平台上。易于编辑，易于管理和快速。当时我们研究了我们的选择，并决定在google sheets上添加新的更新，通过Google Apps脚本将自动更新必要的信息到Firebase上的实时数据库。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/4b4977f839ec62a51ad243d6917d05cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9RkXJnIx2SsxhY3aZS8nwg.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Paybackhub webpage</figcaption></figure><p id="16fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在Google sheets上处理数据既简单又舒适。我们添加公司名称，我们的平台提供的返现和其他必要的细节注意到进入表中。当所有这些细节都得到验证后，就会运行一个脚本，将所需的重要数据以结构化的格式更新到Firebase上的数据库中。数据是从这里获取的，所有的功能都是由我们的网站执行的。</p><h1 id="8003" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">使用Google sheets开始自动化Firebase。</h1><p id="e12e" class="pw-post-body-paragraph ir is hu it b iu le iw ix iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo hn dt translated">在进入代码之前，必须有一个谷歌账户。在<a class="ae jp" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> firebase </a>上创建一个应用。创建应用程序后，转到database选项卡，选择相对数据库。出于安全考虑，在数据库上启用了规则。这些规则允许用户和开发者自由地读/写数据库。在构建应用程序时，我们转到rules选项卡，并执行以下操作</p><pre class="jr js jt ju fq lj lk ll lm aw ln dt"><span id="983d" class="lo kh hu lk b fv lp lq l lr ls"><em class="lt">{<br/> “rules”: {<br/> “.read”: true,<br/> “.write”: true<br/> }<br/>}</em></span></pre><p id="37ba" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了测试，我们启用了读和写。这意味着任何有权访问数据库url的人都可以在其中读写数据。</p><p id="a4a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Apps Script是一种源自Javascript的语言。因此，Javascript的基础知识足以与应用程序Scipt相处得很好。</p><h2 id="3578" class="lo kh hu bd ki lu lv lw km lx ly lz kq jc ma mb ku jg mc md ky jk me mf lc mg dt translated">理解使用的方法</h2><ol class=""><li id="d28a" class="mh mi hu it b iu le iy lf jc mj jg mk jk ml jo mm mn mo mp dt translated"><strong class="it hv"> getDatabaseByUrl(url，optSecret) : </strong>给定firebase应用程序数据库的Url和一个密码(维护安全性)，该方法返回该url处的数据库。</li></ol><pre class="jr js jt ju fq lj lk ll lm aw ln dt"><span id="1440" class="lo kh hu lk b fv lp lq l lr ls">var url = "URL_OF_FIREBASE_APPLICATION";<br/>var optSecret = "SECRET_CODE";<br/>var database = FirebaseApp.getDatabaseByUrl(url, secret);</span><span id="f6ad" class="lo kh hu lk b fv mq lq l lr ls"><strong class="lk hv">//getData</strong><br/>Logger.log(database.getData("companies/offers")); //give a path </span><span id="4f69" class="lo kh hu lk b fv mq lq l lr ls"><strong class="lk hv">//pushData</strong><br/>var data = {"companyName" : "Paybackhub", "desc" : "A cashback platform"};<br/>var dataToPush = database.pushData("companies", data); //path, data<br/>Logger.log(dataToPush);</span><span id="1cfd" class="lo kh hu lk b fv mq lq l lr ls">//<strong class="lk hv">setData</strong><br/>var data = {"companyName" : "Paybackhub", "desc" : "A cashback platform"};<br/>var dataToSet = database.setData("companies/paybackhub/details", data);<br/>Logger.log(dataToSet); </span><span id="d07f" class="lo kh hu lk b fv mq lq l lr ls">//<strong class="lk hv">updateData</strong><br/>var data = {"desc" : "A cashback platform for software tools"};<br/>var dataToUpdate = database.updateData("companie<!-- -->s/paybackhub/details<!-- -->",data);<br/>Logger.log(dataToUpdate);</span><span id="27d6" class="lo kh hu lk b fv mq lq l lr ls">//<strong class="lk hv">removeData</strong><br/>var dataRemoved = database.removeData("companies/paybackhub");<br/>Logger.log(dataRemoved);</span></pre><p id="f272" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">2.<strong class="it hv"> getData(path，parameters) : </strong>该方法将获取路径中给定的所有数据。在上面的例子中，变量<em class="lt">数据库</em>保存了应用程序中所有数据库的值。<em class="lt"> getData </em>方法使用这个变量来遍历数据库，并从特定路径获取数据。</p><p id="531c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">3.<strong class="it hv"> pushData (path，Data，optQueryParameters) : </strong>生成一个新的子位置，将数据推送到那个路径(即生成的位置)。变量<em class="lt">数据</em>中的内容存储在新的子<em class="lt">公司中。</em></p><p id="0907" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">4.<strong class="it hv"> setData(path，Data，optQueryParameters) : </strong>该方法将数据写入作为参数发送的特定路径。变量<em class="lt">数据</em>中的内容存储在路径<em class="lt">公司/列表</em>中(即特定位置)</p><p id="fabf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">5.<strong class="it hv"> updateData(path，Data，optQueryParameters) </strong>:用于在不改变已有数据的情况下，更新特定路径的数据。这里<em class="lt">数据</em>代表需要被覆盖的孩子。</p><p id="9386" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">6.<strong class="it hv"> removeData(path，optQueryParameters) : </strong>该方法用于删除数据库中特定路径下的所有数据。在上面的代码中，<em class="lt"> companies/paybackhub </em>下的所有条目都将被删除。</p><h1 id="0667" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">将Firebase库添加到应用程序脚本</h1><p id="840d" class="pw-post-body-paragraph ir is hu it b iu le iw ix iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo hn dt translated">要使用上述函数，必须包括能够使用它们的库。在脚本编辑器中，点击<strong class="it hv">Resources&gt;Librairies</strong>并添加项目关键字“<strong class="it hv">myep 8 zeet 1 ylvdxs 7 uyg 9 pldocoke 7–2l</strong>”。点击<strong class="it hv">后选择</strong>，选择最新版本即可。</p><h1 id="9570" class="kg kh hu bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">谷歌工作表</h1><p id="9c1a" class="pw-post-body-paragraph ir is hu it b iu le iw ix iy lf ja jb jc lg je jf jg lh ji jj jk li jm jn jo hn dt translated">在google sheets中，填写需要推入这些行和列的所有数据。要了解更多关于使用应用程序脚本访问数据的信息，请阅读谷歌的这篇精彩的<a class="ae jp" href="https://developers.google.com/apps-script/reference/spreadsheet/" rel="noopener ugc nofollow" target="_blank">文档。</a></p><p id="3bec" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这帮助<a class="ae jp" href="http://paybackhub.com" rel="noopener ugc nofollow" target="_blank"> paybackhub </a>非常容易地管理数据库。关于公司的每日更新在一天中被多次归档。所以在Google Sheets上处理所有这些更新对我们帮助很大。只需按下一个按钮，所有这些变化都会更新到Firebase上，我们所有的顾客都可以通过我们的网站购物。</p><p id="2eee" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于这种定期手动更新，使用这种方法将是非常有益和有效的。更多关于如何处理Firebase和Google Sheets的信息，请点击这里。</p><p id="8742" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">希望这篇文章是有用的，并尝试一下。</p></div><div class="ab cl mr ms hc mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="hn ho hp hq hr"><p id="0d0d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于软件工具上的返现结账<a class="ae jp" href="http://paybackhub.com" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv">返现枢纽</strong> </a>。我们每周增加5个很棒的工具，有高达30%的返现。可以从paybackhub获得大约相当于3个月工资的返现。希望这对你有帮助:)</p><p id="8a32" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你对这篇文章和Paybackhub有任何反馈，请联系twitter。</p></div><div class="ab cl mr ms hc mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="hn ho hp hq hr"><p id="5ea3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在Twitter上关注pay back hub:【https://twitter.com/paybackhub T4】</p><p id="1434" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在twitter上联系我:<a class="ae jp" href="https://twitter.com/s_omeal" rel="noopener ugc nofollow" target="_blank"> Supriya S </a></p></div></div>    
</body>
</html>