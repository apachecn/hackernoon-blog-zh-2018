<html>
<head>
<title>PostgreSQL RDS Creation/Migration in AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS中的PostgreSQL RDS创建/迁移</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/postgresql-rds-creation-migration-in-aws-cbae2901d460?source=collection_archive---------22-----------------------#2018-07-05">https://medium.com/hackernoon/postgresql-rds-creation-migration-in-aws-cbae2901d460?source=collection_archive---------22-----------------------#2018-07-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="7e4a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">本文描述了在AWS中从现有数据库创建数据库的过程，我们将介绍将模式和数据从现有数据库迁移到新数据库的步骤。当需要为基础设施中的不同环境(系统测试、集成测试或性能测试)创建RDS实例时，或者在将数据库从一个版本迁移到另一个版本的过程中，您可能会遇到这种情况。由于大多数组织正在进入您构建您自己的模型阶段，如果我们知道一些简单的步骤来自行管理数据库更改，就不需要依赖DBA团队来处理每个更改请求。我之所以写这篇文章，是因为它可以节省一些时间，让我们更快地完成那些需要用必要的模式和数据来启动RDS实例的工作。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff jp"><img src="../Images/046ef4bf5d6f98aa8a840eb63c77b871.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*-ACGpP5uyGEo_QN5Onlasg.png"/></div></figure><p id="bff7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从上述角度来看，本页将向您展示如何使用实用工具psql和pgdump使用PostgreSQL RDS。</p><ol class=""><li id="3593" class="jx jy hu it b iu iv iy iz jc jz jg ka jk kb jo kc kd ke kf dt translated">【psql的设置路径&amp; pgdump </li></ol><p id="be2e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">psql和pgdump是PostgreSQL安装附带的实用工具。如果您已经安装了，可以在系统中的类似位置找到上述可执行文件，如下所示。</p><blockquote class="kg kh ki"><p id="ba93" class="ir is kj it b iu iv iw ix iy iz ja jb kk jd je jf kl jh ji jj km jl jm jn jo hn dt translated">/Library/PostgreSQL/9.6/bin</p></blockquote><p id="fb02" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">将该位置添加到现有路径中，如下所示。</p><blockquote class="kg kh ki"><p id="82e6" class="ir is kj it b iu iv iw ix iy iz ja jb kk jd je jf kl jh ji jj km jl jm jn jo hn dt translated">导出路径=/Library/PostgreSQL/9.6/bin/:$ PATH；</p></blockquote><p id="764b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> 2。从模式</strong>中提取DDL &amp; DML命令</p><p id="efb4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在执行下面给出的任何说明之前，请确保在RDS实例安全组中为特定IP范围启用了TCP的端口5432(Postgres的默认端口),该IP范围将允许从您的笔记本电脑访问RDS实例。这个检查是必需的，因为您将从您的机器上执行所有的create和insert语句。</p><p id="c8c9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下命令有助于根据RDS实例中可用的现有模式生成DDL脚本，其中包括旧数据库中存在的所有配置(如主键、外键约束)，这些配置将在生成的文件中可用。</p><blockquote class="kg kh ki"><p id="88e8" class="ir is kj it b iu iv iw ix iy iz ja jb kk jd je jf kl jh ji jj km jl jm jn jo hn dt translated">pg _ dump-h<aws instance="" name="">-p<port>-d<database name="">-U<username>-s-F p-n<schema name="">&gt;<give a="" file="" name=""/></schema></username></database></port></aws></p></blockquote><p id="6dff" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面的第二个命令通过提供适当的插入脚本，帮助从旧数据库生成数据转储。</p><blockquote class="kg kh ki"><p id="dfb9" class="ir is kj it b iu iv iw ix iy iz ja jb kk jd je jf kl jh ji jj km jl jm jn jo hn dt translated">pg _ dump-h<aws instance="" name="">-p<port>-d<database name="">-U<username>-a-F p-n<schema name="">———插页&gt;<give a="" file="" name=""/></schema></username></database></port></aws></p></blockquote><p id="a2df" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">执行插入脚本</strong></p><p id="924c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">每当您尝试从您的机器执行SQL脚本时，系统都会提示您输入密码。</p><blockquote class="kg kh ki"><p id="89d9" class="ir is kj it b iu iv iw ix iy iz ja jb kk jd je jf kl jh ji jj km jl jm jn jo hn dt translated">psql-f<sql script="">-h<aws db="" name="">-p<port>-d<database name="">-U<username/></database></port></aws></sql></p></blockquote><p id="55fc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦SQL脚本执行完成，您就可以使用您的数据库了。</p><p id="a8d7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您只有一个超级用户，您可以使用“登录/组角色”下的pgadmin工具添加新用户，开始向您的数据库添加具有有限权限的新用户，并在您的应用程序中使用它。</p><p id="5310" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上述方法可以在数据库从一个版本迁移到另一个版本(比如从9.6到9.8)的过程中使用。这些生成的脚本可能需要的唯一更改是，如果新版本不支持任何数据类型，则在新版本的DB上运行它之前，需要进行额外的检查以使其工作。</p></div></div>    
</body>
</html>