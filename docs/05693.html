<html>
<head>
<title>Setting up your GPU machine to be Deep Learning ready</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设置您的GPU机器为深度学习做好准备</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/setting-up-your-gpu-machine-to-be-deep-learning-ready-96b61a7df278?source=collection_archive---------1-----------------------#2018-07-07">https://medium.com/hackernoon/setting-up-your-gpu-machine-to-be-deep-learning-ready-96b61a7df278?source=collection_archive---------1-----------------------#2018-07-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/70be6d7616c17789ad09dd492ce85b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CK_sSiW64uM21k5k.jpg"/></div></div></figure><p id="db37" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你好，</p><p id="5c4f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇教程是我上一篇文章的松散延续，一定要看一看。</p><div class="ka kb fm fo kc kd"><a href="https://hackernoon.com/deep-learning-with-google-cloud-platform-66ada9d7d029" rel="noopener  ugc nofollow" target="_blank"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hv fv z el ki eo ep kj er et ht dt translated">借助谷歌云平台实现GPU支持的深度学习</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">我知道，高端深度学习GPU支持的系统非常昂贵，而且不容易获得，除非你…</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">hackernoon.com</p></div></div><div class="km l"><div class="kn l ko kp kq km kr ja kd"/></div></div></a></div><p id="80e0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是在假设你有一台带GPU的裸机的情况下编写的，如果它是部分预设置的，请随意跳过一些部分，我还假设你有一张NVIDIA卡，我们将在本教程中只介绍TensorFlow的设置，这是最受欢迎的深度学习框架(向Google致敬！)</p><h1 id="0a8d" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated"><strong class="ak">安装CUDA驱动程序</strong></h1><p id="7b20" class="pw-post-body-paragraph jc jd hu je b jf lq jh ji jj lr jl jm jn ls jp jq jr lt jt ju jv lu jx jy jz hn dt translated">CUDA是NVIDIA的并行计算平台，是TensorFlow的基本前提。但是后面我们会明白，其实反过来开始更好，所以后面再回到这个部分。</p><h1 id="6870" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">安装TensorFlow</h1><p id="ad2e" class="pw-post-body-paragraph jc jd hu je b jf lq jh ji jj lr jl jm jn ls jp jq jr lt jt ju jv lu jx jy jz hn dt translated">启动您的终端(或者SSH，如果是远程机器)。找到您的特定应用所需的TensorFlow版本(如果有)，或者如果没有这种限制，我们就使用我目前使用的TensorFlow 1.8.0。</p><blockquote class="lv lw lx"><p id="7fe3" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">pip安装tensorflow-gpu==1.8.0</p></blockquote><p id="cabd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让它安装。现在转到Python shell，</p><blockquote class="lv lw lx"><p id="804f" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">大蟒</p></blockquote><p id="a3a6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在Python shell中，键入:</p><blockquote class="lv lw lx"><p id="1fc2" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">将张量流作为tf导入</p></blockquote><p id="ab02" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">此时，由于我们没有安装CUDA，您应该会看到类似如下的错误:</p><blockquote class="lv lw lx"><p id="75f2" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">ImportError: libcublas.so.9.0:无法打开共享对象文件:没有这样的文件或目录</p></blockquote><p id="f2a2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">9.0和文件名可能是其他名称，具体取决于您选择的TensorFlow版本。但是反其道而行之的全部意义在于知道我们需要哪个版本的CUDA，在本例中是9.0。官方文档对TF版和CUDA版的对应关系并不明确，所以我一直觉得这种逆向工程的方法比较好。</p><p id="6ced" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们回到安装CUDA。</p><p id="3705" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用</p><blockquote class="lv lw lx"><p id="9a82" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">退出()</p></blockquote><p id="d8da" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">退出Python shell。</p><h1 id="5d81" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">安装CUDA驱动程序(这次我们真的会做，我保证)</h1><p id="0aaf" class="pw-post-body-paragraph jc jd hu je b jf lq jh ji jj lr jl jm jn ls jp jq jr lt jt ju jv lu jx jy jz hn dt translated">所以导航到https://developer.nvidia.com/cuda-toolkit-archive的<a class="ae mc" href="https://developer.nvidia.com/cuda-toolkit-archive" rel="noopener ugc nofollow" target="_blank"/>。选择您刚刚在上面确定的版本。</p><p id="6e3c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Linux-&gt;x86_64-&gt;Ubuntu-&gt;16.04(或17.04)-&gt;deb(网络)</p><p id="a8c8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将deb下载到您的机器上，并按照NVIDIA页面上的说明安装CUDA。一旦完成，让我们检查是否一切顺利。</p><p id="3f80" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">返回，重新打开Python shell，</p><blockquote class="lv lw lx"><p id="d820" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">将张量流作为tf导入</p></blockquote><p id="fcd8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以我们还没有完成，您现在应该会看到一个稍微不同的错误消息。(如果您看到与之前相同的问题，请参考下面的“故障排除”)</p><blockquote class="lv lw lx"><p id="1a1a" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">ImportError: libcudnn.so.7:无法打开共享对象文件:没有这样的文件或目录</p></blockquote><p id="1200" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们还需要一个名为cuDNN的NVIDIA库，用于深度神经网络的GPU加速。再次注意我们需要的cuDNN版本，在本例中是7.0。</p><p id="187d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">导航到<a class="ae mc" href="https://developer.nvidia.com/cudnn" rel="noopener ugc nofollow" target="_blank">https://developer.nvidia.com/cudnn</a>并注册一个账户(免费)。在您创建帐户后，登录并进入https://developer.nvidia.com/rdp/cudnn-archive<a class="ae mc" href="https://developer.nvidia.com/rdp/cudnn-archive" rel="noopener ugc nofollow" target="_blank">的</a></p><p id="a518" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">选择所需的cuDNN版本，并确保您选择的CUDA版本。在这种情况下，我们需要，</p><p id="a8db" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ly">为CUDA 9.0 </em>下载cud nn v 7 . 0 . 5(2017年12月5日)</p><p id="63f9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在下拉选择中，</p><p id="d71c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ly">cud nn v 7 . 0 . 5 Linux库</em></p><p id="8c33" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">tgz文件将开始下载，移动到您的机器，提取它使用</p><blockquote class="lv lw lx"><p id="c949" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">tar -xzvf <cudnn_tar_filename/></p></blockquote><p id="e076" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将提取一个文件夹“cuda ”, CD到该目录，并执行这两个命令，</p><pre class="md me mf mg fq mh mi mj mk aw ml dt"><span id="fe8d" class="mm kt hu mi b fv mn mo l mp mq">sudo cp lib64/* /usr/local/cuda/lib64/<br/>sudo cp include/cudnn.h /usr/local/cuda/include/</span></pre><p id="f687" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们完成了(希望如此)。再次启动Python shell，您就知道该怎么做了。</p><p id="755d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果这次它没有抛出任何错误，我们是好的。</p><p id="1231" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为了确保TensorFlow能够检测到我们的GPU，请在同一个Python shell上运行这个命令</p><blockquote class="lv lw lx"><p id="70ad" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">tf.test.gpu_device_name()</p></blockquote><p id="c81f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它应该打印出所有可用的GPU。这在TF的旧版本上可能不起作用，如果是这样，请在您的终端上尝试这个:</p><blockquote class="lv lw lx"><p id="9373" class="jc jd ly je b jf jg jh ji jj jk jl jm lz jo jp jq ma js jt ju mb jw jx jy jz hn dt translated">英伟达-smi</p></blockquote><h1 id="3f94" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">解决纷争</h1><p id="c97b" class="pw-post-body-paragraph jc jd hu je b jf lq jh ji jj lr jl jm jn ls jp jq jr lt jt ju jv lu jx jy jz hn dt translated">如果你做的一切都是正确的，即使<em class="ly"> nvidia-smi </em>工作，TensorFlow仍然抛出相同的错误，这可能是环境路径变量的问题。执行以下操作来修复:</p><pre class="md me mf mg fq mh mi mj mk aw ml dt"><span id="e9ce" class="mm kt hu mi b fv mn mo l mp mq">export LD_LIBRARY_PATH=/usr/local/cuda/lib64:${LD_LIBRARY_PATH}<br/>export PATH=/usr/local/cuda/lib64:${PATH}</span></pre><p id="3646" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果甚至<em class="ly"> nvidia-smi </em>命令都不起作用，说明CUDA安装不正确，如果您遗漏了什么，请重新开始。</p><p id="a54d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我知道任何问题，建议或批评。</p><p id="e1d5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">干杯。</p><p id="6a61" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ly"> Saurabh是印度瓦朗加尔国家理工学院计算机科学专业的本科生，目前是班加罗尔印度科学学院的研究实习生。</em></p></div></div>    
</body>
</html>