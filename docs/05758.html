<html>
<head>
<title>Build and Deploy a Serverless Node.js App powered by Cosmic JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建并部署一个由Cosmic JS支持的无服务器Node.js应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-and-deploy-a-serverless-node-js-app-powered-by-cosmic-js-21b45eaea32e?source=collection_archive---------35-----------------------#2018-07-09">https://medium.com/hackernoon/build-and-deploy-a-serverless-node-js-app-powered-by-cosmic-js-21b45eaea32e?source=collection_archive---------35-----------------------#2018-07-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/772453e11a8763ad3de078cbba2e3ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OP0bpWW4ZC4-intY"/></div></div></figure><p id="f0b0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">无服务器应用程序开发越来越受欢迎，这在很大程度上是因为“构建应用程序，而不是基础设施”这一吸引人的主张。这种构建应用程序的方式提供了许多好处，包括不必管理服务器基础架构、无限的可伸缩性以及不必为空闲的服务器时间付费，只需在使用您的服务时付费。</p><p id="f349" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ka" href="https://serverless.com/company/team/" rel="noopener ugc nofollow" target="_blank">无服务器</a>平台进一步将构建无服务器应用抽象为愉快的开发人员体验，帮助您快速启动并运行基于云功能的应用。</p><p id="31fc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ka" href="https://cosmicjs.com" rel="noopener ugc nofollow" target="_blank"> Cosmic JS </a>为团队提供了一个CMS API来管理任何新的或现有的应用程序的内容。<a class="ae ka" href="https://github.com/cosmicjs/serverless-starter" rel="noopener ugc nofollow" target="_blank"> Cosmic JS无服务器启动应用</a>让你启动并运行一个连接到Cosmic JS CMS的无服务器应用。</p><p id="27f5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在本教程中，我将向你展示如何在几分钟内开始使用<a class="ae ka" href="https://github.com/cosmicjs/serverless-starter" rel="noopener ugc nofollow" target="_blank">宇宙JS无服务器启动应用</a>。另外，我将向您展示将任何Node.js应用程序转换为无限可扩展的Node.js无服务器应用程序的步骤。让我们开始吧。</p><h1 id="16f1" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">TL；速度三角形定位法(dead reckoning)</h1><p id="763e" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><a class="ae ka" href="https://github.com/cosmicjs/serverless-starter" rel="noopener ugc nofollow" target="_blank">在GitHub上查看宇宙JS无服务器启动器</a></p><h1 id="82b4" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">安装无服务器启动器</h1><p id="5b00" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">要安装Cosmic JS无服务器启动程序，请运行以下命令:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="d35b" class="ln kc hu lj b fv lo lp l lq lr">npm i -g cosmic-cli<br/>cosmic login<br/>cosmic init serverless-starter</span></pre><p id="ce60" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这些命令执行以下操作:<br/> 1 .安装<a class="ae ka" href="https://www.npmjs.com/package/cosmic-cli" rel="noopener ugc nofollow" target="_blank">宇宙CLI</a>2。登录你的<a class="ae ka" href="https://cosmicjs.com/" rel="noopener ugc nofollow" target="_blank">宇宙JS账户</a>(你可能需要创建一个新的桶，如果是这样，它会带你完成这个过程😀)<br/> 3。下载<a class="ae ka" href="https://github.com/cosmicjs/serverless-starter" rel="noopener ugc nofollow" target="_blank">无服务器启动器</a>并将演示内容导入您选择的存储桶。</p><p id="f5f5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下载完成后，系统会提示您使用以下命令启动应用程序:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="8a05" class="ln kc hu lj b fv lo lp l lq lr">cd serverless-starter<br/>cosmic develop</span></pre><p id="c370" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您的应用程序现在应该运行在<a class="ae ka" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a></p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ls"><img src="../Images/8b4f2a33b87671c69bf8a586c3e6bf94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZRdebXi_LUIQH5ZQ.png"/></div></div></figure><h1 id="9ad2" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">准备起飞</h1><p id="c667" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">既然我们已经在本地运行了我们的应用程序，让我们准备好将它发布到AWS cloud。首先，我们需要连接我们的AWS凭证。为了在你的AWS账户上找到这些，<a class="ae ka" href="https://serverless.com/framework/docs/providers/aws/guide/credentials/" rel="noopener ugc nofollow" target="_blank"> Serverless在他们的网站</a>上有一个很棒的展示。</p><p id="27b2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">检索到AWS密钥后，运行以下命令:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="f329" class="ln kc hu lj b fv lo lp l lq lr">export AWS_ACCESS_KEY_ID=your-aws-key-id<br/>export AWS_SECRET_ACCESS_KEY=your-aws-secret-key</span></pre><p id="561c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，我们已经准备好向AWS发布我们的无服务器启动器。运行以下命令登录到无服务器服务并部署我们的应用程序:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="2a82" class="ln kc hu lj b fv lo lp l lq lr">npm i -g serverless<br/>serverless login<br/>COSMIC_BUCKET=your-bucket-slug serverless deploy</span></pre><p id="8121" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">无服务器部署命令为我们完成了所有繁重的工作。它使用我们的AWS帐户在幕后执行一些魔法，然后一旦我们的应用程序可用，它将提供端点来找到部署的应用程序。添加环境变量<code class="eh lt lu lv lj b">COSMIC_BUCKET</code>，通过Cosmic JS API将我们部署的应用程序连接到我们的Cosmic JS Bucket。这使我们能够从<a class="ae ka" href="https://cosmicjs.com/cms-api" rel="noopener ugc nofollow" target="_blank">宇宙JS管理仪表板</a>管理我们新部署的无服务器应用程序的内容。</p><figure class="le lf lg lh fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/8890c205cd5703739916572557e349c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*W3A2P3_OLCAiec7A.png"/></div></div></figure><p id="8943" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从上面的输出中，您可以看到我们可用的<strong class="je hv">端点</strong>，这里部署了我们的无服务器应用程序。</p><h1 id="2093" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">使任何Node.js应用程序无服务器就绪</h1><p id="4021" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">所以我们运行了几个命令，把Cosmic JS无服务器启动应用推送到AWS……酷。但是，让我们更深入一点，看看我们如何转换<a class="ae ka" href="https://github.com/cosmicjs/node-starter" rel="noopener ugc nofollow" target="_blank"> Node Starter应用程序</a>，以及我们如何将大多数any Node.js应用程序转换为无服务器应用程序。</p><p id="6be7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">编辑serverless.yml </strong> <br/>要将<a class="ae ka" href="https://github.com/cosmicjs/node-starter" rel="noopener ugc nofollow" target="_blank">节点启动器</a>转换为无服务器应用程序，我们必须创建一个<a class="ae ka" href="https://github.com/cosmicjs/serverless-starter/blob/master/serverless.yml" rel="noopener ugc nofollow" target="_blank"> serverless.yml </a>文件，并设置配置以处理动态路由。这是在功能&gt;应用&gt;事件区域中完成的，以指示动态http事件。看起来是这样的:</p><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="8a41" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">编辑app.js </strong> <br/>接下来我们需要编辑app的入口点，<a class="ae ka" href="https://github.com/cosmicjs/serverless-starter/blob/master/app.js" rel="noopener ugc nofollow" target="_blank"> app.js文件</a>以导出主处理函数。我们还包含了<a class="ae ka" href="https://www.npmjs.com/package/serverless-http" rel="noopener ugc nofollow" target="_blank">无服务器-http节点模块</a>来包装我们的Express应用程序以供无服务器使用。下面是转换为无服务器的app.js文件:</p><figure class="le lf lg lh fq iv"><div class="bz el l di"><div class="lx ly l"/></div></figure><h1 id="561e" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">最后</h1><p id="6722" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">通过一些编辑，您可以快速将Node.js应用程序转换为无服务器应用程序。<a class="ae ka" href="https://serverless.com/" rel="noopener ugc nofollow" target="_blank">无服务器</a>平台将AWS帐户配置的复杂性抽象化，为您提供愉快的开发体验。添加Cosmic JS支持的内容，您就有了一个无限可扩展的无服务器应用程序，其内容通过Cosmic JS API进行管理。无需管理服务器，无需维护CMS。构建应用而非基础设施才是未来！</p><p id="316e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你对用Cosmic JS构建无服务器应用有任何意见或问题，<a class="ae ka" href="https://twitter.com/cosmic_js" rel="noopener ugc nofollow" target="_blank">在Twitter上联系我们</a>和<a class="ae ka" href="https://cosmicjs.com/community" rel="noopener ugc nofollow" target="_blank">在Slack上加入对话</a>。</p></div></div>    
</body>
</html>