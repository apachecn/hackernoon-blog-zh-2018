<html>
<head>
<title>Creating an Instagram Bot With Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Node.js创建Instagram Bot</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-create-an-instagram-bot-with-node-js-a289185a7d6f?source=collection_archive---------0-----------------------#2018-07-10">https://medium.com/hackernoon/how-to-create-an-instagram-bot-with-node-js-a289185a7d6f?source=collection_archive---------0-----------------------#2018-07-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/cb3781258af046d8cef9b5efc01f296e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fpjROQBti3jtZUmoScYb2w.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/photos/7ICU-gxJ1zY?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Elijah O’Donell</a> on <a class="ae jg" href="https://unsplash.com/search/photos/instagram?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0952" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">当Instagram的月活跃用户达到10亿的消息传出时，我忍不住创建了一个自己的账户，试图为自己赢得一些粉丝。</p><p id="f790" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然而，鉴于我对它的浓厚兴趣，我希望借此机会测试我所学内容的一些现实应用，并使用机器人来这样做(即获得追随者)，而不是投入所有乏味的工作。</p><p id="c112" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我做的第一件事是检查一个<a class="ae jg" href="https://www.instagram.com/developer/" rel="noopener ugc nofollow" target="_blank"> Instagram API </a>。然而，无济于事，因为它被证明是一个无用的，过时的软件。</p><p id="d861" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">尽管脸书最近发布了<a class="ae jg" href="https://developers.facebook.com/docs/instagram-api/" rel="noopener ugc nofollow" target="_blank">新的Instagram API </a>，但他们只支持商业客户。</p><p id="65f8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">但是，嘿，这没问题——我想——我可以自己创造一个。</p><p id="1f9e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这正是我们今天要学的。</p><p id="477a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">仔细想想，Instagram的网站本身就是平台的API。我们所需要做的就是弄清楚如何与它远程交互，而不是像普通用户那样手动操作。</p><blockquote class="kf"><p id="ea6e" class="kg kh hu bd ki kj kk kl km kn ko ke ek translated">有志者事竟成。</p></blockquote><p id="f5a1" class="pw-post-body-paragraph jh ji hu jj b jk kq jm jn jo kr jq jr js ks ju jv jw kt jy jz ka ku kc kd ke hn dt translated">这就是操纵木偶的人进入画面的地方。该库允许我们创建一个无头的Google Chrome / Chromium实例，并通过使用DevTools协议来控制它。</p><h1 id="10af" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">设置项目</h1><p id="ff28" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">您可以继续复制<a class="ae jg" href="https://github.com/maciejcieslar/instagrambot" rel="noopener ugc nofollow" target="_blank">存储库</a>。</p><pre class="ly lz ma mb fq mc md me mf aw mg dt"><span id="0f8a" class="mh kw hu md b fv mi mj l mk ml">git clone <a class="ae jg" href="https://github.com/maciejcieslar/instagrambot.git" rel="noopener ugc nofollow" target="_blank">https://github.com/maciejcieslar/instagrambot.git</a></span></pre><p id="5e95" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们的结构看起来像这样:</p><pre class="ly lz ma mb fq mc md me mf aw mg dt"><span id="289f" class="mh kw hu md b fv mi mj l mk ml">|  -- instagrambot/<br/>|  |  -- .env<br/>|  |  -- .eslintrc.js<br/>|  |  -- .gitignore<br/>|  |  -- README.md<br/>|  |  -- package-lock.json<br/>|  |  -- package.json<br/>|  |  -- src/<br/>|  |  |  -- common/<br/>|  |  |  |  -- browser/<br/>|  |  |  |  |  -- api/<br/>|  |  |  |  |  |  -- authenticate.ts<br/>|  |  |  |  |  |  -- comment-post.ts<br/>|  |  |  |  |  |  -- find-posts.ts<br/>|  |  |  |  |  |  -- follow-post.ts<br/>|  |  |  |  |  |  -- get-following.ts<br/>|  |  |  |  |  |  -- get-post-info.ts<br/>|  |  |  |  |  |  -- get-user-info.ts<br/>|  |  |  |  |  |  -- index.ts<br/>|  |  |  |  |  |  -- like-post.ts<br/>|  |  |  |  |  |  -- unfollow-user.ts<br/>|  |  |  |  |  -- index.ts<br/>|  |  |  |  -- interfaces/<br/>|  |  |  |  |  -- index.ts<br/>|  |  |  |  -- scheduler/<br/>|  |  |  |  |  -- index.ts<br/>|  |  |  |  |  -- jobs.ts<br/>|  |  |  |  -- scraper/<br/>|  |  |  |  |  -- scraper.js<br/>|  |  |  |  -- utils/<br/>|  |  |  |  |  -- index.ts<br/>|  |  |  |  -- wit/<br/>|  |  |  |  |  -- index.ts<br/>|  |  |  -- config.ts<br/>|  |  |  -- index.ts<br/>|  |  -- tsconfig.json<br/>|  |  -- tslint.json</span></pre><h1 id="313b" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">浏览器界面</h1><p id="c8d7" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">至此，让我们创建我们的浏览器界面，我们将使用它从Puppeteer获得渲染页面。</p><p id="a3af" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们的getPage函数为我们创建了一个浏览器的页面，转到提供的URL并注入我们的scraper(后面会提到)。此外，它等待我们的回调返回一个承诺，解析它并关闭页面。</p><p id="caf8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/index.ts" rel="noopener ugc nofollow" target="_blank">src/common/browser/index . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="994f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">非常清楚地说，木偶师是一个独立的浏览器界面，我们只是抽象了一些会不断重复的代码。</p><p id="3df4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们不必担心我们可能不小心打开的页面导致的内存泄漏。</p><h1 id="e09c" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">刮刀</h1><p id="2dbe" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">对于任何与网络抓取相关的事情来说，另一件有帮助的事情是创建你自己的抓取助手。当我们进行更高级的刮削时，我们的刮刀会派上用场。</p><p id="4736" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先，我们定义一些助手，主要用于设置<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Howto/Use_data_attributes" rel="noopener ugc nofollow" target="_blank">数据属性</a>。除此之外，我们还有这个元素类，它是对普通HTMLElement的抽象。此外，还有一个find函数，它为我们提供了一种对开发人员更友好的查询元素的方式。</p><p id="293b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/scraper/scraper.js" rel="noopener ugc nofollow" target="_blank">src/common/scraper/scraper . js</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><h1 id="052f" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">证明</h1><p id="8682" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">最后，我们可以创建我们的第一个实际上与Instagram相关的功能。当我们第一次打开浏览器时，我们需要验证我们的用户。</p><figure class="ly lz ma mb fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mo"><img src="../Images/e0262118bd687f20f9fa0a93d58c22af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jxqJXESVyePwdR5pNad23w.png"/></div></div></figure><p id="5c71" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先，我们等待页面打开，然后输入在<a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/config.ts" rel="noopener ugc nofollow" target="_blank"> config.ts </a>中提供的凭证。每个字符之间有100毫秒的延迟。然后我们使用<em class="mp">登录</em>按钮，如果它存在，我们点击它。</p><p id="923a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/authenticate.ts" rel="noopener ugc nofollow" target="_blank">src/common/browser/API/authenticate . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="75dd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你想看到奇迹发生，在木偶师的启动选项中设置headless为false。它会打开一个浏览器，跟踪我们的机器人的每一个动作。</p><figure class="ly lz ma mb fq iv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/f444b8c4e7c83b5ccd4372256a542ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/1*DdqNd3ClUG7lYXoqfKJo2A.gif"/></div></figure><p id="bb83" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在我们登录了，Instagram会自动在我们的浏览器中设置cookies，所以我们不必担心必须再次登录。</p><p id="0156" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以关闭页面(我们的界面会处理它)，然后继续创建第一个函数来查找带有#hashtag的帖子。</p><p id="17f9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Instagram上带有#标签的最新帖子的网址是<a class="ae jg" href="https://www.instagram.com/explore/tags/follow4follow" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/explore/tags/follow4follow</a>。</p><p id="d350" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">前9个帖子总是<em class="mp">热门帖子</em>，这意味着他们可能永远不会回复我们的关注或喜欢，因为他们有成千上万个帖子。理想情况下，我们应该跳过它们，只获取最近的。</p><p id="aaf2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">当我们向下滚动时，会加载更多的帖子。在一次滚动中会出现12个帖子，所以我们必须计算我们要滚动多少次才能得到预期的数目。</p><p id="ed43" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在第一次装载时，有9个<em class="mp">顶部</em>和12个<em class="mp">普通</em>立柱。我们总共有21个。如果我们想找到36篇文章并省略前9篇，我们必须减去前12篇，然后将剩下的除以12，这样我们就知道我们需要滚动多少次。</p><p id="056b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">36(总数)— 12(第一个)= 24(遗漏的员额)</p><p id="2246" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">24 / 12 = 2(我们需要滚动的时间)</p><p id="ff0a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">此外，我们将添加一个滚动到结果，因为如果一些东西花了太长时间来渲染，这将是我们的安全网。</p><p id="7bc9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/find-posts.ts" rel="noopener ugc nofollow" target="_blank">src/common/browser/API/find-posts . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="aae3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以遍历返回的URL，并对每个URL执行一组给定的操作。</p><p id="7471" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">事情是这样的，除了帖子的网址，我们对它一无所知，但是我们可以通过抓取找到所有必要的信息。</p><h1 id="20b1" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">获取帖子的信息</h1><figure class="ly lz ma mb fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mr"><img src="../Images/f176aec90b7ec45cf597d763f7b6fe58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWP4qutoi-AhNxNw3ptp5w.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">An Instagram post example</figcaption></figure><p id="90c3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">正如我们在上面看到的，网站上有很多关于这篇文章的有用信息，例如:</p><ul class=""><li id="e8bf" class="ms mt hu jj b jk jl jo jp js mu jw mv ka mw ke mx my mz na dt translated">作者被跟踪了吗？</li><li id="877e" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">跟随按钮选择器</li><li id="666b" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">帖子有人喜欢吗？</li><li id="89e3" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">相似按钮选择器</li><li id="43de" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">作者的用户名</li><li id="b6e6" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">描述和注释</li><li id="fd73" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">注释选择器</li><li id="7c72" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">喜欢的数量</li></ul><p id="fda8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">但是在我们继续之前…</p><h1 id="53cb" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">为我们的评论添加NLP</h1><p id="ebfa" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">有一件事我们应该考虑，那就是<em class="mp">这个职位的目的是什么？</em>。是为了炫耀某人的新手表，还是为了悼念逝去的亲人？</p><p id="c71a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">理想情况下，我们想知道帖子是关于什么的。我们可以这样做:</p><p id="c39b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://wit.ai/" rel="noopener ugc nofollow" target="_blank"> Wit.ai </a>是一项来自脸书的服务，它让我们创建一个应用程序，并教它理解句子。</p><p id="2f86" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这就是NLP的由来，它代表自然语言处理。例如，如果你想制作一个聊天机器人，它也包含在Messenger API中。</p><p id="2cd8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">虽然这可能需要一些时间，但我们可以教我们的应用程序理解帖子的描述，并给我们提供见解。</p><p id="3399" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这很简单，真的，我们所要做的就是告诉它在一个句子中寻找什么。在我们的例子中，句子将是一个帖子的描述，我们将通过<a class="ae jg" href="https://github.com/wit-ai/node-wit" rel="noopener ugc nofollow" target="_blank"> node-wit </a>库发送。</p><p id="9fd7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先，你需要在<a class="ae jg" href="https://wit.ai/" rel="noopener ugc nofollow" target="_blank"> wit.ai </a>上创建一个账户。您可以使用您的GitHub帐户登录。</p><p id="2fe3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然后你要么自己创建app，要么用别人的app。如果你想用我训练过的app，这里<a class="ae jg" href="https://wit.ai/primosdace_B2MY2/instao/entities" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="3d60" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们的应用程序接收一条消息，并返回它是happy_description还是sad_description以及对它的确信程度。</p><p id="73de" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">还有一个<a class="ae jg" href="https://www.npmjs.com/package/node-emoji" rel="noopener ugc nofollow" target="_blank">表情库</a>让我们的评论更生动。</p><p id="6f04" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在，让我们将令牌放入<a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/config.ts" rel="noopener ugc nofollow" target="_blank"> config.ts </a>中，并创建一个小助手，用于将消息转换为意图，并基于所提供的意图生成注释。</p><p id="05bd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/wit/index.ts" rel="noopener ugc nofollow" target="_blank"> src/common/wit/index.ts </a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="1fed" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">虽然代码已经准备好，我们可以将表情符号添加到我们的评论中，<a class="ae jg" href="https://github.com/GoogleChrome/puppeteer/issues/1096" rel="noopener ugc nofollow" target="_blank">木偶师最近在输入它们时遇到了一些问题</a>。一旦问题得到解决，只需取消注释就可以了。</p><p id="3ae0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在我们可以获得文章信息及其意图，使用我们之前在网站上找到的选择器，我们可以获得保存数据的元素。</p><p id="d168" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/get-post-info.ts" rel="noopener ugc nofollow" target="_blank">src/common/browser/API/get-post-info . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><h1 id="f75e" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">获取用户信息</h1><p id="0b26" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">我们只能从一个帖子中获取这么多。有时我们会对用户的个人资料感兴趣。</p><figure class="ly lz ma mb fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ng"><img src="../Images/cab9e024c28a78d3c9a363738bad579f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JCvGyIjpnr9GTcBnjXIUYw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">An Instagram profile example</figcaption></figure><p id="8186" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以收集到许多有用的信息，例如:</p><ul class=""><li id="f238" class="ms mt hu jj b jk jl jo jp js mu jw mv ka mw ke mx my mz na dt translated">职位的数量</li><li id="fd5e" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">追随者的数量</li><li id="ed93" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">以下的数字</li><li id="1632" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">有没有跟账？</li><li id="6626" class="ms mt hu jj b jk nb jo nc js nd jw ne ka nf ke mx my mz na dt translated">Bio(描述)，但是因为这对我们没有用，所以我们不打算废弃它。</li></ul><p id="7263" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/get-user-info.ts" rel="noopener ugc nofollow" target="_blank">src/common/browser/API/get-user-info . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><h1 id="122b" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">发布操作</h1><p id="633f" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">现在，我们需要实现<a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/like-post.ts" rel="noopener ugc nofollow" target="_blank"> like-post.ts </a>。</p><p id="e719" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们只需检查帖子是否已经有人喜欢了。如果没有，我们选择like选择器并点击它。</p><p id="ec39" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/like-post.ts" rel="noopener ugc nofollow" target="_blank">src/common/browser/API/like-post . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="7958" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于<a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/follow-post.ts" rel="noopener ugc nofollow" target="_blank">跟帖</a>也是如此。</p><p id="c341" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/follow-post.ts" rel="noopener ugc nofollow" target="_blank">src/common/browser/API/follow-post . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="d747" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">使用<a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/comment-post.ts" rel="noopener ugc nofollow" target="_blank"> comment-post.ts </a>我们在文本区输入评论并按回车键。</p><p id="083b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/comment-post.ts" rel="noopener ugc nofollow" target="_blank">src/common/browser/API/comment-post . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><h1 id="c569" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">用户操作</h1><p id="fb3f" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">我们的机器人还必须能够取消关注人，因为否则它可能会超过7500关注限制。</p><p id="17c6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先，我们需要获得我们正在跟踪的人的URL。</p><p id="f96b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们点击个人资料中后的<em class="mp">按钮。</em></p><p id="d1c5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们跟踪的最后20个用户应该会显示一个列表。然后，我们可以对每个URL执行<a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/unfollow-user.ts" rel="noopener ugc nofollow" target="_blank"> unfollow-user.ts </a>。</p><p id="5d09" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/get-following.ts" rel="noopener ugc nofollow" target="_blank">src/common/浏览器/api/get-following.ts </a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="d757" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在我们有了URL，我们只需一次取消关注一个用户。我们单击“取消关注”按钮，然后单击确认对话框。</p><p id="baf2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/browser/api/unfollow-user.ts" rel="noopener ugc nofollow" target="_blank">src/common/browser/API/un follow-user . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><h1 id="6332" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">调度程序</h1><p id="51d7" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">现在一切都准备好了，我们必须考虑我们的机器人将如何工作。</p><p id="0433" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">显然，它不能只是无意识地一直跟着人，因为，你可能已经猜到了，Instagram会很快禁止他。</p><p id="3f08" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">根据我从<a class="ae jg" href="https://www.androidtipster.com/instagram-limits/" rel="noopener ugc nofollow" target="_blank">读到的</a>和在我自己的测试中看到的，有不同的限制，取决于账户的大小和年龄。</p><p id="352b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们现在安全地玩它。不过，不要担心，随着帐户的增长，限制会进一步扩大。</p><p id="459a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以创建一个简单的调度程序，它将每小时执行一次注册的作业，假设该小时在它们的预期时间范围内。</p><p id="e43f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/scheduler/index.ts" rel="noopener ugc nofollow" target="_blank">src/common/scheduler/index . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="5daa" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/common/scheduler/jobs.ts" rel="noopener ugc nofollow" target="_blank">src/common/scheduler/jobs . ts</a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="7c26" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">你可能已经注意到了，我们使用了很多来自配置的变量。有些值是我们用proccess.env提供的，这意味着它们是敏感的，我们应该将它们包含在。环境文件。其余的可以手动更改。</p><p id="611f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/config.ts" rel="noopener ugc nofollow" target="_blank"> src/config.ts </a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="815b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们用一个普通用户会活跃的小时范围来注册我们的作业，剩下的唯一事情就是运行应用程序。</p><h1 id="def2" class="kv kw hu bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">放弃</h1><p id="1f7f" class="pw-post-body-paragraph jh ji hu jj b jk lt jm jn jo lu jq jr js lv ju jv jw lw jy jz ka lx kc kd ke hn dt translated">由于Instagram的<a class="ae jg" href="http://instagram.com/robots.txt" rel="noopener ugc nofollow" target="_blank"> robots.txt </a>政策，这样的应用是不允许运行的。这个帖子仅仅是为了教育目的。</p><p id="093a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/maciejcieslar/instagrambot/blob/master/src/index.ts" rel="noopener ugc nofollow" target="_blank"> src/index.ts </a></p><figure class="ly lz ma mb fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><pre class="ly lz ma mb fq mc md me mf aw mg dt"><span id="03d5" class="mh kw hu md b fv mi mj l mk ml">npm run start</span></pre></div><div class="ab cl nh ni hc nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="hn ho hp hq hr"><p id="64cc" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">非常感谢你的阅读，希望你喜欢！</p><p id="bdb4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你有任何问题或意见，欢迎在下面的评论区提出，或者给我发<a class="ae jg" href="https://www.mcieslar.com/contact" rel="noopener ugc nofollow" target="_blank">消息</a>。</p><p id="205c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在推特上关注我<a class="ae jg" href="https://www.twitter.com/maciejcieslar" rel="noopener ugc nofollow" target="_blank"> @maciejcieslar </a>。</p><p id="1144" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="http://eepurl.com/dAKhxb" rel="noopener ugc nofollow" target="_blank">加入我的简讯</a>！</p></div><div class="ab cl nh ni hc nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="hn ho hp hq hr"><p id="d7ee" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mp">原载于2018年7月10日</em><a class="ae jg" href="https://www.mcieslar.com/creating-an-instagram-bot-with-node" rel="noopener ugc nofollow" target="_blank"><em class="mp">www.mcieslar.com</em></a><em class="mp">。</em></p></div></div>    
</body>
</html>