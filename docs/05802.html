<html>
<head>
<title>The Three Levels of Reusability in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中可重用性的三个层次</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/the-three-types-of-reusable-react-components-37a6bf7c2d69?source=collection_archive---------6-----------------------#2018-07-11">https://medium.com/hackernoon/the-three-types-of-reusable-react-components-37a6bf7c2d69?source=collection_archive---------6-----------------------#2018-07-11</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/045e1137cc212f0434f2b882442985b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EBh4Yh7Sq2McY2P3TwDN3w@2x.jpeg"/></div></div></figure><div class=""/><p id="5702" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">开发人员经常谈论重用代码的重要性。我们谈论DRY原则(不要重复自己)，代码审查充斥着类似这样的评论:“你能把它封装成一个函数并在第19行重用它吗”，我们经常向产品所有者解释为什么当我们在这里<em class="kb">上</em>改变一些东西时，它会在这里<em class="kb">上</em>自动<em class="kb">改变。</em></p><p id="16da" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但这些讨论缺乏一些细微差别。他们经常让可重用性看起来像是二进制的——代码要么可重用，要么不可重用。我认为实际上有三个层次的可重用性。</p><p id="2c86" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">第一种，也是最不可重用的组件类型根本不能被重用。有经验的开发人员在严格、不灵活的期限内构建这种类型的组件。没有经验的开发人员在他们只想让某些东西工作或者还没有学会重用代码的时候构建这种类型的组件。</p><p id="d82c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">中间地带充满了只能在一个应用程序中重用的组件。大多数组件都属于这一阵营。开发人员关心可重用性，希望一次又一次地重用他们的组件，而不是重新发明轮子，但不想把精力放在提取那些组件并把它们放在库中。</p><p id="9de1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">可以在应用程序之间共享的第三种类型的组件。这些组件存在于像<a class="ae ka" href="https://material-ui.com/" rel="noopener ugc nofollow" target="_blank">材质UI </a>或<a class="ae ka" href="http://react-toolbox.io/#/" rel="noopener ugc nofollow" target="_blank">反应工具箱</a>这样的库中。它们可以导入到应用程序中，并且它们的组件可以重用。</p><p id="e155" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">每个级别的可重用性都需要不同的工作量来构建，并为团队和业务提供不同级别的价值。让我们研究一下<code class="eh kc kd ke kf b">Button</code>组件在每一层可能是什么样子。</p></div><div class="ab cl kg kh hc ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hn ho hp hq hr"><figure class="ko kp kq kr fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff kn"><img src="../Images/e5a7cccf2598e4b534413afa63b1788f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XGyNx2biq3WS4xIR8By1Hg.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Design credit: <a class="ae ka" href="https://www.linkedin.com/in/joecahill" rel="noopener ugc nofollow" target="_blank">Joe Cahill</a></figcaption></figure><h2 id="9f78" class="kw kx if bd ky kz la lb lc ld le lf lg jn lh li lj jr lk ll lm jv ln lo lp lq dt translated">完全不能重复使用的组件</h2><p id="053c" class="pw-post-body-paragraph jc jd if je b jf lr jh ji jj ls jl jm jn lt jp jq jr lu jt ju jv lv jx jy jz hn dt translated">构建按钮的方法有很多种，不同的团队成员可能有不同的偏好。我见过开发人员上百次地重新构建一个简单的<code class="eh kc kd ke kf b">Button</code>，而不是构建一个可以跨应用程序重用的可重用按钮。</p><p id="4eb4" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">例如，有时我会看到带有特定业务逻辑和样式的按钮。我甚至见过一些硬编码的文本。</p><pre class="ko kp kq kr fq lw kf lx ly aw lz dt"><span id="99e3" class="kw kx if kf b fv ma mb l mc md"><em class="kb">const</em> ComparisonButton = ({ <br/>  isDisabled, <br/>  icon, <br/>  width, <br/>  color, <br/>  region <br/>}) <em class="kb">=&gt;</em> {   <br/>  <em class="kb">const</em> color = isDisabled === true ? '#999999' : '#1274b8';<br/>  const btnClass = region === 'us' ? 'btn__blue : 'btn__red'; </span><span id="fc5e" class="kw kx if kf b fv me mb l mc md"><em class="kb">  return</em> (<br/>    &lt;button className={btnClass}&gt;<br/>      &lt;Icon <br/>        styles={icon}<br/>        width={width}<br/>        color={color}<br/>      &lt;/Icon&gt;<br/>      Compare Me<br/>    &lt;/button&gt;<br/> );<br/>};</span></pre><p id="17c0" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它可以这样使用:</p><pre class="ko kp kq kr fq lw kf lx ly aw lz dt"><span id="d294" class="kw kx if kf b fv ma mb l mc md">import { ComparisonButton } from './ComparisonButton</span><span id="63c0" class="kw kx if kf b fv me mb l mc md">const ParentComponent = () =&gt; {<br/>  return &lt;ComparisonButton /&gt;<br/>}</span></pre><p id="f572" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个<code class="eh kc kd ke kf b">Button</code>组件的实现方式有几个主要问题。</p><ol class=""><li id="2bbe" class="mf mg if je b jf jg jj jk jn mh jr mi jv mj jz mk ml mm mn dt translated">文本被硬编码在<code class="eh kc kd ke kf b">Button</code>中。如果您需要国际化您的应用程序，并且<code class="eh kc kd ke kf b">Button</code>文本需要是法语，会发生什么？</li><li id="e09a" class="mf mg if je b jf mo jj mp jn mq jr mr jv ms jz mk ml mm mn dt translated"><code class="eh kc kd ke kf b">Button</code>知道<code class="eh kc kd ke kf b">Icon</code>组件。如果有人想用这个没有<code class="eh kc kd ke kf b">Icon</code>的<code class="eh kc kd ke kf b">Button</code>会怎么样？</li></ol><p id="51a9" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">3.<code class="eh kc kd ke kf b">Button</code>的造型是由它内部决定的，而不是作为道具传进来的。这使得样式更难覆盖。如果想重用风格略有不同的<code class="eh kc kd ke kf b">Button</code>的逻辑怎么办？</p><p id="b24b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个<code class="eh kc kd ke kf b">Button</code>真的是具体到它的上下文。它只能在一种情况下使用，即使它与站点上的所有其他按钮共享逻辑。你甚至不能把你想要的任何文本传进去！</p><p id="3d64" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">假设我们想将它重构为一个可以在应用程序中重用的组件。</p><h2 id="0305" class="kw kx if bd ky kz la lb lc ld le lf lg jn lh li lj jr lk ll lm jv ln lo lp lq dt translated">只能在应用程序中重用的组件</h2><p id="b278" class="pw-post-body-paragraph jc jd if je b jf lr jh ji jj ls jl jm jn lt jp jq jr lu jt ju jv lv jx jy jz hn dt translated">如果我们重构前面的例子，使其在我们的应用程序中可重用，它就需要更加通用。</p><pre class="ko kp kq kr fq lw kf lx ly aw lz dt"><span id="b200" class="kw kx if kf b fv ma mb l mc md"><em class="kb">const</em> Button = ({ children, onClick, className, ...props }) <em class="kb">=&gt;</em> {   <br/>  <em class="kb">return</em> (<br/>    &lt;button className={className} onClick={onClick}&gt;<br/>     {children}    <br/>    &lt;/button&gt;<br/>  );<br/>};</span></pre><p id="3553" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它可以这样使用:</p><pre class="ko kp kq kr fq lw kf lx ly aw lz dt"><span id="be4a" class="kw kx if kf b fv ma mb l mc md">const ParentComponent = (props) =&gt; {</span><span id="e674" class="kw kx if kf b fv me mb l mc md"><em class="kb">  const</em> color = props.isDisabled === true ? '#999999' : '#1274b8';<br/>  const btnClass = props.region === 'us' ? 'btn__blue : 'btn__red';<br/>  const onClick = () =&gt; { // do something }</span><span id="ee8a" class="kw kx if kf b fv me mb l mc md">  &lt;Button className={btnClass} onClick={onClick}&gt;      <br/>    &lt;Icon <br/>      styles={props.icon}<br/>      width={props.width}<br/>      color={props.color}<br/>    &lt;/Icon&gt;<br/>    Compare Me<br/>  &lt;/Button&gt;<br/>}</span></pre><p id="fd83" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，<code class="eh kc kd ke kf b">Button</code>不需要了解<code class="eh kc kd ke kf b">Icon</code>。对于另一个开发人员来说，在没有<code class="eh kc kd ke kf b">Icon</code>的场景中重用<code class="eh kc kd ke kf b">Button</code>非常容易。</p><p id="a63d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们还将按钮被禁用时<code class="eh kc kd ke kf b">Icon</code>应该是什么颜色的知识移到了<code class="eh kc kd ke kf b">ParentComponent</code>中。此外，<code class="eh kc kd ke kf b">ParentComponent</code>管理<code class="eh kc kd ke kf b">Button</code>应该如何基于区域进行样式化。</p><p id="cab6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh kc kd ke kf b">Button</code>内部的逻辑只处理它<em class="kb">需要</em>知道的东西，而应用程序处理业务逻辑。这使得与该应用程序在同一个repo中工作的其他开发人员可以重用该按钮。</p><h2 id="36be" class="kw kx if bd ky kz la lb lc ld le lf lg jn lh li lj jr lk ll lm jv ln lo lp lq dt translated">可以在应用程序之间共享的组件</h2><p id="c7a1" class="pw-post-body-paragraph jc jd if je b jf lr jh ji jj ls jl jm jn lt jp jq jr lu jt ju jv lv jx jy jz hn dt translated">假设您的团队在扩大，您希望所有团队都能为您的用户提供一致的体验。您将需要升级到第三种类型的可重用组件。您将构建一个可重用组件的库，它可以被您工作的所有团队使用。</p><p id="0ad7" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">那个图书馆:</p><ol class=""><li id="4ca5" class="mf mg if je b jf jg jj jk jn mh jr mi jv mj jz mk ml mm mn dt translated">必须可以安装到其他应用程序中</li><li id="0ffa" class="mf mg if je b jf mo jj mp jn mq jr mr jv ms jz mk ml mm mn dt translated">必须处理造型</li><li id="a406" class="mf mg if je b jf mo jj mp jn mq jr mr jv ms jz mk ml mm mn dt translated">必须使样式易于覆盖</li><li id="9047" class="mf mg if je b jf mo jj mp jn mq jr mr jv ms jz mk ml mm mn dt translated">必须有文档</li></ol><p id="7299" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您的按钮可能看起来仍然像以前一样，但是现在，您将从库中导入它，而不是从应用程序中的另一个文件导入。</p><p id="1401" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如何实际构建一个可重用的组件库是另一篇文章的主题，但是如果你正试图决定是否要进行这个项目，可以考虑阅读<a class="ae ka" rel="noopener" href="/@MCapoz/should-you-build-a-reusable-component-library-4e7df72413d7">你应该构建一个可重用的组件库吗？</a></p></div><div class="ab cl kg kh hc ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hn ho hp hq hr"><p id="a196" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这三个层次的可重用性都有优点和缺点。有时候，你只需要完成一个功能。其他时候，您希望在团队中共享组件。</p><p id="fbd6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当你开发一个特性的时候，你应该为你所从事的工作，你的公司所处的阶段，以及你的团队的带宽选择合适的可重用性级别。有时，在可重用性阶梯的最底层构建一些东西是完全可以接受的。其他团队可能需要更强大的解决方案。只要始终确保您有意识地选择可重用性的级别，并认识到您所做的假设。</p></div><div class="ab cl kg kh hc ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hn ho hp hq hr"><p id="e920" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你喜欢这篇文章，并且有兴趣学习更多关于可重用性和可重用组件库的知识，你可以考虑:</p><ul class=""><li id="b262" class="mf mg if je b jf jg jj jk jn mh jr mi jv mj jz mt ml mm mn dt translated">你应该建立一个可重用的组件库吗？</li><li id="f9b5" class="mf mg if je b jf mo jj mp jn mq jr mr jv ms jz mt ml mm mn dt translated"><a class="ae ka" href="https://m.youtube.com/watch?v=PHi2lohuXvo" rel="noopener ugc nofollow" target="_blank">构建可复用组件库</a></li></ul><p id="9e92" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">🌟<strong class="je ig"> <em class="kb">如果你喜欢这个帖子，</em> </strong> <strong class="je ig"> <em class="kb">一定要在中上</em> </strong> <a class="ae ka" rel="noopener" href="/@MCapoz"> <strong class="je ig"> <em class="kb">关注我</em> </strong> </a> <strong class="je ig"> <em class="kb">，</em><a class="ae ka" href="https://twitter.com/MCapoz" rel="noopener ugc nofollow" target="_blank"><strong class="je ig"><em class="kb">在twitter上关注我</em> </strong> </a> <strong class="je ig"> <em class="kb">，并在</em></strong><a class="ae ka" href="https://www.patreon.com/maecapozzi" rel="noopener ugc nofollow" target="_blank"><strong class="je ig"><em class="kb">Patreon</em>T41】🌟</strong></a></strong></p><figure class="ko kp kq kr fq hw"><div class="bz el l di"><div class="mu mv l"/></div></figure></div></div>    
</body>
</html>