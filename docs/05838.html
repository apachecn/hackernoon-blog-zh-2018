<html>
<head>
<title>Tensorflow Vs Keras? — Comparison by building a model for image classification.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tensorflow Vs Keras？—通过建立图像分类模型进行比较。</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/tensorflow-vs-keras-comparison-by-building-a-model-for-image-classification-f007f336c519?source=collection_archive---------2-----------------------#2018-07-16">https://medium.com/hackernoon/tensorflow-vs-keras-comparison-by-building-a-model-for-image-classification-f007f336c519?source=collection_archive---------2-----------------------#2018-07-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/117fadd14be9f774b76ae3e25155333d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*99EOCVmmez8FK6pdQCNUsQ.jpeg"/></div></div></figure><p id="0e1b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">是的，正如标题所说，这是数据科学家之间非常平常的谈话(甚至是你！)有些人说TensorFlow更好，有些人说Keras更好！让我们看看在图像分类的情况下，这个东西实际上是如何工作的。</p><p id="3524" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在此之前，让我们介绍这两个术语Keras和Tensorflow，并帮助您在10分钟内建立一个强大的图像分类器！</p><h1 id="b8fb" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated"><strong class="ak">张量流:</strong></h1><p id="5d09" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">Tensorflow是深度学习中开发模型使用最多的库。这是有史以来最好的图书馆，被许多极客在日常实验中完全选中。如果我说谷歌已经把张量处理单元(TPU)仅仅用于处理张量，你能想象吗？是的，他们有。他们放置了一个单独的实例类，称为TPU，它具有最强大的计算能力来处理张量流的深度学习模型。</p><h1 id="6043" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated"><strong class="ak">建造它的时间到了！</strong></h1><p id="041a" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">我现在将帮助您使用tensorflow创建一个强大的图像分类器。等等！什么是量词？这只是您向tensorflow代码抛出的一个简单问题，询问给定的图像是玫瑰还是郁金香。所以，首先要做的是。让我们在机器上安装tensorflow。官方文档提供了两个版本，即CPU和GPU版本。对于CPU版本:</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="e106" class="lm kb hu li b fv ln lo l lp lq">pip install tensorflow</span></pre><p id="0089" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">请注意，我是在对GPU而不是CPU进行实验后写这篇博客的。GPU安装在这里被整齐的给了<a class="ae lr" href="https://www.tensorflow.org/install/" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="ab fr cl ls"><img src="../Images/732382a159f4f84b456f506709bf1003.png" data-original-src="https://miro.medium.com/v2/format:webp/1*dr3pZsLJg28gKwq0MXp1Mg.png"/></div></figure><p id="d227" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，让我们用Google的Tensorflow for poets实验来训练一个模型。谷歌的这个知识库有惊人的脚本，可以对图像进行简单的实验。它非常简洁，足以满足我们的目的。还记得我之前用过的<strong class="je hv">强大</strong>这个词吗？是的，当我们使用一种叫做<strong class="je hv">迁移学习的东西时，这个词就开始起作用了。</strong>迁移学习是一种强大的方法，它使用已经训练了几天或几周的预训练模型，然后改变最终层以适应我们自己的一组类。</p><p id="eb9a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Inception V3是一个非常好的模型，在2015 ImageNet Challenge 的图像分类中排名第二。对于每类图像数量较少的数据集，它被认为是迁移学习的最佳网络。</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lt"><img src="../Images/73bd2b2ab730e76ce2c5f5358fb56b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9YouBEcHMPaeLJ1W.png"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">Inception V3</figcaption></figure><p id="6919" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在克隆git存储库:</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="c560" class="lm kb hu li b fv ln lo l lp lq">git clone https://github.com/googlecodelabs/tensorflow-for-poets-2</span><span id="bdbe" class="lm kb hu li b fv ly lo l lp lq">cd tensorflow-for-poets-2</span></pre><p id="51b9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，你可以选择你的图像。你所要做的就是把数据集文件夹放在下面的样式中。</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="c17b" class="lm kb hu li b fv ln lo l lp lq"> — Dataset folder -<br/>       class1/<br/>           — image1<br/>           — image2<br/>       class2/<br/>           — image1<br/>           — image2</span></pre><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lz"><img src="../Images/c14cc19a8505fe187ef46c3ec233443e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I_lY47Dg6Px_WMTfu3OKhg.png"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">FLOWER DATA</figcaption></figure><p id="5f3e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它应该看起来像上面这样(忽略image.py)。我已经得到了上面的<strong class="je hv">花_照片</strong>文件夹:</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="ac87" class="lm kb hu li b fv ln lo l lp lq">curl http://download.tensorflow.org/example_images/flower_photos.tgz | tar xz -C tf_files</span></pre><h2 id="6ea2" class="lm kb hu bd kc ma mb mc kg md me mf kk jn mg mh ko jr mi mj ks jv mk ml kw mm dt translated">创建数据集</h2><p id="511f" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">你可以使用任何你喜欢的图片。越多越好(以几千为目标)。如上所述，将它们按类别分开，并确保它们在一个名为<code class="eh mn mo mp li b">tf_files.</code>的文件夹中</p><p id="7921" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以下载已经存在的各种用例的数据集，比如《权力的游戏》中角色的癌症检测。这里是各种<a class="ae lr" href="https://dataturks.com/projects/Trending?type=IMAGE_CLASSIFICATION" rel="noopener ugc nofollow" target="_blank">影像分类数据集。</a></p><p id="9461" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者，如果您有自己独特的用例，您可以为它创建自己的数据集。您可以从网上下载图像，并使用像<a class="ae lr" href="https://dataturks.com/" rel="noopener ugc nofollow" target="_blank"> Dataturks </a>这样的注释工具，在ziffy中手动上传图像并标记图像，从而立即创建一个大数据集。更好的是，Dataturks的输出可以很容易地用于构建tf_files。</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mq"><img src="../Images/07fdc836772fac866710c0015c12e571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMKNwK4Bhqsak5BsX0xwcg.png"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">Building dataset using Dataturks</figcaption></figure><p id="0e1d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我发现了一个很棒的插件，可以在谷歌Chrome上批量下载图像——这个+ Dataturks将使构建训练数据变得轻而易举。此处链接<a class="ae lr" href="https://chrome.google.com/webstore/detail/fatkun-batch-download-ima/nnjjahlikiabnchcpehcpkdeckfgnohf?hl=en" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="d9ec" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以试试用dataturks <a class="ae lr" href="https://dataturks.com/projects/import?type=IMAGE_CLASSIFICATION" rel="noopener ugc nofollow" target="_blank">的image_classification工具在这里</a>做这个。此处，该工具提供的最佳功能是，如果我们有一个非结构化数据集，并且所有图像都在一个文件夹中。通过手动用类来标记它，您可以下载一个json文件，其中包含嵌入了类的图像的所有细节。然后为<a class="ae lr" href="https://gist.github.com/sameerg07/e296fe1f8e24933aa6eedd558047278c" rel="noopener ugc nofollow" target="_blank"> keras </a>和<a class="ae lr" href="https://gist.github.com/sameerg07/4e0337ed2f77845edbb319633bd324e5" rel="noopener ugc nofollow" target="_blank"> tensorflow </a>使用这里给出的脚本:</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="8b33" class="lm kb hu li b fv ln lo l lp lq">-------&gt; for tensorflow<br/>python3 tensorflow_json_parser.py — json_file “flower.json” — dataset_path “Dataset5/”</span><span id="da89" class="lm kb hu li b fv ly lo l lp lq">-------&gt; for keras<br/>python3 keras_json_parser.py --json_file "flower.json" --dataset_path "Dataset5/" --train_percentage 80 --validation_percentage 20</span></pre><h2 id="a36a" class="lm kb hu bd kc ma mb mc kg md me mf kk jn mg mh ko jr mi mj ks jv mk ml kw mm dt translated">培养</h2><p id="767b" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">现在是训练模型的时候了。在tensorflow-for-poets-2文件夹中，有一个名为scripts的文件夹，其中包含了重新训练模型所需的所有内容。<strong class="je hv"> retrain.py </strong>有一种特殊的方式来裁剪和缩放图像，这太酷了。</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mr"><img src="../Images/664dba0eec1556bb38ae414d568a4b50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4PMf03NgVJFaRdhR5k8R1g.png"/></div></div></figure><p id="61a0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后使用以下命令进行训练，其中选项名称本身描述了所需的训练路径。：</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="fd06" class="lm kb hu li b fv ln lo l lp lq">python3 -m scripts.retrain \ <br/> --bottleneck_dir=tf_files/bottlenecks \ <br/> --model_dir=tf_files/models/inception \<br/> --output_graph=tf_files/retrained_graph.pb \<br/> --output_labels=tf_files/retrained_labels.txt \<br/> --image_dir=tf_files/flower_photos</span></pre><p id="afdd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这将下载初始模型，并使用培训文件夹和给定的参数相应地培训最后一层。我用12GB Nvidia Tesla k80和7GB Vram在GCP实例上训练了4000步。</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ms"><img src="../Images/9edc386cffee86c19ee29170171882d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gThLRCa6hu8pFxrKD78LgQ.png"/></div></div></figure><p id="0a3d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">训练是以80-20，测试-训练分割完成的，我们可以在上面看到，它给出了91%的测试准确度。现在是测试的时候了！我们在<strong class="je hv"> <em class="mt"> tf_files/ </em> </strong>中有一个. pb文件可以用来测试。以下更改已添加到<strong class="je hv"> label_image.py </strong></p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="90a2" class="lm kb hu li b fv ln lo l lp lq">from PIL import Image,ImageDraw,ImageFont<br/>results = results.tolist()<br/>image = Image.open(file_name)<br/>fonttype = ImageFont.truetype(“/usr/share/fonts/truetype/dejav/DejaVuSans.ttf”,18)<br/> <br/>draw = ImageDraw.Draw(image)<br/>draw.text(xy=(5,5),text=str(labels[results.index(max(results))])+”:”+str(max(results)),fill = (255,255,255,128),font = fonttype)<br/>image.show()<br/>image.save(file_name.split(“.”)[0]+”1"+”.jpg”)</span></pre><p id="2e43" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">上面的代码将帮助我们在被测试的图像上绘制精度并保存它。随机图像的置信度百分比如下所示</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff mu"><img src="../Images/717af8184b8c68a3730ee13e74e9855f.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*rn-R75wcPnexbe9jKuw7Ag.png"/></div></figure><p id="1663" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">显示了几个测试输出:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/12b2c062db4c68a40289e51df4e48c9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Po083pI3sIGxTG7s5ymjRA.jpeg"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">a collage of few outputs comprising of all classes</figcaption></figure><p id="bc3b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">正如我们所看到的，对于所陈述的任务来说，结果是非常有希望的。</p><h1 id="f076" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated"><strong class="ak"> KERAS: </strong></h1><p id="c67c" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">Keras是建立在TensorFlow之上的高级API(也可以用在Theano之上)。与<strong class="je hv"> Tensorflow相比，它更加用户友好和易于使用。如果我们是所有这些深度学习的新手，想要从头开始编写一个新模型，那么我会建议使用Keras，因为它在可读性和可写性方面都很容易。它可以与以下设备一起安装:</strong></p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="72af" class="lm kb hu li b fv ln lo l lp lq">pip install keras</span></pre><p id="e42e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">甚至这个东西也包裹在tensorflow上，所以CPU v/s GPU兼容性变化也将适用于此。</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mv"><img src="../Images/26b51ac4a62dd4637e10decd02285d5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s3cLmPw09rFq0fDn.png"/></div></div></figure><p id="e077" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因为，我们必须使用迁移学习和inception模型来执行相同的分类花卉的任务，我已经看到Keras以标准格式加载模型，就像API是如何编写的一样。</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="8949" class="lm kb hu li b fv ln lo l lp lq">from keras.applications.inception_v3 import preprocess_input</span></pre><p id="e9e3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Keras具有加载数据集的标准格式，即，我们不是直接在数据集文件夹中给出文件夹，而是手动划分训练和测试数据，并按照以下方式排列它们。我使用了在tensorflow部分下载的相同数据集，并按照下面的指示做了一些修改。</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="29cf" class="lm kb hu li b fv ln lo l lp lq"> — Dataset folder -<br/>  — train/ <br/>       class1/<br/>          — image1<br/>          — image2<br/>       class2/<br/>          — image1<br/>          — image2<br/>  — test/ <br/>      class1/<br/>          — image1<br/>          — image2<br/>      class2/<br/>          — image1<br/>          — image2</span></pre><p id="0e61" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它应该如下所示:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mw"><img src="../Images/00a6c4aaa7138eb6f2886a712045c270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YK4JcggiXOH28I9qsc8Nzw.png"/></div></div></figure><p id="cbc1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">和测试应该有如下所示的文件夹:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mx"><img src="../Images/9a2addd17dd2e9315203531482af97a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GVMUM4d6NhrO5AZJkkqG2w.png"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">TRAIN FOLDER</figcaption></figure><p id="f87b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，我们已经完成了数据集的设置，是时候进行培训了！我写下了一小段代码来进行下面的训练:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="my mz l"/></div></figure><p id="27d7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这段代码写得很简洁，通过将参数传递给下面的命令可以很容易理解:</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="938e" class="lm kb hu li b fv ln lo l lp lq">python3 inception_train.py <br/> — train_dir flower_photos/train \<br/> — val_dir flower_photos/validation \ <br/> — nb_epoch 50 \ <br/> — batch_size 10 \ <br/> — output_model_file inception_yo1.model</span></pre><p id="dd8c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在我的GPU上的训练花费了每个时期大约1分钟，每个时期292步，并且训练了50个时期(这非常多！)批量为10，数据分割为80–20。</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff na"><img src="../Images/bd2f3b2633fb92fe21a4a68a6cf47d6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*WQyya9IQh5COo3WTyETD_w.png"/></div></figure><p id="ddc3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">哇哦！我们完成了训练，达到了大约91%的测试准确度和0.38的损失。该模型已经保存为一个inception.model文件，可以再次加载和测试。为此，我们编写了另一个脚本，在图像上绘制预测的类并保存它。测试脚本如下所示:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="my mz l"/></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">inception_test.py</figcaption></figure><p id="1e67" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该脚本可以测试为:</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="76c8" class="lm kb hu li b fv ln lo l lp lq">python3 -m scripts.label_image — graph=tf_files/retrained_graph.pb — image=rose.jpeg</span></pre><p id="ac88" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所有类别的预测置信度百分比输出如下:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="fe ff nb"><img src="../Images/1daa8918f66d40c31404e849d452ce0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*3TTokRHY-yM5TcR3r8tD6A.png"/></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">[daisy,dandelion,roses,sunflower,tulip]</figcaption></figure><p id="ceb3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下面是一些带有图形的输出:</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nc"><img src="../Images/af629e555d760cfcecb99791ca739edb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Q8XV88ConT3PenriGt7Qw.jpeg"/></div></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">tested images with their probability graphs</figcaption></figure><p id="e712" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">终于！您已经学习了如何使用Keras和tensorflow构建强大的分类器。但是，哪一个是最好的仍然是我们头脑中的一个问题！因此，让我们仅基于目前的分类任务进行比较研究。</p><p id="5ef6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">keras的全部tain和测试代码以及修改后的tensorflow脚本都可以在我的github <a class="ae lr" href="https://github.com/sameerg07/FlowerClassification" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="125c" class="lm kb hu bd kc ma mb mc kg md me mf kk jn mg mh ko jr mi mj ks jv mk ml kw mm dt translated">原型制作:</h2><p id="8768" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">如果你真的想快速编写代码并建立模型，那么Keras是一个好选择。我们可以在几分钟内建立复杂的模型！<code class="eh mn mo mp li b">Model</code>和<code class="eh mn mo mp li b">Sequential</code>API是如此强大，以至于它们甚至不会给你一种你正在构建强大模型的感觉，因为它们使用起来很容易。</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="my mz l"/></div></figure><p id="d270" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就这样，一个模型做好了！甚至迁移学习在Keras中比在tensorflow中更容易编码。Tensorflow太难了，除非你是一个有粘性的程序员，否则无法从头开始编码。</p><h2 id="bac2" class="lm kb hu bd kc ma mb mc kg md me mf kk jn mg mh ko jr mi mj ks jv mk ml kw mm dt translated">临时编码和灵活性:</h2><p id="7a8d" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">与Keras相比，tensorflow是一个低级的库，许多新功能在tensorflow中可以以比Keras更好的方式实现，例如，任何激活功能等。此外，tensorflow中模型的微调和调整比Keras中的更灵活，因为有更多的参数可用。</p><h2 id="caaf" class="lm kb hu bd kc ma mb mc kg md me mf kk jn mg mh ko jr mi mj ks jv mk ml kw mm dt translated">训练时间和处理能力:</h2><p id="1d64" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">上述模型在相同的数据集上训练，我们看到Keras比tensorflow需要更长的训练时间。Tensorflow在15分钟内完成了4000步的训练，而Keras花了大约2小时完成50个周期。可能我们无法比较步数和纪元，但在这种情况下，两者都给出了91%的测试准确度，这是可比的，我们可以描述keras训练比tensorflow慢一点。除此之外，这是有意义的，因为tensorflow是一个低级库。</p><h2 id="8ff0" class="lm kb hu bd kc ma mb mc kg md me mf kk jn mg mh ko jr mi mj ks jv mk ml kw mm dt translated">提供的额外功能:</h2><p id="8e47" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">Tensorflow有一个内置的调试器，可以在训练期间进行调试，也可以生成图形。</p><figure class="ld le lf lg fq iv fe ff paragraph-image"><div class="ab fr cl ls"><img src="../Images/09d30fdced04bddaf332d705df971b4a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*a1Cb6y1jYeOolmC-Qxc6Mw.png"/></div><figcaption class="lu lv fg fe ff lw lx bd b be z ek">TensorFlow Debugger snapshot (Source : TensorFlow documentation )</figcaption></figure><p id="73ab" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">Tensorflow甚至支持线程和队列异步训练重张量！这为TPU提供了更好、更快的处理速度。线程的示例代码如下所示:</p><figure class="ld le lf lg fq iv"><div class="bz el l di"><div class="my mz l"/></div></figure><h2 id="cc63" class="lm kb hu bd kc ma mb mc kg md me mf kk jn mg mh ko jr mi mj ks jv mk ml kw mm dt translated">监测和控制:</h2><p id="7ea3" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">根据我在dee学习中的经验，我觉得tensorflow非常适合许多情况，尽管它有点难。例如，我们可以很容易地监控每一件事，例如控制网络的权重和梯度。我们可以选择哪一步应该训练，哪一步不应该。这在喀拉斯不太可行。下面给出的一行就有这样的魔力！</p><pre class="ld le lf lg fq lh li lj lk aw ll dt"><span id="4a03" class="lm kb hu li b fv ln lo l lp lq">step = tf.Variable(1, trainable=False, dtype=tf.int32)</span></pre><h1 id="3bb8" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">结论:</h1><p id="abef" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">无论如何，Keras将很快被整合到tensorflow中！那么，为什么选择pythonic呢？(Keras是pythonic化的)。我的建议是花些时间习惯tensorflow。上面的分类问题，如果你已经按照博客做了相应的步骤，那么你会觉得Keras在很多方面都是比tensorflow小痛苦和耐心杀手。所以，试着使用其他的类，试着为假钞检测等应用训练分类器</p><p id="7c76" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">希望这个博客能让你更好地了解什么时候用什么！</p><p id="b6e2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我希望听到任何建议或疑问。请在sameer.gadicherla@dataturks.comT3给我写信</p></div></div>    
</body>
</html>