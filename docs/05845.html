<html>
<head>
<title>Build an E-Commerce Progressive Web App with GatsbyJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用GatsbyJS构建一个电子商务渐进式Web应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-an-e-commerce-progressive-web-app-with-gatsbyjs-dc811ec2b9d4?source=collection_archive---------9-----------------------#2018-07-16">https://medium.com/hackernoon/build-an-e-commerce-progressive-web-app-with-gatsbyjs-dc811ec2b9d4?source=collection_archive---------9-----------------------#2018-07-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/cb02374d70e3319c5b90fe40d7bf21b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hPoIYfgcOXjvB__v4NnhvQ.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/photos/0kwMzZZ5oKo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Yiran Ding</a> on <a class="ae jg" href="https://unsplash.com/search/photos/phone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="67c9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">前几天试着用手机买了一件t恤。</p><p id="1805" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先，我被重定向到一个http://m.thatsite.com的网址。</p><p id="0db5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">移动网站负载…</p><p id="cfae" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">内容终于出现了，同时出现了一个全屏弹出窗口:</p><p id="50ea" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">下载我们的手机应用程序，获得更好的购物体验！</strong></p><p id="665e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我点击链接。App store加载…</p><p id="8e68" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">差评，模糊截图，50 MB。<em class="kf">叹息</em></p><p id="64a1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我关闭了应用商店和浏览器。</p><p id="01f9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这种熟悉、粗略的购物体验<em class="kf">本可以</em>避免。</p><p id="fef5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">怎么会？用<strong class="jj hv">递进web app电商</strong>。</p><p id="bb85" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">近几年来，渐进式网络应用(PWAs)一直呈上升趋势。实实在在的PWA例子到处都在涌现，而且理由充分。</p><p id="4b0d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">他们鼓励一种包容性的、全球性的、适应性的web开发方法。正如我们将在本文中看到的，从用户和业务角度来看，它们都是有意义的。像<a class="ae jg" href="https://snipcart.com/blog/react-seo-nextjs-tutorial" rel="noopener ugc nofollow" target="_blank"> React </a>和<a class="ae jg" href="https://snipcart.com/blog/vuejs-ecommerce-headless-buttercms" rel="noopener ugc nofollow" target="_blank"> Vue JS </a>这样的框架越来越多地被用于制作pwa。</p><p id="78b4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">今天，我将向你展示如何利用盖茨比建立一个顺利的PWA商店。</p><p id="a65f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这篇文章将涵盖:</p><ol class=""><li id="1eaf" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke kl km kn ko dt translated">艾滋病毒/艾滋病的定义</li><li id="ddf0" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">PWA电子商务案例</li><li id="339a" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">PWAs的Gatsby.js概述</li><li id="4394" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">详细的PWA示例，包括步骤、代码回购和现场演示</li></ol><p id="b8b4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们开始吧。</p><h1 id="e8bd" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">什么是渐进式Web应用程序(PWA)？</h1><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ls"><img src="../Images/230ebf79dd2f40972c71b8a2d7797c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EexGseVMGfg5wRnv.png"/></div></div></figure><p id="434e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">渐进式网络应用</strong>是谷歌工程师创造的一个总括术语。它是一组开发原则，而不是特定的技术或堆栈。该方法包含三个重要原则:</p><p id="62c0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> 1。可靠性</strong></p><p id="6b74" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">通过<a class="ae jg" href="https://developers.google.com/web/fundamentals/primers/service-workers/" rel="noopener ugc nofollow" target="_blank">服务人员</a>，无论设备或网络状况如何，包括离线状态，PWA都不会对用户的请求做出响应。</p><p id="2168" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> 2。性能</strong></p><p id="db3f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">通过压缩、预缓存、代码分割和渐进式渲染等技术，PWA极大地减少了“pogo-sticking”用户的数量——这些用户在网站加载缓慢时放弃了您的网站！这里的目标是争取最短的<a class="ae jg" href="https://developers.google.com/web/tools/lighthouse/audits/time-to-interactive" rel="noopener ugc nofollow" target="_blank">交互时间</a>。</p><p id="1c6c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv"> 3。订婚</strong></p><p id="abb3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">通过Web应用程序清单，pwa可以轻松安装在移动主屏幕上。作为一名开发者，你可以在这里得到两个世界的最好的东西:没有应用程序商店重定向/糟糕的安装，以及能够<a class="ae jg" href="https://developers.google.com/web/fundamentals/push-notifications/" rel="noopener ugc nofollow" target="_blank">通过网络推送通知</a>吸引移动用户。所有这些都包含在一个web应用程序中，其感觉和行为几乎与原生移动应用程序相同。</p><p id="1a4c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">要获得更全面的PWA清单，请务必查看<a class="ae jg" href="https://developers.google.com/web/progressive-web-apps/checklist" rel="noopener ugc nofollow" target="_blank">谷歌词条</a>。</p><h1 id="4994" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">为什么电子商务要使用PWA？</h1><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/573d0f76a7c1700b95bd5cc751f36449.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/0*tV1NZpf_M32wjyb5.jpg"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Flipkart Lite, a prime example of mobile e-commerce with a PWA</figcaption></figure><p id="7aea" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">渐进式网络应用的技术优势转化为电子商务商家的直接商业利益:</p><p id="49e5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">它拓宽了市场和使用案例。</strong></p><p id="56d7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">浏览和购买可以在任何地方的任何连接上，无论速度快慢，在大多数设备上完成。线下能力也可以刺激参与，正如我们将在下面的PWA示例中看到的。</p><p id="54e2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这有助于提高转化率。</p><p id="542c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">服务人员的预先缓存有助于获得快速、流畅的购物体验。Chrome dev tools(<a class="ae jg" href="https://developers.google.com/web/tools/lighthouse/" rel="noopener ugc nofollow" target="_blank">Google light house</a>)中的开箱即用PWA审计允许您快速发现&amp;修复性能问题。提供内容自适应地减少跳出率，从而提高用户参与度指标，这是一个突出的SEO排名信号。</p><p id="15e5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">它减少了开发预算。</strong></p><p id="2a22" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">无需开发单独的网络和移动应用。由于“<a class="ae jg" href="https://developers.google.com/web/fundamentals/app-install-banners/" rel="noopener ugc nofollow" target="_blank">添加到主屏幕</a>”和推送通知功能，您的电子商务PWA看起来和感觉就像一个原生移动应用程序。</p><p id="3324" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">考虑到这些好处，大型行业参与者转向渐进式网络应用电子商务就不足为奇了。这里有几个电子商务的好例子:</p><ul class=""><li id="46c4" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke ly km kn ko dt translated"><a class="ae jg" href="https://m.flipkart.com/" rel="noopener ugc nofollow" target="_blank"> Flipkart </a></li><li id="35b1" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke ly km kn ko dt translated"><a class="ae jg" href="https://m.aliexpress.com/" rel="noopener ugc nofollow" target="_blank">全球速卖通</a></li><li id="7659" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke ly km kn ko dt translated">孔加</li><li id="c5e4" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke ly km kn ko dt translated">塞利奥</li></ul><p id="e0f0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">自己去看；这些移动商务体验是A1。</p><h1 id="24a0" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">为什么在这个PWA例子中使用Gatsby？</h1><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lz"><img src="../Images/dbecec1bcc70c0fed7abeecf0360e4b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*csF_KsUCY8pUKVgn.png"/></div></div></figure><p id="9881" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">简短的回答？因为Gatsby很容易迅速地将PWA的例子组合在一起。</p><p id="74da" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">通常作为React的静态站点生成器出现，实际上远不止如此。这是一个完整的现代网站框架，已经成为了JAMstack生态系统中开发者的最爱。</p><p id="1409" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">《盖茨比》的创作者凯尔·马修斯在<a class="ae jg" href="https://thenewstack.io/gatsbyjs-the-open-source-react-based-ssg-creates-company-to-evolve-cloud-native-website-builds/" rel="noopener ugc nofollow" target="_blank">接受新书库</a>采访时，解释了他的创意是如何融入PWA的:</p><blockquote class="ma mb mc"><p id="5ca8" class="jh ji kf jj b jk jl jm jn jo jp jq jr md jt ju jv me jx jy jz mf kb kc kd ke hn dt translated"><em class="hu">“谷歌做了很多关于如何制作快速网站的研究，PWA是这些模式的总称。所以有了盖茨比，我们就问自己，为什么不把这些模式，所有这些让网站快速发展的东西，烘焙成一个网站框架？”</em></p></blockquote><p id="6ebf" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在这篇文章的<a class="ae jg" href="https://www.gatsbyjs.org/blog/2017-09-13-why-is-gatsby-so-fast/" rel="noopener ugc nofollow" target="_blank">中，他解释了Gatsby是如何为你的网站充当</a><a class="ae jg" href="https://en.wikipedia.org/wiki/Compiler-compiler" rel="noopener ugc nofollow" target="_blank">元编译器</a>的，具有内置的——非可选的——性能优化。</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mg"><img src="../Images/a3f4ce914d104aa6973d934b8897d039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sdYXXHfOiPqU2Nt2.png"/></div></div></figure><p id="c278" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">所以Gatsby有很多“勾选”的PWA支持框，比如:</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff mh"><img src="../Images/e0339d74d4729729d220dbbda558d4c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/0*-B9hIRoNJKfdeKIm.png"/></div></figure><ul class=""><li id="95ac" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke ly km kn ko dt translated">它输出的文件是静态HTML，使您的电子商务内容易于搜索引擎抓取、索引和排序。有机流量是网上商店丰富的流量来源——对许多商店来说，这是他们的生命线。</li><li id="9fdf" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke ly km kn ko dt translated">它通过<a class="ae jg" href="https://www.gatsbyjs.org/packages/gatsby-plugin-offline/?=offline" rel="noopener ugc nofollow" target="_blank">这个插件</a>和<a class="ae jg" href="https://www.gatsbyjs.org/packages/gatsby-plugin-manifest/?=manifest" rel="noopener ugc nofollow" target="_blank">这个</a>的“添加到主屏幕”功能支持服务人员。</li></ul><p id="4ddb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">关于盖茨比令人印象深刻的特征的完整列表，请阅读本页。</p><h1 id="55bb" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">PWA示例:构建一个Gatsby电子商务渐进式web应用程序</h1><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff mi"><img src="../Images/fc8a8faf0e2f4801e5e1b6c3411d144c.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/0*8MzYPwMq-PLMB8CS.png"/></div></figure><p id="8ba6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个演示的一点背景:人类深陷僵尸启示录。互联网偶尔可用，但更多的时候，网络是关闭的。我们PWA的目标:</p><p id="1a93" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">1)提供有用的离线生存指南。 <br/> <strong class="jj hv"> 2)网络建立时提供可购买的生存装备。</strong></p><p id="80dd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="kf">先决条件</em></p><ul class=""><li id="2f70" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke ly km kn ko dt translated">对盖茨比JS的基本理解</li><li id="f87e" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke ly km kn ko dt translated"><a class="ae jg" href="https://app.snipcart.com/register" rel="noopener ugc nofollow" target="_blank">用Snipcart免费测试账户</a></li></ul><p id="8cd7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于这个演示，我将使用Ruben Harutyunyan的<a class="ae jg" href="https://github.com/Vagr9K/gatsby-material-starter" rel="noopener ugc nofollow" target="_blank">材质启动器</a>。它配备了所有需要的插件，使Gatsby PWA具有合理的默认配置。</p><p id="4ecd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">即:</p><ul class=""><li id="9c93" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke ly km kn ko dt translated"><code class="eh mj mk ml mm b">gatsby-plugin-manifest</code>允许在移动设备主屏幕上安装应用程序</li><li id="394e" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke ly km kn ko dt translated"><code class="eh mj mk ml mm b">gatsby-plugin-sharp</code>自动生成各种尺寸的图像</li><li id="e501" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke ly km kn ko dt translated"><code class="eh mj mk ml mm b">gatsby-plugin-offline</code>让服务人员离线使用你的应用</li></ul><p id="0ddf" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">它使用markdown文件作为内容源，使用<a class="ae jg" href="https://react-md.mlaursen.com/" rel="noopener ugc nofollow" target="_blank"> react-md </a>来提供一个基于Google的Material Design mobile style guide的组件。我还将展示一些技巧，让Snipcart优雅地处理不断变化的网络条件。</p><p id="1fac" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们从安装盖茨比和启动器开始。</p><ul class=""><li id="afe7" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke ly km kn ko dt translated">如果您还没有Gatsby cli，请安装它:</li></ul><p id="f917" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh mj mk ml mm b">npm install --global gatsby-cli</code></p><ul class=""><li id="39d1" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke ly km kn ko dt translated">创建项目:</li></ul><p id="5d22" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh mj mk ml mm b">gatsby new gatsby-pwa-demo <a class="ae jg" href="https://github.com/Vagr9K/gatsby-material-starter" rel="noopener ugc nofollow" target="_blank">https://github.com/Vagr9K/gatsby-material-starter</a></code></p><ul class=""><li id="2359" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke ly km kn ko dt translated">在项目的文件夹中启动开发服务器:</li></ul><p id="46e7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh mj mk ml mm b">cd gatsby-pwa-demo</code></p><p id="8c00" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh mj mk ml mm b">gatsby develop</code></p><h1 id="6b4b" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">响应性</h1><p id="b701" class="pw-post-body-paragraph jh ji hu jj b jk mn jm jn jo mo jq jr js mp ju jv jw mq jy jz ka mr kc kd ke hn dt translated">响应式网页设计并不新鲜。自从它出现以来，web开发社区积累了许多好的实践。</p><p id="3e91" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先，是你的PWA网站的布局。通过提供完全响应的页面，您将为购物者提供跨设备的更加一致的电子商务体验。为此，您可以使用像react-md这样的响应组件库，或者使用您的CSS技能从头开始创建它。</p><p id="5959" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Gatsby帮助您的地方是通过<code class="eh mj mk ml mm b">gatsby-plugin-sharp</code>提供响应性和优化的图像。它处理您的图像并生成不同的尺寸，供浏览器在<code class="eh mj mk ml mm b">srcset</code>属性中选择。所以只下载最适合当前屏幕尺寸的文件。</p><p id="0507" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">尽管如此，我还是建议尽可能使用<code class="eh mj mk ml mm b">.svg</code>图片。Web服务器可以很容易地压缩这种大小的格式，而且，因为它们是矢量格式，你只需要一个文件就可以缩放到任何大小。</p><h1 id="904e" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">离线功能</h1><p id="2e57" class="pw-post-body-paragraph jh ji hu jj b jk mn jm jn jo mo jq jr js mp ju jv jw mq jy jz ka mr kc kd ke hn dt translated">离线功能通常是PWAs的核心论点。虽然不是唯一的酷功能，但我不能在PWAs上写一篇不谈论它的帖子。而有了盖茨比，就像给你的<code class="eh mj mk ml mm b">gatsby-config.js</code>加上<code class="eh mj mk ml mm b">gatsby-plugin-offline</code>一样简单！</p><p id="5f95" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在引擎盖下，这使用了来自谷歌的<a class="ae jg" href="https://github.com/GoogleChromeLabs/sw-precache" rel="noopener ugc nofollow" target="_blank"> sw-precache </a>，一个生成服务工人的库，自动缓存你的网站文件供离线使用。</p><p id="aa2a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">服务工作者就像是在DOM上下文之外运行的后台任务，不会影响用户界面。它对于离线模式很有用，因为它可以拦截请求并拥有自定义的缓存逻辑。有了Gatsby，所有的HTML和JavaScript都被缓存，并在离线时从缓存中检索。</p><h1 id="f33e" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">类似应用的行为</h1><p id="c02a" class="pw-post-body-paragraph jh ji hu jj b jk mn jm jn jo mo jq jr js mp ju jv jw mq jy jz ka mr kc kd ke hn dt translated">渐进式web应用程序的一个很好的特性是能够使用Web应用程序代替本地移动应用程序，并让它以同样的方式运行。关于这个问题有很多观点——模仿原生应用的外观和感觉是好是坏。至少web技术给了你这种灵活性，而且<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/Manifest" rel="noopener ugc nofollow" target="_blank"> Web应用清单</a>允许你的应用在移动浏览器的UI之外独立存在。相当整洁！</p><p id="e659" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">自动生成该清单。您可以在<code class="eh mj mk ml mm b">gatsby-config.js</code>中自定义:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ms mt l"/></div></figure><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff mi"><img src="../Images/029a95485269a19f490641cc4c158b16.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/0*xJ8XtmGlv1hIPFcv.png"/></div></figure><p id="0751" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这些参数大多是应用程序的描述性或可视化细节。最有趣的是<code class="eh mj mk ml mm b">display: "standalone"</code>。这将使应用程序作为自己的窗口打开，没有浏览器导航选项。</p><p id="c636" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在某些情况下，浏览器可以自动提示用户将应用程序安装到他们的主屏幕上。您也可以通过<a class="ae jg" href="https://developers.google.com/web/fundamentals/app-install-banners/#trigger" rel="noopener ugc nofollow" target="_blank">手动触发</a>。如果你有本地版本的应用，有一个参数<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/Manifest#related_applications" rel="noopener ugc nofollow" target="_blank">指示浏览器推荐这些应用</a>。</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff mi"><img src="../Images/be9e4cee8a410334a9ca98075a7d1df9.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/0*Prqr9et4kwV5GR81.png"/></div></figure><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div class="fe ff mi"><img src="../Images/eb4a31daf5adf9c2bdd90a37baafd223.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/0*bTd-0GoGnZukPRCP.png"/></div></figure><h1 id="1b93" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">让购物车处理不断变化的网络条件</h1><p id="6099" class="pw-post-body-paragraph jh ji hu jj b jk mn jm jn jo mo jq jr js mp ju jv jw mq jy jz ka mr kc kd ke hn dt translated">对于这个PWA示例的电子商务功能，我将把我们自己的dev-first购物车平台Snipcart集成到应用程序中。</p><p id="48c6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="kf"> Snipcart的工作非常简单:你</em> <a class="ae jg" href="https://docs.snipcart.com/getting-started/installation" rel="noopener ugc nofollow" target="_blank"> <em class="kf">把需要的脚本</em> </a> <em class="kf">添加到你的站点，然后</em> <a class="ae jg" href="https://docs.snipcart.com/configuration/product-definition" rel="noopener ugc nofollow" target="_blank"> <em class="kf">直接在HTML中定义产品</em> </a> <em class="kf">。</em></p><p id="d08e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">服务工作者的缺点之一是他们只能缓存来自您的域的内容。因此，您必须为Snipcart使用另一种策略来处理连接丢失。</p><p id="d754" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先，只有当您可以访问互联网时，您才需要加载所需的资产。我在这里做了一点手脚，使用直接DOM操作将标签添加到页面的头部——无论您使用什么框架，您都可以修改它！</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ms mt l"/></div></figure><p id="ada7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">上面，我检查加载了什么文件，每次浏览器恢复在线时，我都要检查一遍。通过更多的事件，您可以在Snipcart尚未加载或脱机时处理添加到购物车中的产品:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ms mt l"/></div></figure><p id="757d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在这些事件处理程序中，我们维护一个要添加的产品队列。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ms mt l"/></div></figure><h1 id="5fa2" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">现场演示和GitHub回购</h1><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mu"><img src="../Images/d6a24142c97f08004b047b9195316f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8rgbQC3ZUYQeGOCR.png"/></div></div></figure><blockquote class="ma mb mc"><p id="e1c2" class="jh ji kf jj b jk jl jm jn jo jp jq jr md jt ju jv me jx jy jz mf kb kc kd ke hn dt translated"><a class="ae jg" href="https://snipcart.github.io/gatsby-pwa-demo/all-about-weapons" rel="noopener ugc nofollow" target="_blank"> <em class="hu">见现场演示</em> </a></p><p id="428d" class="jh ji kf jj b jk jl jm jn jo jp jq jr md jt ju jv me jx jy jz mf kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/snipcart/gatsby-pwa-demo" rel="noopener ugc nofollow" target="_blank"> <em class="hu">参见代码回购</em> </a></p></blockquote><h1 id="edbe" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">结论</h1><p id="ea11" class="pw-post-body-paragraph jh ji hu jj b jk mn jm jn jo mo jq jr js mp ju jv jw mq jy jz ka mr kc kd ke hn dt translated">盖茨比是一件非常聪明的工程作品。虽然它<em class="kf">没有</em>有一个学习曲线和棘手的调试，一旦你得到它，它是如此强大，你会很快爱上它。</p><p id="8038" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">制作这整个教程比我们通常的演示多花了我几天时间。我遇到了几个无法识别的GraphQL错误，<code class="eh mj mk ml mm b">gatsby build</code>命令曾经中途崩溃，没有返回错误代码。但是总的来说，我在这个PWA例子上有一个有趣的经历。</p><p id="361e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">当然，我不可能在一篇文章中涵盖所有可能的用例——在PWA的保护伞下有这么多了不起的特性。如果我有更多的时间，我会探索<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/API/notification" rel="noopener ugc nofollow" target="_blank">通知</a>和<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/API/Push_API" rel="noopener ugc nofollow" target="_blank">推送</a>API来提高移动应用程序的用户参与度。</p><p id="f26b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">希望你能从这篇文章中学到一些东西。我确实做了！:)</p><p id="b71d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">有意见或问题吗？点击下面的部分！</p></div><div class="ab cl mv mw hc mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hn ho hp hq hr"><p id="8fef" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="kf">我最初在</em> <a class="ae jg" href="https://snipcart.com/blog/pwa-example-ecommerce-gatsby" rel="noopener ugc nofollow" target="_blank"> <em class="kf"> Snipcart博客</em> </a> <em class="kf">上发表了这篇文章，并在</em> <a class="ae jg" href="http://snipcart.us5.list-manage2.com/subscribe?u=c019ca88eb8179b7ffc41b12c&amp;id=3e16e05ea2" rel="noopener ugc nofollow" target="_blank"> <em class="kf">我们的时事通讯</em> </a> <em class="kf">上分享了它。</em></p></div></div>    
</body>
</html>