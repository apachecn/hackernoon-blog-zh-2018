<html>
<head>
<title>Building Siri Shortcuts Using NSUserActivity in iOS 12</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在iOS 12中使用NSUserActivity构建Siri快捷方式</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-siri-shortcuts-using-nsuseractivity-in-ios-12-ff252339e98a?source=collection_archive---------10-----------------------#2018-07-25">https://medium.com/hackernoon/building-siri-shortcuts-using-nsuseractivity-in-ios-12-ff252339e98a?source=collection_archive---------10-----------------------#2018-07-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/f802636c9fc272d500beef7357a13098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CfiRPzkOMqHtPESAjFQScg.jpeg"/></div></div></figure><h2 id="85d7" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">更新:</h2><ul class=""><li id="a92a" class="ka kb hu kc b kd ke kf kg jn kh jr ki jv kj kk kl km kn ko dt translated"><a class="ae kp" rel="noopener" href="/@azamsharp/getting-started-with-siri-shortcuts-in-ios-12-using-intents-8206099aa5ce">第2部分—使用意图开始使用Siri快捷方式</a></li></ul><p id="60ad" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">在WWDC 2018上，苹果宣布了Siri <a class="ae kp" href="https://hackernoon.com/tagged/shortcuts" rel="noopener ugc nofollow" target="_blank">快捷方式</a>，它允许开发者建立体验，从他们的锁定屏幕上快速完成任务。用户将能够使用“<strong class="kc hv">快捷方式</strong>”应用程序管理第三方快捷方式，该应用程序将在<a class="ae kp" href="https://hackernoon.com/tagged/ios" rel="noopener ugc nofollow" target="_blank"> iOS </a> 12公开发布时推出。</p><p id="1091" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">在本帖中，我们将介绍如何使用NSUserActivity创建Siri快捷方式。如果你的快捷方式是用来打开已安装的应用程序，那么NSUserActivity是一个很好的选择。你也可以使用NSUserActivity来恢复应用的状态，<em class="lh">虽然这个功能目前在iOS 12 Beta 4 </em>中被破坏了。</p><h1 id="933f" class="li jd hu bd je lj lk ll ji lm ln lo jm lp lq lr jq ls lt lu ju lv lw lx jy ly dt translated">先决条件</h1><ul class=""><li id="286a" class="ka kb hu kc b kd ke kf kg jn kh jr ki jv kj kk kl km kn ko dt translated">iOS 12 Beta 4或以上版本</li><li id="1d36" class="ka kb hu kc b kd lz kf ma jn mb jr mc jv md kk kl km kn ko dt translated">Xcode 10 Beta 4</li></ul><h1 id="6afe" class="li jd hu bd je lj lk ll ji lm ln lo jm lp lq lr jq ls lt lu ju lv lw lx jy ly dt translated">履行</h1><p id="7e6f" class="pw-post-body-paragraph kq kr hu kc b kd ke kt ku kf kg kw kx jn me kz la jr mf lc ld jv mg lf lg kk hn dt translated">在Xcode中创建新的单视图应用程序项目，并将其命名为“<strong class="kc hv"> HotCoffee </strong>”。HotCoffee应用程序将负责在您需要时为我们订购热咖啡。用户界面的设计完全取决于你，我们采取了最简单的方法，如下所示。</p><figure class="mi mj mk ml fq iv fe ff paragraph-image"><div class="fe ff mh"><img src="../Images/f6b30ee5c0689cfe1181bb44af243f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*TG8iDzfEsjmBsDc-oEUfzA.png"/></div></figure><p id="ed6f" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">为了让Siri了解我们喝咖啡的行为，我们需要将我们的活动捐赠给Siri。在我们的场景中，捐赠活动的最佳时间是下订单的时候。以下代码用于捐赠您的活动。</p><figure class="mi mj mk ml fq iv"><div class="bz el l di"><div class="mm mn l"/></div></figure><p id="9acb" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">我们从创建订单活动开始。这是通过使用NSUserActivity类并将活动类型作为字符串传递来实现的。现在不要担心活动类型，我们稍后会看到在哪里声明它。</p><p id="4925" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">接下来，我们确保我们的活动符合搜索条件和预测条件。这将有助于Siri更多地了解我们的活动。我们使用<strong class="kc hv"> title </strong>属性设置快捷方式的标题。<strong class="kc hv">suggestedInvocationPhrase</strong>用于给用户一个想法，告诉他们应该为Siri语音快捷方式设置什么短语。</p><p id="f124" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">如果你想从你的活动中传递额外的信息到iOS应用程序，你可以把这些信息放在userInfo属性中。<em class="lh">在Xcode 10 Beta 4中，userInfo属性不起作用，总是返回空字典</em>。</p><p id="55d1" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">最后，您可以将视图控制器的userActivity属性设置为orderActivity，并将其标记为当前属性。</p><p id="4a2a" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">在运行您的iOS应用程序并捐赠活动之前，让我们确保在info.plist文件中设置活动类型属性。添加一个新节点“<strong class="kc hv"> NSUserActivityTypes </strong>”，如下图所示。</p><figure class="mi mj mk ml fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mo"><img src="../Images/7690f5272b75b0d36f085278aff3d56a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fesHkkzdggr2Ki62c2NewQ.png"/></div></div></figure><p id="40e2" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">最后一件事！我保证:)</p><p id="2eed" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">启动模拟器，进入<strong class="kc hv">设置- &gt;开发者</strong>，向下滚动，确保“<strong class="kc hv">快捷方式测试</strong>下的两个选项都已启用。</p><figure class="mi mj mk ml fq iv fe ff paragraph-image"><div class="fe ff mp"><img src="../Images/f55ccf9a10eadc160a24906d922bb80e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*Epcg5jnC24PGqzYYdXndtg.png"/></div></figure><p id="7534" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">厉害！现在您可以运行您的应用程序并下订单了。一旦您下订单，活动就会被捐赠，并且由于开发者快捷方式测试选项已启用，您将能够在Siri建议下看到您的活动(只需从顶部向下滑动，使您的搜索栏可见)。</p><figure class="mi mj mk ml fq iv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/94e6351297818adddfb303a2a70a34f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*VTQaCOePYlUxu-d5wOE6Dw.png"/></div></figure><p id="42c7" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">恭喜你创建了第一个Siri快捷方式:)</p><p id="6ff2" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">您也可以将此快捷键添加为Siri语音快捷键。为此，在模拟器中打开<strong class="kc hv">设置</strong>应用，然后选择<strong class="kc hv"> Siri </strong>。您应该会在快捷方式部分看到您的快捷方式列表。只需按下“+”按钮，将您的快捷方式添加为Siri语音快捷方式。这意味着您只需使用Siri语音就可以启动快捷方式。</p><figure class="mi mj mk ml fq iv fe ff paragraph-image"><div class="fe ff mr"><img src="../Images/df8e9080a798c6353b9920e1fdc20b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*dk8ZEJO5yN-DzOriLzF2-w.png"/></div></figure><p id="0bad" class="pw-post-body-paragraph kq kr hu kc b kd ks kt ku kf kv kw kx jn ky kz la jr lb lc ld jv le lf lg kk hn dt translated">如果你喜欢这篇文章，并想了解更多关于Siri快捷方式的知识，那么请查看我的3个多小时Udemy课程“<a class="ae kp" href="https://www.udemy.com/mastering-siri-shortcuts-for-ios/?couponCode=SIRIFORMED" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hv">在iOS中掌握Siri快捷方式</strong> </a>”。该课程更详细地介绍了如何使用NSUserActivity、Intents、自定义响应、自定义用户界面等创建Siri快捷方式。</p><div class="ms mt fm fo mu mv"><a href="https://www.udemy.com/mastering-siri-shortcuts-for-ios/?couponCode=SIRIFORMED" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab ej"><div class="mx ab my cl cj mz"><h2 class="bd hv fv z el na eo ep nb er et ht dt translated">在iOS | Udemy中掌握Siri快捷键</h2><div class="nc l"><h3 class="bd b fv z el na eo ep nb er et ek translated">用快捷方式简化你经常做的事情</h3></div><div class="nd l"><p class="bd b gc z el na eo ep nb er et ek translated">www.udemy.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj ja mv"/></div></div></a></div><figure class="mi mj mk ml fq iv"><div class="bz el l di"><div class="nk mn l"/></div></figure></div></div>    
</body>
</html>