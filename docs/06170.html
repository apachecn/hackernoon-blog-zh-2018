<html>
<head>
<title>Tracing services with Istio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Istio追踪服务</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/tracing-services-with-istio-e51d249da60c?source=collection_archive---------21-----------------------#2018-07-25">https://medium.com/hackernoon/tracing-services-with-istio-e51d249da60c?source=collection_archive---------21-----------------------#2018-07-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="1d42" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">超级快速post，当istio将envoy容器端car注入到您的pod中时，每个进出的请求都“附加”了一些http头，然后它们用于跟踪。</p><p id="de3b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是istio采用的“侧车注入”方法的众多好处之一，虽然有点侵入性，但迄今为止似乎效果不错。</p><p id="126b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好的，你可以通过在图表上启用它来快速部署jaeger和zipkin:</p><div class="jp jq fm fo jr js"><a href="https://github.com/istio/istio/blob/master/install/kubernetes/helm/istio/values.yaml#L415" rel="noopener  ugc nofollow" target="_blank"><div class="jt ab ej"><div class="ju ab jv cl cj jw"><h2 class="bd hv fv z el jx eo ep jy er et ht dt translated">istio/istio</h2><div class="jz l"><h3 class="bd b fv z el jx eo ep jy er et ek translated">istio -连接、管理和保护微服务的开放平台。</h3></div><div class="ka l"><p class="bd b gc z el jx eo ep jy er et ek translated">github.com</p></div></div></div></a></div><p id="9832" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以防你还没有启用它。</p><p id="6451" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">然后，如果你稍微看一下图表，你会发现这样的参考:</p><figure class="kc kd ke kf fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff kb"><img src="../Images/3966b9fca2ae00c1366f0018f7b09b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IeIAfZClvqJHvDkXTulDrg.png"/></div></div></figure><p id="0071" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">那是从mixer来的，所以不需要太多的挖掘，你就可以看到mixer是如何将统计数据传递给zipkin的，记住Mixer可以看到一切。</p><p id="86d4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以如果我们转到耶格正在监听的地方:</p><pre class="kc kd ke kf fq kn ko kp kq aw kr dt"><span id="62ee" class="ks kt hu ko b fv ku kv l kw kx">kubectl port-forward -n istio-system istio-tracing-754cdfd695-ngssw 16686:16686</span></pre><p id="3d4a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们点击<code class="eh ky kz la ko b">http://localhost:16686</code>，我们会找到耶格:</p><figure class="kc kd ke kf fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff lb"><img src="../Images/c0347fb3594cbaa3e5b9b56b6e47ab69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5KEKom5j8tyagFVdSIGWlw.png"/></div></div></figure><p id="439f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这对于跟踪和了解可能需要很长时间来处理的服务非常有趣，我强制输入了一个错误，看起来像这样:</p><figure class="kc kd ke kf fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff lc"><img src="../Images/a9f718e51a77ebf5e4042f5e4cb4d67b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gECzUb6Hh5QjxK0-ueYT8g.png"/></div></div></figure><p id="0b98" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果pod <code class="eh ky kz la ko b">nginx</code>将调用额外的服务，它们也应该显示在那里，<strong class="it hv">因为记住所有的入口/出口流量都由pod内的特使边车捕获。</strong></p></div></div>    
</body>
</html>