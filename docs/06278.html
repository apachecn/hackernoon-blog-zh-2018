<html>
<head>
<title>30 Shared Principles for discussing Software Architectures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">讨论软件架构的30个共享原则</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/first-do-no-harm-30-principles-that-helped-me-avoid-fly-by-architecture-reviews-e8952ac632a?source=collection_archive---------0-----------------------#2018-07-29">https://medium.com/hackernoon/first-do-no-harm-30-principles-that-helped-me-avoid-fly-by-architecture-reviews-e8952ac632a?source=collection_archive---------0-----------------------#2018-07-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/49d71c5b29835e57d1e7c58cf354d642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Fjhe9FlqQQRY91QTi1Cuw.jpeg"/></div></div></figure><p id="a520" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">想象一次飞越式架构审查。一个建筑师走进来，看了看，掩饰了一下，用双筒望远镜看了看。他提供的评论通常过于笼统或者脱离了上下文。评论经常遇到震耳欲聋的沉默或曲折的争论。他们很少帮助任何人。每个程序员都害怕它；每个建筑师也害怕它。</p><p id="e429" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">据说软件架构师应该像园丁而不是指挥官一样思考。前者塑造、管理和清除杂草，而后者定义和规定。建筑师应该策划而不是发号施令，塑造而不是定义，引发讨论而不是贴标签。但是，如何让它发挥作用呢？</p><p id="26e8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在WSO2，我做了八年多的架构评审。WSO2拥有广泛的产品组合，包括众所周知的<a class="ae ka" href="https://wso2.com/integration" rel="noopener ugc nofollow" target="_blank"> WSO2 ESB </a>、<a class="ae ka" href="https://wso2.com/api-management/" rel="noopener ugc nofollow" target="_blank"> WSO2 API Manager </a>和<a class="ae ka" href="https://wso2.com/analytics" rel="noopener ugc nofollow" target="_blank"> WSO2 SP </a>。在过去的八年里，我们讨论、设计、改进和重新设计了许多产品和功能。</p><p id="e864" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们设计过程的一个关键部分是建筑不是由建筑师完成的。我们没有一组架构师来指定架构蓝图，由其他人来实现。相比之下，设计是由编写代码的团队完成的。建筑师修正、抱怨、策划和改进设计。我们有一个架构团队，但他们是向导和看门人，而不是独裁者。</p><p id="c8a2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在接下来的演讲中，Gregor Hohpe很好地抓住了这个观点。</p><p id="d248" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ka" href="https://www.youtube.com/watch?v=qVyt3qQ_7TA[/embed" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=qVyt3qQ_7TA</a></p><p id="58af" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从短期来看，指定一个架构更快，甚至可能更便宜。是真的。然而，从长远来看，我们通过让他们自己思考，让他们进化架构，有时让他们犯自己的错误，来建立更好的团队。当我们专注于团队时，他们会随着时间变得更好。执行变得更容易，因为架构首先是团队的想法。</p><p id="875d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然而，架构审查也有其缺陷。Paul ( <a class="ae ka" href="http://twitter.com/pzfreo" rel="noopener ugc nofollow" target="_blank"> @pzfreo </a>)曾经称这种建筑驱动力为建筑师走进去，倾听，评论，然后继续前进。作为一名建筑师，你可以很容易地检查、抱怨和拆开设计。然而，如果你不小心，你可能会让团队不知所措，不知道该做什么。</p><p id="13cc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们通过共享架构原则的列表来解决这个问题。这些是每个人都同意的原则。架构师给出反馈说，由于委托人x，这样不好。原则指导我们，并使我们的讨论扎根。他们也避免无休止的哲学争论。最后，如果设计者从未听说过该原理，他很容易学会。</p><p id="a2cb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">以下是其中的一些原则。有些是众所周知的，而有些是我们通过艰苦的努力才获得的。</p><h1 id="08e6" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">基础</h1><p id="7ba0" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><strong class="je hv">原则一:</strong> <a class="ae ka" href="https://people.apache.org/~fhanik/kiss.html" rel="noopener ugc nofollow" target="_blank">亲吻(保持简单)</a>以及“一切都要尽可能简单但不能更简单。”这个想法是使用最简单的解决方案。</p><p id="33cd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则2:</strong><a class="ae ka" href="http://martinfowler.com/bliki/Yagni.html" rel="noopener ugc nofollow" target="_blank">【YAGNI】(<em class="le">你不会需要它)</em></a><em class="le">——</em>不到需要的时候，不要建造它。</p><p id="7f4e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原理三:</strong>爬，走，跑。换句话说，让它工作，让它变得更好，让它变得伟大。进行迭代开发——进行敏捷的迭代开发。对于每个特性，创建里程碑(最多2周)并迭代。</p><p id="cc95" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">原则4: 构建稳定、高质量产品的唯一方法是通过自动化测试。自动化测试要有创造性；一切都可以自动化！！设计的时候想想这个。</p><p id="2ef9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则5: </strong>始终考虑投资回报(ROI)，投入最多的注意力以产生最大的影响。</p><p id="2d27" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则6: </strong>了解你的用户，并据此平衡你的努力。对于大多数产品来说，会有成千上万的最终用户，20个开发人员来扩展产品，100个开发人员来建立产品。例如，不要花几个月的时间为不太可能使用它的开发者构建UI(他们喜欢脚本！而是)。这是原则5的特例。</p><p id="5ac4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">原则7: 尽可能独立地设计和测试特性。设计的时候想想这个。从长远来看，这将省去很多麻烦，否则在所有东西都构建好之前，你无法测试系统。同样，有了这个原则，你的发布会更顺利。</p><p id="7e9a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则八:</strong>望风谷歌羡慕。我们都喜欢闪亮的设计。很容易将您永远不需要的特性和解决方案引入到您的架构中。</p><h1 id="0b0f" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">选择功能</h1><p id="70f8" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><strong class="je hv">原则9: </strong>想透用户会如何充分使用我们的产品是不可能的。所以拥抱MVP(最小可行产品)。这个想法是找出几个用例，只做支持这些用例的特性，交付产品，并根据反馈和经验塑造未来的产品。</p><p id="05b0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">原则10: 尽可能少做一些功能，如果有疑问，就把它删掉。许多特性从未被使用过，也许你应该留下一个扩展点。</p><p id="4744" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则11: </strong>等待别人提出要求(例如，不妨碍交易的特性，等到需要的时候)</p><p id="a9e2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则12: </strong>如果客户要求的功能搞乱了大局，要有勇气与客户抗争。找出更大的图景，试着找到处理这个问题的另一种方法。记得福特的名言“如果我问人们想要什么，他们会说是更快的马。”另外，记住你是专家。你应该领导。领导者的工作是做正确的事，而不是流行的事。用户以后会感谢你的。</p><h1 id="8563" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">服务器设计和并发</h1><p id="94d0" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><strong class="je hv">原则13: </strong>从硬件、操作系统到你的编程语言，了解服务器是如何工作的。优化IO调用的数量是通向最佳架构的第一盏指路明灯。</p><p id="a48d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原理14: </strong>知道阿姆达尔关于同步的定律。线程间共享的可变数据会降低程序速度。尽可能使用并发数据结构，只有在必要时才使用同步。尽可能短时间地保持锁定。如果你打算在持有锁的时候阻塞，确保你知道你在做什么。能破就破。</p><p id="a144" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则15: </strong>如果你的设计是基于非阻塞、事件驱动的架构，那么永远不要阻塞线程或者从那些线程做IO。如果你这样做，系统会像骡子一样慢。</p><h1 id="a6e5" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated"><strong class="ak">分布式系统</strong></h1><p id="a51b" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><strong class="je hv">原则16: </strong>无状态系统是可伸缩且简单明了的。尽可能了解并使用<a class="ae ka" href="https://en.wikipedia.org/wiki/Shared-nothing_architecture" rel="noopener ugc nofollow" target="_blank">无共享架构</a>。</p><p id="136d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">原则17: 除非你同时控制客户端和服务器端的代码，否则不管失败与否，都很难精确地传递一次消息。试着将你的系统设计得更少(例如使用原则18)。知道大多数承诺一次送达的系统在某处偷工减料。</p><p id="2f82" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则18: </strong>尽可能将运算实现为幂等运算。然后就很容易恢复，至少一次分娩就可以生活。</p><p id="5986" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原理19: </strong>知道CAP定理。扩大交易规模很难。尽可能使用补偿。基于RDBMS的事务不可伸缩。</p><p id="fc3c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则20: </strong>分布式共识不可扩展，群组通信也不可扩展，集群范围的可靠消息传递也不可扩展。两者的最大节点限制都是一天8个节点左右。</p><p id="1844" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">原则21: 你永远无法隐藏分布式系统中的延迟和故障。(参见<a class="ae ka" href="https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing" rel="noopener ugc nofollow" target="_blank">分布式计算的谬误解释</a>)。</p><h1 id="4927" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated"><strong class="ak">用户体验</strong></h1><p id="2c77" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated"><strong class="je hv">原则22: </strong>了解你的用户，知道他们的目标:他是新手、专家，还是临时用户？他对计算机科学了解多少？极客喜欢扩展点，开发者喜欢样本和脚本，普通人喜欢ui。</p><p id="ceb4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则23: </strong>最好的产品不需要说明书。其用途不言而喻。</p><p id="491f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则24: </strong>当你无法在两个选择之间做出决定时，不要把问题变成一个配置选项。你让用户和解决方案架构师的日子不好过了。他们对系统如何运作的了解甚至比你还少，他们怎么能决定呢？最好的选择是找到一个每次都有效的选择；第二好的方法是自动做出选择，第三好的方法是添加一个配置参数并设置一个合理的默认值。</p><p id="5c13" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则25: </strong>始终为配置提供合理的默认值。</p><p id="d0c1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则26: </strong>设计不良的配置会造成很多混乱。始终记录一些配置的示例值。</p><p id="bb08" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则27: </strong>询问配置值，用户无需进行计算就可以立即回答(例如，不要询问最大缓存条目数，而是询问应该用于缓存的最大内存)</p><p id="b1b8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">原则28: </strong>看到未知配置抛出错误。千万不要默默忽视。静默配置错误是调试时许多时间损失的来源。</p><h1 id="df9b" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">难题</h1><p id="e0dc" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">原则29: 想出新的语言很容易，但掌握它们却很难。除非团队能在这上面花费至少10个人年的时间，否则尽量不要做。如果你还不确定，那就看看<a class="ae ka" href="http://www.paulgraham.com/langdes.html" rel="noopener ugc nofollow" target="_blank">关于语言设计的五个问题</a>。</p><p id="b647" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">原则30: 可组合的拖放ui很难，除非团队准备投入十年的时间，否则不要创建。</p><p id="0d3b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，让我谈谈我随着时间的推移而改变想法的一些事情。在理想情况下，平台必须由正交的组件组成，每个组件处理一个方面(例如，安全性、消息传递、注册、中介、分析)。具有这些特征的系统将是最佳的。</p><p id="8604" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">不幸的是，很难达到那种状态。呆在那里甚至很难。严格执行这一点可能是错误的，特别是在新功能的初始阶段，简单的功能可能会级联成大的变化，因为我们试图让一切正交。有时候，我们发现我们添加的功能根本没有用，然后所有额外的工作都白费了。最后，如果这导致了多个团队之间的协商，那么这个特性可能永远也完成不了。</p><p id="ca4c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">事后看来，当试图消除导致严重复杂性的重复时，我愿意忍受重复。治疗可能比疾病更糟糕。</p><h1 id="d03d" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">结论</h1><p id="d827" class="pw-post-body-paragraph jc jd hu je b jf kz jh ji jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz hn dt translated">作为建筑师，应该像园丁一样思考，他塑造、管理和清除杂草，而不是定义和建造。你应该策划而不是发号施令，塑造而不是定义，引发讨论而不是贴标签。虽然短期来看，指定架构可能更便宜、更容易，但从长远来看，指导团队并让他们找到自己的路是有回报的。</p><p id="08f4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你不小心，这是更容易做到的飞行由架构，设计师只告诉他的架构是错误的，但没有为什么它是错误的。避免这种情况的一个方法是拥有一套被普遍接受的原则，这些原则成为讨论的基础，也是崭露头角的架构师的学习途径。</p><p id="4c5b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们讨论了一些帮助我应对挑战的原则。以下是总结。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lf"><img src="../Images/9e4cda4eb4e42d7f9f48725e92532dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sVbG7e6LmlaBohy6V0y0IQ.png"/></div></div></figure><p id="4cac" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你能想到任何其他人，我会很高兴通过评论听到他们。</p><p id="5ff7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">希望这有用。如果你喜欢这篇文章，你可能也会喜欢<a class="ae ka" rel="noopener" href="/systems-architectures/walking-the-microservices-path-towards-loose-coupling-few-pitfalls-4067bf5e497a"> <em class="le">掌握微服务架构中的4种平衡行为</em> </a>和<a class="ae ka" rel="noopener" href="/@srinathperera/concurrency-ideologies-of-programming-languages-java-c-c-c-go-and-rust-bd4671d943f."><em class="le">Java、C#、C、C++、Go和Rust </em> </a>的并发思想。</p></div></div>    
</body>
</html>