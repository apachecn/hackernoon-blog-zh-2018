<html>
<head>
<title>AI which classifies Sounds:Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对声音进行分类的人工智能:代码</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/ai-which-classifies-sounds-code-python-6a07a2043810?source=collection_archive---------3-----------------------#2018-07-29">https://medium.com/hackernoon/ai-which-classifies-sounds-code-python-6a07a2043810?source=collection_archive---------3-----------------------#2018-07-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/a04aa44a80a2c71075b03ac05b23da82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TRurXpWTjfLg-oDzamHApA.jpeg"/></div></div></figure><p id="fed6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我写过一些文章，可以对不同类型的图像进行分类，例如:</p><div class="ka kb fm fo kc kd"><a href="https://towardsdatascience.com/iris-genus-classification-deepcognition-azure-ml-studio-4b930f54435a" rel="noopener follow" target="_blank"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hv fv z el ki eo ep kj er et ht dt translated">鸢尾属分类|DeepCognition| Azure ML studio</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">界:植物界分支:被子植物目:天冬目:鸢尾科亚科:环烯醚萜族:环烯醚萜属:鸢尾</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">towardsdatascience.com</p></div></div><div class="km l"><div class="kn l ko kp kq km kr ja kd"/></div></div></a></div><div class="ka kb fm fo kc kd"><a rel="noopener follow" target="_blank" href="/coinmonks/how-good-is-your-selfie-26c173d84552"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hv fv z el ki eo ep kj er et ht dt translated">“你的”自拍有多好？</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">看看你的自拍有多棒吧！</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">medium.com</p></div></div><div class="km l"><div class="ks l ko kp kq km kr ja kd"/></div></div></a></div><div class="ka kb fm fo kc kd"><a href="https://hackernoon.com/ai-classifies-15000-years-old-animal-dog-the-easiest-way-cd6619cd4d59" rel="noopener  ugc nofollow" target="_blank"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hv fv z el ki eo ep kj er et ht dt translated">如何制作对狗品种进行分类的AI，DeepLearningStudio</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">爱狗？</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">hackernoon.com</p></div></div><div class="km l"><div class="kt l ko kp kq km kr ja kd"/></div></div></a></div><p id="4953" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者..比如使用RNNs生成故事…</p><div class="ka kb fm fo kc kd"><a href="https://hackernoon.com/generate-stories-using-rnns-pure-mathematics-with-code-cb6f1e967b22" rel="noopener  ugc nofollow" target="_blank"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hv fv z el ki eo ep kj er et ht dt translated">使用RNNs生成故事|带代码的纯数学|:</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">嗨读者！</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">hackernoon.com</p></div></div><div class="km l"><div class="ku l ko kp kq km kr ja kd"/></div></div></a></div><p id="5b7a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以我想写一篇文章，解释如何使用人工智能对不同的声音进行分类。</p><p id="b811" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在本文中，我们将了解如何为声音分类准备数据集，以及如何将其用于我们的深度学习模型。</p><blockquote class="kv kw kx"><p id="de47" class="jc jd ky je b jf jg jh ji jj jk jl jm kz jo jp jq la js jt ju lb jw jx jy jz hn dt translated"><strong class="je hv">数据集:</strong></p></blockquote><p id="8e29" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将使用来自<strong class="je hv">城市声音分类挑战赛</strong>的数据集。这个数据集<strong class="je hv">由来自10个不同来源</strong>的8700多段声音组成。“wav”格式。</p><p id="3c39" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">声音来源:</p><ul class=""><li id="1198" class="lc ld hu je b jf jg jj jk jn le jr lf jv lg jz lh li lj lk dt translated">空调设备</li><li id="9b35" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">汽车喇叭</li><li id="b363" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">玩耍的孩子</li><li id="9bd6" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">狗吠声</li><li id="1cdc" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">演练</li><li id="b54a" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">发动机空转</li><li id="3c57" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">枪击</li><li id="b22a" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">手提气锤</li><li id="8ac4" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">汽笛</li><li id="f7fd" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">街头音乐</li></ul><p id="5373" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个数据集的大小约为5.6GB，这让我有点不愿意在其上训练模型。所以我写了一个python脚本，可以用来减少数据集的大小。基本上，该数据集包含来自每个来源的大约600个声音摘录。我已经将它们减少到170个，使数据集大约为1.1GB。</p><div class="ka kb fm fo kc kd"><a href="https://github.com/Manik9/Urban-Sound" rel="noopener  ugc nofollow" target="_blank"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hv fv z el ki eo ep kj er et ht dt translated">manik 9/城市声音</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">使用神经网络的城市声音分类</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">github.com</p></div></div><div class="km l"><div class="lq l ko kp kq km kr ja kd"/></div></div></a></div><blockquote class="kv kw kx"><p id="9bd9" class="jc jd ky je b jf jg jh ji jj jk jl jm kz jo jp jq la js jt ju lb jw jx jy jz hn dt translated"><strong class="je hv">训练程序的平台</strong></p></blockquote><p id="a7b3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">训练深度学习模型等需要高计算能力的程序，我更喜欢使用深度学习工作室(DLS)的jupyter笔记本。它为亚马逊深度学习实例提供了GPU，可用于训练模型。</p><p id="874b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">看看这里。</p><div class="ka kb fm fo kc kd"><a href="https://deepcognition.ai/" rel="noopener  ugc nofollow" target="_blank"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hv fv z el ki eo ep kj er et ht dt translated">主页</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">我们想邀请您在3月26日至29日的GPU技术大会上加入Deep Cognition的团队，展位号为1035…</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">deepcognition.ai</p></div></div><div class="km l"><div class="lr l ko kp kq km kr ja kd"/></div></div></a></div><blockquote class="kv kw kx"><p id="9882" class="jc jd ky je b jf jg jh ji jj jk jl jm kz jo jp jq la js jt ju lb jw jx jy jz hn dt translated"><strong class="je hv">上传数据集</strong></p></blockquote><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ls"><img src="../Images/193e4fabf4d88bf63bec7ed1652f7be3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sf2uApfOJdXGtQILvxBWPA.png"/></div></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek"><strong class="bd mb">Upload the ‘Urban sound’ dataset in datasets folder</strong></figcaption></figure><blockquote class="kv kw kx"><p id="f342" class="jc jd ky je b jf jg jh ji jj jk jl jm kz jo jp jq la js jt ju lb jw jx jy jz hn dt translated"><strong class="je hv">启动DLS的jupyter笔记本</strong></p></blockquote><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mc"><img src="../Images/e43503e31ffebf4822a07484c74907b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E-sBSaGytOYgDzg2DQ2lcw.png"/></div></div></figure><blockquote class="kv kw kx"><p id="d5d6" class="jc jd ky je b jf jg jh ji jj jk jl jm kz jo jp jq la js jt ju lb jw jx jy jz hn dt translated"><strong class="je hv">音频处理</strong></p></blockquote><p id="c2d3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于图像，我们通常将像素值传递给模型。在音频的情况下，我们也需要传递某种代表音频的数值。</p><p id="a1fc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">librosa是python中的一个库，可用于音频预处理。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="md me l"/></div></figure><ul class=""><li id="7930" class="lc ld hu je b jf jg jj jk jn le jr lf jv lg jz lh li lj lk dt translated">第1行:train.csv包含每首歌曲的位置及其标签。</li><li id="4e63" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">第7行:特定歌曲的文件名。</li><li id="2a51" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">第8行:“x”是歌曲,“s”代表采样率，即librosa读取歌曲的速率。</li><li id="ab14" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">第9行:多氯联苯:</li></ul><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ls"><img src="../Images/17838008b76400cdbbb509f5040773d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rUCCELGXvhJX32NODgh_Sw.png"/></div></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek">source: <strong class="bd mb">Wikipedia</strong></figcaption></figure><ul class=""><li id="7ab7" class="lc ld hu je b jf jg jj jk jn le jr lf jv lg jz lh li lj lk dt translated">第17行:函数“parser”应用于“train”数据帧中的每一行，结果存储在“temp”中。</li><li id="1004" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">在所有上述步骤之后，我们有了一个数据帧‘temp ’,它用一些数值来表示我们的每首歌曲(逐行)。</li><li id="b953" class="lc ld hu je b jf ll jj lm jn ln jr lo jv lp jz lh li lj lk dt translated">将输出转换为一键编码</li></ul><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="md me l"/></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek"><strong class="ak">Labels to One-Hot encoding</strong></figcaption></figure><blockquote class="kv kw kx"><p id="0e29" class="jc jd ky je b jf jg jh ji jj jk jl jm kz jo jp jq la js jt ju lb jw jx jy jz hn dt translated"><strong class="je hv">模型架构</strong></p></blockquote><p id="beb5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">每个示例包含40列，即(1x40)。所以1150的例子包含1150x40。将此转置传递给模型。</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mf"><img src="../Images/792b51014daa0178757ddde844cfb6d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AWOWKbPQblqaDEZ1KFesUQ.png"/></div></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek"><strong class="bd mb">Architecture of our model</strong></figcaption></figure><p id="3146" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们得到一个1x10的输出，代表每个类的分数</p><h2 id="d2e5" class="mg mh hu bd mi mj mk ml mm mn mo mp mq jn mr ms mt jr mu mv mw jv mx my mz na dt translated">下面的代码复制了上面显示的架构。</h2><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="md me l"/></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek"><strong class="ak">model architecture</strong></figcaption></figure><ul class=""><li id="cab6" class="lc ld hu je b jf jg jj jk jn le jr lf jv lg jz lh li lj lk dt translated">第26行涉及不同声音类别的数量。</li></ul><blockquote class="kv kw kx"><p id="f221" class="jc jd ky je b jf jg jh ji jj jk jl jm kz jo jp jq la js jt ju lb jw jx jy jz hn dt translated"><strong class="je hv">训练</strong></p></blockquote><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="md me l"/></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek"><strong class="ak">Training the model</strong></figcaption></figure><p id="df6b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">100个时期后:</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nb"><img src="../Images/513a347ca25a6146fa91d52c5a87c936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIjnoACpC1OlKriLDRfpKg.png"/></div></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek"><strong class="bd mb">Training Results</strong></figcaption></figure><p id="9904" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们训练的模型在验证集上获得了83.04%的准确率，这是非常好的，因为我们甚至将数据集的大小减少到(1/3)rd。我们仍然可以通过使用CNN来提高这个模型的准确性。我们将在另一篇文章中看到。</p><p id="8af4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">感谢阅读</strong>😄</p><p id="1487" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你喜欢这篇文章呢👏分享这个。在LinkedIn和Medium上关注我</p><div class="ka kb fm fo kc kd"><a href="https://www.linkedin.com/in/maniksoni" rel="noopener  ugc nofollow" target="_blank"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hv fv z el ki eo ep kj er et ht dt translated">Manik Soni -机器学习实习生-Ace2three.com印度信息技术有限公司负责人| LinkedIn</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">查看Manik Soni在全球最大的职业社区LinkedIn上的个人资料。Manik有3个工作列在他们的…</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">www.linkedin.com</p></div></div><div class="km l"><div class="nc l ko kp kq km kr ja kd"/></div></div></a></div><div class="ka kb fm fo kc kd"><a rel="noopener follow" target="_blank" href="/@maniksoni653/"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hv fv z el ki eo ep kj er et ht dt translated">马尼克索尼培养基</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">阅读媒介上的Manik Soni的作品。机器学习研究员。每天，Manik Soni和成千上万的其他人…</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">medium.com</p></div></div><div class="km l"><div class="nd l ko kp kq km kr ja kd"/></div></div></a></div></div></div>    
</body>
</html>