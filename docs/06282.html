<html>
<head>
<title>Learn deep learning with GPU enabled kaggle kernels and fastai MOOC</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">借助支持GPU的kaggle内核和fastai MOOC学习深度学习</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/learn-deep-learning-with-gpu-enabled-kaggle-kernels-and-fastai-mooc-72fee41bb4b5?source=collection_archive---------4-----------------------#2018-07-29">https://medium.com/hackernoon/learn-deep-learning-with-gpu-enabled-kaggle-kernels-and-fastai-mooc-72fee41bb4b5?source=collection_archive---------4-----------------------#2018-07-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="d50a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">深度学习民主化的最大障碍之一是需要一个T2图形处理器加速环境。如果我们想花时间有效地测试和学习问题陈述，我们需要一个基于GPU的服务器。但是这些跨平台的基于GPU的环境(GCP、AWS、Azure、Paper-space、floydhub)可能会让你花费大约0.60美元到1.5美元之间的任何东西。这一成本与存储成本结合在一起，如果我们使用持久的实例，可能会增加我们钱袋的负担。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="ab fr cl jv"><img src="../Images/aed9d6a947aab168c1892fcc8c430026.png" data-original-src="https://miro.medium.com/v2/format:webp/1*O6BWOmzibWC-q1iPXyYE5w.jpeg"/></div><figcaption class="jy jz fg fe ff ka kb bd b be z ek">picked up from slav’s blog <a class="ae jp" href="https://blog.slavv.com/learning-machine-learning-on-the-cheap-persistent-aws-spot-instances-668e7294b6d8" rel="noopener ugc nofollow" target="_blank">https://blog.slavv.com/learning-machine-learning-on-the-cheap-persistent-aws-spot-instances-668e7294b6d8</a></figcaption></figure><p id="c148" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">客观地看，根据最近的估计，2013年，10.7%的世界人口每天的生活费不到1.9美元(http://www.worldbank.org/en/topic/poverty/overvie，T6，T7)。现在，对于属于这一范围的学习者来说，使用支持GPU的实例几乎是不可能的，因为它的成本几乎是他们一天收入的一半。</p><p id="d421" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是当kaggle推出支持GPU的内核时，一些令人惊讶的消息传来，这些内核现在可以用来学习和解决问题语句中的深度学习问题，而无需雇用GPU。</p><p id="d174" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于所有热衷于简化学习和实践深度学习的fastai的学习者来说，这是最大的礼物之一。</p><p id="7c73" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们快速看一下使用kaggle内核实现fastai课程所需的步骤。</p><p id="0b44" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">学习fastai如何使用kaggle内核</strong></p><p id="c460" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">步骤1 </strong>转到kaggle并启动一个新内核</p><p id="f997" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">步骤2 </strong>启用内核GPU(您会在屏幕右下角看到选项)</p><p id="c779" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">步骤3</strong>ka ggle内核没有安装fastai repo，所以我们需要自己安装。转到添加自定义包并在git hub repo中粘贴<a class="ae jp" href="https://github.com/fastai/fastai" rel="noopener ugc nofollow" target="_blank"><strong class="it hv">github.com/fastai/fastai</strong></a></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kc"><img src="../Images/a922055de7116373a24591f9a736f2ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3h-nT6qazTMPP-3mUF99QA.png"/></div></div></figure><p id="cf4d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">第4步导入我们继续工作所需的所有fastai工具</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kh"><img src="../Images/f332e04306c351658bc5d65e3843665d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*otx-0esDuBFiQRjXA4_k0A.png"/></div></div></figure><p id="95b2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这种情况下，我使用<strong class="it hv">猫与狗的redux竞赛</strong>作为基线竞赛，来测试fastai是否可以在kaggle内核上使用。我们还计划使用<strong class="it hv"> Resnet34 </strong>进行迁移学习，因此我们的下一步是获取比赛数据和<strong class="it hv"> Resnet34 </strong>的预训练权重</p><p id="e04f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">第5步获取内核数据，并添加预先训练好的权重供您使用</strong></p><p id="e033" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在你内核的右控制面板的中央，你会发现一个名为<strong class="it hv">“添加数据集”的选项。</strong>这是您获取比赛数据和我们决定继续进行的网络预训练权重所需的信息。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff ki"><img src="../Images/93e79b0833eddb2bc6b064c802bf88e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gKJbQ7IdPD60ybCzf-Pqjw.png"/></div></div><figcaption class="jy jz fg fe ff ka kb bd b be z ek">Data for cat vs Dogs Redux(get from add datasets →competitions)</figcaption></figure><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kj"><img src="../Images/d3575828a38a79f210ace0774bd0b32f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chkgVPdLFZdTeSKyjCtD2w.png"/></div></div><figcaption class="jy jz fg fe ff ka kb bd b be z ek">Get weights of Resnet-34(Add datasets-&gt;datasets)</figcaption></figure><p id="c498" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们现在已经设置好了GPU环境，加载了fastai库，加载了比赛图像，并且我们已经添加了Resnet34的预训练权重。让我们继续前进，使用fastai库开发一个快速的深度学习模型。</p><p id="5a38" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">第五步装载所有需要的重要fastai工具包</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kk"><img src="../Images/b1e0085070f50a7eade6bcbc101d0ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gCOP0YlCSertvG7Sraoyxw.png"/></div></div></figure><p id="9a38" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">步骤6在数据输入库中，我们有两个文件夹，分别是训练和测试用的猫和狗的图片。创建用于训练深度学习模型的图像数据的方法之一是，我们在csv中获取训练数据的细节和标签，并将其用作参考。我们会这样做的。</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kh"><img src="../Images/9a530563297ff00e85ca48fc42f1e876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PE-AX5Yxi28P26ijmdcQNg.png"/></div></div></figure><p id="2f7e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">步骤7现在，在上述步骤之后，我们将以csv格式存储培训数据的详细信息。现在让我们创建验证索引，并继续创建模型数据对象。</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kl"><img src="../Images/6b982549ae187bfc92190a4f0ac24034.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xi7V6jabdW6FLmkeMd-npA.png"/></div></div></figure><p id="5964" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> Step-8 Fastai训练代码期望我们在开发环境的特定文件夹中使用的网络的预训练权重。下面的步骤就是这样做的。</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff km"><img src="../Images/796b779dae6228182f3efe0c639ba95f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-KNRLuknJs2iRak59CWMzg.png"/></div></div></figure><p id="eb41" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">步骤9让我们预先计算模型的权重，并使用学习率查找器</strong>查找学习率</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kn"><img src="../Images/040d2045b8a6dcc8b49c8e95400024c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*grATTFLkRcFLcJZ8kmwi9A.png"/></div></div></figure><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff ko"><img src="../Images/97bd02b41d6869093aff0b672d17d574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oMWF_UgwK29_-2TUSO7Vog.png"/></div></div></figure><p id="9e06" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">步骤10——我们现在已经完成了快速基线训练，但是如果我们现在想要在csv中获得预测，并且我们想要在不提交整个内核的情况下这样做呢？下面的代码完成了这项工作。</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kp"><img src="../Images/8129e608a61e68730e724a5bf3f2c3b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-1zCKg8-28fE4Yfl4gSPQ.png"/></div></div><figcaption class="jy jz fg fe ff ka kb bd b be z ek">Get predictions for the test data</figcaption></figure><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kq"><img src="../Images/a7a646a20d0dfd5aac5d73d82c23d9f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aNJzfdHXWPf-yK1CoKoLng.png"/></div></div><figcaption class="jy jz fg fe ff ka kb bd b be z ek">Get a download link straight from the data-frame of test predictions</figcaption></figure><h1 id="ffde" class="kr ks hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated">结论</h1><p id="474a" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">我能够使用我最喜欢的库之一(fastai)零成本地为计算机视觉(对象识别)中最流行的问题语句之一开发深度学习模型。Google以前有google colab，它也有支持GPU的基础设施，但不知何故，我发现它太慢太不稳定，无法完成具体的学习。但是Kaggle内核以其目前的形式应该被用作学习环境和开发环境。</p><p id="90b5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">致谢</strong></p><p id="b652" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我在下面引用了Anshul Rai和<a class="lu lv gr" href="https://medium.com/u/703b09baff4e?source=post_page-----72fee41bb4b5--------------------------------" rel="noopener" target="_blank"> Rachael Tatman </a>的两个内核，同时试图解决我试图解决的问题中的一些古怪之处。</p><div class="lw lx fm fo ly lz"><a href="https://www.kaggle.com/anshulrai/using-fastai-in-kaggle-kernel" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab ej"><div class="mb ab mc cl cj md"><h2 class="bd hv fv z el me eo ep mf er et ht dt translated">在Kaggle内核中使用fastai</h2><div class="mg l"><h3 class="bd b fv z el me eo ep mf er et ek translated">编辑描述</h3></div><div class="mh l"><p class="bd b gc z el me eo ep mf er et ek translated">www.kaggle.com</p></div></div></div></a></div><div class="lw lx fm fo ly lz"><a href="https://www.kaggle.com/rtatman/download-a-csv-file-from-a-kernel" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab ej"><div class="mb ab mc cl cj md"><h2 class="bd hv fv z el me eo ep mf er et ht dt translated">从内核下载一个. csv文件</h2><div class="mg l"><h3 class="bd b fv z el me eo ep mf er et ek translated">编辑描述</h3></div><div class="mh l"><p class="bd b gc z el me eo ep mf er et ek translated">www.kaggle.com</p></div></div></div></a></div><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="mi mj l"/></div></figure></div></div>    
</body>
</html>