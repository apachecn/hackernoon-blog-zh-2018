<html>
<head>
<title>About Text-Kit and UITextView In iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于iOS中的Text-Kit和UITextView</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/about-text-kit-and-uitextview-in-ios-6b0bf8996c54?source=collection_archive---------12-----------------------#2018-07-29">https://medium.com/hackernoon/about-text-kit-and-uitextview-in-ios-6b0bf8996c54?source=collection_archive---------12-----------------------#2018-07-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="6e3c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt jp translated">在iOS 7之前，当我们给出属性文本时，UITextView使用web-kit通过HTML来呈现输入。但是对于其他许多行数和复杂功能的定制，核心文本是留给开发者的选择。</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff jy"><img src="../Images/e54871c488f8de525b1648c7b32f078b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tEqbIlgg4dNXH2vbRsPUgQ.png"/></div></div></figure><ul class=""><li id="dc30" class="kk kl hu it b iu iv iy iz jc km jg kn jk ko jo kp kq kr ks dt translated"><strong class="it hv"> Core-Text : Core-Text </strong>是一个底层框架，位于iOS内核的<em class="kt"> Core-Graphics </em>框架之上。换句话说，Core-Text是一个低级的文本引擎，当我们与<em class="kt"> Core-Graphics/Quartz </em>框架一起使用时，它可以对<em class="kt">布局</em>和<em class="kt">格式进行细粒度控制。</em></li><li id="e2d9" class="kk kl hu it b iu ku iy kv jc kw jg kx jk ky jo kp kq kr ks dt translated"><strong class="it hv">文本套件:</strong></li></ul><p id="9b83" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在iOS 7中，苹果发布了一个名为Text-Kit的高级库，它是核心文本之上的一层，与头罩后面的核心文本进行交互。因此开发者可以利用这个新的库(文本工具包)API，在他们的应用设计中定制布局和格式。它继承了核心文本的所有主要功能，并将它们包装成对象，为开发人员提供所需的API。</p><p id="84d2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在需要修改文本细节时，比如字体或布局属性，必须处理核心文本，这是一个强大的框架，但是很难使用。随着<em class="kt">属性化字符串</em>的出现，事情变得更好，其中<em class="kt"> UITextView </em>视图也可以显示丰富的文本、图像等。</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff kz"><img src="../Images/be14531a668ff225409255467736cad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4xBaVsxAyr0uxxGbkUvDQ.png"/></div></div></figure><p id="1dfc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">TextKit给了我们，</p><ul class=""><li id="e004" class="kk kl hu it b iu iv iy iz jc km jg kn jk ko jo kp kq kr ks dt translated">富文本编辑</li><li id="fe88" class="kk kl hu it b iu ku iy kv jc kw jg kx jk ky jo kp kq kr ks dt translated">格式和语法突出显示</li><li id="44eb" class="kk kl hu it b iu ku iy kv jc kw jg kx jk ky jo kp kq kr ks dt translated">自定义布局</li><li id="fd0a" class="kk kl hu it b iu ku iy kv jc kw jg kx jk ky jo kp kq kr ks dt translated">用户交互</li><li id="c79d" class="kk kl hu it b iu ku iy kv jc kw jg kx jk ky jo kp kq kr ks dt translated">注释、文本效果、自定义输入行为、文本突出显示、与UI的交互等。</li></ul><p id="2f5e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">iOS中的TextKit处理3种类型的文本属性。他们是</p><ul class=""><li id="2ebb" class="kk kl hu it b iu iv iy iz jc km jg kn jk ko jo kp kq kr ks dt translated"><strong class="it hv">人物属性</strong></li></ul><p id="c65c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这些特征包括字体、颜色、下标等与单个字符或一系列字符相关的特征。</p><ul class=""><li id="d700" class="kk kl hu it b iu iv iy iz jc km jg kn jk ko jo kp kq kr ks dt translated"><strong class="it hv">段落属性</strong></li></ul><p id="3bd4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这些包括缩进、制表符、行距等。这些会影响布局管理器将文本行排列到页面段落中的方式。这些都封装在一个名为<em class="kt"> NSParagraphStyle </em>的独立类中</p><ul class=""><li id="5bbc" class="kk kl hu it b iu iv iy iz jc km jg kn jk ko jo kp kq kr ks dt translated"><strong class="it hv">文档属性</strong></li></ul><p id="0996" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这些包括文档特征，如纸张大小、边距、视图缩放等。</p><p id="215d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">→文本块中的每个<strong class="it hv"> <em class="kt">字符</em> </strong>都有一个<em class="kt">键和值</em>，【NSAttributedStringKey】的字典。Type: Any]与之相关联。</p><p id="0fa8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="kt"> →文字套件由三个主要类别组成:</em> </strong></p><ul class=""><li id="804d" class="kk kl hu it b iu iv iy iz jc km jg kn jk ko jo kp kq kr ks dt translated">文本存储类(NSTextStorage)</li><li id="4faf" class="kk kl hu it b iu ku iy kv jc kw jg kx jk ky jo kp kq kr ks dt translated">布局管理器类(NSLayoutManager)</li><li id="284f" class="kk kl hu it b iu ku iy kv jc kw jg kx jk ky jo kp kq kr ks dt translated">文本容器类(NSTextContainer)</li></ul><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div class="fe ff la"><img src="../Images/6c751b47140b21ee26fdcafef01226b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*O_CaYuy24_k4XqA5_rWbBQ.png"/></div></figure><p id="67f0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> NSTextStorage : </strong>它是<strong class="it hv"><em class="kt">nsmutableattributedstring</em></strong>类的子类，作用是存储所有的文本相关信息(NSTextAttributedString)，如字体、段落样式、文本颜色、大小等。它的作用还在于确保所有编辑过的文本属性数据在整个管理和编辑会话中保持一致。</p><p id="69c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> NSLayoutManager : </strong>顾名思义，这个类的作用是管理视图对象上的文本数据显示。它从NSTextStorage对象获取文本数据(如属性数据),以在视图上呈现相同的编辑/更改。每当对文本属性进行更改时，NSTextStorage对象都会通知它，所以每次更改都会立即反映在文本输入视图中。</p><p id="fc7f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它处理并支持任何可以在其中显示文本的视图对象，并执行操作以在视图上清晰地呈现unicode字符。</p><p id="b743" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="kt">注意:</em> </strong> <em class="kt">字符串/字符串字符有ASCII、Unicode等多种形式。NSLayoutManager对象(iOS)支持所有unicode字符，因此当您使用unicode字符编码/解码字符串时，(如utf8、utf16)我们会获得一些值，因此我们可以安全地强制展开结果。</em></p><p id="635a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">NSTextContainer : 它指定了视图，在那里绘制文本。它管理和处理视图对象框架和边界，以指定文本绘制区域。它还以数组的形式保存UIBezierPaths(路径)的信息，以便定义文本绘制区域，使其不排除与文本无关的对象，如图像。这样，我们可以在文本容器中显示图像和其他与文本无关的对象，而不会与文本重叠。</p><p id="1a33" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">注:</strong> <em class="kt">除了UIWebView与Web-kit框架一起工作外，所有其他文本输入字段/视图，如UITextView、UITextField和UILabel对象，都与</em><strong class="it hv">Text-Kit</strong>→<strong class="it hv">Core-Text</strong>→<strong class="it hv">Core-Graphics</strong>一起工作。</p><p id="6f74" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="kt">在文本工具包中，</em> <code class="eh lb lc ld le b"><em class="kt">NSTextStorage</em></code> <em class="kt">对象将</em> <code class="eh lb lc ld le b"><em class="kt">UITextView</em></code> <em class="kt">对象显示的文本和</em> <code class="eh lb lc ld le b"><em class="kt">NSLayoutManager</em></code> <em class="kt">对象布局的文本存储到</em> <code class="eh lb lc ld le b"><em class="kt">NSTextContainer</em></code> <em class="kt">对象定义的区域中。这是它们之间的关系。</em></p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div class="fe ff lf"><img src="../Images/6eeb129a28dfac121299f34fd50b44f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/0*OWOzCVxFgFAnjG0H.png"/></div></figure><p id="6027" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">注意:在印刷术中，一个字形是一组约定符号中的一个基本符号，用于书写时表示一个可读的字符。了解更多字形 <a class="ae lg" href="https://en.wikipedia.org/wiki/Glyph" rel="noopener ugc nofollow" target="_blank"> <em class="kt">在这里</em> </a></p><p id="c9ce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">简单地说，字形是你看到的字符的视觉表现。</p><p id="af59" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="kt">其他备注:</em> </strong></p><ul class=""><li id="b22a" class="kk kl hu it b iu iv iy iz jc km jg kn jk ko jo kp kq kr ks dt translated">将段落样式应用于段落的第一个字符就足够了。</li><li id="04f5" class="kk kl hu it b iu ku iy kv jc kw jg kx jk ky jo kp kq kr ks dt translated">文本的垂直位置将通过使用TextView的属性独立配置和分隔。</li><li id="02f5" class="kk kl hu it b iu ku iy kv jc kw jg kx jk ky jo kp kq kr ks dt translated">如果range = = 0，表示插入文本或替换文本</li></ul><p id="e254" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">→上面提到的所有类都有很多使用RichTextFormat的有用方法，我们可以进一步扩展或子类化它们来配置更多。我们可以子类化TextStorage、TextContainer、TextAttachment、NSAttributedStrings、NSLayoutManager等。UITextVIew可以用自定义的TextStorage、LayoutManager和TextContainer对象进行编程初始化。</p><p id="7e6f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt">— — — — — — — — — *********************** — — — — — — — — —</p><p id="7932" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你喜欢我的教程请关注我的<strong class="it hv"> <em class="kt">中</em>、</strong> <a class="ae lg" href="https://twitter.com/Leelakrishn4" rel="noopener ugc nofollow" target="_blank"> <strong class="it hv"> <em class="kt">推特</em></strong></a>&amp;<a class="ae lg" href="https://www.linkedin.com/in/leela-prasad-penumutchu-b44023157/" rel="noopener ugc nofollow" target="_blank"><strong class="it hv"><em class="kt">linkedIn</em></strong></a><strong class="it hv"/>账号</p><p id="cdf9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">感谢阅读…</p><p id="d05f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">****************************!！！再见！！！****************************</p></div></div>    
</body>
</html>