<html>
<head>
<title>How to create a store locator app using Vuejs, Cosmic JS, and Google Maps.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Vuejs、Cosmic JS和Google Maps创建商店定位器应用程序？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-create-an-awesome-store-locator-app-using-vuejs-cosmic-js-and-google-maps-d813b3c4d157?source=collection_archive---------19-----------------------#2018-07-30">https://medium.com/hackernoon/how-to-create-an-awesome-store-locator-app-using-vuejs-cosmic-js-and-google-maps-d813b3c4d157?source=collection_archive---------19-----------------------#2018-07-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/b0b496d0b10a3491eaf660f3a74ea553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gul_q5PeE9yqI2gl2CG_rw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">store locator app build using Vue, Cosmic JS, and Google Maps</figcaption></figure><p id="b490" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">TL；博士:</p><p id="ccb2" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="http://store-locator.cosmicapp.co/#/" rel="noopener ugc nofollow" target="_blank">演示</a></p><p id="0a8d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://github.com/mtermoul/vuejs-store-locator" rel="noopener ugc nofollow" target="_blank">源代码(github) </a></p><p id="6c4f" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://cosmicjs.github.io/rest-api-docs/" rel="noopener ugc nofollow" target="_blank">宇宙JS后端功能</a></p><p id="ebaf" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://developers.google.com/maps/documentation/javascript/tutorial" rel="noopener ugc nofollow" target="_blank">谷歌地图javascript API </a></p><p id="0493" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" rel="noopener" href="/codingthesmartway-com-blog/vue-js-2-state-management-with-vuex-introduction-db26cb495113"> Vue js和vuex </a></p><p id="df42" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://github.com/Akryum/vue-googlemaps" rel="noopener ugc nofollow" target="_blank"> Vue-googlemaps </a></p><h2 id="245d" class="kf kg hu bd kh ki kj kk kl km kn ko kp jr kq kr ks jv kt ku kv jz kw kx ky kz dt translated">介绍</h2><p id="8754" class="pw-post-body-paragraph jg jh hu ji b jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd hn dt translated">这个小应用程序可以让用户搜索和定位你的商店。如果商店与你的业务无关，你可以用它来定位你的办公室、分支机构、仓库…或者任何你的业务。要做到这一点，您需要定义一个用户可以找到并定位的位置列表。</p><h2 id="d466" class="kf kg hu bd kh ki kj kk kl km kn ko kp jr kq kr ks jv kt ku kv jz kw kx ky kz dt translated">后端</h2><p id="3707" class="pw-post-body-paragraph jg jh hu ji b jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd hn dt translated">使用Cosmic JS可以节省你很多时间，因为它允许你存储你的数据，并且不需要任何额外的编码就可以准备好一个REST api。出于这个应用的目的，我使用了Cosmic JS的以下功能:</p><ul class=""><li id="7d10" class="lf lg hu ji b jj jk jn jo jr lh jv li jz lj kd lk ll lm ln dt translated">Bucket对象:在后端存储数据，比如城市、州，这些地方有可用的存储。</li><li id="99bc" class="lf lg hu ji b jj lo jn lp jr lq jv lr jz ls kd lk ll lm ln dt translated">桶媒体:存储应用图像和谷歌地图图标。将数据和媒体存储在一个地方非常方便。</li><li id="aee6" class="lf lg hu ji b jj lo jn lp jr lq jv lr jz ls kd lk ll lm ln dt translated">虚拟主机:我使用了Cosmic JS来托管我的应用程序，但是你也可以使用Cosmic JS将你的应用程序部署到其他托管服务中。</li></ul><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lt"><img src="../Images/201553da568666bdb0e3bca9cc79e008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bXbsIDVlxkFAVxux7cjdVw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Cosmic JS dashboard — adding cities where your store is available</figcaption></figure><h2 id="65f4" class="kf kg hu bd kh ki kj kk kl km kn ko kp jr kq kr ks jv kt ku kv jz kw kx ky kz dt translated">启动您的vue应用程序</h2><p id="731b" class="pw-post-body-paragraph jg jh hu ji b jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd hn dt translated">安装vue-cli后，您可以运行以下命令开始构建您的应用程序</p><pre class="lu lv lw lx fq ly lz ma mb aw mc dt"><span id="ac30" class="kf kg hu lz b fv md me l mf mg">$ npm install -g vue-cli<br/>$ vue init webpack store-locator<br/>$ cd store-locator<br/>$ npm install<br/>$ npm install --save vuex vuetify vue-router vue-resource vue-googlemaps cosmicjs moment<br/>$ npm run dev</span></pre><p id="8a63" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">vue应用程序将有两个主要组件:</p><ul class=""><li id="4843" class="lf lg hu ji b jj jk jn jo jr lh jv li jz lj kd lk ll lm ln dt translated">允许用户选择一个城市，并获得一个商店列表</li><li id="e695" class="lf lg hu ji b jj lo jn lp jr lq jv lr jz ls kd lk ll lm ln dt translated">MapPanel.vue:为每个商店显示带有标记的对应地图</li></ul><p id="9e29" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">你可以用<a class="ae ke" href="https://vuetifyjs.com/en/layout/pre-defined" rel="noopener ugc nofollow" target="_blank"> vuetify </a> grid system轻松构建应用布局，不需要写很多css。</p><h2 id="1623" class="kf kg hu bd kh ki kj kk kl km kn ko kp jr kq kr ks jv kt ku kv jz kw kx ky kz dt translated">使用Vuex和Cosmic JS添加状态管理</h2><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mh mi l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">store-locator/src/store/index.js</figcaption></figure><p id="6032" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">创建应用程序时，我们需要调用Cosmic JS rest api来获取将在搜索中使用的城市。所以在下面的代码中有两件事值得一提。首先，我们用从<a class="ae ke" href="https://console.cloud.google.com/apis/dashboard" rel="noopener ugc nofollow" target="_blank"> google api控制台</a>提供的<code class="eh mj mk ml lz b">GOOGLE_API_KEY</code>初始化VueGoogleMaps组件。其次，我们调用<code class="eh mj mk ml lz b">this.$store.dispatch('fetchCities')</code>来填充vuex存储文件上的<code class="eh mj mk ml lz b">availableLocations</code>。我们还可以调用<code class="eh mj mk ml lz b">this.$store.dispatch('fetchStoreCardImages')</code>，它将调用Cosmic JS REST api来获取存储在媒体文件夹中的所有图像。</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mh mi l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">store-locator/src/main.js</figcaption></figure><p id="5e58" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这是配置Cosmic JS REST API要调用的代码。注册后，您可以读取Api，编写密钥，并添加您的Bucket。</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mh mi l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">store-locator/src/api/config.js</figcaption></figure><p id="9430" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">存储桶是应用程序中所有数据、文件和图像的根容器。</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mh mi l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">store-locator/src/api/cosmic.js</figcaption></figure><p id="eeeb" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在下面的代码中，您可以在<code class="eh mj mk ml lz b">fetchCities</code>动作中看到，我们调用了Cosmic JS api来选择所有类型为cities的对象，并遍历结果数组，创建另一个对象来填充store <code class="eh mj mk ml lz b">availableLocations</code>变量，该变量将在SearchPanel组件中使用，以显示可用位置的列表。</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mh mi l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">store-locator/src/store/index.js</figcaption></figure><p id="d1b3" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">同样以非常相似的方式，我们可以调用Cosmic JS REST Api来获取图像，并使用<code class="eh mj mk ml lz b">Cosmic.getMedia(...)</code>将它们存储在Vuex存储中</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mh mi l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">store-locator/src/store/index.js</figcaption></figure><h2 id="24ab" class="kf kg hu bd kh ki kj kk kl km kn ko kp jr kq kr ks jv kt ku kv jz kw kx ky kz dt translated">将谷歌地图添加到您的vue应用程序中</h2><p id="7c7f" class="pw-post-body-paragraph jg jh hu ji b jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd hn dt translated">为了显示地图，我使用了<a class="ae ke" href="https://github.com/Akryum/vue-googlemaps" rel="noopener ugc nofollow" target="_blank"> vue-googlemaps </a>组件，这是一个易于使用的vue组件，就像是<a class="ae ke" href="https://developers.google.com/maps/documentation/javascript/tutorial" rel="noopener ugc nofollow" target="_blank">Google Maps Javascript API</a>的包装器。为了绘制地图，您需要提供一个特定位置的地理编码<code class="eh mj mk ml lz b">mapCenter</code>点。例如奥兰多市中心有以下地理位置<code class="eh mj mk ml lz b">{latitude: 30.325974,longitude: -81.660454}</code>。此外，要在地图上绘制表示商店或特殊位置的标记，您需要地理点、标题和图标。为了这个应用程序的目的，我存储了不同城市的地理位置，并存储在Cosmic JS后端。</p><p id="7899" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">你可能会问，我如何获得我的家庭地址或工作办公室的地理位置。有几种服务可以将常规地址转换成地理位置，反之亦然。但最简单的方法，是打开<a class="ae ke" href="https://www.google.com/maps" rel="noopener ugc nofollow" target="_blank">谷歌地图</a>，点击地图上的任意一点。然后你会在底部看到那个位置的地理点。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mm"><img src="../Images/3e4adca5057504d689f699d43cb1de89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ud7e5hDQiRaEPA_g5v_ZjQ.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Google maps showing a geolocation of selected point</figcaption></figure><p id="5637" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">下面是应用程序启动时绘制地图的代码</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mh mi l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">store-locator/src/components/MapPanel.vue</figcaption></figure><p id="1b32" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">在<code class="eh mj mk ml lz b">MapPanel</code> vue组件中，我们使用<code class="eh mj mk ml lz b">vue-googlemaps</code>来显示谷歌地图。我们所能提供的就是<code class="eh mj mk ml lz b">mapCenter, zoom, mapMarkers</code>。我们有几个观察者来更新地图。首先是当用户从<code class="eh mj mk ml lz b">SearchPanel</code>中选择新城市时触发的<code class="eh mj mk ml lz b">selectedLocation</code>。我们还在等待<code class="eh mj mk ml lz b">stores</code>用标记填充地图，标记为该位置的每个商店显示一个小图标。我们也在等待<code class="eh mj mk ml lz b">selectedStore</code>高亮显示相应的地图标记。这就是我们更新地图视图的方式</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mh mi l"/></div></figure><p id="36f6" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">最后，我们只需要在地图上添加几个事件。第一个事件<code class="eh mj mk ml lz b">onMapMarkerClick</code>使标记图标高亮显示，并使相应的商店在搜索窗格上被选中。<code class="eh mj mk ml lz b">onMapMarkerMouseOver</code>添加一点动画，让图标上下跳动。</p><h2 id="9edb" class="kf kg hu bd kh ki kj kk kl km kn ko kp jr kq kr ks jv kt ku kv jz kw kx ky kz dt translated">构建和部署</h2><p id="dfb0" class="pw-post-body-paragraph jg jh hu ji b jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd hn dt translated">在您构建并测试您的应用程序之后，您需要将<code class="eh mj mk ml lz b">.env</code>文件添加到您的根文件夹中，以进行您的应用程序配置，如下所示。</p><pre class="lu lv lw lx fq ly lz ma mb aw mc dt"><span id="3b0b" class="kf kg hu lz b fv md me l mf mg">GOOGLE_API_KEY=PASTE-YOUR-API-KEY-HERE<br/>COSMIC_BUCKET=store-locator<br/>COSMIC_READ_KEY=PASTE-YOUR-API-KEY-HERE<br/>COSMIC_WRITE_KEY=PASTE-YOUR-API-KEY-HERE<br/>PORT=5000</span></pre><p id="d719" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">您还需要将<code class="eh mj mk ml lz b">start</code>命令添加到<code class="eh mj mk ml lz b">package.json</code>脚本中，这将被Cosmic JS主机用来启动您的应用服务器。一旦更新了Api键，就可以使用以下命令构建并部署到Cosmic JS</p><pre class="lu lv lw lx fq ly lz ma mb aw mc dt"><span id="494f" class="kf kg hu lz b fv md me l mf mg">$ # to run you app on dev mode<br/>$ npm run dev<br/>$ # to test your production server mode<br/>$ npm run start<br/>$ # to build your application before deployment<br/>$ npm run build<br/>$ # commit all changes to github<br/>$ git add .<br/>$ git commit -m 'Before deployment'<br/>$ git push</span></pre><p id="6778" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，您可以直接进入Cosmic JS web hosting，按照说明部署您的应用程序。</p><h2 id="9a07" class="kf kg hu bd kh ki kj kk kl km kn ko kp jr kq kr ks jv kt ku kv jz kw kx ky kz dt translated">结论</h2><p id="f884" class="pw-post-body-paragraph jg jh hu ji b jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd hn dt translated">将谷歌地图添加到您的应用程序中是增强用户体验的有趣且简单的方法。在这个应用程序中使用Vue.js也节省了大量时间。然而，有了Cosmic JS，我就可以在没有额外编码的情况下使用服务器Rest Api实现完整的堆栈应用程序。我认为Cosmic JS是一个很好的云平台，可以在不需要额外编码的情况下促进你的开发。</p><h2 id="b1d5" class="kf kg hu bd kh ki kj kk kl km kn ko kp jr kq kr ks jv kt ku kv jz kw kx ky kz dt translated">我很想收到你的来信</h2><p id="ca1d" class="pw-post-body-paragraph jg jh hu ji b jj la jl jm jn lb jp jq jr lc jt ju jv ld jx jy jz le kb kc kd hn dt translated">最后，我鼓励你浏览一下<a class="ae ke" href="https://github.com/mtermoul/vuejs-store-locator" rel="noopener ugc nofollow" target="_blank">源代码</a>，试试这个应用程序，如果你有任何问题或评论，请告诉我。</p><p id="47e1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">不断创造令人惊叹的应用程序。</p><p id="32bb" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">干杯。</p></div></div>    
</body>
</html>