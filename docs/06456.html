<html>
<head>
<title>Spicing up Bash Scripts with Computer Vision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用计算机视觉给Bash脚本增添趣味</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/spicing-up-bash-scripts-with-computer-vision-86d4b9f19247?source=collection_archive---------19-----------------------#2018-08-02">https://medium.com/hackernoon/spicing-up-bash-scripts-with-computer-vision-86d4b9f19247?source=collection_archive---------19-----------------------#2018-08-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="5aac" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">戴恩·索维斯托</p><h2 id="b098" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated">现在的问题是:你有一个目录(或许多目录)充满了图像、视频和其他媒体格式。也许你的旧硬盘里满是你多年前录制的度假照片和视频，你想快速有效地筛选。</h2><h2 id="003d" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated">让我们将问题变得更具挑战性，假设您正在寻找一个非常具体的图像或视频文件，但是您没有时间手动整理所有文件、观看所有视频或搜索所有图像。您希望有一种方法可以编写一个bash脚本来帮您做到这一点……好吧，确实有。</h2><p id="8e4c" class="pw-post-body-paragraph ir is hu it b iu kk iw ix iy kl ja jb jc km je jf jg kn ji jj jk ko jm jn jo hn dt translated">计算机视觉如今使用非常强大的面部识别和物体检测算法，这些算法最近在ML社区掀起了波澜。在这篇文章中，我将向你展示一种快速而简单的方法，在你自己的应用中使用计算机视觉，而无需了解任何算法。</p><h2 id="a440" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated"><strong class="ak">第一步:编写一个Python脚本来进行API调用</strong></h2><p id="f699" class="pw-post-body-paragraph ir is hu it b iu kk iw ix iy kl ja jb jc km je jf jg kn ji jj jk ko jm jn jo hn dt translated">随着围绕ML的所有热情，许多崭露头角的数据科学家都对高级算法着迷，如“LSTM”、深度学习和oways，以做像对象检测这样的事情。API调用不仅易于在代码中实现，需要很少的模块/库，而且最重要的是可以在最先进的ML模型范围内实现测试数据的目标精度。API调用也是将计算机视觉集成到您的应用程序中的一种非常灵活的方式，特别是如果您没有诸如超参数调整等复杂主题的实践经验，或者没有资源来训练您自己的计算机视觉算法。</p><p id="36bd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当然，和往常一样，使用API调用也有利弊。其中最明显的是API调用可能被称为“黑盒”方法，这意味着您放弃了作为开发人员对API调用的一些控制。</p><p id="6af8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我打算让自己轻松一些，只使用谷歌云ML引擎。这不是免费的，需要积分，但我会使用这个演示免费试用。如果你不想在云中进行API调用，你可以用scitkit-learn或者python中其他成千上万的ML库来替换它。</p><blockquote class="kp"><p id="e150" class="kq kr hu bd ks kt ku kv kw kx ky jo ek translated">谷歌云平台由谷歌提供，是一套云计算服务，运行在谷歌内部用于其最终用户产品的相同基础设施上，如谷歌搜索和YouTube。</p></blockquote><p id="7103" class="pw-post-body-paragraph ir is hu it b iu kz iw ix iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo hn dt translated">通过使用云作为计算机视觉处理的后端，这是非常资源密集型的(高CPU负载和内存使用)，您可以轻松地将您的解决方案移植到任何支持互联网的设备上。这确实是我在云中使用Google的秘密原因，我在一台没有GPU的旧笔记本电脑上运行这个演示，尽管像迁移学习这样的高级技术可以让我跳过计算密集型的培训步骤，但对于这个演示来说，云提供了完美的解决方案。</p><p id="2ad0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">谷歌云平台有一个云ML引擎，允许你使用TensorFlow和scikit-learn或keras等框架训练<a class="ae le" href="https://hackernoon.com/tagged/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>模型，而不必规划等式的基础设施规模——这是由谷歌为你管理的，你所要做的只是进行一次API调用。事不宜迟，让我们记录下这4个步骤:</p><h2 id="6b58" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated"><strong class="ak">步骤1创建服务账户</strong></h2><p id="84cf" class="pw-post-body-paragraph ir is hu it b iu kk iw ix iy kl ja jb jc km je jf jg kn ji jj jk ko jm jn jo hn dt translated">如果你阅读了Google的Vision API的文档和教程，你会发现有不止一个选择来认证云。另一个选择是获得一个开发者API密匙。然而，这是不安全的，特别是如果你要从生产中进行API调用，你会想要一个更持久和安全的解决方案，建议创建一个服务帐户。</p><figure class="lg lh li lj fq lk fe ff paragraph-image"><div class="fe ff lf"><img src="../Images/d4ab5948f51e7857400a99f580aeb419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*GwWRouIOJmTs0mPoTGl5fw.jpeg"/></div></figure><p id="eadc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">认证<strong class="it hv"> API </strong>请求。为了向<strong class="it hv">视觉API </strong>发出请求，您需要使用一个<strong class="it hv">服务帐户</strong>。一个<strong class="it hv">服务账户</strong>是一个<strong class="it hv">账户</strong>，属于你的项目，被<strong class="it hv"> Google </strong>客户端<strong class="it hv"> Python </strong>库用来发出<strong class="it hv"> Vision API </strong>请求。</p><blockquote class="kp"><p id="58a3" class="kq kr hu bd ks kt ku kv kw kx ky jo ek translated">创建一个提醒，这样你就不会超出预算</p></blockquote><figure class="lo lp lq lr ls lk fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff ln"><img src="../Images/7968019e4cff3a0d37e847823909c6b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Vew_ItwSVwGVczFw11mYg.png"/></div></div></figure><p id="b5d2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建服务帐户后，您可以生成一个服务帐户密钥——只是一个JSON文件，其中包含您的凭证信息。您应该将它存储在一个安全的文件系统中，并根据最小特权原则设置适当的权限。在生产应用程序中，建议您使用Google云存储而不是本地文件系统来存储该文件。</p><h2 id="c43b" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated"><strong class="ak">步骤二。启用视觉API </strong></h2><p id="3c77" class="pw-post-body-paragraph ir is hu it b iu kk iw ix iy kl ja jb jc km je jf jg kn ji jj jk ko jm jn jo hn dt translated">谷歌云平台要求你在开始使用一项服务之前启用它，像Cloud Vision API这样的服务在默认情况下是禁用的。在您的项目中启用API可以通过点击下图中API库中的“Enable”来完成。</p><h2 id="ac5d" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated"><strong class="ak">第三步。测试您的API调用</strong></h2><p id="f255" class="pw-post-body-paragraph ir is hu it b iu kk iw ix iy kl ja jb jc km je jf jg kn ji jj jk ko jm jn jo hn dt translated">我写了一个简单的<a class="ae le" href="https://hackernoon.com/tagged/python" rel="noopener ugc nofollow" target="_blank"> python </a>脚本，名为LabelImages.py代码来对Google cloud进行API调用。你拿回来的数据应该是JSON。</p><figure class="lg lh li lj fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff ln"><img src="../Images/f47eb28105028ad220bb81f983c27124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ulTintpXPJeYbbwit0Bo1Q.png"/></div></div></figure><figure class="lg lh li lj fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff ln"><img src="../Images/34b6894f31e4ae5ed0eb1f6da4851819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mjLyy5Cz33adfgwk3X_PLQ.png"/></div></div></figure><h2 id="7905" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated"><strong class="ak">第四步。编写有用的Bash脚本</strong></h2><figure class="lg lh li lj fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff ln"><img src="../Images/5b874e79413e28d73667b2e40e2ab004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K45BLsGrFpR70TQBEtWVFA.png"/></div></div></figure><p id="3f86" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以轻松地编写一个bash脚本，为存储在一个目录中的每个图像运行API调用(这个目录可能在云上，也可能在您的本地计算机上)。这有许多应用，但我用它来对图像进行分类，并在图像目录中组织/标记文件名，该目录包含从各种来源收集的以多种格式存储的100，000多幅图像。我将把创建这个脚本的细节留给您。</p><figure class="lg lh li lj fq lk fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/3073ebcc745d9c4b9850b0e884423c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*_TLuJuVPFi8apv1cveNl4A.png"/></div></figure><p id="b240" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当然，您也可以从命令行使用xargs将每个文件传输到您的计算机视觉API调用，如果您有许多文件，该调用将并行运行。</p><h2 id="08e1" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated"><strong class="ak">结论</strong></h2><p id="d327" class="pw-post-body-paragraph ir is hu it b iu kk iw ix iy kl ja jb jc km je jf jg kn ji jj jk ko jm jn jo hn dt translated">在四个步骤中，我演示了如何创建一个使用计算机视觉来标记图像的简单实用程序。有趣的计算机视觉应用远比我在一篇博客中所能列出的要多得多。下面给出了一些关于从哪里开始调查的资源。你甚至可以将代码移植到你的支持互联网的Raspberry Pi设备上，用谷歌云(或者任何你喜欢的云服务)作为你的处理后端，构建一些非常实用的计算机视觉应用。只要确保设置一个预算和警报，这样你就不会超出预算，因为每次API调用都会向你收费。</p><p id="cde7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">额外资源</p><p id="df9e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">https://cloud.google.com/billing/docs/how-to/budgets<a class="ae le" href="https://cloud.google.com/billing/docs/how-to/budgets" rel="noopener ugc nofollow" target="_blank"/></p><p id="cc98" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">【https://cloud.google.com/docs/authentication/ T4】</p><figure class="lg lh li lj fq lk"><div class="bz el l di"><div class="ly lz l"/></div></figure></div></div>    
</body>
</html>