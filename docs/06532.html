<html>
<head>
<title>How to create a two-way navigation map</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建双向导航地图</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-create-a-two-way-navigation-map-e96600a73cbd?source=collection_archive---------12-----------------------#2018-08-05">https://medium.com/hackernoon/how-to-create-a-two-way-navigation-map-e96600a73cbd?source=collection_archive---------12-----------------------#2018-08-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="13b1" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">用普通Javascript创建交互式信息图(第三部分)</h2></div><h2 id="af07" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">概述</h2><p id="b6bd" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">本文是关于用普通Javascript创建交互式信息图的五部分系列文章。</p><p id="bee4" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">以前，我们添加了导航功能来与内容进行交互。我们可以任意滚动、缩放、平移或拖动大画布。</p><figure class="lg lh li lj fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff lf"><img src="../Images/080b253884126143ecad4cb8847d5fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*S4GJz9A5RsCGSTVGhqkbPQ.gif"/></div></div><figcaption class="lr ls fg fe ff lt lu bd b be z ek">Integrated usage (so far)</figcaption></figure><p id="b25e" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">你注意到什么特别的事情了吗？有一个小地图可以响应用户的动作。这是怎么回事？</p><h2 id="542b" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">目标</h2><p id="ab17" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">我们将添加一个地图定位器来增强导航。</p><h2 id="5e91" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">介绍</h2><p id="d184" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">地图定位器对于探索大型画布非常有用。这是一个简单而有效的可视化工具，提供当前位置的持续更新。这个小工具也是展示交互组件之间主题关系的理想工具。</p><h2 id="b603" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">概念</h2><p id="5ce3" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">地图定位器包括一个<code class="eh lv lw lx ly b">miniMap</code>和一个<code class="eh lv lw lx ly b">location indicator</code>。小地图是实际大小的<code class="eh lv lw lx ly b">canvas</code>的缩小版。位置指示器是表示用户当前位置的图标或标记。</p><p id="e632" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">您可以通过两种方式使用地图定位器:</p><ul class=""><li id="0238" class="lz ma hu kj b kk la kn lb ju mb jy mc kc md kz me mf mg mh dt translated">当访问者滚动/缩放/平移/拖动画布时，指示器会自动移动到新位置。您已经在之前的介绍/回顾演示视频中看到了这一点。</li><li id="4749" class="lz ma hu kj b kk mi kn mj ju mk jy ml kc mm kz me mf mg mh dt translated">反过来，访问者也可以使用指示器本身与画布进行交互。您可以拖动指示器或点击任何区域来导航到任何新区域。</li></ul><figure class="lg lh li lj fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff mn"><img src="../Images/7195727e34323470f9d2bd8c531b9e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*55hq7yCzVy01z8CgjvhznQ.gif"/></div></div><figcaption class="lr ls fg fe ff lt lu bd b be z ek">Navigate by mini-map: drag bracket, or, point-and-click</figcaption></figure><h2 id="608f" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">行动和反应的概念</h2><p id="5ff9" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">回想一下第二部分的讨论，我们对UI有一个动作和反应的概念。简言之，鼠标上的<strong class="kj hv">动作</strong>会在HTML元素上产生相同的<strong class="kj hv">反应</strong>。例如，光标移动会导致画布移动相同的距离。这种镜像效果被测量为<strong class="kj hv">鼠标增量值</strong>。</p><p id="e165" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">我们将应用相同的概念来构建地图定位器。位置指示符的增量移动转化为更大画布上的新的相对滚动值。我们可以映射这两种方式来创建一个多功能的双向导航工具。</p><h2 id="0a9a" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">准备小地图容器</h2><p id="1a8a" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">创建对<code class="eh lv lw lx ly b">miniMap</code>容器的引用。它将停留在画布的顶部来引导导航。</p><pre class="lg lh li lj fq mo ly mp mq aw mr dt"><span id="27ab" class="jj jk hu ly b fv ms mt l mu mv">var miniMap = document.getElementById( “miniMap” );</span></pre><p id="c99b" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">创建一个存在于<code class="eh lv lw lx ly b">miniMap</code>容器中的引用<code class="eh lv lw lx ly b">indicator</code>。</p><pre class="lg lh li lj fq mo ly mp mq aw mr dt"><span id="4373" class="jj jk hu ly b fv ms mt l mu mv">var indicator = document.getElementById( "indicator" );</span></pre><p id="e0cd" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">使用任何方法来生成你的小地图。我们将走捷径，使用画布的缩小静态图像。</p><pre class="lg lh li lj fq mo ly mp mq aw mr dt"><span id="6186" class="jj jk hu ly b fv ms mt l mu mv">&lt;img src=”myMap.jpg” id=”miniMap”&gt;</span></pre><p id="407a" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">记得使用<code class="eh lv lw lx ly b">z-index</code>设置正确的出现顺序。</p><h2 id="2a8f" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">使用指示器导航</h2><p id="28cf" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">添加一个事件监听器来捕获<code class="eh lv lw lx ly b">indicator</code>的鼠标增量值，并更新<code class="eh lv lw lx ly b">canvas</code>的新的相对滚动位置。</p><pre class="lg lh li lj fq mo ly mp mq aw mr dt"><span id="f0e5" class="jj jk hu ly b fv ms mt l mu mv">miniMap.addEventListener("mousedown", handlerIndicator, false);</span><span id="2af1" class="jj jk hu ly b fv mw mt l mu mv">function handlerIndicator(event) {<br/>    if (event.which == 1) {<br/>        // formula<br/>    }<br/>}</span></pre><p id="a979" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">该公式应根据相对鼠标增量值动态更新画布滚动值:</p><pre class="lg lh li lj fq mo ly mp mq aw mr dt"><span id="2f1b" class="jj jk hu ly b fv ms mt l mu mv">canvas.scrollTo( <br/>    ( canvas.scrollWidth * (event.clientX - boundingbox(0, 0, miniMap).x) / boundingbox(0, 0, miniMap).w ) - canvas.offsetWidth/2,<br/>    (canvas.scrollHeight * (event.clientY - boundingbox(0, 0, miniMap).y) / boundingbox(0, 0, miniMap).h ) - canvas.offsetHeight/2 <br/>);</span></pre><ul class=""><li id="3d31" class="lz ma hu kj b kk la kn lb ju mb jy mc kc md kz me mf mg mh dt translated"><code class="eh lv lw lx ly b">canvas.scrollTo</code>告诉浏览器在检测到<code class="eh lv lw lx ly b">miniMap</code>上的<code class="eh lv lw lx ly b">mousedown</code>事件时执行滚动。</li><li id="76d5" class="lz ma hu kj b kk mi kn mj ju mk jy ml kc mm kz me mf mg mh dt translated"><code class="eh lv lw lx ly b">event.clientX</code>和<code class="eh lv lw lx ly b">event.clientY</code>返回鼠标光标的X和Y坐标。这些值由浏览器引擎动态更新。</li><li id="99d5" class="lz ma hu kj b kk mi kn mj ju mk jy ml kc mm kz me mf mg mh dt translated"><code class="eh lv lw lx ly b">scrollWidth</code>返回画布(即父容器)的宽度。</li><li id="aeaa" class="lz ma hu kj b kk mi kn mj ju mk jy ml kc mm kz me mf mg mh dt translated"><code class="eh lv lw lx ly b">event.clientX — boundingbox(0, 0, miniMap).x) / boundingbox(0, 0, miniMap).w</code>将指示器的相对移动转换到实际大小的画布上。</li><li id="32ac" class="lz ma hu kj b kk mi kn mj ju mk jy ml kc mm kz me mf mg mh dt translated"><code class="eh lv lw lx ly b">canvas.offsetWidth/2</code>和<code class="eh lv lw lx ly b">canvas.offsetHeight/2</code>初始化正确的滚动偏移值。</li></ul><p id="68eb" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">我们创造了一种单向导航设备。让我们使它成为双向的。</p><h2 id="88bf" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">导航画布</h2><p id="201e" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">创建一个事件监听器，以便每当在画布上检测到交互(即滚动/平移/拖动)时调用自定义函数<code class="eh lv lw lx ly b">handler_mouseScroll</code></p><pre class="lg lh li lj fq mo ly mp mq aw mr dt"><span id="b0cb" class="jj jk hu ly b fv ms mt l mu mv">canvas.addEventListener("scroll", handlerMouseScroll, false);</span><span id="0312" class="jj jk hu ly b fv mw mt l mu mv">function handlerMouseScroll(event) {<br/><br/><em class="mx">    var</em> scrollpercentX = canvas.scrollLeft / canvas.scrollWidth;</span><span id="3ca2" class="jj jk hu ly b fv mw mt l mu mv"><em class="mx">    var</em> scrollpercentY = canvas.scrollTop / canvas.scrollHeight;</span><span id="85c3" class="jj jk hu ly b fv mw mt l mu mv">    indicator.style.left = miniMap.offsetWidth * scrollpercentx<br/>    + "px";<br/>    indicator.style.top = miniMap.offsetHeight * scrollpercenty<br/>    + "px";<br/>    ...<br/>}</span></pre><ul class=""><li id="be30" class="lz ma hu kj b kk la kn lb ju mb jy mc kc md kz me mf mg mh dt translated"><code class="eh lv lw lx ly b">scrollpercentX</code>和<code class="eh lv lw lx ly b">scrollpercentY</code>给出了用于计算小地图上相对滚动值的转换率。</li><li id="ccd1" class="lz ma hu kj b kk mi kn mj ju mk jy ml kc mm kz me mf mg mh dt translated"><code class="eh lv lw lx ly b">miniMap.offsetWidth</code>和<code class="eh lv lw lx ly b">miniMap.offsetHeight</code>给出了小地图的尺寸。</li><li id="8fc5" class="lz ma hu kj b kk mi kn mj ju mk jy ml kc mm kz me mf mg mh dt translated"><code class="eh lv lw lx ly b">indicator.style.left</code>和<code class="eh lv lw lx ly b">indicator.style.top</code>更新迷你地图上指示器的位置。</li></ul><h2 id="fd6c" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">后续步骤</h2><p id="e125" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">有了双向导航工具，游客可以探索一个大画布而不会迷失方向。我们可以创建复杂但易于使用的信息图表。</p><p id="1089" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">在下一篇文章中，我们将设计一个可以表示多方面内容的信息架构的UI。</p></div><div class="ab cl my mz hc na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="hn ho hp hq hr"><h2 id="9335" class="jj jk hu bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">到其他部分的链接</h2><p id="785f" class="pw-post-body-paragraph kh ki hu kj b kk kl iv km kn ko iy kp ju kq kr ks jy kt ku kv kc kw kx ky kz hn dt translated">第一部分为设计交互式信息图奠定了基础。</p><p id="c561" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated"><a class="ae nf" rel="noopener" href="/@PageiiStudio/how-to-create-a-navigation-ui-bac94a9e51fa"> <strong class="kj hv">第二部分</strong>增加浏览内容的导航功能。</a></p><p id="607f" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">第三部分→  <em class="mx">你来了。</em></p><p id="7d2f" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated"><a class="ae nf" rel="noopener" href="/@PageiiStudio/how-to-create-a-progressive-ui-to-enhance-presentation-cc42fe97360c"> <strong class="kj hv"> Part-four </strong>增加了一个内嵌UI来访问分层内容。</a></p><p id="9af9" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">第五部分展示了为什么创建有人情味的用户界面如此容易。</p></div><div class="ab cl my mz hc na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="hn ho hp hq hr"><p id="3bb4" class="pw-post-body-paragraph kh ki hu kj b kk la iv km kn lb iy kp ju lc kr ks jy ld ku kv kc le kx ky kz hn dt translated">如果你喜欢这个故事，你可以在<a class="ae nf" href="https://pageii.com/story;title=How-to-create-a-two-way-navigation-map" rel="noopener ugc nofollow" target="_blank"> Pageii工作室</a>找到更多。</p></div></div>    
</body>
</html>