<html>
<head>
<title>Deep Hive: Deep learning live on stage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Deep Hive:深度学习现场直播</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/deep-hive-deep-learning-live-on-stage-7d1525a55bb1?source=collection_archive---------16-----------------------#2018-08-06">https://medium.com/hackernoon/deep-hive-deep-learning-live-on-stage-7d1525a55bb1?source=collection_archive---------16-----------------------#2018-08-06</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="11a9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最近我不得不做一些关于机器学习、深度学习和计算机视觉的演讲。我开始在一个幻灯片平台上工作，并看着其他人在网上做了什么来传达诸如监督学习、CNN等概念。</p><p id="7407" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我发现了非常好的图片和图表。作为一名数据科学家，它们对我来说很有意义，但大部分感觉太抽象，无法直接传达给非技术观众。</p><p id="7fc9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">除此之外，人们通过做比听学得更好。所以我总是尝试与观众互动，让我的演讲更吸引人。</p><blockquote class="jp"><p id="478f" class="jq jr hu bd js jt ju jv jw jx jy jo ek translated">如果我可以在舞台上现场表演机器学习的整个过程(数据收集、训练、测试)会怎么样？</p></blockquote><p id="7283" class="pw-post-body-paragraph ir is hu it b iu jz iw ix iy ka ja jb jc kb je jf jg kc ji jj jk kd jm jn jo hn dt translated">这将使这个想法更加有形和具体。我就是这样得到了开发Deep Hive的灵感。</p><p id="0ce5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">完整的源代码可从<br/><a class="ae ke" href="https://github.com/wouterdewinter/deep-hive" rel="noopener ugc nofollow" target="_blank">https://github.com/wouterdewinter/deep-hive</a>获得</p><h1 id="07ca" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">深层蜂巢</h1><p id="3d45" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">主要概念很简单:</p><ol class=""><li id="5f26" class="li lj hu it b iu iv iy iz jc lk jg ll jk lm jo ln lo lp lq dt translated">观众中的人们同时标记图像和；</li><li id="a5d9" class="li lj hu it b iu lr iy ls jc lt jg lu jk lv jo ln lo lp lq dt translated">用这些注释训练模型；</li><li id="367a" class="li lj hu it b iu lr iy ls jc lt jg lu jk lv jo ln lo lp lq dt translated">测试结果显示在主屏幕上。</li></ol><p id="1bb9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">任务是学习机器学习模型来将图像分类到多个类别中。默认的猫狗数据集有两个类。自定义数据集可以包含更多的类，但是更多的类将需要更多的数据来实现合理的性能。</p><figure class="lx ly lz ma fq mb fe ff paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="fe ff lw"><img src="../Images/95a0cb4789ce5584a25b0675410468b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nZSheKLLBGnUtvANBwvGyw.png"/></div></div><figcaption class="mi mj fg fe ff mk ml bd b be z ek">The Dashboard screen</figcaption></figure><h2 id="c83c" class="mm kg hu bd kh mn mo mp kl mq mr ms kp jc mt mu kt jg mv mw kx jk mx my lb mz dt translated">训练和测试集</h2><p id="919a" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">为了防止泄露信息，数据集被分成训练集和测试集。训练集中的图像显示给观众中的用户进行标记。测试集中的图像用于评估准确性。这些是显示在仪表板上的图像。</p><p id="0272" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于用户提交的每个图像标签，该模型将评估一个测试图像。将最后64张测试图像的平均分数作为报告的准确度。</p><h1 id="a364" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">体系结构</h1><p id="c5ba" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">让我们深入了解应用程序的本质细节。</p><figure class="lx ly lz ma fq mb fe ff paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="fe ff na"><img src="../Images/e078b7b0995b5016432eec0a99b3044c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HhHcmoMVISBguL1mjuU_mg.png"/></div></div><figcaption class="mi mj fg fe ff mk ml bd b be z ek">Moving parts of the application</figcaption></figure><h2 id="a1ed" class="mm kg hu bd kh mn mo mp kl mq mr ms kp jc mt mu kt jg mv mw kx jk mx my lb mz dt translated">工人</h2><p id="904b" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">工人实际上是应用程序的工作马。这个python脚本在后台运行，包含Keras模型。它从消息队列接收消息，比如新的注释。它与模型交互，并将准确性统计数据推回消息队列。</p><p id="57d9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该脚本在单线程中运行。您不能让多个workers以负载平衡的方式运行，因为您需要模型从每个新注释中学习，而不仅仅是它的一部分。有多种方法以分布式方式训练模型，但这更复杂，并且对于这里使用的少量数据是不需要的。</p><h2 id="2fc6" class="mm kg hu bd kh mn mo mp kl mq mr ms kp jc mt mu kt jg mv mw kx jk mx my lb mz dt translated">模型</h2><p id="eed0" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">对于图像分类任务，卷积神经网络(CNN)是黄金标准。通常，CNN需要大量的训练数据才能表现良好。我们在这里没有这种奢侈，因为我们只有非常有限的时间让观众给图像贴标签。幸运的是，我们可以通过'<em class="nb">转移学习</em> <strong class="it hv"> ' </strong>来大幅减少所需的数据量。</p><p id="d38c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用这种技术，我们可以重用来自另一个网络的已经训练好的层，将我们自己的层放在上面，并且只训练这些最后的层。</p><figure class="lx ly lz ma fq mb fe ff paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="fe ff nc"><img src="../Images/6ee9ee04c878d78510c6cafcf0415965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3qLIf0Qcyp4qYIIqhThQXQ.png"/></div></div><figcaption class="mi mj fg fe ff mk ml bd b be z ek">Transfer Leaning</figcaption></figure><p id="8abe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">深层蜂巢模型在标准VGG-16模型的基础上增加了三层:</p><pre class="lx ly lz ma fq nd ne nf ng aw nh dt"><span id="82fe" class="mm kg hu ne b fv ni nj l nk nl">Layer (type)                 Output Shape              Param #<br/>=================================================================<br/>vgg16 (Model)                (None, 4, 4, 512)         14714688<br/>_________________________________________________________________<br/>global_average_pooling2d_1 ( (None, 512)               0<br/>_________________________________________________________________<br/>dense_1 (Dense)              (None, 256)               131328<br/>_________________________________________________________________<br/>dropout_1 (Dropout)          (None, 256)               0<br/>_________________________________________________________________<br/>dense_2 (Dense)              (None, 2)                 514<br/>=================================================================<br/>Total params: 14,846,530<br/>Trainable params: 131,842<br/>Non-trainable params: 14,714,688<br/>_________________________________________________________________</span></pre><p id="0795" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">总共有14，846，530个参数，但我们只需要训练其中的131，842个。太棒了。</p><p id="219a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因为模型需要一个接一个地学习新的图像标签，所以我们本质上是在做“<em class="nb">在线学习</em>”。这就是我选择老式SGD(随机梯度下降)优化器而不是Adam或其他具有动态学习率的优化器的原因。</p><h2 id="45d1" class="mm kg hu bd kh mn mo mp kl mq mr ms kp jc mt mu kt jg mv mw kx jk mx my lb mz dt translated">信息排队</h2><p id="01c7" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">为了简单起见，我选择Redis作为消息队列。Redis是一个流行的内存中键/值存储，但是有一个非常方便的pubsub机制。它充当工作人员和web服务器之间的中继。</p><h2 id="c608" class="mm kg hu bd kh mn mo mp kl mq mr ms kp jc mt mu kt jg mv mw kx jk mx my lb mz dt translated">网络服务器</h2><p id="2b9d" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">对web服务器的要求相当适中。提供一些静态文件，为前端公开一个小api，并将消息传递给Redis。Flask是轻量级的，非常适合这个任务。因为模型是通过worker和Redis解耦的，所以Flask可以毫无问题地多线程运行。</p><h2 id="d649" class="mm kg hu bd kh mn mo mp kl mq mr ms kp jc mt mu kt jg mv mw kx jk mx my lb mz dt translated">前端</h2><p id="013f" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">仪表板非常动态，需要在新数据到达时每秒更新多个部分几次。一个简单的React应用程序就可以完成这项工作。应用程序每300毫秒轮询一次新数据。这不能很好地扩展，但是通常只有一个控制面板在运行。使用websockets将是一个更具可伸缩性的选择。</p><h2 id="2aab" class="mm kg hu bd kh mn mo mp kl mq mr ms kp jc mt mu kt jg mv mw kx jk mx my lb mz dt translated">注释</h2><p id="140d" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">注释屏幕是为移动设备构建的，向观众成员显示图像，并为每个类显示一个按钮。单击其中一个类提交标签，并立即请求一个新的图像进行注释。</p><figure class="lx ly lz ma fq mb fe ff paragraph-image"><div class="fe ff nm"><img src="../Images/b10986d8cf535f9e80f6ffd565f89eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*rmRz-hmXSIvUgXLdBMvycA.png"/></div><figcaption class="mi mj fg fe ff mk ml bd b be z ek">The annotation screen</figcaption></figure><h2 id="c80e" class="mm kg hu bd kh mn mo mp kl mq mr ms kp jc mt mu kt jg mv mw kx jk mx my lb mz dt translated">仪表盘</h2><p id="7722" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">仪表板有4个部分:</p><figure class="lx ly lz ma fq mb fe ff paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="fe ff nn"><img src="../Images/3aa35d0de7a7b871ec8248874538abfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0HxDPAnhZyjH4YYqTza9MA.png"/></div></div></figure><ol class=""><li id="c9d8" class="li lj hu it b iu iv iy iz jc lk jg ll jk lm jo ln lo lp lq dt translated"><strong class="it hv">图像网格</strong>显示了40幅图像的完整测试集。它显示图像、预测标签和指示正确或不正确预测的颜色。</li><li id="ada7" class="li lj hu it b iu lr iy ls jc lt jg lu jk lv jo ln lo lp lq dt translated"><strong class="it hv">准确度</strong>显示测试集的准确度，背景中的图表显示趋势。图形由优秀的d3.js库渲染。</li><li id="1715" class="li lj hu it b iu lr iy ls jc lt jg lu jk lv jo ln lo lp lq dt translated"><strong class="it hv">注释计数</strong>，嗯…显示注释的图像数量。</li><li id="9cde" class="li lj hu it b iu lr iy ls jc lt jg lu jk lv jo ln lo lp lq dt translated"><strong class="it hv">简短的URL </strong>供观众在手机上输入。在我的演示中，我在Deep Hive演示之前的幻灯片中显示了一个QR码，以节省一些用户的输入。</li></ol><p id="b3ce" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">短网址下面有两个按钮:</p><ul class=""><li id="e6b9" class="li lj hu it b iu iv iy iz jc lk jg ll jk lm jo no lo lp lq dt translated"><strong class="it hv"> Reset </strong>将重置模型并重新评估测试集；</li><li id="8f3b" class="li lj hu it b iu lr iy ls jc lt jg lu jk lv jo no lo lp lq dt translated"><strong class="it hv">模拟</strong>通过在消息队列中推送完整训练集的图像标签来模拟观众。</li></ul><h1 id="91fe" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">数据集</h1><p id="c50e" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">我用两个不同的数据集测试了这个应用程序。</p><p id="6cb0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">主要的一个是<a class="ae ke" href="https://www.kaggle.com/c/dogs-vs-cats" rel="noopener ugc nofollow" target="_blank"> Kaggle狗对猫数据集</a>。这样，我在大约250个用户注释中获得了大约90%的准确率。如果你的观众有25个人，这通常用不了一分钟！</p><p id="5731" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我在为一个客户做一个花卉识别器。使用两个类的私有数据集中的图像，我得到了超过90%的160条注释。对于模型来说，这似乎是一个更容易的任务。</p><figure class="lx ly lz ma fq mb fe ff paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="fe ff lw"><img src="../Images/bd5d0ce3e7b922507fbcf874138d57d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_x6_KMJzMeTSCQI4giAqNw.png"/></div></div><figcaption class="mi mj fg fe ff mk ml bd b be z ek">The flower dataset</figcaption></figure><h1 id="3558" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">结论</h1><p id="9b6d" class="pw-post-body-paragraph ir is hu it b iu ld iw ix iy le ja jb jc lf je jf jg lg ji jj jk lh jm jn jo hn dt translated">我希望你喜欢这个应用程序和引擎盖下的窥视。如果人们感兴趣，我可能会很快增加一些功能。例如学习速率滑块或一些其他超参数控制。请在评论中告诉我你对下一个版本有什么想法。</p><p id="5d3b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请随意使用Deep Hive进行您自己的演示。我很好奇，想知道进展如何！</p></div></div>    
</body>
</html>