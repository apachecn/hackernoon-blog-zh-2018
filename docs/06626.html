<html>
<head>
<title>Historical Log Analysis and SIEM Limitations: Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">历史日志分析和SIEM限制:第二部分</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/historical-log-analysis-and-siem-limitations-part-ii-448c4be041d3?source=collection_archive---------38-----------------------#2018-08-07">https://medium.com/hackernoon/historical-log-analysis-and-siem-limitations-part-ii-448c4be041d3?source=collection_archive---------38-----------------------#2018-08-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/9d10a4c002e96033fa59036087b1cfbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5KJlqy81eY1QOcpF5l-nAw.png"/></div></div></figure><p id="e17b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在<a class="ae ka" rel="noopener" href="/p/7f3e30d30a9f/">上一部分</a>中，我们讨论了历史和SIEM提供的短期实时分析在可扩展性和性质(原因和方式)上的差异。现在让我们看看数据在两个世界是如何被处理的。</p><p id="1946" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">区分短期和长期分析的方面不仅仅是结构化和非结构化数据。事实上，它们中的一些对两种分析都是严峻的挑战，以至于导致严重的限制或昂贵的决策。</p><h2 id="8e8d" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">数据标准化</h2><p id="2743" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">让我们首先讨论日志的标准化，这是大多数SIEM供应商采用的方法。根据其<a class="ae ka" href="https://securosis.com/blog/understanding-and-selecting-siem-lm-aggregation-normalization-and-enrichmen" rel="noopener ugc nofollow" target="_blank">定义</a>的标准化包括将数据元素(即日志记录字段)减少到一个已知的公共集合。这是应用索引和一致存储事件的必要步骤。这个过程的缺点是<strong class="je hv">数据丢失</strong> : a)直接——丢弃的数据元素，b)元数据——关于日志记录结构的信息，例如字段序列、字段中的数据元素、语法模式等。</p><p id="5613" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">SIEMs通常不认为数据丢失是一个问题，因为它们的主要目标是利用已知模式进行检测。另一方面，历史分析的主要任务是发现新的信息，任何数据的丢失都会减少成功的机会。这意味着持续的正常化是一个大禁忌。</p><p id="de3e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">虽然很容易理解直接数据字段的重要性，但元数据经常被低估。但在许多情况下，元数据对于区分恶意使用模式至关重要。例如，在电子商务欺诈领域，欺诈者通常面临扩大欺诈交易规模或同时模仿正常客户行为的两难境地。他们做了相当大的努力来融入常态，通常只有自动化的痕迹才能够识别他们。自动化的痕迹可以在元数据中找到，比如查询参数的某个序列(或缺失)、X-FORWARDED-FOR头中的ip地址、JSON有效负载的组成等。将数据元素转换成JSON会使这些信息消失。</p><h2 id="9838" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">抽取、转换、加载至目的端（extract-transform-load的缩写）</h2><p id="c7aa" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">其次，规范化过程包括提取(字段)、转换(分配类型)和加载(到系统中)。<strong class="je hv"> ETL的缺点是</strong>它<strong class="je hv">不能抵抗非机器可读格式(JSON，XML)的日志的记录结构</strong>的变化。从这样的日志中提取依赖于对数据元素的顺序和格式的假设。当这种情况发生时，你基本上有两个选择，都有严重的后果:</p><ol class=""><li id="0ff4" class="lb lc hu je b jf jg jj jk jn ld jr le jv lf jz lg lh li lj dt translated">ETL过程被中止(假设解析过程能够检测到解析失败),导致系统中的<strong class="je hv">数据丢失。考虑一下丢失重要实时警报数据源的影响。</strong></li><li id="dd3f" class="lb lc hu je b jf lk jj ll jn lm jr ln jv lo jz lg lh li lj dt translated">无效数据被加载到系统中，并且<strong class="je hv">错误持续存在</strong>。显然，这可能会导致一个原本正确的分析得出错误的结论，不管它是近期的还是历史的。</li></ol><p id="4354" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从这种情况中恢复需要修复提取(解析)步骤并重复整个ETL。第二种情况实际上更糟，因为它涉及到识别和删除存储中的错误记录。尽管如此，这两者都对SIEM监控和历史分析流程有很大影响。这就是SIEM解决方案使用非常静态的输入数据(网络安全设备日志、商用web服务器日志等)的原因。事实上，我认为这是阻止使用应用程序日志进行安全事件监控和分析的主要因素。这是非常不幸的，因为应用程序日志在用于识别许多类型的恶意行为的上下文中非常丰富。</p><p id="8683" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当进行历史分析时，当您查看更长时间的日志时，结构变化的可能性甚至更高。未能识别变更等于丢失输入数据，这可能导致错误的结果和发现新信息的失败。</p><h2 id="ea5f" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">供应商锁定数据</h2><p id="31c1" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">现在应该很明显为什么<strong class="je hv">试图使用SIEM作为你的长期数据存储是一个非常糟糕的主意</strong>。然而，它甚至还有一个方面。所有输入SIEM的数据最终都以特定于供应商的格式存储。当您希望使用另一个工具尝试新的算法和方法时，您将面临导出数据的任务。如果供应商为此提供工具，那你就很幸运了。通常情况并非如此。由于供应商通常不公开他们的内部格式，导出任务实质上变成了一个逆向工程任务，从技术和法律两方面来说都有问题。回想一下，每次转换也可能导致数据丢失。</p><h2 id="7557" class="kb kc hu bd kd ke kf kg kh ki kj kk kl jn km kn ko jr kp kq kr jv ks kt ku kv dt translated">数据丰富</h2><p id="f971" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated">数据丰富的概念意味着添加补充信息(如地理位置、交易号、应用程序数据等。)到日志和事件，以增强分析和报告(此处的定义借用了<a class="ae ka" href="https://securosis.com/blog/understanding-and-selecting-siem-lm-aggregation-normalization-and-enrichmen" rel="noopener ugc nofollow" target="_blank"/>)。本质上，有两种添加补充数据的方法:I)作为日志记录的附加字段，在加载时添加；ii)作为结果集中的附加字段，在查询时添加。</p><p id="c77d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">许多SIEM只允许通过第一种方法进行浓缩。这是可以理解的，因为他们需要以实时方式交付结果，这解释了为什么他们希望卸载任何额外的处理。在执行查询之前添加补充数据在这里也不是问题，因为任务是检测已知的威胁。</p><p id="c478" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然而，这成为历史分析的一个问题。带着发现新信息的使命，在开始分析之前，您无法真正预测您需要哪些补充信息。唯一合理的方法是动态地丰富数据。</p><h1 id="7510" class="lp kc hu bd kd lq lr ls kh lt lu lv kl lw lx ly ko lz ma mb kr mc md me ku mf dt translated">摘要</h1><p id="7cb2" class="pw-post-body-paragraph jc jd hu je b jf kw jh ji jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz hn dt translated"><strong class="je hv">永远保持你的日志的原始状态。</strong>以并行方式向您的SIEM提供数据，但不要替代长期存储(即日志管理是必须具备的)。这样，您可以避免数据丢失和供应商锁定的情况。</p><p id="c900" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">使用分析工具，允许在查询期间定义数据的模式/格式</strong>(与ETL期间相反)<strong class="je hv">。</strong>这为您提供了适应日志记录结构变化的灵活性。如果该工具能够通知您更改，那就更好了。</p><p id="e709" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">总而言之，我认为SIEM供应商将会努力征服长期分析领域。</p></div></div>    
</body>
</html>