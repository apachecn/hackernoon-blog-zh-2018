<html>
<head>
<title>Start testing your GraphQL Schema, Queries and, Mutations!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开始测试你的GraphQL模式，查询和，突变！</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/start-testing-your-graphql-schema-queries-and-mutations-b514911b1368?source=collection_archive---------2-----------------------#2018-08-15">https://medium.com/hackernoon/start-testing-your-graphql-schema-queries-and-mutations-b514911b1368?source=collection_archive---------2-----------------------#2018-08-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/a9beed70463316b5bbe5bcb4b8ab43d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*9VyBulcxDuGbfz9FfcZMbg.png"/></div><figcaption class="iy iz fg fe ff ja jb bd b be z ek"><a class="ae jc" href="https://github.com/EasyGraphQL" rel="noopener ugc nofollow" target="_blank">EasyGraphQL</a>: Free open source tools for GraphQL</figcaption></figure><p id="7b58" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">对您的代码进行一些测试总是一个您应该实现的好习惯。你所做的测试将帮助你防止一些错误，也将确保你的应用程序如你所想的那样工作。</p><p id="cd20" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">有时进行测试可能很困难，需要大量的代码，但大多数时候这取决于您用来测试代码的实现；有一些包可以帮助你用几行代码进行测试。</p><p id="cd71" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">今天我将介绍<code class="eh kb kc kd ke b"><a class="ae jc" href="https://github.com/EasyGraphQL/easygraphql-tester" rel="noopener ugc nofollow" target="_blank">easygraphql-tester</a></code>，它是一个npm包，将帮助您在服务器端和客户端测试您的模式、查询和突变。</p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><h2 id="3c25" class="km kn hu bd ko kp kq kr ks kt ku kv kw jo kx ky kz js la lb lc jw ld le lf lg dt translated"><strong class="ak">怎么用？</strong></h2><p id="7554" class="pw-post-body-paragraph jd je hu jf b jg lh ji jj jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka hn dt translated">使用<code class="eh kb kc kd ke b"><a class="ae jc" href="https://github.com/EasyGraphQL/easygraphql-tester" rel="noopener ugc nofollow" target="_blank">easygraphql-tester</a></code>不需要很多额外的代码来测试你的模式、查询和变异。</p><p id="c628" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated"><strong class="jf hv">第一步:</strong></p><ul class=""><li id="ecc2" class="lm ln hu jf b jg jh jk jl jo lo js lp jw lq ka lr ls lt lu dt translated">导入包<code class="eh kb kc kd ke b"><a class="ae jc" href="https://github.com/EasyGraphQL/easygraphql-tester" rel="noopener ugc nofollow" target="_blank">easygraphql-tester</a></code></li><li id="19d2" class="lm ln hu jf b jg lv jk lw jo lx js ly jw lz ka lr ls lt lu dt translated">读取GraphQL模式</li><li id="cbe5" class="lm ln hu jf b jg lv jk lw jo lx js ly jw lz ka lr ls lt lu dt translated">初始化测试器并将schemaCode传递给它</li></ul><pre class="ma mb mc md fq me ke mf mg aw mh dt"><span id="fcd3" class="km kn hu ke b fv mi mj l mk ml">const EasyGraphQLTester = require('easygraphql-tester')<br/>const fs = require('fs')<br/>const path = require('path')<br/><br/>const schemaCode = fs.readFileSync(path.join(__dirname, 'schema.gql'), 'utf8')<br/><br/>const tester = new EasyGraphQLTester(schemaCode)</span></pre><p id="aade" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated"><strong class="jf hv">测试查询:</strong></p><ul class=""><li id="e7f4" class="lm ln hu jf b jg jh jk jl jo lo js lp jw lq ka lr ls lt lu dt translated">将查询设置为<code class="eh kb kc kd ke b">const</code></li><li id="f07f" class="lm ln hu jf b jg lv jk lw jo lx js ly jw lz ka lr ls lt lu dt translated">如果测试应该通过，调用<code class="eh kb kc kd ke b">tester</code> pass中的<code class="eh kb kc kd ke b">test</code>,作为第一个参数，作为第二个参数，作为第三个参数，输入期望的变量</li></ul><pre class="ma mb mc md fq me ke mf mg aw mh dt"><span id="0afe" class="km kn hu ke b fv mi mj l mk ml">const EasyGraphQLTester = require('easygraphql-tester')<br/>const fs = require('fs')<br/>const path = require('path')<br/><br/>const schemaCode = fs.readFileSync(path.join(__dirname, 'schema', 'schema.gql'), 'utf8')<br/>const tester = new EasyGraphQLTester(schemaCode)<br/><br/>const query = `<br/>  {<br/>    getMe {<br/>      id<br/>      email<br/>      familyInfo {<br/>        father {<br/>          email<br/>        }<br/>        mother {<br/>          username<br/>        }<br/>      }<br/>    }<br/>  }<br/>`</span><span id="0b77" class="km kn hu ke b fv mm mj l mk ml">tester.test(true, query)</span></pre><p id="e34a" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">如果查询成功，它将返回您请求的字段的模拟。测试人员还将验证参数，以防查询需要一些参数和参数类型。</p><p id="ab71" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated"><strong class="jf hv">测试一个突变:</strong></p><ul class=""><li id="71d6" class="lm ln hu jf b jg jh jk jl jo lo js lp jw lq ka lr ls lt lu dt translated">将变异设为<code class="eh kb kc kd ke b">const</code></li><li id="b11d" class="lm ln hu jf b jg lv jk lw jo lx js ly jw lz ka lr ls lt lu dt translated">如果测试应该通过，从<code class="eh kb kc kd ke b">tester</code> pass调用<code class="eh kb kc kd ke b">test</code>,作为第一个参数，作为第二个参数，作为第三个参数，输入期望的变量</li></ul><pre class="ma mb mc md fq me ke mf mg aw mh dt"><span id="6b96" class="km kn hu ke b fv mi mj l mk ml">const EasyGraphQLTester = require('easygraphql-tester')<br/>const fs = require('fs')<br/>const path = require('path')<br/><br/>const schemaCode = fs.readFileSync(path.join(__dirname, 'schema', 'schema.gql'), 'utf8')<br/>const tester = new EasyGraphQLTester(schemaCode)<br/><br/>const mutation = `<br/>  mutation CreateUser{<br/>    createUser {<br/>      email<br/>    }<br/>  }<br/>`</span><span id="8a9f" class="km kn hu ke b fv mm mj l mk ml">tester.test(true, mutation, {<br/>  email: 'test@test.com',<br/>  username: 'test',<br/>  fullName: 'test',<br/>  password: 'test'<br/>})</span></pre><p id="980f" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">如果查询成功，它将返回您在变异中请求的字段的模拟。</p><h2 id="55a1" class="km kn hu bd ko kp kq kr ks kt ku kv kw jo kx ky kz js la lb lc jw ld le lf lg dt translated">嘲弄查询和变异:</h2><p id="290e" class="pw-post-body-paragraph jd je hu jf b jg lh ji jj jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka hn dt translated"><code class="eh kb kc kd ke b"><a class="ae jc" href="https://github.com/EasyGraphQL/easygraphql-tester" rel="noopener ugc nofollow" target="_blank">easygraphql-tester</a></code>可以作为你的查询或变异的模仿者，使用它很简单。</p><p id="0ded" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">调用方法<code class="eh kb kc kd ke b">.mock()</code>并传递一个带有以下选项的对象:</p><ul class=""><li id="dc76" class="lm ln hu jf b jg jh jk jl jo lo js lp jw lq ka lr ls lt lu dt translated">查询:这将是要测试的查询/变异。</li><li id="eace" class="lm ln hu jf b jg lv jk lw jo lx js ly jw lz ka lr ls lt lu dt translated">变量:如果是一个变异，这是必需的，它必须是一个带有输入字段的对象。</li><li id="7e3c" class="lm ln hu jf b jg lv jk lw jo lx js ly jw lz ka lr ls lt lu dt translated">fixture:这是可选的，如果你想通过你的自定义fixture。</li><li id="1685" class="lm ln hu jf b jg lv jk lw jo lx js ly jw lz ka lr ls lt lu dt translated">saveFixture:默认为<code class="eh kb kc kd ke b">false</code>，如果传递Fixtures，当再次进行相同的查询时，将其设置为<code class="eh kb kc kd ke b">true</code>，它将返回fixture值。</li></ul><p id="d312" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">结果将具有顶级字段，这意味着结果将是一个具有属性的对象，该属性将是带有模拟结果的查询或别名的名称(顶级字段)。</p><h2 id="562f" class="km kn hu bd ko kp kq kr ks kt ku kv kw jo kx ky kz js la lb lc jw ld le lf lg dt translated">模拟例子</h2><pre class="ma mb mc md fq me ke mf mg aw mh dt"><span id="033c" class="km kn hu ke b fv mi mj l mk ml">'use strict'</span><span id="9f5e" class="km kn hu ke b fv mm mj l mk ml">const EasyGraphQLTester = require('easygraphql-tester')<br/>const fs = require('fs')<br/>const path = require('path')</span><span id="385b" class="km kn hu ke b fv mm mj l mk ml">const userSchema = fs.readFileSync(path.join(__dirname, 'schema', 'user.gql'), 'utf8')</span><span id="8885" class="km kn hu ke b fv mm mj l mk ml">const tester = new EasyGraphQLTester(userSchema)</span><span id="1f8f" class="km kn hu ke b fv mm mj l mk ml">const query = `<br/>  {<br/>    getUser(id: "1") {<br/>      id<br/>      name<br/>      familyInfo {<br/>        lastName<br/>        email<br/>      }<br/>    }<br/>  }<br/>`</span><span id="8121" class="km kn hu ke b fv mm mj l mk ml">const fixture = {<br/>  id: '1',<br/>  name: 'EasyGraphQL'<br/>}</span><span id="9a19" class="km kn hu ke b fv mm mj l mk ml">const { getUser } = tester.mock({ query, fixture })</span><span id="1da8" class="km kn hu ke b fv mm mj l mk ml">// getUser<br/>{ <br/>  id: '1',<br/>  name: 'EasyGraphQL',<br/>  familyInfo: [<br/>    { <br/>      lastName: 'Bartoletti',<br/>      email: 'YSjsYuV@wtnK.com'<br/>    },<br/>    { <br/>      lastName: 'Bartoletti',<br/>      email: 'YSjsYuV@wtnK.com'<br/>    },<br/>    { <br/>      lastName: 'Bartoletti',<br/>      email: 'YSjsYuV@wtnK.com'<br/>    }<br/>  ]<br/>}</span></pre><h2 id="dc57" class="km kn hu bd ko kp kq kr ks kt ku kv kw jo kx ky kz js la lb lc jw ld le lf lg dt translated">错误:</h2><p id="5906" class="pw-post-body-paragraph jd je hu jf b jg lh ji jj jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka hn dt translated">如果查询上有错误或突变<code class="eh kb kc kd ke b"><a class="ae jc" href="https://github.com/EasyGraphQL/easygraphql-tester" rel="noopener ugc nofollow" target="_blank">easygraphql-tester</a></code>会让你知道发生了什么。</p><p id="15ab" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated"><strong class="jf hv">试图访问getMe上的无效字段id-&gt;父亲</strong></p><pre class="ma mb mc md fq me ke mf mg aw mh dt"><span id="1f30" class="km kn hu ke b fv mi mj l mk ml">const EasyGraphQLTester = require('easygraphql-tester')<br/>const fs = require('fs')<br/>const path = require('path')<br/><br/>const schemaCode = fs.readFileSync(path.join(__dirname, 'schema', 'schema.gql'), 'utf8')<br/>const tester = new EasyGraphQLTester(schemaCode)<br/><br/>const query = `<br/>  {<br/>    getMe {<br/>      id<br/>      email<br/>      familyInfo {<br/>        father {<br/>          id<br/>          email<br/>        }<br/>      }<br/>    }<br/>  }<br/>`<br/>tester.test(true, query) // Error: Invalid field id on getMe</span></pre><p id="7556" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated"><strong class="jf hv">查询上的无效参数</strong></p><pre class="ma mb mc md fq me ke mf mg aw mh dt"><span id="5aa8" class="km kn hu ke b fv mi mj l mk ml">const EasyGraphQLTester = require('easygraphql-tester')<br/>const fs = require('fs')<br/>const path = require('path')<br/><br/>const schemaCode = fs.readFileSync(path.join(__dirname, 'schema', 'schema.gql'), 'utf8')<br/>const tester = new EasyGraphQLTester(schemaCode)<br/><br/>const getUserByUsername = `<br/>  {<br/>    getUserByUsername(username: 1, name: test) {<br/>      email<br/>    }<br/>  }<br/>`<br/><br/>tester.test(true, getUserByUsername) // Error: username argument is not type String</span></pre><p id="8085" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated"><strong class="jf hv">输入</strong>上缺少字段</p><pre class="ma mb mc md fq me ke mf mg aw mh dt"><span id="5215" class="km kn hu ke b fv mi mj l mk ml">const EasyGraphQLTester = require('easygraphql-tester')<br/>const fs = require('fs')<br/>const path = require('path')<br/><br/>const schemaCode = fs.readFileSync(path.join(__dirname, 'schema', 'schema.gql'), 'utf8')<br/>const tester = new EasyGraphQLTester(schemaCode)<br/><br/>const mutation = `<br/>  mutation CreateUser{<br/>    createUser {<br/>      email<br/>    }<br/>  }<br/>`<br/>const test = tester.test(true, mutation, {<br/>  email: 'test@test.com',<br/>  fullName: 'test',<br/>  password: 'test'<br/>})<br/>// Error: username argument is missing on createUser</span></pre><h2 id="a9a2" class="km kn hu bd ko kp kq kr ks kt ku kv kw jo kx ky kz js la lb lc jw ld le lf lg dt translated"><strong class="ak">配合摩卡使用&amp;柴:</strong></h2><p id="7a63" class="pw-post-body-paragraph jd je hu jf b jg lh ji jj jk li jm jn jo lj jq jr js lk ju jv jw ll jy jz ka hn dt translated">为了在测试中获得更好的结果，你可以将它与Mocha &amp; Chai一起使用(也可以将它与你最喜欢的一起使用)来测试结果并验证返回的字段。</p><pre class="ma mb mc md fq me ke mf mg aw mh dt"><span id="df57" class="km kn hu ke b fv mi mj l mk ml">'use strict'<br/><br/>const fs = require('fs')<br/>const path = require('path')<br/>const { expect } = require('chai')<br/>const EasyGraphQLTester = require('../lib')<br/><br/>const schemaCode = fs.readFileSync(path.join(__dirname, 'schema', 'schema.gql'), 'utf8')<br/><br/>describe('Mutation', () =&gt; {<br/>  let tester<br/><br/>  before(() =&gt; {<br/>    tester = new EasyGraphQLTester(schemaCode)<br/>  })<br/><br/>  describe('Should throw an error if variables are missing', () =&gt; {<br/>    it('Should throw an error if the variables are missing', () =&gt; {<br/>      let error<br/>      try {<br/>        const mutation = `<br/>          mutation CreateUser{<br/>            createUser {<br/>              email<br/>            }<br/>          }<br/>        `<br/>        tester.mock(mutation)<br/>      } catch (err) {<br/>        error = err<br/>      }<br/><br/>      expect(error).to.be.an.instanceOf(Error)<br/>      expect(error.message).to.be.eq('Variables are missing')<br/>    })<br/>  })<br/><br/>  describe('Should return selected fields', () =&gt; {<br/>    it('Should return selected fields', () =&gt; {<br/>      const mutation = `<br/>        mutation CreateUser{<br/>          createUser {<br/>            email<br/>          }<br/>        }<br/>      `<br/>      const test = tester.mock(mutation, {<br/>        email: 'test@test.com',<br/>        username: 'test',<br/>        fullName: 'test',<br/>        password: 'test'<br/>      })<br/><br/>      expect(test).to.exist<br/>      expect(test.email).to.be.a('string')<br/>    })<br/>  })<br/>})</span></pre></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><p id="9dc6" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">如果你喜欢这个包，别忘了在GitHub上给个⭐️</p><p id="1f9f" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">模拟演示:<a class="ae jc" href="https://repl.it/@alejandroestrada/easygraphql-tester" rel="noopener ugc nofollow" target="_blank">https://repl.it/@alejandroestrada/easygraphql-tester</a></p><p id="91f5" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">带笑话的演示:<a class="ae jc" href="https://codesandbox.io/s/42m2rx71j4" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/42m2rx71j4</a></p><p id="1feb" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">回购:<a class="ae jc" href="https://github.com/EasyGraphQL/easygraphql-tester" rel="noopener ugc nofollow" target="_blank">https://github.com/EasyGraphQL/easygraphql-tester</a></p><p id="f704" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">国家预防机制:<a class="ae jc" href="https://www.npmjs.com/package/easygraphql-tester" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/easygraphql-tester</a></p><p id="4be5" class="pw-post-body-paragraph jd je hu jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hn dt translated">【https://easygraphql.com/】网站:<a class="ae jc" href="https://easygraphql.com/" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>