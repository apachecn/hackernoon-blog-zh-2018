<html>
<head>
<title>Using babel 7 with node</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用babel 7和node</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/using-babel-7-with-node-7e401bc28b04?source=collection_archive---------0-----------------------#2018-08-16">https://medium.com/hackernoon/using-babel-7-with-node-7e401bc28b04?source=collection_archive---------0-----------------------#2018-08-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="716a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以你想用node的新巴别塔7？我们这里的目标是建立一个最小的节点应用程序，它能够在本地运行，并且有一个用于远程部署的构建命令。我们开始吧！</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/217cc96a6519e8eb82c938a7eb77080b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tcJeNVYJST_f-8YEIh_rFA.jpeg"/></div></div><figcaption class="kb kc fg fe ff kd ke bd b be z ek">Medium kinda forces me to make these… I know…</figcaption></figure><p id="b85d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可能熟悉的巴别塔和v7有一些不同。</p><ol class=""><li id="221e" class="kf kg hu it b iu iv iy iz jc kh jg ki jk kj jo kk kl km kn dt translated"><strong class="it hv">巴别塔软件包现已确定范围</strong>就像许多其他大型组织一样，巴别塔已将其更名为NPM软件包。这意味着例如<code class="eh ko kp kq kr b">babel-cli</code>已经被重命名为<code class="eh ko kp kq kr b">@babel/cli</code>。</li><li id="34a0" class="kf kg hu it b iu ks iy kt jc ku jg kv jk kw jo kk kl km kn dt translated"><strong class="it hv">不要再摆弄预设了。现在你可以使用<code class="eh ko kp kq kr b">@babel/preset-env</code>并在配置文件中定义你的需求。</strong></li><li id="e616" class="kf kg hu it b iu ks iy kt jc ku jg kv jk kw jo kk kl km kn dt translated"><code class="eh ko kp kq kr b"><strong class="it hv">babel-node</strong></code> <strong class="it hv">已经从CLI中的</strong>移动到它自己的包:<code class="eh ko kp kq kr b">@babel/node</code></li></ol><p id="8fb0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">好了，我们把最重要的事情都记下来了。你可以选择在babels网站上阅读更多关于这些变化的信息，但我们接下来需要做的是:</p><h2 id="e4b6" class="ky kz hu bd la lb lc ld le lf lg lh li jc lj lk ll jg lm ln lo jk lp lq lr ls dt translated">设置应用程序结构</h2><p id="24b6" class="pw-post-body-paragraph ir is hu it b iu lt iw ix iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo hn dt translated">我们将尽可能保持简单:</p><p id="897c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，您想运行<code class="eh ko kp kq kr b">npm init</code>在目录中创建一个<code class="eh ko kp kq kr b">package.json</code>文件，根据您是否使用Git，您可能想运行<code class="eh ko kp kq kr b">git init</code></p><p id="15b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将建立两个目录，一个用于开发，另一个用于部署我们编译的资产。</p><pre class="jq jr js jt fq ly kr lz ma aw mb dt"><span id="0489" class="ky kz hu kr b fv mc md l me mf">your-project-directory<br/>|--dist<br/>|--src<br/>|--package.json</span></pre><p id="5102" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于这个例子，我们将在src目录中添加一个简单的文件，名为<code class="eh ko kp kq kr b">server.js</code></p><pre class="jq jr js jt fq ly kr lz ma aw mb dt"><span id="3b0c" class="ky kz hu kr b fv mc md l me mf">your-project-directory<br/>|--dist<br/>|--src<br/>|  |--server.js<br/>|--package.json</span></pre><p id="5826" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们需要用<code class="eh ko kp kq kr b">npm install --save-dev @babel/core @babel/cli @babel/preset-env @babel/node</code>给我们的项目添加一些babel包。这些分别负责babel的一般工作，babel在命令行中的使用，使用最新JS特性的能力和babel与node的使用。</p><p id="149b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了便于开发，我们还将使用<code class="eh ko kp kq kr b">npm install --save-dev</code>添加<code class="eh ko kp kq kr b">nodemon</code>包，当我们的一个文件被更改时，它会自动为我们重新加载node。</p><p id="4ec1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，我们只需要通过在我们的项目根目录下创建一个<code class="eh ko kp kq kr b">.babelrc</code>文件来告诉babel使用<code class="eh ko kp kq kr b">@babel/preset-env</code>包:</p><pre class="jq jr js jt fq ly kr lz ma aw mb dt"><span id="43b8" class="ky kz hu kr b fv mc md l me mf">// .babelrc<br/>{<br/>  "presets": ["@babel/preset-env"]<br/>}</span></pre><p id="860d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您的项目结构现在应该如下所示:</p><pre class="jq jr js jt fq ly kr lz ma aw mb dt"><span id="85c2" class="ky kz hu kr b fv mc md l me mf">your-project-directory<br/>|--dist<br/>|--node_modules<br/>|--src<br/>|  |--server.js<br/>|--package.json<br/>|--.babelrc</span></pre><h2 id="4042" class="ky kz hu bd la lb lc ld le lf lg lh li jc lj lk ll jg lm ln lo jk lp lq lr ls dt translated">向<code class="eh ko kp kq kr b">package.json</code>添加脚本</h2><p id="5381" class="pw-post-body-paragraph ir is hu it b iu lt iw ix iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo hn dt translated">现在是最后一步，我们将命令添加到<code class="eh ko kp kq kr b">package.json</code>文件中。</p><ul class=""><li id="c6bc" class="kf kg hu it b iu iv iy iz jc kh jg ki jk kj jo mg kl km kn dt translated">添加<code class="eh ko kp kq kr b">nodemon --exec babel-node src/server.js</code>作为<code class="eh ko kp kq kr b">start</code>脚本。这告诉nodemon包监视文件更改，当它检测到更改时重新加载，并使用babel-node运行文件<code class="eh ko kp kq kr b">src/server.js</code>。我们将在本地开发时使用它。</li><li id="a5d7" class="kf kg hu it b iu ks iy kt jc ku jg kv jk kw jo mg kl km kn dt translated">添加<code class="eh ko kp kq kr b">babel src --out-dir dist</code>作为<code class="eh ko kp kq kr b">build</code>脚本。这告诉babel编译来自<code class="eh ko kp kq kr b">src</code>目录的文件，并将它们放在<code class="eh ko kp kq kr b">dist</code>目录中。</li><li id="3462" class="kf kg hu it b iu ks iy kt jc ku jg kv jk kw jo mg kl km kn dt translated">添加<code class="eh ko kp kq kr b">node dist/server.js</code>作为<code class="eh ko kp kq kr b">serve</code>脚本。这使我们能够在服务器上运行我们编译的代码，我们不仅仅使用<code class="eh ko kp kq kr b">nodemon</code>的原因是它使用了比使用<code class="eh ko kp kq kr b">node</code>多得多的内存，并增加了一些启动时间，这对一些应用程序来说是好的，但对其他应用程序来说可能会有很大的性能影响。</li></ul><p id="e4a5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您的<code class="eh ko kp kq kr b">package.json</code>现在应该看起来像这样:</p><pre class="jq jr js jt fq ly kr lz ma aw mb dt"><span id="731f" class="ky kz hu kr b fv mc md l me mf">{<br/>  "name": "my-app",<br/>  "version": "1.0.0",<br/>  "description": "",<br/>  "main": "src/server.js",<br/>  "scripts": {<br/>    "start": "nodemon --exec babel-node src/server.js",<br/>    "build": "babel src --out-dir dist",<br/>    "serve": "node dist/server.js"<br/>  },<br/>  "author": "",<br/>  "license": "ISC",<br/>  "dependencies": {<br/>  },<br/>  "devDependencies": {<br/>    "<a class="ae kx" href="http://twitter.com/babel/cli" rel="noopener ugc nofollow" target="_blank">@babel/cli</a>": "^7.0.0-rc.1",<br/>    "<a class="ae kx" href="http://twitter.com/babel/core" rel="noopener ugc nofollow" target="_blank">@babel/core</a>": "^7.0.0-rc.1",<br/>    "<a class="ae kx" href="http://twitter.com/babel/node" rel="noopener ugc nofollow" target="_blank">@babel/node</a>": "^7.0.0-rc.1",<br/>    "<a class="ae kx" href="http://twitter.com/babel/preset-env" rel="noopener ugc nofollow" target="_blank">@babel/preset-env</a>": "^7.0.0-rc.1",<br/>    "nodemon": "^1.18.3"<br/>  }<br/>}</span></pre><h2 id="60b1" class="ky kz hu bd la lb lc ld le lf lg lh li jc lj lk ll jg lm ln lo jk lp lq lr ls dt translated">祝发展愉快，好运！</h2><p id="ca81" class="pw-post-body-paragraph ir is hu it b iu lt iw ix iy lu ja jb jc lv je jf jg lw ji jj jk lx jm jn jo hn dt translated">如果你有任何问题或建议，我会在评论中看到你，或者你可以通过twitter 打电话给我<a class="ae kx" href="https://twitter.com/will_rut" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="jq jr js jt fq ju"><div class="bz el l di"><div class="mh mi l"/></div></figure></div></div>    
</body>
</html>