<html>
<head>
<title>PostgreSQL vs MongoDB v2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PostgreSQL vs MongoDB v2</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/https-medium-com-cn007b-postgresql-vs-mongodb-v2-5b5b2de6990f?source=collection_archive---------3-----------------------#2018-08-16">https://medium.com/hackernoon/https-medium-com-cn007b-postgresql-vs-mongodb-v2-5b5b2de6990f?source=collection_archive---------3-----------------------#2018-08-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/de3bb6305b457db607d14c4dfa675f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AQa_9wUQG9j296A3_SoE0g.png"/></div></div></figure><div class=""/><div class=""><h2 id="3838" class="pw-subtitle-paragraph jc ie if bd b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ek translated">在相同数据集上测试PostgreSQL和MongoDB的读取性能</h2></div><h2 id="e1a2" class="ju jv if bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">TL；博士:</h2><p id="b737" class="pw-post-body-paragraph ks kt if ku b kv kw jg kx ky kz jj la kf lb lc ld kj le lf lg kn lh li lj lk hn dt translated">在第一篇<a class="ae ll" href="https://hackernoon.com/https-medium-com-cn007b-postgresql-vs-mongodb-6d8bdb7c1697" rel="noopener ugc nofollow" target="_blank">文章</a>中，我已经概述了如何决定在一个特殊的情况下(也许是一种罕见的情况)使用特定的数据库。但是在收到信息、评论和反馈后，感觉这种情况被认为是普遍的。因此，我改进并扩展了我的基准，我将与您分享最新信息。</p><h2 id="8425" class="ju jv if bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">未更改</h2><p id="931f" class="pw-post-body-paragraph ks kt if ku b kv kw jg kx ky kz jj la kf lb lc ld kj le lf lg kn lh li lj lk hn dt translated">数据模式保持不变(两个实体:<code class="eh lm ln lo lp b">storage</code>和<code class="eh lm ln lo lp b">file,</code>，具有关系<code class="eh lm ln lo lp b">1 to many</code>)。</p><p id="d5da" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated"><code class="eh lm ln lo lp b">postgres</code>数据示例:</p><figure class="lv lw lx ly fq hw"><div class="bz el l di"><div class="lz ma l"/></div></figure><p id="f127" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated"><code class="eh lm ln lo lp b">mongo</code>数据示例:</p><figure class="lv lw lx ly fq hw"><div class="bz el l di"><div class="lz ma l"/></div></figure><h2 id="e31b" class="ju jv if bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">改变的</h2><p id="3bce" class="pw-post-body-paragraph ks kt if ku b kv kw jg kx ky kz jj la kf lb lc ld kj le lf lg kn lh li lj lk hn dt translated">导入数据库<strong class="ku ig"> 2500 </strong>条目为<code class="eh lm ln lo lp b">storage</code> <em class="mb"> </em>数据，导入<strong class="ku ig"> 24705 </strong>条目为<code class="eh lm ln lo lp b">file</code>数据(分别为500和4924 <strong class="ku ig">)。</strong></p><p id="bb6d" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated">在这次基准测试中，添加了更多的查询。<br/>不仅考虑了之前基准测试中的<code class="eh lm ln lo lp b">query1</code>:</p><p id="60f5" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated"><code class="eh lm ln lo lp b">query1</code> <code class="eh lm ln lo lp b">postgres</code>:</p><figure class="lv lw lx ly fq hw"><div class="bz el l di"><div class="lz ma l"/></div></figure><p id="44b1" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated"><code class="eh lm ln lo lp b">query1</code> <code class="eh lm ln lo lp b">mongo</code>:</p><figure class="lv lw lx ly fq hw"><div class="bz el l di"><div class="lz ma l"/></div></figure><p id="b47e" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated">而且还添加了一堆else查询。</p><p id="4b13" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated">更新的数据库版本:<code class="eh lm ln lo lp b"><em class="mb">PostgreSQL</em></code> <em class="mb"> 10.0 </em> → 10.5，<code class="eh lm ln lo lp b">MongoDB</code> 3.4.9 → 4.0.1。</p><p id="3d14" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated">增加了衡量后续步骤花费时间的基准:</p><ul class=""><li id="e17d" class="mc md if ku b kv lq ky lr kf me kj mf kn mg lk mh mi mj mk dt translated"><code class="eh lm ln lo lp b">v1</code> —连接数据库，从数据库获取数据，打印数据。</li><li id="ead2" class="mc md if ku b kv ml ky mm kf mn kj mo kn mp lk mh mi mj mk dt translated"><code class="eh lm ln lo lp b">v2</code> —从数据库获取数据，打印数据(不测量连接时间)。</li></ul><h2 id="34c1" class="ju jv if bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">基准测试:</h2><p id="c029" class="pw-post-body-paragraph ks kt if ku b kv kw jg kx ky kz jj la kf lb lc ld kj le lf lg kn lh li lj lk hn dt translated">关于<code class="eh lm ln lo lp b">Docker</code>、<code class="eh lm ln lo lp b">PostgreSQL</code>、<code class="eh lm ln lo lp b">MongoDB</code>等的所有技术信息。你可以在<a class="ae ll" href="https://github.com/cn007b/benchmark-postgres-mongo" rel="noopener ugc nofollow" target="_blank"> github repo </a>中找到。</p><h2 id="1008" class="ju jv if bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">结果:</h2><p id="a05b" class="pw-post-body-paragraph ks kt if ku b kv kw jg kx ky kz jj la kf lb lc ld kj le lf lg kn lh li lj lk hn dt translated">对我来说，在我的电脑上结果看起来像:</p><pre class="lv lw lx ly fq mq lp mr ms aw mt dt"><span id="03b1" class="ju jv if lp b fv mu mv l mw mx">+-------------+--------------------+--------------------+<br/>| Benchmark # | PostgreSQL 10.5    | MongoDB 4.0.1      |<br/>+-------------+--------------------+--------------------+<br/>| v1.query1   | 34137 microseconds | 52020 microseconds |<br/>| v1.query2   | 20691 microseconds | 14950 microseconds |<br/>| v1.query3   | 15952 microseconds | 14410 microseconds |<br/>| v1.query4   | 18025 microseconds | 15389 microseconds |<br/>+-------------+--------------------+--------------------+<br/>| v2.query1   | 33596 microseconds | 43352 microseconds |<br/>| v2.query2   | 20072 microseconds |  1711 microseconds |<br/>| v2.query3   | 14750 microseconds |   573 microseconds |<br/>| v2.query4   | 17727 microseconds |  1678 microseconds |<br/>+-------------+--------------------+--------------------+</span></pre><p id="e61a" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated">我从这个表中省略了许多基准测试，因为在简单的查询中<code class="eh lm ln lo lp b">mongo</code>比<code class="eh lm ln lo lp b">postgres</code>要快。</p><h2 id="2b60" class="ju jv if bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">结论:</h2><p id="d22e" class="pw-post-body-paragraph ks kt if ku b kv kw jg kx ky kz jj la kf lb lc ld kj le lf lg kn lh li lj lk hn dt translated">只有在我的<code class="eh lm ln lo lp b">query1</code>中，<code class="eh lm ln lo lp b">postgres</code>比<code class="eh lm ln lo lp b">mongo</code>更快(因为<code class="eh lm ln lo lp b">$unwind</code>)对于所有其他查询来说<code class="eh lm ln lo lp b">mongo</code>比<code class="eh lm ln lo lp b">postgres</code>更快。</p><p id="83ec" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated">问题是:对于您的特定情况，哪个数据库更快？<br/>答案:你要基准！)</p><p id="e0d3" class="pw-post-body-paragraph ks kt if ku b kv lq jg kx ky lr jj la kf ls lc ld kj lt lf lg kn lu li lj lk hn dt translated">PS:如果您对基准测试有什么有趣的疑问，请告诉我。</p></div></div>    
</body>
</html>