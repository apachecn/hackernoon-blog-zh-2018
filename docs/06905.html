<html>
<head>
<title>IEEE’s camera identification challenge — different approach to teaming up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">IEEE的相机识别挑战——不同的合作方式</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/ieees-camera-identification-challenge-different-approach-to-teaming-up-28da44dfe635?source=collection_archive---------18-----------------------#2018-08-16">https://medium.com/hackernoon/ieees-camera-identification-challenge-different-approach-to-teaming-up-28da44dfe635?source=collection_archive---------18-----------------------#2018-08-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/7348c42a68634653eae453ba1aaa9c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*72DAURrm-1thjuojAb5rEg.png"/></div></div></figure><p id="4c72" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ka">最近，我们推出了一系列新的</em> <a class="ae kb" rel="noopener" href="/@dbrainio/amazon-basin-from-space-competitive-approach-to-train-neural-network-736937902dd0"> <em class="ka">机器学习文章</em> </a> <em class="ka">，由我们的首席数据科学家Artur Kuzin执行。今天，阿图尔带着他的一个新故事出现了，他谈到了作为导师参加“IEEE的相机模型识别”比赛的情况，并分享了他最近在团队管理和解决问题方面的经验。</em></p><h1 id="90ef" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">问题陈述</h1><p id="3108" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">今年冬天，我作为导师参加了“IEEE信号处理学会——相机型号识别”竞赛。问题是识别拍摄图像的相机。图像集合中有十个相机型号作为类别:两个iPhones、七个Android手机和一个DSLR相机。</p><p id="0f34" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">问题是识别拍摄图像的相机。图像集合中有十个相机型号作为类别:两个iPhones、七个Android手机和一个DSLR相机。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lf"><img src="../Images/abd3ae63ac48e13b853cc41029b5c6f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8GTYXRcmmnc2YCpsHMoFHQ.png"/></div></div></figure><h1 id="f476" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">主要思想</h1><p id="e31a" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">通常，你有<a class="ae kb" rel="noopener" href="/@ksusorokina/image-classification-with-convolutional-neural-networks-496815db12a8">深度学习解决方案</a>将图像上的各种物体相互区分开来(即猫对狗、色情对比基尼、汽车对公共汽车)。与此同时，猫(或汽车)的照片在拍摄方式和设备上不应该有任何区别。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lk"><img src="../Images/cb2a020408e6867199d3cc429314f8a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eagfgbEmSZYUXTCyutFkVQ.png"/></div></div></figure><p id="3c96" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个竞赛正好相反:不管照片上的物体是什么，我们都需要识别设备。这意味着，我们必须考虑传感器噪声、图像处理伪像、光学缺陷等因素。</p><h1 id="05ee" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">团队互动</h1><p id="823c" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">大多数kaggle团队由排行榜分数相似的参与者组成，每个团队成员都有自己的工作解决方案渠道。早些时候，我写了一篇<a class="ae kb" href="https://habr.com/company/ods/blog/413667/" rel="noopener ugc nofollow" target="_blank">文章</a>，其中有一个很好的例子。但是这一次我们用了另一种方式:我们将管道分成连续和独立的部分，所以每个团队成员都专注于自己的部分。</p><h1 id="19a3" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">解决办法</h1><p id="fa7a" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated"><strong class="je hv">数据挖掘。</strong>本次比赛允许使用外部数据集。我们的团队成员<a class="ae kb" href="https://www.kaggle.com/fartuk1" rel="noopener ugc nofollow" target="_blank">阿图尔·法塔霍夫</a>基于<a class="ae kb" href="https://medium.freecodecamp.org/how-to-scrape-websites-with-python-and-beautifulsoup-5946935d93fe?gi=441d5e833bff" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup </a>库编写了一个web scraper。为了正确处理Flickr上的页面结构，使用web浏览器模拟器<a class="ae kb" href="https://www.seleniumhq.org/" rel="noopener ugc nofollow" target="_blank"> selenium </a>也是必要的。总之，我们从Yandex下载了超过500 Gb的图像。Fotki，Flickr和维基共享。</p><p id="c95f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">数据过滤。这是我在这个项目中唯一的代码级贡献。我选择了以下过滤标准:1)典型图像大小(相机方面)，2) JPEG压缩级别，3)EXIF相机型号信息，4)EXIF处理软件信息。</strong></p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ll"><img src="../Images/fc5c0f5241ace3b535d861573e926214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wQek5_WHlSFFuxdlcs0Sw.png"/></div></div></figure><p id="e1a7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">绝大多数的Moto-X图片都被忽略了，因为在那个类中有几个不同的硬件版本。</p><p id="e64a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">验证方案。</strong>学习和验证模块的开发委托给了<a class="ae kb" href="https://www.kaggle.com/ikibardin" rel="noopener ugc nofollow" target="_blank"> Ilya Kibardin </a>。不幸的是，对kaggle数据集的验证不一致:我们的神经网络得分接近1.0的准确性(我们在排行榜上的得分约为0.96)。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lm"><img src="../Images/a59ca5937b4aab3ecadf4cea88223c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*81B3N3Vj_kqiXKqjL3ZkXw.png"/></div></div></figure><p id="90f5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因此，我们决定在附加数据上进行验证(URL由Gleb Posobin提供:<a class="ae kb" href="https://www.kaggle.com/c/sp-society-camera-model-identification/discussion/47235" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/sp-society-camera-model-identificati on/discussion/47235</a>)。我们还将10%的kaggle训练集加入到这个额外的数据集中，以使类别更加平衡。</p><p id="b886" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最佳检查点是通过操纵的和未受影响的数据上的最低交叉熵值来选择的。</p><p id="dca7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">培训方式。</strong>在比赛进行到一半的时候，<a class="ae kb" href="https://www.kaggle.com/antorsae" rel="noopener ugc nofollow" target="_blank"> Andres Torrubia </a>在kaggle论坛上公开了他的完整解决方案。这是一个真正的游戏改变者，因为模型看起来很好，每个人都立即开始使用它。当伊万·罗马诺夫发布了同一解决方案的pytorch版本时，情况再次发生了变化:在多个GPU上实现并行化既快又容易。可悲的是，这些家伙最终在最终排行榜上排名第30和第45，但他们在我们心中永远保持不败。</p><p id="9221" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们的组员伊利亚对米莎的代码(<a class="ae kb" href="https://www.kaggle.com/c/sp-society-camera-model-identification/discussion/48679" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/sp-society-camera-model-identificati on/discussion/48679</a>)做了如下阐述:</p><p id="3326" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">预处理。</strong></p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ln"><img src="../Images/a1437ebdf60ec0a6ade18bd09cd56024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JYrVgdmrhwNQvS4oKa4_qQ.png"/></div></div></figure><p id="746f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">学问。</strong>学习步骤由完整神经网络的微调组成，没有任何冻结层，因为问题与ImageNet非常不同。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lo"><img src="../Images/bbfc8d09bdc02ddd273eb4bba7933d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7FxyLcI1OROJkVCW9dFQHQ.png"/></div></div></figure><p id="2009" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">调度。</strong></p><p id="7ad9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">1.从学习率1e-4的亚当开始。如果损失在2-3个时期内没有改善，学习率减半。这一过程应持续到达到收敛。<br/> 2。用SGD代替Adam学习率是从1e-3到1e-6的循环(三个循环)。</p><p id="1ec1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">最后的合奏。</strong>我让伊利亚应用我最近在“<a class="ae kb" rel="noopener" href="/@dbrainio/amazon-basin-from-space-competitive-approach-to-train-neural-network-736937902dd0"> Amazon from Space </a>”比赛中采用的方法:我们微调了九个模型，从中选择了三个最佳检查点，使用每个选择的检查点计算测试时间增加(TTA)的预测，并通过几何平均值对这些预测进行平均。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lp"><img src="../Images/e78f5cdd038026f5eb0522c87060b883.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vwi68HboHxmqfIUP_K-adw.png"/></div></div></figure><h1 id="dd75" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">第一阶段后果</h1><p id="78c4" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">这种方法使我们在总排名中名列第二，在学生类别中名列第一。我们成功通过了第一阶段，并进入了2018年加拿大IEEE声学、语音和信号处理国际会议期间举行的比赛的第二阶段。非常值得注意的是，第三支队伍也被认为是一支学生队伍。从他们的得分来看，我们似乎只比他们的解决方案多了一个正确的预测。</p><h1 id="9ae3" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">2018年IEEE信号处理杯决赛</h1><p id="1f4d" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">在我们收到确认信后，伊利亚和阿图尔开始为第二阶段做准备，而瓦列里、安德烈和我决定我们不能参加。不幸的是，伊利亚和阿图尔的签证被加拿大大使馆拒绝。但幸运的是，组委会理解我们的处境，允许我们远程参与比赛。</p><h1 id="d565" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">第二阶段细节</h1><p id="126a" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">第二阶段没有排行榜:根据比赛规则，我们只有一次提交解决方案的机会。此外，在训练集中没有关于相机模型的信息。所以，基本上，这是一个双重失败:没有外部数据和不具代表性的本地验证。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lq"><img src="../Images/e2cf51e727b2a7af55acd25bd07dd07e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MkGUIbQEG2VzwhjfuJzE0w.png"/></div></div><figcaption class="lr ls fg fe ff lt lu bd b be z ek">Class distribution on the second stage.</figcaption></figure><h1 id="809b" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">解决办法</h1><p id="db2b" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">起初，我们尝试使用第一阶段的管道。每个模型都很快获得了很高的准确性(大约0.97)，但是它们的预测在测试样本上没有重叠(大约0.87)。在我看来，我们的模型过于合身了。于是我想出了新的方案:<br/> 1。使用第一阶段的最佳模型进行特征提取；<br/> 2。执行特征提取，随后进行PCA缩减；<br/> 3。训练LightGBM分类器。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lv"><img src="../Images/7d4018a38de8bc4c6765ccda8c515316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8O3iEW5ajxWKKmxAvhLdvg.png"/></div></div></figure><p id="5309" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我提出这个计划的原因如下。这些网络已经被训练成能够在特定的图像背景之外提取重要的特征。因此，仅仅在它上面训练一些轻量级的东西就足够了。然而，由于这一阶段的数据可能与第一阶段的数据非常不同，如果分类器是非线性的，就更好了，就像决策树上的梯度推进一样。我已经在之前的比赛中成功应用了这个想法(我也分享了一些<a class="ae kb" href="https://www.kaggle.com/drn01z3/mxnet-xgboost-baseline-lb-0-57" rel="noopener ugc nofollow" target="_blank">代码</a>)。DenseNet在本地验证方面似乎优于Resnext和SE-Resnext。结果，我们的最终解决方案看起来像这样:</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/96eaae896ab686fb7ef3a726784f5a77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O0RLTiwh6wvthqQ3x8UhOg.png"/></div></div></figure><p id="76ec" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">被操作部分的训练样本数乘以7，因为我已经分别从数据的每个操作转换中提取了特征。</p><h1 id="05e4" class="kc kd hu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">编后记</h1><p id="cafb" class="pw-post-body-paragraph jc jd hu je b jf la jh ji jj lb jl jm jn lc jp jq jr ld jt ju jv le jx jy jz hn dt translated">最后，我们在决赛阶段获得了第二名，但是有一些重要的情况。首先，评审团不是通过准确性，而是通过陈述来评估解决方案。决赛的获胜者不仅制作了演示文稿，还制作了他们算法的现场演示。第二，我们仍然不知道每个团队的最终得分(委员会不会透露这一信息，即使被直接询问)。</p><p id="8cc4" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有趣的事实:绝大多数讲俄语的数据科学家都是开放数据科学社区的成员。这是一个非常友好的环境，在第一阶段，我们社区的每个团队都在团队名称中添加了[ods.ai]。结果发现排行榜榜首有好多！在那之后，像反转和基巴这样的传奇人物加入了我们的社区，想知道我们在做什么。</p><figure class="lg lh li lj fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lx"><img src="../Images/276fcdde4012dd769edff31fcccedb3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Kvx0I2eMsSpDJCC5zZ3ow.png"/></div></div></figure><p id="b326" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我真的很喜欢作为导师参加比赛。我能够给出一些关于基线改进和执行本地验证的有价值的建议——所有这些都是基于我在以前比赛中的经验。我认为，这种团队形成的实践已经证明了自己，应该在未来的比赛中应用:Kaggle Master/Grandmaster作为解决方案架构师，2-3名Kaggle专家作为编码员和研究人员。在我看来，这肯定是一个双赢的局面:有经验的Kaggle用户不必花太多时间编写代码，而初学者可以获得更好的结果，避免常见错误，并快速获得经验。</p></div></div>    
</body>
</html>