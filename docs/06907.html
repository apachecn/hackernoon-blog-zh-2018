<html>
<head>
<title>Demystifying AWS Pricing APIs &amp; its Cryptic codes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">揭开AWS定价API及其神秘代码的神秘面纱</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/demystifying-aws-pricing-apis-its-cryptic-codes-1acda3496cd?source=collection_archive---------20-----------------------#2018-08-16">https://medium.com/hackernoon/demystifying-aws-pricing-apis-its-cryptic-codes-1acda3496cd?source=collection_archive---------20-----------------------#2018-08-16</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/0d3aecefd7beb9540c2f324db58bcb8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HiBVgIV7gHJ1GTHpwgemnA.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Be like Bob</figcaption></figure><p id="2146" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">Bob是一名高级IT人员，负责一家中型制造公司，该公司在10个国家开展业务，在2个国家设有工厂。</p><p id="06ad" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">两年前，该公司决定将其80%的IT基础设施迁移到AWS。由于鲍勃领导这项活动，他是财务部核实账单的关键人物。</p><p id="f223" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">几个月来，Bob通过自己的眼睛和头脑，浏览AWS网站和清理定价数据，管理账单和预算计划的验证。</p><p id="32c1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">但是，鲍勃是一个公认的聪明人。所以，他决定让它自动化。</p><p id="72df" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">怎么会？让我们听听鲍勃的意见。</p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><p id="fe82" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv">我:</strong>嘿鲍勃，<em class="km">你好吗</em>？</p><p id="a6ee" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">鲍勃:(微笑，因为他听起来像我)酷人，谢谢。</p><p id="5de0" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我: Bob，你使用了AWS定价API。是什么迫使你这样做的？</p><p id="89e1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv"> Bob: </strong>浏览AWS网站所需的时间，了解价格详情。</p><p id="0da8" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我们使用数百个不同口味、不同大小、不同存储类型、数据库等的ec2。而这只是AWS庞大产品中的一小部分。</p><p id="3938" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">手动查看价格，在特定日期记录价格，不断寻找变化太多了。所以，决定做点什么。</p><p id="ade1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">通过集成AWS APIs，现在我们有了一个根据我们的需求定制的仪表板，并且总是最新的。我们还为我们的用户创建了自己定制的计算器。它整合了AWS价格和当地供应商的价格。</p><p id="10a7" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这有助于简化我们的消费，价格现在更容易预测。</p><p id="bf6a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv">我:</strong>这对于像你这样的人来说是有意义的，因为你每天都要处理这么多AWS组件，并对费用负责。</p><p id="44a2" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">是的，那是真的。</p><p id="b184" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv">我:</strong>我浏览了AWS定价的<a class="ae ke" href="https://hackernoon.com/tagged/api" rel="noopener ugc nofollow" target="_blank"> API </a>文档。我来总结一下我所理解的，问一下你我的疑惑。</p><p id="cd78" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">鲍勃:当然</p><p id="2d72" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv">我:</strong>一、基础知识:</p><ol class=""><li id="2350" class="kn ko hu ji b jj jk jn jo jr kp jv kq jz kr kd ks kt ku kv dt translated">API访问是通过https进行的。</li><li id="3dd1" class="kn ko hu ji b jj kw jn kx jr ky jv kz jz la kd ks kt ku kv dt translated">AWS以json或csv的形式提供定价信息。</li><li id="4bdd" class="kn ko hu ji b jj kw jn kx jr ky jv kz jz la kd ks kt ku kv dt translated">这些API无需AWS帐户即可公开访问。</li><li id="7949" class="kn ko hu ji b jj kw jn kx jr ky jv kz jz la kd ks kt ku kv dt translated">访问json/csv的基址是<a class="ae ke" href="https://pricing.us-east-1.amazonaws.com/" rel="noopener ugc nofollow" target="_blank">https://pricing.us-east-1.amazonaws.com/</a></li><li id="1e5f" class="kn ko hu ji b jj kw jn kx jr ky jv kz jz la kd ks kt ku kv dt translated">上述url中的us-east-1是所有信息都可用的地方，并且不仅限于此区域。</li></ol><p id="e9b2" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">为了访问数据，我遵循了以下步骤</p><p id="28b4" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv">步骤1 </strong>:通过下载从AWS获取产品列表</p><p id="73c4" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://pricing.us-east-1.amazonaws.com/offers/v1.0/aws/index.json" rel="noopener ugc nofollow" target="_blank">https://pricing . us-east-1 . Amazon AWS . com/offers/v 1.0/AWS/index . JSON</a>。</p><p id="4ad1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">它有所有AWS产品的详细信息以及从哪里获得其价格的信息。</p><p id="6836" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">例如。</p><pre class="lb lc ld le fq lf lg lh li aw lj dt"><span id="c031" class="lk ll hu lg b fv lm ln l lo lp">“AmazonEC2”: { “offerCode” : “AmazonEC2”, “versionIndexUrl” : “/offers/v1.0/aws/AmazonEC2/index.json”, “currentVersionUrl”: “/offers/v1.0/aws/AmazonEC2/current/index.json”, “currentRegionIndexUrl”: “/offers/v1.0/aws/AmazonEC2/current/region_index.json” },</span><span id="a54f" class="lk ll hu lg b fv lq ln l lo lp">(Note: A product, like AmazonEC2, is referred as ‘Offer’)</span></pre><p id="134b" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv">第二步</strong>:从上面的设置中，访问‘currentRegionIndexUrl’网址</p><p id="b40a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><a class="ae ke" href="https://pricing.us-east-1.amazonaws.com/offers/v1.0/aws/AmazonEC2/current/region_index.json" rel="noopener ugc nofollow" target="_blank">https://pricing . us-east-1 . Amazon AWS . com/offers/v 1.0/AWS/amazone C2/current/region _ index . JSON</a></p><p id="9123" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">它给出了每个地区的详细价格。</p><p id="5739" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">例如。</p><pre class="lb lc ld le fq lf lg lh li aw lj dt"><span id="8c75" class="lk ll hu lg b fv lm ln l lo lp">"ap-south-1" :<br/>{<br/> <br/>"regionCode" : "ap-south-1",<br/> <br/>"currentVersionUrl":"/offers/v1.0/aws/AmazonEC2/20180628005902/ap-south-1/index.json"<br/> <br/>},</span></pre><p id="39e8" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在，事情变得越来越模糊。这是一片混乱的数据海洋。</p><p id="e206" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">涉及到一些<strong class="ji hv">神秘的代码</strong>，我找不到任何解释这些代码的AWS文档。此外，一些部分显示价格为<strong class="ji hv"> 0.0美元</strong>。这怎么可能呢？</p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><p id="371d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">鲍勃:到目前为止的总结是正确的。您已经到达了数据的来源，但是您正在努力从中提取信息。要做到这一点，你必须了解产品，并找到模式。</p><p id="c89e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">例如，您正在访问EC2定价。现在，EC2定价有多种变化，如按需、专用主机、保留主机。此外，还有各种方式，如全额/无/部分预付等。</p><p id="1a4d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这种变异是通过那些看起来像外星人的代码捕捉到的。</p><p id="b8b2" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">让我们举个例子:</p><p id="5b21" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated"><strong class="ji hv">我们想查看预装SQL Enterprise的Linux m5.large的价格。</strong></p><p id="72e5" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">通过解析，得到这个变体的代码— ZV5VAXGR4YZS96VY</p><p id="6699" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">用这个代码搜索，你会得到文件中的多个块。</p><p id="f564" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">每个区块代表同一产品的一个独特变体——上面提到了不同的因素，如支付条款、专用主机等</p><p id="17b2" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">每个块将有一个唯一的标识符，“Offertermcode”。例如，“JRTCKXETXF”代表按需定价，按小时付费。</p><p id="7120" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">另一个例子，“HU7G6KETJZ”代表保留定价，包含部分前期费用。因此，账单将包括一些预付金额和一些每月。“2TG2D8R56U”用于预付费用，而“6YS6CT7”用于每小时费用。</p><p id="ea6d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">就是这样。</p><p id="702a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">总而言之，深度有三个层次。</p><figure class="lb lc ld le fq iv fe ff paragraph-image"><div class="fe ff lr"><img src="../Images/7f456473dbade92af2017301f9275610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*GVSSr4tKIlpGUTyjq3pdFw.png"/></div></figure><ol class=""><li id="a8c0" class="kn ko hu ji b jj jk jn jo jr kp jv kq jz kr kd ks kt ku kv dt translated">EC2的唯一代码—比如ZV5VAXGR4YZS96VY</li><li id="47c6" class="kn ko hu ji b jj kw jn kx jr ky jv kz jz la kd ks kt ku kv dt translated">上述变体的唯一报价术语代码—<br/>按需、全额预付、无预付等—13个唯一报价术语代码</li><li id="3513" class="kn ko hu ji b jj kw jn kx jr ky jv kz jz la kd ks kt ku kv dt translated">预付和/或按小时支付条款</li></ol><p id="5504" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我:谢谢鲍勃。现在清楚了，去神秘化了。</p><p id="98b1" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我真的想和你一样。</p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><p id="302e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">AWS价格API文档可在此处访问<a class="ae ke" href="https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/price-changes.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="965d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">本帖原帖<a class="ae ke" href="https://blog.calsoftinc.com/2018/08/demystifying-aws-pricing-apis-cryptic-codes.html" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></div><div class="ab cl kf kg hc kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hn ho hp hq hr"><p id="4bec" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">请在评论区提供您的反馈。它会帮助我提高。你也可以发电子邮件到dhruvdesaai@gmail.com给我。</p><figure class="lb lc ld le fq iv"><div class="bz el l di"><div class="ls lt l"/></div></figure></div></div>    
</body>
</html>