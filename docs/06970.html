<html>
<head>
<title>How to run a Sanity backed blog with React and Next.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ç”¨Reactå’ŒNext.jsè¿è¡Œä¸€ä¸ªå¥å…¨çš„åšå®¢</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/how-to-run-a-sanity-backed-blog-with-react-and-next-js-805f4b466413?source=collection_archive---------4-----------------------#2018-08-19">https://medium.com/hackernoon/how-to-run-a-sanity-backed-blog-with-react-and-next-js-805f4b466413?source=collection_archive---------4-----------------------#2018-08-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="9e74" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">æœ‰æ—¶å€™ä½ åªæ˜¯éœ€è¦ä¸€ä¸ªåšå®¢ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆä¸ç”¨ä¸€äº›é—ªäº®çš„ä¸œè¥¿æ¥æ„å»ºå®ƒå‘¢ï¼Œæ¯”å¦‚Sanityã€Reactå’ŒNext.jsï¼Ÿ</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/bc01506d0c38659e2a80ff2dc2c15aca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oU56bUWBQ6rZ-aw5_FXuJg.png"/></div></div></figure><p id="08b5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><a class="ae kr" href="http://foo.bar/" rel="noopener ugc nofollow" target="_blank">æœ‰æ—¶å€™ä½ åªéœ€è¦ä¸€ä¸ªåšå®¢ã€‚è™½ç„¶æœ‰å¤§é‡çš„åšå®¢å¹³å°ï¼Œä½†æœ‰å¾ˆå¥½çš„ç†ç”±è®©ä½ çš„åšå®¢å†…å®¹ä¸ä½ çš„å…¶ä»–å†…å®¹ä¸€èµ·å­˜åœ¨ï¼Œæ— è®ºæ˜¯æ–‡æ¡£(å°±åƒæˆ‘ä»¬çš„æƒ…å†µ)ï¼Œäº§å“ï¼ŒæŠ•èµ„ç»„åˆè¿˜æ˜¯å…¶ä»–ä»€ä¹ˆã€‚åšå®¢çš„å†…å®¹æ¨¡å‹ï¼Œæˆ–è€…è¯´æ•°æ®æ¨¡å¼ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„èµ·ç‚¹ï¼Œå¯ä»¥è®©ä½ å¼€å§‹åˆ¶ä½œä¸€äº›æ— å¤´çš„ä¸œè¥¿ï¼Œæœ‰ç€</a><a class="ae kr" href="https://hackernoon.com/tagged/sanity" rel="noopener ugc nofollow" target="_blank">çš„å¥å…¨æ€§</a>å’Œä¸€ä¸ªåˆ†ç¦»çš„å‰ç«¯ã€‚</p><p id="ed06" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Sanityä½œä¸ºå†…å®¹åç«¯ï¼Œä½¿ç”¨åŸºäºReactçš„æ¡†æ¶Next.jsæ¥å‘ˆç°ç½‘é¡µã€‚</p><p id="97e2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¦‚æœæ‚¨ä¸æƒ³è¾“å…¥ä»¥ä¸‹æ‰€æœ‰å†…å®¹ï¼Œæ‚¨ä¹Ÿå¯ä»¥:</p><p id="e070" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ğŸ‘‰<a class="ae kr" href="https://github.com/sanity-io/sanity-blog-tutorial" rel="noopener ugc nofollow" target="_blank"> <strong class="jx hv">æŸ¥çœ‹Githubä¸Šçš„ä»£ç </strong> </a> <strong class="jx hv">ğŸ‘ˆ</strong></p><h1 id="6961" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">1.å®‰è£…Sanityå’Œé¢„é…ç½®çš„åšå®¢æ¨¡å¼</h1><p id="04ea" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">å¦‚æœæ‚¨è¿˜æ²¡æœ‰è¿™æ ·åšï¼Œè¯·ä½¿ç”¨npmå®‰è£…Sanityå‘½ä»¤è¡Œ(CLI)å·¥å…·ã€‚</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="3c4e" class="lu kt hu lq b fv lv lw l lx ly">npm i -g @sanity/cli.</span></pre><p id="334a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">è¿™å…è®¸æ‚¨åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­è¿è¡Œ<code class="eh lz ma mb lq b">sanity init</code>å‘½ä»¤ï¼Œäº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸‹ä¸€æ­¥ã€‚ä½ å°†è¢«è¦æ±‚åœ¨Googleæˆ–Githubä¸Šåˆ›å»ºä¸€ä¸ªè´¦æˆ·ã€‚ä¹‹åï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œè¿™æ—¶ä¼šè¦æ±‚æ‚¨é€‰æ‹©ä¸€ä¸ªé¡¹ç›®æ¨¡æ¿ã€‚é€‰æ‹©åšå®¢æ¨¡å¼æ¨¡æ¿ã€‚é¦–å…ˆï¼Œæ‚¨éœ€è¦ä¸ºæ‚¨çš„é¡¹ç›®å’Œæ•°æ®é›†å‘½å(å¦‚æœæ‚¨éœ€è¦ä¸€ä¸ªæ•°æ®é›†ç”¨äºæµ‹è¯•ï¼Œæ‚¨å¯ä»¥æ·»åŠ æ›´å¤šçš„æ•°æ®é›†)ï¼Œå¹¶ä¸ºæ‚¨æƒ³è¦å­˜å‚¨content studioæ–‡ä»¶çš„ä½ç½®é€‰æ‹©ä¸€ä¸ªè·¯å¾„ã€‚</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="c676" class="lu kt hu lq b fv lv lw l lx ly">$ Select project to use: Create new project <br/>$ Informal name for your project: sanity-tutorial-blog <br/>$ Name of your first data set: production <br/>$ Output path: ~/Sites/sanity-tutorials/blog <br/>$ Select project: template Blog (schema)</span></pre><p id="49fe" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å®‰è£…å®Œæˆåï¼Œæ‚¨å¯ä»¥è¿è¡Œ<code class="eh lz ma mb lq b">sanity start</code>æ¥å¯åŠ¨Content Studioï¼Œåœ¨è¿™é‡Œæ‚¨å¯ä»¥å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹ã€‚ä¸€æ—¦ç‚¹å‡»å‘å¸ƒï¼Œè¿™äº›å†…å®¹å°†ç«‹å³åŒæ­¥åˆ°äº‘ä¸­ï¼Œå¹¶é€šè¿‡APIæä¾›ã€‚é€šè¿‡è¿è¡Œ<code class="eh lz ma mb lq b">sanity deploy</code>ï¼Œä½ å°†ä¸Šä¼ è¿™ä¸ªå·¥ä½œå®¤ï¼Œå¹¶è®©é‚£äº›æœ‰è®¿é—®æƒé™çš„äººå¯ä»¥åœ¨ç½‘ä¸Šä½¿ç”¨å®ƒ(ä½ å¯ä»¥é€šè¿‡å¯¼èˆªåˆ°<a class="ae kr" href="https://manage.sanity.io/" rel="noopener ugc nofollow" target="_blank"> manage.sanity.io </a>æ¥æ·»åŠ ç”¨æˆ·)ã€‚</p><p id="b84f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt">â€”</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/d8d13f2767b0b79de81f547901eb0f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:312/format:webp/0*9lV4kj-A0alAJAR9.png"/></div></figure><p id="5287" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">æ˜ç™½äº†<br/> </strong>æ‚¨å¯ä»¥ç»§ç»­æ“ä½œå¹¶ä½¿æ‚¨çš„æ•°æ®é›†ç§æœ‰ï¼Œä½†æ˜¯å¦‚æœæ‚¨è¿™æ ·åšï¼Œæ‚¨éœ€è¦åœ¨<a class="ae kr" href="https://manage.sanity.io/" rel="noopener ugc nofollow" target="_blank"> manage.sanity.io </a>ä¸Šä¸ºè‡ªå·±åˆ›å»ºä¸€ä¸ªä»¤ç‰Œï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ä¸‹é¢çš„å®¢æˆ·ç«¯é…ç½®ä¸­ã€‚</p><p id="515f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt">â€”</p><p id="1c5f" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æ‚¨å¯ä»¥å¯¹å­˜å‚¨åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­çš„æ¨¡å¼åšå¾ˆå¤šäº‹æƒ…ï¼Œä½†æ˜¯è¿™æ˜¯å¦ä¸€ä¸ªæ•™ç¨‹çš„å†…å®¹ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬åªæƒ³è®©æˆ‘ä»¬çš„åšå®¢è¿è¡Œèµ·æ¥ï¼</p><h1 id="9f4e" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">2.å®‰è£…Next.jså¹¶è®©å®ƒè¿è¡Œ</h1><p id="ae41" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">Next.js (ç”±ç‰›é€¼å…¬å¸<a class="ae kr" href="https://zeit.co/" rel="noopener ugc nofollow" target="_blank"> Zeit </a>å¼€å‘)æä¾›äº†ä¸€ä¸ªç®€æ´çš„è®¾ç½®ï¼Œç”¨äºåˆ¶ä½œåŸºäºReactçš„ç½‘é¡µï¼Œåœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶æä¾›æœåŠ¡å™¨æ¸²æŸ“ï¼Œä»¥åŠè®¸å¤šå…¶ä»–æœ‰ç”¨çš„åŠŸèƒ½ã€‚å¦‚æœä½ å·²ç»ä¹ æƒ¯äº†<a class="ae kr" href="https://hackernoon.com/tagged/react" rel="noopener ugc nofollow" target="_blank"> React </a>ï¼Œæˆ–è€…å·²ç»å°è¯•è¿‡create-react-appï¼Œè¿™åº”è¯¥ä¸éš¾ä¸Šæ‰‹ã€‚</p><p id="2c55" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ä¸ºæ‚¨çš„å‰ç«¯æ–‡ä»¶åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œ<code class="eh lz ma mb lq b">npm init</code>ä¸ºæ‚¨çš„é¡¹ç›®åˆ›å»ºä¸€ä¸ªpackage.jsonæ–‡ä»¶ã€‚ç„¶åå®‰è£…Next.jsä¾èµ–é¡¹</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="f2ca" class="lu kt hu lq b fv lv lw l lx ly">npm install --save next react react-dom</span></pre><p id="54b5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¹¶å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°package.jsonä¸­:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="eb8e" class="lu kt hu lq b fv lv lw l lx ly">{ <br/>  "scripts": { <br/>    "dev": "next", <br/>    "build": "next build", <br/>    "start": "next start"<br/>  }<br/>}</span></pre><p id="d9e7" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">Next.jsæ ¹æ®æ‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä½ç½®è¿›è¡Œè·¯ç”±ã€‚å› æ­¤ï¼Œå¦‚æœä½ æ·»åŠ ä¸€ä¸ªåä¸º<code class="eh lz ma mb lq b">pages</code>çš„æ–‡ä»¶å¤¹ï¼Œå¹¶æ·»åŠ <code class="eh lz ma mb lq b">index.js</code>ï¼Œå®ƒå°†æˆä¸ºä½ ç½‘ç«™çš„é¦–é¡µã€‚åŒæ ·ï¼Œå¦‚æœä½ åœ¨<code class="eh lz ma mb lq b">/pages</code>ä¸­æ·»åŠ <code class="eh lz ma mb lq b">about.js</code>ï¼Œä¸€æ—¦ä½ å¯åŠ¨é¡¹ç›®ï¼Œè¿™å°†æ˜¾ç¤ºåœ¨<code class="eh lz ma mb lq b"><a class="ae kr" href="http://localhost:3000/about" rel="noopener ugc nofollow" target="_blank">localhost:3000/about</a></code>ä¸Šã€‚ä¸ºäº†ç¡®ä¿ä¸€åˆ‡å°±ç»ªï¼Œå°è¯•å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°<code class="eh lz ma mb lq b">pages/index.js</code>ï¼Œå¹¶åœ¨shellä¸­é”®å…¥<code class="eh lz ma mb lq b">npm run dev</code>:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="e1af" class="lu kt hu lq b fv lv lw l lx ly">const Index = (props) =&gt; &lt;div&gt;Hello world!&lt;/div&gt; export default Index</span></pre><p id="a464" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ç°åœ¨ï¼Œå¦‚æœä½ åœ¨æµè§ˆå™¨ä¸­å‰å¾€<code class="eh lz ma mb lq b"><a class="ae kr" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank">localhost:3000</a></code>ï¼Œä½ åº”è¯¥æœ‰ä¸€ä¸ªå¯¹ä¸–ç•Œçš„é—®å€™ã€‚</p><h1 id="503f" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">3.åˆ¶ä½œåŠ¨æ€é¡µé¢æ¨¡æ¿</h1><p id="6200" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ï¼Œä½†ç°åœ¨æ˜¯æœ‰è¶£çš„éƒ¨åˆ†:è®©æˆ‘ä»¬ä»Sanityä¸­è·å–ä¸€äº›å†…å®¹ï¼Œå¹¶åœ¨Reactä¸­å‘ˆç°å‡ºæ¥ã€‚é¦–å…ˆå®‰è£…è¿æ¥åˆ°Sanity APIæ‰€éœ€çš„ä¾èµ–é¡¹:<code class="eh lz ma mb lq b">npm install @sanity/client --save</code>ã€‚åœ¨æ ¹å‰ç«¯æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º<code class="eh lz ma mb lq b">client.js</code>çš„æ–°æ–‡ä»¶ã€‚æ‰“å¼€æ–‡ä»¶ï¼Œæ”¾å…¥ä»¥ä¸‹å†…å®¹:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="fa2c" class="lu kt hu lq b fv lv lw l lx ly">import sanityClient from '@sanity/client'<br/>export default sanityClient({<br/>  projectId: 'your-project-id',<br/>  dataset: 'production',<br/>  useCdn: true<br/>})</span></pre><p id="e54e" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ä¸ºæ¯ä¸ªæ–°çš„åšå®¢æ¡ç›®æ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶æ˜¯ä¸åˆ‡å®é™…çš„ã€‚ç”šè‡³æ˜¯ä¸€åœºäº‰è®ºã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬åˆ¶ä½œä¸€ä¸ªé¡µé¢æ¨¡æ¿ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨æ¥è‡ªSanityçš„URL slugsã€‚ä¸å¹¸çš„æ˜¯ï¼ŒNext.jsæ²¡æœ‰å¼€ç®±å³ç”¨çš„åŠ¨æ€é¡µé¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»æ·»åŠ ä¸€äº›æœåŠ¡å™¨ä»£ç ã€‚è®©æˆ‘ä»¬é‡ç”¨æ¥è‡ª<code class="eh lz ma mb lq b">nextjs/examples</code>çš„ä»£ç ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹ä»£ç åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­æ·»åŠ ä¸€ä¸ª<code class="eh lz ma mb lq b">server.js</code>æ–‡ä»¶:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="095c" class="lu kt hu lq b fv lv lw l lx ly">const { createServer } = require('http')<br/>const { parse } = require('url')<br/>const next = require('next')<br/>const pathMatch = require('path-match')</span><span id="76cc" class="lu kt hu lq b fv md lw l lx ly">const port = parseInt(process.env.PORT, 10) || 3000<br/>const dev = process.env.NODE_ENV !== 'production'<br/>const app = next({ dev })<br/>const handle = app.getRequestHandler()<br/>const route = pathMatch()<br/>const match = route('/blog/:slug')</span><span id="e127" class="lu kt hu lq b fv md lw l lx ly">app.prepare().then(() =&gt; {<br/>  createServer((req, res) =&gt; {<br/>    const { pathname, query } = parse(req.url, true)<br/>    const params = match(pathname)<br/>    if (params === false) {<br/>      handle(req, res)<br/>      return<br/>    }<br/>    // assigning `query` into the params means that we still<br/>    // get the query string passed to our application<br/>    // i.e. /blog/foo?show-comments=true<br/>    app.render(req, res, '/blog', Object.assign({}, query, params))<br/>  }).listen(port, err =&gt; {<br/>    if (err) throw err<br/>    console.log(`&gt; Ready on <a class="ae kr" href="http://localhost:${port}`" rel="noopener ugc nofollow" target="_blank">http://localhost:${port}`</a>)<br/>  })<br/>})</span></pre></div><div class="ab cl me mf hc mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hn ho hp hq hr"><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/9e9c7403b1873ccb89c66f1085bb94cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:312/format:webp/0*b_oowmJJYdZJPpkR.png"/></div></figure><p id="aa5b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">æ˜ç™½äº†</strong></p><p id="4ef5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¦‚æœæ‚¨å¯¹<code class="eh lz ma mb lq b">server.js </code>æˆ–<code class="eh lz ma mb lq b">package.json</code>è¿›è¡Œæ›´æ”¹ï¼Œæ‚¨å¿…é¡»é‡å¯<code class="eh lz ma mb lq b">npm run dev</code></p></div><div class="ab cl me mf hc mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hn ho hp hq hr"><p id="c57c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æ‚¨è¿˜åº”è¯¥è¿è¡Œ<code class="eh lz ma mb lq b">npm install http url path-match --save </code>ä»¥è·å¾—å¿…è¦çš„ä¾èµ–é¡¹ï¼Œå¹¶å°†<code class="eh lz ma mb lq b">package.json</code>ä¸­çš„è„šæœ¬éƒ¨åˆ†æ›´æ”¹ä¸º:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="c603" class="lu kt hu lq b fv lv lw l lx ly">{ <br/>  "scripts": { <br/>    "dev": "node server.js",<br/>    "build": "next build",<br/>    "start": "NODE_ENV=production node server.js" <br/>  } <br/>}</span></pre><p id="b7db" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æ‚¨çš„å‰ç«¯æ–‡ä»¶å¤¹ç°åœ¨åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="d035" class="lu kt hu lq b fv lv lw l lx ly">~/blog/frontend<br/>$ tree -I node_modules<br/>.<br/>â”œâ”€â”€ client.js<br/>â”œâ”€â”€ package-lock.json<br/>â”œâ”€â”€ package.json<br/>â””â”€â”€ pages<br/>    â”œâ”€â”€ blog.js<br/>    â””â”€â”€ index.js<br/>â”œâ”€â”€ server.js<br/>1 directory, 6 files</span></pre><p id="13de" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">Next.jsé™„å¸¦äº†ä¸€ä¸ªåä¸º<code class="eh lz ma mb lq b">getInitialProps</code>çš„ç‰¹æ®Šå‡½æ•°ï¼Œåœ¨<code class="eh lz ma mb lq b">/pages</code>ä¸­å‘ˆç°æ¨¡æ¿ä¹‹å‰ï¼Œè°ƒç”¨è¯¥å‡½æ•°å¹¶å‘reactç»„ä»¶è¿”å›é“å…·ã€‚è¿™æ˜¯è·å–é¡µé¢æ‰€éœ€æ•°æ®çš„ç»ä½³ä½ç½®ã€‚</p></div><div class="ab cl me mf hc mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hn ho hp hq hr"><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/3468474ca4b060ed80525d27e39aead3.png" data-original-src="https://miro.medium.com/v2/resize:fit:312/format:webp/0*YLKY8lmz9XneGYSc.png"/></div></figure><p id="3102" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">æŠ“ä½ä½ äº†</strong></p><p id="0dfc" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><code class="eh lz ma mb lq b">getInitialProps</code>åªå¯¹pagesæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶<em class="ml">èµ·ä½œç”¨ï¼Œå¹¶ç”¨äºè·¯ç”±ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¸ä¼šè¢«åŒ…å«åœ¨è¿™äº›é¡µé¢ä¸­çš„reactç»„ä»¶è°ƒç”¨ã€‚<a class="ae kr" href="https://github.com/zeit/next.js/#user-content-fetching-data-and-component-lifecycle" rel="noopener ugc nofollow" target="_blank">é˜…è¯»Next.jsæ–‡æ¡£äº†è§£æ›´å¤šä¿¡æ¯ã€‚</a></em></p></div><div class="ab cl me mf hc mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hn ho hp hq hr"><p id="0927" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æœ‰å¾ˆå¤šä¸åŒçš„æ–¹æ³•å¯ä»¥ç¼–å†™reacté¡µé¢ç»„ä»¶ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¯ä»¥è®©ä½ æ›´å®¹æ˜“ä¸Šæ‰‹ã€‚å°†ä»¥ä¸‹å†…å®¹æ”¾å…¥blog.jsã€‚è¿™é‡Œæˆ‘ä»¬å°†slugè®¾ç½®ä¸ºæ ‡é¢˜ï¼Œåªæ˜¯ä¸ºäº†åœ¨æ·»åŠ ä»Sanityè·å–å†…å®¹çš„ä»£ç ä¹‹å‰æµ‹è¯•ä»£ç æ˜¯å¦æœ‰æ•ˆ:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="31e3" class="lu kt hu lq b fv lv lw l lx ly">const Post = ({ title = 'No title' }) =&gt; (<br/>  &lt;div&gt;<br/>    &lt;h1&gt;{title}&lt;/h1&gt;<br/>  &lt;/div&gt;<br/>)</span><span id="f674" class="lu kt hu lq b fv md lw l lx ly">Post.getInitialProps = ({ query: { slug = '' } }) =&gt; { <br/>  const title = slug<br/>  return { title }<br/>}</span><span id="1703" class="lu kt hu lq b fv md lw l lx ly">export default Post</span></pre><p id="2c80" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¦‚æœä½ è½¬åˆ°<code class="eh lz ma mb lq b">localhost:3000/blog/whatever</code>ï¼Œä½ ç°åœ¨åº”è¯¥çœ‹åˆ°â€œwhateverâ€ä½œä¸ºH1æ‰“å°åœ¨é¡µé¢ä¸Šã€‚</p><h1 id="f629" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">4.ä»ç†æ™ºä¸­è·å–ä¸€äº›å†…å®¹</h1><p id="159b" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">æˆ‘ä»¬ç°åœ¨å·²ç»ä¸ºNext.jsè®¾ç½®äº†ä¸€ä¸ªç”¨äºé¦–é¡µçš„æ¨¡æ¿(index.js)å’Œä¸€ä¸ªè‡ªå®šä¹‰æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨ä½¿blog.jsæ¨¡æ¿å¯ä»¥å°†/blog/ä¸‹çš„slugä½œä¸ºæŸ¥è¯¢ã€‚ç°åœ¨æœ‰è¶£çš„éƒ¨åˆ†å¼€å§‹äº†ï¼Œè®©æˆ‘ä»¬ç»™è¿™ä¸ªç»„åˆå¢åŠ ä¸€äº›ç†æ™º:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="fed6" class="lu kt hu lq b fv lv lw l lx ly">import client from '../client'</span><span id="ac2a" class="lu kt hu lq b fv md lw l lx ly">const BlogPost = ({ title = 'No title' }) =&gt; (<br/>  &lt;div&gt;<br/>    &lt;h1&gt;{title}&lt;/h1&gt;<br/>  &lt;/div&gt;<br/>)</span><span id="2a28" class="lu kt hu lq b fv md lw l lx ly">BlogPost.getInitialProps = async ({ query: { slug } }) =&gt; {<br/>  const { title } = await client.fetch('*[_type == "post" &amp;&amp; slug.current == $slug][0]', { slug })<br/>  return { title }<br/>}</span><span id="bdd3" class="lu kt hu lq b fv md lw l lx ly">export default BlogPost</span></pre><p id="b415" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æˆ‘ä»¬ä½¿ç”¨async/awaitï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨è¿›è¡Œå¼‚æ­¥APIè°ƒç”¨ï¼Œè¿™ä½¿å¾—ä»£ç æ›´å®¹æ˜“ç†è§£ã€‚<code class="eh lz ma mb lq b">client.fetch()</code>æ¥å—ä¸¤ä¸ªå‚æ•°:<a class="ae kr" href="https://www.sanity.io/docs/data-store/how-queries-work" rel="noopener ugc nofollow" target="_blank">ä¸€ä¸ªæŸ¥è¯¢</a>å’Œä¸€ä¸ªå¸¦æœ‰å‚æ•°å’Œå€¼çš„å¯¹è±¡ã€‚</p></div><div class="ab cl me mf hc mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hn ho hp hq hr"><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/dcd37f287d8c06c57a5df1450cd675ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:312/format:webp/0*WzeV8FOOEH4anQ4u.png"/></div></figure><p id="274d" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><strong class="jx hv">äº²æç¤º</strong></p><p id="b9b9" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æœ¬æ•™ç¨‹ä¸­çš„GROQè¯­æ³•å¯ä»¥è¿™æ ·ç†è§£:</p><p id="1c32" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><code class="eh lz ma mb lq b">*</code>ğŸ‘ˆé€‰æ‹©æ‰€æœ‰æ–‡æ¡£</p><p id="c39a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><code class="eh lz ma mb lq b">[_type == 'post' &amp;&amp; slug.current == $slug]</code>ğŸ‘ˆå°†æ‰€é€‰å†…å®¹å‘ä¸‹è¿‡æ»¤åˆ°ç±»å‹ä¸ºâ€œpostâ€çš„æ–‡æ¡£ï¼Œä»¥åŠé‚£äº›ä¸æˆ‘ä»¬åœ¨å‚æ•°ä¸­çš„slugç›¸åŒçš„æ–‡æ¡£</p><p id="e822" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><code class="eh lz ma mb lq b">[0]</code>ğŸ‘ˆé€‰æ‹©åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ª</p></div><div class="ab cl me mf hc mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hn ho hp hq hr"><p id="daf5" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ä¸ºäº†è®©å‰ç«¯æœåŠ¡å™¨çœŸæ­£ä»Sanityè·å–æ•°æ®ï¼Œæˆ‘ä»¬å¿…é¡»å°†å…¶åŸŸæ·»åŠ åˆ°<a class="ae kr" href="https://www.sanity.io/docs/front-ends/cors" rel="noopener ugc nofollow" target="_blank"> CORSè®¾ç½®</a>ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¿…é¡»å°†<code class="eh lz ma mb lq b">localhost:3000</code>(ä»¥åŠæœ€ç»ˆä½ çš„åšå®¢æ‰€åœ¨çš„åŸŸå)æ·»åŠ åˆ°Sanityçš„CORSæºè®¾ç½®ä¸­ã€‚å¦‚æœæ‚¨åœ¨shellä¸­è¾“å…¥<code class="eh lz ma mb lq b">sanity manage</code>,æ‚¨å°†åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°è¯¥é¡¹ç›®çš„è®¾ç½®ã€‚å¯¼èˆªåˆ°è®¾ç½®å¹¶æ·»åŠ <code class="eh lz ma mb lq b">http://localhost:3000</code>ä½œä¸ºæ–°çš„åŸç‚¹ã€‚</p><p id="7162" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ç°åœ¨ï¼Œä½ å¯ä»¥åˆ›å»ºå¹¶å‘å¸ƒä¸€ä¸ªè‡³å°‘æœ‰ä¸€æ®µæ–‡å­—å’Œä¸€ä¸ªæ ‡é¢˜çš„å¸–å­:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mm"><img src="../Images/ecbe57d082bb72457a01f0c6d61fcd3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T65nvLuJahq__ncB"/></div></div></figure><p id="28eb" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¦‚æœä½ å‘ä¸–ç•Œè‡´æ„ï¼Œä¸–ç•Œæœ€ç»ˆä¹Ÿä¼šå‘ä½ è‡´æ„</p><p id="1970" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">è½¬åˆ°<a class="ae kr" href="http://localhost:3000/hello-world" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/Hello-world</a>å¹¶ç¡®è®¤H1æ‹¼å†™ä¸ºâ€œHello worldï¼â€ã€‚ç°åœ¨ï¼Œæ‚¨å·²ç»æˆåŠŸåœ°å°†å‰ç«¯ä¸ç†æ™ºè¿æ¥èµ·æ¥ã€‚ğŸ‰</p><h1 id="c25f" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">5.æ·»åŠ ä½œè€…å’Œç±»åˆ«ç½²å</h1><p id="ee9f" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">åœ¨Content Studioä¸­ï¼Œæ‚¨ä¼šå‘ç°ï¼Œæ‚¨å¯ä»¥ä¸ºä½œè€…å’Œç±»åˆ«æ·»åŠ æ¡ç›®ã€‚å»æ·»åŠ è‡³å°‘ä¸€ä¸ªæœ‰å›¾ç‰‡çš„ä½œè€…ã€‚</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mn"><img src="../Images/598f8d659c8951684eda8c264d8ef345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/0*UjvLr9JRyRA7UVKG"/></div></figure><p id="ed0c" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æˆ‘</p><p id="cd1a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å›åˆ°ä½ çš„åšå®¢æ–‡ç« ï¼Œåœ¨ä½œè€…æ é™„ä¸Šè¿™ä¸ªä½œè€…ï¼Œåƒè¿™æ ·:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mo"><img src="../Images/6f20cd17d29d00fc8dac4b0d227f71fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/0*_il5bbGrC-J9qPVn"/></div></figure><p id="2acc" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å‘å¸ƒæ›´æ”¹ï¼Œç„¶åå›åˆ°ä»£ç ç¼–è¾‘å™¨ã€‚æˆ‘ä»¬åˆšåˆšåšçš„æ˜¯<em class="ml">å¼•ç”¨</em>ä¸€ä¸ªæ¥è‡ªåšå®¢å¸–å­çš„ä½œè€…ã€‚å¼•ç”¨æ˜¯å¥å…¨æ€§çš„ä¸€ä¸ªå¼ºå¤§éƒ¨åˆ†ï¼Œå®ƒä½¿å¾—è·¨ç±»å‹è¿æ¥å’Œé‡ç”¨å†…å®¹æˆä¸ºå¯èƒ½ã€‚å¦‚æœ<em class="ml">æ£€æŸ¥</em>æ‚¨çš„å—æ–‡æ¡£(<code class="eh lz ma mb lq b">Ctrl + alt/opt + i</code>)ï¼Œæ‚¨ä¼šçœ‹åˆ°è¯¥å¯¹è±¡çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="7fec" class="lu kt hu lq b fv lv lw l lx ly">"author": {<br/>  "_ref": "fdbf38ad-8ac5-4568-8184-1db8eede5d54",<br/>  "_type": "reference"<br/>}</span></pre><p id="66f0" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¦‚æœæˆ‘ä»¬ç°åœ¨åªå–å‡ºäº†authorå˜é‡(<code class="eh lz ma mb lq b">const { title, author } = await client.fetch('*[slug.current == $slug][0]',{ slug })</code>)ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å°†å¾—åˆ°çš„å†…å®¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹è¿™å¯¹æˆ‘ä»¬ä¸æ˜¯å¾ˆæœ‰ç”¨ã€‚è¿™å°±æ˜¯GROQä¸­çš„<em class="ml">æŠ•å½±</em>æ´¾ä¸Šç”¨åœºçš„åœ°æ–¹ã€‚<a class="ae kr" href="https://www.sanity.io/docs/data-store/query-cheat-sheet#object-projections" rel="noopener ugc nofollow" target="_blank"> Projectionsæ˜¯GROQ </a>çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§ï¼Œå…è®¸æˆ‘ä»¬æŒ‡å®šAPI-responseæ¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="6a39" class="lu kt hu lq b fv lv lw l lx ly">import client from '../client'</span><span id="a803" class="lu kt hu lq b fv md lw l lx ly">const BlogPost = ({ title = 'No title', name = 'No name' }) =&gt; (<br/>  &lt;div&gt;<br/>    &lt;h1&gt;{title}&lt;/h1&gt;<br/>    &lt;span&gt;By {name}&lt;/span&gt;<br/>  &lt;/div&gt;<br/>)</span><span id="a558" class="lu kt hu lq b fv md lw l lx ly">BlogPost.getInitialProps = async ({ query: { slug } }) =&gt; {<br/>  const document = await client.fetch('*[_type == "post" &amp;&amp; slug.current == $slug][0]{title, "name": author-&gt;name}', { slug })<br/>  return document<br/>}</span><span id="157b" class="lu kt hu lq b fv md lw l lx ly">export default BlogPost</span></pre><p id="9730" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">åœ¨è¿™é‡Œï¼Œæˆ‘å°†æŠ•å½±<code class="eh lz ma mb lq b">{title, "name": author-&gt;name}</code>æ·»åŠ åˆ°æˆ‘ä»¬çš„æŸ¥è¯¢ä¸­ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘æŒ‡å®šæˆ‘å¸Œæœ›åœ¨APIè°ƒç”¨ä¸­è¿”å›æ–‡æ¡£ä¸­çš„ä»€ä¹ˆå†…å®¹ã€‚æˆ‘ä»¬éœ€è¦ä¸ºä½œè€…å§“ååˆ›å»ºä¸€ä¸ªé”®ï¼Œå¹¶ä½¿ç”¨ç®­å¤´<code class="eh lz ma mb lq b">-&gt;</code>è·Ÿè¸ªå¯¹ä½œè€…æ–‡æ¡£ä¸Šname-propertyçš„å¼•ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬è¦æ±‚Sanityéµå¾ª<code class="eh lz ma mb lq b">_ref</code>ä¸‹çš„idï¼Œå¹¶ä»è¯¥æ–‡æ¡£ä¸­è¿”å›åä¸º<code class="eh lz ma mb lq b">name</code>çš„å˜é‡çš„å€¼ã€‚</p><p id="46bc" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">è®©æˆ‘ä»¬è¯•ç€å¯¹ç±»åˆ«åšåŒæ ·çš„äº‹æƒ…ã€‚é¦–å…ˆï¼Œåœ¨Content Studioä¸­åˆ›å»ºè‡³å°‘ä¸¤ä¸ªç±»åˆ«ã€‚æˆ‘ç»™<em class="ml"> Next.js </em>åŠ äº†ä¸€ä¸ªï¼Œç»™<em class="ml">æ•™ç¨‹</em>åŠ äº†ä¸€ä¸ªã€‚</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mp"><img src="../Images/26cd1966ff8456f318b3c193c523b912.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/0*EAlaz407MWF8sGSd"/></div></figure><p id="91df" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å°†ç±»åˆ«æ·»åŠ åˆ°æ‚¨çš„åšå®¢æ–‡ç« ä¸­</p><p id="c9e4" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ç°åœ¨æˆ‘ä»¬çš„åšå®¢æ–‡ç« ä¸­æœ‰äº†ä¸€ç³»åˆ—å¯¹ç±»åˆ«çš„å¼•ç”¨ã€‚å¦‚æœæ‚¨åœ¨æ–‡æ¡£æ£€æŸ¥å™¨ä¸­å–ä¸€ä¸ªå³°å€¼ï¼Œæ‚¨ä¼šçœ‹åˆ°è¿™äº›æ˜¾ç¤ºä¸ºä½œè€…æ¡ç›®ï¼Œå¸¦æœ‰<code class="eh lz ma mb lq b">_ref</code> -idçš„å¯¹è±¡ã€‚æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¿…é¡»ä½¿ç”¨æŠ•å½±æ¥å¾—åˆ°è¿™äº›ã€‚</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="e7b2" class="lu kt hu lq b fv lv lw l lx ly">import client from '../client'</span><span id="57d5" class="lu kt hu lq b fv md lw l lx ly">const BlogPost = ({ title = 'No title', name = 'No name', categories = [] }) =&gt; (<br/>  &lt;div&gt;<br/>    &lt;h1&gt;{title}&lt;/h1&gt;<br/>    &lt;span&gt;By {name}.&lt;/span&gt;<br/>    {categories &amp;&amp; (<br/>      &lt;ul&gt;Posted in<br/>        { categories.map(category =&gt; (<br/>          &lt;li key={category}&gt;{category}&lt;/li&gt;<br/>        ))}<br/>      &lt;/ul&gt;<br/>      )<br/>    }<br/>  &lt;/div&gt;<br/>)</span><span id="b6ec" class="lu kt hu lq b fv md lw l lx ly">BlogPost.getInitialProps = async ({ query: { slug } }) =&gt; {<br/>  const document = await client.fetch('*[_type == "post" &amp;&amp; slug.current == $slug][0]{title, "name": author-&gt;name, "categories": categories[]-&gt;title}', { slug })<br/>  return document<br/>}</span><span id="1f84" class="lu kt hu lq b fv md lw l lx ly">export default BlogPost</span></pre><p id="b723" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ç±»åˆ«çš„æŠ•å½±ä¸authoréå¸¸ç›¸ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æˆ‘åœ¨å…³é”®ç±»åˆ«ä¸ŠåŠ äº†æ–¹æ‹¬å·ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªå¼•ç”¨æ•°ç»„ã€‚</p><p id="b555" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">ä½†æ˜¯æˆ‘ä»¬ä¹Ÿæƒ³æŠŠä½œè€…çš„ç…§ç‰‡æ·»åŠ åˆ°ç½²åä¸­ï¼Sanityä¸­çš„å›¾åƒå’Œæ–‡ä»¶èµ„äº§ä¹Ÿæ˜¯å¼•ç”¨ï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬è¦è·å¾—ä½œè€…å›¾åƒï¼Œæˆ‘ä»¬é¦–å…ˆå¿…é¡»éµå¾ªå¯¹ä½œè€…æ–‡æ¡£å’Œå›¾åƒèµ„äº§çš„å¼•ç”¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¿é—®<code class="eh lz ma mb lq b">"imageUrl": author-&gt;image.asset-&gt;url</code>ç›´æ¥æ£€ç´¢imageUrlï¼Œä½†æ˜¯è¿™é‡Œä½¿ç”¨æˆ‘ä»¬åˆ¶ä½œçš„<a class="ae kr" href="https://www.sanity.io/docs/front-ends/presenting-images" rel="noopener ugc nofollow" target="_blank">å›¾åƒUrlåŒ…</a>æ›´å®¹æ˜“ã€‚ç”¨<code class="eh lz ma mb lq b">npm i --save @sanity/image-url</code>åœ¨å‰ç«¯å·¥ç¨‹ä¸­å®‰è£…åŒ…ã€‚å®ƒè·å–å›¾åƒå¯¹è±¡å¹¶ç¡®å®šä»å“ªé‡Œè·å–å›¾åƒï¼Œè¿™ä½¿å¾—ä½¿ç”¨ç„¦ç‚¹ç‰¹å¾ç­‰å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="90c8" class="lu kt hu lq b fv lv lw l lx ly">import client from '../client'<br/>import imageUrlBuilder from '<a class="ae kr" href="http://twitter.com/sanity/image-url" rel="noopener ugc nofollow" target="_blank">@sanity/image-url</a>'<br/>const builder = imageUrlBuilder(client)</span><span id="0ea2" class="lu kt hu lq b fv md lw l lx ly">function urlFor(source) {<br/>  return builder.image(source)<br/>}</span><span id="5d09" class="lu kt hu lq b fv md lw l lx ly">const BlogPost = ({ title = 'No title', name = 'No name', categories = [], authorImage = {} }) =&gt; (<br/>  &lt;div&gt;<br/>    &lt;h1&gt;{title}&lt;/h1&gt;<br/>    &lt;span&gt;By {name}.&lt;/span&gt;<br/>    {categories &amp;&amp; (<br/>      &lt;ul&gt;Posted in<br/>        { categories.map(category =&gt; (<br/>          &lt;li key={category}&gt;{category}&lt;/li&gt;<br/>        ))}<br/>      &lt;/ul&gt;<br/>      )<br/>    }<br/>    &lt;div&gt;<br/>      &lt;img src={urlFor(authorImage).width(50).url()} /&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>)</span><span id="111f" class="lu kt hu lq b fv md lw l lx ly">BlogPost.getInitialProps = async ({ query: { slug } }) =&gt; {<br/>  const document = await client.fetch(`*[_type == "post" &amp;&amp; slug.current == $slug][0]{<br/>      title,<br/>      "name": author-&gt;name,<br/>      "categories": categories[]-&gt;title,<br/>      "authorImage": author-&gt;image<br/>    }`, { slug })<br/>  return document<br/>}</span><span id="f3eb" class="lu kt hu lq b fv md lw l lx ly">export default BlogPost</span></pre><p id="bb51" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æ”¾å…¥å›¾åƒURLæ„å»ºå™¨çš„ä»£ç è¡Œåï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code class="eh lz ma mb lq b">urlFor()</code>å‡½æ•°ä¸­å‘é€æ¥è‡ªSanityçš„å›¾åƒå¯¹è±¡ï¼Œå¹¶åœ¨ä¸åŒçš„æ–¹æ³•(ä¾‹å¦‚<code class="eh lz ma mb lq b">.width(50)</code>)åé¢æ·»åŠ <code class="eh lz ma mb lq b">.url()</code>-æ–¹æ³•ã€‚</p><h1 id="2b77" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">6.æ·»åŠ å¯Œæ–‡æœ¬å†…å®¹</h1><p id="2e82" class="pw-post-body-paragraph jv jw hu jx b jy lk iv ka kb ll iy kd ke lm kg kh ki ln kk kl km lo ko kp kq hn dt translated">å¦‚æœæ²¡æœ‰å¯¹æ–‡æœ¬å†…å®¹çš„å¼ºå¤§æ”¯æŒï¼Œä¸€ä¸ªåšå®¢å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚Sanityä¸­çš„å¯Œæ–‡æœ¬æ˜¯ä»¥ä¸€ç§å…è®¸æˆ‘ä»¬åœ¨è®¸å¤šä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨å®ƒçš„æ–¹å¼æ„å»ºçš„:ä»æµè§ˆå™¨ä¸­çš„HTMLåˆ°è¯­éŸ³ç•Œé¢ä¸­çš„è¯­éŸ³å®ç°ã€‚å…³äºå—å†…å®¹å’Œå®ƒçš„å¯æ‰©å±•æ€§æœ‰å¾ˆå¤šè¦è¯´çš„ï¼Œä½†åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åªä½¿ç”¨åŒ…<a class="ae kr" href="https://github.com/sanity-io/block-content-to-react" rel="noopener ugc nofollow" target="_blank">å—å†…å®¹ååº”</a>é™„å¸¦çš„ç°æˆç‰¹æ€§ã€‚ç”¨<code class="eh lz ma mb lq b">npm install --save @sanity/block-content-to-react</code>å®‰è£…ã€‚</p><pre class="jk jl jm jn fq lp lq lr ls aw lt dt"><span id="a4e8" class="lu kt hu lq b fv lv lw l lx ly">import BlockContent from '<a class="ae kr" href="http://twitter.com/sanity/block-content-to-react" rel="noopener ugc nofollow" target="_blank">@sanity/block-content-to-react</a>'<br/>import imageUrlBuilder from '<a class="ae kr" href="http://twitter.com/sanity/image-url" rel="noopener ugc nofollow" target="_blank">@sanity/image-url</a>'<br/>import client from '../client'<br/>const builder = imageUrlBuilder(client)<br/>function urlFor(source) {<br/>  return builder.image(source)<br/>}<br/>const BlogPost = ({ title = 'No title', name = 'No name', categories = [], authorImage = {}, body = [] }) =&gt; (<br/>  &lt;div&gt;<br/>    &lt;h1&gt;{title}&lt;/h1&gt;<br/>    &lt;span&gt;By {name}.&lt;/span&gt;<br/>    {categories &amp;&amp; (<br/>      &lt;ul&gt;Posted in<br/>        { categories.map(category =&gt; (<br/>          &lt;li key={category}&gt;{category}&lt;/li&gt;<br/>        ))}<br/>      &lt;/ul&gt;<br/>      )<br/>    }<br/>    &lt;div&gt;<br/>      &lt;img src={urlFor(authorImage).width(50).url()} /&gt;<br/>    &lt;/div&gt;<br/>    &lt;BlockContent<br/>      blocks={body}<br/>      imageOptions={{w: 320, h: 240, fit: 'max'}}<br/>      projectId={client.clientConfig.projectId}<br/>      dataset={client.clientConfig.dataset}<br/>    /&gt;<br/>  &lt;/div&gt;<br/>)</span><span id="f11d" class="lu kt hu lq b fv md lw l lx ly">BlogPost.getInitialProps = async ({ query: { slug } }) =&gt; {<br/>  const document = await client.fetch(`*[_type == "post" &amp;&amp; slug.current == $slug][0]{<br/>      title,<br/>      "name": author-&gt;name,<br/>      "categories": categories[]-&gt;title,<br/>      "authorImage": author-&gt;image,<br/>      body<br/>    }`, { slug })<br/>  return document<br/>}</span><span id="d41b" class="lu kt hu lq b fv md lw l lx ly">export default BlogPost</span></pre><p id="91de" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æˆ‘ä»¬å°†react-componentä½œä¸º<code class="eh lz ma mb lq b">BlockContent</code>å¯¼å…¥ï¼Œå¹¶ä»post-documentè·å–ä¸»ä½“ã€‚æˆ‘ä»¬å°†ä¸»ä½“ä½œä¸º<code class="eh lz ma mb lq b">blocks-prop</code>å‘é€ï¼Œå¹¶æ·»åŠ <code class="eh lz ma mb lq b">projectID</code>å’Œæ¥è‡ª<code class="eh lz ma mb lq b">client-config</code>çš„æ•°æ®é›†ï¼Œä»¥ä¾¿è®©<code class="eh lz ma mb lq b">BlockContent</code>ç»„ä»¶çŸ¥é“ä»å“ªé‡Œè·å–å¯èƒ½å‡ºç°åœ¨å¯Œæ–‡æœ¬å­—æ®µä¸­çš„å›¾åƒã€‚</p><p id="480b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æˆ‘è¿˜åŠ äº†ä¸€ä¸ªé“å…·å«<code class="eh lz ma mb lq b">imageOptions</code>ï¼Œæ§åˆ¶å›¾ç‰‡é»˜è®¤è¾“å‡ºã€‚å°±æ˜¯è¿™æ ·ï¼æ‚¨å¯ä»¥<a class="ae kr" href="https://github.com/sanity-io/block-content-to-react" rel="noopener ugc nofollow" target="_blank">å®šåˆ¶ä¸åŒå…ƒç´ çš„è¾“å‡ºï¼Œç”šè‡³é€šè¿‡å‘é€æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œåºåˆ—åŒ–å™¨â€çš„ä¸œè¥¿æ¥æ·»åŠ æ‚¨è‡ªå·±çš„å®šåˆ¶å—ç±»å‹</a>â€”â€”æˆ‘ä»¬å°†åœ¨å¦ä¸€ç¯‡åšå®¢æ–‡ç« ä¸­ä»‹ç»è¿™äº›ã€‚</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/e808695b8d2fd5a63af64ce82e7aae6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/0*ZdXb7CNz8oPa0nSZ"/></div></figure><p id="131a" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨åº”è¯¥æœ‰ä¸€ä¸ªåŸºæœ¬çš„åšå®¢æ¨¡æ¿</p><p id="522b" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æœ¬æ•™ç¨‹åˆ°æ­¤ç»“æŸï¼å½“è°ˆåˆ°ä¸ºä¸€ä¸ªéå¸¸å¸¸è§çš„å†…å®¹è®¾ç½®ç¼–å†™å‰ç«¯å±‚æ—¶ï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»æ¶‰åŠäº†å¾ˆå¤šå†…å®¹ï¼Œä½†æ˜¯ä»…ä»…æ¶‰åŠäº†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»“åˆä½¿ç”¨Sanityå’ŒReactæ¥å®Œæˆçš„åŠŸèƒ½å’Œæ¼‚äº®çš„äº‹æƒ…çš„å†°å±±ä¸€è§’ã€‚</p><p id="24ef" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated">æ‚¨å¯ä»¥ä»GitHub ä¸‹è½½<a class="ae kr" href="https://github.com/sanity-io/sanity-blog-tutorial" rel="noopener ugc nofollow" target="_blank">ç¤ºä¾‹é¡¹ç›®ï¼Œå¹¶éšæ—¶å‘æˆ‘ä»¬è¯¢é—®å…³äº</a><a class="ae kr" href="https://slack.sanity.io" rel="noopener ugc nofollow" target="_blank"> Slack </a>çš„é—®é¢˜ï¼Œæˆ–è€…æ‚¨å¯èƒ½æ‰¾åˆ°æˆ‘ä»¬çš„å…¶ä»–æ–¹å¼ã€‚</p></div><div class="ab cl me mf hc mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hn ho hp hq hr"><p id="63c2" class="pw-post-body-paragraph jv jw hu jx b jy jz iv ka kb kc iy kd ke kf kg kh ki kj kk kl km kn ko kp kq hn dt translated"><em class="ml">æœ€åˆå‘å¸ƒäº</em><a class="ae kr" href="https://www.sanity.io/blog/build-your-own-blog-with-sanity-and-next-js" rel="noopener ugc nofollow" target="_blank"><em class="ml">www . sanity . io</em></a><em class="ml">ã€‚</em></p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mr ms l"/></div></figure></div></div>    
</body>
</html>