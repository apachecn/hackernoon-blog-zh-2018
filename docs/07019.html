<html>
<head>
<title>AGUDLP principle for the configuration of a main level domain, AD set-up and IP addressing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">主级域配置、AD设置和IP寻址的AGUDLP原则</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/configuring-a-main-level-domain-ad-active-directory-set-up-and-ip-addressing-with-the-agudlp-d826ac46e5d5?source=collection_archive---------33-----------------------#2018-08-20">https://medium.com/hackernoon/configuring-a-main-level-domain-ad-active-directory-set-up-and-ip-addressing-with-the-agudlp-d826ac46e5d5?source=collection_archive---------33-----------------------#2018-08-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="bac1" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">以n'cloud虚拟办公室为例，在迈向全面运行系统之前必须完成的初步技术任务</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/d177405f02ea94176833b9a5f8783357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ordJY1PP2O9ycuB_.jpg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Image: <a class="ae jz" href="http://cloudaction.com/old_backup/" rel="noopener ugc nofollow" target="_blank">www.cloudaction.com</a></figcaption></figure><p id="0c65" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt kw translated">建立一个远程桌面终端服务器需要完成一些初步的技术任务，然后才能进入一个完全可操作的系统。<a class="ae jz" rel="noopener" href="/nworld-publications/strategic-and-financial-cleverness-behind-an-outsourced-cloud-based-it-infrastructure-the-example-6c1ee76569c8">后者的特点是在安全性、可靠性和故障安全方面的高质量标准</a>。这篇技术性文章的目的是向读者概述如何配置一个主级域，如何建立一个活动目录，以及IP地址。我这里指的是<a class="ae jz" href="https://www.ncloud.swiss" rel="noopener ugc nofollow" target="_blank"> n'cloud虚拟办公室</a>。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff lf"><img src="../Images/5b1a9d61fb5c106d3cf2354d47c5804b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fa8xQ9TBxJ27jq-3CAf8FA.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">n’cloud Virtual Office</figcaption></figure><p id="1fab" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">创建服务器</strong></p><p id="e1b1" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我们从安装主域服务器开始。我们将其命名为DOM002AD01，并配置域DOM002.local，这是整个结构的最高域。服务器将获得一个特定的地址“123.456.78.910”。该服务器也是主DNS，并被配置为转发DNS。我们得到以下非常基本的配置:</p><blockquote class="lg lh li"><p id="babc" class="ka kb lj kc b kd ke iv kf kg kh iy ki lk kk kl km ll ko kp kq lm ks kt ku kv hn dt translated"><strong class="kc hv">主级别域服务器:DOM002.local </strong></p><p id="812c" class="ka kb lj kc b kd ke iv kf kg kh iy ki lk kk kl km ll ko kp kq lm ks kt ku kv hn dt translated"><strong class="kc hv">域控制器主域:DOM002AD01。DOM002.local </strong></p><p id="2631" class="ka kb lj kc b kd ke iv kf kg kh iy ki lk kk kl km ll ko kp kq lm ks kt ku kv hn dt translated"><strong class="kc hv"> IP地址:123.456.78.910 </strong></p></blockquote><p id="7a43" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">在开始安装和配置服务器之前，我们需要在集群节点(DOMCLN201)上的Hyper-V中创建虚拟服务器。为此，我们需要一个映像，我们认为这个映像是在SYSPREP的准备工作中预先准备好的。我们将集群上的这个映像复制到一个专门为虚拟服务器创建的文件夹中，并以新服务器命名。现在，让我们为Hyper-V中的虚拟服务器创建新文件夹，以便能够安装虚拟服务器。为此，我们必须在操作之前选择存储服务器的具体存储位置。在创建服务器时，RAM值和硬盘存储器的动态功能被设置。</p><p id="98cb" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">确定服务器的世代</strong></p><p id="f657" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv"> <em class="lj">第1代:</em> </strong></p><p id="42bd" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">第1代为虚拟服务器提供了与以前版本的Hyper-V相同的虚拟硬件。</p><p id="e96f" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv"> <em class="lj">第二代:</em> </strong></p><p id="5cb1" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">第2代在虚拟机上提供了以下新功能:</p><blockquote class="lg lh li"><p id="fdd8" class="ka kb lj kc b kd ke iv kf kg kh iy ki lk kk kl km ll ko kp kq lm ks kt ku kv hn dt translated">使用标准网卡的PXE启动</p><p id="4c3a" class="ka kb lj kc b kd ke iv kf kg kh iy ki lk kk kl km ll ko kp kq lm ks kt ku kv hn dt translated">从虚拟SCSI磁盘引导</p><p id="b0de" class="ka kb lj kc b kd ke iv kf kg kh iy ki lk kk kl km ll ko kp kq lm ks kt ku kv hn dt translated">从虚拟SCSI DVD开始</p><p id="81c9" class="ka kb lj kc b kd ke iv kf kg kh iy ki lk kk kl km ll ko kp kq lm ks kt ku kv hn dt translated">安全启动(默认启用)</p><p id="1173" class="ka kb lj kc b kd ke iv kf kg kh iy ki lk kk kl km ll ko kp kq lm ks kt ku kv hn dt translated">UEFI固件支持</p></blockquote><p id="3c7f" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">由于虚拟硬盘是在第2代上设计和创建的，因此选择了第2代选项。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff ln"><img src="../Images/673a04420b327699c927d41b60574ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*POqkbtRvljp0OqiIfHyMUw.png"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek"><em class="lo">Generations Selection of virtual servers</em></figcaption></figure><p id="2137" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">创建服务器时，有一个选项需要您选择网络适配器。因为已经在给定的集群上创建了网络适配器，所以我们只需在“配置网络”部分选择适配器。这允许在网络和因特网上通信。</p><p id="5f31" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">然后，我们选择虚拟硬盘，它存储在集群的文件夹中。服务器的创建就已经完成了。现在可以启动、安装和配置虚拟服务器了。</p><p id="2900" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">主域服务器命名&amp; IP寻址</strong></p><p id="c76d" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我们启动服务器，从配置开始。首先，将计算机名更改为适当的预定义名称“DOM002AD01”。然后，服务器重新启动。然后，输入带有网关和DNS的IP地址，以便可以在提供虚拟服务器的公司的网络中使用该服务器。</p><p id="0876" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">主域上的角色安装</strong></p><p id="87e1" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">需要为域和整个AD结构安装Active Directory域服务角色。安装后，服务器可以提升为域控制器。因此，可以配置第一个域“主域(DOM002.local)”。该角色还带来了其他功能，如活动目录用户和计算机管理。在这里，用户创建NTFS组，稍后需要这些组来嵌套子域中的组，从而允许RDP用户进行远程和数据访问。</p><p id="c1f1" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">“DNS服务器”角色自动安装在所有Active Directory服务器上，整个结构中的主域服务器充当同一域和其他域的服务器的转发DNS。</p><p id="f4ed" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">活动目录管理&amp; NTFS组，AGUDLP原则</strong></p><p id="3873" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">第一步，创建一个新的域管理员，命名为“domain min @ DOM 002 . local”。我们现在将“Administrator”复制到Active Directory中，并将其重命名为“DOMAdmin”。为此，我们创建了一个新的组织单位(OU)，称为“NTFS组”。在其中，我们可以创建以后通过web访问和分配网络驱动器所需的所有组。回想起来，我们还应该将子域中的组嵌套到主域中的这些NTFS组中，以便web访问最终能够正常工作。组必须在组区域设置为“通用”，否则您将无法嵌套子域的组。</p><p id="754d" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">agu DLP原理</strong></p><p id="7667" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">在n'cloud.swiss，我们根据AGUDLP原则构建整个用户和群组结构。AGUDLP是一个简化用户和组的顺序和结构的原则。AGUDLP简单地代表<strong class="kc hv">帐户&gt;全局组&gt;通用组&gt;域本地&gt;权限</strong>。</p><p id="b043" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">用户帐户被添加到其子域的全局组中。然后，这些全局组嵌套在主域的通用组中。在主域上，它们被再次嵌套到特殊的“域本地”组中，并从那里被分配到它们的访问授权寄存器中的特定程序。</p><p id="867f" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我们环境中的几乎一切都是一样的，除了我们没有最后的“域本地”嵌套。这实际上只有在混乱和更多用户和组的情况下才是必要的。因为除了新管理员之外，主域上没有用户，所以我们不需要这一步。</p><p id="c22c" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">域名服务器</strong></p><p id="906b" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">DNS的主要任务是回答域名解析请求。DNS的工作方式很像目录查询。用户知道姓名，但不知道地址或电话号码。如果我们在网络中查询服务器名称，例如使用命令“nslookup ”, DNS会返回IPv4或IPv6地址，而不是电话号码。</p><p id="cec2" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我们现在创建两个DNS记录。其中之一是可以解析特定的网址，确保通过网络进行访问。另一个DNS正在转发到提供商的DNS。这样，网络中的其他服务器也可以访问互联网。目前，我们创建一个“反向查找区域”,以便在这些“正向查找区域”中创建新条目时，可以在其中创建指针条目。完成后，我们可以创建一个名为netkom.ch的新区域。重要的是将区域数据复制到整个结构中，以便子域中的服务器也能被重定向。现在我们整合已经定义的两个条目。我们使用条目WWW，因为这确保我们可以到达网站<a class="ae jz" href="http://www.netkom.ch" rel="noopener ugc nofollow" target="_blank"> www.netkom.ch </a>。</p><p id="4763" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><strong class="kc hv">子域配置(子域活动目录结构)</strong></p><p id="f86b" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">现在我们来看看子域的配置。我们从域控制器“USER1AD01”开始，在第二个AD“user 2 AD 01”上稍作延迟。为此，与主域的DOM002AD01一样，安装了“Active Directory域服务”角色，然后将这两个角色提升为“域控制器”。</p><p id="f289" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">在安装角色之前，首先在NIC选项卡中输入IP、DNS和网关地址，然后重新启动服务器。由于我们已经设置了到DOM002AD01的转发，现在输入了DOM002AD01的DNS地址。重新启动后，服务器现在可以安装角色并将其提升为域控制器。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff lp"><img src="../Images/d527a53dbb48da6d6231009ac4a9463f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rV8Q--VL6K3AopgEs2d_8A.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Image: <a class="ae jz" href="https://medium.com/nworld-publications" rel="noopener">n’world publications</a></figcaption></figure></div></div>    
</body>
</html>