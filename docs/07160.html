<html>
<head>
<title>Video Streaming in Your React Native App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React原生应用中的视频流</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/video-streaming-in-your-react-native-app-feae1c6ae4e2?source=collection_archive---------0-----------------------#2018-08-24">https://medium.com/hackernoon/video-streaming-in-your-react-native-app-feae1c6ae4e2?source=collection_archive---------0-----------------------#2018-08-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/9319b8b7d6fc0756f0e3f41e42f26a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*klAIhm-SPd134HN_J8V1gA.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/photos/XQdcBNRM8IY?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Zach Meaney</a> on <a class="ae jg" href="https://unsplash.com/search/photos/mobile-phone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b4ff" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我最近一直在与react-native-video 库合作，将视频整合到应用程序中。我必须说，这是一个来自react原生社区的令人印象深刻的库，有许多贡献者和用户。</p><h1 id="57b1" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">关键特征</h1><p id="3e9d" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">该库的一些关键特性包括:</p><ul class=""><li id="ca00" class="li lj hu jj b jk jl jo jp js lk jw ll ka lm ke ln lo lp lq dt translated">本地和远程文件回放支持。</li><li id="8a6a" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">带字幕的音频和文本轨道的选择。</li><li id="56ff" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">可配置速率(提高或降低视频速度)。</li><li id="3b3b" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">应用程序在后台运行时的音频播放。</li><li id="589e" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">外部回放。</li><li id="cd18" class="li lj hu jj b jk lr jo ls js lt jw lu ka lv ke ln lo lp lq dt translated">当然也支持iOS和Android设备。</li></ul><p id="0e67" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这些特性使这个库成为react本机应用程序中视频流的可靠选择。</p><h1 id="9fc8" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">设置</h1><p id="8f06" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">iOS和Android的设置都非常简单。</p><p id="fe61" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">运行以下命令来安装react-native-video包</p><pre class="lw lx ly lz fq ma mb mc md aw me dt"><span id="5c97" class="mf kg hu mb b fv mg mh l mi mj">npm install --save react-native-video</span></pre><p id="0f99" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">链接react-native-视频库，支持iOS和Android</p><pre class="lw lx ly lz fq ma mb mc md aw me dt"><span id="be05" class="mf kg hu mb b fv mg mh l mi mj">react-native link react-native-video</span></pre><p id="6c32" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">有了这两个命令，您就可以开始编码您的视频组件了。</p><h1 id="2b3b" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">开始使用<video>组件</video></h1><p id="deac" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">我已经创建了一个<em class="mk"> VideoComponent.js </em>，它将用于渲染视频。任何时候我们想要在这个应用程序中播放视频，我们都可以使用<em class="mk"> VideoComponent </em>。</p><p id="6028" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">您可以观察到，<em class="mk"> renderVideo() </em>方法从react-native-video库中调用了<em class="mk"> &lt; Video &gt; </em>组件。</p><p id="8f08" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为了渲染这个组件，我们需要提供视频源和播放器在我们的应用程序中播放的样式。</p><p id="41a9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在下面的例子中，我们提供了一个来自assets文件夹的mp4文件和一个播放器的基本样式。<em class="mk"> &lt;视频&gt; </em>附带的所有其他道具都是可选的，根据我们的需要进行配置。</p><figure class="lw lx ly lz fq iv"><div class="bz el l di"><div class="ml mm l"/></div></figure><p id="451a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在我们的<em class="mk"> VideoComponent </em>已经准备好了，我们可以从任何页面/屏幕调用它。对于我们的例子，我将从<em class="mk"> App.js </em>文件中调用它，这是我们应用程序的起始页面。</p><figure class="lw lx ly lz fq iv"><div class="bz el l di"><div class="ml mm l"/></div></figure><p id="0a14" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="mk"> render() </em>方法调用&lt; VideoComponent / &gt;，这样我们就可以开始运行了。</p><p id="e4ae" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">运行iOS或android的代码</p><pre class="lw lx ly lz fq ma mb mc md aw me dt"><span id="087f" class="mf kg hu mb b fv mg mh l mi mj">//iOS<br/>react-native run-ios </span><span id="ddea" class="mf kg hu mb b fv mn mh l mi mj">// Android<br/>react-native run-android</span></pre><p id="b47d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">模拟器现在打开，应用程序内有视频流。</p><figure class="lw lx ly lz fq iv fe ff paragraph-image"><div class="fe ff mo"><img src="../Images/278bb93c8e2e63e398203d987d481214.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*dvhexn_qSwQQbog60NljBw.gif"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Gif showing the emulator streaming video</figcaption></figure><h1 id="c30f" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">有用的道具</h1><p id="5c83" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">一旦我们集成了基本的视频流，我们就可以使用这个库附带的道具了。</p><p id="934e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以增加或减少音量，静音，确保应用程序后台播放音频，选择音频/文本轨道等..</p><p id="d88d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">需要注意的一点是新增了<em class="mk"> ignoreSilentSwitch </em>道具。在我们的例子中，我将它设置为“<em class="mk">服从</em>”。这是iOS设备特有的，指的是用户设备上的硬件静音开关。如果您注意到设备上没有任何音频的视频流，设备静音开关可能已启用。你可以覆盖它并设置道具为"<em class="mk">忽略</em>"</p><p id="1d81" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">请记住，将<em class="mk"> ignoreSilentSwitch </em>设置为<em class="mk">“忽略”</em>可能不是理想的解决方案，因为这不会让用户满意。</p><h1 id="96a2" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">远程文件回放</h1><p id="893a" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">在前面的示例中，我们看到了一个从本地资产文件夹中回放的文件。集成同一个库来从远程url传输视频也很简单。</p><p id="03bf" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如下所示，修改源以从url提取视频。</p><pre class="lw lx ly lz fq ma mb mc md aw me dt"><span id="befd" class="mf kg hu mb b fv mg mh l mi mj">source={{uri: '&lt;REMOTE URL&gt;'}}</span></pre><p id="9cf6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">欲了解更多关于该库的信息，请查看<a class="ae jg" href="https://github.com/react-native-community/react-native-video" rel="noopener ugc nofollow" target="_blank"> github </a>上的文档。希望你喜欢将视频流集成到react原生应用中。</p></div><div class="ab cl mp mq hc mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hn ho hp hq hr"><p id="78ef" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个故事最初发表在<a class="ae jg" href="http://adhithiravichandran.com" rel="noopener ugc nofollow" target="_blank">www.adhithiravichandran.com</a></p><p id="7ac1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">更多教程和文章请在twitter上关注我@<a class="ae jg" href="https://twitter.com/AdhithiRavi" rel="noopener ugc nofollow" target="_blank">adhithilavi</a>并访问我的博客<a class="ae jg" href="http://www.adhithiravichandran.com" rel="noopener ugc nofollow" target="_blank">www.adhithiravichandran.com</a></p><figure class="lw lx ly lz fq iv"><div class="bz el l di"><div class="mw mm l"/></div></figure></div></div>    
</body>
</html>