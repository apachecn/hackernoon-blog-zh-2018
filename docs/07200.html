<html>
<head>
<title>A crash course on serverless-side rendering with Vue.js, Nuxt.js and AWS Lambda</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Vue.js、Nuxt.js和AWS Lambda进行无服务器端渲染的速成课程</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/a-crash-course-on-serverless-side-rendering-with-vue-js-nuxt-js-and-aws-lambda-fbfaad80aa25?source=collection_archive---------3-----------------------#2018-08-26">https://medium.com/hackernoon/a-crash-course-on-serverless-side-rendering-with-vue-js-nuxt-js-and-aws-lambda-fbfaad80aa25?source=collection_archive---------3-----------------------#2018-08-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/d5deb5115f9c072a0cfc453897a69c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xBmMrkc8mFLdE_eDc1Fy9g.jpeg"/></div></div></figure><p id="a9dc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是一个很拗口的标题。不要让它吓跑你。归结起来很简单。</p><p id="591e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们希望两全其美。SEO boost服务器端呈现提供了单个页面应用程序的速度。所有这些基本上都是免费托管在AWS Lambda的无服务器环境中。</p><h1 id="da55" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">TL；速度三角形定位法(dead reckoning)</h1><p id="0704" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">这是我们将为您快速构建的内容的一个快速概述。随意跳到你最感兴趣的那一步。不要介意我内疚地让你读完整本书……*<em class="ld">内疚地盯着</em> *😐</p><ul class=""><li id="cf64" class="le lf hu je b jf jg jj jk jn lg jr lh jv li jz lj lk ll lm dt translated">我们在建造什么？</li><li id="f949" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">配置和安装依赖项</li><li id="2b36" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">用<a class="ae ls" href="https://serverless.com/" rel="noopener ugc nofollow" target="_blank">无服务器框架</a>和<a class="ae ls" href="https://nuxtjs.org/" rel="noopener ugc nofollow" target="_blank"> Nuxt.js </a>构建app</li><li id="b5fd" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">将应用程序部署到<a class="ae ls" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a></li><li id="ba78" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">用<a class="ae ls" href="https://dashbird.io/" rel="noopener ugc nofollow" target="_blank"> Dashbird </a>测试应用</li></ul><p id="51bd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> <em class="ld">注意</em> </strong> <em class="ld">:我们要写的</em> <a class="ae ls" href="https://github.com/adnanrahic/serverless-side-rendering-vue-nuxt" rel="noopener ugc nofollow" target="_blank"> <em class="ld">代码已经在GitHub </em> </a> <em class="ld">上了，如果需要进一步参考或者遗漏了什么步骤，可以随时查看。</em></p><h1 id="7f89" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">我们在建造什么？</h1><p id="bc7a" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">首先要做的是。我们想要一个超快的单页应用程序。但是，这通常是有代价的。糟糕的搜索引擎优化能力。这不行，这意味着我们也希望应用程序有服务器端的渲染。好吧，听起来很简单。我们将获取<a class="ae ls" href="https://nuxtjs.org/guide" rel="noopener ugc nofollow" target="_blank"> Nuxt.js </a>，这是一个用于创建通用<a class="ae ls" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>应用程序的框架，并将其配置为在服务器端呈现我们的页面。</p><p id="6ae1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为此，我们需要启动一个简单的Express服务器，并配置Nuxt渲染器通过Express提供文件服务。这比听起来简单多了。</p><p id="32a2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然而，这里关键的要点是<em class="ld">服务器</em>这个词。呃，我们不喜欢提那个词。那么，我们需要做什么？嗯，将整个应用程序部署到AWS Lambda上！它毕竟是一个很小的Node.js实例。</p><p id="0c11" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但这引发了一个担忧。如果一切都出了可怕的问题，如何监控和调试它？我通常让<a class="ae ls" href="https://dashbird.io/" rel="noopener ugc nofollow" target="_blank"> Dashbird </a>在一个单独的标签中打开，以实时监控我所有的无服务器资源。</p><p id="017f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">唷，有了它，让我们开始吧！</p><h1 id="a4e6" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">配置和安装依赖项</h1><p id="63b2" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">和往常一样，我们从枯燥的部分开始，设置项目并安装依赖项。</p><h2 id="4bb2" class="lt kb hu bd kc lu lv lw kg lx ly lz kk jn ma mb ko jr mc md ks jv me mf kw mg dt translated">1.安装无服务器框架</h2><p id="cf09" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">为了让无服务器开发<strong class="je hv">不</strong>成为绝对的折磨，继续安装<a class="ae ls" href="https://serverless.com/" rel="noopener ugc nofollow" target="_blank">无服务器框架</a>。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="101f" class="lt kb hu mm b fv mq mr l ms mt">$ npm i -g serverless</span></pre><p id="cf1d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv">注意:</strong> <em class="ld">如果您使用的是Linux或Mac，您可能需要以</em> <code class="eh mu mv mw mm b"><em class="ld">sudo</em></code> <em class="ld">的身份运行该命令。</em></p><p id="f43e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦全局安装到您的机器上，您就可以在终端的任何地方使用这些命令。但是为了让它与您的AWS帐户通信，您需要配置一个IAM用户。跳过<a class="ae ls" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html" rel="noopener ugc nofollow" target="_blank">这里的解释</a>，然后返回并使用提供的键运行下面的命令。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="56b0" class="lt kb hu mm b fv mq mr l ms mt">$ serverless config credentials \ <br/>    --provider aws \ <br/>    --key xxxxxxxxxxxxxx \ <br/>    --secret xxxxxxxxxxxxxx</span></pre><p id="1cbb" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，当您运行任何终端命令时，您的无服务器安装知道要连接到哪个帐户。让我们来看看它是如何工作的。</p><h2 id="cb4e" class="lt kb hu bd kc lu lv lw kg lx ly lz kk jn ma mb ko jr mc md ks jv me mf kw mg dt translated">2.创建服务</h2><p id="41f4" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">创建一个新目录来存放您的无服务器应用程序服务。在那里启动一个终端。现在您已经准备好创建一个新的服务了。</p><p id="5397" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你问的服务是什么？把它当成一个项目。但也不尽然。在这里定义AWS Lambda函数、触发它们的事件以及它们需要的任何AWS基础设施资源，所有这些都在一个名为<strong class="je hv"> serverless.yml </strong>的文件中。</p><p id="3581" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">回到您的终端，键入:</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="dd24" class="lt kb hu mm b fv mq mr l ms mt">$ serverless create \<br/>    --template aws-nodejs \<br/>    --path serverless-side-rendering-vue-nuxt</span></pre><p id="c8d1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">create命令将创建一个新的<strong class="je hv">服务</strong>。修卡！但有趣的部分来了。我们需要为函数选择一个运行时。这被称为<strong class="je hv">模板</strong>。传入<code class="eh mu mv mw mm b">aws-nodejs</code>会将运行时设置为Node.js .这正是我们想要的。路径将为服务创建一个文件夹。</p><h2 id="c531" class="lt kb hu bd kc lu lv lw kg lx ly lz kk jn ma mb ko jr mc md ks jv me mf kw mg dt translated">3.安装npm模块</h2><p id="5bf3" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">在您的终端中切换到<strong class="je hv">无服务器端渲染vue-nuxt </strong>文件夹。这里应该有三个文件，但是现在，让我们首先初始化npm。</p><p id="3a16" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在创建了<code class="eh mu mv mw mm b">package.json</code>文件之后，您可以安装一些依赖项。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="6c59" class="lt kb hu mm b fv mq mr l ms mt">$ npm i axios nuxt express serverless-http serverless-apigw-binary</span></pre><p id="7921" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这些是我们的生产依赖项，我将更详细地解释它们的作用。除了它们，我们还需要一个作为开发依赖。这将让我们把一个域与我们的端点联系起来。太棒了。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="c30f" class="lt kb hu mm b fv mq mr l ms mt">$ npm i --save-dev serverless-domain-manager</span></pre><p id="17ec" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，你的<code class="eh mu mv mw mm b">package.json</code>应该是这样的。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="d1e0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们还需要添加两个脚本，一个用于在本地开发机器上运行<code class="eh mu mv mw mm b">nuxt</code>，另一个用于构建和部署应用程序。你可以在<code class="eh mu mv mw mm b">package.json</code>的<code class="eh mu mv mw mm b">scripts</code>部分看到它们。</p><h2 id="462e" class="lt kb hu bd kc lu lv lw kg lx ly lz kk jn ma mb ko jr mc md ks jv me mf kw mg dt translated">4.配置serverless.yml文件</h2><p id="5cca" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">接下来，让我们最终在代码编辑器中打开项目。检查<strong class="je hv"> serverless.yml </strong>文件，它包含此服务的所有配置设置。您可以在这里指定常规配置设置和每个功能的设置。您的<strong class="je hv"> serverless.yml </strong>将充满样板代码和注释。请随意删除它，并粘贴这个。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="b1ef" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">属性列出了服务中的所有函数。我们只需要一个函数，因为它将运行Nuxt渲染。它的工作原理是旋转一个微小的Express应用程序，将Nuxt渲染器中间件连接到Express路由器，并将应用程序传递给<strong class="je hv">无服务器http </strong>模块。反过来，这将把整个Express应用捆绑到一个lambda函数中，并将其绑定到一个API网关端点。在functions属性下，您可以看到一个<strong class="je hv"> nuxt </strong>函数，它在<code class="eh mu mv mw mm b">index.js</code>文件中有一个名为<code class="eh mu mv mw mm b">nuxt</code>的处理程序。API Gateway会将所有请求代理到内部Express路由器，后者会告诉Nuxt渲染器渲染我们的Vue.js页面。哇，听起来很复杂！但其实真的不是。一旦我们开始写代码，你会看到它是多么简单。</p><p id="4b60" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们还添加了两个插件，一个是让更多mime类型通过API网关的<code class="eh mu mv mw mm b">serverless-apigw-binary</code>，另一个是让我们毫不费力地将域名连接到端点的<code class="eh mu mv mw mm b">serverless-domain-manager</code>。</p><p id="115b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们在底部还有一个<code class="eh mu mv mw mm b">custom</code>部分。属性充当了一种将环境变量安全加载到我们的服务中的方式。稍后通过使用<code class="eh mu mv mw mm b">${self:custom.secrets.&lt;environment_var&gt;}</code>引用它们，实际值保存在一个名为<code class="eh mu mv mw mm b">secrets.json</code>的简单文件中。</p><p id="f3e0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">除此之外，我们还让API网关二进制插件知道我们想让所有类型通过，并为我们的端点设置一个自定义域。</p><p id="c8bd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">配置到此为止，下面添加<code class="eh mu mv mw mm b">secrets.json</code>文件。</p><h2 id="3c03" class="lt kb hu bd kc lu lv lw kg lx ly lz kk jn ma mb ko jr mc md ks jv me mf kw mg dt translated">5.添加机密文件</h2><p id="c49e" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">我们都知道把私钥推给GitHub会害死小企鹅。我们不要那样做。用无服务器框架处理这个问题很简单。添加一个<code class="eh mu mv mw mm b">secrets.json</code>文件并粘贴进去。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="1262" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，只有通过更改这些值，您才能将不同的环境部署到不同的阶段和域。相当酷。</p><h1 id="438c" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">使用无服务器框架和Nuxt.js构建应用程序</h1><p id="ae28" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">我们将使用Nuxt.js来构建我们的通用Vue.js应用程序。这是什么意思？好吧，让我们保持简单，它只是一个服务器端渲染的单页应用程序。这意味着您不需要担心SEO，因为它会在将JavaScript发送给客户端之前对其进行渲染。但是，一旦它被加载到客户端，它就不会再次请求文件，而是缓存它。更快！我喜欢它。</p><p id="20a6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们跳进来。</p><h2 id="d666" class="lt kb hu bd kc lu lv lw kg lx ly lz kk jn ma mb ko jr mc md ks jv me mf kw mg dt translated">1.设置Nuxt.js服务器端渲染</h2><p id="2cf4" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">为了让Nuxt工作，我们需要一个<code class="eh mu mv mw mm b">nuxt.config.js</code>文件来添加我们的构建配置。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="7123" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以看到我们需要<strong class="je hv"> secrets.js </strong>文件，以便在静态文件的<code class="eh mu mv mw mm b">publicPath</code> URL中加载我们的阶段。一旦我们在下面的快速路由器中添加了路由，您就会明白为什么这很重要。另外，检查<code class="eh mu mv mw mm b">srcDir</code>，它指定了我们的客户端文件所在的文件夹的名称。</p><p id="9e82" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦添加完毕，创建另一个名为<strong class="je hv"> nuxt.js </strong>的文件。很直观，我知道。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="919b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这很简单。我们获取了Express和Nuxt，用<code class="eh mu mv mw mm b">express.static</code>创建了一个静态路由，并将Nuxt将要创建的捆绑JavaScript的目录传递给它。这里的路径是<code class="eh mu mv mw mm b">/_nuxt</code>，但是因为API Gateway添加了stage作为后缀，我们需要在上面提到的<code class="eh mu mv mw mm b">nuxt.config.js</code>文件的<code class="eh mu mv mw mm b">publicPath</code>中指定它。</p><p id="a351" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦加载了配置，除了将<code class="eh mu mv mw mm b">nuxt.render</code>中间件传递给Express应用程序之外，没有什么要做的了。</p><p id="804e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，应用程序需要连接到<code class="eh mu mv mw mm b">serverless-http</code>并作为lambda函数导出。创建一个<code class="eh mu mv mw mm b">index.js</code>文件并将其粘贴进去。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="dd48" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如您所见，我们还需要创建<code class="eh mu mv mw mm b">binaryMimeTypes.js</code>文件来保存我们想要启用的所有mime类型。这只是一个简单的数组，我们将它传递给<code class="eh mu mv mw mm b">serverless-http</code>模块。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="ac76" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">太好了，这就是Nuxt的设置。让我们跳进客户端代码！</p><h2 id="e100" class="lt kb hu bd kc lu lv lw kg lx ly lz kk jn ma mb ko jr mc md ks jv me mf kw mg dt translated">2.编写客户端Vue.js</h2><p id="eae9" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">在项目的根目录下创建一个新文件夹，并将其命名为<code class="eh mu mv mw mm b">client</code>。如果你向上滚动，我们在<code class="eh mu mv mw mm b">nuxt.config.js</code>文件中设置<code class="eh mu mv mw mm b">srcDir</code>指向一个名为<code class="eh mu mv mw mm b">client</code>的目录。</p><p id="03e0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这个<code class="eh mu mv mw mm b">client</code>文件夹中，再创建三个名为<code class="eh mu mv mw mm b">components</code>、<code class="eh mu mv mw mm b">layouts</code>、<code class="eh mu mv mw mm b">pages</code>的文件夹。进入<code class="eh mu mv mw mm b">layouts</code>文件夹后，创建一个名为<code class="eh mu mv mw mm b">default.vue</code>的新文件，并粘贴进去。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="5671" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">默认视图将拥有包含来自Nuxt的渲染内容的<code class="eh mu mv mw mm b">&lt;navbar/&gt;</code>组件和<code class="eh mu mv mw mm b">&lt;nuxt/&gt;</code>组件。</p><p id="efc2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在将<code class="eh mu mv mw mm b">navbar.vue</code>文件添加到<code class="eh mu mv mw mm b">components</code>文件夹中。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="99b7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是一个非常简单的导航工具，可以用来在一些可爱的狗狗之间导航。一旦我们在<code class="eh mu mv mw mm b">pages</code>文件夹中添加了一些东西，这就有意义了。</p><p id="d3b9" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在<code class="eh mu mv mw mm b">pages</code>文件夹中创建一个<code class="eh mu mv mw mm b">index.vue</code>文件，并添加下面的代码。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="4028" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh mu mv mw mm b">index.vue</code>文件将呈现在我们的应用程序的根路径上。它调用一个狗API，会显示一个可爱的狗的图片。要创建更多的路线，创建一个名为<code class="eh mu mv mw mm b">dogs</code>的子文件夹，并在其中创建一个<code class="eh mu mv mw mm b">index.vue</code>文件和一个<code class="eh mu mv mw mm b">_breed.vue</code>文件。<code class="eh mu mv mw mm b">index.vue</code>将在<code class="eh mu mv mw mm b">/dogs</code>路线渲染，<code class="eh mu mv mw mm b">_breed.vue</code>将在<code class="eh mu mv mw mm b">/dogs/:breed</code>渲染，<code class="eh mu mv mw mm b">:breed</code>代表路线参数。</p><p id="279d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将其添加到<code class="eh mu mv mw mm b">dogs</code>目录的<code class="eh mu mv mw mm b">index.vue</code>中。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="a150" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">还有，<code class="eh mu mv mw mm b">dogs</code>文件夹中的<code class="eh mu mv mw mm b">_breed.vue</code>文件中的另一个片段。</p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="14f5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">正如你在这些文件中看到的，有一个<code class="eh mu mv mw mm b">head()</code>函数。它会在你的页面的<code class="eh mu mv mw mm b">&lt;head&gt;</code>中添加自定义字段，给它适当的SEO支持！</p><p id="1e07" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> <em class="ld">注意</em> </strong> <em class="ld">:如果你卡住了，</em> <a class="ae ls" href="https://github.com/adnanrahic/serverless-side-rendering-vue-nuxt" rel="noopener ugc nofollow" target="_blank"> <em class="ld">下面是回购</em> </a> <em class="ld">中代码的样子。</em></p><p id="205b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们部署它，看看它是否有效。</p><h1 id="8834" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">将应用程序部署到AWS Lambda</h1><p id="3a08" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">在最开始的时候，我们给我们的<code class="eh mu mv mw mm b">package.json</code>添加了一个叫做<code class="eh mu mv mw mm b">deploy</code>的脚本。它将构建Nuxt应用程序，并按照我们在<code class="eh mu mv mw mm b">serverless.yml</code>中指定的方式部署无服务器服务。</p><p id="59fc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你需要做的就是跑:</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="6f2c" class="lt kb hu mm b fv mq mr l ms mt">$ npm run deploy</span></pre><p id="7a58" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您将看到终端为您的应用程序返回一些带有端点的输出。但是，我们还有一件事要做。我们需要添加域。我们已经在<code class="eh mu mv mw mm b">serverless.yml</code>中添加了配置，但是我们还需要运行一个命令。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="feeb" class="lt kb hu mm b fv mq mr l ms mt">$ sls create_domain</span></pre><p id="f898" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这将创建一个CloudFront发行版，并将其连接到您的域。确保您已将证书添加到AWS帐户。AWS通常需要大约20分钟来提供一个新的发行版。去喝杯咖啡吧。</p><pre class="mh mi mj mk fq ml mm mn mo aw mp dt"><span id="6faa" class="lt kb hu mm b fv mq mr l ms mt">$ npm run deploy</span></pre><p id="2f6b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">回来了？好的，继续，再部署一次。</p><p id="90da" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您仍然可以使用默认端点，但是现在您也将它绑定到了您的域。它应该是这样的。</p><figure class="mh mi mj mk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mz"><img src="../Images/8c6042b1848afa4ac1e5540ced2faf87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*M7L4xp92Plh4REVC.png"/></div></div></figure><p id="e6b3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">太好了，你的应用已经运行了。去试试吧。</p><h1 id="78dd" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">用Dashbird测试应用程序</h1><p id="452e" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">在测试应用程序时，我通常会查看我的Dashbird指标，以确保它一切正常。如果是这样，浏览器控制台和Dashbird应用程序都不应该有任何错误。酷的是<a class="ae ls" href="https://dashbird.io/features/" rel="noopener ugc nofollow" target="_blank"> Dashbird </a>是<a class="ae ls" href="https://dashbird.io/pricing/" rel="noopener ugc nofollow" target="_blank">免费的，不需要信用卡</a>到<a class="ae ls" href="https://dashbird.io/register/" rel="noopener ugc nofollow" target="_blank">报名</a>。依我看，这是双赢。</p><figure class="mh mi mj mk fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff na"><img src="../Images/fe599fa0ddbcf69bb5d0f6af498f5760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EXy-p6hGQhwT2lAQ.gif"/></div></div></figure><p id="de74" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我这边的日志显示都是绿色的，所以它工作得很好！就这样，应用程序完成了。您已经使用Nuxt.js创建了一个服务器端渲染的Vue.js应用程序，在AWS Lambda上的无服务器环境中托管它，并在用户开始抱怨之前添加了一种监控和调试应用程序的方法。没有比这更好的了。</p><h1 id="b7bb" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">包扎</h1><p id="da25" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">这是一种全新的创建快速响应网站的思维方式。绝对没有你需要担心的服务器。只需部署代码，并保证它会工作。如果有什么东西坏了，你会有仪表板鸟在背后看着你，如果有什么不对劲，它会提醒你。该死，我喜欢松散的集成。</p><p id="112b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你在某个地方卡住了，看看GitHub repo 以获得进一步的参考，如果你想让更多人在GitHub上看到它，请随意给它打个星。</p><p id="466a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你想阅读我以前的一些无服务器思考，请前往<a class="ae ls" rel="noopener" href="/@adnanrahic">我的简介</a>或<a class="ae ls" href="https://upscri.be/b6f3d5/" rel="noopener ugc nofollow" target="_blank">加入我的时事通讯！</a></p><figure class="mh mi mj mk fq iv"><div class="bz el l di"><div class="nb my l"/></div></figure><p id="294d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者，马上看看我的几篇文章:</p><ul class=""><li id="ee5e" class="le lf hu je b jf jg jj jk jn lg jr lh jv li jz lj lk ll lm dt translated"><a class="ae ls" href="https://hackernoon.com/building-a-serverless-contact-form-with-aws-lambda-and-aws-ses-fbf01d523678" rel="noopener ugc nofollow" target="_blank">使用AWS Lambda和AWS SES构建无服务器联系表单</a></li><li id="05cd" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated">【Express和MongoDB的无服务器API速成班</li><li id="bb6f" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated"><a class="ae ls" href="https://hackernoon.com/solving-invisible-scaling-issues-with-serverless-and-mongodb-1a065b5a6465" rel="noopener ugc nofollow" target="_blank">使用无服务器和MongoDB解决不可见的伸缩问题</a></li><li id="a60d" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated"><a class="ae ls" href="https://dev.to/adnanrahic/how-to-deploy-a-nodejs-application-to-aws-lambda-using-serverless-2nc7" rel="noopener ugc nofollow" target="_blank">如何使用无服务器将Node.js应用程序部署到AWS Lambda</a></li><li id="68fa" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated"><a class="ae ls" href="https://hackernoon.com/getting-started-with-aws-lambda-and-node-js-4ce3259c6dfd" rel="noopener ugc nofollow" target="_blank">AWS Lambda和Node.js入门</a></li><li id="01e2" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated"><a class="ae ls" href="https://medium.freecodecamp.org/a-crash-course-on-securing-serverless-apis-with-json-web-tokens-ff657ab2f5a5" rel="noopener ugc nofollow" target="_blank">用JSON web令牌保护无服务器API的速成班</a></li><li id="c885" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated"><a class="ae ls" href="https://hackernoon.com/migrating-your-node-js-rest-api-to-serverless-d2a170e0856c" rel="noopener ugc nofollow" target="_blank">将Node.js REST API迁移到无服务器</a></li><li id="faa6" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated"><a class="ae ls" href="https://hackernoon.com/building-a-serverless-rest-api-with-node-js-and-mongodb-2e0ed0638f47" rel="noopener ugc nofollow" target="_blank">用Node.js和MongoDB构建无服务器REST API</a></li><li id="01b6" class="le lf hu je b jf ln jj lo jn lp jr lq jv lr jz lj lk ll lm dt translated"><a class="ae ls" href="https://hackernoon.com/a-crash-course-on-serverless-with-node-js-632b37d58b44" rel="noopener ugc nofollow" target="_blank">node . js无服务器速成班</a></li></ul><p id="462a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我也强烈推荐查看<a class="ae ls" href="https://css-tricks.com/routing-route-protection-server-rendered-vue-apps-using-nuxt-js/" rel="noopener ugc nofollow" target="_blank">这篇关于Nuxt.js的文章</a>，以及<a class="ae ls" href="https://serverless.com/blog/serverless-api-gateway-domain/" rel="noopener ugc nofollow" target="_blank">这篇关于无服务器域管理器的教程</a>。</p><p id="7edd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">希望你们喜欢读这篇文章，就像我喜欢写这篇文章一样。如果你喜欢，拍一下那个小心脏，这样更多的人会看到这个教程。直到下次，保持好奇，玩得开心。</p></div><div class="ab cl nc nd hc ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="hn ho hp hq hr"><p id="820b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ld">原载于</em><a class="ae ls" href="https://dev.to/adnanrahic/a-crash-course-on-serverless-side-rendering-with-vuejs-nuxtjs-and-aws-lambda-1nk4" rel="noopener ugc nofollow" target="_blank"><em class="ld">dev . to</em></a><em class="ld">。</em></p></div></div>    
</body>
</html>