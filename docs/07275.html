<html>
<head>
<title>Laravel E-Commerce Tutorial with PyroCMS [Live Demo]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyroCMS的Laravel电子商务教程[现场演示]</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/laravel-e-commerce-tutorial-with-pyrocms-live-demo-538bf0a703f4?source=collection_archive---------7-----------------------#2018-08-28">https://medium.com/hackernoon/laravel-e-commerce-tutorial-with-pyrocms-live-demo-538bf0a703f4?source=collection_archive---------7-----------------------#2018-08-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/0f7017c9a423f5e99ed5e89296b2de7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OcLPC_mZ0_tRVRSQujlODA.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/photos/HYBOqyse6EU?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Julien Millet</a> on <a class="ae jg" href="https://unsplash.com/search/photos/lava?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ba81" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">“我厌倦了所有对PHP的厌恶。你可以用任何语言写sh*tty代码。”</p><p id="cef7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">那是我们队里唯一的PHP后卫，兰亭。</p><p id="ea92" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">"大多数时候，问题出在程序员身上，而不是编程语言."</p><p id="77b0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">又是他——基本上是对的。</p><p id="3c90" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">“有没有试过用Laravel做点什么？<em class="kf">牛逼</em>框架&amp;社区。”</p><p id="9d11" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">自从我早期编程以来，PHP取得了巨大的飞跃。我也没有花时间跳回到它的现代环境中(忙着<a class="ae jg" href="https://snipcart.com/blog/progressive-migration-backbone-vuejs-refactoring" rel="noopener ugc nofollow" target="_blank">涉足Vue.js </a>重构&amp;原型)。</p><p id="cf9d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">所以今天，这正是我要做的。</p><p id="1f92" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">怎么会？<strong class="jj hv">通过创建一个Laravel电子商务网站</strong>。</p><p id="774f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我将使用Laravel驱动的PyroCMS &amp; Snipcart来帮助我做到这一点。</p><p id="5a82" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">碰巧这个周末我做了一大堆意大利面酱。我永远也吃不完，所以为什么不在网上卖剩余的呢！</p><p id="020c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在本教程中，我将向您展示:</p><ul class=""><li id="a14b" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke kl km kn ko dt translated">如何建立一个PyroCMS演示网站</li><li id="da01" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">如何给PyroCMS添加电子商务面板</li><li id="a93e" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">如何在项目前端显示Snipcart产品</li><li id="8830" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">如何在PyroCMS中使用webhooks和Laravel控制器</li><li id="20a6" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">如何在结帐时使用Snipcart的自定义验证</li></ul><p id="9ab8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">看看我生疏的PHP技能能否盖过我的厨艺。</p><h1 id="f723" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">Laravel &amp;电子商务:快速上下文</h1><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ls"><img src="../Images/90e6fade19f31bca2d1ffe241d2502b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*FLOxlFldgXh7mOBi.png"/></div></div></figure><p id="42e2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于那些还不知道的人:<strong class="jj hv"> Laravel是一个开源的PHP web框架，用于构建网站&amp; web应用</strong>。</p><p id="1e09" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">它有一个平滑的学习曲线，消除了一些用PHP构建的怪癖，有许多现代的内置库。有人说它相当于Ruby on Rails PHP。</p><p id="a479" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="kf">想在开始这个tuts之前熟悉一下Laravel吗？查看</em> <a class="ae jg" href="https://selftaughtcoders.com/from-idea-to-launch/lesson-17/laravel-5-mvc-application-in-10-minutes/" rel="noopener ugc nofollow" target="_blank"> <em class="kf">这篇文章</em></a><em class="kf">——向你展示如何在10分钟内构建一个简单的MVC应用程序&lt;。</em></p><p id="6846" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">有了Laravel，你可以利用<a class="ae jg" href="https://getcomposer.org/" rel="noopener ugc nofollow" target="_blank"> Composer </a>来管理依赖&amp;包。许多有用的软件包将允许你快速跟踪你的Laravel应用程序或网站开发。想想调试、认证、API交互等等。像<a class="ae jg" href="https://packagist.org/" rel="noopener ugc nofollow" target="_blank">Packagist</a>&amp;<a class="ae jg" href="https://packalyst.com/" rel="noopener ugc nofollow" target="_blank">packapyst</a>这样的网站是找到有用的Laravel软件包的很好的资源。</p><h1 id="8e1c" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">Laravel上的电商？</h1><p id="62ef" class="pw-post-body-paragraph jh ji hu jj b jk lx jm jn jo ly jq jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">当然，还有针对Laravel的电子商务包。像<a class="ae jg" href="https://github.com/mage2/laravel-ecommerce" rel="noopener ugc nofollow" target="_blank"> Mage2 </a>和<a class="ae jg" href="https://github.com/aimeos/aimeos-laravel#aimeos-laravel-package" rel="noopener ugc nofollow" target="_blank"> Aimeos </a>这样的热门应用可以帮助你在Laravel应用上设置电子商务功能。</p><p id="960a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">因此，你在Laravel的电子商务选择非常多:</p><ol class=""><li id="85be" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke mc km kn ko dt translated">使用Laravel的框架从头开始构建您自己的电子商务应用程序。</li><li id="5477" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke mc km kn ko dt translated">使用电子商务包来扩展您的应用程序。</li><li id="54b4" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke mc km kn ko dt translated">选择一个Laravel驱动的CMS，并添加自定义电子商务。</li></ol><p id="91b2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">第一个？耗时</strong>。我可以在拉勒维尔做一个完整的电子商务应用程序。但是我没有时间从头开始编写代码——我需要一个MVP来尽快测试意大利面酱市场！</p><p id="b33b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">第二个？居然有意思</strong>。我们可能会在另一篇文章中这样做！</p><p id="9cea" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><strong class="jj hv">第三个？这就是我们在这里做的。它将通过有用的捷径加快我们的发展(PyroCMS搭建网站；Snipcart抽象电子通信逻辑&amp;后端)。</strong></p><p id="26ec" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我真的很高兴能在这个演示的Laravel项目中操作。与我们的许多jam stack/static site tut不同，为我们的商店处理任何后端逻辑都很容易。</p><p id="f04c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="kf">编者按:如果你正在用Laravel建立一个简单的订阅业务，请查看</em> <a class="ae jg" href="https://laravel.com/docs/5.5/billing" rel="noopener ugc nofollow" target="_blank"> <em class="kf"> Laravel收银台</em> </a> <em class="kf">，或者</em> <a class="ae jg" href="https://docs.snipcart.com/configuration/recurring-and-subscription-plans-definition" rel="noopener ugc nofollow" target="_blank"> <em class="kf">我们自己的订阅功能</em> </a> <em class="kf">。</em></p><h1 id="a338" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">关于PyroCMS的一句话</h1><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff md"><img src="../Images/9252010cbc76282ce5135327d9dd0b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uvX0KKfdU4qN5rh0.png"/></div></div></figure><p id="7700" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我以前使用PHP CMS的经历并不是很好。然而，我听说过很多关于Pyro的好东西。因为我需要一个Laravel驱动的工具来做这个tuts，所以选择它是显而易见的。</p><p id="02db" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><a class="ae jg" href="https://pyrocms.com/" rel="noopener ugc nofollow" target="_blank"> PyroCMS </a>是专门为Laravel打造的PHP CMS。它是麻省理工学院许可下的开源软件，配备了许多有用的功能。</p><p id="1d51" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">本着透明的精神，以下是其他基于Laravel的CMS:</p><ul class=""><li id="0d08" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke kl km kn ko dt translated">十月CMS ( <a class="ae jg" href="https://snipcart.com/blog/snipcart-octobercms-ecommerce-tutorial-got" rel="noopener ugc nofollow" target="_blank">见我们的tuts </a>)</li><li id="6978" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">AsgardCMS</li><li id="1d5d" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">熔岩</li><li id="5c04" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">典型的</li><li id="266c" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">Statamic ( <a class="ae jg" href="https://snipcart.com/blog/integrating-e-commerce-on-statamic-flat-file-cms" rel="noopener ugc nofollow" target="_blank">参见我们的tuts </a>)</li></ul><h1 id="4f04" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">Laravel电子商务教程:构建PyroCMS演示商店</h1><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff me"><img src="../Images/54c0fed48296dde455d71e3f93365cb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nv17jTZWISHjHS_B.jpg"/></div></div></figure><h2 id="c38b" class="mf kv hu bd kw mg mh mi la mj mk ml le js mm mn li jw mo mp lm ka mq mr lq ms dt translated">先决条件</h2><p id="5820" class="pw-post-body-paragraph jh ji hu jj b jk lx jm jn jo ly jq jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">对于本教程，您需要:</p><ul class=""><li id="f49f" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke kl km kn ko dt translated">对PHP作为编程语言的基本理解</li><li id="efee" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">安装了PHP和<a class="ae jg" href="https://getcomposer.org/" rel="noopener ugc nofollow" target="_blank"> Composer </a>的网络服务器</li><li id="d6f3" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">这个项目的数据库(我正在使用MySQL)</li><li id="36c0" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated"><a class="ae jg" href="https://app.snipcart.com/register" rel="noopener ugc nofollow" target="_blank">一个Snipcart账号</a>(测试模式下永远免费)</li></ul><h1 id="faff" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">步骤1:安装PyroCMS</h1><p id="0f68" class="pw-post-body-paragraph jh ji hu jj b jk lx jm jn jo ly jq jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">首先用Composer搭建一个PyroCMS项目。</p><p id="bca1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><code class="eh mt mu mv mw b">composer create-project pyrocms/pyrocms pyro_demo</code></p><p id="5a77" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">将web服务器的根文件夹设置为项目的<code class="eh mt mu mv mw b">public</code>文件夹。确保它可以写入<code class="eh mt mu mv mw b">public/app</code>、<code class="eh mt mu mv mw b">bootstrap/cache</code>和<code class="eh mt mu mv mw b">storage</code>文件夹。熟悉Laravel的人会认出它的目录结构。如果你是PyroCMS的新手，准备好被它的快速运行所折服吧。</p><p id="fb70" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">访问您的网站，使用内置的安装程序来配置Pyro与您的网站信息和数据库设置。</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mx"><img src="../Images/bbcde4b9453d4acbebc997de7d1ac861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*I2edfO47Nakrv47o.png"/></div></div></figure><p id="21e7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在您可以从<code class="eh mt mu mv mw b">composer.json</code>中移除<code class="eh mt mu mv mw b">anomaly/installer-module</code>依赖项，然后运行<code class="eh mt mu mv mw b">composer update</code>。</p><h1 id="9bf8" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">步骤2:为产品构建电子商务面板</h1><p id="e4a0" class="pw-post-body-paragraph jh ji hu jj b jk lx jm jn jo ly jq jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">尽管我们有一个Laravel项目可以玩，PyroCMS建议将新的功能分割成<em class="kf">插件</em>。对于一个大项目来说，为不相关的功能添加一些插件是一个好主意。这里，我们将使用<a class="ae jg" href="https://laravel.com/docs/5.0/commands" rel="noopener ugc nofollow" target="_blank"> artisan命令</a>创建一个产品模块:</p><pre class="lt lu lv lw fq my mw mz na aw nb dt"><span id="ad48" class="mf kv hu mw b fv nc nd l ne nf">php artisan make:addon snipcart.module.products</span></pre><p id="b14e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这将生成文件夹<code class="eh mt mu mv mw b">addons/{your site slug}/snipcart/products-module</code>。从现在开始，大部分路径都是相对于这个文件夹的。</p><p id="989d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Pyro的核心是流的概念——本质上是内容的集合。我们的插件定义了一个我们与artisan一起搭建的<code class="eh mt mu mv mw b">products</code>流:</p><pre class="lt lu lv lw fq my mw mz na aw nb dt"><span id="b531" class="mf kv hu mw b fv nc nd l ne nf">php artisan make:stream products snipcart.module.products</span></pre><p id="7a9f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这些命令产生了一些新元素。让我们先来看看我们的addon中的<code class="eh mt mu mv mw b">migrations</code>文件夹，在这里我们只需要添加一些东西就有了一个完整的产品管理后端。</p><p id="795e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">继续在<code class="eh mt mu mv mw b">{date}_snipcart.module.products__create_products_fields.php</code>中定义产品的字段。它们是使用<a class="ae jg" href="https://pyrocms.com/documentation/categories/field-types" rel="noopener ugc nofollow" target="_blank">内置的烟火</a>字段类型定义的。</p><p id="bd82" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们的产品将有SKU，名称，价格，描述，图像和标签:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="83a1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们还必须将它们添加到<code class="eh mt mu mv mw b">{date}_snipcart.module.products__create_products_stream.php</code>中的<code class="eh mt mu mv mw b">$assignments</code>参数中，这样它们就会出现在我们的管理表单中。</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="18db" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以在控制台输入<code class="eh mt mu mv mw b">php artisan addon:install products</code>来安装插件。这足以在CMS管理中添加/编辑产品！</p><blockquote class="ni nj nk"><p id="8896" class="jh ji kf jj b jk jl jm jn jo jp jq jr nl jt ju jv nm jx jy jz nn kb kc kd ke hn dt translated"><em class="hu">如果您以后要对迁移进行更改，您可以使用</em> <code class="eh mt mu mv mw b"><em class="hu">php artisan migrate:refresh --addon=products</em></code> <em class="hu">来刷新它们。</em></p></blockquote><p id="0806" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">但是我们还可以做更多的事情来改善编辑体验。</p><p id="f568" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们在产品列表中添加产品图片。编辑<code class="eh mt mu mv mw b">src/Product/Table/ProductTableBuilder.php</code>中的<code class="eh mt mu mv mw b">$columns</code>:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="ea73" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们可以通过使用字段的名称来显示字段的存储值，或者通过使用<em class="kf">赋值</em>来格式化它。后者计算字符串，并允许我们为字段值调用presenter方法(这里:<code class="eh mt mu mv mw b">currency</code>显示美元符号，<code class="eh mt mu mv mw b">preview</code>显示调整大小的图像)。</p><p id="9c80" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">看起来不错！</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff no"><img src="../Images/c117a9d206d3868e707c5b2edaf75f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*g6S5rJ8c1PiPD6zQ.png"/></div></div></figure><h1 id="fd2b" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">步骤3:在PyroCMS网站上展示产品</h1><p id="ce8c" class="pw-post-body-paragraph jh ji hu jj b jk lx jm jn jo ly jq jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">我们将使用<a class="ae jg" href="https://twig.symfony.com/" rel="noopener ugc nofollow" target="_blank"> Twig </a>的模板引擎添加一个视图，然后用一个控制器和route连接它。创建使用默认布局的产品视图，并在<code class="eh mt mu mv mw b">resources/views/products/index.twig</code>中添加一些引导类:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="fa27" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">接下来是<code class="eh mt mu mv mw b">src/Http/Controller/ProductsController.php</code>中一个非常简单的控制器:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="cde6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于路线，将<code class="eh mt mu mv mw b">products</code>路线添加到<code class="eh mt mu mv mw b">src/ProductsModuleServiceProvider.php</code>中为管理员生成的路线中:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="1d27" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们走吧！如果我们参观<code class="eh mt mu mv mw b">/products</code>看起来不错:</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff no"><img src="../Images/8ac90cd2d0b5bec3561870c5e8715682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wy6Qcf9jSOZqx-kA.png"/></div></div></figure><p id="3b77" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们还需要一个链接到这个页面。通过创建文件<code class="eh mt mu mv mw b">{project root}/resources/{site slug}/addons/pyrocms/starter-theme/views/partials/navigation.twig</code>覆盖导航模板:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="85d6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这里我们复制了原始模板，并简单地添加了:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><h1 id="cbfd" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">步骤4:集成Snipcart和PyroCMS</h1><p id="ed3a" class="pw-post-body-paragraph jh ji hu jj b jk lx jm jn jo ly jq jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">只需几个步骤就可以将这些购买按钮转换成<a class="ae jg" href="https://docs.snipcart.com/configuration/product-definition" rel="noopener ugc nofollow" target="_blank">正确定义的Snipcart产品</a>。</p><p id="a4a3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">首先，我们需要一个地方来存储我们的API密钥。通过创建文件<code class="eh mt mu mv mw b">resources/config/setting.php</code>为模块添加一个设置条目:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="1aef" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">该设置可在<em class="kf">设置模块&gt;模块&gt;产品模块</em>下的管理中访问。</p><p id="802e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们准备覆盖<code class="eh mt mu mv mw b">{project root}/resources/{site slug}/addons/pyrocms/starter-theme/views/partials/scripts.twig</code>中的<code class="eh mt mu mv mw b">scripts</code>模板，以添加<a class="ae jg" href="https://docs.snipcart.com/getting-started/installation" rel="noopener ugc nofollow" target="_blank"> Snipcart所需的文件</a>:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="d233" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">要将Snipcart的物品属性注入购买按钮，修改<code class="eh mt mu mv mw b">ProductPresenter</code>以在<code class="eh mt mu mv mw b">src/Product/ProductPresenter.php</code>中添加一个<code class="eh mt mu mv mw b">buyButton</code>方法:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="0d9b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个文件中有很多内容(尤其是如果您是Pyro新手的话):</p><ol class=""><li id="fb4e" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke mc km kn ko dt translated">在Presenter的构造函数中通过依赖注入接收<code class="eh mt mu mv mw b">HtmlBuilder</code></li><li id="85e8" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke mc km kn ko dt translated">使用我们来自<code class="eh mt mu mv mw b">$this-&gt;object</code>的产品条目</li><li id="4d05" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke mc km kn ko dt translated">使用Pyro的<code class="eh mt mu mv mw b">FilesModule</code>工具构建裁剪图像的URL</li><li id="a673" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke mc km kn ko dt translated">将所有产品数据转移到各自的Snipcart属性</li><li id="09e6" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke mc km kn ko dt translated">最后构建按钮(<code class="eh mt mu mv mw b">&lt;a ...&gt;</code>)元素</li></ol><p id="f19d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们现在可以在<code class="eh mt mu mv mw b">resources/views/products/index.twig</code>中更新我们的产品视图，给演示者打电话:</p><pre class="lt lu lv lw fq my mw mz na aw nb dt"><span id="a386" class="mf kv hu mw b fv nc nd l ne nf">{{ product.buyButton('Buy for '~product.price.currency(), {'class': 'btn btn-primary'})|raw }}</span></pre><p id="9374" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我美味的意大利面酱现在可以买到了！</p><h1 id="a39a" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">步骤5:在结帐时添加自定义验证</h1><p id="8e60" class="pw-post-body-paragraph jh ji hu jj b jk lx jm jn jo ly jq jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">在网上卖食品——或者其他任何东西——经常会遇到各种各样的挑战。例如，冷冻食品不能长途运输。额外的辛辣食物必须附有警告。诸如此类。</p><p id="5cd2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">因此，首先让我们通过使用我们新的<a class="ae jg" href="https://docs.snipcart.com/javascript-api-reference/custom-validation" rel="noopener ugc nofollow" target="_blank">定制验证特性</a>来添加一些虚拟检查。我们将防止顾客点对他们来说太辣的产品:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="0462" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">该代码过滤掉<code class="eh mt mu mv mw b">cart-content</code>页面上的验证事件，并向带有<code class="eh mt mu mv mw b">spicy</code>标签的产品添加一个错误。它进入<code class="eh mt mu mv mw b">resources/js/validation.js</code>，我们给<code class="eh mt mu mv mw b">scripts.twig</code> : <code class="eh mt mu mv mw b">{{ asset_add("scripts.js", "snipcart.module.products::js/validation.js") }}</code>添加另一行。</p><p id="d23c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在去冷冻物品检查和拉勒维尔土地</p><p id="77e5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们之前制作的ProductsController实际上扩展了一个Laravel控制器，添加了一些来自PyroCMS的好东西。当您查看来自PyroCMS的<code class="eh mt mu mv mw b">BaseController</code>的源代码时，您会看到来自<code class="eh mt mu mv mw b">Illuminate</code>名称空间的所有东西都连接到控制器。现在让我们通过直接扩展基本的Laravel控制器并只添加我们需要的东西来创建一个简单的<a class="ae jg" href="https://docs.snipcart.com/webhooks/shipping" rel="noopener ugc nofollow" target="_blank"> shipping webhook </a>。</p><p id="a470" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在<code class="eh mt mu mv mw b">src/Http/Controller/ShippingController.php</code>中创建该控制器:</p><figure class="lt lu lv lw fq iv"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="e180" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">所以<code class="eh mt mu mv mw b">ShippingController</code>只使用来自<code class="eh mt mu mv mw b">Illuminate</code>的类。这是一个普通的老式Laravel控制器，它检查Snipcart的输入数据，并确定我们是否必须返回错误消息或运费。与<code class="eh mt mu mv mw b">ProductsController</code>一样，我们在模块的服务提供者中添加了一个路由:<code class="eh mt mu mv mw b">'webhooks/shipping' =&gt; 'Snipcart\ProductsModule\Http\Controller\ShippingController@webhook',</code>。</p><h1 id="61f9" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">现场演示和GitHub回购</h1><p id="3c59" class="pw-post-body-paragraph jh ji hu jj b jk lx jm jn jo ly jq jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">我们完事了。</p><p id="5aaa" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们在这里讨论了很多东西。但是它应该让您大致了解如何将Snipcart与PyroCMS集成，并使用Laravel的更多常规功能。</p><figure class="lt lu lv lw fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff np"><img src="../Images/326b64634738f7d89d0a365f14e93643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9GEzJSQspSU0iiNp.png"/></div></div></figure><blockquote class="ni nj nk"><p id="d956" class="jh ji kf jj b jk jl jm jn jo jp jq jr nl jt ju jv nm jx jy jz nn kb kc kd ke hn dt translated"><a class="ae jg" href="https://github.com/snipcart/snipcart-pyrocms-demo" rel="noopener ugc nofollow" target="_blank"> <em class="hu">参见GitHub上的开源回购</em> </a> <em class="hu">。</em></p><p id="1126" class="jh ji kf jj b jk jl jm jn jo jp jq jr nl jt ju jv nm jx jy jz nn kb kc kd ke hn dt translated"><a class="ae jg" href="http://snipcart-pyrocms-demo.herokuapp.com/products" rel="noopener ugc nofollow" target="_blank"> <em class="hu">看现场演示这里</em> </a> <em class="hu">！</em></p></blockquote><h1 id="61d8" class="ku kv hu bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">结束语</h1><p id="826e" class="pw-post-body-paragraph jh ji hu jj b jk lx jm jn jo ly jq jr js lz ju jv jw ma jy jz ka mb kc kd ke hn dt translated">这个项目和管理界面在不到3个小时的时间内就运行了，我之前没有任何使用Pyro的经验。整个过程花了两天时间。主要是因为我真的想通过从模块中注入我们的脚本标签来集成Snipcart，而不是编辑主题模板。</p><p id="c4a7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我有一个爆炸建设这个tuts的管理。我不认为这个过程可以变得更容易，所以称赞Pyro！</p><p id="75b4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">由于不太了解Laravel，我很难区分PyroCMS的结束和Laravel的开始。您必须熟悉PyroCMS的源代码，以描绘出如何完成那些仅通过查看文档不容易理解的事情的方法。</p><p id="4d0d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果我有更多的时间花在这个演示上，我会探索管理员的许多内容管理功能。很多可以直接从管理完成，没有太多的代码。一个很酷的测试是将产品分配给特别标记的博客帖子！</p></div><div class="ab cl nq nr hc ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="hn ho hp hq hr"><p id="61e3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="kf">本帖最初发表在</em> <a class="ae jg" href="https://snipcart.com/blog/laravel-ecommerce-tutorial-pyrocms-demo" rel="noopener ugc nofollow" target="_blank"> <em class="kf"> Snipcart博客</em> </a> <em class="kf">和</em> <a class="ae jg" href="https://us5.list-manage.com/subscribe?u=c019ca88eb8179b7ffc41b12c&amp;id=3e16e05ea2" rel="noopener ugc nofollow" target="_blank"> <em class="kf">本报快讯</em> </a> <em class="kf">。</em></p></div></div>    
</body>
</html>