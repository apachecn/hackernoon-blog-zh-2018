<html>
<head>
<title>LibSubmarine: Temporarily hide transactions on ethereum (cheaply!)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">LibSubmarine:暂时隐藏以太坊上的交易(便宜！)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/libsubmarine-temporarily-hide-transactions-on-ethereum-cheaply-6910191f46f2?source=collection_archive---------10-----------------------#2018-08-28">https://medium.com/hackernoon/libsubmarine-temporarily-hide-transactions-on-ethereum-cheaply-6910191f46f2?source=collection_archive---------10-----------------------#2018-08-28</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/d4a9a82672d7396724875f5ad84fbe8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swdhIDMSjoLTLHErtChZcw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek"><a class="ae jg" href="https://github.com/lorenzb/libsubmarine/" rel="noopener ugc nofollow" target="_blank">github.com/lorenzb/libsubmarine</a></figcaption></figure><h1 id="8ef1" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">隐私的状态</h1><p id="f721" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">隐私是区块链的一大挑战，尤其是以太坊。有无数的用例需要私下交易的能力，以避免向可能对所披露的信息采取行动的其他方发出信号。</p><p id="9497" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">一个显著的例子是连锁投票。如果在投票期结束前可以公开计票，新选民就可以利用这些信息来影响他们的投票。</p><p id="d1d4" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">这个问题的一个优雅的解决方案叫做<a class="ae jg" href="https://github.com/ConsenSys/PLCRVoting" rel="noopener ugc nofollow" target="_blank">加权提交-显示投票</a>，它允许参与者隐藏他们的投票直到投票期结束。这是伟大的，因为这意味着用户可以可信地承诺链上的秘密数据，这只是在稍后的日期透露。但是，投票的参与地址和权重在投票期结束前是公开的。</p><p id="b638" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">那么，如果参与者希望在投票期结束之前完全隐藏他们的参与，该怎么办呢？</p><p id="719b" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">这就是潜艇部队发挥作用的地方。</p><h1 id="344f" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">隐藏交易=海底发送</h1><p id="fad9" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">常规的提交-揭示方案仅限于隐藏以太坊交易中包含的数据。<a class="ae jg" href="http://hackingdistributed.com/2017/08/28/submarine-sends/" rel="noopener ugc nofollow" target="_blank">潜艇发送</a>允许用户隐藏整个交易，直到它在后面的块中被揭露。也就是说，可以隐藏发送者、接收者、值和数据。这里有几个用例。</p><h2 id="0848" class="li ji hu bd jj lj lk ll jn lm ln lo jr kq lp lq jv ku lr ls jz ky lt lu kd lv dt translated">密封投标拍卖</h2><p id="4cc4" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">在密封投标拍卖中，必须能够在不公开披露的情况下可信地承诺价格。如果出价是在ETH中，用正常的提交/披露来隐藏价格是不可能的。</p><h2 id="384b" class="li ji hu bd jj lj lk ll jn lm ln lo jr kq lp lq jv ku lr ls jz ky lt lu kd lv dt translated">超前保护</h2><p id="4ad7" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">任何DEX都容易受到<a class="ae jg" href="https://hackernoon.com/front-running-bancor-in-150-lines-of-python-with-ethereum-api-d5e2bfd0d798" rel="noopener ugc nofollow" target="_blank">抢先</a>的影响，因为矿工可以观察内存池中的事务，并在块中的事务之前下单。</p><h2 id="80d5" class="li ji hu bd jj lj lk ll jn lm ln lo jr kq lp lq jv ku lr ls jz ky lt lu kd lv dt translated">链上投票</h2><p id="fde6" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">如前所述，常规提交/展示不能隐藏投票的参与或价值。</p><h1 id="085a" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">潜艇如何发送工作</h1><p id="ec9c" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">实施海底发送的一个主要挑战是气体消耗和UX。<a class="ae jg" href="https://twitter.com/ethlorenz" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hv"> @ </strong> ethlorenz </a>提出了一个优雅的解决方案，既节省了气体，又最大限度地减少了用户生成的事务数量。该解决方案需要4个帐户的交互:一个用户(Alice)、一个隐藏地址(sub潜艇)、一个dApp和一个挑战者。Alice根据实现执行3或4个事务。</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lw"><img src="../Images/55f491a6a943c47a81b370763b35b2c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w8lRsQzImlO11bTfnQeREQ.png"/></div></div></figure><h2 id="b5a2" class="li ji hu bd jj lj lk ll jn lm ln lo jr kq lp lq jv ku lr ls jz ky lt lu kd lv dt translated">过程</h2><ol class=""><li id="269d" class="mb mc hu kh b ki kj km kn kq md ku me ky mf lc mg mh mi mj dt translated">Alice将值和数据提交到一个隐藏的海底地址。</li><li id="c457" class="mb mc hu kh b ki mk km ml kq mm ku mn ky mo lc mg mh mi mj dt translated">Alice在至少一个块之后向dApp揭示值和数据。</li><li id="327a" class="mb mc hu kh b ki mk km ml kq mm ku mn ky mo lc mg mh mi mj dt translated">Alice广播原始签名解锁事务，其中sub潜艇地址将值发送到dApp。</li><li id="08e9" class="mb mc hu kh b ki mk km ml kq mm ku mn ky mo lc mg mh mi mj dt translated">dApp通过检索值和数据来完成流程。</li></ol><h2 id="203b" class="li ji hu bd jj lj lk ll jn lm ln lo jr kq lp lq jv ku lr ls jz ky lt lu kd lv dt translated">安全</h2><p id="8245" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">在这个系统中，Alice有机会通过透露与她之前所犯下的不同的值和数据来进行恶意行为。这种行为可以通过要求Alice提交押金并要求在解锁和完成交易之间有一个质询期来防止，在该质询期内，质询者可以证明Alice在欺骗并要求她的押金。</p><h2 id="f383" class="li ji hu bd jj lj lk ll jn lm ln lo jr kq lp lq jv ku lr ls jz ky lt lu kd lv dt translated">气体</h2><p id="e408" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">用于用户生成交易的气体总量约为20.7万气体，而挑战量约为27万气体。</p><h1 id="3782" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">lib潜艇内部构件</h1><p id="fe0a" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">我们构建了<a class="ae jg" href="https://github.com/lorenzb/libsubmarine/" rel="noopener ugc nofollow" target="_blank">lib subscribe</a>作为Submarine Sends方案的模块化和可重用的实现。该架构包括一个用于生成和执行提交-揭示方案的库，以及一个名为<a class="ae jg" href="https://github.com/lorenzb/proveth" rel="noopener ugc nofollow" target="_blank"> ProvEth </a>的独立库，用于生成和验证挑战者使用的Merkle-Patricia证明。</p><figure class="lx ly lz ma fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff mp"><img src="../Images/ad147da9babaab234be34d28c06d3f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zlK4WIFMs6QnRv0o73yAag.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek"><a class="ae jg" href="https://github.com/lorenzb/libsubmarine" rel="noopener ugc nofollow" target="_blank">LibSubmarine</a> and <a class="ae jg" href="https://github.com/lorenzb/proveth" rel="noopener ugc nofollow" target="_blank">Proveth</a> libraries</figcaption></figure><h2 id="2935" class="li ji hu bd jj lj lk ll jn lm ln lo jr kq lp lq jv ku lr ls jz ky lt lu kd lv dt translated">libsub潜艇</h2><p id="a5c6" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">首先，链外过程包括生成伪签名，该伪签名可用于“欺骗”以太坊链接受来自我们没有私钥的地址的一次性交易。</p><p id="0521" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">这是可能的，因为发送交易的地址实际上没有在原始广播以太坊交易中定义。相反,“发件人”地址由以太坊客户端根据交易附带的<a class="ae jg" href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" rel="noopener ugc nofollow" target="_blank"> ECDSA </a> <a class="ae jg" href="https://en.bitcoin.it/wiki/Secp256k1" rel="noopener ugc nofollow" target="_blank"> Secp256k1 </a>签名动态计算。</p><p id="c69a" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">由于ECDSA的工作方式，可以将任意数据作为交易签名进行传递，并调用<code class="eh mq mr ms mt b">ecrecover(Txdata)</code>来获得与交易的以太坊“From”地址相对应的ECDSA公钥。</p><p id="9f4b" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">这个构造的事务成为解锁事务，一旦用户完成显示步骤，就可以执行该解锁事务。</p><p id="40ff" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">一旦离线程序完成，用户就进入上一节概述的四个步骤。提交、展示、解锁和最终确定。更多细节可以在我们的<a class="ae jg" href="https://github.com/lorenzb/libsubmarine" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中找到。</p><h2 id="1c15" class="li ji hu bd jj lj lk ll jn lm ln lo jr kq lp lq jv ku lr ls jz ky lt lu kd lv dt translated">ProvEth</h2><p id="104e" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">这个库使用以太坊块的事务trie创建<a class="ae jg" href="https://github.com/ethereum/wiki/wiki/Patricia-Tree" rel="noopener ugc nofollow" target="_blank"> merkle-patricia </a>离线证明，并使用智能契约验证在线证明。</p><p id="3e17" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">这个证据是一个挑战者提交的，可信地声称爱丽丝是恶意行为，并削减她的存款。</p><p id="a72e" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">这个库是从<a class="ae jg" href="https://github.com/KyberNetwork/peace-relay" rel="noopener ugc nofollow" target="_blank">和平接力</a>中重新打包的，可以用作在chain上执行merkle-patricia证明验证的工具。</p><h1 id="de5e" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">包起来。</h1><p id="b63c" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">看看我们的<a class="ae jg" href="https://github.com/lorenzb/libsubmarine" rel="noopener ugc nofollow" target="_blank"> Github </a>。我们希望在改善图书馆方面得到一些帮助。否则，你可以在推特上鼓励我们把这个消息传出去！👌</p><p id="8f85" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">如果你对技术的好奇心仍然强烈——睁大你的眼睛！我们将会发布更多的文章详细介绍代码。</p><p id="8984" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">这是一个由社区提供的工具，供使用麻省理工学院许可证的社区使用。💯</p><p id="b278" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">发现这一方案的所有功劳都归于IC3团队和他们的<a class="ae jg" href="http://hackingdistributed.com/2017/08/28/submarine-sends/" rel="noopener ugc nofollow" target="_blank">潜艇发送的文章</a>和<a class="ae jg" href="https://twitter.com/ethlorenz" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hv"> @ </strong> ethlorenz </a>找到了一个成本有效的实施方案。</p><p id="db09" class="pw-post-body-paragraph kf kg hu kh b ki ld kk kl km le ko kp kq lf ks kt ku lg kw kx ky lh la lb lc hn dt translated">感谢<a class="ae jg" href="https://twitter.com/relyt29" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hv"> @ </strong> relyt29 </a>、<a class="ae jg" href="https://twitter.com/sbetamc" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hv"> @ </strong> sbetamc </a>和<a class="ae jg" href="https://twitter.com/ethlorenz" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hv"> @ </strong> ethlorenz </a>这些糟糕的开发者帮助审阅这篇文章！</p><figure class="lx ly lz ma fq iv"><div class="bz el l di"><div class="mu mv l"/></div></figure></div></div>    
</body>
</html>