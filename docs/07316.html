<html>
<head>
<title>Detect Cryptocurrency Market Trends Using PHP: Exponential Moving Averages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PHP检测加密货币市场趋势:指数移动平均线</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/detect-cryptocurrency-market-trends-using-php-exponential-moving-averages-d5134d56f484?source=collection_archive---------14-----------------------#2018-08-29">https://medium.com/hackernoon/detect-cryptocurrency-market-trends-using-php-exponential-moving-averages-d5134d56f484?source=collection_archive---------14-----------------------#2018-08-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="3af1" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">我们将使用PHP计算8天和21天的指数移动平均线，以确定比特币的看涨/看跌交叉。</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/b760d534dba3f0345c0fe8008f8787ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzNqr8nP183AZVQc0MlXrQ.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Photo by <a class="ae jz" href="https://www.shutterstock.com/g/nokwan007" rel="noopener ugc nofollow" target="_blank">Nokwan007</a> on Shutterstock.com</figcaption></figure><h1 id="1a4c" class="ka kb hu bd kc kd ke kf kg kh ki kj kk ja kl jb km jd kn je ko jg kp jh kq kr dt translated">什么是均线？</h1><p id="c4b2" class="pw-post-body-paragraph ks kt hu ku b kv kw iv kx ky kz iy la lb lc ld le lf lg lh li lj lk ll lm ln hn dt translated">移动平均线可以让你看到一个金融工具在一段时间内的价格变化。它在技术分析中被广泛使用，被称为“滞后”指标，因为它是基于历史价格的。</p><p id="c92f" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">两种常用的均线是简单移动平均线(SMA)和指数移动平均线(EMA)。SMA是证券在特定时期的简单平均值。均线与此类似，但是更重视最近的价格。</p><h1 id="880b" class="ka kb hu bd kc kd ke kf kg kh ki kj kk ja kl jb km jd kn je ko jg kp jh kq kr dt translated">SMA和EMA的示例</h1><p id="4825" class="pw-post-body-paragraph ks kt hu ku b kv kw iv kx ky kz iy la lb lc ld le lf lg lh li lj lk ll lm ln hn dt translated">理解SMA和EMA最简单的方法是看一个例子。</p><p id="85c2" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">我们将虚拟证券在过去15天的收盘价计算如下:</p><p id="5138" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">第一周 : 10、12、15、11、18</p><p id="17c3" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated"><strong class="ku hv">第二周</strong> : 21、17、15、10、7</p><p id="21fb" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated"><strong class="ku hv">第三周</strong> : 8、9、15、17、20</p><p id="a235" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">在这个例子中，10天均线是前10天的平均收盘价。第二天的SMA将是前10天，将第一天从列表中删除。诸如此类。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff lt"><img src="../Images/1f6d6f42cb2adaa18d040cf7849f0ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p_ge9IjG4kTCT8Bp7qa2Dg.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Table illustrating SMA and EMA values</figcaption></figure><p id="7209" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">EMA的参与程度略高。它包括计算加权乘数，然后用价格、加权值和前一天的均线来确定均线。</p><p id="ff25" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">幸运的是，您不需要担心所涉及的底层算术。PHP有一个名为Trader的库，用来处理技术分析计算。</p><h1 id="e9e4" class="ka kb hu bd kc kd ke kf kg kh ki kj kk ja kl jb km jd kn je ko jg kp jh kq kr dt translated">8日和21日均线</h1><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff lu"><img src="../Images/35f1b454b429c542df6e17e6afd13e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iH6h7uKjaTsip81cX5b9ZA.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">8-day and 21-day EMA on the BTCUSD chart on TradingView</figcaption></figure><p id="d6d5" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">8日和21日EMA是股票市场和加密货币市场中非常流行的短期指标。</p><p id="3a7d" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">主要信号是:</p><ul class=""><li id="4e83" class="lv lw hu ku b kv lo ky lp lb lx lf ly lj lz ln ma mb mc md dt translated">当8日线穿越21日线上方时。这表明多头交叉，价格可能会上涨(买入信号)。</li><li id="71f8" class="lv lw hu ku b kv me ky mf lb mg lf mh lj mi ln ma mb mc md dt translated">当8日线穿越21日线下方时。这表明一个熊市交叉，价格可能会下降(卖出信号)。</li></ul><p id="7069" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">看上面的图表，我已经标出了8天(蓝色)和21天(红色)的交叉点，这就是趋势。</p><h1 id="69a2" class="ka kb hu bd kc kd ke kf kg kh ki kj kk ja kl jb km jd kn je ko jg kp jh kq kr dt translated">提醒一句</h1><p id="6ae3" class="pw-post-body-paragraph ks kt hu ku b kv kw iv kx ky kz iy la lb lc ld le lf lg lh li lj lk ll lm ln hn dt translated">我不是财务顾问，本文中的任何内容都不应被理解为财务建议。加密市场是高度不稳定的，你应该在做任何投资之前做自己的彻底研究。</p><p id="113c" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">同样需要注意的是，技术分析并不完美。因为市场是由心理驱动的，一些信号可能会完全消失。这就是为什么同时利用各种指标(如RSI和成交量)很重要。然后你会寻找汇合点，也就是几个指标都显示出相似的趋势。即使这样，你也不能百分百确定。</p><p id="8336" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated"><strong class="ku hv">技术分析不是银弹。</strong></p><h1 id="71df" class="ka kb hu bd kc kd ke kf kg kh ki kj kk ja kl jb km jd kn je ko jg kp jh kq kr dt translated">准备好您的PHP环境</h1><p id="7758" class="pw-post-body-paragraph ks kt hu ku b kv kw iv kx ky kz iy la lb lc ld le lf lg lh li lj lk ll lm ln hn dt translated">我们将使用PHP <a class="ae jz" href="http://php.net/manual/en/book.trader.php" rel="noopener ugc nofollow" target="_blank">交易者扩展</a>来计算均线。您可以通过检查<code class="eh mj mk ml mm b">phpinfo()</code>的结果来确认它已安装:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mn"><img src="../Images/87e1938798e29dca83c16f854acf3819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MMBNAKjR1VaoAi17um6REA.png"/></div></div></figure><p id="39cf" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">历史价格数据可通过优秀的<a class="ae jz" href="https://min-api.cryptocompare.com/" rel="noopener ugc nofollow" target="_blank"> CryptoCompare API </a>获得。我们将使用他们的历史数据API。以下请求将显示过去60天BTC的美元价格:</p><p id="6eb6" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated"><a class="ae jz" href="https://min-api.cryptocompare.com/data/histoday?fsym=BTC&amp;tsym=USD&amp;limit=60" rel="noopener ugc nofollow" target="_blank">https://min-api.cryptocompare.com/data/histoday?fsym=BTC&amp;tsym = USD&amp;limit = 60</a></p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mo"><img src="../Images/d0bc15d4f506c610601a7102d8b1baf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*NtRQZoCRXQ-bU4WdsMCMJg.png"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">JSON extract from CryptoCompare</figcaption></figure><p id="47b1" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">它将关闭时间视为12:00 GMT，<code class="eh mj mk ml mm b">time</code>字段返回Unix时间戳(纪元时间)。</p><h1 id="b70e" class="ka kb hu bd kc kd ke kf kg kh ki kj kk ja kl jb km jd kn je ko jg kp jh kq kr dt translated">确定EMA</h1><p id="b865" class="pw-post-body-paragraph ks kt hu ku b kv kw iv kx ky kz iy la lb lc ld le lf lg lh li lj lk ll lm ln hn dt translated">添加以下代码以从CryptoCompare API读取响应:</p><pre class="jk jl jm jn fq mp mm mq mr aw ms dt"><span id="d096" class="mt kb hu mm b fv mu mv l mw mx">&lt;?php</span><span id="5da3" class="mt kb hu mm b fv my mv l mw mx">$response = json_decode(file_get_contents('https://min-api.cryptocompare.com/data/histoday?fsym=BTC&amp;tsym=USD&amp;limit=60'));</span></pre><p id="7569" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">如果您执行<code class="eh mj mk ml mm b">print_r($response)</code>，将会返回如下响应:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mz"><img src="../Images/8205615c273c976d72bfb75808cb1213.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*bq1Da2zPaG0pOxrFP7GD3g.png"/></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Decode the JSON response into a PHP object</figcaption></figure><p id="a714" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">接下来，我们将收盘价添加到一个数组中:</p><pre class="jk jl jm jn fq mp mm mq mr aw ms dt"><span id="ce33" class="mt kb hu mm b fv mu mv l mw mx">$prices = [];</span><span id="15e9" class="mt kb hu mm b fv my mv l mw mx">foreach ($response-&gt;Data as $v) {<br/>    $prices[] = $v-&gt;close;<br/>}</span></pre><p id="f4db" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">保存这些价格后，我们现在可以使用<a class="ae jz" href="http://php.net/manual/en/function.trader-ema.php" rel="noopener ugc nofollow" target="_blank"> trader_ema() </a> PHP函数来确定8天和21天的ema:</p><pre class="jk jl jm jn fq mp mm mq mr aw ms dt"><span id="f7e7" class="mt kb hu mm b fv mu mv l mw mx">$ema8 = trader_ema($prices, 8);<br/>$ema21 = trader_ema($prices, 21);</span></pre><p id="af73" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">提醒一下:默认情况下，Trader扩展使用3位小数的精度。要使用satoshi或显示几个小数的硬币，如XRP和XLM，您可以在运行时设定精度:</p><pre class="jk jl jm jn fq mp mm mq mr aw ms dt"><span id="9be5" class="mt kb hu mm b fv mu mv l mw mx">ini_set('trader.real_precision', '8');</span></pre><p id="0fd3" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">或者在<strong class="ku hv"> php.ini </strong>文件中:</p><pre class="jk jl jm jn fq mp mm mq mr aw ms dt"><span id="f442" class="mt kb hu mm b fv mu mv l mw mx">trader.real_precision=8</span></pre><p id="045f" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">现在我们有了EMA的数组，我们将获取每组的最后两个来设置前一天的EMA和当前的EMA:</p><pre class="jk jl jm jn fq mp mm mq mr aw ms dt"><span id="3887" class="mt kb hu mm b fv mu mv l mw mx">$current_8 = array_pop($ema8);<br/>$current_21 = array_pop($ema21);<br/>$previous_8 = array_pop($ema8);<br/>$previous_21 = array_pop($ema21);</span></pre><p id="b794" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">我们现在可以简单地检查是否发生了交叉，并做出相应的反应:</p><pre class="jk jl jm jn fq mp mm mq mr aw ms dt"><span id="5b3f" class="mt kb hu mm b fv mu mv l mw mx">if ($current_8 &gt; $current_21 &amp;&amp; $previous_8 &lt; $previous_21) {<br/>    echo 'Buy';<br/>} elseif ($current_8 &lt; $current_21 &amp;&amp; $previous_8 &gt; $previous_21) {<br/>    echo 'Sell';<br/>} else {<br/>    echo 'Do Nothing';<br/>}</span></pre><p id="2ced" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">这是完整的最终源代码，带有一些输出:</p><pre class="jk jl jm jn fq mp mm mq mr aw ms dt"><span id="c74b" class="mt kb hu mm b fv mu mv l mw mx">&lt;?php</span><span id="d322" class="mt kb hu mm b fv my mv l mw mx">ini_set(‘trader.real_precision’, ‘8’);</span><span id="0d41" class="mt kb hu mm b fv my mv l mw mx">$response = json_decode(file_get_contents(‘<a class="ae jz" href="https://min-api.cryptocompare.com/data/histoday?fsym=BTC&amp;tsym=USD&amp;limit=60'" rel="noopener ugc nofollow" target="_blank">https://min-api.cryptocompare.com/data/histoday?fsym=BTC&amp;tsym=USD&amp;limit=60'</a>));</span><span id="2a1b" class="mt kb hu mm b fv my mv l mw mx">$prices = [];</span><span id="dc67" class="mt kb hu mm b fv my mv l mw mx">foreach ($response-&gt;Data as $k =&gt; $v) {<br/>    $prices[] = $v-&gt;close;<br/>}</span><span id="44fc" class="mt kb hu mm b fv my mv l mw mx">$ema8 = trader_ema($prices, 8);<br/>$ema21 = trader_ema($prices, 21);</span><span id="d29f" class="mt kb hu mm b fv my mv l mw mx">$current_8 = array_pop($ema8);<br/>$current_21 = array_pop($ema21);<br/>$previous_8 = array_pop($ema8);<br/>$previous_21 = array_pop($ema21);</span><span id="429a" class="mt kb hu mm b fv my mv l mw mx">echo ‘Current 8-day: ‘ . $current_8 . “\n”;<br/>echo ‘Current 21-day: ‘ . $current_21 . “\n”;<br/>echo ‘Previous 8-day: ‘ . $previous_8 . “\n”;<br/>echo ‘Previous 21-day: ‘ . $previous_21 . “\n”;</span><span id="18a3" class="mt kb hu mm b fv my mv l mw mx">if ($current_8 &gt; $current_21 &amp;&amp; $previous_8 &lt; $previous_21) {<br/>    echo ‘Buy’;<br/>} elseif ($current_8 &lt; $current_21 &amp;&amp; $previous_8 &gt; $previous_21) {<br/>    echo ‘Sell’;<br/>} else {<br/>    echo ‘Do Nothing’;<br/>}</span></pre><h1 id="0084" class="ka kb hu bd kc kd ke kf kg kh ki kj kk ja kl jb km jd kn je ko jg kp jh kq kr dt translated">真实世界使用</h1><p id="4605" class="pw-post-body-paragraph ks kt hu ku b kv kw iv kx ky kz iy la lb lc ld le lf lg lh li lj lk ll lm ln hn dt translated">这方面的一个简单的现实应用是将它集成到一个交易机器人中。您可以使用服务器上的cron将它设置为每天运行。在最新收盘价后运行它，检测是否有交叉。</p><p id="b78d" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">如果你的机器人发现了某些趋势，你可以与币安这样的交易所整合，通过他们的API执行交易。如前所述，尝试从至少三个不同的指标中寻找确认，以最小化你的风险。</p><p id="ee71" class="pw-post-body-paragraph ks kt hu ku b kv lo iv kx ky lp iy la lb lq ld le lf lr lh li lj ls ll lm ln hn dt translated">在接下来的文章中，我们将关注更多指标，以及它们如何用于确定加密货币市场趋势。</p><h1 id="ac4c" class="ka kb hu bd kc kd ke kf kg kh ki kj kk ja kl jb km jd kn je ko jg kp jh kq kr dt translated">升级你的网站开发技能！</h1><p id="ab8c" class="pw-post-body-paragraph ks kt hu ku b kv kw iv kx ky kz iy la lb lc ld le lf lg lh li lj lk ll lm ln hn dt translated"><a class="ae jz" href="https://webdev.chowles.com/" rel="noopener ugc nofollow" target="_blank">注册我的时事通讯</a>，在那里我将分享有见地的网络开发和区块链相关的文章，以增强你的技能。</p></div></div>    
</body>
</html>