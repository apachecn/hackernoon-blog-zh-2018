<html>
<head>
<title>Finding The Most Important Sentences Using NLP &amp; TF-IDF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NLP &amp; TF-IDF查找最重要的句子</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/finding-the-most-important-sentences-using-nlp-tf-idf-3065028897a3?source=collection_archive---------4-----------------------#2018-09-05">https://medium.com/hackernoon/finding-the-most-important-sentences-using-nlp-tf-idf-3065028897a3?source=collection_archive---------4-----------------------#2018-09-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/b978013a7e723cf9250b4b5e0f99eca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LlTvixBX8cxihWACjXoP7g.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/photos/yEAOfWSdzgM?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Pankaj Patel</a> on <a class="ae jg" href="https://unsplash.com/search/photos/coding?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8753" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们将使用词频—逆文档频率(TF-IDF)来查找BBC新闻文章中最重要的句子。然后我们将把这个算法实现到一个快速简单的Firefox扩展中。</p><p id="a76f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">单击此处查看本文的更新版本:</p><div class="kf kg fm fo kh ki"><a href="https://skerritt.blog/tfidf/" rel="noopener  ugc nofollow" target="_blank"><div class="kj ab ej"><div class="kk ab kl cl cj km"><h2 class="bd hv fv z el kn eo ep ko er et ht dt translated">使用NLP &amp; TF-IDF查找最重要的句子</h2><div class="kp l"><h3 class="bd b fv z el kn eo ep ko er et ek translated">我们将创建BBC新闻文章的摘要，并使用Firefox扩展将它们放在顶部。这篇文章…</h3></div><div class="kq l"><p class="bd b gc z el kn eo ep ko er et ek translated">skerritt.blog</p></div></div><div class="kr l"><div class="ks l kt ku kv kr kw ja ki"/></div></div></a></div></div><div class="ab cl kx ky hc kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hn ho hp hq hr"><p id="5547" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt le translated">我们将创建BBC新闻文章的摘要，并使用Firefox扩展将它们放在顶部。本文是关于正则算法词频-逆文档频(TF-IDF)的。我们将以Firefox扩展的形式创建一个真实世界的用法。我知道你在想什么。“TF-IDF？裂开😴“不过萧然跟我在一起，倒是挺有意思的！</p><p id="87f6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">当我们完成时，它会看起来像这样:</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div class="fe ff ln"><img src="../Images/6df702c380b1948105dbee0d6d3cb632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*b01QNPpkOMWG1g-GLuab4Q.png"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">News article found <a class="ae jg" href="https://www.bbc.co.uk/news/business-45289432" rel="noopener ugc nofollow" target="_blank">here</a>. Red box highlights the most important sentences. The red box is not in the final product, is only used for illustration purposes.</figcaption></figure></div><div class="ab cl kx ky hc kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hn ho hp hq hr"><h1 id="d201" class="ls lt hu bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp dt translated">术语频率*逆文档频率</h1><p id="ec59" class="pw-post-body-paragraph jh ji hu jj b jk mq jm jn jo mr jq jr js ms ju jv jw mt jy jz ka mu kc kd ke hn dt translated">别担心，算法的名字让我每次听到它大声说出来都会睡着。这个算法是两个算法相乘。让我们看看这两者是如何工作的:</p><h2 id="231d" class="mv lt hu bd lu mw mx my ly mz na nb mc js nc nd mg jw ne nf mk ka ng nh mo ni dt translated">检索词频率</h2><p id="1b48" class="pw-post-body-paragraph jh ji hu jj b jk mq jm jn jo mr jq jr js ms ju jv jw mt jy jz ka mu kc kd ke hn dt translated">词频(TF)是一个词在文档中出现的频率，除以有多少个词。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div class="fe ff nj"><img src="../Images/ccec739969b35f1cd5db02765fd17be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*F4O-l5YkFEMU4WJQZOoBQw.png"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">The Term Frequency (TF) of a term, t, and a document, d.</figcaption></figure><p id="09b6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">假设你正在阅读一篇关于英国退出欧盟的新闻。“英国退出欧盟”这个词会出现很多，所以“英国退出欧盟”这个词的出现频率很高。</p><p id="8d5c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">很多时候，我们希望在术语旁边建立一个术语频率字典(hashmap)。比如<em class="nk"> {word:那个词的词频} </em>然后迭代这个字典，找出哪个词出现的次数最多。</p><p id="d9b4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在，如果我告诉你，术语频率字典看起来有点像这样:</p><pre class="lo lp lq lr fq nl nm nn no aw np dt"><span id="6e47" class="mv lt hu nm b fv nq nr l ns nt">{"and": 0.87, "the": 0.73}</span></pre><p id="5b66" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">你可以看到这些普通的英语单词对我们没有用。当然，大多数英语课本中都有这些单词，但是我们称这些英语单词为<em class="nk">停用词</em>。停用词通常指一种语言中最常见的词，尽管没有单一的定义。你必须根据用法选择停用词。你必须决定用什么词。在处理一些文本之前，您通常希望删除停用词，以便更好地处理文本。</p><p id="30f2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">有大写字母的单词和没有大写字母的单词是不同的。在编程中，“非洲”和“非洲”是两回事。因此，我们希望将所有内容都转换成小写或大写，以便更好地处理我们的文本。我们要把所有的单词都变成小写。</p><p id="16d2" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">给定一个字符串，我们想删除停用词并将其转换成小写。我们的扩展将给我们一个BBC新闻文章的所有文本的字符串。先不要担心我们从哪里得到文本，这将在稍后的Firefox扩展部分完成。现在，假设我们有这样的文本:</p><pre class="lo lp lq lr fq nl nm nn no aw np dt"><span id="7ecb" class="mv lt hu nm b fv nq nr l ns nt">... These are external links and will open in a new windowA neat feature of many modern laptops is the ability to power them up through the USB port. Unlike the rectangular USB ports of old, the newer type - USB-C - can carry enough power to charge your <br/>machine.That’s great news: it means ...</span></pre><p id="bb95" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为了防止读者睡着，上面的文字被缩短了。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="ee1f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这是将“美化”我们的文档的功能。第3行是我在<a class="ae jg" href="https://stackoverflow.com/questions/5631422/stop-word-removal-in-javascript" rel="noopener ugc nofollow" target="_blank"> StackOverflow </a>上找到的一组停用词。我添加了“<em class="nk">共享</em>和“<em class="nk">链接这些</em>”，因为这些是我们不想要的新闻文章中的常用词。</p><p id="3e1f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">第5行是<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" rel="noopener ugc nofollow" target="_blank">正则表达式</a>。方括号表示或。[,.]表示<em class="nk">“在逗号或句号处激活”</em>。/g表示全局。一旦你找到一个<em class="nk">、</em>或<em class="nk">。”</em>不要停，继续搜索字符串。空字符串就是我们要替换的。如果我们发现一个句号或一个逗号，不用任何东西代替它——删除它。这是因为“非洲”这个词。如果没有这个，“非洲”会被归类为两个不同的词。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nw"><img src="../Images/fa3e13f38c2ed23f9c8f2a672ff58c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tBAPevEG7SV1GQMXA8OQWg.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">From my Instagram, <a class="ae jg" href="https://www.instagram.com/brandon.codes/" rel="noopener ugc nofollow" target="_blank">@Brandon.codes</a></figcaption></figure><p id="18a3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">第4行将文档分割成单独的单词。<em class="nk"> map </em>函数将函数应用于数组中的每个元素。一旦字符串被分割成单词数组，我们就对每个元素应用<em class="nk"> toLowerCase() </em>方法。它让每个单词都变成小写。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nx"><img src="../Images/9e04c4acbeacb2a1d140641e5a5c92ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8aM6hM6ewnoY4j-dwC2cWw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">From my Instagram, <a class="ae jg" href="https://www.instagram.com/brandon.codes/" rel="noopener ugc nofollow" target="_blank">@Brandon.codes</a>. The arrows are <a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" rel="noopener ugc nofollow" target="_blank">Arrow Functions</a> (Lambda / Anonymous functions).</figcaption></figure><p id="edb7" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">一旦我们过滤掉停用的单词，我们就返回小写的单词。<em class="nk"> Filter() </em>创建一个新数组，其中只包含函数返回True的元素。如果一个单词是一个停用词，它将得到True，这意味着我们将得到一个新的仅包含文档中停用词的<strong class="jj hv">数组。我们使用否定运算符“！”得到相反的结果，这正是我们想要的。返回没有停用词的单词列表。</strong></p><p id="b37e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在我们要计算每个单词在文档中出现的次数。这对术语频率和反向文档频率都很有用。首先，我们希望从一个单词数组中获取所有唯一的单词。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="7b13" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们将数组转换成集合，因为集合没有重复。这让我们只能得到数组中唯一的字。集合也没有顺序，所以我们不能使用数组索引来访问元素。我们需要把它直接转换回数组。关于集合论的更多内容，请看我写的这篇文章。</p><p id="68d3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">好了，现在来数一个单词在单词数组中出现了多少次。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="6a48" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个函数遍历每一个唯一的单词，并计算这个单词在单词数组中出现的次数。频率函数这个词挺长的，我就分解一下。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="fb22" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">第6行将文档分成句子。有时句子前面有空格。“布兰登。狗。”在“狗”之前有空格我们将<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim" rel="noopener ugc nofollow" target="_blank"> trim() </a>方法应用于每一项，以消除这些尾随的空白。</p><p id="1e83" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">关于第7行，第一个单词的前146个字符是社交媒体链接。这个词的其余部分是标题或副标题。这里，看:</p><pre class="lo lp lq lr fq nl nm nn no aw np dt"><span id="b472" class="mv lt hu nm b fv nq nr l ns nt">Share this withEmailFacebookMessengerMessengerTwitterPinterestWhatsAppLinkedInCopy this linkThese are external links and will open in a new window<strong class="nm hv">Ryanair is tightening the rules on what passengers pay to take luggage onto the plane, in order to "speed up boarding".</strong></span></pre><p id="4bb0" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这很烦人，因为标题是故事必不可少的一部分，需要考虑进去。所以我们去掉第一个单词的前146个字符，得到:</p><pre class="lo lp lq lr fq nl nm nn no aw np dt"><span id="41fa" class="mv lt hu nm b fv nq nr l ns nt">Ryanair is tightening the rules on what passengers pay to take luggage onto the plane, in order to "speed up boarding"</span></pre><p id="742d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">还记得这个公式吗？</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div class="fe ff nj"><img src="../Images/ccec739969b35f1cd5db02765fd17be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*F4O-l5YkFEMU4WJQZOoBQw.png"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">The Term Frequency (TF) of a term, t, and a document, d.</figcaption></figure><p id="e59f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">变量“<em class="nk"> TFVals </em>”正在计算这个公式。如果我们运行句子“你好，我叫布兰登。布兰登布兰登。大象跳过月亮“通过项频率函数，我们会得到类似这样的东西:</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ny"><img src="../Images/d82ca151b784b682a56ce8478b42ed91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uTEkBVplTb57czjE2ZiuNw.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">TF only returns 1 “Brandon”, so not every Brandon has a TF score. For this example, bare in mind that TF only returns 1 Brandon because we are calculating the singular term (word) frequency.</figcaption></figure><p id="3159" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们有词频这个术语，但是我们想计算最重要的<strong class="jj hv">句子</strong>，而不是单词。为了做到这一点，我们仔细检查每一个句子，看看这个句子中出现了哪些单词，它们在<em class="nk"> TFVals </em>中。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff nz"><img src="../Images/69fce564c9d3536b56cdaa95b762ad90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gn5T98Vkm3C8hW87x2KpRQ.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Remember earlier how I said we don’t count all 3 “Brandon”’s? I’ve done that now. Also, note that we’re splitting this up into sentences. There are 3 sentences in this image.</figcaption></figure><p id="d6e6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们只需要把它们加起来，然后除以我们有多少单词。因为我们只是把非停用词的TF值相加，所以如果我们除以一个句子中有多少个非停用词，而不是句子中有多少个词，这才是公平的。如果不除以单词量，长句比短句更有优势。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff oa"><img src="../Images/d4f17eb9d4f1734359c51604f7c6b9f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3L16z-glMZjfjvrAaYTKcg.png"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">The sentence with the highest TF is “Brandon Brandon.”</figcaption></figure><p id="5260" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这就是下面第20行的内容。我们遍历每一个句子，计算每个句子的TF值，就像我们上面做的一样。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">New code added starts at line 20</figcaption></figure><p id="c5c8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">仅此而已。但是我们有一个问题，只用术语频率。正如你之前看到的，“Brandon Brandon”是我们看的所有三个句子中得分最高的TF。</p><p id="9015" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">光有人气是不够的。我们不希望句子中包含最多的关键字，因为它们可能没有意义，或者它们可能是彼此的重复。如“布兰登”中的“布兰登”句。它的TF值很高，但内容不多。</p><p id="c24d" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">它包含的信息不多，也没什么用。我们想要一个既罕见又独特的句子，并且包含文章中常见的关键词。这就是逆文档频率出现的原因。</p></div><div class="ab cl kx ky hc kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hn ho hp hq hr"><h2 id="adfb" class="mv lt hu bd lu mw mx my ly mz na nb mc js nc nd mg jw ne nf mk ka ng nh mo ni dt translated">逆文档频率</h2><p id="6773" class="pw-post-body-paragraph jh ji hu jj b jk mq jm jn jo mr jq jr js ms ju jv jw mt jy jz ka mu kc kd ke hn dt translated">词频是一个词有多常见，逆文档频率(IDF)是一个词有多独特或罕见。IDF的公式为:</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div class="fe ff ob"><img src="../Images/d7ccd77dca3062ee5446eb1ec63216ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*WD4Z2DxSrAicsKwuQm26wA.png"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">t is the term and d is the documents. We have multiple documents, we’re treating each sentence as its own document.</figcaption></figure><p id="0d55" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">IDF使用了许多文档，而TF是为一个文档而构建的。你可以决定什么是文档。在本文中，每个句子都是它自己的文档。</p><p id="4e90" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">IDF的前几步和TF一样。我们美化文档，统计文档中的单词，并获得所有唯一的单词。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="976c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">第1–6行并不新鲜。第17行的for循环遍历文档中的每个句子。因为每个句子都是一个新的“文档”，所以我们需要单独计算每个句子的字数。我们必须美化它们，去掉停用词，把它们变成一组单词。我们将每个新句子的单词计数对象推入<em class="nk">单词计数句子</em>。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div class="fe ff oc"><img src="../Images/af2f51cafdee725f6367b00115e383e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*O9Lv6-QTG07EEqnLQNZ3xA.png"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">There are 3 sentences here. We don’t care how many times Brandon appears over the whole document. I tried to pick the words to give you something interesting without making the maths too large, but in the process I developed narcissism.</figcaption></figure><p id="52ca" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们现在将检查每个单词，并计算该单词在每个句子中出现的次数，然后使用下面的公式计算IDF得分。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div class="fe ff od"><img src="../Images/b2cc0fbda13aefe2ba28cfbc62be85b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*kO4fXaJdu9QhbwICxbvc1w.png"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">I use log 10 here. Note: all logarithms are constantly <a class="ae jg" href="https://www.khanacademy.org/math/algebra2/exponential-and-logarithmic-functions/logarithmic-scale/v/logarithmic-scale" rel="noopener ugc nofollow" target="_blank">scaled</a>, so it doesn’t matter much on what logarithm you use.</figcaption></figure><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div class="fe ff oe"><img src="../Images/327a2a97396593d90b06267b2f1230bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*8pJZji2F5uy6E6zAxKL06Q.png"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">A small example of how IDF is used.</figcaption></figure><p id="1ed6" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在我们对每个不停的单词都这样做。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div class="fe ff of"><img src="../Images/72598299f9699880de5f1abcd14ebb65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*omR9oAN2-yDYfOcIv7bPEw.png"/></div></figure><p id="a440" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这个的代码是:</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">New code starts on line 25.</figcaption></figure><p id="d4be" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在我们想得到所有句子的IDF值，我们在这里使用来自TF的相同代码，但是替换了一些东西来使它工作。</p><p id="23ba" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果我实话实说，我做了一个简单的“查找和替换”变量。我把评论里的“TF”换成了IDF。我把“<em class="nk"> TFVals </em>”换成了“<em class="nk"> IDFVals </em>”。这里没有发生什么重要的事情，所以可以跳过这一部分。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">New code starts on line 38.</figcaption></figure><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div class="fe ff og"><img src="../Images/22001d54253b09fc5f6628b773de3d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*kxm0bf_KleZ31r1GszSw8g.png"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Now that we have written code to calculate the IDF value of sentences; we have completed the formula from earlier. “is a dog” has the highest IDF value.</figcaption></figure><p id="9f52" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们现在知道一个句子是多么独特或罕见。这没什么用，因为我们也想让句子包含丰富的信息。我们希望有某种方式将TF的受欢迎程度与IDF的独特性结合起来。这将引导我们进入下一部分…</p></div><div class="ab cl kx ky hc kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hn ho hp hq hr"><h1 id="87b3" class="ls lt hu bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp dt translated">TF-IDF重访</h1><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="oh nv l"/></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">“Are we done yet? Can I wake up now?” Yes, very nearly done! Gif from <a class="ae jg" href="https://gph.is/1SI2P4W" rel="noopener ugc nofollow" target="_blank">Giphy</a>.</figcaption></figure><p id="8b68" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们现在已经实现了TF和IDF功能。剩下唯一要做的就是将它们相乘。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="4cb1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对象TF和IDF都来自相同的数据，所以TF不会包含IDF中没有的内容。因此，我们可以遍历一个对象并使用同一个键。我们将TFVals中的值乘以IDFVals中的值。</p><p id="d345" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们的下一步是计算TF-IDF对象中最重要的3个句子。用几个if语句迭代对象的<em class="nk">【key，value】</em>可以很好地工作。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="6ffb" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">你会在底部看到我们返回格式化的字符串。我们把它格式化，这样当我们把它插入网页时，它看起来很漂亮。每个<br/>是一个<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/br" rel="noopener ugc nofollow" target="_blank">换行符，</a>是文本中的一个空格。黑点是项目符号。我们现在要在Firefox扩展中实现这个算法。🔥🦊</p></div><div class="ab cl kx ky hc kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hn ho hp hq hr"><h1 id="e2ce" class="ls lt hu bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp dt translated">获取和更改BBC新闻文章中的文本</h1><p id="955b" class="pw-post-body-paragraph jh ji hu jj b jk mq jm jn jo mr jq jr js ms ju jv jw mt jy jz ka mu kc kd ke hn dt translated">转到任意一篇<a class="ae jg" href="https://www.bbc.co.uk/news" rel="noopener ugc nofollow" target="_blank"> BBC </a>新闻文章，右键单击并按“检查元素”。你会在屏幕底部看到一个漂亮的方框。使用左上角的元素选择器工具，将鼠标悬停在文章上。我们可以看到整篇文章都包含在一个CSS类“story-body”中。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff oi"><img src="../Images/87f89b752daebca349adaad88135cafc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gtYohYjQ76R6kjcU.png"/></div></div></figure><p id="259b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果我们进一步深入，我们可以看到文章中的所有实际文本都包含在这个CSS类中的段落标记中。</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff oj"><img src="../Images/90097641f6da7adbd8ed9b2921e0bebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5nY1VQtLqXTiPMHt.png"/></div></div></figure><p id="4318" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们将使用<a class="ae jg" href="https://jquery.com/" rel="noopener ugc nofollow" target="_blank"> JQuery </a>选择文本。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="ec47" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这一行选择story-body类中所有的<a class="ae jg" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/p" rel="noopener ugc nofollow" target="_blank"> &lt; p &gt; </a>标签。现在我们想要得到文本，我们通过应用方法<em class="nk">来实现。text() </em>。</p><p id="148c" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们想把我们的文字添加到文章的顶部。JQuery有一个名为prepend的方法，它允许我们将数据添加到对象的顶部。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="4495" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们完事了。我们现在可以识别BBC新闻文章中最重要的句子，并显示在顶部。只是时间把它变成一个延伸。</p></div><div class="ab cl kx ky hc kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hn ho hp hq hr"><h1 id="de87" class="ls lt hu bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp dt translated">Firefox扩展基础</h1><p id="78b1" class="pw-post-body-paragraph jh ji hu jj b jk mq jm jn jo mr jq jr js ms ju jv jw mt jy jz ka mu kc kd ke hn dt translated">Firefox扩展有两个主要部分。你写的Javascript和<em class="nk"> manifest.json </em>文件告诉Mozilla你的扩展是做什么的。我们现在正在检查<em class="nk"> manifest.json </em>。</p><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="nu nv l"/></div></figure><p id="327f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="nk"> manifest_version </em>告诉Firefox你正在使用哪个版本的清单。<em class="nk"> Name </em>告诉Firefox你的扩展名是什么。<em class="nk">版本</em>告诉Firefox你的扩展是什么版本号。这三个是必须的。</p><p id="7b3e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="nk">描述</em>告诉Firefox你的扩展是做什么的。</p><p id="f31a" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">T21告诉火狐当网址匹配你输入的内容时加载什么脚本。为了运行您指定的脚本，当前URL必须至少与您指定的一个URL匹配。您可以在这里使用两个特殊字符:</p><ol class=""><li id="fc8c" class="ok ol hu jj b jk jl jo jp js om jw on ka oo ke op oq or os dt translated">"<strong class="jj hv"> * </strong>"匹配零个或多个字符。在这个例子中，我不知道用户将加载HTTP还是HTTPS，所以我让它一步加载两者。我也不知道用户会看哪篇文章，所以我把它设置为在任何文章上激活。</li></ol><p id="a563" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">2.”<strong class="jj hv">？</strong>“恰好匹配一个字符。</p><p id="1c75" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Mozilla开发者网络对此有一个很好的解释:</p><p id="4252" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">例如:<code class="eh ot ou ov nm b">"*na?i"</code>将匹配<code class="eh ot ou ov nm b">"illuminati"</code>和<code class="eh ot ou ov nm b">"annunaki"</code>，但不匹配<code class="eh ot ou ov nm b">"sagnarelli"</code>。</p><p id="e6bc" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">因为我们将使用jQuery，所以在脚本执行之前，我们也将jQuery JS文件导入到网站中。你可以从<a class="ae jg" href="https://code.jquery.com/jquery-3.3.1.slim.js" rel="noopener ugc nofollow" target="_blank">这里</a>抓取jQuery文件。复制粘贴到一个名为<em class="nk">“jquery . js”</em>的文件中。</p><p id="19cf" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在Firefox URL中输入“<em class="nk"> about:debugging </em>”来加载这个页面:</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ow"><img src="../Images/bbd35b6ef6587256b16263ddc1ac0de5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*G8AooP4-C9x4vjHK.png"/></div></div></figure><p id="aef1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">从这里，点击<em class="nk">“加载临时附件…”</em>，然后点击扩展中的任何文件。一旦你这样做了，你应该看到这个:</p><figure class="lo lp lq lr fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ox"><img src="../Images/f2b73d73d1263db55b7a384a06323023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*L0rVhBpG2bOjkxt9.png"/></div></div></figure><p id="77de" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Mozilla有一篇关于火狐扩展基础的好文章。</p><p id="ecd3" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">现在加载任何<a class="ae jg" href="https://www.bbc.co.uk/news" rel="noopener ugc nofollow" target="_blank"> BBC新闻</a>文章来玩吧！</p></div><div class="ab cl kx ky hc kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hn ho hp hq hr"><h1 id="4a94" class="ls lt hu bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp dt translated">结论</h1><p id="5ebf" class="pw-post-body-paragraph jh ji hu jj b jk mq jm jn jo mr jq jr js ms ju jv jw mt jy jz ka mu kc kd ke hn dt translated">您现在已经看到了TF-IDF的强大功能以及它的实际应用。我有这个想法是因为我有电子邮件焦虑症。我对阅读电子邮件感到非常紧张，所以我想要一个快速的摘要来平静我的思绪。唉，这是我第一次写Javascript。我开始做一些比较容易的东西，比如BBC新闻文章。</p><p id="25f9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你愿意的话，下面是一些改进这些代码的方法:</p><ul class=""><li id="5945" class="ok ol hu jj b jk jl jo jp js om jw on ka oo ke oy oq or os dt translated">动态选择你想要的摘要中的句子数量。您可以在整篇文章中找到平均TF*IDF值，以及可以包含在摘要中的任何超过X的值。这使得长文章和短文章被同等对待。</li><li id="5f51" class="ok ol hu jj b jk oz jo pa js pb jw pc ka pd ke oy oq or os dt translated">扩展这一工作在任何其他网站上你想。</li></ul><p id="5691" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">GitHub回购在这里是<a class="ae jg" href="https://github.com/brandonskerritt/tldr-News" rel="noopener ugc nofollow" target="_blank"/>。</p></div><div class="ab cl kx ky hc kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hn ho hp hq hr"><figure class="lo lp lq lr fq iv"><div class="bz el l di"><div class="pe nv l"/></div></figure><h2 id="8550" class="mv lt hu bd lu mw mx my ly mz na nb mc js nc nd mg jw ne nf mk ka ng nh mo ni dt translated">你喜欢这篇文章吗？在社交媒体上与我联系，讨论所有与计算机科学相关的事情😁</h2><p id="84d2" class="pw-post-body-paragraph jh ji hu jj b jk mq jm jn jo mr jq jr js ms ju jv jw mt jy jz ka mu kc kd ke hn dt translated"><a class="ae jg" href="https://twitter.com/brandon_skerrit" rel="noopener ugc nofollow" target="_blank">推特</a>|<a class="ae jg" href="http://instagram.com/brandon.codes" rel="noopener ugc nofollow" target="_blank">insta gram</a>|<a class="ae jg" href="https://www.linkedin.com/in/brandonls/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a></p><p id="2fd1" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我写这篇文章没有得到报酬。如果你想支持我或喜欢这篇文章，请随时给我买杯茶或下面的东西😍✨</p><div class="kf kg fm fo kh ki"><a href="https://www.paypal.me/brandonskerritt" rel="noopener  ugc nofollow" target="_blank"><div class="kj ab ej"><div class="kk ab kl cl cj km"><h2 class="bd hv fv z el kn eo ep ko er et ht dt translated">用贝宝支付布兰登·斯凯里特。我</h2><div class="kp l"><h3 class="bd b fv z el kn eo ep ko er et ek translated">去paypal.me/BrandonSkerritt输入金额。既然是PayPal，那就简单又安全。没有PayPal…</h3></div><div class="kq l"><p class="bd b gc z el kn eo ep ko er et ek translated">www.paypal.me</p></div></div><div class="kr l"><div class="pf l kt ku kv kr kw ja ki"/></div></div></a></div><div class="kf kg fm fo kh ki"><a href="https://monzo.me/brandonskerritt" rel="noopener  ugc nofollow" target="_blank"><div class="kj ab ej"><div class="kk ab kl cl cj km"><h2 class="bd hv fv z el kn eo ep ko er et ht dt translated">通过Monzo.me即时支付Brandon</h2><div class="kp l"><h3 class="bd b fv z el kn eo ep ko er et ek translated">点击链接向布兰登付款。你不需要创建一个账户，而且完全免费。</h3></div><div class="kq l"><p class="bd b gc z el kn eo ep ko er et ek translated">monzo.me</p></div></div><div class="kr l"><div class="pg l kt ku kv kr kw ja ki"/></div></div></a></div></div></div>    
</body>
</html>