<html>
<head>
<title>A complete Backend only with Kotlin and your favourite text-editor!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个完整的后端，只有Kotlin和你最喜欢的文本编辑器！</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/a-complete-backend-only-with-kotlin-and-your-favourite-text-editor-582b4528688?source=collection_archive---------8-----------------------#2018-09-10">https://medium.com/hackernoon/a-complete-backend-only-with-kotlin-and-your-favourite-text-editor-582b4528688?source=collection_archive---------8-----------------------#2018-09-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/8e7ad9caa334b9f7471e18317b74551a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UnOJQ9MbdKpsnecahq5uRg.jpeg"/></div></div></figure><p id="224c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">什么？！！好吧，让我澄清一下。让我们只用Kotlin和你最喜欢的文本编辑器来构建一个完整的后端/网络应用程序。不，不需要安装IntellJ IDEA，不需要处理Gradle文件的东西..说真的，没有！你所需要的只是一个简单的文本编辑器和Kotlin。那么……该怎么做呢？</p><p id="b621" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于这个食谱，我们需要两种成分(除了文本编辑器和Kotlin)。<br/>我假设你已经安装了<a class="ae ka" href="https://kotlinlang.org" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">科特林</strong> </a> <strong class="je hv"> </strong>并且设置了Atom或者Sublime或者Vim。</p><h1 id="6b90" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">安装<a class="ae ka" href="https://github.com/holgerbrandl/kscript" rel="noopener ugc nofollow" target="_blank">k脚本</a>和<a class="ae ka" href="https://ktor.io/" rel="noopener ugc nofollow" target="_blank">k用于</a></h1><figure class="la lb lc ld fq iv fe ff paragraph-image"><div class="fe ff kz"><img src="../Images/eaa9710776415f5aece06bbf20f1ae5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/1*eNOHLwmo78NiRScganL79Q.gif"/></div><figcaption class="le lf fg fe ff lg lh bd b be z ek">A made GIF ;-)</figcaption></figure><blockquote class="li lj lk"><p id="48ac" class="jc jd ll je b jf jg jh ji jj jk jl jm lm jo jp jq ln js jt ju lo jw jx jy jz hn dt translated">什么是<a class="ae ka" href="https://ktor.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> KTor </strong> </a>？Ktor是一个使用强大的Kotlin编程语言在连接系统中构建异步服务器和客户端的框架。</p></blockquote><p id="e637" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">KTor是一个用Kotlin构建的web框架，用于开发强大的web应用程序。这是我们将要使用的框架。Ktor是一个可以轻松构建互联应用的框架——web应用、HTTP服务、移动和浏览器应用。现代的连接应用程序需要异步来为用户提供最好的体验，而Kotlin协同例程提供了强大的工具来以简单明了的方式做到这一点。<br/>如果你想阅读更多关于Ktor的描述请查看<a class="ae ka" href="https://ktor.io/quickstart/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">这里</strong> </a> <strong class="je hv">。</strong></p><blockquote class="li lj lk"><p id="a26d" class="jc jd ll je b jf jg jh ji jj jk jl jm lm jo jp jq ln js jt ju lo jw jx jy jz hn dt translated">什么是<a class="ae ka" href="https://github.com/holgerbrandl/kscript" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv"> Kscript </strong> </a>？在基于*nix的系统上，增强了对<a class="ae ka" href="https://kotlinlang.org/" rel="noopener ugc nofollow" target="_blank"> Kotlin </a>的脚本支持。</p></blockquote><p id="24e7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是有趣的部分。它是一个由<a class="ae ka" href="https://twitter.com/holgerbrandl" rel="noopener ugc nofollow" target="_blank"><em class="ll">@ HolgerBrandl</em></a><em class="ll"/>维护的<a class="ae ka" href="https://github.com/holgerbrandl/kscript" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">库</strong> </a>，为Kotlin提供了增强的、牛逼的脚本支持。您甚至可以使用该工具进行数据/文本处理，也可以运行Kotlin.kt文件。观看<a class="ae ka" href="https://www.youtube.com/watch?v=cOJPKhlRa8c" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">这篇演讲</strong> </a> <strong class="je hv"> </strong>了解更多细节和Kscript能做什么。</p><p id="6528" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要安装Kscript，请遵循以下步骤:<br/>如果您已经安装了<a class="ae ka" href="http://sdkman.io" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">sdkman</strong></a><strong class="je hv"/>，您可以直接跳到步骤<strong class="je hv"> 2。</strong> <br/> <strong class="je hv"> 1。</strong>安装<a class="ae ka" href="http://sdkman.io" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">sdkman</strong></a><strong class="je hv"><br/></strong>你可以在这里按照说明<a class="ae ka" href="https://sdkman.io/install" rel="noopener ugc nofollow" target="_blank"><strong class="je hv"/></a>。或者运行:</p><pre class="la lb lc ld fq lp lq lr ls aw lt dt"><span id="925e" class="lu kc hu lq b fv lv lw l lx ly">$ curl -s “<a class="ae ka" href="https://get.sdkman.io" rel="noopener ugc nofollow" target="_blank">https://get.sdkman.io</a>" | bash</span></pre><p id="b448" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后按照终端屏幕上的指示运行如下内容</p><pre class="la lb lc ld fq lp lq lr ls aw lt dt"><span id="e789" class="lu kc hu lq b fv lv lw l lx ly">$ source "$HOME/.sdkman/bin/sdkman-init.sh"</span></pre><p id="f554" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> 2。</strong>安装<strong class="je hv"> Kscript <br/> </strong>一旦你安装了<strong class="je hv"> sdkman，</strong>你就可以运行这个来安装Kscript。(但是Kscript的先决条件是Kotlin和Maven，所以要确保您的机器上有Kotlin。简单来说，运行<code class="eh lz ma mb lq b">$ sdk install kotlin</code>和<code class="eh lz ma mb lq b">$ sdk install maven</code>。现在运行以下命令:</p><pre class="la lb lc ld fq lp lq lr ls aw lt dt"><span id="c921" class="lu kc hu lq b fv lv lw l lx ly">$ sdk install kscript</span></pre><p id="400a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它将下载Kscript并将其添加到您的路径中。</p><p id="e875" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我给你一个Kscript的快速概述，这样你就会对它有一个概念。要开始使用Kscript并获得完整的参考资料，请访问<a class="ae ka" href="https://github.com/holgerbrandl/kscript" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">本报告</strong> </a> <strong class="je hv">。<br/> </strong>文件的扩展名是<code class="eh lz ma mb lq b">.kts</code>或者可以使用<code class="eh lz ma mb lq b">.kt</code>。将这一行添加到您的文件<code class="eh lz ma mb lq b">#!/usr/bin/env kscript</code>的顶部(在shebang行中指向它)。在这个文件中，你可以编写任何kotlin代码。检查下面简单的<code class="eh lz ma mb lq b">hello_world.kts</code>。</p><pre class="la lb lc ld fq lp lq lr ls aw lt dt"><span id="d318" class="lu kc hu lq b fv lv lw l lx ly">#!/usr/bin/env kscript</span><span id="a74b" class="lu kc hu lq b fv mc lw l lx ly">import java.util.*</span><span id="0de5" class="lu kc hu lq b fv mc lw l lx ly">println("Belllloooo!!")<br/>//Rest of the code below </span></pre><p id="4df5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以使用下面的命令来运行它。它有一些编译开销，所以需要一些时间。</p><pre class="la lb lc ld fq lp lq lr ls aw lt dt"><span id="b0b5" class="lu kc hu lq b fv lv lw l lx ly">$ kscript hello_world.kts</span></pre><p id="0667" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">请浏览kscript repo 以获得更多关于如何包含库依赖、另一个文件、Kotlin-opts、JVM-args等的细节。</p><h1 id="76f9" class="kb kc hu bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">运行KTor服务器</h1><p id="fcd5" class="pw-post-body-paragraph jc jd hu je b jf md jh ji jj me jl jm jn mf jp jq jr mg jt ju jv mh jx jy jz hn dt translated">现在我们来看看KTor。要使用KTor，我们需要依赖<br/> <code class="eh lz ma mb lq b">compile "io.ktor:ktor-server-netty:0.9.4"</code>来和gradle一起使用。但是，正如我所说，我们根本没有维护任何gradle文件的东西。Kscript最好的特性之一是，你可以在你正在处理的同一个文件中声明库依赖。让我告诉你我修改同一个<code class="eh lz ma mb lq b">hello_world.kts</code>文件的意思。</p><figure class="la lb lc ld fq iv"><div class="bz el l di"><div class="mi mj l"/></div></figure><p id="1f5d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这里的<code class="eh lz ma mb lq b">@file:MavenRepository(...)</code>与你IntellJ IDEA中的<code class="eh lz ma mb lq b">build.gradle</code>文件中的<code class="eh lz ma mb lq b">repositor{}</code>相同。KTor所需的存储库是maven repos。另外，<code class="eh lz ma mb lq b">@file:DependsOnMaven(...)</code>指定了Netty基本用法所需的工件。</p><p id="af14" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当您第一次尝试运行上述文件时，将下载并缓存依赖项。要清除缓存，你可以运行<code class="eh lz ma mb lq b">kscript --clear-cache</code>。</p><p id="b01d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">通过进一步修改上面的文件，让我们看看如何启动服务器。我再次修改同一个hello_world.kts文件。</p><figure class="la lb lc ld fq iv"><div class="bz el l di"><div class="mi mj l"/></div></figure><p id="8ad0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你就完了。运行命令<code class="eh lz ma mb lq b">$ kscript hello_world.kts</code>即可。它将首次下载依赖项(编译和下载依赖项需要一些时间)。您可以忽略警告(类似SL4J等)。<br/>在浏览器上访问url <code class="eh lz ma mb lq b">http://localhost:8080</code>。希望你可能会看到一些东西</p><p id="59af" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们刚刚创建了一个带有文本编辑器和kotlin的简单服务器。为了进一步完善，你可以在<a class="ae ka" href="http://ktor.io/servers/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">文档</strong> </a> <strong class="je hv">中查看服务器支持的KTor开发。</strong>关于客户端HTML模板和请求处理，请查看KTor的本<a class="ae ka" href="http://ktor.io/clients/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="je hv">文档</strong> </a>。</p><p id="fe91" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">KTor是异步服务器框架。我将在本系列的下一部分讨论这些主题。所以，敬请关注下期帖子。</p></div><div class="ab cl mk ml hc mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hn ho hp hq hr"><p id="5358" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">第二部分即将到来。敬请期待！如果你喜欢这个故事，请为我鼓掌，并跟随我获得像这样的精彩食谱。更多内容请访问<a class="ae ka" href="http://www.nikhya.me" rel="noopener ugc nofollow" target="_blank"><strong class="je hv">http://nikhya . me</strong></a><strong class="je hv"/>。</p></div></div>    
</body>
</html>