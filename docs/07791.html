<html>
<head>
<title>Low-cost USB Rubber Ducky pen-test tool for $3 using Digispark and Duck2Spark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">低成本USB橡胶Ducky笔-使用Digispark和Duck2Spark的测试工具，售价3美元</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/low-cost-usb-rubber-ducky-pen-test-tool-for-3-using-digispark-and-duck2spark-5d59afc1910?source=collection_archive---------0-----------------------#2018-09-13">https://medium.com/hackernoon/low-cost-usb-rubber-ducky-pen-test-tool-for-3-using-digispark-and-duck2spark-5d59afc1910?source=collection_archive---------0-----------------------#2018-09-13</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="1dc7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是一个历史悠久的故事:一些黑客看到了不错的硬件笔测试工具，黑客对该工具的价格感到恐惧，黑客以零头的价格构建了自己的版本。</p><p id="3ac8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这方面的一个例子是Rubber Ducky，这是一个优秀的Hak5黑客工具，由于几个开发人员的工作，我们可以使用一个小而便宜的Digispark来模仿它。来自通用现成部件的廉价硬件的一个优点是它是一次性的并且几乎不可能被追踪。</p><p id="25ca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">USB橡皮鸭是一种伪装成普通闪存盘的击键注入工具。计算机将其识别为常规键盘，并以每分钟超过1000个单词的速度自动接受其预编程的击键有效载荷。部署一些最高级的笔测试攻击或it自动化任务只需几秒钟的物理访问时间。但是橡皮鸭也可以帮助恶作剧的执行，例如用一个脚本快速改变同事工作站的壁纸。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/2a3ef5807f74f24c61ffcebe8f68045f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I9_HZriwF7C3o-BRpjm1mg.jpeg"/></div></div></figure><p id="c9c4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">但是45美元加上运费<a class="ae jp" href="https://hakshop.com/products/usb-rubber-ducky-deluxe" rel="noopener ugc nofollow" target="_blank">的橡皮鸭</a>并不是一个便宜的工具，幸运的是我们可以<a class="ae jp" href="https://bit.ly/2N6oAkh" rel="noopener ugc nofollow" target="_blank">用Digispark开发板和一些免费软件只花3美元</a>就可以DIY一个克隆。Digispark是基于Attiny85的微控制器开发板，类似于Arduino Uno，只是更便宜、更小。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kc"><img src="../Images/9c283fa9b786e8157cc736c8af481535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iv7e7RJ9TK8AlJ-oGxouWg.png"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Digispark boards</figcaption></figure><p id="d4ea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">第一步:设置Digispark开发环境</strong></p><p id="b4d6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在开始使用我们的开发板之前，我们必须安装Arduino IDE。在此之后，我们必须下载此板的兼容性包，这是一个相当简单的操作。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff kh"><img src="../Images/08f53411cd6daa72e78e4790bf532a7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cIvhX1n8AbwuAzILFsqonQ.png"/></div></div></figure><div class="ki kj fm fo kk kl"><a href="https://www.arduino.cc/en/main/software" rel="noopener  ugc nofollow" target="_blank"><div class="km ab ej"><div class="kn ab ko cl cj kp"><h2 class="bd hv fv z el kq eo ep kr er et ht dt translated">Arduino软件</h2><div class="ks l"><h3 class="bd b fv z el kq eo ep kr er et ek translated">ARDUINO软件是按“原样”提供给您的，我们对以下方面不做任何明示或暗示的担保</h3></div><div class="kt l"><p class="bd b gc z el kq eo ep kr er et ek translated">www.arduino.cc</p></div></div><div class="ku l"><div class="kv l kw kx ky ku kz ka kl"/></div></div></a></div><p id="2dfb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">安装后打开Arduino IDE应用程序，进入<strong class="it hv">文件</strong>-&gt;-<strong class="it hv">首选项</strong>-<br/>在名为“附加电路板管理器URL”的输入字段中输入以下URL。</p><pre class="jr js jt ju fq la lb lc ld aw le dt"><span id="2e47" class="lf lg hu lb b fv lh li l lj lk"><a class="ae jp" href="http://digistump.com/package_digistump_index.json" rel="noopener ugc nofollow" target="_blank">http://digistump.com/package_digistump_index.json</a></span></pre><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff ll"><img src="../Images/92bfd7fcec9502f076db68d3516d01e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWdGarEESeDbCD489rAvtg.jpeg"/></div></div></figure><p id="7a97" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">打开Arduino IDE—Preferences<strong class="it hv">Tools</strong>-&gt;<strong class="it hv">Board</strong>-&gt;-<strong class="it hv">Boards Manager</strong><br/>从下拉菜单中选择“Contributed”，选择<strong class="it hv"> Digistump AVR Boards </strong>包并安装。</p><p id="221a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们需要安装Digispark引导程序驱动程序。你只需要驱动程序用arduino编程就可以了。一旦你给它编了程序，它就会像橡皮鸭(一种通用的USB键盘)一样在你插入的任何设备上工作，而不需要任何驱动程序。</p><p id="9228" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://github.com/digistump/DigistumpArduino/releases/download/1.6.7/Digistump.Drivers.zip" rel="noopener ugc nofollow" target="_blank"><strong class="it hv">https://github . com/digi stump/DigistumpArduino/releases/download/1 . 6 . 7/digi stump。drivers . zip</strong>T3】</a></p><p id="7e45" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">通常驱动程序安装过程会有一些问题。所以请确保正确安装驱动程序。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff lm"><img src="../Images/f253b2861c6626ef381e5d366fbef0cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*5W9j8XXghzX0h7Z0CKD5SQ.jpeg"/></div></figure><p id="75a3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后进入<strong class="it hv">工具</strong> - &gt; <strong class="it hv">板卡</strong>，选择<strong class="it hv"> Digispark(默认— 16.5mhz) </strong>设置为默认。</p><p id="68ac" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">第二步:将Digispark变成一个橡胶鸭子克隆体</strong></p><p id="4a07" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">橡皮鸭使用简单的脚本语言来创建有效载荷。对于Digispark来说，事情并没有那么简单。我们需要使用<strong class="it hv"><em class="ln">digi keyboard . h</em></strong>和Arduino IDE编写自己的有效载荷。互联网上有一些适用于Digispark的脚本。但是多亏了MaMe82 ( <a class="ae jp" href="https://twitter.com/mame82" rel="noopener ugc nofollow" target="_blank">马库斯·门斯</a>)的工作，你可以用duck2spark项目把橡皮鸭脚本翻译成Digispark。</p><div class="ki kj fm fo kk kl"><a href="https://github.com/mame82/duck2spark" rel="noopener  ugc nofollow" target="_blank"><div class="km ab ej"><div class="kn ab ko cl cj kp"><h2 class="bd hv fv z el kq eo ep kr er et ht dt translated">mame82/duck2spark</h2><div class="ks l"><h3 class="bd b fv z el kq eo ep kr er et ek translated">原始RubberDucky有效负载到Digispark Arduino IDE草图源的转换器。- mame82/duck2spark</h3></div><div class="kt l"><p class="bd b gc z el kq eo ep kr er et ek translated">github.com</p></div></div><div class="ku l"><div class="lo l kw kx ky ku kz ka kl"/></div></div></a></div><p id="7332" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Duck2spark的一个很大的特点是，在DigiSpark上模拟RuberDucky的可用解决方案和教程对非美国语言的键盘布局支持较差。这可以通过将问题“外包”给支持多种键盘布局的DuckEncoder来解决。</p><p id="c9dc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用Duck2spark真的很简单。让我们看一个duck2spark文档的例子，一个经典的hello world:</p><pre class="jr js jt ju fq la lb lc ld aw le dt"><span id="125f" class="lf lg hu lb b fv lh li l lj lk">Generate a DuckyScript test.duck you want to use as output:</span><span id="fab3" class="lf lg hu lb b fv lp li l lj lk">echo "STRING Hello World" &gt; test.duck</span><span id="84a8" class="lf lg hu lb b fv lp li l lj lk">Compile the script using DuckEncoder with your keyboard layout (de in example) or use my python port:</span><span id="0b6e" class="lf lg hu lb b fv lp li l lj lk">java -jar encoder.jar -i test.duck -o raw.bin -l de</span><span id="6c0c" class="lf lg hu lb b fv lp li l lj lk">Use duck2spark.py to convert into Arduino Sketch (options for single run, 2 seconds startup delay):</span><span id="6871" class="lf lg hu lb b fv lp li l lj lk">duck2spark.py -i raw.bin -l 1 -f 2000 -o sketch.ino</span><span id="ee13" class="lf lg hu lb b fv lp li l lj lk">After setting up the Arduino IDE load the example "DigisparkKeyboard" and replace the Sketch source by the one saved to sketch.ino </span></pre><p id="823e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">点击草图-&gt;上传或点击左上角的上传按钮。打开记事本或任何软件。再次插入Digispark USB，神奇的“Hello World”就打出来了。</p><p id="1499" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">橡皮鸭的有效载荷可以是任何东西；它根据我们的目标和意图而改变！我们可以创建无线网络关联、下载和执行有效载荷、反向外壳等。对于pen测试，我们甚至可以使用Meterpreter、Empire、Unicorn或任何其他powershell有效负载。</p><div class="ki kj fm fo kk kl"><a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payloads" rel="noopener  ugc nofollow" target="_blank"><div class="km ab ej"><div class="kn ab ko cl cj kp"><h2 class="bd hv fv z el kq eo ep kr er et ht dt translated">hak5darren/USB橡胶鸭</h2><div class="ks l"><h3 class="bd b fv z el kq eo ep kr er et ek translated">在GitHub上创建一个帐户，为hak5darren/USB-Rubber-Ducky开发做贡献。</h3></div><div class="kt l"><p class="bd b gc z el kq eo ep kr er et ek translated">github.com</p></div></div><div class="ku l"><div class="lq l kw kx ky ku kz ka kl"/></div></div></a></div><p id="15e7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">故障排除</strong></p><p id="2ec8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您能够对您的Digispark进行编程，并且代码运行，但是在拔出并重新插入Digispark后草图不运行:您将需要更新引导加载程序。引导装载程序有一个内置的更新机制。要刷新引导加载程序，请使用此处的指南<a class="ae jp" href="https://www.iot-experiments.com/micronucleus-bootloader-upgrade/" rel="noopener ugc nofollow" target="_blank">和</a>，Digispark将在拔出和插回后工作并运行草图。</p><p id="74f7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请记住，Digispark是OSHW(开源硬件)，没有原始的Digispark或克隆的Digispark，他们都是一样的！唯一的区别是，一些制造商闪存旧版本的引导加载程序。</p><p id="f52b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">提示</strong></p><p id="3206" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Digispark的使用并没有到此为止，作为一个Arduino兼容的开发系统，它可以用于任何基于Arduino的攻击，只需稍作修改。即使使用它进行HID攻击也不是运行Duck2Spark的必要条件，如果你想在低级别的USB HID上工作，Digispark有一个内置的键盘库，名为Digikeyboard。</p><p id="6f95" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">关于你的橡胶鸭子克隆的最后一个提示:使用一些<a class="ae jp" href="https://bit.ly/2CQfLpP" rel="noopener ugc nofollow" target="_blank">热缩管</a>为你的新Digispark-Ducky提供电绝缘、机械保护、密封和一些隐形功能。一个足够便宜的设备，以至于你不介意把它留在现场，如果你不得不穿上你的忍者装备<a class="ae jp" href="https://www.youtube.com/watch?v=5aRDVVXMFzE" rel="noopener ugc nofollow" target="_blank">逃跑的话</a>。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff lr"><img src="../Images/aeee2dcb077f6190ea0a88586f422028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*rLWVOIHX9L2vx3_7N9Ro3w.png"/></div></div></figure><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="ls lt l"/></div></figure></div></div>    
</body>
</html>