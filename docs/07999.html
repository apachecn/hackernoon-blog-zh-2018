<html>
<head>
<title>Build your first Machine Learning &amp; Tensorflow model in 5 minutes!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在5分钟内构建您的第一个机器学习&amp; Tensorflow模型！</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-your-first-tensorflow-model-in-5-minutes-77237e3cf76d?source=collection_archive---------5-----------------------#2018-09-21">https://medium.com/hackernoon/build-your-first-tensorflow-model-in-5-minutes-77237e3cf76d?source=collection_archive---------5-----------------------#2018-09-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="c4f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">所以你听说了<a class="ae jp" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>，机器学习&amp;深度学习这么多，你想入党:)</p><p id="d9b0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这篇文章中，我们将建立一个模型来计算:</p><p id="cd89" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Y = W*x + b</p><p id="b46d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，当向模型提供<strong class="it hv"> x </strong>时，它应该预测最佳可能的<strong class="it hv"> Y </strong>。</p><p id="62ed" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将训练模型，根据我们训练它的内容，尽可能给出最好的<strong class="it hv"> W </strong>和<strong class="it hv"> b </strong>。</p><p id="8a66" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如，如果我们想让我们的模型知道<strong class="it hv"> W </strong>应该是-1而<strong class="it hv"> b </strong> 9，意思是Y =-1 * x+9；我们应该像这样在许多训练对上训练它:</p><p id="c7ea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">(x = input，Y = desired_output) = (x，Y) = (5，4)；</p><p id="c7be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Y = -1*5 + 9 =&gt; Y = 4(当输入为5时，预测Y为4)</p><p id="fede" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">(x，Y) = (3，6)；Y = -1*3 +9 =&gt; Y = 6(当输入x为3时，预测Y为6)</p><p id="5500" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这里的想法是，我们希望模型知道W应该是-1和9，并且它将通过经验来学习它-我们给它提供的训练对(x，Y)越多，它将越好地学习正确预测。</p><p id="5fe4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">那么我们言归正传吧！</strong></p><p id="3c51" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，我们应该从设置环境开始。</p><p id="75fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们首先创建一个目录，运行:</p><p id="a84e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh jq jr js jt b">mkdir tf_linear_regression</code></p><p id="a8b1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在(推荐)让我们在虚拟环境中运行所有程序，遵循以下步骤(它适用于Mac，如果您有Linux或Windows，请尝试使用<a class="ae jp" href="https://www.anaconda.com/" rel="noopener ugc nofollow" target="_blank"> Anaconda </a>)</p><p id="b483" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">安装Python3</p><pre class="ju jv jw jx fq jy jt jz ka aw kb dt"><span id="ac17" class="kc kd hu jt b fv ke kf l kg kh">brew install python3</span></pre><p id="9055" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">(如果你没有Brew——只需从<a class="ae jp" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">这里</a>安装即可)</p><p id="6e71" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在安装虚拟环境</p><p id="82c1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://stackoverflow.com/a/54183964/1340604" rel="noopener ugc nofollow" target="_blank">链接至完整解释</a></p><pre class="ju jv jw jx fq jy jt jz ka aw kb dt"><span id="470a" class="kc kd hu jt b fv ke kf l kg kh">pip3 install virtualenv</span></pre><p id="e040" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创造环境</p><p id="93f8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh jq jr js jt b">cd tf_linear_regression</code></p><pre class="ju jv jw jx fq jy jt jz ka aw kb dt"><span id="a9e2" class="kc kd hu jt b fv ke kf l kg kh">virtualenv -p python3 &lt;path-to-our-dir&gt;</span></pre><p id="47e9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在激活它:</p><pre class="ju jv jw jx fq jy jt jz ka aw kb dt"><span id="130a" class="kc kd hu jt b fv ke kf l kg kh">source &lt;path-to-our-dir&gt;/bin/activate</span><span id="baaf" class="kc kd hu jt b fv ki kf l kg kh">get out of the virtual env run:</span></pre><p id="0184" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要退出虚拟环境，请运行:</p><p id="2f57" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">复员</p><h2 id="dff3" class="kc kd hu bd kj kk kl km kn ko kp kq kr jc ks kt ku jg kv kw kx jk ky kz la lb dt translated">现在是有趣的事情</h2><p id="598e" class="pw-post-body-paragraph ir is hu it b iu lc iw ix iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo hn dt translated">安装Tensorflow</p><pre class="ju jv jw jx fq jy jt jz ka aw kb dt"><span id="3fd5" class="kc kd hu jt b fv ke kf l kg kh">pip3 install tensorflow</span></pre><p id="17e1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在(只是为了好玩)安装Jyputer notebook(不用，可以复制下面的代码粘贴到一个<a class="ae jp" href="https://hackernoon.com/tagged/python" rel="noopener ugc nofollow" target="_blank"> python </a>文件中，作为python脚本运行</p><pre class="ju jv jw jx fq jy jt jz ka aw kb dt"><span id="9cce" class="kc kd hu jt b fv ke kf l kg kh">pip3 install jupyter</span></pre><p id="8acc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://jupyter.readthedocs.io/en/latest/install.html" rel="noopener ugc nofollow" target="_blank">(链接此处)</a></p><p id="8aea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在让我们试着做一些简单的事情&amp;看看这个等式:</p><pre class="ju jv jw jx fq jy jt jz ka aw kb dt"><span id="5274" class="kc kd hu jt b fv ke kf l kg kh">y = W*x + B</span></pre><p id="ad11" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">假设我们有成对的输入，它们的标签=&gt; (X，Y) = [(x1，y1)，(x2，y2)，(x3，y3)，..，(xn，yn)]；</p><p id="8ea0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">也就是说，对于每个输入x，我们都有输出y。这是一个受监督的<a class="ae jp" href="https://hackernoon.com/tagged/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a> (ML)，其中对于每个输入，我们都知道期望的输出。</p><p id="83cb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们要训练上式中的W和B。假设我们有(X，Y) = [ (5，4)，(3，6)，(-1，10)…]</p><p id="dcea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果我们要猜W和B会是什么…(记住):</p><p id="1eb1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">y = W*x + B</p><p id="b9ca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">4 = []*5 +[];6 = []*3 + [];10 = []*(-1) + [].你可以看到W = -1和</p><p id="9b74" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">B = 9非常适合我们…</p><p id="039a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，让我们在Tensorflow (TF)中构建一个模型，我们将对其进行训练，以找到W和b的值。每个步骤中的训练过程如下:</p><p id="2425" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">步骤1:对于输入5，结果是4，对于输入3，结果是6，依此类推。</p><p id="9f48" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以看到这和我们在教机器识别图片中的猫是一样的道理:1。“这张输入图片是一只猫”；2.“这张输入图片是一只猫”；3.“这个输入图片不是猫”等。</p><p id="862e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们从<strong class="it hv">开始吧！</strong></p><p id="1db8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">导入TF和Numpy:</p><figure class="ju jv jw jx fq li fe ff paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="fe ff lh"><img src="../Images/e013abf229799105ca9b1f4594f8703e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y9vVd7KZ4A_dHUfxGKTmmA.png"/></div></div></figure><p id="81ac" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">声明x，y，w，b；变量用作可训练变量，占位符用于给定的训练集输入:</p><figure class="ju jv jw jx fq li fe ff paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="fe ff lh"><img src="../Images/8a854967e39d2cd6c740971b51c0af7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YGzbYSqyrDXEog_UYOH6_Q.png"/></div></div></figure><p id="a43f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">声明X和Y模型输入的训练集，并声明线性方程:</p><figure class="ju jv jw jx fq li fe ff paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="fe ff lh"><img src="../Images/26bc30cb32343cb11f664b15668fc974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*za2MGPC8o8z2bQUIhiRTcw.png"/></div></div></figure><p id="8944" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们设置误差函数(model_delta)，损失函数&amp;优化器+初始化我们上面声明的变量:</p><figure class="ju jv jw jx fq li fe ff paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="fe ff lp"><img src="../Images/048d4c80d1b9b6f646780437ec5adce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kKlfFS7F5ESBqaWOlgn25g.png"/></div></div></figure><p id="8351" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这有点违背直觉，但在TF中，与Python中的程序相反，到目前为止没有任何东西在运行，现在我们应该声明一个会话，然后开始训练过程:</p><figure class="ju jv jw jx fq li fe ff paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="fe ff lq"><img src="../Images/b0cd2378a110a2bf04f662477c82ec1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_q40Dbn7oS-oB_aWss1Cw.png"/></div></div></figure><p id="e58c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可以试试迭代的次数，你可以看到100次我们甚至都不接近，但是1000次就好多了，10000次我们就快到了:</p><ul class=""><li id="6484" class="lr ls hu it b iu iv iy iz jc lt jg lu jk lv jo lw lx ly lz dt">0.9999 ~ -1</li><li id="2978" class="lr ls hu it b iu ma iy mb jc mc jg md jk me jo lw lx ly lz dt">8.9998 ~ 9</li></ul><p id="fa48" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">关于Jupyter笔记本中的代码，请访问此处:<br/><a class="ae jp" href="https://github.com/kohn1001/tesorflow-playground/blob/master/linear_regression/linear_regression_tensorflow_basic.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/Kohn 1001/tesorflow-playground/blob/master/linear _ regression/linear _ regression _ tensor flow _ basic . ipynb</a></p><figure class="ju jv jw jx fq li"><div class="bz el l di"><div class="mf mg l"/></div></figure></div></div>    
</body>
</html>