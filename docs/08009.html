<html>
<head>
<title>Mocks? Stubs? Or Shims?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模仿？存根？还是垫片？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/mocks-stubs-or-shims-f22164422020?source=collection_archive---------15-----------------------#2018-09-21">https://medium.com/hackernoon/mocks-stubs-or-shims-f22164422020?source=collection_archive---------15-----------------------#2018-09-21</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/1004985ffacec017d0817d08e64f030e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/0*cmbZiyLb6N-AMeV7.jpg"/></div></figure><p id="a431" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果你正在构建比简单的“Hello World”更复杂的东西。“app，有可能你会以依赖()告终。这些依赖关系在任何地方都可能不同，从访问系统资源(你认为“<em class="jw"> Hello World！</em>“真的到了你的屏幕？)、系统中的其他组件、外部资源、外部应用程序等等。更糟糕的是</p><ul class=""><li id="0c92" class="jx jy hu ja b jb jc jf jg jj jz jn ka jr kb jv kc kd ke kf dt translated">依赖关系可能也在开发中</li><li id="a570" class="jx jy hu ja b jb kg jf kh jj ki jn kj jr kk jv kc kd ke kf dt translated">即使它们是稳定的，您也可能没有访问它们所必需的一切(例如，在S3获得的认证框架)</li><li id="db10" class="jx jy hu ja b jb kg jf kh jj ki jn kj jr kk jv kc kd ke kf dt translated">即使这样，您可能想要测试您不能保证的特定响应(它需要总是失败。或者成功。或者基于PRNG随机选择)</li></ul><p id="9ae7" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这就是<em class="jw">嘲讽</em>的用武之地，在这里你实质上假装你与依赖项的交互，这样你就可以在不依赖于你的依赖项的情况下实现<em class="jw">你的</em>东西。<br/>这一切都很好，而且当你认真对待它时，实际上有点直观，有一个警告——当你开始搜索时，你可能会听到术语<em class="jw">模仿</em>、<em class="jw">存根</em>和<em class="jw">垫片</em>在某种程度上互换使用。</p><p id="c52f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我倾向于坚持下面的语义。你可以选择也可以不选择使用这些，但是无论你用什么，一定要确保你和你团队中的其他人都达成一致。此外，为了将来的团队成员，也为了将来的你，把它记录下来！。<br/>(或者见鬼，你可以沿着“<em class="jw">模仿是一种代码味道，#JustSayNo </em>”的方式去存在。只要你对“<em class="jw">嘲弄</em>”的意思有一个一致的定义😆)</p><p id="71c1" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> <em class="jw">模仿</em> </strong>:完全替代依赖，复制你实际给出的大部分或全部行为。这些实际上会变得有些棘手(因此上面的“<em class="jw">代码味道</em>”裂缝)，因为，<em class="jw">在极端情况下</em>，你基本上需要跟踪/复制依赖的功能。话又说回来，如果你<em class="jw">能</em>在适当的地方设置一个好的嘲讽系统，那将是非常有价值的。<br/>然而，关键是你与mock的交互方式与依赖项的交互方式完全相同，通过API、接口、消息或其他方式。</p><figure class="km kn ko kp fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff kl"><img src="../Images/e7e24b7e83a1b2622bddac3b8b4cfd5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Xt1FsSNQtxc34Btd3_4fA.png"/></div></div></figure><p id="6560" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> <em class="jw">存根</em> </strong>:这些是<em class="jw">模仿</em>的极度简化版本，它们通常只返回一组硬编码的值，并且/或者以简单的方式再次失败。如上所示，将stub←→Mocks spectrum想象成一个从最小功能到完整功能的过程。您与存根的交互方式与您与依赖项(API、接口等)的交互方式完全相同。).存根对于测试依赖关系的接口特别有用，因为只是让事情开始(硬编码的响应比没有响应要好！)</p><p id="b2c2" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja hv"> <em class="jw">垫片</em> </strong>:有时你没有能力创建一个<em class="jw">存根</em>或一个<em class="jw">模拟</em>，要么是由于时间限制、复杂性，要么就是缺乏资源。在这些情况下，您可能会滑入一些代码，这些代码的行为基本上就像您在与依赖项进行交互一样。<br/>使用<em class="jw">垫片</em>的关键是你<em class="jw">不要</em>使用接口——API、消息等。—你通常会得到的资源。例如，如果您需要从S3检索某些东西，您只需绕过整个S3界面，只需从本地文件中获取对象。</p><p id="86b5" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">根据我的经验，垫片造成的混乱比我能应付的还要多。它们在你的代码中制造了一些弯路，这些弯路会让你产生一种错误的安全感，或者更糟，让你忘记自己曾经走过的弯路。小心使用它们，并且只在你绝对需要的时候使用(是的，有时候你会这样做！)</p><p id="533e" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">所以你有了它— <em class="jw">模拟</em>对<em class="jw">存根</em>对<em class="jw">垫片</em>！</p><p id="6bd8" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><em class="jw"> ( </em> <a class="ae ku" href="https://dieswaytoofast.blogspot.com/2018/09/mocks-stubs-or-shims.html" rel="noopener ugc nofollow" target="_blank"> <em class="jw">这篇文章也出现在我的博客上</em> </a> <em class="jw"> ) </em></p></div></div>    
</body>
</html>