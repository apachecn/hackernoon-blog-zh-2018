<html>
<head>
<title>Efficient Implementation of MobileNet and YOLO Object Detection Algorithms for Image Annotation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于图像标注的移动网络和YOLO目标检测算法的高效实现</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/efficient-implementation-of-mobilenet-and-yolo-object-detection-algorithms-for-image-annotation-717e867fa27d?source=collection_archive---------1-----------------------#2018-09-26">https://medium.com/hackernoon/efficient-implementation-of-mobilenet-and-yolo-object-detection-algorithms-for-image-annotation-717e867fa27d?source=collection_archive---------1-----------------------#2018-09-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><blockquote class="ir is it"><p id="f41a" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">该问题的目标是实现分类和定位算法，以实现高的对象分类和标记精度，并以尽可能少的数据和时间训练模型。下面的博客考虑了问题的解决方案。</p></blockquote><p id="3abd" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">模型的效率取决于各种参数，包括模型的架构、模型中权重参数的数量、网络已被训练的图像的数量以及可用于实时测试模型的计算能力。第三个参数无法控制，因此我们依赖于前两个参数。因此，迁移学习在这种情况下工作得最好，因为预训练的权重根据我们的数据集进行调整，尽管获得了最小的误差和可靠的准确度。</p><h1 id="d94e" class="jw jx hu bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated"><strong class="ak">型号</strong></h1><p id="89da" class="pw-post-body-paragraph iu iv hu ix b iy ku ja jb jc kv je jf jt kw ji jj ju kx jm jn jv ky jq jr js hn dt kz translated"><span class="l la lb lc bm ld le lf lg lh di"> F </span>对于图像分类，我们使用一个keras模型，通过运行下面的代码<strong class="ix hv">获得模型摘要。</strong>调整模型的参数，以适应尽可能少的数据的最大信息变化。这样，我们就有了批量标准化层，这些层随机调整权重以使模型一般化。</p><h1 id="8ec3" class="jw jx hu bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">实验</h1><p id="747a" class="pw-post-body-paragraph iu iv hu ix b iy ku ja jb jc kv je jf jt kw ji jj ju kx jm jn jv ky jq jr js hn dt translated">我们使用MobileNet模型在数据集上进行训练。该数据集来自黑客地球深度学习挑战，用于对动物进行分类。</p><p id="a23f" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">如果您需要任何其他特定于域的数据集:</p><p id="128d" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">你可以在这里</strong>找到上千个这样的 <a class="ae li" href="https://dataturks.com/projects/trending" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hv">开放数据集</strong> </a> <strong class="ix hv">。</strong></p><p id="579d" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">我们从数据集中随机选择10个类，改变每个类的图像数量和完全连接的层的大小，并报告结果。</p><figure class="lj lk ll lm fq ln"><div class="bz el l di"><div class="lo lp l"/></div></figure><h1 id="ada4" class="jw jx hu bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">结果</h1><p id="904b" class="pw-post-body-paragraph iu iv hu ix b iy ku ja jb jc kv je jf jt kw ji jj ju kx jm jn jv ky jq jr js hn dt translated">这些模型在英特尔i7处理器上运行了15个时期。</p><p id="e49d" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">模型1: Mobilenet : 1000步/时段:较大的FC层:训练时间:18分钟/时段:数据集:50幅图像/平均:精度:82.2% <br/>模型2: Mobilenet: 500步/时段:较小的FC层:训练时间:12分钟/时段:数据集:50幅图像/平均:82.47% <br/>模型3: Mobilnet 500步/时段:较小的FC层:训练时间:11分钟/时段:数据集:每类30幅图像:精度</p><h1 id="afee" class="jw jx hu bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated"><strong class="ak">图像检测:</strong></h1><blockquote class="ir is it"><p id="4d24" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">有一些方法将检测作为一个回归问题。最受欢迎的两个是YOLO和固态硬盘。这些探测器也被称为单触发探测器。让我们来看看它们:</p></blockquote><p id="d06c" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">你只看一次。 <br/> YOLO将每幅图像分成一个S×S的网格，每个网格预测N个边界框和置信度。置信度反映了边界框的准确性以及边界框是否实际包含对象(不考虑类别)。YOLO还预测训练中每个类的每个盒子的分类分数。您可以结合这两个类别来计算每个类别出现在预测框中的概率。</p><p id="1818" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">因此，预测了总SxSxN盒。然而，这些框中的大多数都具有低置信度得分，如果我们设置一个阈值，比如30%的置信度，我们可以删除它们中的大多数，如下例所示。</p><figure class="lj lk ll lm fq ln fe ff paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="fe ff lq"><img src="../Images/0b3e5c8e15165ec3ab7bfc9ae5cc7413.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WgvzAXLxLQAev2cfOqljQw.png"/></div></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek">YOLO predicts one type of class in one grid! Hence small objects are not identified…</figcaption></figure><h1 id="09df" class="jw jx hu bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">单发探测器</h1><p id="eac7" class="pw-post-body-paragraph iu iv hu ix b iy ku ja jb jc kv je jf jt kw ji jj ju kx jm jn jv ky jq jr js hn dt translated">SSD仅对输入图像运行一次卷积网络，并计算特征图。现在，我们在这个特征图上运行一个小的3×3大小的卷积核来预测边界框和分类概率。SSD也使用类似于fast-RCNN的各种纵横比的锚盒，并学习偏移而不是学习盒。为了处理规模，SSD在多个卷积层之后预测边界框。由于每个卷积层在不同的尺度下工作，它能够检测各种尺度的物体。</p><p id="01d8" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">我们比较了两种模型，最初是YOLO(darknet)和后来的固态硬盘，并比较了它们的精度和速度。由于我们的输入是图像，FPS参数不用于区分模型。此外，SSDs是快速RCNN模型和YOLO模型之间的平衡。让我们看看实验告诉了我们什么？</p><p id="51dc" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">在openCV库中Adrian Rosebrock的帮助下，使用dnn模块实现了SSD模型。</p><figure class="lj lk ll lm fq ln"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="e9ec" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">YOLO预训练的重量是从我们选择YOLOv3模型的作者网站下载的。因为它是暗网模型，锚盒与我们数据集中的不同。因此我们最初使用来自<a class="ae li" href="https://github.com/ssaru/convert2Yolo" rel="noopener ugc nofollow" target="_blank">这里</a>的代码将边界框从VOC形式转换成暗网形式。然后我们通过改变配置文件来训练网络。</p><p id="b48b" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">结果:</strong></p><p id="970a" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">SSDs: IOU= 0.74，mAP: 0.83时间/纪元:12分钟<br/> YOLOs: IOU= 0.69，mAP: 0.85时间/纪元:11分钟</p><p id="4b63" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">输出图像</strong></p><figure class="lj lk ll lm fq ln fe ff paragraph-image"><div class="ab fr cl mb"><img src="../Images/8163e78dcef8e3bf6b9a12015caf310f.png" data-original-src="https://miro.medium.com/v2/1*IZf0wajQ75DPsoBkWjwlsA.gif"/></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek">SSDs used for Vehicle Detection</figcaption></figure><figure class="lj lk ll lm fq ln fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/336e1e59d877ce24af530b6cf9008ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*-hncwE_YxO9atENl.png"/></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek">Output with YOLOv3 Pretrained Weights</figcaption></figure><h1 id="3176" class="jw jx hu bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated"><strong class="ak">结论</strong></h1><blockquote class="ir is it"><p id="87df" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">总的问题是我们需要权衡速度和准确性。整体解决方案被提议为用于各种类型图像的两种不同模型。</p></blockquote><p id="f397" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">速度和精度之间的权衡伴随着可用的计算能力。YOLO模型适合精度不是很高的高速输出，而固态硬盘在高速输出时精度更高，计算时间也更长。</p><p id="b619" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">因此，在好的微处理器上选择固态硬盘，否则YOLO将成为基于微处理器的计算的首选。</p><p id="4f7c" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">无耻插件:我们是一个在线工具，可以让你非常容易地建立ML数据集，比如做图像包围盒，NER标记等等。快来看看:最好的 <a class="ae li" href="https://dataturks.com/features/image-bounding-box.php" rel="noopener ugc nofollow" target="_blank"> <em class="iw">图像标注工具</em> </a> <em class="iw">！</em></p></div></div>    
</body>
</html>