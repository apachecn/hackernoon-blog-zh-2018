<html>
<head>
<title>Making the world beautiful with ARCore Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用ARCore Android让世界变得美好</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/making-the-world-beautiful-with-arcore-android-9ddde21f73dd?source=collection_archive---------15-----------------------#2018-10-02">https://medium.com/hackernoon/making-the-world-beautiful-with-arcore-android-9ddde21f73dd?source=collection_archive---------15-----------------------#2018-10-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/18caa727c4a09f8a1aa7d7478822209b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ie39H_VgzLwLnDB68Nu1rw.jpeg"/></div></div></figure><div class=""/><p id="50f4" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt ka translated">如果你对这个世界的现状不满意，你可能会想要改善它。让它更漂亮。而且，在2018年，谷歌和他们的ARCore Android可以帮助你实现这一目标。ARCore是一个用于构建增强现实应用的开发平台。在本文中，我将向您介绍它的功能，以及这项技术本身如何丰富您的日常生活。我还将一步一步地向您展示如何制作自己的ARCore应用程序。</p><h1 id="2cb3" class="kj kk if bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">什么是增强现实？</h1><p id="57b4" class="pw-post-body-paragraph jc jd if je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">你可以说增强现实让你可以用手机创造自己的世界。用技术术语来说，AR使得用计算机生成的3D模型、图像和视频来增强你的现实世界环境成为可能。当你通过手机摄像头看东西时，你会看到/听到作为环境一部分的所有虚拟附加物。当然，前提是你要安装一个必需的AR应用。</p><p id="089c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae lm" href="https://tsh.io/blog/mid-year-review-of-the-2018-tech-trends-is-the-4th-industrial-revolution-here/" rel="noopener ugc nofollow" target="_blank">为什么AR是2018 </a>最热门的技术之一？这可能是因为你有太多的方法可以使用它——唯一的限制是你的想象力。增强现实有可能影响和丰富我们生活的方方面面。请继续阅读，找出方法。</p><h1 id="5d36" class="kj kk if bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">ARCore Android是什么？</h1><p id="c999" class="pw-post-body-paragraph jc jd if je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">因为我的文章关注的是ARCore，所以让我们先来一次简短的回顾。2018年2月23日，谷歌发布ARCore ver。1.0.0.从那以后，Android一直支持增强现实。在第一个版本中，谷歌实现了基本的功能，如:跟踪手机在现实世界中的位置，检测环境平面的大小和位置，以及了解环境的当前照明条件。除了这些功能，ARCore 1.0还引入了定向点，允许您将虚拟对象放置在非水平或非平面纹理表面上。</p><p id="b42e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">2018年4月17日，谷歌发布ARCore Android ver。1.1.0包括:</p><ul class=""><li id="1493" class="ln lo if je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated">用于同步(在同一帧)从相机帧获取图像的API(无需手动将图像缓冲区从GPU复制到CPU)；</li><li id="a42a" class="ln lo if je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">用于获取相机拍摄的图像的色彩校正信息的API。</li></ul><p id="afa2" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">5月8日，我们得到了一个巨大的发布，其中谷歌补充道:</p><ul class=""><li id="cdd7" class="ln lo if je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated">cloud Anchors API使开发人员能够在iOS和Android上构建共享的Google ARCore体验。这是通过允许在一个设备上创建的锚被转换成云锚并与其他设备上的用户共享来实现的；</li><li id="b0c0" class="ln lo if je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">增强图像API，使ARCore应用程序能够检测和跟踪图像；</li><li id="769d" class="ln lo if je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">垂直面检测，这意味着ARCore开始检测水平面和垂直面。</li></ul><p id="a821" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在写这篇文章的时候，谷歌已经发布了ARCore Android版本。1.3.0，支持:</p><ul class=""><li id="9744" class="ln lo if je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated">Frame上的新方法，<em class="mb">getandroidesensorpose()，其中</em>返回Android传感器帧的世界空间姿态)；</li><li id="f54e" class="ln lo if je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">相机上的新方法:<em class="mb"> getImageIntrinsics() </em>返回相机图像的相机内部函数和<em class="mb"> getTextureIntrinsics() </em>返回相机纹理的相机内部函数；</li><li id="c241" class="ln lo if je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">新类别<em class="mb">cameraintrinsic</em>为相机提供不旋转的物理特性，包括其焦距、主焦点和图像尺寸；</li><li id="1f5a" class="ln lo if je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">Session <em class="mb"> getConfig() </em>上的新方法，该方法返回由Session.configure()设置的配置。</li></ul><h1 id="a767" class="kj kk if bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">ARCore Android正在运行</h1><p id="71f6" class="pw-post-body-paragraph jc jd if je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">在上一节中，我介绍了Google ARCore的功能。现在，让我们暂时抛开技术细节，欣赏一下增强现实在视觉上是多么令人印象深刻。你准备好看看如何将它融入你的生活了吗？</p><p id="3058" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">想象外面很美，你要去一个全新的地方骑自行车旅行。你以前从未去过那里，所以，当然，你需要一个向导。有了增强现实，你的手机可以作为一个很好的向导，根据你的位置告诉你去哪里。这里有一个例子:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mg mh l"/></div></figure><p id="661e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者说你刚搬到一个大城市，但你在那里还没有任何朋友，所以你不知道如何去所有有趣的地方。如果你有一个ARCore兼容设备，它会定位附近所有的兴趣点，并实时显示给你。你只需要把手机对准街道。</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mg mh l"/></div></figure><p id="8c26" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当你想装饰你的新家或者买一件与其他家具不冲突的新家具时，ARCore Android也可以帮助你。只要把你的手机指向你想放新东西的地方。</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mg mh l"/></div></figure><p id="b498" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有很多关于如何使用AR的想法和概念。关于这部电影有一些例子:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mg mh l"/></div></figure><h1 id="ff12" class="kj kk if bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">如何制作ARCore应用程序</h1><p id="5d79" class="pw-post-body-paragraph jc jd if je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">在本文的剩余部分，我将教你如何创建一个简单的带有标记和视频的ARCore应用程序。在ARCore中，标记是用户环境中的2D图像，如海报或产品包装。在您的应用程序中，您将使用标记来显示地球的3D模型和用户单击模型后播放的短视频。这将是以后创作更大作品的第一步，例如，你自己的博物馆指南。我们开始工作吧！</p><p id="af69" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您需要从环境配置开始。做起来需要Android Studio和Kotlin的基础知识。下一步是配置您的<strong class="je ig"> build.gradle </strong>。请记住，ARCore的最小sdk版本是24。在您的<strong class="je ig"> build.gradle中，</strong>添加依赖项:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><p id="03da" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在您的<strong class="je ig"> AndroidManifest.xml </strong>中，为摄像机添加权限:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><p id="89b7" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当运行应用程序时，必须确保安装在ARCore支持的设备上。有两种方法:<br/>使用ar fragment——你不需要编写代码来检查你的设备上是否安装了ARCore AndroidARFragment会帮你做的！<br/>编写检查所有ARCore状态的代码<br/> <br/>下面是后者的一个例子:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><p id="d4f3" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">好了，现在您的环境已经启动并运行，您可以开始构建应用程序了。正如我之前提到的，它将向您展示ARCore的一小部分功能。<br/> <br/>我决定使用流行的标记(2D图片)。在ARCore Android中，它们被称为增强图像。首先，你需要添加图像，你的应用程序将识别这些图像，并在屏幕上显示为3D模型。您还需要安装一个场景插件，以便轻松导入sceneform资产。这可以通过以下方式完成:</p><ul class=""><li id="d14c" class="ln lo if je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated">id Studio -&gt;首选项-&gt;插件，</li><li id="8f36" class="ln lo if je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">选择浏览存储库… -&gt;搜索Google Sceneform工具，</li><li id="3c2b" class="ln lo if je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">单击安装。</li></ul><p id="fd3e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，您已经具备了将3D模型导入到项目中的一切条件。是时候找些模特了！你可以从这个<a class="ae lm" href="https://poly.google.com/" rel="noopener ugc nofollow" target="_blank">网站</a>开始。记住模特应该是OBJ，FBX或者glTF。有关将3D模型导入ARCore应用程序的更多信息，请访问此<a class="ae lm" href="https://developers.google.com/ar/develop/java/sceneform/import-assets" rel="noopener ugc nofollow" target="_blank">网站。</a> <a class="ae lm" href="https://developers.google.com/ar/develop/java/sceneform/import-assets" rel="noopener ugc nofollow" target="_blank"> <br/> <br/> </a>太棒了！你已将模型导入我们的应用程序。现在，让我们找点乐子吧！在应用程序包中的项目内创建一个资产文件夹。您将在那里保存标记和视频的图像。记住只使用。jpg和。png图像文件。<br/> <br/>有了资产文件夹中的图像和视频加上导入的模型，终于可以开始编码了。首先，您需要创建一个将图像作为标记从资源加载到位图的方法:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><p id="bf0d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在我的例子中，我使用了一个来自google samples for ARCore Android的图像，但是您可以选择任何您想要的图像。现在，您需要添加一个数据库来存储标记的所有图像，以便进行识别。为此，请添加:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><p id="d8df" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如您所见，您已经构建了AugmentedImageDatabase，并使用前面的方法添加了一个图像。之后，就该配置会话了:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><p id="1e7c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">应该在onResume()方法中调用此方法。<br/> <br/>至此，您已经创建了从资产导入图像以及将它们添加到数据库和会话配置的方法。剩下要实现的唯一事情是在扫描标记之后显示3D模型。小菜一碟！首先创建一个更新方法，您将使用它来更新显示的模型:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><p id="82ca" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后一步是在表面视图的更新监听器中添加这个方法:</p><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><p id="d831" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就是这样！尝试扫描图像，你应该会在屏幕上看到地球的3D模型(或者你选择的任何图像)。</p><figure class="mc md me mf fq hw fe ff paragraph-image"><div class="fe ff mj"><img src="../Images/a85a53f073d1b0f41d459917332148f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*FkyvfgIIhlRYKq5jla2n8w.png"/></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek"><em class="mo">Thanks to ARCore, you can see a 3D model of the Earth on a smartphone screen</em></figcaption></figure><h1 id="ae9f" class="kj kk if bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">如何在ARCore Android中添加视频</h1><p id="0b0c" class="pw-post-body-paragraph jc jd if je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">您的ARCore应用程序现在允许您导入图像和3D模型，将它们添加到数据库中，并在扫描标记后显示3D模型。但是还缺少一个东西——显示和播放视频。ARCore不支持直接播放视频。要实现它，你需要使用OpenGL。我在这里使用了<a class="ae lm" href="https://gist.github.com/BALUSANGEM/47dc82fb4542bacbb35960510580e1a6" rel="noopener ugc nofollow" target="_blank">中的代码。</a> <br/> <a class="ae lm" href="https://gist.github.com/BALUSANGEM/47dc82fb4542bacbb35960510580e1a6" rel="noopener ugc nofollow" target="_blank"> <br/> </a>这正是我们想要的。如果您从gist创建一个类，剩下唯一要做的事情就是在您的<strong class="je ig"> MainActivity.class: </strong>中添加一些代码</p><ul class=""><li id="5626" class="ln lo if je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated">步骤1 —您需要扩展GLSurfaceView。渲染器，</li><li id="d3a0" class="ln lo if je b jf lw jj lx jn ly jr lz jv ma jz ls lt lu lv dt translated">步骤2 —在MainActivity的布局中，添加:</li></ul><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><ul class=""><li id="4d89" class="ln lo if je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated">步骤3 —在onCreate方法中，添加:</li></ul><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><ul class=""><li id="5f9d" class="ln lo if je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated">步骤4 —添加用于绘制视频帧的代码:</li></ul><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><ul class=""><li id="57bd" class="ln lo if je b jf jg jj jk jn lp jr lq jv lr jz ls lt lu lv dt translated">最后一步-在onUpdateFrame方法中为3D模型添加一个点击监听器:</li></ul><figure class="mc md me mf fq hw"><div class="bz el l di"><div class="mi mh l"/></div></figure><p id="bf85" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就是这样！你可以在这里找到MainActivity <a class="ae lm" href="https://gist.github.com/edi233/cd24f60dfbb210e29cffb09fa17685c1" rel="noopener ugc nofollow" target="_blank">的完整代码。</a></p><p id="0851" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在应用了所有前面的步骤之后，您应该得到类似这样的结果:</p><div class="ht hu fm fo hv mp"><a href="https://streamable.com/s/49jny/kkdsaj" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd ig fv z el mu eo ep mv er et ie dt translated">mobizen_20180808_131833 -可流式传输</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">编辑描述</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">streamable.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd ib mp"/></div></div></a></div><p id="af0f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">恭喜你！您刚刚创建了一个可以显示3D模型的应用程序，在您点击它之后，会向您显示一个视频！使用ARCore Android可以做的事情令人惊叹</p><h1 id="31d1" class="kj kk if bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">摘要</h1><p id="61ae" class="pw-post-body-paragraph jc jd if je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">如你所见，用增强现实创造一个更美好的世界非常简单。谷歌ARCore让你可以自由地制造几乎任何你想要的东西。为什么差不多？这项技术仍然非常年轻——具有惊人的潜力，但没有我们需要的许多功能。谷歌开发人员正在逐渐增加新功能和修复漏洞，但还有很多工作要做。尽管有这么多缺陷和缺失的功能，ARCore Android还是值得熟悉的。至少，我是这么认为的。</p></div><div class="ab cl ne nf hc ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="hn ho hp hq hr"><h2 id="1502" class="nl kk if bd kl nm nn no kp np nq nr kt jn ns nt kx jr nu nv lb jv nw nx lf ny dt translated">手稿后</h2><p id="9623" class="pw-post-body-paragraph jc jd if je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">在我的项目中，我使用了一篇名为<a class="ae lm" rel="noopener" href="/nosort/playing-video-in-arcore-using-openggl-a81ff62f7a6d">使用OpenGL在ARCore中播放视频</a>的文章中的信息。我还使用了Google ARCore示例中的一些代码。你可以在这里找到这个项目<a class="ae lm" href="https://github.com/edi233/ARCoreVideo.git" rel="noopener ugc nofollow" target="_blank">的所有代码。</a></p></div><div class="ab cl ne nf hc ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="hn ho hp hq hr"><p id="6e0e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">这篇文章由ukasz Juszczyk撰写，最初发表在软件之家博客</strong><a class="ae lm" href="http://www.tsh.io/blog" rel="noopener ugc nofollow" target="_blank"><strong class="je ig"/></a><strong class="je ig">上。访问博客，获得更多关于最佳开发实践和软件外包技巧的文章。</strong></p></div></div>    
</body>
</html>