<html>
<head>
<title>3 Min Hack for Locally building a Native Extension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">3分钟黑客本地构建一个本地扩展</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/3-min-hack-for-locally-building-a-native-extension-serverless-technologies-5f86d613bef1?source=collection_archive---------21-----------------------#2018-10-02">https://medium.com/hackernoon/3-min-hack-for-locally-building-a-native-extension-serverless-technologies-5f86d613bef1?source=collection_archive---------21-----------------------#2018-10-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><h2 id="d19b" class="hs ht hu bd b gc hv hw hx hy hz ia ek ib translated" aria-label="kicker paragraph">无服务器技术</h2><div class=""/><figure class="fi fk jb jc jd je fe ff paragraph-image"><div role="button" tabindex="0" class="jf jg di jh bf ji"><div class="fe ff ja"><img src="../Images/63cd862f397579a7ac6c353cc8e7b98e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yF3LN4YQYMjWk0cd.jpg"/></div></div><figcaption class="jl jm fg fe ff jn jo bd b be z ek">illustration/Ortal Avraham</figcaption></figure><p id="44da" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">无服务器是软件架构领域的热点。许多供应商致力于无服务器，当然，亚马逊、谷歌、IBM和微软也在这方面投入了大量资金。但是像其他热门技术一样，它也有一些缺点。</p><p id="eeab" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在这篇文章中，我分享了一个非常方便的技巧，可以帮助你构建一个本地扩展。</p><p id="2eab" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">需要是发明之母，我们的黑客也不例外。从单片到无服务器，Rookout有助于跨平台的生产调试，但我们的许多客户已经在更广泛地使用无服务器，他们促使我们更深入地研究这项技术。</p><p id="116d" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">对Python和Node的Rookout支持依赖于本机扩展来实现它的魔力。如果您已经读到这里，您可能知道在Lambda和其他无服务器技术上运行本机扩展需要您将正确的二进制文件预打包到函数zip文件中。由于<a class="ae kn" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a>运行在亚马逊Linux上，如果你运行在Windows、Mac或Debian Linux上，这可能会很痛苦。</p><p id="cf81" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">亚马逊<a class="ae kn" href="https://aws.amazon.com/blogs/compute/nodejs-packages-in-lambda/" rel="noopener ugc nofollow" target="_blank">为Lambda构建本地扩展的方法</a>将它们构建在专用的EC2实例上，这远不是最愉快的体验。我们的许多客户要求我们帮助他们从任何操作系统中构建和部署Lambda功能。</p><p id="fb39" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在头脑风暴会议之后，我们的一些工程师带回来一个漂亮的小技巧，我很高兴与你分享。结果是，<a class="ae kn" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>可以轻松地执行一个本地任务，就好像它在我们自己的计算机上运行一样。以下命令行摘自官方Docker <a class="ae kn" href="https://docs.docker.com/engine/reference/commandline/run/#mount-volume--v---read-only" rel="noopener ugc nofollow" target="_blank">指南</a>，允许您在当前文件夹中运行Docker命令:</p><p id="f6f8" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在当前目录中运行Docker</p><p id="e09b" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">$ docker run-v ` pwd `: ` pwd `- w ` pwd `- I-t Ubuntu pwd</em></p><p id="529f" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">要让Docker容器模拟AWS Lambda环境，我们只需看看LambCI项目。要构建AWS Lambda兼容的本机扩展，只需运行以下命令行:</p><p id="41e7" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">节点:</p><p id="e47c" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">使用Docker构建节点依赖关系:</p><p id="b1f8" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">docker run-v ` pwd `: ` pwd `- w ` pwd `- I-tλci/lambda:build-nodejs 8.10 NPM安装</em></p><p id="47de" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Python:</p><p id="60b7" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">用Docker构建Python依赖关系:</p><p id="62a6" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">docker run-v ` pwd `: ` pwd `- w ` pwd `- I-tλci/lambda:build-python 2.7 pip install-r requirements . txt</em></p><p id="f19d" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我们可以通过使用脚本隐藏使用Docker构建扩展的本质细节来做得更好。例如，让我们看看这个package.json文件，它允许您动态构建扩展:</p><p id="042e" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">使用docker的package.json文件</p><p id="5b7c" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko"> { </em></p><p id="70f2" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">【姓名】:【举例】，</em></p><p id="432d" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko"> "main": "index.js "，</em></p><p id="100c" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">“依赖关系”:{ }，</em></p><p id="7573" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">【脚本】:{ </em></p><p id="efa2" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">“安装模块”:“docker run-it-v ` pwd `: ` pwd `- w ` pwd ` node:6 NPM install”，</em></p><p id="7e3d" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">" build-package ":" zip-r package . zip * "，</em></p><p id="f84d" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">“构建”:“npm运行安装-模块&amp; &amp; npm运行构建-打包”</em></p><p id="4c72" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko"> } </em></p><p id="e3ca" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko"> } </em></p><p id="c13b" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">要构建，只需运行:</p><p id="3d9e" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">国家预防机制运行建立</em></p><p id="b07b" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">在开发Lambda函数时，我们的团队和我们的客户都发现这种方法非常有帮助，可以节省时间。希望你也觉得有用。</p></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><p id="79db" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><em class="ko">撰稿:Liran Haimovitch。最初发表于</em><a class="ae kn" href="https://www.rookout.com/3_min_hack_for_building_local_native_extensions/" rel="noopener ugc nofollow" target="_blank"><em class="ko">www.rookout.com</em></a><em class="ko">。</em></p></div></div>    
</body>
</html>