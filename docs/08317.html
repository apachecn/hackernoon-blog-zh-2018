<html>
<head>
<title>How to build a fun social media on limited time and budget</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•åœ¨æœ‰é™çš„æ—¶é—´å’Œé¢„ç®—ä¸‹å»ºç«‹ä¸€ä¸ªæœ‰è¶£çš„ç¤¾äº¤åª’ä½“</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/how-to-build-a-fun-social-media-on-limited-time-and-budget-c28c84ba93db?source=collection_archive---------19-----------------------#2018-10-03">https://medium.com/hackernoon/how-to-build-a-fun-social-media-on-limited-time-and-budget-c28c84ba93db?source=collection_archive---------19-----------------------#2018-10-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="48a5" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">ä½ å¯¹ç¤¾äº¤åª’ä½“æœ‰ä¸€äº›æ–°é¢–æœ‰è¶£çš„æƒ³æ³•ã€‚ä½ æƒ³è¦ä¸€æ¬¾å®‰å…¨ã€æ™ºèƒ½ã€å¿«é€Ÿä¸”å¯æ‰©å±•çš„åº”ç”¨ã€‚<br/>è¿™å°±æ˜¯ä½ å¦‚ä½•åœ¨æœ‰é™çš„æ—¶é—´å’Œé¢„ç®—å†…å®ç°è¿™ä¸€ç›®æ ‡çš„æ–¹æ³•ã€‚</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/eae1b5fdfe9d9ba17fb488a25d188594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xmjxJl4e89aFYBGA1V8xTQ.jpeg"/></div></div></figure><blockquote class="jv jw jx"><p id="09f4" class="jy jz ka kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è¿™ç¯‡æ–‡ç« åŸºäºä¸ªäººç»éªŒå’Œæ•°å°æ—¶çš„ç ”ç©¶ã€‚å®ƒå°†ä¸»è¦åŒ…å«ä»£ç ç¤ºä¾‹ã€‚</p></blockquote></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><p id="485c" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated"><strong class="kb hv">é…æ–™:</strong><br/><a class="ae lf" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">node . js</a><br/><a class="ae lf" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">GCP</a>â€”å¯æ‰©å±•æœåŠ¡å™¨å’Œé¢å¤–å·¥å…·<br/> <a class="ae lf" href="https://firebase.google.com/?" rel="noopener ugc nofollow" target="_blank"> Firebase </a> â€”å®æ—¶æ•°æ®åº“<br/> <a class="ae lf" href="https://www.cloudflare.com/" rel="noopener ugc nofollow" target="_blank"> Cloudflare </a> â€”å®‰å…¨å’Œæ€§èƒ½<br/> <a class="ae lf" href="https://www.mailgun.com/" rel="noopener ugc nofollow" target="_blank"> Mailgun </a> â€”ç”µå­é‚®ä»¶</p><p id="2cf8" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåº”ç”¨å¼•æ“ï¼Œå¹¶å°†å…¶åˆ†æˆ3ä¸ªå¾®æœåŠ¡<br/>ç¬¬ä¸€ä¸ªå¾®æœåŠ¡â€”åç«¯æœåŠ¡å™¨<br/>ç¬¬äºŒä¸ªå¾®æœåŠ¡â€” CronæœåŠ¡å™¨<br/>ç¬¬ä¸‰ä¸ªå¾®æœåŠ¡â€” WebæœåŠ¡å™¨</p></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><blockquote class="jv jw jx"><p id="f1a1" class="jy jz ka kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘å°†ä¸ºå®¢æˆ·ç«¯ä½¿ç”¨<a class="ae lf" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>ã€‚<br/>åç«¯è§£å†³æ–¹æ¡ˆå¯¹å…¶ä»–å®¢æˆ·ç«¯é€‰é¡¹æ¥è¯´ä¹Ÿå¾ˆå¥½ã€‚</p></blockquote></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><p id="303b" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated"><strong class="kb hv"> <em class="ka">ä¹‹å‰å…ˆå†™ç¬¬ä¸€è¡Œä»£ç </em> </strong></p><p id="7ff9" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ä½ éœ€è¦ä¸ºç¬¬ä¸€æ¬¡å‘å¸ƒè®¾å®šä½ çš„ç›®æ ‡ã€‚å†³å®šä»€ä¹ˆæ˜¯ç¬¬ä¸€ä¸ªç‰ˆæœ¬å¿…é¡»çš„ï¼Œä»€ä¹ˆæ˜¯ä½ å¯ä»¥æ·»åŠ çš„ï¼Œè¿™å¾ˆé‡è¦ã€‚</p><p id="9afd" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ä¸ºä½ çš„ç¤¾äº¤åª’ä½“åº”ç”¨ç¨‹åºé€‰æ‹©ä¸€ä¸ªåç§°ã€‚<br/>æ£€æŸ¥åŸŸåæ˜¯å¦å¯ç”¨ã€‚<br/> <em class="ka">ä½ å¯ä»¥ç”¨</em> <a class="ae lf" href="https://domains.google/#/" rel="noopener ugc nofollow" target="_blank"> <em class="ka">è°·æ­ŒåŸŸå</em> </a> <em class="ka">æˆ–è€…</em><a class="ae lf" href="https://www.godaddy.com/" rel="noopener ugc nofollow" target="_blank"><em class="ka">go daddy</em></a><em class="ka">æ¥åšè¿™ä¸ªã€‚</em></p><p id="e0a6" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">åœ¨GCPã€Firebase Cloudflareå’ŒMailgunå¼€è®¾è´¦æˆ·å¹¶åˆ›å»ºæ–°é¡¹ç›®ã€‚</p><p id="49a0" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">åœ¨è„¸ä¹¦å’ŒInstagramä¸Šæ‰“å¼€å¼€å‘è€…è´¦æˆ·ï¼Œå¯ç”¨ç™»å½•é€‰é¡¹ã€‚(ç¡®ä¿æ‚¨å‘é€çš„æ˜¯å®¡æ ¸è¯·æ±‚ï¼Œè¿™å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´)ã€‚</p></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><h1 id="173e" class="lg lh hu bd li lj lk ll lm ln lo lp lq ja lr jb ls jd lt je lu jg lv jh lw lx dt translated">åç«¯APIæœåŠ¡å™¨</h1><h2 id="e9cd" class="ly lh hu bd li lz ma mb lm mc md me lq lc mf mg ls ld mh mi lu le mj mk lw ml dt translated">ç›®æ ‡:</h2><p id="e7d1" class="pw-post-body-paragraph jy jz hu kb b kc mm iv ke kf mn iy kh lc mo kk kl ld mp ko kp le mq ks kt ku hn dt translated">å®¢æˆ·ç«¯å‹å¥½<br/>å®‰å…¨æ€§<br/>è‡ªåŠ¨æ‰©å±•<br/>æ˜“äºç»´æŠ¤<br/>ä¿ç•™æ—¥å¿—<br/>å®æ—¶æŠ¥å‘Šé”™è¯¯</p><p id="c7d2" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">æ˜¯çš„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¼ ç»Ÿçš„RESTful APIæœåŠ¡å™¨æ¥å®ç°è¿™äº›ç›®æ ‡ï¼Œä½†æ˜¯ï¼Œæˆ‘æƒ³å‘æ‚¨å±•ç¤ºå¦ä¸€ä¸ªå¯ä»¥èŠ‚çœæ‚¨å¤§é‡æ—¶é—´çš„æ›¿ä»£æ–¹æ¡ˆã€‚</p><p id="b897" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">æˆ‘ä»¬å°†ä½¿ç”¨<a class="ae lf" href="https://github.com/FirebaseExtended/firebase-queue" rel="noopener ugc nofollow" target="_blank"> Firebaseé˜Ÿåˆ—</a>ï¼ŒFirebaseå®æ—¶æ•°æ®åº“å’Œè°·æ­Œåº”ç”¨å¼•æ“æ¥åˆ›å»ºå®ƒã€‚</p><blockquote class="jv jw jx"><p id="7810" class="jy jz ka kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è¿™å°†æ˜¯æˆ‘çš„æ–‡ä»¶å¤¹å±‚æ¬¡ç»“æ„ã€‚</p></blockquote><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="3e9f" class="ly lh hu ms b fv mw mx l my mz">ğŸ“config<br/>  ğŸ“keys<br/>    â¥serviceAccountKey.json<br/>  configuration.json<br/>  index.js</span><span id="5e10" class="ly lh hu ms b fv na mx l my mz">ğŸ“services<br/>  ğŸ“firebase<br/>    â¥index.js<br/>  ğŸ“image_manipulation<br/>    â¥index.js<br/>  ğŸ“notifications<br/>    â¥index.js</span><span id="30b9" class="ly lh hu ms b fv na mx l my mz">ğŸ“utils<br/>  â¥index.js</span><span id="bfdb" class="ly lh hu ms b fv na mx l my mz">app.js<br/>app.yaml<br/>package.json</span></pre><p id="e6ab" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">èŠ‚ç‚¹ä¾èµ–å…³ç³»:</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="efae" class="ly lh hu ms b fv mw mx l my mz">"fcm-node": "^1.0.15",<br/>"firebase": "^5.4.0",<br/>"firebase-admin": "^6.0.0",<br/>"firebase-queue": "^1.6.1",<br/>"mailgun-js": "^0.20.0"</span></pre><p id="b110" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">å›¾åƒå¤„ç†ä¾èµ–å…³ç³»:</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="940f" class="ly lh hu ms b fv mw mx l my mz">"@google-cloud/storage": "^1.5.1",<br/>"@google-cloud/vision": "^0.14.0",<br/>"image-size": "^0.6.2",<br/>"imagemin": "^5.3.1",<br/>"imagemin-giflossy": "^5.1.10",<br/>"imagemin-jpeg-recompress": "^5.1.0",<br/>"sharp": "^0.18.4",<br/>"smartcrop": "^1.1.1",<br/>"smartcrop-sharp": "^1.0.5"</span></pre></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><p id="f17d" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">è®©æˆ‘ä»¬ä»config/configuration.jsonå¼€å§‹:</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="733c" class="ly lh hu ms b fv mw mx l my mz">{<br/>  "firebase": {<br/>    "projectId": "YOUT_PROJECT_ID",<br/>    "url": "YOUT_PROJECT_DB_URL",<br/>    "serviceAccount": "config/keys/serviceAccountKey.json"<br/>  },<br/>  "mailgun": {<br/>    "apiKey": "YOUT_MAILGUN_KEY",<br/>    "domain": "YOUT_MAILGUN_DOMAIN"<br/>  },<br/>  "app": {</span></pre><p id="344e" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">config/index.js(æ³¨æ„æœ‰configuration.dev.json)</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="cf45" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">const </strong>config = process.env.NODE_ENV === 'production' <br/>? require('config/configuration.json') <br/>: require('config/configuration.dev.json');<br/><br/>module.exports = config;</span></pre><p id="b56e" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">app.yaml</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="afcc" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">service</strong>: api<br/><strong class="ms hv">runtime</strong>: nodejs<br/><strong class="ms hv">env</strong>: flex<br/><strong class="ms hv">env_variables</strong>:<br/>  <strong class="ms hv">NODE_ENV</strong>: prod</span></pre><p id="b22e" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">services/firebase/index.js</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="66d2" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">const </strong>admin = require('firebase-admin');<br/><strong class="ms hv">const </strong>config  = require('config');<br/><br/>admin.initializeApp({<br/>    credential: admin.credential.cert(require(config.firebase.serviceAccount)),<br/>    databaseURL: config.firebase.url<br/>});<br/><br/><strong class="ms hv">const </strong>db = admin.firestore();<br/><strong class="ms hv">const </strong>tasksDB = admin.database();<br/><strong class="ms hv">const </strong>tasksQueue = tasksDB.ref('tasks_queue/');<br/><br/>db.settings({ timestampsInSnapshots: <strong class="ms hv">true </strong>});</span><span id="c3ae" class="ly lh hu ms b fv na mx l my mz">// Here we will write our db functions</span><span id="8aee" class="ly lh hu ms b fv na mx l my mz">module.exports = {<br/>    tasksQueue</span></pre></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><p id="4553" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹ç¼–å†™æˆ‘ä»¬çš„æœåŠ¡å™¨(<strong class="kb hv"> app.js) </strong></p><blockquote class="jv jw jx"><p id="4aad" class="jy jz ka kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘å–œæ¬¢è¿™æ ·è®¾ç½®require()è·¯å¾„:(ä½ å¯ä»¥åœ¨è¿™é‡Œ<a class="ae lf" href="https://gist.github.com/branneman/8048520" rel="noopener ugc nofollow" target="_blank">äº†è§£æ›´å¤šä¿¡æ¯</a></p></blockquote><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="2827" class="ly lh hu ms b fv mw mx l my mz">process.env.NODE_PATH = __dirname;<br/>require('module').<em class="ka">Module</em>._initPaths();</span></pre><p id="365b" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">æˆ‘ä»¬å°†ä»è®¾ç½®å¼€å§‹ï¼Œæ·»åŠ ä¸‰ä¸ªç®€å•çš„â€œä»»åŠ¡â€<strong class="kb hv"> <em class="ka"> saveUserã€updateUser </em> </strong>å’Œ<strong class="kb hv"> <em class="ka"> likePost </em> </strong>ã€‚</p><p id="a8db" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated"><strong class="kb hv"> <em class="ka"> addLogs </em> </strong>å‡½æ•°ä¼šå°†æ”¶åˆ°çš„ä»»åŠ¡ä¿å­˜åˆ°æˆ‘ä»¬åœ¨Firebaseçš„æ—¥å¿—è¡¨ä¸­ã€‚</p><p id="2f69" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated"><strong class="kb hv"> <em class="ka"> mailError </em> </strong>åœ¨å‡ºç°é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œä¼šå°†ä»»åŠ¡æ•°æ®å’Œé”™è¯¯ä¿¡æ¯ä¸€èµ·é€šè¿‡ç”µå­é‚®ä»¶å‘é€å‡ºå»ã€‚</p><p id="2859" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">è€Œ<strong class="kb hv"> <em class="ka"> processTask </em> </strong>å°†ç›‘å¬Firebaseså®æ—¶æ•°æ®åº“ä¸Šçš„<em class="ka"> tasks_queue </em>è¡¨ï¼Œæ¯å½“æœ‰æ–°ä»»åŠ¡å†™å…¥è¯¥è¡¨æ—¶ï¼Œå®ƒå°†æ ¹æ®å…¶ç±»å‹å¤„ç†è¯¥ä»»åŠ¡ã€‚å¦‚æœæœ‰æ¯”ä»–èƒ½å¤„ç†çš„æ›´å¤šçš„ä»»åŠ¡ï¼Œåº”ç”¨å¼•æ“å°†è‡ªåŠ¨ç¼©æ”¾ã€‚</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="3347" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬éœ€è¦å‘Firebaseç«¯ç‚¹æ–‡ä»¶æ·»åŠ ä¸€äº›åŠŸèƒ½</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="d53b" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">function </strong>setData(ref, data){<br/>    <strong class="ms hv">if </strong>(<strong class="ms hv">typeof </strong>ref === 'string') <strong class="ms hv">return </strong>db.doc(ref).set(data);<br/>    <strong class="ms hv">return </strong>ref.set(data);<br/>}</span><span id="6855" class="ly lh hu ms b fv na mx l my mz"><strong class="ms hv">function </strong>updateData(ref, data){<br/>    <strong class="ms hv">if </strong>(<strong class="ms hv">typeof </strong>ref === 'string') <strong class="ms hv">return </strong>db.doc(ref).update(data);<br/>    <strong class="ms hv">return </strong>ref.update(data)</span><span id="70a9" class="ly lh hu ms b fv na mx l my mz">ateLogs(date, taskType, time, task) {<br/>    tasksDB.ref(`logs/${date}/${taskType}/${time}/task`).set(task)</span><span id="f49a" class="ly lh hu ms b fv na mx l my mz"><strong class="ms hv">ion </strong>likePost(postId){<br/>    <strong class="ms hv">return new </strong>Promise((resolve, reject) =&gt; {<br/>        <strong class="ms hv">const </strong>postRef = db.collection('posts').doc(postId);<br/>        <strong class="ms hv">return </strong>db.runTransaction((transaction) =&gt; {<br/>            <strong class="ms hv">return </strong>transaction.get(postRef).then((postDoc) =&gt; {<br/>                <strong class="ms hv">if </strong>(!postDoc.exists) resolve();<br/>                <strong class="ms hv">const </strong>newLikes = postDoc.data().likes + 1;<br/>                transaction.update(postRef, { likes: newLikes });<br/>            });<br/>        }).then(resolve).catch(reject);<br/>    });<br/>}</span><span id="a937" class="ly lh hu ms b fv na mx l my mz">// Don't forget to add them to the module exports</span></pre><p id="0392" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">â€œä»»åŠ¡â€è¡¨çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nd"><img src="../Images/d516798695bb29f4490d55e8d38a9f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qAaSJVWs4fe7UZzBeBroyQ.png"/></div></div></figure></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><p id="fea3" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">å¦ä¸€ä»¶æˆ‘ä»¬å¯èƒ½æƒ³æ·»åŠ åˆ°æœåŠ¡å™¨çš„äº‹æƒ…æ˜¯å›¾åƒå¤„ç†ã€‚æ¯”æ–¹è¯´ï¼Œä¸€ä¸ªç”¨æˆ·ä¸Šä¼ äº†ä¸€å¼ ç…§ç‰‡åˆ°æˆ‘ä»¬æœ‰è¶£çš„ç¤¾äº¤åª’ä½“ä¸Šï¼Œæˆ‘ä»¬éœ€è¦å‹ç¼©è¿™å¼ ç…§ç‰‡ï¼Œå¦‚æœå®ƒæ˜¯å†’çŠ¯æ€§çš„ï¼Œå¯èƒ½ä¼šæé†’æˆ‘ä»¬ï¼Œæˆ‘ä»¬ç”šè‡³æƒ³ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªæ™ºèƒ½ç¼©ç•¥å›¾ã€‚</p><p id="49df" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">æˆ‘ä»¬å°†æ·»åŠ ä»»åŠ¡æ¥å¤„ç†è¯¥è¯·æ±‚</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="27a2" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹services/image _ manipulation/index . js(æˆ‘ä¸ä¼šè¯¦ç»†è®¨è®ºè¿™ä¸ª)</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><h2 id="5388" class="ly lh hu bd li lz ma mb lm mc md me lq lc mf mg ls ld mh mi lu le mj mk lw ml dt translated">é€šçŸ¥</h2><p id="1e8c" class="pw-post-body-paragraph jy jz hu kb b kc mm iv ke kf mn iy kh lc mo kk kl ld mp ko kp le mq ks kt ku hn dt translated">æˆ‘ä»¬æœ€æœ‰ä»·å€¼çš„ä¿ç•™å·¥å…·ã€‚</p><p id="d339" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ä¾‹å¦‚ï¼Œå¦‚æœæœ‰äººå–œæ¬¢ä»–ä»¬çš„å¸–å­ï¼Œæˆ‘ä»¬éœ€è¦é€šçŸ¥ç”¨æˆ·ã€‚æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿè·¨å¹³å°ã€Androidã€iOSå’Œwebå‘ç”¨æˆ·å‘é€æ¶ˆæ¯å’Œé€šçŸ¥ã€‚</p><p id="1f10" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ä¸€ä»¶å¥½äº‹ä¹Ÿå°†ä¿å­˜åœ¨æˆ‘ä»¬çš„æ•°æ®åº“ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ˜¾ç¤ºåº”ç”¨ç¨‹åºå†…çš„æ‰€æœ‰é€šçŸ¥ã€‚</p><p id="e5a4" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">è®©æˆ‘ä»¬æ”¹å˜æˆ‘ä»¬çš„like_postå‡½æ•°</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="9b2a" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">function </strong>likePost(data = {}) {<br/>    <strong class="ms hv">return new </strong>Promise((resolve, reject) =&gt; {<br/>        <strong class="ms hv">const </strong>{ user, postId, postOwner, } = data;<br/>        Promise.all([<br/>            db.likePost(postId),<br/>            db.newNotification('like', user, postOwner),<br/>        ]).then(resolve).catch(reject);<br/>    });<br/>}</span></pre><p id="b26f" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">å¹¶å°†<strong class="kb hv"><em class="ka">new notification</em></strong>æ·»åŠ åˆ°æˆ‘ä»¬çš„Firebaseç«¯ç‚¹æ–‡ä»¶ä¸­</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="63a1" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">const </strong>fcm = require('services/notifications');<br/><strong class="ms hv">const </strong>notificationsText = require('texts/en/notifications');<br/><br/><strong class="ms hv">function </strong>newNotification(tag, from, to) {<br/>    <strong class="ms hv">return new </strong>Promise((resolve, reject) =&gt; {<br/>        <strong class="ms hv">const </strong>notification = notificationsText(tag, from, to);<br/>        <strong class="ms hv">if </strong>(to.deviceToken) fcm.sendNativeNotification(notification, deviceToken);<br/>        <strong class="ms hv">const </strong>newNotificationRef = db.collection(`messages/${to.uid}/notification`).doc();<br/>        newNotificationRef.set(notification).then(resolve).catch(reject);<br/>    });<br/>}</span></pre><p id="f2aa" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">æœåŠ¡/é€šçŸ¥/ç´¢å¼•. js</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><p id="77eb" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ç°åœ¨ä½ å·²ç»æœ‰äº†APIæœåŠ¡å™¨ï¼Œå®ƒå®Œå…¨æ»¡è¶³äº†ä½ çš„å¼•å¯¼éœ€æ±‚(ä½ ä»ç„¶éœ€è¦ç¼–å†™ä¸€äº›å‡½æ•°æ¥å¤„ç†ä½ çš„å®¢æˆ·ç«¯ä»»åŠ¡)ã€‚</p><p id="25dc" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated"><a class="ae lf" href="https://hackernoon.com/tagged/security" rel="noopener ugc nofollow" target="_blank">å®‰å…¨</a>è§„åˆ™å¯ä»¥é€šè¿‡<a class="ae lf" href="https://hackernoon.com/tagged/firebase" rel="noopener ugc nofollow" target="_blank"> Firebase </a>æ§åˆ¶å°ä¸Šçš„è§„åˆ™é€‰é¡¹å¡è½»æ¾è®¾ç½®ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äºå®ƒçš„<a class="ae lf" href="https://firebase.google.com/docs/database/security/" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><h1 id="66ec" class="lg lh hu bd li lj ne ll lm ln nf lp lq ja ng jb ls jd nh je lu jg ni jh lw lx dt translated">CronæœåŠ¡å™¨</h1><p id="e33e" class="pw-post-body-paragraph jy jz hu kb b kc mm iv ke kf mn iy kh lc mo kk kl ld mp ko kp le mq ks kt ku hn dt translated">å¦‚æœæˆ‘ä»¬éœ€è¦ä¸€äº›è°ƒåº¦åŠŸèƒ½åœ¨åå°è¿è¡Œã€‚æˆ‘ä»¬å°†é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°è¿™ä¸€ç›®æ ‡:</p><p id="fd64" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated"><em class="ka">åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„è°ƒåº¦å‡½æ•°å°†åƒä¸€ä¸ªéšæœºå‘å¸ƒ</em></p><p id="ebcb" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">æ–‡ä»¶å¤¹å±‚æ¬¡ç»“æ„</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="d987" class="ly lh hu ms b fv mw mx l my mz">ğŸ“bin<br/>  â¥www</span><span id="986b" class="ly lh hu ms b fv na mx l my mz">ğŸ“config<br/>  ğŸ“keys<br/>    â¥serviceAccountKey.json<br/>  configuration.json<br/>  index.</span><span id="e524" class="ly lh hu ms b fv na mx l my mz">ğŸ“cron_jobs<br/>  â¥ index.js<br/>    random_like.js</span><span id="520a" class="ly lh hu ms b fv na mx l my mz">ğŸ“services<br/>  ğŸ“firebase<br/>    â¥index.js</span><span id="6530" class="ly lh hu ms b fv na mx l my mz">ğŸ“utils<br/>  â¥index.js</span><span id="7b2e" class="ly lh hu ms b fv na mx l my mz">app.js<br/>app.yaml<br/>cron.yaml<br/>package.json</span></pre><p id="a9ee" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">èŠ‚ç‚¹ä¾èµ–å…³ç³»:</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="3b41" class="ly lh hu ms b fv mw mx l my mz">"express": "^4.16.3",<br/>"firebase": "^5.4.0",<br/>"firebase-admin": "^6.0.0"</span></pre><p id="fe34" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">é…ç½®ä¿æŒä¸APIæœåŠ¡å™¨ç›¸åŒã€‚</p><p id="dd7a" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">app.yaml</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="8eb9" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">service</strong>: cron<br/><strong class="ms hv">runtime</strong>: nodejs<br/><strong class="ms hv">env</strong>: flex<br/><strong class="ms hv">env_variables</strong>:<br/>  <strong class="ms hv">NODE_ENV</strong>: production</span></pre><p id="8ad7" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">cron.yaml</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="95cd" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">cron</strong>:<br/>- <strong class="ms hv">description</strong>: Like a Random Post<br/>  <strong class="ms hv">url</strong>: /like_random_post<br/>  <strong class="ms hv">schedule</strong>: every 10 minutes<br/>  <strong class="ms hv">timezone</strong>: Etc/GMT<br/>  <strong class="ms hv">target</strong>: cron</span></pre><p id="b33c" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">app.js</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="332c" class="ly lh hu ms b fv mw mx l my mz">process.env.NODE_PATH = __dirname;<br/>require('module').<em class="ka">Module</em>._initPaths();<br/><br/><strong class="ms hv">const </strong>express = require('express');<br/><strong class="ms hv">const </strong>app = express();<br/>app.enable('trust proxy');<br/><br/>app.use('/', require('cron_jobs'));<br/><br/>app.use((err, req, res, next) =&gt; res.status(500).send(err.message || 'Something broke!'));<br/><br/>module.exports = app;</span></pre><p id="9b32" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">cron_jobs/inde</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="3ae6" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">t </strong>express = require('express');<br/><strong class="ms hv">const </strong>randomLike = require('cron_jobs/random_like');<br/><strong class="ms hv">const </strong>router = express.Router();<br/><br/>// [START routing]<br/>router.get('/like_random_post', randomLike);<br/>// [END routing]<br/><br/>module.exports = router;</span></pre><p id="703c" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">cron_jobs/random_like.js</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="1eed" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">// </strong>At the Firebase endpoint file</span><span id="ee4f" class="ly lh hu ms b fv na mx l my mz"><strong class="ms hv">function </strong>addTask(type, data){<br/>    <strong class="ms hv">return </strong>tasksDB.ref('tasks_queue/tasks').push({ type, data });<br/>}</span></pre><p id="6114" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">æ­£å¦‚æ‚¨åœ¨cron.yamlæ–‡ä»¶ä¸­çœ‹åˆ°çš„ï¼Œæ¯éš”10åˆ†é’Ÿå°±ä¼šå‘/like_random_postç«¯ç‚¹(ç›®æ ‡:cronå¾®æœåŠ¡)å‘å‡ºä¸€ä¸ªGETè¯·æ±‚ã€‚è¯¥å‡½æ•°ä»æ•°æ®åº“ä¸­è·å¾—ä¸€ä¸ªéšæœºçš„postï¼Œå¹¶å°†ä¸€ä¸ªâ€œlike_postâ€ä»»åŠ¡æ·»åŠ åˆ°æˆ‘ä»¬çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚</p></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><p id="26e4" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">è¿™æ˜¯æˆ‘ä»¬æ•…äº‹çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œç°åœ¨ä½ åº”è¯¥æœ‰ä¸€ä¸ªå·¥ä½œæœåŠ¡å™¨ï¼Œå¯ä»¥ç”¨äºä»»ä½•ç±»å‹çš„åº”ç”¨ç¨‹åºï¼Œæœ¬åœ°æˆ–ç½‘ç»œã€‚</p></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><h1 id="9512" class="lg lh hu bd li lj lk ll lm ln lo lp lq ja lr jb ls jd lt je lu jg lv jh lw lx dt translated">ç¬¬2éƒ¨åˆ†â€”å‰ç«¯</h1><h1 id="2301" class="lg lh hu bd li lj ne ll lm ln nf lp lq ja ng jb ls jd nh je lu jg ni jh lw lx dt translated">ç½‘ç»œæœåŠ¡å™¨</h1><p id="53ad" class="pw-post-body-paragraph jy jz hu kb b kc mm iv ke kf mn iy kh lc mo kk kl ld mp ko kp le mq ks kt ku hn dt translated">è¯¥æœåŠ¡å™¨å°†å‘ç”¨æˆ·æä¾›<strong class="kb hv"> WebApp </strong>é¡µé¢ã€‚åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€æ¡è·¯ç”±ï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨React-routerå¤„ç†æ‰€æœ‰è·¯ç”±ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬çš„ç”¨æˆ·å°†ä»–ä»¬çš„å¸–å­åˆ†äº«ç»™å…¶ä»–ç¤¾äº¤åª’ä½“æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒå…·æœ‰å¸å¼•åŠ›ã€‚ä¸°å¯Œçš„é¢„è§ˆæ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„å·¥å…·æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nj"><img src="../Images/d81d628bf419c36faf98d59de5ced7ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g9kHMwgRrB8iJzxJU17Deg.png"/></div></div></figure><p id="af56" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ä¸ºäº†æ”¯æŒä¸°å¯Œçš„é¢„è§ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ªå¸–å­è°ƒæ•´htmlæ–‡ä»¶ã€‚</p><blockquote class="jv jw jx"><p id="d98b" class="jy jz ka kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘å°†åœ¨è¿™é‡Œæ·»åŠ ä¸€ä¸ªä¾‹å­ä»£ç å¦‚ä½•å¯ä»¥å¾ˆå®¹æ˜“åœ°åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¿™åªæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p></blockquote><p id="1693" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">æ–‡ä»¶å¤¹å±‚æ¬¡ç»“æ„:</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="4152" class="ly lh hu ms b fv mw mx l my mz">ğŸ“bin<br/>  â¥www</span><span id="44c7" class="ly lh hu ms b fv na mx l my mz">ğŸ“config<br/>  ğŸ“keys<br/>    â¥serviceAccountKey.json<br/>  configuration.json<br/>  index.</span><span id="cb17" class="ly lh hu ms b fv na mx l my mz">ğŸ“routes<br/>  â¥ index.js<br/>    post.js</span><span id="fcbd" class="ly lh hu ms b fv na mx l my mz">ğŸ“services<br/>  ğŸ“firebase<br/>    â¥index.js</span><span id="a761" class="ly lh hu ms b fv na mx l my mz">ğŸ“utils<br/>  â¥index.js</span><span id="704b" class="ly lh hu ms b fv na mx l my mz">ğŸ“views<br/>  â¥index.js<br/>  â¥html_template.js</span><span id="c7a0" class="ly lh hu ms b fv na mx l my mz">app.js<br/>app.yaml<br/>package.json</span></pre><p id="29e9" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">app.yaml</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="8ea0" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">runtime</strong>: nodejs<br/><strong class="ms hv">env</strong>: flex<br/><strong class="ms hv">env_variables</strong>:<br/>  <strong class="ms hv">NODE_ENV</strong>: production</span></pre><p id="f91c" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">app.js</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="f357" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated"><em class="ka">å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬å°†å‹ç¼©æ–‡ä»¶ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</em></p><p id="650b" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">routes/index.js</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="3138" class="ly lh hu ms b fv mw mx l my mz">'use strict';<br/><br/><strong class="ms hv">const </strong>express = require('express');<br/><strong class="ms hv">const </strong>router = express.Router();<br/><strong class="ms hv">const </strong>htmlTemplate = require('../views');<br/><br/><br/>// [START post]<br/>router.get('/post/*', require('./post'));<br/>// [END post]<br/><br/>// [START app]<br/>router.get('/*', (req, res) =&gt; {<br/>    // console.log(req);<br/>    <strong class="ms hv">return </strong>res.send(htmlTemplate())<br/>});<br/>// [END app]<br/><br/>module.exports = router;</span></pre><p id="6577" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">routes/post.js</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="73c4" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">html _æ¨¡æ¿. js</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><h1 id="b25f" class="lg lh hu bd li lj ne ll lm ln nf lp lq ja ng jb ls jd nh je lu jg ni jh lw lx dt translated">Webåº”ç”¨ç¨‹åº</h1><blockquote class="jv jw jx"><p id="dd4e" class="jy jz ka kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æœ‰å¾ˆå¤šå¾ˆæ£’çš„â€œå¦‚ä½•æ„å»ºReact webåº”ç”¨ç¨‹åºâ€çš„æ–‡ç« ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†é‡ç‚¹ä»‹ç»ä¸€äº›ç¤¾äº¤åª’ä½“webåº”ç”¨ç¨‹åºçš„æŒ‘æˆ˜ã€‚</p></blockquote><h2 id="d9cc" class="ly lh hu bd li lz ma mb lm mc md me lq lc mf mg ls ld mh mi lu le mj mk lw ml dt translated">ç›®æ ‡:</h2><p id="f001" class="pw-post-body-paragraph jy jz hu kb b kc mm iv ke kf mn iy kh lc mo kk kl ld mp ko kp le mq ks kt ku hn dt translated">æè¦<br/>ç°åœºå¬ä¼—<br/>å›¾ç‰‡ä¸Šä¼ <br/>ä¸°å¯Œçš„é¢„è§ˆ</p><p id="7082" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">è®©æˆ‘ä»¬ä»WebAppçš„æ ¹å¼€å§‹</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="31c9" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">pushNotificationæ˜¯æˆ‘ä»¬ä¸åº”ç”¨ç¨‹åºç”¨æˆ·äº¤æµçš„æ–¹å¼ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff nk"><img src="../Images/7c0d8f1dbc849cbcad3819e168d057b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f2KtIKH4bMqkwBOSHQ3fDQ.png"/></div></div></figure><p id="d0d3" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨â€œtoastr jsâ€ã€‚</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="7562" class="ly lh hu ms b fv mw mx l my mz"><strong class="ms hv">import </strong>toastr <strong class="ms hv">from </strong>'toastr';<br/><br/><strong class="ms hv">export default function </strong>pushNotification(message, type = 'error') {<br/>    toastr.options.positionClass = 'toast-bottom-full-width';<br/>    toastr.options.showMethod = 'slideDown';<br/>    toastr.options.hideMethod = 'slideUp';<br/>    toastr.options.hideDuration = 300;<br/>    toastr.options.newestOnTop = <strong class="ms hv">false</strong>;<br/>    toastr.remove();<br/>    <strong class="ms hv">switch </strong>(type) {<br/>        <strong class="ms hv">case </strong>'info':<br/>            toastr.info(message);<br/>            <strong class="ms hv">break</strong>;<br/>        <strong class="ms hv">case </strong>'error':<br/>            toastr.error(message);<br/>            <strong class="ms hv">break</strong>;<br/>        <strong class="ms hv">case </strong>'success':<br/>            toastr.success(message);<br/>            <strong class="ms hv">break</strong>;<br/>        <strong class="ms hv">case </strong>'warning':<br/>            toastr.warning(message);<br/>            <strong class="ms hv">break</strong>;<br/>        <strong class="ms hv">default</strong>:<br/>            toastr.error(message);<br/>            <strong class="ms hv">break</strong>;<br/>    }<br/>}</span></pre><p id="0777" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">Firebaseç«¯ç‚¹æ–‡ä»¶:</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="7e8d" class="ly lh hu ms b fv mw mx l my mz">import firebase from 'firebase/app';<br/>import 'firebase/auth';<br/>import 'firebase/storage';<br/>import 'firebase/firestore';<br/>import 'firebase/database';<br/>import config from 'config';</span><span id="20b2" class="ly lh hu ms b fv na mx l my mz">class Firebase {</span><span id="adf7" class="ly lh hu ms b fv na mx l my mz">static serverTimestamp() {<br/>        return firebase.firestore.FieldValue.serverTimestamp();<br/>    }</span><span id="1143" class="ly lh hu ms b fv na mx l my mz">constructor() {<br/>        firebase.initializeApp({<br/>            apiKey: config.firebase.api_key,<br/>            authDomain: config.firebase.domain,<br/>            projectId: config.firebase.project_id,<br/>            storageBucket: config.firebase.bucket,<br/>        });<br/>        this.auth = firebase.auth();<br/>        this.db = firebase.firestore();<br/>        this.db.settings({ timestampsInSnapshots: true });<br/>        <strong class="ms hv">this</strong>.tasksDB = firebase.database();<br/>        this.tasks = <strong class="ms hv">this</strong>.tasksDB.ref('tasks_queue/tasks');<br/>        this.storage = firebase.storage();<br/>    }</span><span id="ebae" class="ly lh hu ms b fv na mx l my mz">}</span><span id="846d" class="ly lh hu ms b fv na mx l my mz">export default Firebase;</span></pre><h2 id="5aae" class="ly lh hu bd li lz ma mb lm mc md me lq lc mf mg ls ld mh mi lu le mj mk lw ml dt translated">é¥²æ–™</h2><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="baf9" class="ly lh hu ms b fv mw mx l my mz">ğŸ“feed<br/>  ğŸ“view<br/>    â¥feed_item.js<br/>    â¥index.js<br/>   â¥index.js</span></pre><p id="a9b7" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">å¸Œæœ›æˆ‘ä»¬å°†éœ€è¦å¤„ç†å¤§é‡çš„èŒä½ã€‚ä¸ºäº†æ­£ç¡®ç®¡ç†å®ƒï¼Œæˆ‘ä»¬éœ€è¦:</p><p id="35ac" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">1.ä½¿ç”¨æŸ¥è¯¢æ¸¸æ ‡å¯¹æ•°æ®è¿›è¡Œåˆ†é¡µ</p><p id="dbe4" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">2.é«˜æ•ˆæ— é™å¯æ»šåŠ¨å®¹å™¨</p><p id="b922" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">3.æŸ¥çœ‹å‘å¸ƒæ›´æ–°ç›‘å¬ç¨‹åº</p><p id="6498" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">â€œæ§åˆ¶å™¨â€:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="90db" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">å¯¹äºæ— é™å¯æ»šåŠ¨å®¹å™¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨â€œreact-infiniteâ€</p><p id="209b" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">â€œè§†å›¾â€:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="73fe" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">å¯¹äºposté¡¹ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€äº›ä¾¦å¬å™¨ã€‚ä¾‹å¦‚ï¼Œlikes â€” counteråº”è¯¥ä¸æ–­å®æ—¶æ›´æ–°ã€‚ç„¶è€Œï¼Œä¸ºå¤§é‡çš„å¸–å­è®¾ç½®ç›‘å¬å™¨ä¼šæ˜¾è‘—å½±å“æˆ‘ä»¬çš„webappæ€§èƒ½ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œæˆ‘ä»¬å°†åªç›‘å¬è§†å›¾ä¸­çš„å¸–å­çš„å˜åŒ–ï¼Œå¹¶ä½¿ç”¨â€œååº”-å¯è§æ€§-ä¼ æ„Ÿå™¨â€æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="8b1d" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">è®©æˆ‘ä»¬å‘Firebaseç«¯ç‚¹æ–‡ä»¶æ·»åŠ ä¸€äº›å‡½æ•°</p><pre class="jk jl jm jn fq mr ms mt mu aw mv dt"><span id="4838" class="ly lh hu ms b fv mw mx l my mz">getRecentPosts(startAfter = <strong class="ms hv">null</strong>) {<br/>    <strong class="ms hv">const </strong>postRef = startAfter<br/>        ? <strong class="ms hv">this</strong>.db.collection('posts')<br/>            .orderBy('created_at', 'desc')<br/>            .startAfter(startAfter.created_at)<br/>            .limit(config.app.feed_paging)<br/>        : <strong class="ms hv">this</strong>.db.collection('posts')<br/>            .orderBy('created_at', 'desc')<br/>                .limit(config.app.feed_paging);<br/>    <strong class="ms hv">return </strong>postRef.get().then(snapshot =&gt; snapshot.docs.map(doc =&gt; doc.data()));<br/>}</span><span id="4099" class="ly lh hu ms b fv na mx l my mz">postChangesListener(postId, callback) {<br/>    <strong class="ms hv">return this</strong>.db.collection('posts').doc(postId).onSnapshot((doc) =&gt; {<br/>        <strong class="ms hv">if </strong>(callback) callback(doc.data());<br/>    });<br/>}</span><span id="0702" class="ly lh hu ms b fv na mx l my mz">addTask(type, data) {<br/>    return this.tasks.push({ type, ...data });<br/>}</span></pre><h2 id="1520" class="ly lh hu bd li lz ma mb lm mc md me lq lc mf mg ls ld mh mi lu le mj mk lw ml dt translated">å›¾åƒä¸Šä¼ </h2><p id="b191" class="pw-post-body-paragraph jy jz hu kb b kc mm iv ke kf mn iy kh lc mo kk kl ld mp ko kp le mq ks kt ku hn dt translated">æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„ç”¨æˆ·èƒ½å¤Ÿä¸Šä¼ ç…§ç‰‡åˆ°æˆ‘ä»¬çš„ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºè¿™äº›ç…§ç‰‡åˆ›å»ºç¼©ç•¥å›¾ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ä»–ä»¬ç­‰å¾…å¾ˆé•¿æ—¶é—´æ‰èƒ½å®Œæˆã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†éœ€è¦é™ä½ç…§ç‰‡çš„å¤§å°(ä¸ºäº†æ›´å¿«çš„ä¸Šä¼ å’Œåˆ›å»ºç¼©ç•¥å›¾)ã€‚</p><p id="84d3" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">ä¸Šä¼ ç…§ç‰‡ç»„ä»¶:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="bd0f" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">å½“æˆ‘ä»¬è°ƒæ•´ç…§ç‰‡å¤§å°æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å®ƒçš„exifæ•°æ®ï¼Œå¦åˆ™æˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°æ–¹å‘é—®é¢˜ã€‚</p><p id="b79c" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">å›¾åƒå·¥å…·:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><h2 id="367a" class="ly lh hu bd li lz ma mb lm mc md me lq lc mf mg ls ld mh mi lu le mj mk lw ml dt translated">ç™»å½•ç¤ºä¾‹</h2><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><h2 id="6987" class="ly lh hu bd li lz ma mb lm mc md me lq lc mf mg ls ld mh mi lu le mj mk lw ml dt translated">æœ€ç»ˆFirebaseç«¯ç‚¹æ–‡ä»¶</h2><p id="6cc1" class="pw-post-body-paragraph jy jz hu kb b kc mm iv ke kf mn iy kh lc mo kk kl ld mp ko kp le mq ks kt ku hn dt translated">è¯·æ³¨æ„ï¼ŒFirestoreæ•°æ®æ“ä½œå¹¶ä¸å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ï¼Œè€Œæ˜¯é€šè¿‡Firebase RDå‘æœåŠ¡å™¨æ·»åŠ ä»»åŠ¡ã€‚è¿™åªæ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ã€‚</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure><blockquote class="jv jw jx"><p id="d1ee" class="jy jz ka kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘ç”¨çš„æ˜¯webpack 4ï¼Œè¿™æ˜¯æˆ‘çš„webpack.config.jsï¼Œå¦‚æœä½ éœ€è¦ä»£ç åˆ†å‰²å’Œgzipï¼Œä½ å¯ä»¥ç”¨å®ƒä½œä¸ºä¾‹å­ã€‚</p></blockquote><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nb nc l"/></div></figure></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><p id="777d" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">åœ¨æ‚¨å®Œæˆç¼–å†™ç¬¬ä¸€ä¸ªç‰ˆæœ¬å¹¶å°†æ‰€æœ‰å†…å®¹éƒ¨ç½²åˆ°GCPåï¼Œæ‚¨ç°åœ¨å¯ä»¥å°†æ‚¨çš„åº”ç”¨å¼•æ“è®°å½•æ·»åŠ åˆ°æ‚¨çš„Cloudflare DNSè®¾ç½®ï¼Œå¹¶è·å¾—å…è´¹çš„æ€§èƒ½å’Œå®‰å…¨æ€§æå‡ï¼ŒåŒ…æ‹¬SSLã€CDNç­‰ã€‚</p></div><div class="ab cl kv kw hc kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hn ho hp hq hr"><p id="3c0e" class="pw-post-body-paragraph jy jz hu kb b kc kd iv ke kf kg iy kh lc kj kk kl ld kn ko kp le kr ks kt ku hn dt translated">è¿™æ˜¯æˆ‘å»ºç«‹ä½ çš„æ–°çš„æœ‰è¶£çš„ç¤¾äº¤åª’ä½“çš„æœ€åä¸€ä¸ªå»ºè®®:<strong class="kb hv">åŒ…å«æ‰€æœ‰çš„åˆ†æ</strong>ã€‚è¿™å°±æ˜¯ä½ å¦‚ä½•çŸ¥é“ä½ çš„ç”¨æˆ·åœ¨åšä»€ä¹ˆã€‚è¿™å°†æœ‰åŠ©äºä½ è¿›æ­¥ï¼Œå¹¶æŠŠä½ çš„æ—¶é—´æŠ•å…¥åˆ°å¯¹ä»–ä»¬æ¥è¯´é‡è¦çš„äº‹æƒ…ä¸Šã€‚</p><blockquote class="jv jw jx"><p id="7175" class="jy jz ka kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘å¾ˆæƒ³å¾—åˆ°ä½ çš„æ„è§å’Œå»ºè®®ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶é€šè¿‡æˆ‘çš„<a class="ae lf" href="https://www.linkedin.com/in/sagi-medina-935699122/" rel="noopener ugc nofollow" target="_blank"> linkedin </a>è”ç³»æˆ‘ã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼ä¼ æ’­çˆ±:)</p></blockquote></div></div>    
</body>
</html>