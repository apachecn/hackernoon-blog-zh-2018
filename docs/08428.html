<html>
<head>
<title>Adding Chatbot to your Android App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将聊天机器人添加到您的Android应用程序</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/add-chatbot-to-your-android-app-524556c058ab?source=collection_archive---------2-----------------------#2018-10-09">https://medium.com/hackernoon/add-chatbot-to-your-android-app-524556c058ab?source=collection_archive---------2-----------------------#2018-10-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><blockquote class="ir is it"><p id="f1b0" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">更新(2020年1月14日):<em class="hu">我已经更新了源代码以使用最新的协程，你可以检查一下Presenter类</em></p></blockquote><p id="f41c" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">我试图为我的社会创新项目开发一个应用程序。它叫做LISTEND——LISTEND和End Depression。这个项目是我作为<a class="ae jw" href="http://www.xlfutureleaders.com/" rel="noopener ugc nofollow" target="_blank"> XL未来领袖</a>获奖者任务的一部分。Listend现在发布了测试版。我们仍然需要收集数据来训练机器人，让它变得更智能，对用户更有帮助。基本上我们有几个功能，包括聊天机器人本身。我们的主要重点是通过早期预防来预防抑郁症或心理健康问题。如需了解更多信息，您可以查看此处的应用程序<a class="ae jw" href="https://play.google.com/store/apps/details?id=com.rahmat.app.listend" rel="noopener ugc nofollow" target="_blank"> Listend应用程序</a>请提供您的反馈以使应用程序变得更好，谢谢:)。</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff jx"><img src="../Images/952fbb3b7c09d25ee3a35dc0551de798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m3vlxneAo50hBQYOZbT_ug.jpeg"/></div></div><figcaption class="kj kk fg fe ff kl km bd b be z ek">unsplash.com</figcaption></figure><p id="cdea" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">好了，现在我们来编码吧！</p><p id="82cb" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">对于这个聊天机器人的后端，我使用firebase实时数据库，并使用Dialogflow作为聊天机器人引擎。</p><p id="4445" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">注意:在本教程中，我不打算深入训练聊天机器人，我只是展示了在你的android应用程序中添加聊天机器人的一般方法。</strong></p><p id="a24b" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">设置对话流。</strong></p><p id="a0e3" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">出于教程的目的，我们需要在dialogflow控制台中激活聊天机器人代理的聊天功能。只需转到您的dialogflow控制台并创建代理。填写所需的表格，包括时间和默认语言。现在你有一个代理，但它什么都不知道。为了让它发挥作用，我们需要训练它。正如我之前提到的，我们不打算关注这一点，而是可以使用预构建的代理。预构建的代理基本上是经过培训以理解特定上下文的预配置代理。去侧边栏。在那之后进口闲聊代理。现在我们有了一个可以参与闲聊的代理人。耶！</p><p id="ab86" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">在android项目中设置依赖关系。</strong></p><p id="a2e3" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">有几件事，我们需要为了建立应用程序，这些是:</p><ul class=""><li id="df93" class="kn ko hu ix b iy iz jc jd jt kp ju kq jv kr js ks kt ku kv dt translated">对话流</li><li id="ef7a" class="kn ko hu ix b iy kw jc kx jt ky ju kz jv la js ks kt ku kv dt translated">Firebase实时数据库</li><li id="d303" class="kn ko hu ix b iy kw jc kx jt ky ju kz jv la js ks kt ku kv dt translated">Firebase UI</li></ul><p id="7405" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">正如我之前所说，我们将使用Firebase实时数据库作为后端，这意味着所有来自用户和聊天机器人的对话都将存储在这个数据库中。为了简化我们的ui创建，我们使用Firebase UI，我们可以简单地集成从数据库中获得的数据，并将其填充到UI中，我们还可以观察数据，如果有新的变化，会自动更新。你也可以使用你自己的firebase，只需在android工作室<a class="ae jw" href="https://hackernoon.com/tagged/android" rel="noopener ugc nofollow" target="_blank">的firebase助手中添加Firebase，进入工具- &gt; firebase - &gt;添加Firebase实时数据库。</a></p><p id="be6c" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">最后，这里是<em class="iw"> build.gradle </em>文件:</p><figure class="jy jz ka kb fq kc"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="4400" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">创建用户界面</strong></p><p id="58c2" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">我们将创建一个简单的UI来显示消息。我们将通过使用recyclerview来实现这一点。所以首先我们需要创建item_view。像这样:</p><figure class="jy jz ka kb fq kc"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="bb78" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">之后，我们将创建包含显示聊天的recyclerview的布局，并在屏幕底部创建一个带有编辑文本的按钮，用于输入和发送消息。代码是这样的:</p><figure class="jy jz ka kb fq kc"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="d1ff" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">处理业务逻辑</strong></p><p id="6ee8" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">在本教程中，我们将使用MVP方法来使架构松散耦合(如果你专注于android开发，我建议你学习这种或其他方法)。首先，我们需要指定一个契约来明确视图和演示者的角色。基本上，主持人将接收用户的输入信息，并将其发送到数据库，并从<a class="ae jw" href="https://hackernoon.com/tagged/chatbot" rel="noopener ugc nofollow" target="_blank">聊天机器人</a>中检索回复的信息。而视图负责获取用户键入的消息，并用用户消息和机器人消息填充recyclerview。合同看起来是这样的:</p><figure class="jy jz ka kb fq kc"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="0b32" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">正如你在上面看到的，视图没有任何功能，因为firebase adapter可以观察数据库中的数据变化，所以我们不需要处理它。</p><p id="6860" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在我们有了明确的角色，第二步是实现每个角色的契约。在我们转到视图和表示器之前，我们需要首先为recyclerview编写适配器。这里我们使用了firebaseadapter和viewholder。代码看起来像这样:</p><figure class="jy jz ka kb fq kc"><div class="bz el l di"><div class="lb lc l"/></div></figure><figure class="jy jz ka kb fq kc"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="5795" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">主讲人</strong></p><p id="7863" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">在presenter中，我们处理用户输入的消息，将其发送到firebase数据库，并在dialogflow中触发chatbot，在这里，为了使请求在后台执行，我使用了kotlin协程。</p><figure class="jy jz ka kb fq kc"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="03c1" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在我们只需要设置活动，获取用户输入，填充recyclerview并观察firebase实时数据库中的数据变化。</p><figure class="jy jz ka kb fq kc"><div class="bz el l di"><div class="lb lc l"/></div></figure><p id="ba29" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">最后一步，我们需要开始监听onStart函数上的请求，简单地写:</p><p id="5760" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><em class="iw"> adapter.startListening() </em></p><p id="3da9" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在我们完成了，如果你尝试运行这个应用程序，你可以简单地与聊天机器人聊天，这里有一个截图:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff ld"><img src="../Images/57e3192e8ddc42047a0e9b815857e65d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kM2DhAt-V75Gq1x-oXmq0Q.png"/></div></div></figure><p id="c109" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv"> ps:聊天机器人不是很聪明，我们需要训练它让它更聪明，你也可以通过改变客户端访问id来使用你自己的dialogflow代理。</strong></p><p id="5d66" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">您可以在此查看完整代码:</p><div class="le lf fm fo lg lh"><a href="https://github.com/muhrahmatullah/android-chatbot" rel="noopener  ugc nofollow" target="_blank"><div class="li ab ej"><div class="lj ab lk cl cj ll"><h2 class="bd hv fv z el lm eo ep ln er et ht dt translated">muhramatullah/安卓聊天机器人</h2><div class="lo l"><h3 class="bd b fv z el lm eo ep ln er et ek translated">使用dialogflow作为聊天机器人引擎的示例项目。通过创建……为muhramatullah/Android-chatbot开发做出贡献</h3></div><div class="lp l"><p class="bd b gc z el lm eo ep ln er et ek translated">github.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv kh lh"/></div></div></a></div></div><div class="ab cl lw lx hc ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hn ho hp hq hr"><p id="3040" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">好了，这个帖子到此为止。感谢你阅读这篇文章直到最后。如果你认为这个帖子有用，别忘了<strong class="ix hv">关注，分享</strong>和<strong class="ix hv">给它一个掌声！如果你有什么问题或建议，请在下面的评论区留言！谢谢你。</strong></p><figure class="jy jz ka kb fq kc"><div class="bz el l di"><div class="md lc l"/></div></figure></div></div>    
</body>
</html>