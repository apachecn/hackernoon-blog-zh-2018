<html>
<head>
<title>Durable Functions — Backend Development Made Easy (And Cheap!)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">持久的功能——后端开发变得简单(而且便宜！)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/durable-functions-backend-development-made-easy-and-cheap-cbab7acc7050?source=collection_archive---------9-----------------------#2018-10-18">https://medium.com/hackernoon/durable-functions-backend-development-made-easy-and-cheap-cbab7acc7050?source=collection_archive---------9-----------------------#2018-10-18</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="cafe" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">关于新型无服务器的思考。</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff jj"><img src="../Images/e0ed9043f0cb09b4a501cdae158389d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/0*8_lbGJG3lpfeGhyj.png"/></div><figcaption class="jr js fg fe ff jt ju bd b be z ek"><a class="ae jv" href="https://docs.microsoft.com/en-us/azure/azure-functions/durable-functions-overview#pattern-2-fan-outfan-in" rel="noopener ugc nofollow" target="_blank">Fan-Out/Fan-In Pattern</a></figcaption></figure><p id="cc17" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">一段时间以来，功能应用程序的无服务器化一直很有吸引力。不必为24/7基础架构付费，但获得完全的自动扩展是一个游戏规则改变者。但是从来没有感觉到无服务器功能可以取代你的堆栈。简单的Slack app好不好？当然可以。但不是复杂的后端。直到现在。</p><p id="d311" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">Azure的持久功能扩展了他们已经建立的功能即服务(FaaS)平台。最后，无服务器函数有状态。您在代码中定义工作流，同时享受无服务器的诸多好处。</p><p id="c88e" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">在许多方面，持久函数感觉就像无服务器函数本来的样子。Azure是目前唯一提供这种工具的云提供商。持久函数允许您将函数链接在一起。您甚至可以并行运行它们，轻松跟踪工作流程进度。有强大的错误处理和重试机制，开箱即用。</p><p id="7881" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">在建立了一些概念证明之后，我被说服了。是时候重构一些生产应用程序，以及从头开始几个了。这是我目前发现的。</p><h1 id="db81" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">更多编码，更少管道</h1><p id="1bc9" class="pw-post-body-paragraph jw jx hu jy b jz lk iv kb kc ll iy ke kf lm kh ki kj ln kl km kn lo kp kq kr hn dt translated">我曾经使用不同的用例开发过许多大型Node.js应用程序。但是似乎不管怎样，都需要某种队列处理，这也是我花费大部分时间的地方。</p><p id="45b3" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">当然，有像<a class="ae jv" href="https://github.com/Automattic/kue" rel="noopener ugc nofollow" target="_blank"> Kue </a>和<a class="ae jv" href="https://github.com/OptimalBits/bull" rel="noopener ugc nofollow" target="_blank"> Bull </a>这样的优秀框架可以为你做很多繁重的工作。看看这些自述文件。有大量的设置，甚至更多的工作要排除故障和维护。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff lp"><img src="../Images/2fd3b2df7ea8871cfc15aeb41abfddb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOjR0y4F2xMBkA6q0v1kCg.jpeg"/></div></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">That’s Enough Plumbing for Me. (<a class="ae jv" href="https://unsplash.com/photos/Md9UK7frBv0?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Damon Lam</a> on <a class="ae jv" href="https://unsplash.com/search/photos/plumbing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>)</figcaption></figure><p id="a0d5" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">持久功能使用了许多相同的机制，但都是为您处理的。这一开始有点吓人。尤其是在队列管理是我大部分问题的根源的世界里。但是Azure有一个更好的解决方案，不需要照看每一笔交易。</p><p id="8236" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">这大大增加了产量。我在几个小时内重建了自己需要几天才能完成的功能。重复任务、自动重试策略和计划作业都可以正常工作。如果您必须排除故障，表存储中的所有内容都是可查询的。不再需要解析Redis键。我可以专注于业务逻辑，而不是担心计划的工作。</p><h1 id="9823" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">超级简单的托管</h1><p id="f080" class="pw-post-body-paragraph jw jx hu jy b jz lk iv kb kc ll iy ke kf lm kh ki kj ln kl km kn lo kp kq kr hn dt translated">当然，托管对于大型企业应用来说是轻而易举的事情。但是我不再用传统的主机来管理我的个人项目了。我再也不用纠结于免费主机层提供的土豆CPU和128字节的RAM了。或者每月支付费用来维持一个演示应用程序。</p><p id="b377" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">见鬼，如果你需要快速启动，你甚至不需要GitHub库或IDE。我已经使用Azure中的在线代码编辑器托管了几个用于测试的演示函数。我现在有了自己的服务器，可以随时托管任何东西。我一毛钱也不用付。</p><h1 id="3028" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">仍然在最前沿</h1><p id="3389" class="pw-post-body-paragraph jw jx hu jy b jz lk iv kb kc ll iy ke kf lm kh ki kj ln kl km kn lo kp kq kr hn dt translated">虽然开发持久的函数是一种很好的体验，但也存在一些问题。一切都还很新，有很多积极的发展正在进行。</p><h2 id="3546" class="lu kt hu bd ku lv lw lx ky ly lz ma lc kf mb mc le kj md me lg kn mf mg li mh dt translated">工具问题</h2><p id="4ada" class="pw-post-body-paragraph jw jx hu jy b jz lk iv kb kc ll iy ke kf lm kh ki kj ln kl km kn lo kp kq kr hn dt translated">我花了大部分时间在Mac上开发耐用的功能。不要误解我的意思，作为一个多年的. NET开发者，能够构建是一种享受。任何地方的网络应用。但是有些事情就是不对劲。</p><p id="7239" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated"><a class="ae jv" href="https://github.com/azure/azurite" rel="noopener ugc nofollow" target="_blank">Azure</a>，Mac/Linux的本地Azure存储模拟器，直接就不行了。有一种不同的Windows模拟器非常好用。但是蓝晶石还不耐用。这意味着我在进行本地开发时会产生(最小的)成本。我必须使用Azure存储。</p><p id="e6ef" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">建议将<a class="ae jv" href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurefunctions" rel="noopener ugc nofollow" target="_blank">函数扩展</a>用于VS代码。但这也不太持久。它没有以推荐的方式设置项目。而且它似乎甚至不知道耐用功能是一个东西。因此，我发现自己在从头开始创建函数，而不是像预期的那样使用工具。</p><h2 id="348c" class="lu kt hu bd ku lv lw lx ky ly lz ma lc kf mb mc le kj md me lg kn mf mg li mh dt translated">语言选项</h2><p id="effc" class="pw-post-body-paragraph jw jx hu jy b jz lk iv kb kc ll iy ke kf lm kh ki kj ln kl km kn lo kp kq kr hn dt translated">持久函数承诺支持C#、JavaScript、F#、Java，甚至更多。这是个好消息。这意味着一旦你学会了持久函数模式，你就不会被语言选择所束缚。</p><p id="29db" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">不幸的是，我发现C#是现在右<em class="mi">右</em>的唯一有效选项。它是唯一一种“普遍可用(GA)的语言——完全支持并被批准用于生产。”Azure函数在GA中有更多的语言。所以可以说持久的功能支持即将到来。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff mj"><img src="../Images/4dade5bd6f57a23c4b84342f34f4dc86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*o3eqfwYS_E1dPsn7XzmNQQ.png"/></div></div><figcaption class="jr js fg fe ff jt ju bd b be z ek">Supported Languages for Azure <em class="mk">Functions, But Not Durable (</em><a class="ae jv" href="https://docs.microsoft.com/en-us/azure/azure-functions/supported-languages#languages-in-runtime-1x-and-2x" rel="noopener ugc nofollow" target="_blank"><em class="mk">Source</em></a><em class="mk">)</em></figcaption></figure><p id="0157" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">JavaScript缺少使持久功能变得伟大的关键实现。仍然有许多东西不工作。并且文档甚至与它的C#对应物相差甚远。我发现JavaScript的开发经历非常令人沮丧。C#则相反。</p><p id="ff28" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">我怀疑每当JavaScript成为GA时，微软都会解决这些问题。然而，C#似乎将永远是首选。</p><blockquote class="ml"><p id="0a68" class="mm mn hu bd mo mp mq mr ms mt mu kr ek translated">“JavaScript支持通常依赖于我们的。NET实现。- <a class="ae jv" href="https://github.com/MicrosoftDocs/azure-docs/issues/16118#issuecomment-427900886" rel="noopener ugc nofollow" target="_blank"> Chris Gillum </a>，耐用功能首席软件工程师。</p></blockquote><p id="58af" class="pw-post-body-paragraph jw jx hu jy b jz mv iv kb kc mw iy ke kf mx kh ki kj my kl km kn mz kp kq kr hn dt translated">这并不是说它不可用，而是在做语言决定时要记住的事情。即使在我使用持久函数重构的JavaScript应用中，C#也是语言选择。JS只是还没到那一步。</p><h1 id="0284" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">成本大幅下降</h1><p id="41e0" class="pw-post-body-paragraph jw jx hu jy b jz lk iv kb kc ll iy ke kf lm kh ki kj ln kl km kn lo kp kq kr hn dt translated">总的来说，无服务器最明显的优势是节省成本。您只需在功能被使用时付费。这是巨大的，尤其是如果你不是Twitter，并且没有一整天的流量。</p><p id="3907" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">持久功能增加了一点成本，因为它们大量使用Azure存储来保持所有东西的持久性。尽管如此，这一成本是最低的。这比托管自己的Redis实例来模拟功能要好得多。</p><p id="3f45" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">我不确定Azure如何在这些东西上赚钱。普通的web应用程序永远不会有任何显著的成本。但我认为这是他们让开发者开始使用这个平台的一种方式。开始使用像<a class="ae jv" href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-cosmosdb-v2" rel="noopener ugc nofollow" target="_blank"> CosmosDb </a>这样有功能的东西<em class="mi">太</em>容易了，那就是<em class="mi">不</em>便宜。</p><h1 id="ce34" class="ks kt hu bd ku kv kw kx ky kz la lb lc ja ld jb le jd lf je lg jg lh jh li lj dt translated">试一试</h1><p id="4e1a" class="pw-post-body-paragraph jw jx hu jy b jz lk iv kb kc ll iy ke kf lm kh ki kj ln kl km kn lo kp kq kr hn dt translated">总而言之，持久函数框架是一个不可思议的工具。它改变了我对后端开发如何工作的看法。所以试试吧！它是免费的，而且很容易上手。你甚至不需要一个IDE，你可以直接从<a class="ae jv" href="https://azure.microsoft.com/en-us/services/functions/" rel="noopener ugc nofollow" target="_blank">门户网站</a>构建概念证明。</p></div></div>    
</body>
</html>