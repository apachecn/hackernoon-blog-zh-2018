<html>
<head>
<title>Performance Monitoring for AWS Lambda</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS Lambda的性能监控</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/performance-monitoring-for-aws-lambda-e89799963956?source=collection_archive---------5-----------------------#2018-10-23">https://medium.com/hackernoon/performance-monitoring-for-aws-lambda-e89799963956?source=collection_archive---------5-----------------------#2018-10-23</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="461c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://hackernoon.com/tagged/monitoring" rel="noopener ugc nofollow" target="_blank">监控</a>Lambda函数的性能可能看起来是一项微不足道的任务，但是一旦数据集变大，就越来越难以理解用户对系统的体验。作为开发人员，您通常关心系统的延迟和成本。一个好的可观察性工具的特性应该与所有这些相一致，同时还能让您对您的系统提出任意的问题，以找出问题的范围和原因。让我们详细讨论一下应该如何进行性能监控以及找出Lambda函数性能问题的根本原因。</p><h1 id="585b" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">Lambda函数的性能监控</h1><p id="9dc4" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">让我们从你应该在Lambda函数中监控什么开始。一般来说，有两个方面——用户体验和系统成本。用户体验通常归结为服务的<strong class="it hv">可用性</strong>、<strong class="it hv">延迟</strong>和<strong class="it hv">功能集</strong>，而运营服务的成本对于确保<a class="ae jp" href="https://hackernoon.com/tagged/business" rel="noopener ugc nofollow" target="_blank">业务的盈利能力</a>非常重要。在分布式体系结构中，要监控的表面区域变得更大，性能和成本的变化经常会被忽略。</p><p id="f1c4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使无服务器应用程序更难监控的一个因素是分析服务的设置开销。在大多数无服务器的情况下，要监控的单元要多得多，生命周期短，并且配置代理会直接增加延迟和成本。</p><p id="15a1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这种服务的好处在于，默认情况下，<strong class="it hv">它们让自己变得可以被观察到。可观察性并不意味着你有可见性，它意味着系统发出的数据可以让你理解外部发生的事情。这是我们建立Dashbird的核心原则。</strong></p><h2 id="9efd" class="kt jr hu bd js ku kv kw jw kx ky kz ka jc la lb ke jg lc ld ki jk le lf km lg dt translated">观察Lambda函数的开销</h2><p id="45e1" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">根据度量标准，跨所有功能或每个资源单独观察它可能是有意义的。例如，系统成本最好在帐户级别关注，只有当该指标经历重大变化时，深入到功能级别才有意义。</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff lh"><img src="../Images/11d93d3153cffb1e7f1171fddff97950.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sRuXWSpVbTix0-9p.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek"><em class="lx">Account metrics</em></figcaption></figure><h1 id="23b9" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">监控函数的延迟</h1><p id="754d" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">对于延迟，大型数据集可能会扭曲结果，使得很难注意到一个重要的面向用户的功能何时开始花费更长的时间来执行。关注延迟的一个好方法是构建一个包含所有关键任务功能的自定义仪表板，并观察异常值。一个很好的方法是使用Dashbird。</p><p id="e691" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦您检测到某个函数花费的时间比预期的长，您就可以深入到详细的指标…</p><h2 id="379f" class="kt jr hu bd js ku kv kw jw kx ky kz ka jc la lb ke jg lc ld ki jk le lf km lg dt translated">百分位数统计</h2><p id="eeb3" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">通常，在大型数据集中，平均指标隐藏了无关的数据点，使得不可能检测到即使平均执行速度是可接受的，某些百分比的用户经历了明显更长的响应时间。此外，作为一名开发人员，经常会面临来自SLA的需求，比如“99%的请求必须在1秒内完成”。即使你不是，这样的需求也是好的，因为它是可操作的和容易衡量的。这就是百分位数指标发挥作用的地方。</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ly"><img src="../Images/016cd89d5a253d62d6c60c15580b8c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6QsHNcYrueFbzYeC.png"/></div></div><figcaption class="lt lu fg fe ff lv lw bd b be z ek"><em class="lx">Function metrics in Dashbird</em></figcaption></figure><h1 id="f368" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">调试性能问题</h1><p id="a980" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">即使您已经检测到应用程序有问题，问题的原因可能仍然不明显。执行缓慢是由冷启动引起的吗？也许函数调用的某个服务需要很长时间才能响应？增加配置的内存会加快执行速度吗？还是只会花费更多的钱而影响很小？</p><p id="f076" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们一次回答一个问题。冷启动？您可以绘制出冷启动的时间图，并比较冷启动和热调用的延迟。如果冷启动是个问题，可以用不同的方法解决，我们不会在这里深入讨论，因为有很多相关的信息。</p><p id="e4d2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">行刑本身呢？那里的一些服务呼叫特别慢吗？为了分解它，您可以为任何或所有函数启用X射线跟踪，并使用带有X射线跟踪的连接请求Dashbird，向您显示每个请求所花费的确切时间。此外，在代码中记录特定调用前后的事件会记录时间戳，这意味着您可以稍后测量代码中调用之间的时间。</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff lz"><img src="../Images/294e48f63f316d8151e542e18ac4a8b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FdfTD32__tUWLdJM.jpg"/></div></div></figure><p id="85be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您认为没有什么特别的东西会降低您的功能，冷启动也没有什么影响，那么可能是增加CPU会加快执行速度。这主要是一个基于试验和错误的改进流程，当添加更多内存时速度不再增加时，可能会有一个最佳点。</p><h1 id="f216" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">结论</h1><p id="e937" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">尽管无服务器带来了监控和可见性方面的新挑战，但正确的工具和开发实践可以轻松帮助您克服操作和管理问题。代理的必要性日益恶化，因为仅仅通过服务本身发出的数据就可以获得大量的信息。</p></div><div class="ab cl ma mb hc mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hn ho hp hq hr"><p id="b324" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">设置Dashbird大约需要5分钟，之后您将可以全面了解您的无服务器应用程序。在这里报名 <a class="ae jp" href="https://dashbird.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mh">试试吧。</em> </a></p></div></div>    
</body>
</html>