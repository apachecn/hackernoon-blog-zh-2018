<html>
<head>
<title>Animating widgets in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Flutter中制作部件动画</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/animating-widgets-in-flutter-413882881e98?source=collection_archive---------8-----------------------#2018-10-24">https://medium.com/hackernoon/animating-widgets-in-flutter-413882881e98?source=collection_archive---------8-----------------------#2018-10-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="15a7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Flutter是谷歌的移动应用SDK，用于在创纪录的时间内在iOS和Android上制作高质量的原生界面。Flutter的动画支持可以轻松实现多种动画类型。这篇文章描述了如何在Flutter中制作窗口小部件的动画。</p><h2 id="fd0e" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated">动画类型</h2><ul class=""><li id="7491" class="kk kl hu it b iu km iy kn jc ko jg kp jk kq jo kr ks kt ku dt translated"><strong class="it hv">补间动画</strong></li></ul><p id="0693" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在补间动画中，我们必须定义动画的开始点和结束点、时间轴以及定义过渡时间和速度的曲线。框架计算从起点到终点的中间值。</p><ul class=""><li id="d803" class="kk kl hu it b iu iv iy iz jc kv jg kw jk kx jo kr ks kt ku dt translated"><strong class="it hv">基于物理的动画</strong></li></ul><p id="ca30" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在基于物理的动画中，运动类似于真实世界的行为。当我们从地面以一个角度投掷一个球时，它将跟随抛射体运动。所有的计算，如飞行时间和旅行距离，都将根据物理定律来计算。</p><h2 id="300e" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated">为动画准备课程</h2><p id="0505" class="pw-post-body-paragraph ir is hu it b iu km iw ix iy kn ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">我们创建一个小部件，并以一定的时间间隔重复更新其状态，以使其具有动画效果。</p><p id="a48c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了创建一个小部件，我们编写一个类来扩展<code class="eh lb lc ld le b">StatefulWidget</code>类并覆盖它的<code class="eh lb lc ld le b">createState()</code>方法。这个方法返回一个<code class="eh lb lc ld le b">State</code>实例。</p><figure class="lg lh li lj fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff lf"><img src="../Images/ea987978653d691e770c6d687abc69f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BtUJF9aYAmth2zqAlVCfWg.png"/></div></div></figure><p id="d816" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">与我们的有状态小部件相关联的状态对象必须扩展<code class="eh lb lc ld le b">State</code>类，并且还使用一个名为<code class="eh lb lc ld le b">SingleTickerProviderStateMixin</code>的mixin。我们覆盖了build方法，在该方法中我们创建了将要制作动画的小部件对象。</p><figure class="lg lh li lj fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff lr"><img src="../Images/d4625de2966af99278a3d7d7e8fb27ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uq6y14ThDO1gZhcfE94VFg.png"/></div></div></figure><h2 id="815e" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated">创建补间动画</h2><p id="5ed9" class="pw-post-body-paragraph ir is hu it b iu km iw ix iy kn ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">在补间动画中，我们需要提供两个不同的值:开始值和结束值。然后，Flutter将自动生成一组中间值。我们将这些中间值应用于小部件的任何属性，以使其具有动画效果。</p><p id="d94a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们创建一个简单的补间动画，将一个小部件从屏幕的左边缘移动到屏幕的右边缘。为此，我们必须激活小部件的<code class="eh lb lc ld le b">left</code>属性。所有中间值都分配给小部件的<code class="eh lb lc ld le b">left</code>属性。</p><p id="4c58" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了创建和控制动画，我们需要一个<em class="ls">动画</em>对象和一个<em class="ls">动画控制器</em>对象。</p><pre class="lg lh li lj fq lt le lu lv aw lw dt"><span id="4ade" class="jp jq hu le b fv lx ly l lz ma">Animation&lt;double&gt; <strong class="le hv">animation</strong>;<br/>AnimationController <strong class="le hv">controller</strong>;</span></pre><p id="69a5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我们类的<em class="ls"> initState </em>方法中，我们创建了<em class="ls">动画控制器</em>。它期望一个<code class="eh lb lc ld le b">TickerProvider</code>对象作为它的输入之一。由于我们的类正在使用<code class="eh lb lc ld le b">SingleTickerProviderStateMixi </code> mixin，我们可以将<em class="ls">这个</em>传递给它。另一个参数是<em class="ls">持续时间</em>属性来指定动画的持续时间。</p><pre class="lg lh li lj fq lt le lu lv aw lw dt"><span id="ecd6" class="jp jq hu le b fv lx ly l lz ma"><strong class="le hv">controller </strong>= <strong class="le hv">new </strong>AnimationController(vsync: <strong class="le hv">this</strong>,<br/>    duration: <strong class="le hv">new </strong>Duration(seconds: 5));</span></pre><p id="83b9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建一个<code class="eh lb lc ld le b">Tween</code>对象，指定动画的开始和结束值。</p><pre class="lg lh li lj fq lt le lu lv aw lw dt"><span id="c475" class="jp jq hu le b fv lx ly l lz ma">Tween tween = <strong class="le hv">new </strong>Tween&lt;double&gt;(begin: 0.0, end: 400.0);</span></pre><p id="c28c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用补间对象创建动画对象。</p><pre class="lg lh li lj fq lt le lu lv aw lw dt"><span id="d63f" class="jp jq hu le b fv lx ly l lz ma"><strong class="le hv">animation </strong>= tween.animate(<strong class="le hv">controller</strong>);</span></pre><p id="699e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">animation对象为跑马灯的每一次跳动生成一个动画事件。为了处理事件，我们使用addListener()方法。在事件处理程序中调用setState()方法来更新小部件的状态并重新绘制它。</p><pre class="lg lh li lj fq lt le lu lv aw lw dt"><span id="3d75" class="jp jq hu le b fv lx ly l lz ma"><strong class="le hv">animation</strong>.addListener(() {<br/>  setState(() {<br/>  });<br/>});</span></pre><p id="e9f3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了启动动画，我们调用动画控制器的forward()方法。如果我们想让动画重复播放，我们可以调用repeat()方法。</p><pre class="lg lh li lj fq lt le lu lv aw lw dt"><span id="22de" class="jp jq hu le b fv lx ly l lz ma">controller.repeat();</span></pre><p id="2ea8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">动画现在准备好了。我们可以将它应用于任何小部件。</p><figure class="lg lh li lj fq lk fe ff paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="fe ff mb"><img src="../Images/805bc1972e621b9b41837e8ebc04d596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mZQMzcWuvOnx2u9DjPEbmQ.png"/></div></div></figure><h2 id="1762" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated">将动画应用到小部件</h2><p id="8036" class="pw-post-body-paragraph ir is hu it b iu km iw ix iy kn ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">现在我们创建一个小部件，并将动画值应用于它一个属性。</p><pre class="lg lh li lj fq lt le lu lv aw lw dt"><span id="49c8" class="jp jq hu le b fv lx ly l lz ma">child: <strong class="le hv">new </strong>Stack(<br/>    children: &lt;Widget&gt;[<br/>      <strong class="le hv">new </strong>Positioned(<br/>          child: FlutterLogo(),<br/>          height: 100.0,<br/>          width: 100.0,<br/>          left: <strong class="le hv">animation</strong>.<strong class="le hv">value</strong>,<br/>          top: 100.0  <br/>      )<br/>    ])</span></pre><p id="2868" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这里，我们已经将动画值分配给小部件的左侧属性。</p><h2 id="a9b6" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated">动画效果</h2><p id="459f" class="pw-post-body-paragraph ir is hu it b iu km iw ix iy kn ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">将此widget添加到应用程序的任何屏幕中。这是它的样子:</p><figure class="lg lh li lj fq lk fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/0a3632def2be41acf8c6c25c4cf9c392.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/1*JJaNs74lGf8pDEZNOjJ8cQ.gif"/></div><figcaption class="md me fg fe ff mf mg bd b be z ek">Flutter Animation</figcaption></figure><h2 id="b678" class="jp jq hu bd jr js jt ju jv jw jx jy jz jc ka kb kc jg kd ke kf jk kg kh ki kj dt translated">完全码</h2><pre class="lg lh li lj fq lt le lu lv aw lw dt"><span id="1cf1" class="jp jq hu le b fv lx ly l lz ma"><strong class="le hv">import 'package:flutter/animation.dart'</strong>;<br/><strong class="le hv">import 'package:flutter/material.dart'</strong>;</span><span id="46b5" class="jp jq hu le b fv mh ly l lz ma"><strong class="le hv">class </strong>AnimationApp <strong class="le hv">extends </strong>StatefulWidget {<br/>  @override<br/>  State&lt;StatefulWidget&gt; createState() {<br/>    <strong class="le hv">return new </strong>AnimationState();<br/>  }<br/>}</span><span id="1980" class="jp jq hu le b fv mh ly l lz ma"><strong class="le hv">class </strong>AnimationState <strong class="le hv">extends </strong>State&lt;AnimationApp&gt; <strong class="le hv">with </strong>SingleTickerProviderStateMixin {</span><span id="b279" class="jp jq hu le b fv mh ly l lz ma">Animation&lt;double&gt; <strong class="le hv">animation</strong>;<br/>  AnimationController <strong class="le hv">controller</strong>;</span><span id="133b" class="jp jq hu le b fv mh ly l lz ma">@override<br/>  Widget build(BuildContext context) {<br/>    <strong class="le hv">return new </strong>Container(<br/>        color: Colors.<em class="ls">white</em>,<br/>        child: <strong class="le hv">new </strong>Stack(<br/>            children: &lt;Widget&gt;[<br/>              <strong class="le hv">new </strong>Positioned(<br/>                  child: FlutterLogo(),<br/>                  height: 100.0,<br/>                  width: 100.0,<br/>                  left: <strong class="le hv">animation</strong>.<strong class="le hv">value</strong>,<br/>                  top: 100.0<br/>              )<br/>            ])<br/>    );<br/>  }</span><span id="4660" class="jp jq hu le b fv mh ly l lz ma">@override<br/>  <strong class="le hv">void </strong>initState() {<br/>    <strong class="le hv">super</strong>.initState();<br/>    <strong class="le hv">controller </strong>= <strong class="le hv">new </strong>AnimationController(vsync: <strong class="le hv">this</strong>,<br/>        duration: <strong class="le hv">new </strong>Duration(seconds: 4));</span><span id="c802" class="jp jq hu le b fv mh ly l lz ma">Tween tween = <strong class="le hv">new </strong>Tween&lt;double&gt;(begin: 0.0, end: 400.0);<br/>    <strong class="le hv">animation </strong>= tween.animate(<strong class="le hv">controller</strong>);</span><span id="9c3c" class="jp jq hu le b fv mh ly l lz ma"><strong class="le hv">animation</strong>.addListener(() {<br/>      setState(() {<br/>      });<br/>    });</span><span id="0bd7" class="jp jq hu le b fv mh ly l lz ma"><strong class="le hv">controller</strong>.repeat();</span><span id="d7c0" class="jp jq hu le b fv mh ly l lz ma">}<br/>}</span></pre><p id="61ff" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="ls">感谢阅读。如果你喜欢这篇文章，请随意点击那个按钮👏帮助其他人找到它。</em></p><p id="275f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="ls">本文是移动技术相关系列文章的一部分。如果您正在寻找一个移动应用程序开发团队，请联系我们:</em><a class="ae mi" href="mailto:info@47billion.com" rel="noopener ugc nofollow" target="_blank"><em class="ls">【info@47billion.com</em></a><em class="ls">。</em></p></div></div>    
</body>
</html>