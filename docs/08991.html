<html>
<head>
<title>Encrypt and Decrypt Data in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">加密和解密Node.js中的数据</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/encrypt-and-decrypt-data-in-node-js-7126829a217b?source=collection_archive---------12-----------------------#2018-10-31">https://medium.com/hackernoon/encrypt-and-decrypt-data-in-node-js-7126829a217b?source=collection_archive---------12-----------------------#2018-10-31</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="8cef" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Node.js提供了名为“crypto”的内置库，您可以使用它对数据执行加密操作。您可以对字符串、缓冲区和流进行加密操作。</p><p id="1dad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在本文中，我们将通过一些例子来说明如何在项目中进行这些操作。</p><p id="9420" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以使用多种加密算法。点击查看Node.js官方文档<a class="ae jp" href="https://nodejs.org/api/crypto.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="b3b8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了举例，我准备用AES(高级加密系统)算法。</p><h1 id="ca8f" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">创建新的node.js项目</h1><p id="1c1a" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">在系统中的任意位置创建一个新目录，并使用以下命令创建一个新项目:</p><p id="f528" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您已经通过手动构建安装了Node.js，那么它可能没有附带加密库。您可以运行此命令来安装加密依赖项。</p><pre class="kt ku kv kw fq kx ky kz la aw lb dt"><span id="c1fa" class="lc jr hu ky b fv ld le l lf lg">npm install crypto — save</span></pre><p id="5f7e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您已经使用预构建的包安装了它，则不需要这样做。</p><p id="4d4c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们继续前进。</p><h1 id="1c05" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">加密和解密数据(字符串、数字等)</h1><pre class="kt ku kv kw fq kx ky kz la aw lb dt"><span id="20ff" class="lc jr hu ky b fv ld le l lf lg">// Nodejs encryption with CTR<br/> const crypto = require(‘crypto’);<br/> const algorithm = ‘aes-256-cbc’;<br/> const key = crypto.randomBytes(32);<br/> const iv = crypto.randomBytes(16);</span><span id="7444" class="lc jr hu ky b fv lh le l lf lg">function encrypt(text) {</span><span id="95d9" class="lc jr hu ky b fv lh le l lf lg">let cipher = crypto.createCipheriv(‘aes-256-cbc’, Buffer.from(key), iv);<br/> let encrypted = cipher.update(text);<br/> encrypted = Buffer.concat([encrypted, cipher.final()]);<br/> return { iv: iv.toString(‘hex’), encryptedData: encrypted.toString(‘hex’) };<br/> }</span><span id="fb48" class="lc jr hu ky b fv lh le l lf lg">function decrypt(text) {</span><span id="e0bf" class="lc jr hu ky b fv lh le l lf lg">let iv = Buffer.from(text.iv, ‘hex’);<br/> let encryptedText = Buffer.from(text.encryptedData, ‘hex’);<br/> let decipher = crypto.createDecipheriv(‘aes-256-cbc’, Buffer.from(key), iv);<br/> let decrypted = decipher.update(encryptedText);<br/> decrypted = Buffer.concat([decrypted, decipher.final()]);<br/> return decrypted.toString();<br/> }</span><span id="1f95" class="lc jr hu ky b fv lh le l lf lg">var hw = encrypt(“Some serious stuff”)</span><span id="c61a" class="lc jr hu ky b fv lh le l lf lg">console.log(hw)<br/>console.log(decrypt(hw))</span></pre><p id="a9c4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下是输出:</p><figure class="kt ku kv kw fq lj fe ff paragraph-image"><div class="fe ff li"><img src="../Images/88efd8618d40ba40d8c4d5dd0b11da4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*62kGsC3p_Z4dZ3iS"/></div></figure><h1 id="1d05" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">加密和解密缓冲区</h1><p id="3992" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">您还可以加密和解密缓冲区。当你调用这个函数时，只需传递缓冲区来代替字符串，它就应该工作了。</p><p id="a43c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">像这样。</p><pre class="kt ku kv kw fq kx ky kz la aw lb dt"><span id="fc7b" class="lc jr hu ky b fv ld le l lf lg">var hw = encrypt(Buffer.from(“Some serious stuff”,”utf-8"))<br/>console.log(hw)<br/>console.log(decrypt(hw))</span></pre><p id="c190" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您还可以将流通过管道传输到encrypt函数中，以使安全的加密数据通过流。</p><h1 id="4808" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">结论</h1><p id="974d" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我希望这些示例能够帮助您开始使用nodejs加密。</p><p id="7185" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你有任何问题或疑问，请发微博给我@ codeforgeek或留下评论。我会尽快回复。</p></div><div class="ab cl lm ln hc lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hn ho hp hq hr"><p id="dfdf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="lt">原载于2018年10月31日</em><a class="ae jp" href="https://codeforgeek.com/2018/10/encrypt-and-decrypt-data-in-node-js/" rel="noopener ugc nofollow" target="_blank"><em class="lt">【codeforgeek.com</em></a><em class="lt">。</em></p></div></div>    
</body>
</html>