<html>
<head>
<title>Why Using HTML <form> Tag Caused Redux State to Reset</form></title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么使用HTML</h1><form> Tag Caused Redux State to Reset
<blockquote>原文：<a href="https://medium.com/hackernoon/why-using-html-form-tag-caused-redux-state-to-reset-fc42612a314f?source=collection_archive---------12-----------------------#2018-11-04">https://medium.com/hackernoon/why-using-html-form-tag-caused-redux-state-to-reset-fc42612a314f?source=collection_archive---------12-----------------------#2018-11-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="94dd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">想象一下React-Redux应用程序中的一个表单。每当用户填充表单中的一个字段时，Redux状态就会改变。提交按钮将HTTP POST请求发送到服务器，并重定向到下一个屏幕。不幸的是，有时提交按钮会导致应用程序返回到登录页面。</p><p id="e802" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是我在将一个<a class="ae jp" href="https://sailsjs.com/" rel="noopener ugc nofollow" target="_blank"> Sails </a> MVC应用转化为React-Redux时遇到的情况。由于这种情况不会经常发生，我认为这是一种竞争情况，在使用<a class="ae jp" href="http://extension.remotedev.io/" rel="noopener ugc nofollow" target="_blank"> Redux DevTools </a>进行调试时，我注意到出现了<code class="eh jq jr js jt b">@@INIT</code>动作，而不是我的预定义表单动作列表。</p><p id="bc37" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">一个快速的解决方案</strong>当然是不使用这个标签，或者选择一个可用的<a class="ae jp" href="https://www.npmtrends.com/formik-vs-react-form-vs-redux-form" rel="noopener ugc nofollow" target="_blank">表单库。虽然我能够处理这些解决方案的缺点，例如在删除标签的情况下需要实现验证，或者如果我选择使用现有的库，需要在项目中嵌入一个新的外部库，但我想深入挖掘并理解为什么会发生这种情况。</a></p><p id="a4e0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">这是我发现的:</strong></p><p id="b462" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在一个<a class="ae jp" href="https://reactjs.org/docs/forms.html" rel="noopener ugc nofollow" target="_blank"> React官方文档&gt;主要概念&gt;表单</a>的例子中，<code class="eh jq jr js jt b">onSubmit</code>函数被连接到<code class="eh jq jr js jt b">&lt;form&gt;</code>标签，这样:</p><pre class="ju jv jw jx fq jy jt jz ka aw kb dt"><span id="2899" class="kc kd hu jt b fv ke kf l kg kh">&lt;form onSubmit={this.handleSubmit}&gt;</span></pre><p id="4445" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在它内部，默认行为被阻止:</p><pre class="ju jv jw jx fq jy jt jz ka aw kb dt"><span id="61e7" class="kc kd hu jt b fv ke kf l kg kh">handleSubmit(e) {<br/>    e.preventDefault();<br/>  }</span></pre><p id="e929" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">成功了。但是被阻止的默认行为是什么，为什么会导致状态重置，为什么只是有时候？</p><p id="1610" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">答案出乎意料地出现在DevTools的<code class="eh jq jr js jt b">network</code>选项卡中。当单击submit没有得到预期的结果时，HTTP POST请求被取消(以红色显示在network选项卡中)，取而代之的是发送一个GET请求，在URL中包含表单数据。</p><p id="8dc9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这就是在Ajax出现之前<code class="eh jq jr js jt b">&lt;form&gt;</code>的工作方式。在提交时，默认情况下会调用一个http调用——它是GET。当这发生在<a class="ae jp" href="https://github.com/axios/axios/tree/14057dc0bd9811a9fda773588f66de9f4aa0f617" rel="noopener ugc nofollow" target="_blank"> Axios </a> HTTP调用之前时，它导致了Axios调用的取消，并且服务器以导致应用重置的方式进行响应。当Axios呼叫第一次发生时，应用程序按预期工作。</p><p id="8d48" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我从这个bug中学到的一件主要事情是，很久以前的知识在今天的开发中是有用的。</p></div></div>    
</form></body>
</html>