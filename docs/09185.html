<html>
<head>
<title>Build a Slack App to Assign GitHub Issues in 4 Steps with Node.js and Standard Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js和标准库构建一个Slack应用程序，通过4个步骤分配GitHub问题</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-a-slack-app-to-assign-github-issues-in-4-steps-with-node-js-and-standard-library-5daad80a19f9?source=collection_archive---------10-----------------------#2018-11-07">https://medium.com/hackernoon/build-a-slack-app-to-assign-github-issues-in-4-steps-with-node-js-and-standard-library-5daad80a19f9?source=collection_archive---------10-----------------------#2018-11-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="bebf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">GitHub问题是一个神奇的<a class="ae jp" href="https://hackernoon.com/tagged/tool" rel="noopener ugc nofollow" target="_blank">工具</a>来帮助管理<a class="ae jp" href="https://hackernoon.com/tagged/software" rel="noopener ugc nofollow" target="_blank">软件</a>项目。无论您的存储库是公共的还是私有的，issues都提供了一个很好的方法来跟踪任务、增强，当然还有bug。但是，众所周知，<a class="ae jp" href="https://slack.com" rel="noopener ugc nofollow" target="_blank">懈怠</a>，是<em class="jq">工作发生的地方。因此，如果我们能把GitHub的一些功能引入Slack，那就太好了，反正很多人在Slack上花了很多时间。</em></p><p id="39c6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">本指南将引导您在<a class="ae jp" href="https://stdlib.com" rel="noopener ugc nofollow" target="_blank">标准库</a>上设置一个API，当问题被创建或关闭时，该API从GitHub接收消息。这些消息随后被发送到Slack，在那里，渠道中的人们可以了解最新发生的事情，或者指派一名维护者来解决这个问题。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff jr"><img src="../Images/95d36d1a233ea6430364778b75742ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*KiIiwId3gLxVcORSit6U4A.gif"/></div></div></figure><p id="7967" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你不熟悉<a class="ae jp" href="https://www.stdlib.com" rel="noopener ugc nofollow" target="_blank">标准库</a>，我们是一个无服务器平台，让每个人都能在几秒钟内构建、发布和集成可扩展的API。借助我们的在线开发环境，<a class="ae jp" href="https://code.stdlib.com/" rel="noopener ugc nofollow" target="_blank">标准库上的代码，</a>您可以直接从浏览器进行构建和部署。</p><h2 id="b3b8" class="kd ke hu bd kf kg kh ki kj kk kl km kn jc ko kp kq jg kr ks kt jk ku kv kw kx dt translated">步骤1:创建一个Slack应用程序</h2><p id="660b" class="pw-post-body-paragraph ir is hu it b iu ky iw ix iy kz ja jb jc la je jf jg lb ji jj jk lc jm jn jo hn dt translated">导航到您的<a class="ae jp" href="https://api.slack.com/apps" rel="noopener ugc nofollow" target="_blank"> Slack应用仪表板</a>，并点击屏幕右上角的<strong class="it hv">创建新应用</strong>。你很快就会被重定向到标有“<strong class="it hv">基本信息</strong>的页面。在屏幕左侧，您会看到“<strong class="it hv">功能</strong>类别下的“<strong class="it hv">传入Webhooks </strong>”。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff ld"><img src="../Images/6a84fcb0c6a3a28b0b594cbd167e53d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4LVLOiM71ISR8PbOgB0CBw.png"/></div></div></figure><p id="3038" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">基于每个通道，传入的webhooks是将消息发布到Slack的最简单的方法。它们给你一个唯一的URL，可以代表你的机器人向一个特定的频道发布消息。除了创建它们之外，发布消息不需要认证，所以要确保保密。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff le"><img src="../Images/cca246af358fe08076d1b46ac0ffa05d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Q_ln42EGjPwH8NW68SlWA.png"/></div></div></figure><p id="7e39" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">通过点击下一个屏幕上的开关启用传入的webhooks。向下滚动到标题为“<strong class="it hv">您的工作区的web hook URL</strong>”的部分，并单击“<strong class="it hv">向工作区添加新的web hook</strong>”。选择一个渠道，点击<strong class="it hv">授权</strong>。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lf"><img src="../Images/a540167d12815455d64747595443d746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jsr6McaLhU9xtz08Weao1A.png"/></div></div></figure><p id="9f53" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请注意“<strong class="it hv"> Webhook URL </strong>”，因为稍后会用到它。</p><h2 id="f0b9" class="kd ke hu bd kf kg kh ki kj kk kl km kn jc ko kp kq jg kr ks kt jk ku kv kw kx dt translated">步骤2:部署发布Bot API</h2><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lg"><img src="../Images/f39513354f1aabd6f3a5d46a75ea84c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G66VDYPF6AJ6YKJEGz2LSQ.png"/></div></div></figure><p id="9d8d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">松弛部分都整理好之后，在标准库上打开<a class="ae jp" href="https://code.stdlib.com/?src=@steve/issue-bot" rel="noopener ugc nofollow" target="_blank">代码。如果您单击该链接，将自动打开issue-bot API的模板。如果没有，导航到“<strong class="it hv">社区API源</strong>”选项卡并搜索“<strong class="it hv"> steve/issue-bot </strong>”。打开<code class="eh lh li lj lk b">env.json</code>文件，您会发现三个变量。将步骤1中的Slack webhook URL输入到<code class="eh lh li lj lk b">dev</code>部分下的<code class="eh lh li lj lk b">SLACK_WEBHOOK_URL</code>中。</a></p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff ca"><img src="../Images/c206b3ad52f5ec4f94d49ccbd1cd986e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ThT6-32lFMbfdEEDSbjpuw.png"/></div></div></figure><p id="8b61" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在点击<strong class="it hv"> cmd/ctrl + R </strong>来部署您的API。您将看到一个“<strong class="it hv">参数错误</strong>，因为您的<code class="eh lh li lj lk b">functions/__main__.js</code>端点需要三个参数。这三个参数，<code class="eh lh li lj lk b">action</code>、<code class="eh lh li lj lk b">issue</code>和<code class="eh lh li lj lk b">repository</code>，将由GitHub提供(关于这些的更多信息，请查看<a class="ae jp" href="https://developer.github.com/v3/activity/events/types/#issuesevent" rel="noopener ugc nofollow" target="_blank">这些文档</a>)。说到GitHub，您需要注意您的API的“<strong class="it hv"> API端点URL </strong>”，您将把它交给GitHub。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff ll"><img src="../Images/1780ed84c1f09acde4156246e93c84dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pHfGYZcnD29ueuxE-abc7Q.png"/></div></div></figure><h2 id="74a6" class="kd ke hu bd kf kg kh ki kj kk kl km kn jc ko kp kq jg kr ks kt jk ku kv kw kx dt translated">步骤3:配置GitHub Webhook</h2><p id="3d41" class="pw-post-body-paragraph ir is hu it b iu ky iw ix iy kz ja jb jc la je jf jg lb ji jj jk lc jm jn jo hn dt translated">转到您要转发问题的GitHub repo，然后单击屏幕最右侧的“<strong class="it hv">设置</strong>选项卡。在那里，点击屏幕左侧的“<strong class="it hv"> Webhooks </strong>”部分。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lm"><img src="../Images/c913712014ab0dd541ec34156247796e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*spy2yrMdZwxc-0c0v-W1WQ.png"/></div></div></figure><p id="48d9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">点击右上角的<strong class="it hv">添加webhook </strong>后，系统会提示您填写表格。对于第一部分，输入步骤2中的“<strong class="it hv"> API端点URL </strong>”作为“<strong class="it hv">有效负载URL </strong>”，并选择“<strong class="it hv">应用程序/json </strong>”作为内容类型。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff ln"><img src="../Images/5716fa6a12437c2cf2f89d038d344baa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zuLjewVWcJzPm9EiQhl0SQ.png"/></div></div></figure><p id="29f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">向下滚动一点后，您可以选择将哪些事件转发到您的webhook。选择单个事件，并确保检查“<strong class="it hv">问题</strong>”。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lo"><img src="../Images/34ee662d9646725678d9583225c0230d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Potetq-oB2AYivNTyZefSA.png"/></div></div></figure><p id="82ae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">再次检查webhook是否标记为“<strong class="it hv">活动”</strong>，并点击“<strong class="it hv">添加webhook </strong>”。现在来测试一下:到你的GitHub repo打开一个问题！</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lp"><img src="../Images/bb720bb2bea02172f5b564df22348795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mc_dmMTOyYoD6x8Tkp5HZg.png"/></div></div></figure><p id="270e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">用户、存储库和问题元素都是将在浏览器中打开其各自页面的链接。目前，您的API还被配置为在问题关闭时转发。回到GitHub，关闭刚刚打开的问题。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lq"><img src="../Images/fefa9300b067628f28d0808eed6941c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2OpIK-1XSzq7P9yKBx05w.png"/></div></div></figure><h2 id="8ef4" class="kd ke hu bd kf kg kh ki kj kk kl km kn jc ko kp kq jg kr ks kt jk ku kv kw kx dt translated">步骤4:分配问题</h2><p id="4204" class="pw-post-body-paragraph ir is hu it b iu ky iw ix iy kz ja jb jc la je jf jg lb ji jj jk lc jm jn jo hn dt translated">所以，现在你的团队正在更新你的一个回复。下一个合乎逻辑的步骤是从Slack中指派一个维护者来解决这个问题。为了在Slack中启用交互式消息，您需要返回到应用仪表板，并导航到“<strong class="it hv">功能</strong>”类别下标题为“<strong class="it hv">交互式组件</strong>”的部分。一旦启用，您需要配置“<strong class="it hv">请求URL </strong>”。这将与步骤2中的“<strong class="it hv"> API端点URL </strong>相同，但是在末尾添加了<code class="eh lh li lj lk b">/assign/</code>。当用户指定维护者时，这将是被击中的API端点。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lr"><img src="../Images/64705f8c51d68920967d6c3b566510ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wde1erUnDxSsVPMeKSj45Q.png"/></div></div></figure><p id="3cc0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">Slack的最后一步是启用动态内容。这将让机器人预先填充一个下拉列表，其中包含有资格被分配到某个问题的人员列表。滚动到“<strong class="it hv">交互组件</strong>页面的底部，到标题为“<strong class="it hv">消息菜单</strong>的部分。作为“<strong class="it hv">选项加载URL </strong>”，输入步骤2中的“<strong class="it hv"> API端点URL </strong>”，并在末尾添加<code class="eh lh li lj lk b">/assign/list/</code>。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff ls"><img src="../Images/c7a36d60b9ed808ee6f7c821ae1b48e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ullx6TtAKvBFqCJuejlJVQ.png"/></div></div></figure><p id="5988" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">交互组件设置好了，GitHub这边还有一些工作要做。将问题分配给某人需要对GitHub进行经过身份验证的API调用，因此您需要创建一个访问令牌。导航到您的<a class="ae jp" href="https://github.com/settings/profile" rel="noopener ugc nofollow" target="_blank">个人资料设置页面</a>，点击左下角的<strong class="it hv">开发者设置</strong>。在这里，您需要单击左侧的最后一个选项“个人访问令牌”。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lt"><img src="../Images/a659b28b2cff189cef3e494032bec4fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JDtDULOwi1h8FQl6-RvPfA.png"/></div></div></figure><p id="f49d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在下一页，点击<strong class="it hv">生成新令牌</strong>。您需要命名这个令牌，并给它一个范围。令牌需要回购访问权限来分配问题，因此选择该选项。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lu"><img src="../Images/ded37f97680e7fb71e52efb0c0c2eb4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GnxukL9-Z511pFtzLt22vQ.png"/></div></div></figure><p id="eaf7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦创建，复制令牌并返回到标准库上的<a class="ae jp" href="https://code.stdlib.com/" rel="noopener ugc nofollow" target="_blank">代码。将令牌以及与令牌相关联的用户名复制到<code class="eh lh li lj lk b">GITHUB_TOKEN</code>和<code class="eh lh li lj lk b">GITHUB_USERNAME</code>下的<code class="eh lh li lj lk b">env.json</code>文件中。</a></p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lv"><img src="../Images/bcee8d33a4f5b38a66a3bbb8f7b7af39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ChnhpOj2G4w0P984kbwt6w.png"/></div></div></figure><p id="7fe7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">点击<strong class="it hv"> cmd/ctrl + R </strong>来重新部署您的API。为了测试新功能，创建另一个问题，或者更好的是，进入回购的webhooks页面，向下滚动到“<strong class="it hv">最近交付</strong>”。在那里你会看到GitHub发出的所有事件。找到您打开第一期时生成的邮件，然后单击“<strong class="it hv">重新发送”。</strong></p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lw"><img src="../Images/fe5b15f682a5552f544dd77110a386a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LQHT3ttmrdY3aUGGzjONUg.png"/></div></div></figure><p id="fb2d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">过一会儿，你会在Slack中看到一条新消息，与第一条相似，但有一个新的下拉菜单。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lx"><img src="../Images/755f603f065cdc0d6965e5a65096e6ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rsBJrM4P4Gys5FDkjMUoxQ.png"/></div></div></figure><p id="0cca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下拉列表将填充可能的受托人的GitHub用户名(即具有推送访问权限的帐户)。选择一个，过一会儿消息会更新以反映变化。当然，您的GitHub问题页面会显示新的受让人。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lr"><img src="../Images/4af61f0f552b09e2edfd1c419c9b0cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rk5fRdBJ9mp2U9YE7YjQWA.png"/></div></div></figure><h2 id="4e5c" class="kd ke hu bd kf kg kh ki kj kk kl km kn jc ko kp kq jg kr ks kt jk ku kv kw kx dt translated">仅此而已！</h2><p id="07f7" class="pw-post-body-paragraph ir is hu it b iu ky iw ix iy kz ja jb jc la je jf jg lb ji jj jk lc jm jn jo hn dt translated">我希望这篇教程有助于向您展示开始使用<a class="ae jp" href="https://stdlib.com" rel="noopener ugc nofollow" target="_blank">标准库</a>是多么容易。关于如何自动化你的工作流程、合并各种集成等等的其他想法，你可以在这里查看由团队<a class="ae jp" href="https://medium.com/stdlibhq" rel="noopener">撰写的更多指南。如果你有一个好主意想要分享，请通过电子邮件直接联系我:【steve@stdlib.com】T4，或者在Twitter上关注</a><a class="ae jp" href="https://twitter.com/stdlibhq" rel="noopener ugc nofollow" target="_blank">标准库</a>团队和<a class="ae jp" href="https://twitter.com/notoriaga" rel="noopener ugc nofollow" target="_blank">我</a>。</p></div><div class="ab cl ly lz hc ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="hn ho hp hq hr"><p id="2b32" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq"> Steve Meyer是Oberlin学院的应届毕业生，也是标准图书馆的软件工程师。当他不编程的时候，你可以发现他在烤面包，或者玩红色死亡救赎II。</em></p><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="mf mg l"/></div></figure></div></div>    
</body>
</html>