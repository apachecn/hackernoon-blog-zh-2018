<html>
<head>
<title>Simple i18n for Create React App with ttag</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ttag创建React应用程序的简单i18n</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/simple-i18n-for-create-react-app-with-ttag-4c2892343201?source=collection_archive---------4-----------------------#2018-11-17">https://medium.com/hackernoon/simple-i18n-for-create-react-app-with-ttag-4c2892343201?source=collection_archive---------4-----------------------#2018-11-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="c970" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">本文将描述如何通过5个简单的步骤，在几分钟内为<strong class="it hv"> Create React App </strong>和<a class="ae jp" href="https://ttag.js.org/" rel="noopener ugc nofollow" target="_blank"> ttag </a>设置翻译过程。</p><p id="2adb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先，至少有4个理由让你选择ttag搭配<a class="ae jp" href="https://hackernoon.com/tagged/cra" rel="noopener ugc nofollow" target="_blank"> CRA </a>:</p><ul class=""><li id="4229" class="jq jr hu it b iu iv iy iz jc js jg jt jk ju jo jv jw jx jy dt translated"><strong class="it hv">不需要执行弹出</strong>。</li><li id="f122" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">ttag是<strong class="it hv">框架不可知的解决方案</strong>,适用于任何地方<a class="ae jp" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> javascript </a>和babel可以工作的地方。支持<strong class="it hv"> jsx </strong>开箱。</li><li id="ab06" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">ttag使用翻译人员常用的gettext T21标准，并且可以与任何工作流程和翻译服务集成，如transifex，weblate e.t.c</li><li id="05ce" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">ttag不要求你使用像<code class="eh kf kg kh ki b">sprintf</code>这样的“外来”格式规则。您只需简单地使用<strong class="it hv">本机javascript模板文字</strong>进行格式化，例如:</li></ul><pre class="kj kk kl km fq kn ki ko kp aw kq dt"><span id="17c4" class="kr ks hu ki b fv kt ku l kv kw">t`Hello ${ name }`</span></pre><p id="49ff" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在本教程的最后，我们将为<strong class="it hv"> CRA </strong>启动页面设置<strong class="it hv"> i18n </strong>。</p><figure class="kj kk kl km fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff kx"><img src="../Images/82e77b5a31ede203b77c58589be3efd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mMnabttiOByRCMLPPVOX8w.jpeg"/></div></div></figure><blockquote class="lf lg lh"><p id="5163" class="ir is ke it b iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn jo hn dt translated">演示现场—<a class="ae jp" href="https://ttag-org.github.io/CRA-runtime-example/" rel="noopener ugc nofollow" target="_blank">https://ttag-org.github.io/CRA-runtime-example/</a></p><p id="5a74" class="ir is ke it b iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn jo hn dt translated">存储库—<a class="ae jp" href="https://github.com/ttag-org/CRA-runtime-example" rel="noopener ugc nofollow" target="_blank">https://github.com/ttag-org/CRA-runtime-example</a></p></blockquote><h1 id="1c0a" class="ll ks hu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh dt translated">第一步。装置</h1><p id="94eb" class="pw-post-body-paragraph ir is hu it b iu mi iw ix iy mj ja jb jc mk je jf jg ml ji jj jk mm jm jn jo hn dt translated">在这一步，我们将简单地设置新的CRA并安装ttag:</p><pre class="kj kk kl km fq kn ki ko kp aw kq dt"><span id="236e" class="kr ks hu ki b fv kt ku l kv kw">npx create-react-app ttag-app<br/>cd ttag-app<br/>npm i ttag<br/>npm i -D ttag-cli</span></pre><h1 id="5612" class="ll ks hu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh dt translated">第二步。创造。用于翻译的po文件</h1><blockquote class="lf lg lh"><p id="66f6" class="ir is ke it b iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn jo hn dt translated">你可以阅读更多关于gettext和。po文件格式<a class="ae jp" href="https://www.gnu.org/software/gettext/manual/html_node/PO-Files.html" rel="noopener ugc nofollow" target="_blank">此处</a></p></blockquote><p id="fc3c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">根据gettext的说法，我们需要为我们想要翻译的每种语言创建一个单独的<code class="eh kf kg kh ki b">.po</code>文件。我们可以使用<code class="eh kf kg kh ki b">ttag-cli</code>来创建这个文件:</p><pre class="kj kk kl km fq kn ki ko kp aw kq dt"><span id="1e37" class="kr ks hu ki b fv kt ku l kv kw">mkdir i18n <br/>npx ttag init uk i18n/uk.po</span></pre><p id="dfd7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh kf kg kh ki b">ttag init uk i18n/uk.po</code>将为乌克兰语创建<code class="eh kf kg kh ki b">po</code>文件(<code class="eh kf kg kh ki b">uk</code>是语言代码)。</p><blockquote class="lf lg lh"><p id="df26" class="ir is ke it b iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn jo hn dt translated">您可以在这里找到所有可用语言代码的列表—<a class="ae jp" href="https://www.w3.org/International/O-charset-lang.html" rel="noopener ugc nofollow" target="_blank">https://www.w3.org/International/O-charset-lang.html</a></p></blockquote><h1 id="f9fd" class="ll ks hu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh dt translated">第三步。用标签包装字符串</h1><p id="a36e" class="pw-post-body-paragraph ir is hu it b iu mi iw ix iy mj ja jb jc mk je jf jg ml ji jj jk mm jm jn jo hn dt translated">为了使字符串可翻译，你应该用标签来标记它们。让我们打开<code class="eh kf kg kh ki b">App.js</code>文件，使短语<code class="eh kf kg kh ki b">Learn React</code>可翻译:</p><pre class="kj kk kl km fq kn ki ko kp aw kq dt"><span id="0852" class="kr ks hu ki b fv kt ku l kv kw">import { t } from 'ttag'</span><span id="d872" class="kr ks hu ki b fv mn ku l kv kw">// Change 'Learn React' to <br/>t`Learn React`</span></pre><blockquote class="lf lg lh"><p id="bde5" class="ir is ke it b iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn jo hn dt translated"><a class="ae jp" href="https://ttag.js.org/docs/jsx-gettext.html" rel="noopener ugc nofollow" target="_blank">还有</a> <code class="eh kf kg kh ki b"><a class="ae jp" href="https://ttag.js.org/docs/jsx-gettext.html" rel="noopener ugc nofollow" target="_blank"><em class="hu">jt</em></a></code> <a class="ae jp" href="https://ttag.js.org/docs/jsx-gettext.html" rel="noopener ugc nofollow" target="_blank">标签，可以包含嵌套的jsx元素</a></p></blockquote><h1 id="5426" class="ll ks hu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh dt translated">第四步。更新翻译文件</h1><p id="71aa" class="pw-post-body-paragraph ir is hu it b iu mi iw ix iy mj ja jb jc mk je jf jg ml ji jj jk mm jm jn jo hn dt translated">为了让字符串出现在<code class="eh kf kg kh ki b">.po</code>文件中，我们可以从<code class="eh kf kg kh ki b">ttag-cli</code>使用<code class="eh kf kg kh ki b">update</code>命令</p><pre class="kj kk kl km fq kn ki ko kp aw kq dt"><span id="45ce" class="kr ks hu ki b fv kt ku l kv kw">npx ttag update i18n/uk.po src/</span></pre><p id="4b02" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们应该看到我们的短语<code class="eh kf kg kh ki b">Learn React</code>被添加到了<code class="eh kf kg kh ki b">uk.po</code>文件中:</p><pre class="kj kk kl km fq kn ki ko kp aw kq dt"><span id="15fe" class="kr ks hu ki b fv kt ku l kv kw">msgid "Learn React" <br/>msgstr ""</span></pre><p id="fae8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh kf kg kh ki b">msgstr</code>是必须添加翻译的地方:</p><pre class="kj kk kl km fq kn ki ko kp aw kq dt"><span id="902e" class="kr ks hu ki b fv kt ku l kv kw">msgid "Learn React"<br/>msgstr "Вивчити React"</span></pre><h1 id="69d4" class="ll ks hu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh dt translated">第五步。加载翻译</h1><p id="cd8f" class="pw-post-body-paragraph ir is hu it b iu mi iw ix iy mj ja jb jc mk je jf jg ml ji jj jk mm jm jn jo hn dt translated">在这最后一步，我们应该加载并应用来自<code class="eh kf kg kh ki b">.po</code>文件的翻译。为了能够加载<code class="eh kf kg kh ki b">po</code>文件，让我们用<code class="eh kf kg kh ki b">ttag-cli</code>将其转换为<code class="eh kf kg kh ki b">json</code>格式:</p><pre class="kj kk kl km fq kn ki ko kp aw kq dt"><span id="9e65" class="kr ks hu ki b fv kt ku l kv kw">npx ttag po2json i18n/uk.po &gt; i18n/uk.po.json</span></pre><p id="5a9c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在我们可以通过简单的导入或请求来加载<code class="eh kf kg kh ki b">uk.po.json</code>文件。</p><figure class="kj kk kl km fq ky"><div class="bz el l di"><div class="mo mp l"/></div></figure><p id="d902" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh kf kg kh ki b">getLocale</code>功能的实现取决于您的需求。您可以选择将区域设置存储在url、cookies、localStorage或其他地方。类似于:</p><pre class="kj kk kl km fq kn ki ko kp aw kq dt"><span id="6cdc" class="kr ks hu ki b fv kt ku l kv kw">function getLocale() {  <br/>    return cookie.get(LOCALE_COOKIE) || 'en';<br/>}</span></pre><blockquote class="lf lg lh"><p id="6e34" class="ir is ke it b iu iv iw ix iy iz ja jb li jd je jf lj jh ji jj lk jl jm jn jo hn dt translated"><a class="ae jp" href="https://github.com/ttag-org/CRA-runtime-example/blob/master/app/src/i18nInit.js" rel="noopener ugc nofollow" target="_blank">下面是我举的</a> <code class="eh kf kg kh ki b"><a class="ae jp" href="https://github.com/ttag-org/CRA-runtime-example/blob/master/app/src/i18nInit.js" rel="noopener ugc nofollow" target="_blank"><em class="hu">i18nInit</em></a><em class="hu">.js</em></code>的例子</p></blockquote><p id="2db8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我建议将i18n设置移动到一个单独的模块中，并在你的应用程序入口点顶部(在<code class="eh kf kg kh ki b"><a class="ae jp" href="https://github.com/ttag-org/CRA-runtime-example/blob/master/app/src/index.js" rel="noopener ugc nofollow" target="_blank">src/index.js</a></code>的某个地方)的任何其他导入之前导入它</p><h1 id="ad68" class="ll ks hu bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh dt translated">就是这样！</h1><p id="d9d8" class="pw-post-body-paragraph ir is hu it b iu mi iw ix iy mj ja jb jc mk je jf jg ml ji jj jk mm jm jn jo hn dt translated">最后，您还应该设置一些语言切换逻辑。您可以参考示例<a class="ae jp" href="https://github.com/ttag-org/CRA-runtime-example/blob/master/app/src/App.js" rel="noopener ugc nofollow" target="_blank">存储库</a>来了解如何做到这一点的细节。另外，ttag还允许您在构建步骤中预编译翻译。你可以在<a class="ae jp" href="https://ttag.js.org/docs/create-react-app.html#precompiled-translations" rel="noopener ugc nofollow" target="_blank">文档</a>中了解如何做到这一点。</p><p id="74d2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">希望这将有助于人们与CRA设置翻译工作流程。感谢任何反馈。请随意创建<a class="ae jp" href="https://github.com/ttag-org/ttag" rel="noopener ugc nofollow" target="_blank">问题</a>并发表评论。</p><p id="6e98" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">编码快乐！</p><h2 id="a2f4" class="kr ks hu bd lm mq mr ms lq mt mu mv lu jc mw mx ly jg my mz mc jk na nb mg nc dt translated">链接:</h2><ul class=""><li id="a95d" class="jq jr hu it b iu mi iy mj jc nd jg ne jk nf jo jv jw jx jy dt translated">https://ttag.js.org/docs/create-react-app.html和CRA的官方文件—<a class="ae jp" href="https://ttag.js.org/docs/create-react-app.html" rel="noopener ugc nofollow" target="_blank"/></li><li id="2270" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">ttag lib—<a class="ae jp" href="https://github.com/ttag-org/ttag" rel="noopener ugc nofollow" target="_blank">https://github.com/ttag-org/ttag</a></li><li id="3da5" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">巴别塔插件ttag—<a class="ae jp" href="https://github.com/ttag-org/babel-plugin-ttag" rel="noopener ugc nofollow" target="_blank">https://github.com/ttag-org/babel-plugin-ttag</a></li><li id="2290" class="jq jr hu it b iu jz iy ka jc kb jg kc jk kd jo jv jw jx jy dt translated">ttag-CLI—<a class="ae jp" href="https://github.com/ttag-org/ttag-cli" rel="noopener ugc nofollow" target="_blank">https://github.com/ttag-org/ttag-cli</a></li></ul><figure class="kj kk kl km fq ky"><div class="bz el l di"><div class="ng mp l"/></div></figure></div></div>    
</body>
</html>