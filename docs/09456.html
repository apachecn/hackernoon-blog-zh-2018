<html>
<head>
<title>Full guide to building a Serverless API with zero code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">零代码构建无服务器API的完整指南</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/full-guide-to-building-a-serverless-api-with-zero-code-c4f7871998f5?source=collection_archive---------4-----------------------#2018-11-19">https://medium.com/hackernoon/full-guide-to-building-a-serverless-api-with-zero-code-c4f7871998f5?source=collection_archive---------4-----------------------#2018-11-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="6c6b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">API Gateway的一个常见用例是在Lambda函数之上构建API端点。它还可以用作API代理来连接AWS服务。在本指南中，我将带您了解如何仅使用API Gateway和DynamoDB创建自己的API，并介绍增强API端点的高级功能，例如:</p><ul class=""><li id="b6e7" class="jp jq hu it b iu iv iy iz jc jr jg js jk jt jo ju jv jw jx dt translated">映射模板、集成请求和集成响应。</li><li id="65d5" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx dt translated">错误处理和请求验证。</li><li id="42d1" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx dt translated">使用AWS Cognito和Lambda Authorizer进行身份验证。</li><li id="8caa" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx dt translated">使用计划使用和API键的API节流。</li><li id="8e6d" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx dt translated">API文档生成。</li><li id="c8d7" class="jp jq hu it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx dt translated">API网关自定义域。</li></ul><h1 id="08e3" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">设置DynamoDB</h1><p id="a95e" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">首先，创建一个名为<em class="lg"> movies </em>的DynamoDB表，用一个<em class="lg"> id </em>作为分区键(将读/写容量保留为默认值):</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff lh"><img src="../Images/300a708051d5e6cc0bd0a558114b7e97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s2Geo90HVnR45oOql9AxCw.png"/></div></div></figure><p id="6f11" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，在表中插入几个项目，应该是这样的:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff lt"><img src="../Images/303aeac394b9bd72186f4abf954045fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cFs5QvTFhQ7ZwcZ2mw8MlQ.png"/></div></div></figure><p id="4532" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，我们需要授权API网关访问DynamoDB表。因此，我们需要创建一个可由API网关承担的IAM角色:</p><figure class="li lj lk ll fq lm"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="d43a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">该角色将给予API Gateway权限来调用对<em class="lg">电影</em>表的以下DynamoDB操作:</p><figure class="li lj lk ll fq lm"><div class="bz el l di"><div class="lu lv l"/></div></figure><h1 id="e940" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">API端点</h1><p id="85d1" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">在深入了解该架构的细节之前，下图显示了API Gateway和DynamoDB如何适应API架构:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff lw"><img src="../Images/45361f19e03b5720ebac367849ff1077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZ2JPtJvwuaUDu1CSpet6g.png"/></div></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek">Serverless API Architecture</figcaption></figure><p id="08c6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当调用API端点时，请求将通过API网关，API网关将调用适当的DynamoDB操作。这将返回一个响应，该响应由API网关以JSON格式代理给客户机。</p><h2 id="3a91" class="mb ke hu bd kf mc md me kj mf mg mh kn jc mi mj kr jg mk ml kv jk mm mn kz mo dt translated">获取/电影</h2><p id="740b" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">从<a class="ae mp" href="https://console.aws.amazon.com/apigateway/home?region=eu-west-1#/apis/create" rel="noopener ugc nofollow" target="_blank"> API网关控制台</a>创建名为<em class="lg"> MoviesAPI </em>的新API，并创建一个新资源，姑且称之为<em class="lg"> movies </em>:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff mq"><img src="../Images/6e002493b09bb086072f3d467f991e4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VKPvABEnPqeHTUIHwXjnnw.png"/></div></div></figure><p id="2433" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在<em class="lg"> /movies </em>资源上通过点击“<strong class="it hv"> Create Method </strong>”暴露一个<em class="lg"> GET </em>方法。在“<strong class="it hv">集成类型</strong>下选择<em class="lg"> AWS服务</em>，选择<strong class="it hv"> DynamoDB </strong>服务，设置HTTP方法为<em class="lg"> POST </em>，动作类型为<strong class="it hv"> Scan </strong>操作。</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff mr"><img src="../Images/74d7c62eef1f9cefbf46a5ebc52f6c44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bufrdu6IjGNAdBTT7pumXw.png"/></div></div></figure><p id="2401" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来，我们需要将进入API Gateway的HTTP请求转换为对DynamoDB的正确的<strong class="it hv"> Scan </strong>请求。在API网关控制台中，选择“<strong class="it hv">集成请求</strong>”。在底部，我们可以选择身体贴图模板。这里，创建一个新的<em class="lg">应用程序/json </em>映射模板，配置如下:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ms"><img src="../Images/522bcb2bd5a152677dc7d086f19bca26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4PX_2EfuAJwc4je5hzW7sw.png"/></div></div></figure><p id="b941" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从“<strong class="it hv">动作</strong>部署API并创建新的部署阶段，将显示调用URL:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff mt"><img src="../Images/1104fcb6de3a03f5b2f82ca63bbde6b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C19v09YGoBAvKd_62oX95g.png"/></div></div></figure><p id="f456" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">将您的浏览器指向给定的URL，或者使用像Postman这样的现代REST客户端。端点将返回JSON格式的电影列表:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff mu"><img src="../Images/0ac3ee054f8716aff7161cfe53607749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5GYtvhMOUN04bXvool5EWg.png"/></div></div></figure><p id="80b0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">输出以DynamoDB响应格式返回，为了将原始响应映射到传统的JSON对象结构，我们将使用<strong class="it hv">集成响应</strong>特性。</p><p id="d964" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">点击“<strong class="it hv">获取</strong>方法，导航到“<strong class="it hv">集成响应</strong>，展开200响应代码。展开“<strong class="it hv">映射模板</strong> s”部分。在<strong class="it hv"> Content-Type </strong>中，选择<em class="lg"> application/json </em>并创建一个映射模板，该模板循环遍历<em class="lg"> Items </em>数组中的每个项目，提取电影项目的相关属性并将它们放入一个响应结构中:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff mv"><img src="../Images/2cb98cc8aa08fbea8fa3aa03560b3c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TfaNwGe7ABXfwp6CZ12EyQ.png"/></div></div></figure><blockquote class="mw mx my"><p id="10b9" class="ir is lg it b iu iv iw ix iy iz ja jb mz jd je jf na jh ji jj nb jl jm jn jo hn dt translated"><em class="hu">映射模板</em>是用<a class="ae mp" href="http://velocity.apache.org/engine/devel/vtl-reference-guide.html" rel="noopener ugc nofollow" target="_blank">速度模板语言(VTL) </a>表达的脚本，并使用<a class="ae mp" href="http://goessner.net/articles/JsonPath/" rel="noopener ugc nofollow" target="_blank"> JSONPath表达式</a>应用于有效载荷。</p></blockquote><p id="1f0e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，您现在应该会看到一个格式化的响应。</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff mu"><img src="../Images/940880fd708feea567402a536dda79fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R__snyuvqGagu3lW3mJ_Zw.png"/></div></div></figure><h2 id="d65a" class="mb ke hu bd kf mc md me kj mf mg mh kn jc mi mj kr jg mk ml kv jk mm mn kz mo dt translated">获取/电影/:id</h2><p id="77c2" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">第二个端点将负责根据客户端提供的ID获取电影。因此，应该创建一个带有path参数的新资源。ID的值将通过<em class="lg"> $input.params('id') </em>方法获得:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nc"><img src="../Images/91ece383b6a7294f73ac28b397283b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MOJ4H7P4waKOECwbujNE9A.png"/></div></div></figure><p id="a624" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">公开一个GET方法，然后将资源链接到DynamoDB服务。该动作将被<em class="lg"> GetItem </em>操作:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nd"><img src="../Images/a9c6c097d34c4880a083c3c642b4b97c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZdqJqWzttBuJczyL1KbjRg.png"/></div></div></figure><p id="4e52" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同样，为集成请求指定一个主体映射模板，现在使用以下模板:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ne"><img src="../Images/c9e9e004f4d9fdb16bf0b2cb2769abfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-I6AZzWOyVkJGFqZVoiZQ.png"/></div></div></figure><p id="69c8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当用一个ID调用API URL时，如果存在对应于该ID的电影，则返回该电影。</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff mu"><img src="../Images/44234949c2700c2e277ae9f32ec4d79d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wCHZtSU6k3reRrGhvjrjg.png"/></div></div></figure><p id="e851" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">同样，我们将使用integration response将原始DynamoDB响应映射到我们之前定义的类似JSON对象结构:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nd"><img src="../Images/67e728f1b82ca9ca546db2a73c1c38e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UIZkb7Q1qxtCjH6gYPiAEw.png"/></div></div></figure><p id="e9e6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您再次测试它，将会返回以下JSON:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nf"><img src="../Images/c3ca65ce13ef57c4d5572b4ad0ae2d98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LD5gIz7idMVmG6Oj_GULYw.png"/></div></div></figure><h2 id="3d4c" class="mb ke hu bd kf mc md me kj mf mg mh kn jc mi mj kr jg mk ml kv jk mm mn kz mo dt translated">海报/电影</h2><p id="e56c" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">现在我们知道了<strong class="it hv"> GET </strong>方法在有和没有路径参数的情况下是如何工作的。下一步是向表中插入一个新项目。用<strong class="it hv"> PutItem </strong>作为动作创建一个<strong class="it hv"> POST </strong>方法:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ng"><img src="../Images/bbbd9773c1a01715019ddc0aa8142775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7FxakUxjY6Wv-Oe_YHI2w.png"/></div></div></figure><p id="7f6c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将创建一个映射模板，将客户机请求转换成DynamoDB API <strong class="it hv"> PutItem </strong>需要的结构。下面的映射模板创建了DynamoDB PutItem API所需的JSON结构。使用<em class="lg"> $input </em>变量从请求JSON中引用三个输入变量:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nh"><img src="../Images/ec150d992ea96a7fd0888c11e0dbc944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5nvZtI7UdH4apxD9QdQCyg.png"/></div></div></figure><p id="9482" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">回到<strong class="it hv">方法执行</strong>窗格点击<strong class="it hv">测试</strong>。创建一个与上面记录的API定义相匹配的示例请求体，然后选择“<strong class="it hv"> Test </strong>”。例如，您的请求正文可以是:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ni"><img src="../Images/fddc39d2d2140bc28b4ae43fb3556508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fmD2eykRMjpu1QByPnKQCA.png"/></div></div></figure><p id="5ae6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">导航到DynamoDB控制台，查看<em class="lg"> movies </em>表，显示请求确实被成功处理:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nj"><img src="../Images/eb52c666b4b3d9758ce9632554c89ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3TQ91BauRDh-c2RaXuOVNw.png"/></div></div></figure><p id="8507" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">尝试在不给出电影名称属性的情况下插入新电影。将返回以下错误:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nk"><img src="../Images/0d79e3cc4ecb88a36fc6548c701a81e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BK470vbhjZIMCVH9V4RcSQ.png"/></div></div></figure><p id="a86a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是一个DynamoDB PutItem错误。幸运的是，API Gateway允许您在调用下游资源(在我们的例子中是DynamoDB表)之前验证请求体。为了实现这一点，我们将使用API网关模型。模型定义了有效载荷数据结构。模型定义是使用JSON模式草案4编写的。</p><p id="973d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在API Gateway中，导航到Models选项卡并创建一个新模型。按如下方式填写表格:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nl"><img src="../Images/0b57dcf43875acd88bac73657ab2d9c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y5GGTZSJjQ7R0ulrn6ehuw.png"/></div></div></figure><p id="26d9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上面的模型定义了一个具有3个属性的<em class="lg">电影</em>实体，并要求定义<em class="lg"> id </em>和<em class="lg"> name </em>属性(在验证期间使用)。</p><p id="2d91" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">返回到“<strong class="it hv">资源</strong>”页面，从<strong class="it hv"> POST </strong>方法中点击“<strong class="it hv">方法请求</strong>，启用请求验证器选项，如下所示:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nm"><img src="../Images/f8d3ce115e7372d7a4b34bd77476caab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QZlGurMRrcQO5O94qIfAnQ.png"/></div></div></figure><p id="40de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您试图在不提供所需参数的情况下插入新电影，将会返回错误的请求消息错误:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nn"><img src="../Images/0bb1c65c7f5909146e46686be59d9e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wGkDg5Vl8V8RGJQT7FX30w.png"/></div></div></figure><p id="3cdc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以覆盖来自“<strong class="it hv">网关响应</strong>的默认400消息，如下所示:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff no"><img src="../Images/4e79f3b5add5dff4dea661d36764f2c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TbZlmRBAFRDCnGXXoB8Azw.png"/></div></div></figure><p id="5b03" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，将返回用户定义的错误消息:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff np"><img src="../Images/8f455485353fbceb2fc7756b9bcdd599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dq6aCoeJMo8jw6CSPztf0A.png"/></div></div></figure><p id="1a18" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">太好了！尝试实现<strong class="it hv"> PUT </strong>和<strong class="it hv"> DELETE </strong>方法:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nq"><img src="../Images/cb52208d3c74e8c070299759030bbeed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1c_EHGDhytn6bje62RGcpg.png"/></div></div></figure><h1 id="1806" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">证明</h1><p id="bd0d" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">到目前为止，我们构建的无服务器API就像一个魔咒。然而，它是对公众开放的，任何人都可以将数据插入DynamoDB表，只要他/她有API网关调用URL。幸运的是，API Gateway提供了两种处理身份验证的方法:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff lw"><img src="../Images/6af3878a4e1941d2906c340fe7d9d57e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DL-NdfG9WaoS2fjhr74gyA.png"/></div></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek">API Gateway Authentication with Cognito and Lambda Authorizer</figcaption></figure><h2 id="16e5" class="mb ke hu bd kf mc md me kj mf mg mh kn jc mi mj kr jg mk ml kv jk mm mn kz mo dt translated">亚马逊认知</h2><p id="a4f3" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">创建一个新的用户池，点击“<strong class="it hv">查看默认设置</strong>创建一个具有默认设置的池。创建过程结束时应显示一条成功消息:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nr"><img src="../Images/787cd0f02c6fd17950b6e613477c72e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cer-sDpqruCw15tZhp89vw.png"/></div></div></figure><p id="e8fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建您的第一个用户池后，从“<strong class="it hv">常规设置”</strong>下的“<strong class="it hv">应用客户端”</strong>注册您的无服务器API，并选择“<strong class="it hv">添加应用客户端”</strong>。为应用程序命名，并检查基于服务器的认证<strong class="it hv"> ADMIN_NO_SRP_AUTH </strong>选项:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ns"><img src="../Images/5aa8568968226952d1a25d6a4feb9a46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnHWW3ydGf-MtiMiPbignw.png"/></div></div></figure><p id="f345" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用AWS命令行创建新用户:</p><figure class="li lj lk ll fq lm"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="e0e2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在已经创建了用户池，我们可以配置API网关，在授予对DynamoDB的访问权限之前，验证来自成功的用户池身份验证的访问令牌。</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nt"><img src="../Images/2d9d7833909b578228570fdffa195000.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2O1xL2yriE4v5r7T07shig.png"/></div></div></figure><p id="fc82" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">要开始保护API访问，请转到API网关控制台，选择我们之前在中构建的RESTful API，然后单击导航栏中的“<strong class="it hv">Authorizers”</strong>。点击<strong class="it hv">创建新授权人</strong>按钮，选择<strong class="it hv">cogn ITO</strong>。然后，选择我们之前创建的用户池，并将令牌源字段设置为<em class="lg">授权</em>。这定义了包含API调用者身份令牌的传入请求头的名称，用于授权:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nu"><img src="../Images/7066f07355d46ffe3d8a0e8fdab9d127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G03ub_qNsVNW5UyHQMw_hg.png"/></div></div></figure><p id="431b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，您可以保护所有端点，例如，为了保护负责创建新电影的端点。点击<em class="lg"> /movies </em>资源下对应的<em class="lg"> POST </em>方法。点击“<strong class="it hv">方法请求”</strong>框，然后点击“<strong class="it hv">授权”</strong>，选择我们之前创建的用户池:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nv"><img src="../Images/b5bc499ba2d3d6be5ad956253bf60147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YAoxI-EatokYqCEJbbotEw.png"/></div></div></figure><p id="a93f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">完成后，重新部署API，并尝试使用API调用URL插入一部新电影。这一次，端点受到保护，并需要身份验证:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nw"><img src="../Images/d8990189f5ec48d989b8802fa1044dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tx4OXrRWYNkOVuI8AIjOjg.png"/></div></div></figure><p id="809d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了进行身份验证，我们需要从用户池中获取登录用户的身份令牌，并将身份令牌包含在API网关请求的<em class="lg">授权</em>头中。发出以下AWS CLI命令以获取新令牌:</p><figure class="li lj lk ll fq lm"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="a462" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上面的命令获取一个JSON文件，该文件具有以下属性:</p><figure class="li lj lk ll fq lm"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="0252" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦执行，前面的命令将返回以下JSON响应:</p><figure class="li lj lk ll fq lm"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="e7c8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">复制ID令牌并将其添加到您的请求的<em class="lg">授权</em>标题中:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nx"><img src="../Images/0f88aa525ff5f29034cc29294eecb064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N1-IgjbsRHmWUpYfP3D2yA.png"/></div></div></figure><p id="c9eb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">API网关将验证令牌，并将调用<em class="lg">电影</em>表上的<em class="lg"> PutItem </em>操作，这将向表中插入一部新电影:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ny"><img src="../Images/ea7690ca96157cdacd01a73230226c71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Zn2Ixum6PEYUb5couo1Mw.png"/></div></div></figure><h2 id="4185" class="mb ke hu bd kf mc md me kj mf mg mh kn jc mi mj kr jg mk ml kv jk mm mn kz mo dt translated">λ授权器</h2><p id="541c" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">当客户端向您的API发送请求时，它将通过API网关，API网关将从请求中提取令牌，并用它调用您的Lambda函数授权器。该函数评估令牌，生成策略并将其发送回API网关。API Gateway评估策略并调用为API端点注册的DynamoDB操作。</p><p id="d72e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了简单起见，我们的函数将验证客户机提供的令牌是否等于我们的secret(环境变量),并根据结果返回一个策略文档。下面是Node写的函数处理程序源代码。JS:</p><figure class="li lj lk ll fq lm"><div class="bz el l di"><div class="lu lv l"/></div></figure><p id="1aaf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">返回API网关，创建一个新的“<strong class="it hv"> Lambda授权器</strong>”，并将<em class="lg">授权</em>设置为API网关将从中提取令牌的标头:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nz"><img src="../Images/10ff08e4de50c393e51fa8fdde78531c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pHZo_SRIeEYYiGjn-mzVFA.png"/></div></div></figure><p id="f15d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">选择您想要保护的方法，比方说，它将是负责从表中删除电影的端点。点击<strong class="it hv">方法请求</strong>，在<strong class="it hv">授权</strong>下选择您的新授权人:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff oa"><img src="../Images/97d69e27676671695b62ae5c7a693599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eTYD8e_VbSbxqG3CiLYvrQ.png"/></div></div></figure><p id="6b75" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们试着呼叫端点，不出所料，我们没有接通真正的端点:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ob"><img src="../Images/6bcac63afb091c9567860bc4e2af0086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0zM85zCJ1HC1fQGdd8pWOw.png"/></div></div></figure><p id="51cf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您在请求的<em class="lg">授权</em>头中包含了秘密令牌，您应该能够删除一个项目:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff oc"><img src="../Images/b1fb625c0637ec59e4d0dbdcc22f8e85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TxpWhOJdd9nX6pITYwyVeA.png"/></div></div></figure><p id="c7bd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看起来不错！</p><h1 id="b6e9" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">API节流</h1><p id="7354" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">您可以使用结合API键的使用计划来设置API的方法级限制，并定义客户端可以访问API的数量和速度(请求速率和配额)。</p><p id="d6c7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下过程描述了如何创建使用计划:</p><h2 id="747d" class="mb ke hu bd kf mc md me kj mf mg mh kn jc mi mj kr jg mk ml kv jk mm mn kz mo dt translated">API用法</h2><p id="3ba3" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">创建一个名为<strong class="it hv">基本</strong>的使用计划，其<em class="lg">限制</em>为每秒1个请求，而<em class="lg">配额限制</em>为每天10000个请求:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff od"><img src="../Images/9ce4e9a8a11d557651ad60ed9f4b5439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HST4Aygkfi5IzlgEypgG-Q.png"/></div></div></figure><p id="b918" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">创建名为<strong class="it hv"> premium </strong>的第二个使用计划，其<em class="lg">阈值限制</em>为每秒10个请求，而<em class="lg">配额限制</em>为每天100万个请求:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff oe"><img src="../Images/2a6c6c18ca28e72bd9e6a86714ad12a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NR-U0JceqBIvxqv8SE5fug.png"/></div></div></figure><h2 id="09e4" class="mb ke hu bd kf mc md me kj mf mg mh kn jc mi mj kr jg mk ml kv jk mm mn kz mo dt translated">API键</h2><p id="208b" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">接下来，创建两个API键:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff of"><img src="../Images/56950ece9e7fdb21654f5b0d16ba88f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-wdRBhEaFMLqGNaoZCRLg.png"/></div></div></figure><p id="3d4b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">将第一个API密钥分配给基本使用计划，将第二个密钥分配给高级使用计划:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nm"><img src="../Images/f5e194f5eada326665d1c90e9037d8d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CRA6wyt276SE0GJrzq07pg.png"/></div></div></figure><p id="105a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">将我们创建的使用计划与API部署阶段相关联:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff nq"><img src="../Images/f6e50acc1905f79932bf806d47aa184f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ueco9nppv05IJEbrgHwHfQ.png"/></div></div></figure><p id="330a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">将API方法配置为需要API密钥:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff og"><img src="../Images/5b051759dec18776e74292a2f1e89f58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-QIjv7kHgJ-dOwbaM3WVjg.png"/></div></div></figure><p id="7793" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">部署或重新部署API以使需求生效:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff oh"><img src="../Images/8af39549b387cec5ce700c95834ec00c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--G02gnygsWPjqrjBUYY1Q.png"/></div></div></figure><p id="751c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，如果您添加了<strong class="it hv"> x-api-key </strong>头。如果一切顺利，您将收到如下输出:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff oi"><img src="../Images/85a9f06eab224eb9423d95b30fdf5cf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KhnTCsl62tpzNCpZPouyPQ.png"/></div></div></figure><p id="8907" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果超出了与API键相关的速率限制或配额限制，将返回“<strong class="it hv">太多请求</strong>”HTTP错误:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff oh"><img src="../Images/ad99e3f2102bb8de3f11268c8b41fd26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RcExFeW7Um3xElB96zFXxQ.png"/></div></div></figure><h1 id="7e3b" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated"><strong class="ak">自定义域名</strong></h1><p id="fe3c" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">您可以将自己的域名用于API和部署阶段，创建一个由<strong class="it hv">ACM</strong>(Amazon Certificate Manager)证书支持的<strong class="it hv">自定义域名</strong>:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff oj"><img src="../Images/5c79f5c8ec0dc6121979b04c71e1ff06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eN3V5bm_492P37ISGSqE4A.png"/></div></div></figure><p id="8383" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从API网关控制台创建新的自定义域名:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ok"><img src="../Images/e534313c68a03cae000d5af29e72bc1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Noyqo1QNb0elsnnssBcJiA.png"/></div></div></figure><p id="0fc5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">添加路径映射，将域名映射到API部署阶段:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff ol"><img src="../Images/889835943eee190cf975eeb9d0320260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yNFnJ6TSQfGYiDWGUv-iUg.png"/></div></div></figure><p id="867d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">配置完成后，您可以使用自定义域名查询API，如下所示:<a class="ae mp" href="https://api.serverlessmovies.com/movies" rel="noopener ugc nofollow" target="_blank">https://api.serverlessmovies.com/movies</a></p><h1 id="839d" class="kd ke hu bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">证明文件</h1><p id="e927" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">在完成本指南之前，我们将介绍如何为我们到目前为止构建的无服务器API创建文档。</p><p id="148d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在API Gateway控制台上，选择您有兴趣为其生成文档的部署阶段。在下面的例子中，我选择了<em class="lg">沙箱</em>环境。然后，点击<strong class="it hv">导出</strong>选项卡，并点击<strong class="it hv">导出为摆动</strong>部分:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff om"><img src="../Images/1e06c91524cf6d8e7d2c3f46ec083793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IoKLP_XWnLCwUJrWaaMf8Q.png"/></div></div></figure><p id="d894" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> Swagger </strong>是<strong class="it hv"> OpenAPI </strong>的实现，OpenAPI 是由Linux基金会定义的关于如何描述和定义API的标准。这个定义被称为<strong class="it hv"> OpenAPI规范文档</strong>。</p><p id="06f6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您可以将文档保存在JSON或YAML文件中。然后，导航到<a class="ae mp" href="https://editor.swagger.io" rel="noopener ugc nofollow" target="_blank"> https://editor。昂首阔步。io/ </a>并将内容粘贴到网站编辑器上，它将被编译并生成一个HTML页面，如下所示:</p><figure class="li lj lk ll fq lm fe ff paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="fe ff mu"><img src="../Images/e157ecf02ae67c68138cee6843e6b29a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XuerV5h_Ui-LlojboDjMCw.png"/></div></div></figure><p id="b40c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">喜欢你正在读的东西吗？查看我的书，了解如何使用AWS Lambda在Golang中构建、保护、部署和管理生产就绪的无服务器应用程序。</p><div class="on oo fm fo op oq"><a href="https://www.packtpub.com/application-development/hands-serverless-applications-go" rel="noopener  ugc nofollow" target="_blank"><div class="or ab ej"><div class="os ab ot cl cj ou"><h2 class="bd hv fv z el ov eo ep ow er et ht dt translated">使用Go | PACKT Books动手操作无服务器应用程序</h2><div class="ox l"><h3 class="bd b fv z el ov eo ep ow er et ek translated">学习使用AWS Lambda在Golang中构建、保护、部署和管理您的无服务器应用程序</h3></div><div class="oy l"><p class="bd b gc z el ov eo ep ow er et ek translated">www.packtpub.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe lr oq"/></div></div></a></div></div></div>    
</body>
</html>