<html>
<head>
<title>Predicting Your Age In A Photo Using Deep Learning!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习预测照片中的年龄！</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-an-age-predictor-web-app-using-deep-learning-25f0190ea18f?source=collection_archive---------17-----------------------#2018-11-20">https://medium.com/hackernoon/building-an-age-predictor-web-app-using-deep-learning-25f0190ea18f?source=collection_archive---------17-----------------------#2018-11-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/fba837601a9e02459d6e6a46acd88226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJ95WQM-Flrh0VIWikDhcQ.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">An App that predicts the age of the person in the photo</figcaption></figure><p id="13ba" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">如果你只是想玩玩这个应用程序，看看这里:<a class="ae ke" href="https://age-predictor.now.sh/" rel="noopener ugc nofollow" target="_blank">https://age-predictor.now.sh/</a></p><p id="2cbd" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">继续我的深度学习之旅，我决定尝试在图像中预测人的年龄。</p><p id="11d0" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">谢天谢地，有一个非常好的数据集可供我使用，叫做IMDB-Wiki数据集:【https://data.vision.ee.ethz.ch/cvl/rrothe/imdb-wiki/ T2】</p><h1 id="7bfc" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">迁移学习</h1><p id="4d55" class="pw-post-body-paragraph jg jh hu ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">我对此喋喋不休。转学很牛逼！你可以用一个已经训练好的模型走得更远，而不必花几天时间来训练你的模型。这就像一场接力赛，最初的模型正在把接力棒传递给你，让你继续前进。</p><p id="a10a" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">使用维基百科的纯人脸数据，我训练了一个Resnet-50模型(已经在Imagenet上训练过了)。这类似于创建数据集的人采用的方法，但他们使用了不同的头，即VGG16模型而不是Resnet。</p><h1 id="6e37" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">与数据角力</h1><p id="00aa" class="pw-post-body-paragraph jg jh hu ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">很多时候，将数据转化为易于理解的形式是深度学习项目最大的挑战。在这种情况下，尽管数据可供我使用，但我仍然不得不进行一些争论。</p><p id="83e2" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">首先，数据被分成子集并存储在编号为01-99的文件夹中。我编写了一个python脚本来遍历目录，并将所有文件移动到一个文件夹中，我的模型将在这个文件夹中使用这些文件。</p><p id="1de2" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">一个有趣的挑战是获取标签，因为它们没有单独的文件，而是在图像本身的文件名中。数据集中的图像有文件名，包括人的出生日期和照片拍摄的年份。利用这些，并假设照片拍摄的年中日期为7月1日，我们可以很好地估计照片中人的年龄。</p><p id="e48d" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">我编写了另一段代码，从这两个日期中推导出年龄，以获得标签。为了简单起见，我只选择了年龄在10-120岁之间的照片。这意味着这个模型对于非常小的孩子或者非常老的人来说是不适用的。</p><p id="e108" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">现在我们有了数据以及年龄/标签:</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff li"><img src="../Images/fad0b4191965ca8b14c7716a137417ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1aZBQr6w0BPr6T17TBCVrg.jpeg"/></div></div></figure><h1 id="7c4d" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">模特培训</h1><p id="3b3d" class="pw-post-body-paragraph jg jh hu ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">该训练模型了！我使用Pytorch上运行的惊人的fastai库进行深度学习:【https://github.com/fastai/fastai<a class="ae ke" href="https://github.com/fastai/fastai" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="70c5" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">Fastai是新来者进入深度学习的一个很好的方式。在他们的网站上找到更多信息，并参加他们的课程。免费的！</p><h1 id="3b48" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">结果</h1><p id="0824" class="pw-post-body-paragraph jg jh hu ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">经过几个小时的训练，这个模型看起来还不错:</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ln"><img src="../Images/aa446a5a9a47728929a293065d881e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V9XM1970xtY4U-jR2GMyxw.jpeg"/></div></div></figure><h1 id="9720" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">部署到生产</h1><p id="91f9" class="pw-post-body-paragraph jg jh hu ji b jj ld jl jm jn le jp jq jr lf jt ju jv lg jx jy jz lh kb kc kd hn dt translated">我喜欢这个结果(即使他们是错的，听起来仍然很有趣，所以……)。我把我的模型转移到了Zeit应用程序代码库中。Zeit是快速部署你的应用程序的一个很好的服务(他们有一个免费层！):<a class="ae ke" href="https://zeit.co/dashboard" rel="noopener ugc nofollow" target="_blank">https://zeit.co/</a></p><p id="999e" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这是我的直播应用:【https://age-predictor.now.sh/ T2】</p><p id="7abc" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">这是应用程序中的同一个示例:</p><figure class="lj lk ll lm fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/fba837601a9e02459d6e6a46acd88226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJ95WQM-Flrh0VIWikDhcQ.jpeg"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Not too shabby, despite the cheesy Alien Font</figcaption></figure><p id="aacc" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">请玩一些照片，看看你会得到什么样的年龄预测。让我知道进展如何！</p><p id="ec64" class="pw-post-body-paragraph jg jh hu ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hn dt translated">包含代码的Github回购:【https://github.com/btahir/age-detector T4】</p></div></div>    
</body>
</html>