<html>
<head>
<title>Forgetting to set environment variables in nodejs apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">忘记在nodejs应用程序中设置环境变量</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/forgetting-to-set-environment-variables-in-nodejs-apps-1f45ff113ce5?source=collection_archive---------29-----------------------#2018-11-20">https://medium.com/hackernoon/forgetting-to-set-environment-variables-in-nodejs-apps-1f45ff113ce5?source=collection_archive---------29-----------------------#2018-11-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="6df4" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">TL；博士<code class="eh jj jk jl jm b">yarn add --dev faceplant</code></h2></div><p id="5f6a" class="pw-post-body-paragraph jn jo hu jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated">你已经开发了你的杀手<code class="eh jj jk jl jm b">express</code>应用。它通过了单元测试、集成测试、端到端测试...你如此满足，以至于你把代码打印出来，钉在冰箱上。您部署到生产环境中，但是几个小时后，您就收到抱怨，说该服务或多或少完全无用。您翻遍了调试日志，但毫无用处——没有明显的错误，测试也通过了，所以您的用户一定是夸大其词了。全部都是。</p><p id="cca5" class="pw-post-body-paragraph jn jo hu jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated">或者您可能忘记了在生产中设置环境变量。</p><p id="b8fe" class="pw-post-body-paragraph jn jo hu jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated">从我的经验来看，这是经过充分测试的生产应用程序中服务失败的头号来源，这在Meeshkan也引起了it部门的不满。</p><p id="41a3" class="pw-post-body-paragraph jn jo hu jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated">为了解决这个问题，我们制作了<code class="eh jj jk jl jm b"><a class="ae kj" href="https://github.com/Meeshkan/faceplant" rel="noopener ugc nofollow" target="_blank">faceplant</a></code>，一个用于生产工作负载的TSLint插件。目标是用类似<code class="eh jj jk jl jm b">tslint --project . &amp;&amp; ts-node dist/server.ts</code>的东西替换类似<code class="eh jj jk jl jm b">ts-node dist/server.ts</code>的启动命令，以便在生产环境中完成林挺步骤，如果lint检查没有通过，服务将很快失败。</p><p id="2f52" class="pw-post-body-paragraph jn jo hu jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated">这个包中的第一个规则<code class="eh jj jk jl jm b">no-unset-env-variables</code>，允许您检查以确保您的env变量在开发和生产环境中都被设置了。有从<code class="eh jj jk jl jm b">.env</code>文件读取或使用实际环境的选项。您甚至可以让它检查代码中不存在的变量。所有这些加起来就是更安全的生产代码和更愉快的开发体验。</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff kk"><img src="../Images/59228dfdece6a419616417fe37707b64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jghuaY17zF8MbE7eKY2RAw.gif"/></div></div><figcaption class="kw kx fg fe ff ky kz bd b be z ek">Ah, linting. Saving Meeshkan’s production environment since 2018.</figcaption></figure><p id="5db2" class="pw-post-body-paragraph jn jo hu jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated">如果你以前从未开发过TSLint插件，那就太容易了。我们使用这个<a class="ae kj" href="https://github.com/eranshabi/tslint-custom-rules-boilerplate" rel="noopener ugc nofollow" target="_blank">伟大的样板</a>来开始，并弄清楚如何通过遵循<a class="ae kj" href="https://github.com/cartant/rxjs-tslint-rules" rel="noopener ugc nofollow" target="_blank">这个报告</a>中的约定使其为生产做好准备。</p><p id="1855" class="pw-post-body-paragraph jn jo hu jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated">否则，当有疑问时，使用<code class="eh jj jk jl jm b"><a class="ae kj" href="http://i-forgot-to-set-my-env-variable.com" rel="noopener ugc nofollow" target="_blank">http://i-forgot-to-set-my-env-variable.com</a></code>。</p><pre class="kl km kn ko fq la jm lb lc aw ld dt"><span id="8697" class="le lf hu jm b fv lg lh l li lj">axios.get(process.env.API_URL || "http://<!-- -->i-forgot-to-set-my-env-variable.com")</span></pre><p id="0e21" class="pw-post-body-paragraph jn jo hu jp b jq jr iv js jt ju iy jv jw jx jy jz ka kb kc kd ke kf kg kh ki hn dt translated"><a class="ae kj" href="https://github.com/Meeshkan/i-forgot-to-set-my-env-variable" rel="noopener ugc nofollow" target="_blank">拉动请求</a>欢迎光临！</p><figure class="kl km kn ko fq kp fe ff paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="fe ff lk"><img src="../Images/a3813c2297249e7db28e55f76f4bebbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cw9DMYzq0vQFikMkHTXzJg.png"/></div></div></figure></div></div>    
</body>
</html>