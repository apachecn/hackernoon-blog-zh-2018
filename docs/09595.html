<html>
<head>
<title>An Open-Source Tool to Extract Tables from PDFs into CSVs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个将表格从pdf提取到CSV的开源工具</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/an-open-source-science-tool-to-extract-tables-from-pdfs-into-excels-3ed3cc7f22e1?source=collection_archive---------4-----------------------#2018-11-26">https://medium.com/hackernoon/an-open-source-science-tool-to-extract-tables-from-pdfs-into-excels-3ed3cc7f22e1?source=collection_archive---------4-----------------------#2018-11-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><blockquote class="ir is it"><p id="8d1e" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">Excalibur是一个免费的开源工具，可以帮助您轻松地从pdf中提取表格数据。我最初是为我的<a class="ae jt" href="https://www.vinayakmehta.com/2018/11/26/open-source-tool-extract-tables-pdfs-excels/" rel="noopener ugc nofollow" target="_blank">网站</a>写这篇文章的。</p></blockquote><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff ju"><img src="../Images/92ac1ca22af177307c8e266f67b08e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8YsOjqB-FQPkCAlY.png"/></div></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">Photo by <a class="ae jt" href="https://unsplash.com/photos/Oaqk7qqNh_c?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Patrick Tomasso</a> on <a class="ae jt" href="https://unsplash.com/search/photos/books?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3b21" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated"><em class="iw">借用我之前的博文</em> <a class="ae jt" href="https://www.vinayakmehta.com/2018/10/03/camelot-python-library-extract-tables-pdf/" rel="noopener ugc nofollow" target="_blank"> <em class="iw">的前三段话</em> </a> <em class="iw">因为它们完美地解释了为什么从pdf中提取表格很难。</em></p><p id="2deb" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">PDF ( <a class="ae jt" href="https://en.wikipedia.org/wiki/PDF" rel="noopener ugc nofollow" target="_blank">可移植文档格式</a>)诞生于<a class="ae jt" href="http://www.planetpdf.com/planetpdf/pdfs/warnock_camelot.pdf" rel="noopener ugc nofollow" target="_blank">Camelot项目</a>以创建“一种在各种机器配置、操作系统和通信网络之间交流文档的通用方式”。基本上，目标是使文档可以在任何显示器上查看，并可以在任何现代打印机上打印。PDF是建立在PostScript(一种页面描述语言)之上的，PostScript已经解决了“随处查看和打印”的问题。PDF封装了创建“随处查看和打印”文档所需的组件。这些包括字符、字体、图形和图像。</p><p id="1975" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">PDF文件定义了将字符(和其他组件)放置在相对于页面左下角的精确的<strong class="ix hv"> x，y </strong>坐标上的指令。通过将一些字符放得比其他字符更近来模拟单词。类似地，通过将单词放置在相对较远的位置来模拟空格。那么表格是如何模拟的呢？你猜对了——通过将单词放在电子表格中。</p><p id="1859" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">PDF格式没有表格结构的内部表示，这使得很难提取表格进行分析。可悲的是，许多开放的数据存储在pdf中，而pdf最初并不是为表格数据设计的！</p><h1 id="36df" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">Excalibur:将表格从pdf提取到CSV</h1><p id="b9c0" class="pw-post-body-paragraph iu iv hu ix b iy ll ja jb jc lm je jf kk ln ji jj kl lo jm jn km lp jq jr js hn dt translated">Excalibur是一个从pdf中提取表格数据的web界面，用Python 3！它由<a class="ae jt" href="https://camelot-py.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">卡梅洛特</a>驱动。你可以在<a class="ae jt" href="https://excalibur-py.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">查看精彩的文档，在</a>阅读文档，在<a class="ae jt" href="https://github.com/camelot-dev/excalibur/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上关注进展。</p><p id="fb4c" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated"><strong class="ix hv">注意</strong> : Excalibur仅适用于基于文本的pdf，不适用于扫描文档。(正如Tabula <a class="ae jt" href="https://github.com/tabulapdf/tabula#why-tabula" rel="noopener ugc nofollow" target="_blank">解释的</a>，“如果你可以在PDF查看器中点击并拖动选择表格中的文本，那么你的PDF就是基于文本的”。)</p><h1 id="a60a" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">如何安装神剑</h1><p id="7597" class="pw-post-body-paragraph iu iv hu ix b iy ll ja jb jc lm je jf kk ln ji jj kl lo jm jn km lp jq jr js hn dt translated">安装完<a class="ae jt" href="https://www.ghostscript.com/" rel="noopener ugc nofollow" target="_blank"> ghostscript </a>(见<a class="ae jt" href="https://camelot-py.readthedocs.io/en/master/user/install-deps.html" rel="noopener ugc nofollow" target="_blank">安装说明</a>)后，就可以简单的使用pip来安装Excalibur了:</p><pre class="jv jw jx jy fq lq lr ls lt aw lu dt"><span id="9fe1" class="lv ko hu lr b fv lw lx l ly lz">$ pip install excalibur-py</span></pre><p id="f5e6" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated"><strong class="ix hv">注意</strong>:你也可以从<a class="ae jt" href="https://github.com/camelot-dev/excalibur/releases" rel="noopener ugc nofollow" target="_blank">发布页面</a>下载Windows和Linux的可执行文件，直接运行！</p><h1 id="82dc" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">如何使用神剑</h1><p id="c378" class="pw-post-body-paragraph iu iv hu ix b iy ll ja jb jc lm je jf kk ln ji jj kl lo jm jn km lp jq jr js hn dt translated">使用pip安装后，您可以使用以下命令初始化元数据数据库:</p><pre class="jv jw jx jy fq lq lr ls lt aw lu dt"><span id="b3e4" class="lv ko hu lr b fv lw lx l ly lz">$ excalibur initdb</span></pre><p id="f348" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">然后使用以下命令启动web服务器:</p><pre class="jv jw jx jy fq lq lr ls lt aw lu dt"><span id="c1ce" class="lv ko hu lr b fv lw lx l ly lz">$ excalibur webserver</span></pre><p id="b41d" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">就是这样！现在您可以访问<a class="ae jt" href="http://localhost:5000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:5000 </a>并开始从您的pdf中提取表格数据。</p><ol class=""><li id="1340" class="ma mb hu ix b iy iz jc jd kk mc kl md km me js mf mg mh mi dt translated"><strong class="ix hv">上传</strong>PDF并输入您想要提取表格的页码。</li><li id="5129" class="ma mb hu ix b iy mj jc mk kk ml kl mm km mn js mf mg mh mi dt translated">转到每一页，通过在表格周围画一个方框来选择表格。(您可以选择跳过这一步，因为Excalibur可以自动检测表格。点击“<strong class="ix hv">自动检测表格</strong>”查看Excalibur看到的内容。)</li><li id="3a60" class="ma mb hu ix b iy mj jc mk kk ml kl mm km mn js mf mg mh mi dt translated">从“<strong class="ix hv">高级</strong>”中选择一种风格(格或流):<strong class="ix hv">格，</strong>用于由线条组成的表格，或者<strong class="ix hv">流，</strong>用于由空白组成的表格。</li><li id="1812" class="ma mb hu ix b iy mj jc mk kk ml kl mm km mn js mf mg mh mi dt translated">点击<strong class="ix hv">查看并下载数据</strong>查看提取的表格。</li><li id="7b2a" class="ma mb hu ix b iy mj jc mk kk ml kl mm km mn js mf mg mh mi dt translated">选择你喜欢的格式(CSV/Excel/JSON/HTML)点击“<strong class="ix hv">下载</strong>”！</li></ol><h1 id="7492" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">表检测升级</h1><p id="b139" class="pw-post-body-paragraph iu iv hu ix b iy ll ja jb jc lm je jf kk ln ji jj kl lo jm jn km lp jq jr js hn dt translated">Camelot是支持Excalibur的Python库，它实现了两种方法来从两种不同类型的表结构中提取表:<strong class="ix hv"> Lattice </strong>，用于由线条组成的表，以及<strong class="ix hv"> Stream </strong>，用于由空白组成的表。Lattice在v0.1.0中给出了很好的结果，因为它能够检测单个PDF页面上的不同表格，而Stream将整个页面视为一个表格。</p><p id="5105" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">但上周，卡梅洛特v0.4.0版的发布解决了这个问题。<a class="ae jt" href="https://github.com/socialcopsdev/camelot/pull/206" rel="noopener ugc nofollow" target="_blank"> #206 </a>增加了Anssi Nurminen的<a class="ae jt" href="https://github.com/socialcopsdev/camelot/pull/206" rel="noopener ugc nofollow" target="_blank">硕士论文</a>中描述的表格检测算法的实现，能够在单个PDF页面上检测多个<em class="iw">流</em>类型的表格(大部分时间)！您可以在下面的图片中看到不同之处。</p><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff mo"><img src="../Images/dc1506de682d17f528c8d115c122e992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6S3pPeb750_L8hwC.png"/></div></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">Both <em class="mp">Stream</em>-type tables detected in v0.4.0</figcaption></figure><p id="cd7e" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">相对于</p><figure class="jv jw jx jy fq jz fe ff paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="fe ff mq"><img src="../Images/1a2734961e7e097d63a592988abe4e8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NLS8HL9MD9mzt8Tn.png"/></div></div><figcaption class="kg kh fg fe ff ki kj bd b be z ek">Whole page being treated as a table in v0.3.0</figcaption></figure><h1 id="e2b9" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">在Labworm上投票排名第一</h1><p id="15cf" class="pw-post-body-paragraph iu iv hu ix b iy ll ja jb jc lm je jf kk ln ji jj kl lo jm jn km lp jq jr js hn dt translated">神剑在11月的第二周被选为Labworm 的第一名！Labworm是一个平台，引导科学家找到他们研究的最佳在线资源，并通过促进开放科学来帮助调解知识交流。</p><figure class="jv jw jx jy fq jz"><div class="bz el l di"><div class="mr ms l"/></div></figure><h1 id="fe84" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">为什么是另一个PDF表格提取工具？</h1><p id="a2f2" class="pw-post-body-paragraph iu iv hu ix b iy ll ja jb jc lm je jf kk ln ji jj kl lo jm jn km lp jq jr js hn dt translated">既有开放的(<a class="ae jt" href="https://tabula.technology/" rel="noopener ugc nofollow" target="_blank"> Tabula </a>、<a class="ae jt" href="https://github.com/jsvine/pdfplumber" rel="noopener ugc nofollow" target="_blank">pdf plumb</a>)工具，也有闭源的(<a class="ae jt" href="https://smallpdf.com/" rel="noopener ugc nofollow" target="_blank"> Smallpdf </a>、<a class="ae jt" href="https://docparser.com/" rel="noopener ugc nofollow" target="_blank"> Docparser </a>)工具，广泛用于从pdf中提取数据表。他们要么给出一个不错的输出，要么悲惨地失败。没有中间地带。这是没有帮助的，因为现实世界中的一切，包括PDF表格提取，都是模糊的。</p><p id="ef8b" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">Excalibur使用Camelot，这是为用户提供对表提取的完全控制而创建的。如果您无法使用默认设置获得您想要的输出，您可以调整“<strong class="ix hv">高级</strong>”设置并完成工作！</p><p id="5737" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">关于为什么创建卡梅洛特的更详细的描述，你也应该看看我之前的博客<a class="ae jt" href="https://www.vinayakmehta.com/2018/10/03/camelot-python-library-extract-tables-pdf/" rel="noopener ugc nofollow" target="_blank">的“更长时间阅读”部分。使用<strong class="ix hv"> Ctrl + F </strong>。</a></p><h1 id="b731" class="kn ko hu bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">前方的路</h1><p id="1023" class="pw-post-body-paragraph iu iv hu ix b iy ll ja jb jc lm je jf kk ln ji jj kl lo jm jn km lp jq jr js hn dt translated">重申我在上面谈到的“更长的阅读时间”一节，看到开源工具不能每次都给出好的表格提取输出是一件痛苦的事情。看到闭源工具上的付费墙令人沮丧。我认为付费墙不应该阻挡通向开放科学的道路。我相信Camelot是我们在SocialCops的一次成功尝试，解决了从基于文本的pdf中准确提取表格的问题。神剑通过一个漂亮的网络界面让任何人都更容易接触到卡梅洛特的美好。</p><p id="b71b" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">但是在图像和基于图像的pdf中仍然有大量的公开数据。最先进的光学字符识别软件被锁在付费墙后面。</p><blockquote class="ir is it"><p id="006f" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">“目前，专有的OCR软件大大优于免费和开源的OCR软件，因此，根据公共机构需要执行的OCR工作的数量和类型，公共机构的投资可能是值得的。”— <a class="ae jt" href="https://how-to.usopendata.org/en/latest/The-Basics-of-Open-Data/Working-with-PDFs/" rel="noopener ugc nofollow" target="_blank">如何打开数据—使用pdf</a></p></blockquote><p id="86ff" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">因此，下一步是通过为Camelot和Excalibur添加OCR支持，使任何人都可以轻松地从图像或基于图像的pdf中提取表格(或任何其他类型的数据)。如果你想对此贡献你的想法，请在<a class="ae jt" href="https://github.com/socialcopsdev/camelot/issues/101" rel="noopener ugc nofollow" target="_blank"> #101 </a>上添加你的评论。您还可以查看<a class="ae jt" href="https://excalibur-py.readthedocs.io/en/master/dev/contributing.html" rel="noopener ugc nofollow" target="_blank">贡献者指南</a>，了解关于贡献代码、文档或测试、报告问题和提出改进的指南。</p><p id="ccc7" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">如果Excalibur已经帮助您从pdf中提取表格，请考虑通过<a class="ae jt" href="https://opencollective.com/excalibur" rel="noopener ugc nofollow" target="_blank">成为OpenCollective </a>的支持者或赞助商来支持它的发展！</p><p id="611b" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated">还有，不要再把开放数据发布成pdf了，继续查！:)</p></div><div class="ab cl mt mu hc mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hn ho hp hq hr"><p id="cc99" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf kk jh ji jj kl jl jm jn km jp jq jr js hn dt translated"><strong class="ix hv">感谢</strong>Christine Garcia提供反馈和编辑建议。</p></div></div>    
</body>
</html>