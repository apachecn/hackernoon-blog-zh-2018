<html>
<head>
<title>Build a realtime counter using Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Swift构建实时计数器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-a-realtime-counter-using-swift-9008c3aa9a9c?source=collection_archive---------15-----------------------#2018-11-29">https://medium.com/hackernoon/build-a-realtime-counter-using-swift-9008c3aa9a9c?source=collection_archive---------15-----------------------#2018-11-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><blockquote class="ir is it"><p id="fa57" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated">遵循本教程需要对Swift和Node.js有基本的了解。</p></blockquote><p id="0e08" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">应用程序(web或其他)中最常见的元素之一是计数器。例如，YouTube使用计数器来查看有多少人观看了某个视频。脸书也为他们平台上的视频做同样的事情。</p><p id="f5c6" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">然而，这些网站上的大多数计数器只在你刷新页面时才更新计数。这留下了许多需要改进的地方，因为有时你只是想实时看到数量的增加。这给你的印象是，目前有很多人在查看这个项目。</p><p id="1ad7" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">在本文中，我们将探讨如何利用Pusher的实时特性来创建一个实时更新的计数器。我们将创建一个视频浏览器iOS应用程序，实时计数器显示有多少人观看了视频。</p><figure class="jx jy jz ka fq kb fe ff paragraph-image"><div role="button" tabindex="0" class="kc kd di ke bf kf"><div class="fe ff jw"><img src="../Images/ba67d1c8b41418ffb069f99de65b1646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Y0rOPR3YNSaoCBb7i_iYZQ.gif"/></div></div></figure><p id="a0e0" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">要继续学习，您需要Swift、Xcode和命令行的基础知识。您还需要建立一个推销商帐户，并创建一个应用程序。你可以在这里这样做<a class="ae ki" href="https://pusher.com/" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="4dca" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">基本设置</h1><p id="4385" class="pw-post-body-paragraph iu iv hu ix b iy lh ja jb jc li je jf jt lj ji jj ju lk jm jn jv ll jq jr js hn dt translated">要开始，您需要在您的机器上安装Cocoapods。Cocoapods是一个包管理器，我们将使用它来管理应用程序的依赖性。要安装Cocoapods，请在命令行中键入以下内容:</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="357c" class="lr kk hu ln b fv ls lt l lu lv">$ gem install cocoapods</span></pre><p id="a516" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">安装完成后，启动Xcode并创建一个新的单页应用程序项目。按照设置向导进行操作，然后在Xcode项目编辑器打开后，关闭Xcode。<code class="eh lw lx ly ln b">cd</code>到你的项目的根目录并运行命令:</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="d699" class="lr kk hu ln b fv ls lt l lu lv">$ pod init</span></pre><p id="b6cf" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">这应该会在项目的根目录下创建一个<code class="eh lw lx ly ln b">Podfile</code>。在您喜欢的编辑器中打开该文件，然后将文件内容更新为以下内容:</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="e425" class="lr kk hu ln b fv ls lt l lu lv"># Uncomment the next line to define a global platform for your project<br/>platform :ios, '9.0'</span><span id="195a" class="lr kk hu ln b fv lz lt l lu lv">target 'counter' do<br/>  # Comment the next line if you're not using Swift and don't want to use dynamic frameworks<br/>  use_frameworks!</span><span id="b149" class="lr kk hu ln b fv lz lt l lu lv">  # Pods for counter<br/>  pod 'Alamofire'<br/>  pod 'PusherSwift'</span><span id="d241" class="lr kk hu ln b fv lz lt l lu lv">end</span></pre><p id="f9b5" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">在上面的文件中，我们指定了两个依赖项:<code class="eh lw lx ly ln b">PusherSwift</code>和<code class="eh lw lx ly ln b">Alamofire</code>。这些在项目的后期会很有用。现在，通过从终端运行以下命令来安装这些依赖项:</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="4bc3" class="lr kk hu ln b fv ls lt l lu lv">$ pod install</span></pre><p id="aaad" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">一旦完成，您应该在项目的根目录下有一个<code class="eh lw lx ly ln b">.xcworkspace</code>文件。打开这个文件，它应该会启动Xcode。(在打开文件之前，请确保您没有为该项目运行任何Xcode实例，否则您将会得到一个错误。)</p><h1 id="5553" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">为我们的实时应用程序创建视图</h1><p id="1687" class="pw-post-body-paragraph iu iv hu ix b iy lh ja jb jc li je jf jt lj ji jj ju lk jm jn jv ll jq jr js hn dt translated">现在项目已经打开，我们将为我们的应用程序创建一些视图。打开<code class="eh lw lx ly ln b">Main.storyboard</code>文件，在那里我们将创建视图。</p><p id="3579" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">我们想要创建一个导航控制器，它将有一个<code class="eh lw lx ly ln b">ViewController</code>作为导航控制器的根控制器。然后在新的视图控制器中，我们将添加一个webview这是我们将嵌入我们希望人们观看的视频的地方。我们还将添加两个标签，一个用于计数器，另一个只是普通的不可变消息。</p><p id="ca7a" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">在我们完成之后，这是我们目前所拥有的:</p><figure class="jx jy jz ka fq kb fe ff paragraph-image"><div role="button" tabindex="0" class="kc kd di ke bf kf"><div class="fe ff ma"><img src="../Images/4846c29452a9294486aa974613076fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Y6cjEkEdw_wvhj5J3RpgA.png"/></div></div></figure><h1 id="b54c" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">将我们的实时特性添加到应用程序中</h1><p id="135e" class="pw-post-body-paragraph iu iv hu ix b iy lh ja jb jc li je jf jt lj ji jj ju lk jm jn jv ll jq jr js hn dt translated">既然我们已经创建了应用程序，现在我们可以添加与视图交互的代码，并添加实时支持和视频。</p><p id="441c" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">创建一个新的<code class="eh lw lx ly ln b">MainViewController</code>类，并将其链接到我们上面创建的视图控制器。然后在Xcode中创建一个分割视图，ctrl+从<code class="eh lw lx ly ln b">webview</code>拖动到视图控制器。这将在控制器中创建一个<code class="eh lw lx ly ln b">@IBOutlet</code>；对计数器标签做同样的操作，这样它会创建另一个<code class="eh lw lx ly ln b">@IBOutlet</code>。我们的控制器现在应该有两个<code class="eh lw lx ly ln b">@IBOutlet</code>一个用于webview，一个用于计数器标签。太好了。</p><p id="7876" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在我们将添加代码来加载我们的视频。在这个练习中，我们将使用YouTube上的一段视频来演示推手教程。在<code class="eh lw lx ly ln b">viewDidLoad</code>方法中添加以下内容:</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="2046" class="lr kk hu ln b fv ls lt l lu lv">func viewDidLoad() {<br/>    super.viewDidLoad()<br/>    loadYoutube(videoID:"xDQ8vzD0lzw")<br/>}</span></pre><p id="1e61" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在让我们创建<code class="eh lw lx ly ln b">loadYoutube</code>方法和其他依赖方法:</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="5fbc" class="lr kk hu ln b fv ls lt l lu lv">func loadYoutube(videoID:String) {<br/>    self.automaticallyAdjustsScrollViewInsets = false<br/>    webview.allowsInlineMediaPlayback = true<br/>    webview.mediaPlaybackRequiresUserAction = false</span><span id="b442" class="lr kk hu ln b fv lz lt l lu lv">    let embedHTML = getEmbedHTML(id:videoID);</span><span id="550b" class="lr kk hu ln b fv lz lt l lu lv">    let url: NSURL = NSURL(string: "<a class="ae ki" href="https://www.youtube.com/embed/\(videoID)" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/embed/\(videoID)</a>")!</span><span id="8b2f" class="lr kk hu ln b fv lz lt l lu lv">    webview.loadHTMLString(embedHTML as String, baseURL:url as URL )<br/>}</span><span id="0da3" class="lr kk hu ln b fv lz lt l lu lv">private func getEmbedHTML(id: String) -&gt; String {<br/>    return "&lt;html&gt;&lt;head&gt;&lt;style type=\"text/css\"&gt;body {background-color: transparent;color: white;}&lt;/style&gt;&lt;/head&gt;&lt;body style=\"margin:0\"&gt; &lt;iframe webkit-playsinline width=\"100%\" height=\"100%\" src=\"<a class="ae ki" href="https://www.youtube.com/embed/\(id)?feature=player_detailpage&amp;playsinline=1\" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/embed/\(id)?feature=player_detailpage&amp;playsinline=1\</a>" frameborder=\"0\"&gt;&lt;/iframe&gt;";<br/>}</span></pre><p id="c1b6" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在，我们已经指示应用程序自动加载YouTube视频。但是，计数器功能还不能工作。让我们解决这个问题。</p><p id="f8b6" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">导入<code class="eh lw lx ly ln b">PusherSwift</code>库并添加一个新方法，使用Pusher更新计数器:</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="1984" class="lr kk hu ln b fv ls lt l lu lv">updateViewCount() {<br/>    let options = PusherClientOptions(<br/>        host: .cluster("PUSHER_CLUSTER")<br/>    )</span><span id="7308" class="lr kk hu ln b fv lz lt l lu lv">    pusher = Pusher(key: "PUSHER_KEY", options: options)</span><span id="3102" class="lr kk hu ln b fv lz lt l lu lv">    let channel = pusher.subscribe("counter")<br/>    let _ = channel.bind(eventName: "new_user", callback: { (data: Any?) -&gt; Void in<br/>        if let data = data as? [String: AnyObject] {<br/>            let viewCount = data["count"] as! NSNumber<br/>            self.count.text = "\(viewCount)" as String!<br/>        }<br/>    })</span><span id="3a10" class="lr kk hu ln b fv lz lt l lu lv">    pusher.connect()<br/>}</span></pre><blockquote class="ir is it"><p id="5968" class="iu iv iw ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hn dt translated"><em class="hu">注意:在显示</em> <code class="eh lw lx ly ln b"><em class="hu">PUSHER_CLUSTER</em></code> <em class="hu">和</em> <code class="eh lw lx ly ln b"><em class="hu">PUSHER_KEY</em></code> <em class="hu">的地方，您应该用您实际的推杆组合和按键替换。你还需要导入</em></p></blockquote><p id="aa35" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在你可以从<code class="eh lw lx ly ln b">viewDidLoad</code>方法中调用<code class="eh lw lx ly ln b">updateViewCount</code>，这样当视图被加载时它就会被调用。</p><p id="3560" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">我们要做的最后一件事是使用<code class="eh lw lx ly ln b">Alamofire</code>向后端发送一个请求，这样计数器可以被更新和保存，这样我们就不会丢失观看视频的人数。导入<code class="eh lw lx ly ln b">Alamofire</code>并添加以下内容:</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="c2fe" class="lr kk hu ln b fv ls lt l lu lv">func sendViewCount() {<br/>    Alamofire.request(endpoint, method: .post).validate().responseJSON { response in<br/>        switch response.result {<br/>        case .success:<br/>            if let result = response.result.value {<br/>                let data = result as! NSDictionary<br/>                let viewCount = data["count"] as! NSNumber<br/>                self.count.text = "\(viewCount)" as String!<br/>            }<br/>        case .failure(let error):<br/>            print(error)<br/>        }<br/>    }<br/>}</span></pre><p id="e859" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在我们已经完成了，现在<code class="eh lw lx ly ln b">MainViewController</code>应该看起来有点像这样:</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="2b2e" class="lr kk hu ln b fv ls lt l lu lv">import UIKit<br/>import Alamofire<br/>import PusherSwift</span><span id="c1ec" class="lr kk hu ln b fv lz lt l lu lv">class MainViewController: UIViewController {</span><span id="633e" class="lr kk hu ln b fv lz lt l lu lv">    <a class="ae ki" href="http://twitter.com/IBOutlet" rel="noopener ugc nofollow" target="_blank">@IBOutlet</a> weak var count: UILabel!<br/>    <a class="ae ki" href="http://twitter.com/IBOutlet" rel="noopener ugc nofollow" target="_blank">@IBOutlet</a> weak var webview: UIWebView!</span><span id="0daa" class="lr kk hu ln b fv lz lt l lu lv">    var endpoint: String = "<a class="ae ki" href="http://localhost:4000/update_counter" rel="noopener ugc nofollow" target="_blank">http://localhost:4000/update_counter</a>"</span><span id="d99f" class="lr kk hu ln b fv lz lt l lu lv">    var pusher : Pusher!</span><span id="f991" class="lr kk hu ln b fv lz lt l lu lv">    override func viewDidLoad() {<br/>        super.viewDidLoad()<br/>        loadYoutube(videoID:"xDQ8vzD0lzw")<br/>        sendViewCount()<br/>        updateViewCount()<br/>    }</span><span id="4024" class="lr kk hu ln b fv lz lt l lu lv">    func sendViewCount() {<br/>        Alamofire.request(endpoint, method: .post).validate().responseJSON { response in<br/>            switch response.result {</span><span id="6c2e" class="lr kk hu ln b fv lz lt l lu lv">            case .success:<br/>                if let result = response.result.value {<br/>                    let data = result as! NSDictionary<br/>                    let viewCount = data["count"] as! NSNumber<br/>                    self.count.text = "\(viewCount)" as String!<br/>                }<br/>            case .failure(let error):<br/>                print(error)<br/>            }<br/>        }<br/>    }</span><span id="c054" class="lr kk hu ln b fv lz lt l lu lv">    func updateViewCount() {<br/>        let options = PusherClientOptions(<br/>            host: .cluster("PUSHER_CLUSTER")<br/>        )</span><span id="5bc5" class="lr kk hu ln b fv lz lt l lu lv">        pusher = Pusher(key: "PUSHER_KEY", options: options)</span><span id="eb65" class="lr kk hu ln b fv lz lt l lu lv">        let channel = pusher.subscribe("counter")<br/>        let _ = channel.bind(eventName: "new_user", callback: { (data: Any?) -&gt; Void in<br/>            if let data = data as? [String: AnyObject] {<br/>                let viewCount = data["count"] as! NSNumber<br/>                self.count.text = "\(viewCount)" as String!<br/>            }<br/>        })</span><span id="e488" class="lr kk hu ln b fv lz lt l lu lv">        pusher.connect()<br/>    }</span><span id="8af0" class="lr kk hu ln b fv lz lt l lu lv">    func loadYoutube(videoID:String) {<br/>        self.automaticallyAdjustsScrollViewInsets = false<br/>        webview.allowsInlineMediaPlayback = true<br/>        webview.mediaPlaybackRequiresUserAction = false<br/>        let embedHTML = getEmbedHTML(id:videoID);</span><span id="4e17" class="lr kk hu ln b fv lz lt l lu lv">        let url: NSURL = NSURL(string: "<a class="ae ki" href="https://www.youtube.com/embed/\(videoID)" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/embed/\(videoID)</a>")!<br/>        webview.loadHTMLString(embedHTML as String, baseURL:url as URL )<br/>    }</span><span id="b0d2" class="lr kk hu ln b fv lz lt l lu lv">    private func getEmbedHTML(id: String) -&gt; String {<br/>        return "&lt;html&gt;&lt;head&gt;&lt;style type=\"text/css\"&gt;body {background-color: transparent;color: white;}&lt;/style&gt;&lt;/head&gt;&lt;body style=\"margin:0\"&gt; &lt;iframe webkit-playsinline width=\"100%\" height=\"100%\" src=\"<a class="ae ki" href="https://www.youtube.com/embed/\(id)?feature=player_detailpage&amp;playsinline=1\" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/embed/\(id)?feature=player_detailpage&amp;playsinline=1\</a>" frameborder=\"0\"&gt;&lt;/iframe&gt;";<br/>    }<br/>}</span></pre><p id="f8de" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">如果我们现在加载应用程序，它将加载视频，但计数器将不工作。这是因为我们还没有设置后端逻辑。</p><h1 id="f7f8" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">为我们的实时计数器iOS应用程序创建后端</h1><p id="d07d" class="pw-post-body-paragraph iu iv hu ix b iy lh ja jb jc li je jf jt lj ji jj ju lk jm jn jv ll jq jr js hn dt translated">对于后端，我们将创建一个非常基本的Node.js应用程序。这个应用程序只需要一个端点来保存计数器状态，并向Pusher发送一个触发器，这样订阅通道事件的其他侦听器就可以获取它并实时更新。</p><p id="8e8c" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">首先，为您的应用程序创建一个新目录。在应用程序中创建两个文件:</p><h2 id="9618" class="lr kk hu bd kl mb mc md kp me mf mg kt jt mh mi kx ju mj mk lb jv ml mm lf mn dt translated">文件:package.json</h2><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="d831" class="lr kk hu ln b fv ls lt l lu lv">{<br/>  "main": "index.js",<br/>  "dependencies": {<br/>    "body-parser": "^1.16.0",<br/>    "express": "^4.14.1",<br/>    "pusher": "^1.5.1"<br/>  }<br/>}</span></pre><p id="db53" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated"><strong class="ix hv">文件:index.js </strong></p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="0557" class="lr kk hu ln b fv ls lt l lu lv">var Pusher = require('pusher');<br/>let express = require('express');<br/>let bodyParser = require('body-parser');<br/>let fs = require('fs');</span><span id="4c6e" class="lr kk hu ln b fv lz lt l lu lv">let app = express();</span><span id="b178" class="lr kk hu ln b fv lz lt l lu lv">let pusher = new Pusher({<br/>  appId: 'PUSHER_ID',<br/>  key: 'PUSHER_KEY',<br/>  secret: 'PUSHER_SECRET',<br/>  cluster: 'PUSHER_CLUSTER',<br/>  encrypted: true<br/>});</span><span id="34fe" class="lr kk hu ln b fv lz lt l lu lv">app.use(bodyParser.json());<br/>app.use(bodyParser.urlencoded({ extended: false }));</span><span id="6de2" class="lr kk hu ln b fv lz lt l lu lv">app.post('/update_counter', function(req, res) {<br/>  let counterFile = './count.txt';</span><span id="4bfb" class="lr kk hu ln b fv lz lt l lu lv">  fs.readFile(counterFile, 'utf-8', function(err, count) {<br/>    count = parseInt(count) + 1;<br/>    fs.writeFile(counterFile, count, function (err) {<br/>      pusher.trigger('counter', 'new_user', {count:count});<br/>      res.json({count:count});<br/>    });<br/>  });<br/>});</span><span id="6cf9" class="lr kk hu ln b fv lz lt l lu lv">app.use(function(req, res, next) {<br/>    let err = new Error('Not Found');<br/>    err.status = 404;<br/>    next(err);<br/>});</span><span id="80c7" class="lr kk hu ln b fv lz lt l lu lv">module.exports = app;</span><span id="61bf" class="lr kk hu ln b fv lz lt l lu lv">app.listen(4000, function(){<br/>  console.log('App listening on port 4000!')<br/>})</span></pre><p id="af65" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">最后，在同一个目录中创建<code class="eh lw lx ly ln b">counter.txt</code>文件，并将其改为可写。</p><pre class="jx jy jz ka fq lm ln lo lp aw lq dt"><span id="27c9" class="lr kk hu ln b fv ls lt l lu lv">$ echo "0" &gt; count.txt <br/>$ chmod 0644 count.txt</span></pre><p id="3a53" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在运行<code class="eh lw lx ly ln b">npm install</code>来安装node使后端应用程序工作所需的所有依赖项。当依赖项安装完成后，运行<code class="eh lw lx ly ln b">node index.js</code>来启动应用程序。</p><p id="0606" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">为了让我们的应用程序与本地主机应用程序交互，我们需要做的最后一个更改是在我们的项目<code class="eh lw lx ly ln b">info.plist</code>文件中。在启动应用程序之前，进行以下更改:</p><figure class="jx jy jz ka fq kb fe ff paragraph-image"><div role="button" tabindex="0" class="kc kd di ke bf kf"><div class="fe ff mo"><img src="../Images/e86ef5d43a987cff811a581813ddc19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tqe_RWqk8CfSt0UPRW1LGA.png"/></div></div></figure><p id="4b25" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">现在，当您启动应用程序时，您可以看到计数器增加，如果有应用程序的另一个实例，他们可以看到计数器实时增加。整洁！</p><h1 id="9592" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">结论</h1><p id="c46e" class="pw-post-body-paragraph iu iv hu ix b iy lh ja jb jc li je jf jt lj ji jj ju lk jm jn jv ll jq jr js hn dt translated">在本文中，我们探讨了如何在iOS应用程序中使用Pusher创建实时计数器。我们很想知道你会如何将它整合到你的iOS应用程序中。如果你有任何其他你想看的用例，或者有任何反馈，请在下面留下评论。</p><p id="d28e" class="pw-post-body-paragraph iu iv hu ix b iy iz ja jb jc jd je jf jt jh ji jj ju jl jm jn jv jp jq jr js hn dt translated">这篇文章最初出现在<a class="ae ki" href="https://pusher.com/tutorials/counter-swift/" rel="noopener ugc nofollow" target="_blank"> Pusher博客</a>上。</p></div></div>    
</body>
</html>