<html>
<head>
<title>Build a Ruby based Lambda Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建一个基于Ruby的Lambda函数</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/build-a-ruby-based-lambda-function-44f3d006fef6?source=collection_archive---------0-----------------------#2018-12-02">https://medium.com/hackernoon/build-a-ruby-based-lambda-function-44f3d006fef6?source=collection_archive---------0-----------------------#2018-12-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/896c0483f68de07afda938fa9dab8ed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FVZylKGxEdrrp9fsbbmh6Q.png"/></div></div></figure><p id="4e3d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在AWS re:Invent 2018上，宣布了<strong class="je hv"> Ruby </strong>现在是AWS Lambda支持的语言。在这篇文章中，我将带你从头开始编写第一个基于Ruby的Lambda函数，然后是如何配置、部署和测试Lambda函数。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ka"><img src="../Images/5947722691326b585140a43472def0ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h_wpo-LkZANdfttSISqC3g.png"/></div></div></figure><p id="7767" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> API网关</strong>将传入的请求转发给目标基于Ruby的Lambda函数，该函数将在<em class="kf"> movies </em>表上调用相应的<strong class="je hv"> DynamoDB </strong>操作。</p><p id="d208" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，创建一个Lambda执行角色，允许在DynamoDB表上调用<em class="kf">扫描</em>操作:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="kg kh l"/></div></figure><p id="fcbf" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下面的函数入口点是不言自明的，它使用AWS SDK(该包预安装在Lambda中)在适当的区域实例化DynamoDB客户端，并在DynamoDB表上发出<em class="kf"> Scan </em>操作(在环境变量中定义):</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="kg kh l"/></div></figure><blockquote class="ki kj kk"><p id="b57f" class="jc jd kf je b jf jg jh ji jj jk jl jm kl jo jp jq km js jt ju kn jw jx jy jz hn dt translated">默认情况下，AWS SDK for Ruby包含在Lambda执行环境中。</p></blockquote><p id="16bc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">既然已经定义了我们的处理程序，那么就转到Lambda表单创建，并从<strong class="je hv">现有角色</strong>下拉列表中选择IAM角色(您可能需要刷新页面以使更改生效)。然后，点击<strong class="je hv">创建功能</strong>按钮:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ko"><img src="../Images/3243a6c4d3d17fb2e8fc3ec66ada39bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UqSw2mV0-_RjDgVUP3qOpg.png"/></div></div></figure><p id="bc52" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将表名设置为环境变量:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kp"><img src="../Images/f6d914068105b29f666bd26be3b8be2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KFaS9DyvQyWxpiCQhTEQkw.png"/></div></div></figure><p id="fe27" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="kf">电影</em>表包含一组电影:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kq"><img src="../Images/c29c7735682ff4853cc441a919e7af17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RKpG77GYUF_oOXyYZVM42Q.png"/></div></div></figure><p id="4960" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用AWS CLI命令创建部署包(zip文件)并更新函数代码:</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="kg kh l"/></div></figure><blockquote class="ki kj kk"><p id="3403" class="jc jd kf je b jf jg jh ji jj jk jl jm kl jo jp jq km js jt ju kn jw jx jy jz hn dt translated">确保将Lambda函数处理程序设置为<em class="hu"> handler.lambda_handler </em></p></blockquote><p id="b476" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一旦部署了该功能，通过点击控制台右上角的“<strong class="je hv">测试”</strong>按钮，使用样本事件数据手动调用它。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kr"><img src="../Images/564e21623101ba68195e1d9671007eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ick1XOgwHh6cW8z_Sn7gWg.png"/></div></div></figure><p id="ce93" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">到目前为止，我们学习了如何用Ruby构建我们的第一个Lambda函数。我们还学习了如何从控制台手动调用它。为了利用Lambda的强大功能，我们将学习如何使用AWS API网关服务触发这个Lambda函数来响应传入的HTTP请求(事件驱动架构):</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ks"><img src="../Images/bf8d02fe60d05d3817064544535b6053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rXlkWzg9C5eKyWqOCo8BHg.png"/></div></div></figure><p id="d626" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建一个部署阶段，用API <strong class="je hv">调用URL </strong>打开自己喜欢的浏览器；您应该会看到类似以下屏幕截图所示的消息:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kt"><img src="../Images/fe6a350a198964aa6f20c4db9ce1ad37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HMup6kIt3I7oNhCJxyWArw.png"/></div></div></figure><p id="a6df" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下面的屏幕截图显示了一个正确配置的基于Ruby的Lambda函数，它具有对DynamoDB的IAM访问权限:</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ku"><img src="../Images/01b8c30863ed977ea5554190e8d9141d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HC0-PjmtmLqfHkaprTlGuA.png"/></div></div></figure><p id="b68b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">喜欢你正在读的东西吗？查看我的书，了解如何使用AWS Lambda在Golang中构建、保护、部署和管理生产就绪的无服务器应用程序。</p><div class="kv kw fm fo kx ky"><a href="https://www.amazon.com/Hands-Serverless-Applications-production-ready-applications-ebook/dp/B07DT9DD4V" rel="noopener  ugc nofollow" target="_blank"><div class="kz ab ej"><div class="la ab lb cl cj lc"><h2 class="bd hv fv z el ld eo ep le er et ht dt translated">使用Go的实际操作无服务器应用程序:使用AWS构建真实的、生产就绪的应用程序…</h2><div class="lf l"><h3 class="bd b fv z el ld eo ep le er et ek translated">学习使用AWS Lambda关键功能在Golang中构建、保护、部署和管理您的无服务器应用程序</h3></div><div class="lg l"><p class="bd b gc z el ld eo ep le er et ek translated">www.amazon.com</p></div></div><div class="lh l"><div class="li l lj lk ll lh lm ja ky"/></div></div></a></div></div></div>    
</body>
</html>