<html>
<head>
<title>How to measure the latency of a WebCam with OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用OpenCV测量网络摄像头的延迟</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-measure-the-latency-of-a-webcam-with-opencv-1a3d4a86558?source=collection_archive---------2-----------------------#2018-12-02">https://medium.com/hackernoon/how-to-measure-the-latency-of-a-webcam-with-opencv-1a3d4a86558?source=collection_archive---------2-----------------------#2018-12-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/3692cf5823f120aa2d7c74fff7616107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VxhK8CRxwNXg9qTW.jpg"/></div></div></figure><p id="bc5b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这个快速教程中，您将了解如何测量网络摄像头的延迟，以评估它是否能够处理实时要求比静态图像捕捉更高的图像捕捉任务。</p><p id="86d0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">想象一条饮料生产线沿着传送带快速灌装瓶子。部署了一个摄像头来验证每个瓶子的质量，如液体的体积和形状，每个有缺陷的产品都必须被挑选出来。图像捕捉的实时要求是至关重要的，因为任何延长的等待时间都可能导致不同的瓶子被转移到错误的路径。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff ka"><img src="../Images/861cc4a11cb7ffc775731677f6077377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*7PhREJPeBPz5jejA.png"/></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">Vision-based inspection</figcaption></figure><h1 id="b774" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">潜伏期从何而来？</h1><p id="ab20" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">通过调用Python cv2库中的<code class="eh lm ln lo lp b">camera.read()</code>从网络摄像头中读取一帧似乎很简单，然而，在幕后发生了许多事情，这可能会引入不可预测的延迟，这在实时应用中是不可取的。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lq"><img src="../Images/270065896b9645d863547bba535468e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*94Wpr5ElgHAPcGSR.png"/></div></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">Camera pipeline</figcaption></figure><p id="0e43" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从上图可以看出，捕捉到的图像经过“很长”的一段路到达你的电脑，然后被解码并显示在屏幕上。</p><h1 id="ddd2" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">测量延迟</h1><p id="9e84" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">为了测量实际图像被捕获和显示在屏幕上之间的延迟，我们将快速编写一个简单的Python脚本，以尽可能快的速度从摄像机读取图像，并在管道末端检测到之前的颜色变化时立即翻转显示颜色。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff lr"><img src="../Images/b9e1cc87797e9c4ace70e6295debb87d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iUbcvjeVWhjxrd7K.png"/></div></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">Measure latency</figcaption></figure><p id="e52a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">前面的序列表明等待时间可能比几帧长。</p><p id="dd5f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是这个实验的逻辑图。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff ls"><img src="../Images/8b71dd512ad02215312d78ace8936f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/0*URR495FyFUgimzSV.png"/></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">Flowchart</figcaption></figure><p id="b2b3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">完整的脚本如下所示。</p><figure class="kb kc kd ke fq iv"><div class="bz el l di"><div class="lt lu l"/></div></figure><p id="edca" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将您的相机指向弹出窗口，观察每秒钟黑白之间的几次颜色翻转，这反映了延迟。</p><p id="6f1a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">你可以将你的相机镜头尽可能靠近屏幕，它不需要有一个清晰的焦点，只需要平均强度就可以使颜色翻转。</p><p id="f87e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我已经在我的罗技C930e USB网络摄像头上测试了它，下面是结果。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff lv"><img src="../Images/0b9d4099250a7a536c39582378b956af.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/0*LH1UL33VLndhTsEk.gif"/></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">Demo</figcaption></figure><p id="6d8d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">测试了两种图像分辨率，您可以看到较低的分辨率产生的延迟稍低。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/4f7d1f7a9b27bead2ff4a847d9705f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/0*R6OrehmPvtCwolHE.png"/></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">Latency distribution 640 x 480</figcaption></figure><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/47c37e0a520a6832341e6e9ee66ab2e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/0*7lejMZcAnVPXdUBr.png"/></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">Latency distribution 1280 x 720</figcaption></figure><p id="2b77" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">该值以毫秒为单位，平均值约为200毫秒。假设传送带以1米/秒的恒定速度运行，瓶子已经移动了20厘米远。</p><h1 id="cf33" class="kj kk hu bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dt translated">解决方法是什么？</h1><p id="c3ce" class="pw-post-body-paragraph jc jd hu je b jf lh jh ji jj li jl jm jn lj jp jq jr lk jt ju jv ll jx jy jz hn dt translated">如果您的应用需要更多的预测和更低延迟的图像捕捉，一个简单有效的解决方案是将您的相机升级为具有外部触发信号的工业相机，其中可以连接一个<a class="ae ly" href="https://en.wikipedia.org/wiki/Photoelectric_sensor" rel="noopener ugc nofollow" target="_blank">光电眼传感器</a>或数字控制IO。</p><figure class="kb kc kd ke fq iv fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/5246371b5972300ad5e34460c243d46a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/0*vCMxzouwyGv4xlrB.png"/></div><figcaption class="kf kg fg fe ff kh ki bd b be z ek">External trigger</figcaption></figure><p id="7062" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这种情况下，可以在更具预测性的时间戳捕获图像，该时间戳可以由阻挡光电眼传感器的东西或来自计算机的实时信号触发。</p><p id="c9ae" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><a class="ae ly" href="https://twitter.com/intent/tweet?url=https%3A//www.dlology.com/blog/how-to-measure-the-latency-of-a-webcam-with-opencv/&amp;text=How%20to%20measure%20the%20latency%20of%20a%20WebCam%20with%20OpenCV" rel="noopener ugc nofollow" target="_blank">在Twitter上分享</a> <a class="ae ly" href="https://www.facebook.com/sharer/sharer.php?u=https://www.dlology.com/blog/how-to-measure-the-latency-of-a-webcam-with-opencv/" rel="noopener ugc nofollow" target="_blank">在脸书分享</a></p></div><div class="ab cl ma mb hc mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hn ho hp hq hr"><p id="04b6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">【www.dlology.com】最初发表于<a class="ae ly" href="https://www.dlology.com/blog/how-to-measure-the-latency-of-a-webcam-with-opencv/" rel="noopener ugc nofollow" target="_blank"><em class="mh"/></a><em class="mh">。</em></p></div></div>    
</body>
</html>