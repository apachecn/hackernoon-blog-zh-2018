<html>
<head>
<title>How to Integrate Scatter Desktop Wallet into your EOS Dapps using Reactjs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Reactjs将分散桌面钱包集成到您的EOS Dapps中</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-integrate-scatter-desktop-wallet-into-your-eos-dapps-using-reactjs-170d6d83d7a0?source=collection_archive---------13-----------------------#2018-12-03">https://medium.com/hackernoon/how-to-integrate-scatter-desktop-wallet-into-your-eos-dapps-using-reactjs-170d6d83d7a0?source=collection_archive---------13-----------------------#2018-12-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="39ab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你可能已经熟悉了<a class="ae jp" href="https://hackernoon.com/tagged/scatter" rel="noopener ugc nofollow" target="_blank"> Scatter </a>，这是一个网络/桌面钱包，让普通用户可以轻松存储他们的私钥并与应用程序进行交互。将Scatter整合到应用程序中可能会很棘手，因为Scatter正在快速改进，最近已经引入了一些突破性的变化。有很多人问我关于整合Scatter的问题，所以我写了这篇教程，讲述如何将最新版本的Scatter Desktop整合到你的分布式<a class="ae jp" href="https://hackernoon.com/tagged/eos" rel="noopener ugc nofollow" target="_blank"> EOS </a>应用中。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jq"><img src="../Images/0e064aa3595ac15b5b1152cb24cbc063.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*GAatPIl7XViIBSV51J_XPQ.png"/></div></figure><h1 id="8054" class="jy jz hu bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dt translated">创建您的分散集成</h1><p id="09f5" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">我们将从在组件内部设置散布开始，并创建一个事务方法。我们将能够在应用程序中的任何地方使用它，使用户能够用Scatter签署交易。</p><h2 id="faf8" class="lb jz hu bd ka lc ld le ke lf lg lh ki jc li lj km jg lk ll kq jk lm ln ku lo dt translated">创建单独的分散文件并安装依赖项</h2><p id="a1ca" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">确保导入eosjs、scatterjs-core和scatterjs-plugin-eosjs2。注意，我们正在导入‘scatter js-plugin-eosjs 2 ’,因为我们的EOS js版本大于16。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="b6e4" class="lb jz hu lq b fv lu lv l lw lx">npm i -S eosjs<br/>npm i -S scatterjs-core<br/>npm i -S scatterjs-plugin-eosjs2</span></pre><p id="875e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我强烈建议将您的核心分散功能分解到一个单独的文件中，我通常称之为eosio-client.js。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="72e7" class="lb jz hu lq b fv lu lv l lw lx">import React from “react”;<br/>import { Api, JsonRpc, JsSignatureProvider } from “eosjs”;<br/>import ScatterJS from “scatterjs-core”;<br/>import ScatterEOS from “scatterjs-plugin-eosjs2”; </span></pre><h2 id="4d8d" class="lb jz hu bd ka lc ld le ke lf lg lh ki jc li lj km jg lk ll kq jk lm ln ku lo dt translated">设置您的网络和端点</h2><p id="f8a3" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">接下来，我们要定义一个端点和网络。您的端点将是您的eosio合同的所在地。如果您在本地机器上使用契约，它可能类似于<a class="ae jp" href="http://localhost:8888." rel="noopener ugc nofollow" target="_blank"> http://localhost:8888。</a>如果你已经部署到丛林网，你可以从这里选择一个端点:<a class="ae jp" href="http://jungle.cryptolions.io/#apiendpoints" rel="noopener ugc nofollow" target="_blank">http://jungle.cryptolions.io/#apiendpoints</a>。在mainnet上，大多数块生产者都有可用的api端点，您可以从这些端点中选择任何一个:<a class="ae jp" href="https://www.eosdocs.io/resources/apiendpoints/" rel="noopener ugc nofollow" target="_blank">https://www.eosdocs.io/resources/apiendpoints/</a>。</p><p id="7701" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将访问部署到丛林网络的合同，因此我们将使用以下端点:</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="b47b" class="lb jz hu lq b fv lu lv l lw lx">const endpoint = "<a class="ae jp" href="http://jungle.cryptolions.io:18888" rel="noopener ugc nofollow" target="_blank">http://jungle2.cryptolions.io:8</a>0";</span></pre><p id="b891" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">接下来我们将建立我们的网络。网络引用某些区块链，所以你可以获得帐户，并建立签名提供商。注意，在这个例子中我们将使用Jungle(测试网)chainId。如果我们使用Mainnet，我们将使用chainId“ACA 376 f 206 b 8 fc 25 a 6 ed 44 dbdc 66547 c 36 c 6 c 33 e 3a 119 FB beaef 943642 f 0 e 906”。我们也指定了正在使用的区块链，因为你实际上可以和其他区块链像以太坊和创一起使用散射。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="7a27" class="lb jz hu lq b fv lu lv l lw lx">const network = {<br/>  blockchain: "eos",<br/>  protocol: "http",<br/>  host: "jungle2.cryptolions.io",<br/>  port: 80,<br/>  chainId:      "e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473" <br/>};</span></pre><h2 id="8c9d" class="lb jz hu bd ka lc ld le ke lf lg lh ki jc li lj km jg lk ll kq jk lm ln ku lo dt translated">设置您的组件</h2><p id="386f" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">我们将能够在应用程序中的任何地方实例化EOSIOClient的实例，这将使我们能够访问我们在这里创建的变量和方法。我们将设置我们的构造函数来接受一个参数contractAccount。这将使我们能够通过为特定的EOSIOClient实例传递我们想要使用的任何契约名称来与应用程序中的多个契约进行交互。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="e60b" class="lb jz hu lq b fv lu lv l lw lx">export default class EOSIOClient extends React.Component {<br/> constructor(contractAccount) {<br/>  super(contractAccount);<br/>  this.contractAccount = contractAccount;<br/></span></pre><p id="2373" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">从我们的构造函数中设置ScatterJS。确保传入新的ScatterEOS()，这将告诉Scatter我们正在使用“scatterjs-plugin-eosjs2”。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="e94c" class="lb jz hu lq b fv lu lv l lw lx">ScatterJS.plugins(new ScatterEOS());</span></pre><h2 id="de39" class="lb jz hu bd ka lc ld le ke lf lg lh ki jc li lj km jg lk ll kq jk lm ln ku lo dt translated">连接到散点并创建参考</h2><p id="a778" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">我们在构造函数中要做的最后一件事是连接到Scatter，创建一个对您的帐户的引用，并创建一个对完全初始化的Scatter代理的引用。这有很多代码，但是最好将其显示为一个单独的块。如果这需要更多的解释，请在评论中告诉我。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="7f31" class="lb jz hu lq b fv lu lv l lw lx">try {<br/>   ScatterJS.scatter.connect(this.contractAccount).then(connected =&gt; {<br/>     if (!connected) return console.log("Issue Connecting");</span><span id="4d6f" class="lb jz hu lq b fv ly lv l lw lx">   const scatter = ScatterJS.scatter;</span><span id="4c62" class="lb jz hu lq b fv ly lv l lw lx">   const requiredFields = {<br/>     accounts: [network] // We defined this above<br/>   };</span><span id="9e28" class="lb jz hu lq b fv ly lv l lw lx">   scatter.getIdentity(requiredFields).then(() =&gt; {<br/>     this.account = scatter.identity.accounts.find(<br/>       x =&gt; x.blockchain === "eos"<br/>     );</span><span id="e2b3" class="lb jz hu lq b fv ly lv l lw lx">     const rpc = new JsonRpc(endpoint);<br/>       this.eos = scatter.eos(network, Api, { rpc });<br/>     });</span><span id="4054" class="lb jz hu lq b fv ly lv l lw lx">     window.ScatterJS = null; // Don't forget to do this!<br/>   <br/>     });</span><span id="5fda" class="lb jz hu lq b fv ly lv l lw lx">  } catch (error) {<br/>    console.log(error);<br/>  }<br/>} // Close the constructor function</span></pre><p id="172b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请注意，设置上面的this.accounts非常重要，而不是硬编码您的帐户信息或向您的用户询问信息。</p><h2 id="73ac" class="lb jz hu bd ka lc ld le ke lf lg lh ki jc li lj km jg lk ll kq jk lm ln ku lo dt translated">添加交易方法</h2><p id="34ae" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">您现在已经准备好使用散点来签署交易。每当我们在EOSIOClient实例上调用事务方法时，我们都要传入动作名称和数据。这是一个相当简单的事务，我们将用它来与我们的智能合约进行基本的交互。您可以查看eosjs文档来构建更复杂的(多动作)方法，但这应该适用于最基本的智能契约交互。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="75cf" class="lb jz hu lq b fv lu lv l lw lx">transaction = (action, data) =&gt; {<br/>  return this.eos.transact(<br/>    {<br/>      actions: [<br/>        {<br/>          account: this.contractAccount,<br/>          name: action,<br/>          authorization: [<br/>            {<br/>              actor: this.account.name,<br/>              permission: this.account.authority<br/>            }<br/>          ],<br/>          data: {<br/>       ...data<br/>      }<br/>     }<br/>    ]<br/>   },<br/>   {<br/>    blocksBehind: 3,<br/>    expireSeconds: 30<br/>   }<br/>  );<br/> };</span></pre><p id="6cb4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">祝贺您，您已经成功地设置了您的应用程序，以便用户可以使用Scatter签署交易。你可以在这里看到这个文件<a class="ae jp" href="https://github.com/liebeskind/ScatterExample" rel="noopener ugc nofollow" target="_blank">的完整版本。</a></p><h1 id="1414" class="jy jz hu bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dt translated">在应用程序中创建一个EOSIOClient实例</h1><p id="dd97" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">确保将EOSIOClient导入到文件中。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="8dec" class="lb jz hu lq b fv lu lv l lw lx">import EOSIOClient from "../utils/eosio-client";</span></pre><p id="a30f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在构造函数内部，创建一个this.eosio引用。请确保您也浏览了<a class="ae jp" href="https://github.com/GetScatter/ScatterApps" rel="noopener ugc nofollow" target="_blank"> ScatterApps </a>，并将您的应用添加到apps.json文件中。将契约帐户名传递到初始化器中。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="47fd" class="lb jz hu lq b fv lu lv l lw lx">this.eosio = new EOSIOClient(“YOUR APP NAME”);</span></pre><h2 id="1fec" class="lb jz hu bd ka lc ld le ke lf lg lh ki jc li lj km jg lk ll kq jk lm ln ku lo dt translated">创建您的第一笔交易</h2><p id="3d0a" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">我们准备创建我们的第一个事务。在本例中，用户打算购买RAM。在我们的界面中，用户可以输入要购买的字节数，然后点击“立即购买”,这将触发这个函数调用。</p><pre class="jr js jt ju fq lp lq lr ls aw lt dt"><span id="07ba" class="lb jz hu lq b fv lu lv l lw lx">handleBuyRam = async event =&gt; {<br/><br/>  event.preventDefault();<br/>  let bytes = event.target.bytes.value;</span><span id="d27e" class="lb jz hu lq b fv ly lv l lw lx">  const actionName = "buyrambytes";<br/>  const actionData = {<br/>    buyer: accountName,<br/>    receiver: accountName,<br/>    bytes: parseInt(bytes)<br/>  };</span><span id="8565" class="lb jz hu lq b fv ly lv l lw lx">  try {<br/>    const result = await this.eosio.transaction(actionName, actionData);</span><span id="d97f" class="lb jz hu lq b fv ly lv l lw lx">    console.log(result);<br/>      this.getBalance(); // We can check a user's EOS balance.<br/>    } catch (e) {<br/>      console.log("\nCaught exception: " + e);<br/>      if (e instanceof RpcError) console.log(JSON.stringify(e.json, null, 2));<br/>    }<br/>};</span></pre><h1 id="8020" class="jy jz hu bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dt translated">后续步骤</h1><p id="c78b" class="pw-post-body-paragraph ir is hu it b iu kw iw ix iy kx ja jb jc ky je jf jg kz ji jj jk la jm jn jo hn dt translated">这里有另一个链接指向完整的eosio-client.js文件，以防你错过了上面的链接。</p><p id="fea8" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您现在可以设置散点，创建多个指向不同合同的EOSIOClient实例，并调用事务。如果您想让我写一篇关于从区块链获取信息并显示给您的用户的后续文章，请告诉我！</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="lz ma l"/></div></figure></div></div>    
</body>
</html>