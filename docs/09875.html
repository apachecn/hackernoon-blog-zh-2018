<html>
<head>
<title>Building a Personal Expense Tracker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建立个人支出追踪系统</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/building-a-personal-expense-tracker-657553ef920?source=collection_archive---------13-----------------------#2018-12-07">https://medium.com/hackernoon/building-a-personal-expense-tracker-657553ef920?source=collection_archive---------13-----------------------#2018-12-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/263df6638cb2117470bfdd11af759a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mrz6_YJIXehscG2B"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/@mirzababic?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mirza Babic</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fb7f" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">最近，我对分析和跟踪我每月的消费模式产生了兴趣。有像<a class="ae jg" href="https://www.mint.com/" rel="noopener ugc nofollow" target="_blank"> Mint </a>这样的工具可以帮助你做到这一点。然而，我更感兴趣的是访问历史原始信用卡交易数据进行分析。此外，我发现像<a class="ae jg" href="https://www.mint.com/" rel="noopener ugc nofollow" target="_blank">铸币厂</a>这样的服务在准确分类交易方面做得不是很好。例如，如果我在亚马逊或谷歌上买东西，费用会被归入一般的<em class="kf">购物</em>类别。举例来说，如果我试图计算出我每个月在亚马逊上购物的花费，这不是很有用。</p><p id="7c77" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">很自然地，我决定构建我自己的更适合我的用例的东西，包括:</p><ul class=""><li id="d109" class="kg kh hu jj b jk jl jo jp js ki jw kj ka kk ke kl km kn ko dt translated">访问原始历史信用卡交易数据</li><li id="087b" class="kg kh hu jj b jk kp jo kq js kr jw ks ka kt ke kl km kn ko dt translated">更精细的事务分类</li></ul><p id="44cd" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这篇文章的其余部分详细描述了我如何构建了一个跟踪我每月开销的小应用程序。</p></div><div class="ab cl ku kv hc kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hn ho hp hq hr"><h2 id="2d00" class="lb lc hu bd ld le lf lg lh li lj lk ll js lm ln lo jw lp lq lr ka ls lt lu lv dt translated">获取信用卡交易数据</h2><p id="78ee" class="pw-post-body-paragraph jh ji hu jj b jk lw jm jn jo lx jq jr js ly ju jv jw lz jy jz ka ma kc kd ke hn dt translated">银行和信用卡公司不会让您轻松地以编程方式查询信用卡交易数据。谢天谢地<a class="ae jg" href="https://plaid.com/" rel="noopener ugc nofollow" target="_blank">格子</a>让这变得超级简单。Plaid提供了各种编程语言的客户端SDK，您可以使用这些SDK连接到您的信用卡或借记卡帐户，并查询交易数据。</p><p id="edef" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">为了开始使用Plaid，我需要创建一个帐户并请求API访问密钥。Plaid确实为开发和测试提供了一个免费层，能够连接多达100个实时凭证。这已经足够了，除非您打算编写一个供成百上千用户使用的商业应用程序。你可以在这里注册一个格子<a class="ae jg" href="https://dashboard.plaid.com/signup" rel="noopener ugc nofollow" target="_blank">的账号。</a></p><p id="42ac" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">一旦我创建了一个帐户并有了API访问密钥，下一步就是向我的银行和信用卡提供商进行身份验证，以获得用于plaid API的访问令牌。最简单的方法是使用Plaid提供的<a class="ae jg" href="https://github.com/plaid/quickstart" rel="noopener ugc nofollow" target="_blank">快速启动</a>应用程序。获得访问令牌后，我就可以开始使用plaid API查询事务数据了。</p><p id="363b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我使用Plaids ruby SDK创建了一个简单的包装器类来查询信用卡交易数据。该类的结构如下:</p><figure class="mb mc md me fq iv"><div class="bz el l di"><div class="mf mg l"/></div></figure><p id="2c14" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在这个类的<code class="eh mh mi mj mk b">initialize</code>方法中，我创建了一个<code class="eh mh mi mj mk b">Plaid::Client</code>对象的实例，用于应用程序和Plaid服务器之间的所有通信。我使用<code class="eh mh mi mj mk b">vault</code>来管理我所有的访问令牌。方法<code class="eh mh mi mj mk b">load_secrets_from_vault</code>只是从我运行的<code class="eh mh mi mj mk b">vault</code>服务器的本地实例中加载应用程序秘密。方法<code class="eh mh mi mj mk b">get_credit_card_accounts</code>只获取我在银行的信用卡账户的账户元数据(特别是账户id，用于以后的交易查询)。这是必要的，因为我只想跟踪我的信用卡账户上的交易活动(因为这些是我日常开销所用的)。最后，方法<code class="eh mh mi mj mk b">get_transactions</code>获取给定数据范围的所有事务。因为事务的数量可能很大，所以Plaid API返回一个分页的响应，这个响应由<code class="eh mh mi mj mk b">get_transactions</code>函数来处理。</p><p id="496b" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在检索事务数据之后，我需要对它进行一些清理。具体来说，我想删除未决交易和信用卡付款。此外，我想对事务分类进行一点清理。Plaid返回与事务相关的类别的层次分类。对于我的用例，我对类别的层次结构并不感兴趣——所以我最终将它们连接起来，得到一个完全合格的描述性类别名称。此外，有时事务没有与之相关联的类别。在本例中，我没有将类别留空，而是使用了与交易相关联的供应商名称。最后，Plaid返回的事务对象有很多属性。我倾向于只提取我需要的。下面的<code class="eh mh mi mj mk b">DataSanitize</code>类代码片段捕获了这些清理方法。</p><figure class="mb mc md me fq iv"><div class="bz el l di"><div class="mf mg l"/></div></figure><p id="3bf4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">最后，我编写了一个小模块来每月汇总所有交易，并生成每月支出报告。</p><figure class="mb mc md me fq iv"><div class="bz el l di"><div class="mf mg l"/></div></figure><p id="2304" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我还最终生成了一份月度HTML电子邮件报告，并将所有原始交易数据保存到了AWS DynamoDB中，供以后使用和分析。你可以点击查看完整的代码库<a class="ae jg" href="https://github.com/skabbass1/spendthrift" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>