<html>
<head>
<title>How to secure your Wifi network with Freeradius</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Freeradius保护您的Wifi网络</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-secure-your-wifi-network-with-freeradius-94e0812a83bf?source=collection_archive---------0-----------------------#2018-12-09">https://medium.com/hackernoon/how-to-secure-your-wifi-network-with-freeradius-94e0812a83bf?source=collection_archive---------0-----------------------#2018-12-09</a></blockquote><div><div class="ff gx gy gz ha hb"/><div class="hc hd he hf hg"><figure class="hi hj eu ew hk hl el em paragraph-image"><div role="button" tabindex="0" class="hm hn di ho bf hp"><div class="el em hh"><img src="../Images/c3f31d01f54d97085dd86d4a9500cc21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WaQhvRKYEqpd0sdU2VXlZg.jpeg"/></div></div></figure><div class=""/><p id="91ee" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">在我们学校，我们有一个开放的无线网络，带有一个强制网络门户和另一个仅供教师使用的WLAN (WPA Enterprise，802.1X)。对于这两个网络，我们都使用RADIUS服务器进行身份验证。Freeradius是使用最广泛的开源radius服务器，我们也在使用。在本文中，我们希望为加密连接设置一个Freeradius服务器和证书。特别是，我想把重点放在与linuxmuster.net 6.2的连接和与LDAP服务器的认证上。</p><p id="53b3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">RADIUS服务器通常负责三件事:认证、授权和计费(通常称为AAA)。我们将只处理前两个“As”，即凭证是否正确以及用户是否被授权访问(例如，访问Wifi)。</p><h1 id="7d5b" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">安装自由半径</h1><p id="2f1a" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">我们在当前的Linux安装(这里是Ubuntu 18.04服务器)上执行安装，例如在<a class="ae ks" href="https://openschoolsolutions.org/5-reasons-use-lxd/" rel="noopener ugc nofollow" target="_blank"> LXD容器</a>或虚拟机中。</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="c3aa" class="lc jq hu ky b fi ld le l lf lg">$ apt install freeradius freeradius-ldap freeradius-utils</span></pre><h1 id="bafe" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">配置</h1><h2 id="3cf2" class="lc jq hu bd jr lh li lj jv lk ll lm jz jc ln lo kd jg lp lq kh jk lr ls kl lt dt translated">基本配置</h2><p id="576c" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">为了测试我们的freeradius服务器，我们在<strong class="it hv"><em class="lu">/etc/freeradius/3.0/users</em></strong>中注释掉以下行，或者将其插入文件的开头:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="16f2" class="lc jq hu ky b fi ld le l lf lg"># Remove the “#” before the next line<br/>steve Cleartext-Password := “testing”</span></pre><p id="5018" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">默认情况下，文件<strong class="it hv"><em class="lu">/etc/freeradius/3.0/clients . conf</em></strong>应该包含本地主机作为客户端:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="05d8" class="lc jq hu ky b fi ld le l lf lg">client localhost {<br/>    ipaddr = 127.0.0.1<br/>    secret = testing123<br/>}</span></pre><p id="b2ff" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">现在我们可以进行第一次测试。因此，我们停止freeradius服务，并在调试模式下手动重启它:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="7394" class="lc jq hu ky b fi ld le l lf lg">$ systemctl stop freeradius.service<br/>$ freeradius -X<br/>…<br/>Ready to process request</span></pre><p id="3777" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">重要的是，最后有“<em class="lu">准备好处理请求</em>”。</p><h2 id="385a" class="lc jq hu bd jr lh li lj jv lk ll lm jz jc ln lo kd jg lp lq kh jk lr ls kl lt dt translated">测试基本配置</h2><p id="a4f6" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">接下来，我们检查我们的测试用户“Steve”是否可以登录到RADIUS服务器(最好是在新的/第二个终端中):</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="6d47" class="lc jq hu ky b fi ld le l lf lg">$ radtest steve testing 127.0.0.1 10 testing123</span></pre><p id="0917" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">如果一切正常，我们应该得到以下答案:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="39bd" class="lc jq hu ky b fi ld le l lf lg">Sent Access-Request Id 234 from 0.0.0.0:40302 to 127.0.0.1:1812 length 75<br/>User-Name = “steve”<br/>User-Password = “testing”<br/>NAS-IP-Address = 10.18.10.60<br/>NAS-Port = 10<br/>Message-Authenticator = 0x00<br/>Cleartext-Password = “testing”<br/>Received Access-Accept Id 234 from 127.0.0.1:1812 to 0.0.0.0:0 length 20</span></pre><p id="22bd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">我们获得<em class="lu">访问接受</em>是很重要的。如果此请求成功，则freeradius服务器基本上已设置完毕，并且以下身份验证过程应该正常工作，不会再出现任何问题:</p><ul class=""><li id="d6c6" class="lv lw hu it b iu iv iy iz jc lx jg ly jk lz jo ma mb mc md dt translated">奶头</li><li id="782d" class="lv lw hu it b iu me iy mf jc mg jg mh jk mi jo ma mb mc md dt translated">无檐软平帽</li><li id="1a1b" class="lv lw hu it b iu me iy mf jc mg jg mh jk mi jo ma mb mc md dt translated">MS-CHAPv1</li><li id="9651" class="lv lw hu it b iu me iy mf jc mg jg mh jk mi jo ma mb mc md dt translated">MS-CHAPv2</li><li id="2fc0" class="lv lw hu it b iu me iy mf jc mg jg mh jk mi jo ma mb mc md dt translated">PEAP</li><li id="8758" class="lv lw hu it b iu me iy mf jc mg jg mh jk mi jo ma mb mc md dt translated">EAP-TTLS</li><li id="b830" class="lv lw hu it b iu me iy mf jc mg jg mh jk mi jo ma mb mc md dt translated">EAP-GTC</li><li id="eba8" class="lv lw hu it b iu me iy mf jc mg jg mh jk mi jo ma mb mc md dt translated">EAP-MD5</li></ul><p id="0f8d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">这些方法是不同的“安全”协议。所有都使用用户名和密码进行身份验证。你可以在这里阅读更多关于不同的(P)EAP方法<a class="ae ks" href="https://wiki.freeradius.org/protocol/EAP" rel="noopener ugc nofollow" target="_blank">。MS-CHAPv1和v2是微软的协议。</a></p><blockquote class="mj mk ml"><p id="fc77" class="ir is lu it b iu iv iw ix iy iz ja jb mm jd je jf mn jh ji jj mo jl jm jn jo hc dt translated"><strong class="it hv">注意:</strong>我们现在应该注释或删除带有我们的用户“Steve”的行！</p></blockquote><p id="5270" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">在下文中，我们将配置LDAP模块并为EAP-TTLS创建新的证书。</p><h2 id="41d8" class="lc jq hu bd jr lh li lj jv lk ll lm jz jc ln lo kd jg lp lq kh jk lr ls kl lt dt translated">设置LDAP连接</h2><p id="2cd1" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">我们在文件<strong class="it hv"><em class="lu">/etc/freeradius/3.0/MODS-enabled/LDAP</em></strong>中配置LDAP服务器。如果这个文件不存在，我们必须首先创建一个符号链接。</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="cea0" class="lc jq hu ky b fi ld le l lf lg">$ cd /etc/freeradius/3.0/mods-enabled/<br/>$ ln -s ../mods-available/ldap ./</span></pre><p id="c6e6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">在文件的开头，我们配置了LDAP服务器:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="a4e6" class="lc jq hu ky b fi ld le l lf lg">server = “ldaps://linuxmuster.internal.example.com”<br/>identity = “cn=admin,dc=internal,dc=example,dc=com”<br/>password = superSecretPassword<br/>base_dn = “ou=accounts,dc=internal,dc=example,dc=com”<br/>…<br/>group {<br/>    …<br/>    membership_filter = “(|(member=%{control:Ldap-UserDn})(memberUid=%{%{Stripped-User-Name}:-%{User-Name}}))”<br/>    …<br/>}</span></pre><p id="862e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">您必须确保RADIUS和LDAP服务器之间通信所需的所有端口都是打开的。</p><blockquote class="mj mk ml"><p id="d04c" class="ir is lu it b iu iv iw ix iy iz ja jb mm jd je jf mn jh ji jj mo jl jm jn jo hc dt translated"><strong class="it hv">注意:</strong>如果您想将Freeradius 3.0与linuxmuster.net 6.2一起使用，您必须调整以下代码行，以便与Windows一起进行身份验证(<a class="ae ks" href="https://wiki.freeradius.org/guide/certificate-compatibility" rel="noopener ugc nofollow" target="_blank"> … </a>):</p></blockquote><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="67fc" class="lc jq hu ky b fi ld le l lf lg">update {<br/>    control:Password-With-Header += ‘userPassword’<br/>    control:NT-Password := ‘sambaNTPassword’<br/>    …<br/>}</span></pre><h2 id="3bc3" class="lc jq hu bd jr lh li lj jv lk ll lm jz jc ln lo kd jg lp lq kh jk lr ls kl lt dt translated">测试LDAP连接</h2><p id="c761" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">在freeradius中配置LDAP服务器后，我们必须重新启动freeradius一次，然后可以测试LDAP中的用户是否可以登录到radius服务器。</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="a797" class="lc jq hu ky b fi ld le l lf lg">$ systemctl restart freeradius.service<br/>$ radtest testuser password localhost 10 testing123<br/>Sent Access-Request Id 213 from 0.0.0.0:46425 to 127.0.0.1:1812 length 73<br/>User-Name = “testuser”<br/>User-Password = “password”<br/>NAS-IP-Address = 10.18.10.60<br/>NAS-Port = 10<br/>Message-Authenticator = 0x00<br/>Cleartext-Password = “password”<br/>Received Access-Accept Id 213 from 127.0.0.1:1812 to 0.0.0.0:0 length 20</span></pre><p id="90a4" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">如果我们再次收到“<em class="lu"> Received Access-Accept </em>”作为回答，RADIUS和LDAP服务器之间的连接正常。如果不行，我们应该手动启动RADIUS服务器，看看RADIUS服务器给我们什么错误。</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="9a3a" class="lc jq hu ky b fi ld le l lf lg">$ systemctl stop freeradius.service<br/>$ freeradius -X<br/>…<br/>Ready to process request</span></pre><h2 id="8a70" class="lc jq hu bd jr lh li lj jv lk ll lm jz jc ln lo kd jg lp lq kh jk lr ls kl lt dt translated">创建证书(针对EAP-TTLS)</h2><p id="9f46" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">默认情况下，Freeradius使用所谓的蛇油证书，这当然不是为了生产用途。因此，我们在下面的步骤中为服务器创建一个新的根CA和一个证书。您将在<strong class="it hv"><em class="lu">/etc/freeradius/3.0/certs/</em></strong>中找到证书和相应的配置文件。首先我们打开文件<strong class="it hv"> <em class="lu"> ca.cnf </em> </strong>并更改一些设置:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="20e3" class="lc jq hu ky b fi ld le l lf lg">…<br/>[ CA_default ]<br/>…<br/>default_days = 3650<br/>…<br/>default_md = sha256<br/>…</span><span id="c671" class="lc jq hu ky b fi mp le l lf lg">[ req ]<br/>…<br/>default_bits = 2048<br/>input_password = supersecretandlongpassword<br/>output_password = supersecretandlongpassword<br/>…</span><span id="7f26" class="lc jq hu ky b fi mp le l lf lg">[certificate_authority]<br/>countryName = US<br/>stateOrProvinceName = My State<br/>localityName = My Town<br/>organizationName = My School<br/>emailAddress = admin@my-school.org<br/>commonName = “CA Freeradius”<br/>…</span></pre><p id="5c3c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">我们现在对文件<strong class="it hv"> <em class="lu"> server.cnf </em> </strong>进行类似的设置:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="9f01" class="lc jq hu ky b fi ld le l lf lg">…<br/>[ CA_default ]<br/>…<br/>default_days = 3560<br/>…<br/>default_md = sha256<br/>…</span><span id="ad8b" class="lc jq hu ky b fi mp le l lf lg">[ req ]<br/>…<br/>default_bits = 2048<br/>input_password = supersecretandlongpassword<br/>output_password = supersecretandlongpassword</span><span id="196d" class="lc jq hu ky b fi mp le l lf lg">[server]<br/>countryName = US<br/>stateOrProvinceName = My State<br/>localityName = My Town<br/>organizationName = My School<br/>emailAddress = admin@my-school.org<br/>commonName = “Freeradius Server Certificate”</span></pre><p id="1345" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">现在我们还必须更改文件<strong class="it hv"><em class="lu">/etc/freeradius/3.0/MODS-enabled/EAP</em></strong>中的密码:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="c98b" class="lc jq hu ky b fi ld le l lf lg">tls-config tls-common {<br/>    private_key_password = supersecretandlongpassword<br/>    …<br/>}</span></pre><p id="b186" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">我们用一个简单的<code class="fh mq mr ms ky b">make</code>来创建证书:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="61fc" class="lc jq hu ky b fi ld le l lf lg">$ cd /etc/freeradius/3.0/certs/<br/>$ make</span></pre><h2 id="a30e" class="lc jq hu bd jr lh li lj jv lk ll lm jz jc ln lo kd jg lp lq kh jk lr ls kl lt dt translated">测试EAP-TTLS登录</h2><h2 id="e0b7" class="lc jq hu bd jr lh li lj jv lk ll lm jz jc ln lo kd jg lp lq kh jk lr ls kl lt dt translated">编译epol_test</h2><p id="cf27" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated"><code class="fh mq mr ms ky b">radtest</code>不支持EAP-TTLS认证测试。为此，我们需要工具<code class="fh mq mr ms ky b">eapol_test</code>，它是wpa_supplicant 包的一部分。可惜这个工具不是默认由<em class="lu"> wpa_supplicant </em>构建的，所以我们得自己动手。我们下载源代码，将其解包，然后安装一些依赖项。</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="579d" class="lc jq hu ky b fi ld le l lf lg">$ wget <a class="ae ks" href="https://w1.fi/releases/wpa_supplicant-2.7.tar.gz" rel="noopener ugc nofollow" target="_blank">https://w1.fi/releases/wpa_supplicant-2.7.tar.gz</a><br/>$ tar -xzvf wpa_supplicant-2.7.tar.gz<br/>$ apt install build-essential pkg-config libnl-3-dev libssl-dev libnl-genl-3-dev<br/>$ cd wpa_supplicant-2.7<br/>$ cp defconfig .config</span></pre><p id="9ab5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">然后我们要打开文件<strong class="it hv">。配置</strong>并找到行<em class="lu">#配置_ EAPOL _测试=y </em>并删除“#”。</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="045e" class="lc jq hu ky b fi ld le l lf lg">$ nano .config<br/># Remove the “#”<br/>CONFIG_EAPOL_TEST=y</span></pre><p id="1818" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">我们使用以下命令构建程序，并将其复制到正确的位置:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="a6e8" class="lc jq hu ky b fi ld le l lf lg">$ make eapol_test<br/>$ cp eapol_test /usr/local/bin</span></pre><h2 id="095c" class="lc jq hu bd jr lh li lj jv lk ll lm jz jc ln lo kd jg lp lq kh jk lr ls kl lt dt translated">使用eapol_test测试登录</h2><p id="ae8a" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">为了测试EAP-TTLS，我们需要一个用于<code class="fh mq mr ms ky b">eapol_test</code>的小配置文件，如下所示:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="9857" class="lc jq hu ky b fi ld le l lf lg">$ nano eapol_test.conf<br/>network={<br/>    ssid=”example”<br/>    key_mgmt=WPA-EAP <br/>    eap=TTLS<br/>    identity=”user”<br/>    anonymous_identity=”anonymous”<br/>    password=”supersecret”<br/>    phase2=”auth=PAP”<br/>}</span></pre><p id="c471" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">现在我们可以称<code class="fh mq mr ms ky b">eapol_test</code>:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="1f4a" class="lc jq hu ky b fi ld le l lf lg">$ eapol_test -c eapol_test.conf -a 127.0.0.1 -p 1812 -s testing123</span></pre><p id="9a90" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">如果你在最后得到这个问题，一切都是成功的:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="b44f" class="lc jq hu ky b fi ld le l lf lg">MPPE keys OK: 1 mismatch: 0<br/>SUCCESS</span></pre><h1 id="154b" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">设置客户端(例如接入点)</h1><p id="aca8" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">到目前为止，我们只在RADIUS服务器上直接测试过。通常，身份验证请求来自接入点、强制网络门户或无线控制器。我们必须将它们设置为RADIUS服务器上的客户端。我们打开文件<strong class="it hv"><em class="lu">/etc/freeradius/3.0/clients . conf</em></strong>，插入所有接入点等。以他们的IP和密码/秘密结尾:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="7da0" class="lc jq hu ky b fi ld le l lf lg">$ nano /etc/freeradius/3.0/clients.conf<br/>client AP1 {<br/>    ipaddr = 10.0.0.10<br/>    secret = supersecretsecret<br/>}</span></pre><p id="24f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">现在，您可以在接入点上设置WPA Enterprise (802.1X)网络，并使用其IP、端口(1812)和刚刚设置的密码/密码来配置RADIUS服务器。现在，您应该能够使用移动设备登录WLAN了。</p><h1 id="6986" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">限制对特定LDAP组的访问</h1><p id="2bf5" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">在我们学校，只有员工和教师以及高中生可以访问学校的WLAN。在linuxmuster.net有一群<em class="lu"> p_wifi </em>。该组中的每个人都应该有权访问。到目前为止，我们的RADIUS服务器是以这样一种方式配置的，即每个用户都可以在LDAP中访问。为了限制访问，我们将下面几行添加到文件<strong class="it hv"><em class="lu">/etc/freeradius/3.0/users</em></strong>:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="eddf" class="lc jq hu ky b fi ld le l lf lg">DEFAULT Ldap-Group == “cn=p_wifi,ou=groups,dc=internal,dc=example,dc=com”<br/>DEFAULT Auth-Type := Reject<br/>    Reply-Message = “Your are not allowed to access the WLAN!”</span></pre><h1 id="1dc5" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">半径和linuxmuster.net 6.2</h1><p id="448f" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">文档中描述了linuxmuster.net 6.2版Freeradius的安装<a class="ae ks" href="http://docs.linuxmuster.net/en/latest/systemadministration/network/radius/ldap.html" rel="noopener ugc nofollow" target="_blank">。除了几个细节，配置都很像。在Freeradius 2.0中，证书的默认设置不再是最新的，因此某些客户端可能会出现连接问题(例如，当前的macOS)。这里你一定要用Freeradius 3.0的默认值(见上图)！</a></p><h2 id="f01e" class="lc jq hu bd jr lh li lj jv lk ll lm jz jc ln lo kd jg lp lq kh jk lr ls kl lt dt translated">根据无线局域网络不同的接入限制</h2><p id="196f" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">在我们学校，我们有一个面向来宾和学生的专属门户，以及一个面向员工和教师的WPA 802.1X(企业)网络。虽然p_wifi组中的每个人都可以登录到强制网络门户，但只有教师和工作人员可以登录到WPA 802.1X网络。来自强制网络门户的请求来自与WPA企业网络不同的IP ( <a class="ae ks" href="https://openschoolsolutions.org/tag/pfsense/" rel="noopener ugc nofollow" target="_blank"> pfSense </a>)。因此，在文件<strong class="it hv"><em class="lu">/etc/freeradius/sites-enabled/inner-tunnel</em></strong>中，我们包含了一个条件，用于检查请求来自哪个IP，并相应地决定某人是否可以访问:</p><pre class="kt ku kv kw ey kx ky kz la aw lb dt"><span id="d97b" class="lc jq hu ky b fi ld le l lf lg">post-auth {<br/>    …<br/>    #Only allow Teacher&amp;Staff on WPA 802.1X Teacher and Staff network<br/>    if (NAS-IP-Address == 10.0.0.10) {<br/>        if (LDAP-Group == “cn=teachers,ou=groups,dc=internal,dc=example,dc=com” || LDAP-Group == “cn=staff,ou=groups,dc=internal,dc=example,dc=com”) {<br/>            noop<br/>        } else {<br/>            reject<br/>        }<br/>    }<br/>    …<br/>}</span></pre><h1 id="bbb7" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">结论</h1><p id="e056" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hc dt translated">本文仅描述了许多可能配置中的一种。RADIUS服务器很复杂，但是由于freeradius良好的标准配置(尤其是在版本3中)，您很快就会成功。很长一段时间，我们只使用强制网络门户，它工作得很好，但随着WPA 802.1X(企业)网络的使用，可用性和安全性有所提高。没有RADIUS服务器，这是不可能的。</p><p id="375f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">有用的链接:</p><ul class=""><li id="41b9" class="lv lw hu it b iu iv iy iz jc lx jg ly jk lz jo ma mb mc md dt translated"><a class="ae ks" href="http://deployingradius.com/" rel="noopener ugc nofollow" target="_blank">http://deployingradius.com/</a></li><li id="2feb" class="lv lw hu it b iu me iy mf jc mg jg mh jk mi jo ma mb mc md dt translated">https://wiki.freeradius.org/guide/HOWTO<a class="ae ks" href="https://wiki.freeradius.org/guide/HOWTO" rel="noopener ugc nofollow" target="_blank"/></li></ul></div><div class="ab cl mt mu gr mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hc hd he hf hg"><p id="06e6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hc dt translated">【openschoolsolutions.org】最初发表于<a class="ae ks" href="https://openschoolsolutions.org/freeradius-secure-wifi-network/" rel="noopener ugc nofollow" target="_blank"><em class="lu"/></a><em class="lu">。</em></p></div></div>    
</body>
</html>