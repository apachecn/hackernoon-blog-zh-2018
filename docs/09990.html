<html>
<head>
<title>From Code Quality to Integration: Optimizing Alibaba’s Blink Testing Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从代码质量到集成:优化阿里巴巴的Blink测试框架</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/from-code-quality-to-integration-optimizing-alibabas-blink-testing-framework-dc9c357319de?source=collection_archive---------11-----------------------#2018-12-12">https://medium.com/hackernoon/from-code-quality-to-integration-optimizing-alibabas-blink-testing-framework-dc9c357319de?source=collection_archive---------11-----------------------#2018-12-12</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="2805" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated"><em class="jj">阿里巴巴仅用一年时间就完成了革命性分布式开源计算框架的测试和优化。</em></h2></div><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="fe ff jk"><img src="../Images/4e26bd6da4df7d5274614758340ed4c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Dz57bI6NNJNynPdj1PtIg.jpeg"/></div></div></figure><p id="43f0" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated"><em class="ks">本文是</em> <a class="ae kt" rel="noopener" href="/@alitech_2017/a-flink-series-from-the-alibaba-tech-team-b8b5539fdc70"> <strong class="jy hv"> <em class="ks">阿里巴巴旗下Flink系列</em> </strong> </a> <em class="ks">的一部分。</em></p><p id="9059" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">随着对网络设备和基础设施需求的增长，人们越来越需要功能强大的解决方案，以便在某些组件出现故障时仍能正常运行。作为一种这样的解决方案，分布式计算框架通过在整个网络上分散负载来有效地克服潜在的网络停机时间。</p><p id="455c" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">Blink是一个用于数据流处理和批处理的分布式开源计算框架，支持阿里巴巴集团数千项服务的大数据实时处理。为保证其可靠性，2017年成立了Blink测试团队，从零开始建立完整的Blink测试体系，保证Blink的质量。</p><p id="3a99" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">在本文中，在详细探索Blink测试平台之前，我们先看看开源计算框架的基础。</p><h1 id="3077" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">开源计算框架</h1><p id="6e5e" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">Apache Flink是一个广泛使用的分布式开源计算框架，用于数据流处理和批处理。2016年，阿里巴巴以Flink为基础，开始创建Blink框架。2017年，阿里巴巴整合其整个流计算产品，决定基于Blink打造全球领先的实时计算引擎。</p><p id="45ea" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">对于2017年11.11全球购物节，Blink通过同时运行数千个实时计算作业，支持了20多个业务部门和团体，每秒处理的日志达到了惊人的4.7亿条。因此，保证Blink的可靠性和稳定性变得极为重要。为此，Blink测试团队建立了一个全面的测试系统，在短短一年多的时间里，从代码质量进步到持续集成和预测试，并大大提高了Blink的质量。</p><h1 id="7e78" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">眨眼测试平台</h1><p id="7a19" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">测试团队已经定制了Blink测试平台以优化其质量，如下图所示:</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="fe ff lr"><img src="../Images/5007d1eebb213e8f20029c9df693e3eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qae_2y0CHtrC_yfYqFnPZg.jpeg"/></div></div></figure><p id="9f63" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">如上所述，Blink测试平台由三个测试阶段组成。</p><p id="f3a5" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">首先，在代码质量验证中，执行静态代码扫描、单元测试和基于minicluster的测试。</p><p id="8374" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">第二，在集成测试中，执行功能测试、性能测试和破坏性稳定性测试。</p><p id="6348" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">最后，在预测试中，通过模拟用户的工作进行模拟测试，在发布前进行最终版本兼容性测试。</p><p id="f62f" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">该平台选择测试集合的一部分来包含在预提交验证中，以尽早检测代码中的问题。同时，大规模的功能、性能和稳定性测试通常被用作日常构建的集合。此外，Blink测试平台建立了较为完善的质量衡量体系。除了代码覆盖率的统计分析和变化分析，系统可以一键生成测试报告，横向比较不同版本的质量。</p><h2 id="b2cd" class="ls kv hu bd kw lt lu lv la lw lx ly le kf lz ma lg kj mb mc li kn md me lk mf dt translated">代码质量验证阶段</h2><p id="f951" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">代码质量验证阶段是整个Blink质量保证的基础。它主要包括单元测试、代码风格扫描以及基于minicluster的独立集成测试。只有Blink代码通过了这三项测试，才允许提交到项目git，如下图所示:</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="fe ff mg"><img src="../Images/98d4a9d325eca633fbaf3c159a911bae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V9NRbEBSpNA7MDUhaNGXEg.jpeg"/></div></div></figure><h1 id="9ed7" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">功能测试</h1><p id="1896" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">Blink功能测试框架使用Defender，源自pytest，支持Blink SQL测试的特性和第三方插件的引入。此外，它可以用于在测试集群中对场景进行端到端的精确测试(如下图所示)。它支持IDE和Jenkins两种触发模式；案例运行有三种调度模式:yarn_job、yarn_session和local。执行后，以网页或邮件的形式显示结果，并对结果进行持久化。其优点包括:</p><p id="3bfd" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated"><strong class="jy hv"> 1。案件统一调度和精细化管理</strong></p><p id="9e8f" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">目前Blink在防御者上有12个场景超过4000个案例，可以每天固定时间执行dailyrun。如果某类案件发生问题，可以单独执行该案件，并在页面上显示详细情况。</p><p id="0729" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated"><strong class="jy hv"> 2。满足不同场景测试需求的三种运行模式</strong></p><p id="82dc" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">其中，yarn_session模式更适合模块中存在sql case的场景，因为它可以大大减少与yarn的交互时间。</p><p id="dc4d" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated"><strong class="jy hv"> 3。灵活的机箱配置</strong></p><p id="39fc" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">它不仅可以支持系统配置，还可以单独配置每个用例集或集群其他配置所需的资源(插槽、内存等)。</p><p id="19ea" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated"><strong class="jy hv"> 4。一个案例可以支持批处理和流类型的处理</strong></p><p id="9c95" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated"><strong class="jy hv"> 5。客户端类型的灵活扩展</strong></p><p id="e19e" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">现有数据存储和服务的集成和扩展是可能的。现在支持多类型数据存储读写服务、yarn_session启动、Blink作业交互等等。</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="fe ff mh"><img src="../Images/260fe833c734507295693e281640e005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-vtz4CdctbyGMIn5rhjNxA.jpeg"/></div></div></figure><h1 id="190e" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">特性试验</h1><p id="5c8f" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">作为实时大数据处理引擎，Blink对单位时间的数据处理能力和数据处理的实时性提出了非常苛刻的要求。所以性能测试是整个Blink测试中非常重要的一部分，是衡量一个新版本的Blink能否发布的核心标准之一。</p><p id="0ccd" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">Blink的性能测试主要包括操作员性能测试、SQL性能测试、运行时性能测试:</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="fe ff mi"><img src="../Images/8eb6a3c3878b3a9cf77fe5cc927a2a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*92kh0ksuLDWPVmW_kYyZvA.jpeg"/></div></div></figure><h2 id="3c54" class="ls kv hu bd kw lt lu lv la lw lx ly le kf lz ma lg kj mb mc li kn md me lk mf dt translated">操作员绩效测试</h2><p id="febd" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">运算符指的是构成SQL语义的原子操作，如Sum、Aggregate等，不能再拆分。操作符性能测试主要用于监控单个操作符在整个开发过程中的性能变化，以确保局部处理的优化和改进。目前，操作员测试分为单个操作员的性能测试和操作员组合的性能测试。操作员测试以日常运行的方式反馈性能变化。</p><h2 id="6ea8" class="ls kv hu bd kw lt lu lv la lw lx ly le kf lz ma lg kj mb mc li kn md me lk mf dt translated">SQL性能测试</h2><p id="4790" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">这主要用于监控单个SQL在版本开发过程中的性能变化。TPCH和TPCDS是行业SQL标准性能测试集，分别有22个和103个测试用例。测试平台将其引入Blink性能测试，更全面地衡量Blink的性能变化。</p><h2 id="2dcd" class="ls kv hu bd kw lt lu lv la lw lx ly le kf lz ma lg kj mb mc li kn md me lk mf dt translated">运行时性能测试</h2><p id="8992" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">这主要是为了保证运营层面的业绩没有退步。主要包括端到端性能测试和模块性能测试。端到端性能测试首先要搞清楚测试场景，关注每个场景在指定数据量下的作业处理时间。模块性能测试主要包括网络层性能测试、调度层性能测试、故障转移性能测试等。它更关注特定场景下的作业处理时间。</p><p id="4769" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">性能测试的未来计划是集成E2E性能测试、模块级性能测试和参数调整，使它们能够更好地帮助开发性能问题的根本原因并查看参数调整效果(如下所示)。</p><h1 id="f508" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">稳定性试验</h1><p id="6993" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">对于支持高并发、多节点和复杂物理环境的分布式系统，很难避免物理节点异常，如磁盘满和网络延迟。作为一个高可用的分布式系统，Blink必须保证系统的稳定运行和异常情况下数据的正常输出。通过采用“避免失败的最佳方式是不断失败”的方法，该团队模拟了Blink任务运行期间所有可能的异常，从而验证了Blink的稳定性。</p><p id="c688" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">异常场景分为两类:</p><p id="6f1a" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">首先与运行环境有关，包括机器重启、网络异常、磁盘异常、CPU异常等等。这些异常主要由shell命令模拟。</p><p id="4495" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">第二个与Blink作业有关，包括RPC消息超时、任务异常、心跳消息超时等，主要通过byteman软件的集成来实现。在稳定性测试中，那些预先定义的异常场景将被随机选择并组合起来进行测试。</p><p id="0a7f" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">稳定性测试设置为迭代循环。每一轮迭代都包括发布异常场景、提交任务、等待作业恢复和验证。验证主要是检查检查点、容器和槽资源是否符合预期。如果检查失败，将发出警报。一旦验证成功，通过审批，则开始下一次迭代，验证任务在长期运行下的稳定性。</p><p id="69b8" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">稳定性测试架构分为四层(如下图所示):</p><p id="b138" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">组件层主要包括测试Blink作业、monkeys和dumper。</p><p id="c063" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">动作层包括作业启动、状态检查、输出检查等。</p><p id="e71e" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">执行层包括服务、异常场景操作等，异常场景基于SSH对特定机器进行操作。</p><p id="b1fc" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">顶层是用户界面。</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="fe ff mj"><img src="../Images/562a4c41f37a2cfa6d2cb977d08b21c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B9C2XRp-Zo8EzJahDB8tNw.png"/></div></div></figure><h1 id="257e" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">预测试</h1><p id="8c53" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">Blink预测试阶段主要通过在线克隆真实的任务和数据来测试复杂的业务逻辑和大数据量。因此，Blink预测试是对代码质量验证和集成测试的补充，是一个Blink版本发布前的最后一道防线。</p><p id="e072" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">Blink预测试分为模拟测试和兼容性测试。</p><h2 id="f3f1" class="ls kv hu bd kw lt lu lv la lw lx ly le kf lz ma lg kj mb mc li kn md me lk mf dt translated">模拟测试</h2><p id="ad6e" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">模拟测试进一步测量基本测试指标，如Blink的功能性、性能和稳定性，并将开发版本与当前在线版本进行比较。因此，模拟测试可以在早期识别与功能、性能下降和稳定性相关的各种问题，从而提高在线版本的质量。</p><p id="95f5" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">模拟测试分为三个阶段:环境克隆、环境适应和测试运行。</p><h2 id="ce82" class="ls kv hu bd kw lt lu lv la lw lx ly le kf lz ma lg kj mb mc li kn md me lk mf dt translated">环境克隆</h2><p id="4945" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">环境克隆是实现整个仿真测试的基础，包括在线任务的选择和克隆，以及测试数据的采样(如下图)。</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="fe ff mk"><img src="../Images/02fe4a49b7487dd9009be2c930570f2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NEPZjav2BJ_lP0luukuDbQ.png"/></div></div></figure><p id="5cf6" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">Blink的在线任务数量众多，分散在许多不同的项目中。尽管每个在线任务都有自己的内部业务逻辑，但不同的任务可以根据其主要处理逻辑进行分类，例如基于Agg运算的任务集或基于Sum运算的任务集等等。所以眨眼模拟测试需要区分线上任务，选择最有代表性的。</p><p id="e3ee" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">模拟测试的测试数据集是当前在线任务输入数据的样本，只是数据规模不同，可以根据测试需求动态调整，从而实现对测试目标的精确测量。</p><h1 id="54f7" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">环境适应</h1><p id="990e" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">环境适应是仿真测试过程中的初始化阶段，主要是修改测试用例，使其正常运行。该过程包括两个主要步骤:改变测试数据输入源和测试结果输出地址以及更新任务的资源配置。</p><h1 id="c6b3" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">试运转</h1><p id="179d" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">测试运行是模拟测试过程中的实际执行模块，包括测试用例运行和结果反馈。</p><p id="59d0" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">Blink模拟测试包括功能测试、性能测试和稳定性测试。不同的测试模块有不同的度量和反馈方法。这些测试模块的测试结果，以及代码质量检查和集成测试的结果，形成了Blink测试的结果集(如下所示)。</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="fe ff ml"><img src="../Images/946fdbe0cdb202a05a6afdffda244abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i9eFTiXlR62ZyaxypGqFEw.jpeg"/></div></div></figure><p id="060a" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">性能测试和功能测试使用模拟任务和样本数据作为输入，来比较和分析任务在不同执行引擎上的执行和输出。性能测试重点关注执行过程中不同执行引擎的资源利用率、吞吐量等性能指标；而功能测试比较执行的最终结果。需要注意的是，在功能测试中，假设网络版的运行结果为真；即，当在线版本的执行结果与开发版本的执行结果不同时，开发版本的执行被认为是错误的，需要修复开发版本中的错误。</p><p id="9c21" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">稳定性测试侧重于模拟任务在在线克隆环境、大数据量和长时间运行条件下的稳定性。它使用Blink开发版本作为唯一的执行引擎，并在执行期间测量稳定性指标，如资源利用率、吞吐量和故障转移。</p><h1 id="9a0b" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">兼容性测试</h1><p id="30f9" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">Blink兼容性测试主要用于发现新旧Blink版本之间的兼容性问题。目前兼容性测试主要分为静态检查和动态执行检查两个阶段。</p><h1 id="614a" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">静态检查</h1><p id="1a23" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">静态检查主要用于分析在线任务在不同执行引擎下生成的执行计划的差异，包括两个方面:</p><p id="2032" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">新执行引擎生成的执行计划的正确性和生成时间的长短。</p><p id="8042" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">新旧执行引擎分别生成的计划的兼容性。</p><figure class="jl jm jn jo fq jp fe ff paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="fe ff mm"><img src="../Images/273b2adc699d685b44c97dff6bd59b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qh4qBwN62sYsNQZvrxnY2A.jpeg"/></div></div></figure><p id="3273" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated">如果新的执行引擎不能正确地生成执行计划，或者如果生成执行计划花费的时间比预期的长，则静态检查可以被认为是失败的，这表明新版本的Blink中存在异常或缺陷。当新版本可以正确生成执行计划时，如果新版本执行引擎生成的执行计划与旧版本生成的执行计划不兼容，则需要将比较结果反馈给开发人员，以确定执行计划的改变是否是可预期的；如果执行计划是兼容的或者变化是可预期的，那么运行时测试可以直接为新版本运行。</p><h1 id="c70b" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">动态运行时测试</h1><p id="d7d3" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">Blink动态运行时测试使用模拟测试中的功能测试模块运行任务，是升级新版Blink前的最后一轮测试。如果任务能够正常启动且测试结果符合预期，则认为任务能够自动升级；否则，需要手动干预进行手动升级。</p><h1 id="014d" class="ku kv hu bd kw kx ky kz la lb lc ld le ja lf jb lg jd lh je li jg lj jh lk ll dt translated">观点</h1><p id="4b0b" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">经过短短一年多的努力，Blink的整体质量有了很大的提升，测试方法和工具也日趋成熟。随着Blink用户群的增长，Blink服务开发者对其服务任务质量保证的需求也在急剧增加。展望未来，Blink测试团队旨在提供更多的质量保证和开发工具，以进一步提高Blink开发人员的工程效率。</p><p id="712d" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt"><strong class="jy hv">( Original article by Zhao Li赵丽)</strong></p><p id="f342" class="pw-post-body-paragraph jw jx hu jy b jz ka iv kb kc kd iy ke kf kg kh ki kj kk kl km kn ko kp kq kr hn dt translated"><em class="ks">本文是</em> <a class="ae kt" rel="noopener" href="/@alitech_2017/a-flink-series-from-the-alibaba-tech-team-b8b5539fdc70"> <strong class="jy hv"> <em class="ks">阿里巴巴旗下Flink系列</em> </strong> </a> <em class="ks">的一部分。</em></p></div><div class="ab cl mn mo hc mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="hn ho hp hq hr"><h1 id="277a" class="ku kv hu bd kw kx mu kz la lb mv ld le ja mw jb lg jd mx je li jg my jh lk ll dt translated">阿里巴巴科技</h1><p id="01dc" class="pw-post-body-paragraph jw jx hu jy b jz lm iv kb kc ln iy ke kf lo kh ki kj lp kl km kn lq kp kq kr hn dt translated">关于阿里巴巴最新技术的第一手深度资料→脸书:<a class="ae kt" href="http://www.facebook.com/AlibabaTechnology" rel="noopener ugc nofollow" target="_blank"> <strong class="jy hv">《阿里巴巴技术》</strong> </a>。Twitter:<a class="ae kt" href="https://twitter.com/AliTech2017" rel="noopener ugc nofollow" target="_blank"><strong class="jy hv">【AlibabaTech】</strong></a>。</p></div></div>    
</body>
</html>