<html>
<head>
<title>Implementing backend for Unity3D games using PHP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PHP实现Unity3D游戏的后端</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/implementing-backend-for-unity3d-games-using-php-6f043b5b7db7?source=collection_archive---------3-----------------------#2018-12-26">https://medium.com/hackernoon/implementing-backend-for-unity3d-games-using-php-6f043b5b7db7?source=collection_archive---------3-----------------------#2018-12-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/1a4bcd1544878168af878a4c4cdd3d0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ayDg7FQvhFbW749F"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/@everywheresean?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sean Do</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="b32a" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">介绍</h1><p id="d9dd" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated"><strong class="kh hv"> Unity3D </strong>已经成为当今流行的游戏引擎之一。只需对代码做一些修改，就可以开发跨平台的游戏。如果你非常习惯使用<em class="ld"> JavaScript </em>或<em class="ld"> C#，</em>那么Unity3D应该是你的选择。</p><h1 id="9a5b" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">游戏化</h1><p id="1c64" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">业内许多游戏背后的成功肯定是游戏化的最佳实践。游戏化包含了让游戏更具竞争性的一切，并促使更多的肾上腺素冲击排行榜的榜首位置。为一个游戏制作一个排行榜并不容易，因为有很多组件，比如数据库安全，用户认证等等…</p><h1 id="aef3" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">履行</h1><p id="934a" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">这里我们将使用<em class="ld"> PHP </em>和<em class="ld"> MySQL </em>为unity3D上的一个简单游戏实现一个排行榜。计划是这样的:</p><ul class=""><li id="f7b5" class="le lf hu kh b ki lg km lh kq li ku lj ky lk lc ll lm ln lo dt translated">编写PHP脚本对我们的数据库进行SQL查询</li><li id="1553" class="le lf hu kh b ki lp km lq kq lr ku ls ky lt lc ll lm ln lo dt translated">编写<em class="ld"> C# </em>脚本，在我们的应用程序和后端服务器之间发送和访问数据。这里我们的应用程序将是Unity3D游戏，所以我们将使用他们自己的文档来实现它。</li><li id="d2a9" class="le lf hu kh b ki lp km lq kq lr ku ls ky lt lc ll lm ln lo dt translated">最终将我们的数据库转储到云上，尽管我们在开发期间在本地主机上测试它😃。</li></ul><h1 id="d930" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">我们将实施什么</h1><p id="7334" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">我们将尽可能简化这一过程，以便我们能够获得更好的学习体验。我们有一个游戏，我们必须在<strong class="kh hv"/><strong class="kh hv"/>数据库中存储<strong class="kh hv">用户名</strong>和<strong class="kh hv">分数</strong>。因此，每当游戏结束时，我们会将这些数据存储在数据库中，然后检索整个数据，这些数据将被排序并显示在排行榜上。没那么简单。让我们现在就实施吧😃。</p><h2 id="0833" class="lu ji hu bd jj lv lw lx jn ly lz ma jr kq mb mc jv ku md me jz ky mf mg kd mh dt translated"><strong class="ak">编写PHP脚本</strong></h2><p id="070e" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">您需要有一些后端脚本的想法😉。</p><p id="60aa" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">我们将编写两个PHP文件。</p><ul class=""><li id="37c8" class="le lf hu kh b ki lg km lh kq li ku lj ky lk lc ll lm ln lo dt translated"><code class="eh ml mm mn mo b"><em class="ld">data.php</em></code> <em class="ld"> </em>用于<strong class="kh hv">发送</strong>和<strong class="kh hv">检索</strong>数据</li><li id="2e3e" class="le lf hu kh b ki lp km lq kq lr ku ls ky lt lc ll lm ln lo dt translated"><code class="eh ml mm mn mo b">update.php</code>用于<strong class="kh hv">更新</strong>每当玩家取得局部高分时的分数。</li></ul></div><div class="ab cl mp mq hc mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hn ho hp hq hr"><p id="9980" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated"><code class="eh ml mm mn mo b">data.php</code>:</p><p id="879d" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">我们将声明一些在代码中使用的基本变量。</p><pre class="mw mx my mz fq na mo nb nc aw nd dt"><span id="1fa0" class="lu ji hu mo b fv ne nf l ng nh">$servername = "host_name";<br/>$dbname = "dabase_name";<br/>$username = "username";<br/>$password = "database_password";<br/>$playername = $_POST["playernamePost"];<br/>$score = $_POST["scorePost"];</span></pre><p id="0176" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated"><code class="eh ml mm mn mo b">$playername</code>该变量用于存储游戏应用程序发送的用户名。<code class="eh ml mm mn mo b">$_POST["playernamePost"]</code>这是一个特定的动作，它表示将获取存储在变量<code class="eh ml mm mn mo b">playernamePost</code>中的数据，该变量是由某个未知来源发送的。虽然这并不安全，但我们将只研究基本的实现。这同样适用于<code class="eh ml mm mn mo b">$score</code>变量。</p><p id="bc7e" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">接下来，连接数据库</p><pre class="mw mx my mz fq na mo nb nc aw nd dt"><span id="a73c" class="lu ji hu mo b fv ne nf l ng nh">$db = mysqli_connect($servername, $username,$password, $dbname);</span></pre><p id="ea13" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">一旦连接成功，我们可以进一步使用<em class="ld"> SQL </em>查询我们的数据。</p><pre class="mw mx my mz fq na mo nb nc aw nd dt"><span id="9aff" class="lu ji hu mo b fv ne nf l ng nh">$sql = " SELECT * FROM data ORDER BY score";<br/>$push = "INSERT INTO data ( name, score) VALUES ('".$playername."','".$score."')";</span></pre><p id="d3aa" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated"><code class="eh ml mm mn mo b">$sql</code>该变量以字符串的形式存储<em class="ld"> SQL </em>查询(数据检索)。<code class="eh ml mm mn mo b">$push</code>该变量再次以字符串的形式存储<em class="ld"> SQL </em>查询<em class="ld"> ( </em>数据推送到数据库)。您需要对SQL查询语句有所了解，比如<code class="eh ml mm mn mo b">SELECT</code>、<code class="eh ml mm mn mo b">INSERT</code>等等……对数据做了什么。尽管它们很容易理解😜。<code class="eh ml mm mn mo b">name</code>和<code class="eh ml mm mn mo b">score</code>是我们数据库表的列。<code class="eh ml mm mn mo b">data</code>是表名。<code class="eh ml mm mn mo b">ORDER BY</code>这是用来对我们的数据进行排序的，不需要为我们的数据编写单独的排序算法。我建议你避免使用它，因为它效率不高。</p><p id="bac2" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">让这些查询起作用</p><pre class="mw mx my mz fq na mo nb nc aw nd dt"><span id="d908" class="lu ji hu mo b fv ne nf l ng nh">$retrieval = mysqli_query($db, $sql);<br/>$pushdata = mysqli_query($db,$push);</span></pre><p id="555b" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">将变量作为参数发送给<code class="eh ml mm mn mo b">mysqli_query</code>函数将完成我们的工作。</p><p id="1505" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">您可能会想我们的游戏应用程序将如何获取数据。这很简单，我们将所有数据作为一个字符串打印到我们的PHP文件中。稍后，我们将检索数据作为一个单一的字符串，并做一些字符串处理的东西，把它放在我们的排行榜。</p><pre class="mw mx my mz fq na mo nb nc aw nd dt"><span id="1a71" class="lu ji hu mo b fv ne nf l ng nh">while ($row = mysqli_fetch_assoc($retrieval))<br/>{<br/>echo";".$row['name'].":".$row['score']."";<br/>}</span></pre><p id="43e3" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">我们将使用<code class="eh ml mm mn mo b">mysqli_fetch_assoc($retrieval)</code>将数据提取到单个变量<code class="eh ml mm mn mo b">$row</code>中，然后使用while循环打印完整的数据。我们完成了<code class="eh ml mm mn mo b">data.php</code></p></div><div class="ab cl mp mq hc mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="hn ho hp hq hr"><p id="2da0" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">现在我们可以使用<code class="eh ml mm mn mo b">data.php</code>文件检索和推送数据。现在当你要在玩家打出高分的时候更新他的分数，那么你就要用这个<code class="eh ml mm mn mo b">update.php</code>脚本了。这与您简单地使用更新查询非常相似。</p><p id="e6dc" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated"><code class="eh ml mm mn mo b">update.php</code></p><pre class="mw mx my mz fq na mo nb nc aw nd dt"><span id="c6ec" class="lu ji hu mo b fv ne nf l ng nh">$servername = "host_name";<br/>$dbname = "database_name";<br/>$username = "username";<br/>$password = "password";</span><span id="fa5d" class="lu ji hu mo b fv ni nf l ng nh">$playername = $_POST["playernamePos"];<br/>$score =$_POST["scorePos"];<br/>$db = mysqli_connect($servername, $username,$password, $dbname);<br/>$update = "UPDATE data SET score='$score' WHERE name='$playername'";<br/>$result = mysqli_query($db,$update);</span></pre><p id="c7bf" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">您可以在用户名的帮助下找到特定的列，然后更新相应的高分。</p><p id="604e" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">我们已经完成了PHP文件的编写。现在让我们编写<em class="ld"> C# </em>脚本来连接应用程序和后端。</p><h2 id="5bcb" class="lu ji hu bd jj lv lw lx jn ly lz ma jr kq mb mc jv ku md me jz ky mf mg kd mh dt translated">在Unity3D中编写C#脚本</h2><p id="5832" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">您需要熟悉<em class="ld"> unity3D </em>文档😜。</p><p id="5111" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated"><code class="eh ml mm mn mo b">retrieval.cs</code></p><pre class="mw mx my mz fq na mo nb nc aw nd dt"><span id="5735" class="lu ji hu mo b fv ne nf l ng nh">public string url = "www.somecloudstorage.com/data.php";<br/>IEnumerator Start () <br/>{       <br/>WWW retrieve = new WWW(url); <br/>yield return retrieve;  <br/>string fulldata = retrieve.text;  <br/>users = fulldata.Split(';');  <br/>int n =0;  <br/>list.text = "";  <br/>for (int i = users.Length-1; i&gt;=0; i--)<br/>{ <br/>n++;<br/>if (users[i] != "-&gt;0" &amp;&amp; !(users[i].StartsWith("&lt;")))<br/>{   <br/>items = users[i].Split(':');<br/>list.text = list.text+ "\n"+n+".  "+ items[0];   <br/>list2.text = list2.text + "\n" + items[1];  <br/>}}}</span></pre><p id="2b9d" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated"><code class="eh ml mm mn mo b">IEnumarator</code>在这里非常有用，因为我们希望程序暂停执行，直到我们的全部数据从<em class="ld"> PHP </em>文件中加载完毕。我们对那个特定的<em class="ld"> PHP文件发出一个<em class="ld"> HTTP </em>请求。我们通过创建一个<code class="eh ml mm mn mo b">WWW</code>对象并发送所需的<em class="ld"> URL来做到这一点。</em>然后我们会一直等到数据加载完毕。我们可以使用<code class="eh ml mm mn mo b">retrieve.text</code> <em class="ld">将数据作为单个字符串访问(需要时查看Unity3D文档)。</em> Rest很简单，<em class="ld"> </em>我们做一些字符串处理工作，以期望的形式检索它。</em></p><p id="0c6b" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">我们能够检索数据，这是小菜一碟，没错！！现在，让我们看看如何将数据从游戏应用程序推送到数据库。</p><p id="e03f" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated"><code class="eh ml mm mn mo b">push_highscore.cs</code></p><pre class="mw mx my mz fq na mo nb nc aw nd dt"><span id="0217" class="lu ji hu mo b fv ne nf l ng nh">public string url = "www.somecloudstorage.com/data.php";<br/>public void pushData(string username, int highscore) <br/>{<br/>WWWForm form = new WWWForm ();<br/>form.AddField("playernamePos",username);  form.AddField("scorePos",highscore);<br/>WWW push_Data = new WWW(url,form);<br/>}</span></pre><p id="e654" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">这几行<em class="ld"> PHP </em>代码将完成我们的工作。⭐️，记住我们使用Unit3D官方文档来实现这个，所以你必须导入必要的包。</p><p id="6229" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">几乎什么都做好了！！但我不会谈论你将如何更新分数。享受自己实现它的乐趣，我相信你也能做到😜。</p><p id="238f" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">将您的数据转储到云空间显然是必要的。你可能会在市场上找到很多云空间提供商，转储你的后端代码(<em class="ld"> PHP </em>文件)，数据库文件(。sql文件)并正确配置您的PHPMyAdmin。就这样，你完了！！🎉</p><h1 id="81a8" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">结论</h1><p id="1685" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">就是这样，这是实现一个<em class="ld">排行榜</em>和使用<em class="ld"> PHP </em>和<em class="ld"> MySQL </em>为你的游戏应用编写你自己的后端的基本方法👋。</p><p id="4814" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">🌟请记住，这根本不是一种为游戏应用程序(产品)实现排行榜的安全方式。这只是为了让你站起来开始。🌟</p><p id="b641" class="pw-post-body-paragraph kf kg hu kh b ki lg kk kl km lh ko kp kq mi ks kt ku mj kw kx ky mk la lb lc hn dt translated">你可以在<a class="ae jg" href="https://github.com/kmehant" rel="noopener ugc nofollow" target="_blank"> GitHub </a>、<a class="ae jg" href="https://twitter.com/mehant1" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae jg" href="https://www.linkedin.com/in/mehant-kammakomati-1a0b41170/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> ✨✨找到Mehant Kammakomati</p></div></div>    
</body>
</html>