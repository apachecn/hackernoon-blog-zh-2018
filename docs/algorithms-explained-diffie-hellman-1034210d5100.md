# 算法解释:迪菲-赫尔曼

> 原文：<https://medium.com/hackernoon/algorithms-explained-diffie-hellman-1034210d5100>

通过到达这里，你已经参加了一个 Diffie-Hellman 密钥交换！(或者至少是一个变体)。Diffie-Hellman 是在两个端点(各方)之间建立共享秘密的一种方式。

这种算法背后的数学其实很简单。我将首先解释我们正在努力做什么，然后我将解释我们如何实现它。

假设爱丽丝和鲍勃想在约翰不知道他们在说什么或发送什么的情况下互相交流。爱丽丝发给鲍勃的任何东西，约翰都会收到，同样，鲍勃发给爱丽丝的任何东西，约翰也会收到。那么，爱丽丝和鲍勃如何在约翰不理解的情况下互相发送任何东西呢？这就是迪菲-赫尔曼的用武之地。

我将直接研究它的数学，但这可以用视觉来解释，你可以在家里用一些颜料自己测试一下。

首先，爱丽丝和鲍勃公开决定(约翰也会得到一份副本)两个素数， ***g*** 和 ***n*** 。一般来说 ***g*** 是一个小质数，而 ***n*** 则相当大，通常为 2000 位或更长，一般为 4000 位。所以现在爱丽丝、鲍勃和约翰都知道这些数字。

现在爱丽丝秘密决定另一个数字， ***一个*** 。于是鲍勃偷偷决定选一个数字， ***b*** 。爱丽丝和鲍勃都没有发送这些号码，它们是保密的。爱丽丝执行了一个计算， ***g^a mod n*** ，我们就把这个 ***叫做一个*** ，既然它来源于 ***一个*** 。鲍勃然后执行 ***g^b 模式 n*** ，我们称之为 ***B*** 。

爱丽丝送鲍勃， ***A*** ，鲍勃送爱丽丝， ***B*** 。注意约翰现在有 4 个数字， ***A，B，g*** 和 ***n*** 但没有 ***a*** 或 ***b*** 。最后，对于魔术的核心。爱丽丝拿着鲍勃的 ***B*** 表演 ***B^a mod n*** 。同样，鲍勃拿着爱丽丝的 ***A*** 表演 ***A^b mod n*** 。这导致相同的数字，即***b^a mod n = a^b mod n***。他们现在有一个共享号码。注意约翰怎么不能从他得到的数字中算出这些数字是什么。

实际上他可以给它起一个名字叫做解决离散对数问题。如果我们让 ***n*** 非常大，这将成为一个计算量非常大的问题，根本不值得花时间去解决。约翰不得不从 ***A*** 或 ***B*** 中找出 ***a*** 或 ***b*** ，这简直太费时间了。

那么 Alice 和 Bob 可以用他们刚刚一起创建的这个密钥做什么呢？他们可以用它来开始加密他们互相发送的信息。一个不应该在任何地方使用的非常简单的例子是用移位密码(凯撒密码)加密他们的消息，移位值是由新生成的密钥决定的，因为它非常不安全。Alice 和 Bob 都可以加密和解密消息，因为他们知道移位值，但是 John 不能，因为他没有密钥。

哦，如果你想用颜料来做这个，用一种颜色来代替两种颜色来代表 g 和 n，只要混合颜料就可以了。

如果你对此感兴趣，请登录 [www.pyler.io](https://www.pyler.io) 网站，我们在那里提供很棒的在线 Python 课程，让你从初学者一步到位！

![](img/65d0581c2635e776dcbcc8d43ad3ce72.png)

‘Slither into Python’ — Coming next month on Pyler.io