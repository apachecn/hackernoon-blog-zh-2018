# åœ¨ Flutter ä¸­åˆ¶ä½œéƒ¨ä»¶åŠ¨ç”»

> åŸæ–‡ï¼š<https://medium.com/hackernoon/animating-widgets-in-flutter-413882881e98>

Flutter æ˜¯è°·æ­Œçš„ç§»åŠ¨åº”ç”¨ SDKï¼Œç”¨äºåœ¨åˆ›çºªå½•çš„æ—¶é—´å†…åœ¨ iOS å’Œ Android ä¸Šåˆ¶ä½œé«˜è´¨é‡çš„åŸç”Ÿç•Œé¢ã€‚Flutter çš„åŠ¨ç”»æ”¯æŒå¯ä»¥è½»æ¾å®ç°å¤šç§åŠ¨ç”»ç±»å‹ã€‚è¿™ç¯‡æ–‡ç« æè¿°äº†å¦‚ä½•åœ¨ Flutter ä¸­åˆ¶ä½œçª—å£å°éƒ¨ä»¶çš„åŠ¨ç”»ã€‚

## åŠ¨ç”»ç±»å‹

*   **è¡¥é—´åŠ¨ç”»**

åœ¨è¡¥é—´åŠ¨ç”»ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»å®šä¹‰åŠ¨ç”»çš„å¼€å§‹ç‚¹å’Œç»“æŸç‚¹ã€æ—¶é—´è½´ä»¥åŠå®šä¹‰è¿‡æ¸¡æ—¶é—´å’Œé€Ÿåº¦çš„æ›²çº¿ã€‚æ¡†æ¶è®¡ç®—ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„ä¸­é—´å€¼ã€‚

*   **åŸºäºç‰©ç†çš„åŠ¨ç”»**

åœ¨åŸºäºç‰©ç†çš„åŠ¨ç”»ä¸­ï¼Œè¿åŠ¨ç±»ä¼¼äºçœŸå®ä¸–ç•Œçš„è¡Œä¸ºã€‚å½“æˆ‘ä»¬ä»åœ°é¢ä»¥ä¸€ä¸ªè§’åº¦æŠ•æ·ä¸€ä¸ªçƒæ—¶ï¼Œå®ƒå°†è·ŸéšæŠ›å°„ä½“è¿åŠ¨ã€‚æ‰€æœ‰çš„è®¡ç®—ï¼Œå¦‚é£è¡Œæ—¶é—´å’Œæ—…è¡Œè·ç¦»ï¼Œéƒ½å°†æ ¹æ®ç‰©ç†å®šå¾‹æ¥è®¡ç®—ã€‚

## ä¸ºåŠ¨ç”»å‡†å¤‡è¯¾ç¨‹

æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå°éƒ¨ä»¶ï¼Œå¹¶ä»¥ä¸€å®šçš„æ—¶é—´é—´éš”é‡å¤æ›´æ–°å…¶çŠ¶æ€ï¼Œä»¥ä½¿å…¶å…·æœ‰åŠ¨ç”»æ•ˆæœã€‚

ä¸ºäº†åˆ›å»ºä¸€ä¸ªå°éƒ¨ä»¶ï¼Œæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç±»æ¥æ‰©å±•`StatefulWidget`ç±»å¹¶è¦†ç›–å®ƒçš„`createState()`æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª`State`å®ä¾‹ã€‚

![](img/ea987978653d691e770c6d687abc69f8.png)

ä¸æˆ‘ä»¬çš„æœ‰çŠ¶æ€å°éƒ¨ä»¶ç›¸å…³è”çš„çŠ¶æ€å¯¹è±¡å¿…é¡»æ‰©å±•`State`ç±»ï¼Œå¹¶ä¸”è¿˜ä½¿ç”¨ä¸€ä¸ªåä¸º`SingleTickerProviderStateMixin`çš„ mixinã€‚æˆ‘ä»¬è¦†ç›–äº† build æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­æˆ‘ä»¬åˆ›å»ºäº†å°†è¦åˆ¶ä½œåŠ¨ç”»çš„å°éƒ¨ä»¶å¯¹è±¡ã€‚

![](img/d4625de2966af99278a3d7d7e8fb27ec.png)

## åˆ›å»ºè¡¥é—´åŠ¨ç”»

åœ¨è¡¥é—´åŠ¨ç”»ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸¤ä¸ªä¸åŒçš„å€¼:å¼€å§‹å€¼å’Œç»“æŸå€¼ã€‚ç„¶åï¼ŒFlutter å°†è‡ªåŠ¨ç”Ÿæˆä¸€ç»„ä¸­é—´å€¼ã€‚æˆ‘ä»¬å°†è¿™äº›ä¸­é—´å€¼åº”ç”¨äºå°éƒ¨ä»¶çš„ä»»ä½•å±æ€§ï¼Œä»¥ä½¿å…¶å…·æœ‰åŠ¨ç”»æ•ˆæœã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„è¡¥é—´åŠ¨ç”»ï¼Œå°†ä¸€ä¸ªå°éƒ¨ä»¶ä»å±å¹•çš„å·¦è¾¹ç¼˜ç§»åŠ¨åˆ°å±å¹•çš„å³è¾¹ç¼˜ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æ¿€æ´»å°éƒ¨ä»¶çš„`left`å±æ€§ã€‚æ‰€æœ‰ä¸­é—´å€¼éƒ½åˆ†é…ç»™å°éƒ¨ä»¶çš„`left`å±æ€§ã€‚

ä¸ºäº†åˆ›å»ºå’Œæ§åˆ¶åŠ¨ç”»ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª*åŠ¨ç”»*å¯¹è±¡å’Œä¸€ä¸ª*åŠ¨ç”»æ§åˆ¶å™¨*å¯¹è±¡ã€‚

```
Animation<double> **animation**;
AnimationController **controller**;
```

åœ¨æˆ‘ä»¬ç±»çš„ *initState* æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†*åŠ¨ç”»æ§åˆ¶å™¨*ã€‚å®ƒæœŸæœ›ä¸€ä¸ª`TickerProvider`å¯¹è±¡ä½œä¸ºå®ƒçš„è¾“å…¥ä¹‹ä¸€ã€‚ç”±äºæˆ‘ä»¬çš„ç±»æ­£åœ¨ä½¿ç”¨`SingleTickerProviderStateMixi` mixinï¼Œæˆ‘ä»¬å¯ä»¥å°†*è¿™ä¸ª*ä¼ é€’ç»™å®ƒã€‚å¦ä¸€ä¸ªå‚æ•°æ˜¯*æŒç»­æ—¶é—´*å±æ€§æ¥æŒ‡å®šåŠ¨ç”»çš„æŒç»­æ—¶é—´ã€‚

```
**controller** = **new** AnimationController(vsync: **this**,
    duration: **new** Duration(seconds: 5));
```

åˆ›å»ºä¸€ä¸ª`Tween`å¯¹è±¡ï¼ŒæŒ‡å®šåŠ¨ç”»çš„å¼€å§‹å’Œç»“æŸå€¼ã€‚

```
Tween tween = **new** Tween<double>(begin: 0.0, end: 400.0);
```

ä½¿ç”¨è¡¥é—´å¯¹è±¡åˆ›å»ºåŠ¨ç”»å¯¹è±¡ã€‚

```
**animation** = tween.animate(**controller**);
```

animation å¯¹è±¡ä¸ºè·‘é©¬ç¯çš„æ¯ä¸€æ¬¡è·³åŠ¨ç”Ÿæˆä¸€ä¸ªåŠ¨ç”»äº‹ä»¶ã€‚ä¸ºäº†å¤„ç†äº‹ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ addListener()æ–¹æ³•ã€‚åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­è°ƒç”¨ setState()æ–¹æ³•æ¥æ›´æ–°å°éƒ¨ä»¶çš„çŠ¶æ€å¹¶é‡æ–°ç»˜åˆ¶å®ƒã€‚

```
**animation**.addListener(() {
  setState(() {
  });
});
```

ä¸ºäº†å¯åŠ¨åŠ¨ç”»ï¼Œæˆ‘ä»¬è°ƒç”¨åŠ¨ç”»æ§åˆ¶å™¨çš„ forward()æ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬æƒ³è®©åŠ¨ç”»é‡å¤æ’­æ”¾ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ repeat()æ–¹æ³•ã€‚

```
controller.repeat();
```

åŠ¨ç”»ç°åœ¨å‡†å¤‡å¥½äº†ã€‚æˆ‘ä»¬å¯ä»¥å°†å®ƒåº”ç”¨äºä»»ä½•å°éƒ¨ä»¶ã€‚

![](img/805bc1972e621b9b41837e8ebc04d596.png)

## å°†åŠ¨ç”»åº”ç”¨åˆ°å°éƒ¨ä»¶

ç°åœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå°éƒ¨ä»¶ï¼Œå¹¶å°†åŠ¨ç”»å€¼åº”ç”¨äºå®ƒä¸€ä¸ªå±æ€§ã€‚

```
child: **new** Stack(
    children: <Widget>[
      **new** Positioned(
          child: FlutterLogo(),
          height: 100.0,
          width: 100.0,
          left: **animation**.**value**,
          top: 100.0  
      )
    ])
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å°†åŠ¨ç”»å€¼åˆ†é…ç»™å°éƒ¨ä»¶çš„å·¦ä¾§å±æ€§ã€‚

## åŠ¨ç”»æ•ˆæœ

å°†æ­¤ widget æ·»åŠ åˆ°åº”ç”¨ç¨‹åºçš„ä»»ä½•å±å¹•ä¸­ã€‚è¿™æ˜¯å®ƒçš„æ ·å­:

![](img/0a3632def2be41acf8c6c25c4cf9c392.png)

Flutter Animation

## å®Œå…¨ç 

```
**import 'package:flutter/animation.dart'**;
**import 'package:flutter/material.dart'**;**class** AnimationApp **extends** StatefulWidget {
  @override
  State<StatefulWidget> createState() {
    **return new** AnimationState();
  }
}**class** AnimationState **extends** State<AnimationApp> **with** SingleTickerProviderStateMixin {Animation<double> **animation**;
  AnimationController **controller**;@override
  Widget build(BuildContext context) {
    **return new** Container(
        color: Colors.*white*,
        child: **new** Stack(
            children: <Widget>[
              **new** Positioned(
                  child: FlutterLogo(),
                  height: 100.0,
                  width: 100.0,
                  left: **animation**.**value**,
                  top: 100.0
              )
            ])
    );
  }@override
  **void** initState() {
    **super**.initState();
    **controller** = **new** AnimationController(vsync: **this**,
        duration: **new** Duration(seconds: 4));Tween tween = **new** Tween<double>(begin: 0.0, end: 400.0);
    **animation** = tween.animate(**controller**);**animation**.addListener(() {
      setState(() {
      });
    });**controller**.repeat();}
}
```

*æ„Ÿè°¢é˜…è¯»ã€‚å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·éšæ„ç‚¹å‡»é‚£ä¸ªæŒ‰é’®ğŸ‘å¸®åŠ©å…¶ä»–äººæ‰¾åˆ°å®ƒã€‚*

*æœ¬æ–‡æ˜¯ç§»åŠ¨æŠ€æœ¯ç›¸å…³ç³»åˆ—æ–‡ç« çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªç§»åŠ¨åº”ç”¨ç¨‹åºå¼€å‘å›¢é˜Ÿï¼Œè¯·è”ç³»æˆ‘ä»¬:*[*ã€info@47billion.com*](mailto:info@47billion.com)*ã€‚*