# 在 React 和 Vue 中编写高度可重用组件的清单

> 原文：<https://medium.com/hackernoon/checklist-for-writing-highly-reusable-components-in-react-and-vue-531f963864bd>

![](img/ae44056d874eebbf3e5ea7dd57298bf4.png)

Photo by [Kris Guico](https://unsplash.com/@krisguico?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

有如此多的最佳实践和先进的模式——问题是在开发新的组件时要跟踪它们并牢记在心。

我写这个清单是为了帮助自己记住在构建高度可重用组件的过程中需要考虑的所有事情。

这份清单同样适用于**Vue 和 React。**

真的，你用哪个框架都没关系，因为**T5【组件组合】T6 的原理完全一样**。设计组件的一般过程也没有改变。

**帖子最后的浓缩清单。**

# 避免猜测性的笼统

这听起来很明显，但我发现自己总是忘记这一点。

你需要完全理解*你的*用例，并且只实现它。如果你不先思考就一头扎进代码，你最终会写出一堆永远不会用到的特性。那是对你宝贵时间的巨大浪费。

当编写一个应该在许多不同用例中重用的组件时，提供越来越多抽象的诱惑更容易被证明是正当的。

然而，如果你把组件写得很好，以后回来添加你不能预料的新用例应该是相当容易的。

这就是 **80/20 思维**派上用场的地方。您实现的一些特性将负责处理大多数用例。关注那些。

我将留给你最后一条关于 API 设计的推文:

# 简化 API

现在我们已经停下来思考了，让我们尽可能地简化我们的 API。

您还试图在简单性和灵活性之间找到最佳平衡点。正如[肯·惠勒](https://twitter.com/ken_wheeler)在[开源的苦涩指南](/codezillas/a-bitter-guide-to-open-source-a8e3b6a3c1c4)中所说:

> 您希望在开箱即用和按需配置之间找到完美的平衡。最重要的是，你要保持事情清晰，明确和平易近人。不要太聪明，否则你会惹恼所有人。

太简单了，而且没有涵盖足够多有用的用例。太灵活了，理解如何做任何事情都变得太难了。

看看这个 [jQuery Datepicker](http://api.jqueryui.com/datepicker/) 有多少选项。太恐怖了！

这是更高级的合成模式真正派上用场的地方。

通常，您会在简单性和灵活性之间进行权衡。但是像**渲染道具**和**复合组件**这样的技术可以让你在降低复杂度的同时获得**更多的灵活性。**

# 研究现有技术

我们对我们现在正在建造的东西有一个很好的想法，但是首先我们需要看看外面还有什么。

这有几个原因:

首先，我们可以**为我们的实现获得伟大的想法**。

如果我们看看成熟的开源项目，它们或多或少会有一些完整的特性。这让我们再次检查我们可能需要构建的假设。

我们还可以看到 API 是如何构建的，使用了哪些抽象，甚至可能看到一些我们没有考虑到的实现细节。

第二，我们有可能为自己节省一些工作。

我们很有可能会找到一些可以用来加速开发的东西。我们甚至可能找到符合我们所有需求的东西，并最终缩短整个过程。

在他的[高级 React.js 课程](https://courses.totalreact.com/p/advanced-react-free)中， [Ryan Florence](https://twitter.com/ryanflorence) 提到他喜欢检查 jQuery 插件。它们经受住了时间的考验，并且很可能拥有你曾经考虑放入 UI 元素的所有特性。

一个很好的起点是在令人敬畏的 repos:

*   [牛逼-反应](https://github.com/enaqx/awesome-react)
*   [Awesome-Vue](https://github.com/vuejs/awesome-vue)

# 将组件分成小块

组合框架使用组件作为其主要的抽象技术(相对于面向对象中的对象或函数式编程中的函数)。

如果你把所有东西都塞进一个或两个巨大的组件中，你根本没有利用这一点！

组件越小越好:

*   更好的抽象使你的代码更干净，更容易理解，更容易维护
*   鼓励代码的可重用性
*   必要为了使用更多的**先进的**花裤构图技术

考虑拆分组件有两种主要方法:

## **从展示中分离行为**

在一个组件中有状态和逻辑，有一个独立的组件负责呈现。我们通常通过渲染道具和无状态功能组件来实现。

## 抽象层次

在一个组件中保持抽象层次的一致性通常是一个好主意。组件要么处理原生 DOM 元素，如`div`、`p`、`span`，要么处理框架组件。

只是要小心，因为你不想走极端，创建太多组件**！肯特·c·多兹(Kent c . Dodds)有一篇关于[如何知道什么时候事情应该被分开](https://blog.kentcdodds.com/when-to-break-up-a-component-into-multiple-components-4ee75ab53bbc)的很棒的文章。**

# **只在需要的地方使用强大的合成模式**

**渲染道具，提供者模式，高阶组件。这些模式很诱人，用起来也很有趣。**

**但是它们并不总是这项工作的合适工具。知道何时最大限度地利用每一种方法是很重要的。否则**您可能会使用错误的工具**来完成工作，并把自己挖成一个洞。**

**如果你想了解更多，我强烈建议看看 Kent C. Dodd 关于 React 中的高级模式的文章:**

## **复合组件**

**将组件的各个部分分解成更小的部分，可以用不同的方式重新组合。**

**例如，把你的`Table`组件分解成`TableHeader`、`TableBody`和`TableFooter`组件。大多数人使用常规的`Table`都没问题，但是现在有人可以构建自己的表格，并为其构建自定义标题，而不会太麻烦。**

## **高阶组件**

**将一个组件包装在另一个组件中，为其添加功能。这个概念是从 mixin 的面向对象思想发展而来的，但已经在很大程度上取代了它(尽管 Vue 仍然支持 mixin)。**

**当 React 第一次出现时，mixins 给了开发人员一个出口，允许他们回到面向对象世界中熟悉的地方。**

**过了一段时间，我们发现[合成比](/@dan_abramov/mixins-are-dead-long-live-higher-order-components-94a0d2f9e750)遗传好得多，所以更高阶的成分成为了标准。**

## **渲染道具和无渲染组件**

**现在我们看到了另一个转变。这一次远离更高级的组件，并朝向所谓的*渲染道具*(或*作为子功能)。***

**渲染道具让我们**将渲染**委托给父组件，让我们在行为和表现之间有更清晰的分离。如果将这种模式与 prop getters 和 setters 模式结合起来，就可以用很少几行代码构建出极其灵活和富有表现力的组件。**

## **受控和非受控道具**

**是组件控制状态，还是它的父组件控制状态？这就是不受控制的和受控制的道具之间的区别。**

**通常，使用不受控制的道具，因为它们允许我们将复杂性和状态封装在组件中。然而，如果你想要更多的灵活性——这是我们在编写一个高度可重用的组件时所需要的——你可以允许一个道具由父级来控制。**

## **状态缩减器**

**这是我从肯特·c·多兹的项目[降档](https://github.com/paypal/downshift) ( [这里有更多解释](https://blog.kentcdodds.com/when-to-use-control-props-or-state-reducers-6cd83e42c5b))中学到的模式。**

**如果你要暴露一个要控制的道具，为什么不暴露整个状态缩减器呢？然后**你可以对组件的行为进行非常细粒度的控制**——但是你不需要重写任何逻辑。**

**太棒了。**

## **提供商模式**

**如果你用过 Redux 或者 VueX 或者类似的东西，你大概知道这个模式。**

**你只需简单地将它们“注入”到需要它们的地方，而不是整天把道具传来传去，并通过许多许多层次的组件传递下去。**

**在 React 中，这可以通过使用上下文或[在 Vue 中提供和注入](https://vuejs.org/v2/api/#provide-inject)来完成[。](https://reactjs.org/docs/context.html)**

# **可访问性不是事后才想到的**

**我还不太擅长无障碍。**

**不过，这是我最近越来越擅长的事情，因为我相信**让网络变得更好**非常重要。**

**因为我不是这方面的专家，所以我会让你读一读 Addy Osmani 写的这篇文章。您还可以查看 A11Y 项目的大量资源。**

**[](/@addyosmani/accessible-ui-components-for-the-web-39e727101a67) [## Web 的可访问用户界面组件

### 为了便于访问，UI 组件需要在不同屏幕尺寸和不同种类的设备上工作

medium.com](/@addyosmani/accessible-ui-components-for-the-web-39e727101a67) 

# 让造型变得简单

对于消费者来说，按照他们需要的方式来设计你的组件有多容易？

其目的是您的组件将被广泛使用。在各种各样的环境中。它将会被用在你做梦都想不到的地方。

您需要确保其他开发人员可以轻松地设计和更改组件的布局，而无需求助于难看的 CSS 覆盖。

无渲染组件使这变得非常简单。你可以**将所有渲染**委托给任何使用你组件的人。

然而，在许多情况下，默认渲染是有用的。这里一个好的方法是[在你的组件中使用 BEM](/@GarrettLevine/react-components-b-e-m-168f199f35b)并提供容易被覆盖的 CSS 类。

## 但是 CSS 不是图灵完整的！

或者，你可以采用**酷孩子的方法**并使用 CSS-in-JS(它并不适合所有人)。

当这个想法开始时，大多数库都是使用内联样式实现的。这导致了一些性能问题和其他一些问题。

如今，大多数库都是通过将样式表动态附加到 DOM 上来工作的，最大的问题已经解决了。我已经有一段时间没有机会深入研究这些了，但是它在我的清单上！

如果你想了解更多，有大量的图书馆、讲座和文章，但是这里的[是 React](https://hackernoon.com/all-you-need-to-know-about-css-in-js-984a72d48ebc) 和 Vue 的好起点。

# 你测试过吗，兄弟？

你不希望有成千上万的人使用你漂亮的新组件，只是让它在边缘情况下剥落。或者上帝禁止你添加一个漂亮的新功能——但它打破了其他一切。

当你像这样构建一个可重用的组件时，你可能不会做任何集成或者端到端的测试。您将编写**单元测试**，重点测试复杂的逻辑并确保组件正确呈现。

如果您需要开始，这里有一些关于测试 React 和 Vue 组件的好文章:

[](https://www.fullstackreact.com/30-days-of-react/day-22/) [## Fullstack React:测试简介

### 测试套件是一种前期投资，在系统的生命周期中会有回报。今天我们要介绍的话题是…

www.fullstackreact.com](https://www.fullstackreact.com/30-days-of-react/day-22/) [](https://alexjoverm.github.io/series/Unit-Testing-Vue-js-Components-with-the-Official-Vue-Testing-Tools-and-Jest/) [## 使用官方 Vue 测试工具和 Jest 对 Vue.js 组件进行单元测试| Alex Jover Morales

### Vue.js 已经成为年度框架。它非常灵活，高性能，易于学习，导致大量的…

alexjoverm.github.io](https://alexjoverm.github.io/series/Unit-Testing-Vue-js-Components-with-the-Official-Vue-Testing-Tools-and-Jest/) 

# 文档——这是最重要的

“我以后再写文档”，当你向 Github 提交最后一个漂亮的提交时，你这样想。“我的意思是，即使我不去做这件事，也没有人会真的关心这件事。”

毕竟，你是用 Javascrip *t* 语言写作的专家，而不是人类所说的这些[自然](https://hackernoon.com/tagged/natural)语言中的一种。

但是好的文档是把好的组件变成好的组件的关键。

当你试图弄清楚如何让一个库做一些事情，或者你对 React(或 Vue)的生命周期方法感到困惑时，你知道这种感觉。如果不能很快找到答案，那就超级沮丧。

有时你甚至会放弃这个库，因为**你不知道**如何让它工作！

不要因为缺少好的文档而让你闪亮的全新组件浪费掉。

# 简明清单

现在我们已经了解了所有这些，下面是易于参考的版本:

## 避免猜测性的笼统

## 简化 API

## 研究现有技术

## 将组件分成小块

*   将状态+行为与表现分开
*   按抽象层次划分

## 只在需要的地方使用强大的合成模式

*   复合组件
*   高阶组件
*   渲染道具和无渲染组件
*   受控/非受控道具
*   状态缩减器
*   提供商模式

## 可访问性不是事后才想到的

## 让造型变得简单

## 你测试过吗，兄弟？

## 文档——这是最重要的

*我的文章一出来就在*[*michaelnthiessen.com*](http://michaelnthiessen.com)*看看吧！几个星期后，我把它们重新贴在这里。***