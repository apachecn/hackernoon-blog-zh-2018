# 复杂简单:现代技术的诅咒。

> 原文：<https://medium.com/hackernoon/complicated-simplicity-c2bbb3af160c>

![](img/7f517025287f21fd3519b79d08750cb0.png)

你已经听说过这些骗人的生物了。他们向你承诺你想要的一切——就本文而言，这是你的应用程序的完美服务器架构。然而，他们没有告诉你，你也会被赋予你的东西所诅咒。没错，我们说的是微服务和无服务器。

**问:你认为这些技术错误地夸大了它们的价值，还是认为这是可以接受的营销？**

## 微服务承诺

因此，有一天你偶然发现了微服务，有人告诉你，不仅可以降低应用程序的成本，还可以根据负载来扩展独立的单元。你的“支付”服务受到了打击？当然，扩大规模，让您的“身份验证”服务以更低的成本运行。

所以，你很高兴这样做，但是你意识到所有这些 JSON 在服务器之间跳跃增加了一些时间，所以你得到了另一个解决方案。这是 gRPC。二进制数据通过几乎瞬时的解码和编码在服务间传输。

> 哦不！我需要更改我的用户模型来跟踪最近的付款。

很简单，对吧？你只需要改变模型和部署。没有。你必须确保你所有的依赖都是最新的“认证”服务和“支付”服务，并确保你所有的版本都是最新的。

> 哦不！我们需要了解我们的服务器上发生了什么，并监控每个服务的状态。

很简单，对吧？没有。你会很快发现自己在每项服务旁边安装了一个“边车”,并且必须确保边车本身正常工作。

微服务一直标榜自己简单、划算、高效。实际上，如果你没有每天获得数百万的点击，这几乎完全是不真实的，你很容易浪费更多的时间和精力投入到架构中。

所以，微服务其实有点骗人。它们当然有价值，但对许多公司来说并非如此。无服务器女士怎么样？

## 无服务器的承诺

无服务器宣传与微服务类似的好处，尽管成本节约因素被推到了极致，因为你不用为任何一行没有被执行的代码付费。无服务器提供了极其灵活的扩展和便利。

一旦你开始从基础层面来看待这些架构，它就已经令人生畏，并且有极端的样板文件需要设置。我将在这些例子中使用 AWS Lambda，但从经验来看，都有一个痛苦的学习曲线。

因此，您可以开动脑筋，学习 AWS SAM，并创建一个方便的资源文件来启动您的架构。但是维护起来很糟糕，显然不值得。

> 我刚刚听说了无服务器框架，它承诺在一个命令中跨任何提供商进行部署！

太好了，所以你下载[无服务器](https://serverless.com)然后开始破解。您决定运行初始化命令，编辑配置文件并运行 deploy。

无服务器已经做了很多不太透明的事情。它创建了一个完整的堆栈，在 API Gateway 中为你创建了一个服务，应用了一些设置，并把你的 lambdas 推上来。

现在，您需要决定是否需要一个不同的 AWS 帐户用于生产或生活，或者您想要深入研究 IAM，或者您想要满足于一个帐户上的两种环境。然后你了解了 75GB 的限制，他们不会自动删除旧的 lambdas。

> 哇，我让我的 POST 端点工作了，现在我可以创建和编辑用户了！

恭喜你。你测试过当你需要返回一个 403 时会发生什么吗？您是否有一致的方法在您的平台上传递错误？端点认证呢？您可以创建一个身份验证 lambda，但是在决定它的缓存时间时要小心。

## 单纯在哪里？

这不是一个旨在抱怨这些技术的帖子。这是为了让那些认为放弃巨石是个好主意的人意识到这一点。

我最大的问题是虚假广告。事实证明，这些体系结构非常简单，只需点击一下即可完成部署和承诺。

他们没有向你展示你将会遇到的痛苦:显示错误，监控这些架构，然后进行版本控制，维护和扩展它们。

我们在部署中混合使用了传统的微服务和更新的无服务器功能，效果很好。我们有大量的初期问题，不得不更多地了解 SAM，以获得几乎所有我们在 monolith 中习以为常的功能。

总之，放下复杂的[简单的](https://hackernoon.com/tagged/simplicity)，停止欺骗人们。