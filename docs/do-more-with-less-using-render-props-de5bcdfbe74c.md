# 事半功倍！使用渲染道具

> 原文：<https://medium.com/hackernoon/do-more-with-less-using-render-props-de5bcdfbe74c>

![](img/8933e4fa3854e49902a096a7f2866351.png)

# 继续之前！什么是渲染道具？

如果你没有读过迈克尔·杰克逊关于[渲染](https://hackernoon.com/tagged/render)道具的精彩帖子，(不，不是唱歌的那篇)，你必须在继续这篇文章之前试一试。

 [## 使用渲染道具！

### 渲染道具是在 React 中合成状态的强大方法。

cdb.reacttraining.com](https://cdb.reacttraining.com/use-a-render-prop-50de598f11ce) 

如果你懒得阅读，我可以给你一个视频(也包括在文章中)

无耻地引用 MJ 的文章:

> 渲染属性是一个功能属性，组件使用它来知道渲染什么。
> 
> 更一般地说，这个想法是这样的:不是“混合”或装饰一个组件来共享行为，**只是用一个函数道具来呈现一个常规组件，它可以用这个函数道具来与你共享一些状态**。

如果你想了解更多信息，在 [React](https://hackernoon.com/tagged/react) 文档中甚至有一个关于渲染道具的[页面](https://reactjs.org/docs/render-props.html)。

> 术语[“渲染道具”](https://cdb.reacttraining.com/use-a-render-prop-50de598f11ce)指的是一种简单的技术，使用一个其值为函数的道具在 React 组件之间共享代码。

# 如何使用渲染道具解决问题？

我们来谈生意吧！在本文的这一部分，我将回顾应用程序中的两种常见情况(**使用简单易懂的例子**)，它们可以适应您的任何需求！

最终你会明白渲染道具模式是如何让我们的生活变得更简单的。

## 列表上的重复数据提取

我敢肯定，我们都有这样的用例，你有一个从你的 API 获取数据的列表或表格，当它获取时，你用一个漂亮的动画显示一个加载指示器，当它最终完成它的工作时，你呈现列表。

想象一下那个列表是汽车的。那会怎样？也许是这样的:

现在想象一下，这在一个有 10 个或更多列表的应用程序中传播。总是输入加载样板文件会很累，对吗？现在添加分页、排序和过滤，你可能会很快发疯。

渲染道具是来帮忙的。使用该模式，我们可以快速创建一个简单的列表组件，它可以获取一个 url 并为我们处理列表的加载状态。

真的就这么简单。如果你所有的列表都有通用的 JSX 模板，你甚至可以把它添加到这个组件中，去掉另一种形式的重复。只要看一下代码，你就可以很容易地判断出你可以修改它来满足你的任何需求。

添加分页、排序、过滤甚至刷新按钮都是简单的功能。发疯吧！

easy to just DO IT with render props

现在，我们所要做的只是在我们的应用程序中使用我们的组件，我们就可以开始了。

看看下面的 CodeSandbox，看看它是如何完成的，也许还可以摆弄一下。

## 重复的表单发布到服务器

这里有一个稍微复杂一点的例子。表单是大多数应用程序的基础。正确处理表单以确保一切按预期运行是很重要的。

让我们想象一个场景，你的应用程序中有大约 10 个表单。它们都向服务器发布，当它们发布时，提交按钮显示一个加载指示器或消息，它被禁用，完成后你想运行一些代码。

正常情况下会是什么样子？我将使用 [**Formik**](https://github.com/jaredpalmer/formik) **进行表单处理。**

Form without render props

通过查看代码，我们可以很容易地指出最大的重复点是对服务器的 **POST** **fetch 请求**和错误处理。表单域和验证总是会改变，但是你可以有一个应用程序，它总是用表单数据发布到服务器。

现在，让我们做一些工作，并应用渲染道具来重用所有这些有趣的逻辑。

AjaxForm Component using render props

通过创建 AjaxForm render prop 组件，我们已经抽象出了重复的要点，并使我们的生活变得更加简单。

它接受任何 url，甚至给你一个 **onSuccess** 回调。现在，向应用程序添加表单提交的漫长而重复的过程已经一去不复返了。

检查下面的 CodeSandbox 以查看示例

注意:它不会提交到任何地方(只有示例 url 给出)，但你可以看到它是如何工作的，请随时修改它。

CodeSandbox for AjaxForm

# 不要直接使用这些组件

> 过早优化是万恶之源

在使用(或构建)这些组件之前，你应该首先确保你的应用需求在不久的将来不会改变。抵制尽早重构的冲动，因为您的需求可能会发生变化，如果发生变化，您将不断地对这些组件进行更改。有这么多的变化，你最终可能会得到一段难以管理的代码。

我的建议是:

*   概述你的要求
*   像平常一样对它们编码
*   注册可能重构的点
*   确保需求不会发生巨大的变化
*   重构吧！

## 制作适合您的应用和需求的组件。不要满足于这些抽象简单的例子。

# 挑战

如果你想实践这个简洁的小模式，我有一些挑战给你:

*   向列表呈现属性组件添加分页支持
*   向列表渲染属性组件添加排序支持
*   将 ErrorBoundary 合并到 List render prop 组件中以处理异常。

# 野外渲染道具的例子

这些包利用了这种模式:

*   [福米克](https://github.com/jaredpalmer/formik)
*   [反应-fns](https://github.com/jaredpalmer/react-fns)
*   [反应路由器](https://github.com/ReactTraining/react-router)
*   [反应动作](https://github.com/chenglou/react-motion)

# 我一定要用这种模式吗？

不喜欢？没事的。可以看一下[高阶组件](https://reactjs.org/docs/higher-order-components.html)。

# 关门前

我很感谢你花时间阅读这篇文章，我想带着一个问题离开(你可以在评论中回答)。

> 你看到自己使用这种模式了吗？为什么或为什么不？

谢谢你