# Docker 教程系列第 2 部分:微服务架构

> 原文：<https://medium.com/hackernoon/docker-tutorial-series-part-2-microservice-architecture-149d98e63f4b>

在深入了解 [Docker](https://hackernoon.com/tagged/docker) 之前，我觉得了解[微服务](https://hackernoon.com/tagged/microservice)架构以及为什么它是传统单片应用的更好替代方案是很重要的。之后，我们将讨论如何利用 Docker 来创建松散耦合的微服务。

以下是本系列之前文章的链接:

 [## Docker 教程系列第 1 部分:图像、图层和 docker 文件

### 本文是 Docker 系列文章的第一篇。今天，我们将介绍 Docker 的核心概念…

medium.com](/@adityadixit06/docker-tutorial-series-part-1-images-layers-and-dockerfile-249f88041c82) 

单片应用程序由一个容纳业务逻辑的内核和一个与现实世界接口的适配器外层组成。业务逻辑被分成处理服务、事件和对象的模块。而适配器提供对数据库、支付系统、消息引擎、web APIs 和用户界面的访问。尽管采用了逻辑模块化设计，该应用程序还是作为一个整体打包和部署。

在初始阶段，这种应用程序非常容易开发、测试、部署和扩展。但是，随着应用程序复杂性的增加，每个增量更改都变得非常昂贵。新老开发人员都面临着一项艰巨的任务，试图掌握任何代码更改对应用程序的影响。任何使用过企业级应用程序的人，都像我一样，知道数百万行代码需要花费很长时间才能启动，而且几乎是不可理解的。同样可怕的是试图向新员工解释你学到了什么。采用新技术变得几乎不可能，因为这需要从头开始重新构建应用程序。

为了克服上述问题，组织想出了将应用程序分成几个更小的互连服务的想法。目前，对系统进行分区与其说是科学，不如说是一门艺术，尽管有几种策略可以使任务变得更容易。应用程序可以根据服务领域、业务能力或操作职责进行分解。我们的目标是尽量减少对多个微服务的同时更改。

微服务是一个迷你应用程序，有自己的业务逻辑和适配器。它实现了一组独特的特性或功能来服务于它的目标。它由一个小型的跨职能团队开发和维护。它只是与其他微服务松散耦合。以上陈述共同暗示了负责管理微服务的团队可以按照自己的节奏自由开发新功能。此外，该团队可以自由选择它将使用的技术堆栈，从而确保它可以采用它认为合适的新技术。这意味着它可以从更深层次的申请人中选择新员工。

现在，我们来看 Docker 如何帮助我们实现‘微服务架构’的问题。Docker 将每个服务打包成一个独立于底层操作系统环境的独立实体。每个服务都可以独立部署在任何物理或虚拟位置，独立于其他服务。可以产生相同服务的多个实例。功能链接的服务可以在同一台机器上并排放置。这种自由是通过构建一个 Docker 容器并将服务运行所需的一切都放在这个容器中来实现的。

构建容器的第一步是创建一个名为 Dockerfile 的配置文件。docker 文件包含安装应用程序依赖项(如编译器、解释器、库和第三方模块)、复制源代码文件和运行系统命令的指令列表。该 docker 文件将微服务与应用程序的其余部分分离，并允许开发团队独立于组织的其余部分选择其技术堆栈。此外，它指定了环境变量和开放端口，用于传输数据和与外部世界通信。

第二步是通过执行 Dockerfile 中提到的步骤来创建 Docker 映像，这是我们的微服务的蓝图。Docker 映像是为响应 Dockerfile 中发布的指令而构建在彼此之上的层的集合。这些层的特殊之处在于，在每次重建时，Docker 引擎会计算每层的校验和，如果层中未引入任何更改，则使用缓存中存储的先前版本。有了这些信息，我们以这样一种方式创建 Dockerfile，即将最有可能在后续重建中保持不变的层放在开头，将经常变化的层(如包含源代码的层)放在后面。这使得重建映像的过程快得多，并提高了部署新代码更改的速度。

最后，我们可以创建一个 Docker 容器，通过发出 Docker run 命令，它是 Docker 映像的一个可运行实例。Docker 容器封装了我们的微服务，并使其在所有平台上可用，而不管底层环境如何，强调了 Docker 的“一次构建，随处运行”的座右铭。现在，我们可以在单个系统或机器集群上运行这个 Docker 映像的多个并行副本。

容器化使得扩展我们的应用变得容易，也就是说，我们可以根据需求动态地增加或减少微服务的运行实例数量。但与单片应用相比，扩展如此高效和强大的原因是我们可以根据需求扩展每个微服务。让我们举一个例子，假设在我们的单片应用程序中，用户注册模块突然增加。在这种情况下，为了满足新的负载，我们必须生成整个应用程序的新实例，这将在内存和 CPU 使用方面占用大量内存。然而，在使用微服务构建应用的情况下，我们只需扩大用户注册服务的实例，而不会影响其他服务。这种微调生产环境的能力对所有人来说都是一个巨大的福音，尤其是开发运营团队。

这就把我们带到了这篇微服务架构初级读本的结尾。我们讨论了长期以来主导企业开发文化的传统单片应用程序的局限性。然后，我们介绍了微服务架构，作为管理软件设计和开发复杂性的有效替代方案。最后，我们阐述了 Docker 如何使用基于容器的方法帮助我们构建、部署和扩展微服务。

*原载于*[*blog . adityadixit . me*](http://blog.adityadixit.me/docker-tutorial-series-part-2.html)*。*