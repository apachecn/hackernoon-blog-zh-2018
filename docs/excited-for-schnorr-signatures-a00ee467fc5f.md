# 为 Schnorr 签名激动

> 原文：<https://medium.com/hackernoon/excited-for-schnorr-signatures-a00ee467fc5f>

如果你一直关注比特币发展的脉搏，你可能已经听说过 Schnorr 签名，你可能不会在这里发现太多新的东西。你可能更想看看彼得·维尔最近在 BPASE18 的[演讲，或者布莱恩·毕晓普](https://www.youtube.com/watch?v=oTsjMz3DaLs)[编辑的施诺尔签名演讲的文字记录](http://diyhpl.us/~bryan/papers2/bitcoin/bitcoin-tech-dev-talks-schnorr-signatures.2018-02-01.pdf)，这篇文章很大程度上依赖于他们。

比特币签名是使用椭圆曲线数字签名算法(ECDSA)创建的。Schnorr 签名是数字签名的另一种形式。这些签名基于与 ECDSA 相同的[安全](https://hackernoon.com/tagged/security)假设，并且与比特币已经使用的椭圆曲线(secp256k1)兼容。这意味着 Schnorr 签名可以用相同的私钥创建，并且与当前使用的密钥派生方案兼容。

# **Schnorr 签名较小**

ECDSA 签名的大小各不相同，但几乎所有签名的长度都是 72 或 71 字节。一小部分将变得更小，理论上最小为 8 字节。[格雷格·马克斯韦尔]

Schnorr 签名比 ECDSA 签名更有效和紧凑。每个签名的最大长度是 64 个字节。[【via Harding】](https://bitcoin.stackexchange.com/q/34288/5406)

比特币区块包括成千上万个签名，我估计签名占区块链数据的三分之一以上。仅仅因为更紧凑，Schnorr 签名就可以将区块链数据占用空间减少几个百分点。

# **Schnorr 签名允许紧凑的多签名…**

比特币的多重签名方案简单明了，但很幼稚。您首先列出授权签名者的公钥集，然后提供前者签名的足够计数。例如，在 2/3 多签名交易输入中，提供了三个公钥和两个签名。

Schnorr 签名有一个简洁的数学特性，允许将多个签名组合成一个签名。组合签名具有单个签名的大小，但提供对原始单独签名的授权。

这允许更紧凑的多重签名方案，其中您只列出授权的公钥并提供单个签名。对于较大的多重签名事务，这甚至更有效。例如，15 中的 3 和 15 中的 10 的事务输入现在可以具有相同的权重(如果您不在乎谁签名的话)。

# **…以及整个交易中的聚合签名！**

虽然多签名事务构成了块空间的坚实部分，但真正的突破是签名可以跨事务的多个输入进行聚合。不是为每个输入提供一个(或多个)签名，一个带有 Schnorr 签名的事务可以让**为所有输入提供一个签名**。

例如在 BitGo，我们使用三取二多重签名交易。因此，每个事务输入都有两个签名。由于我们看到网络上的低费率，我们的一些客户已经开始从低价值的 UTXO 整合资金。利用当前的签名方案，具有 200 个输入的 2/3 多重签名事务将需要 400 个签名或大约 28.5 kB 的签名数据。使用 Schnorr 签名，可以用单个 64 字节的 Schnorr 签名对相同的事务进行签名。

在 BPASE18 的[演讲中，Pieter Wuille 估计，纯粹从聚合每笔交易的签名并保持其他一切不变来看，比特币区块链将会小 25%到 30%。](https://www.youtube.com/watch?v=oTsjMz3DaLs)

# 无脚本脚本，和…各种黑色加密魔法

安德鲁·波尔斯特拉最近有一些有趣的工作，他称之为“无脚本脚本”(见例如他在 [Real World Crypto 2018](https://www.youtube.com/watch?v=ovCBT1gyk9c) 的演讲)。这个想法是，您可以通过要求为支付提供某些签名来表达智能合同中的条件。通过上面提到的签名聚合，这可以用来紧凑地编码智能契约。合同条款将对其他用户隐藏，仅对参与者透明，但由整个比特币网络强制执行。

你可能听说过最近的跨链原子交换。其基本思想是，在两个不同的区块链上的两个支付以某种方式联系在一起，它们要么都通过，要么都不通过。这可以用来分散交易加密货币。
据此，交易者首先锁定两个链上共享地址中的资金，然后创建两个相互依赖的交易。第二个事务依赖于第一个事务显示的哈希原映像。任何一方都可以退出并等待锁到期来收回他们的资金，但是当第一个事务被执行时，另一个事务立即生效。

通过允许签名聚合的相同属性，所有上述跨链原子交换可以用与常规消费交易不可区分的单个 Schnorr 签名来表示。

# Schnorr 签名的 BIP 正在筹备中

将 Schnorr 签名引入比特币需要一个新的 OP_CODE 进行签名验证。幸运的是，Segwit 为我们提供了比特币脚本的版本控制，因此可以使用软 fork 激活对 Schnorr 签名的支持。我听说多项比特币改进提案正在酝酿中，很快就会出台。

*感谢 Pieter Wuille 的点评。编辑:修正了 ECDSA DER 编码签名的长度。*