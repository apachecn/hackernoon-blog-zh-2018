# 现代 JavaScript 中的函数式编程范式:函数组合

> 原文：<https://medium.com/hackernoon/functional-programming-paradigms-in-modern-javascript-function-composition-109670038859>

![](img/32e0388045d326f816a5219314087680.png)

在前两章中，我们介绍了函数式编程的一些基本范例——纯函数和不变性。如果你还没有读过它们，你可以从这里的[开始。](https://hackernoon.com/functional-programming-paradigms-in-modern-javascript-pure-functions-797d9abbee1)

在本文中，我们将扩展我们对函数及其属性的了解，为如何将它们结合起来组成程序逻辑打下基础。

函数式编程的目标是主要使用小的纯函数来构建我们的程序，这些函数可以组装在一起，就像您在组合小的乐高积木一样。

# 什么是函数构成？

功能组合是将多个功能组合在一起以创建更复杂的逻辑流的行为。通过使用这种技术，我们可以避免读起来像操作流的迭代代码结构，而是通过将指令组合成单个函数来抽象出过程的复杂性

不要被最后一句话的长度吓倒。简而言之，在这里我们将开始学习如何将函数组合在一起。

从以前的一篇文章中我们了解到——函数应该小而纯，并且不产生副作用。符合这些条件的函数是纯函数，而且纯函数很容易合成。

函数总是返回相同的类型，给定相同的参数返回相同的值，这使得它们是可预测的。与电影不同，你希望你的函数有一个可预测的结果，这样你就可以很容易地在你的代码库中使用它们。

我们需要记住的前提是，当我们组合函数时，每个函数都应该从前面的函数中获取输出。我们不能只拿一些功能，把它们粘在一起，然后期望它们工作——它们的输入和输出**需要匹配**。

Congratulations, you have just had your first experience with function composition!

你可以把函数组合想象成管道的组合。执行从第一个(最右边的)开始，它输出的任何内容都将传递给第二个。然后，第二个函数接受它，对它做一些事情，并将其传递给下一个函数，依此类推。

在本文的后面，我们将会遇到另一种将函数组合在一起的方法，但是对于这个特殊的例子，请记住执行是从内到外或者从右到左开始的——无论哪种方法更容易记住

现在让我们回到使用函数组合时需要牢记的前提条件。如果你有一个以数字作为参数的函数，你不能用一个返回字符串的函数来组合它。嗯，技术上你可以，但你不会得到想要的结果。

解释组合的另一个简单方法是，连续调用函数的结果应该等于将它们组合在一起的结果。

通过证明这两种方法具有相同的结果，我们确信我们已经正确地组合了我们的函数，并且它们不依赖于任何额外的输入。

还要注意，我们是**而不是**只是将内部函数作为参数传递，这将是一个高阶函数。最里面的函数实际上是用它的参数调用的。

# 应用在哪里？

每当我学习新的东西时，我喜欢考虑我可以把它应用到哪里，以及它如何有用。

我最近遇到一个案例，一个 API 期望接收一个以特定方式格式化的 JSON 有效负载。一种方法是在代码本身中实现格式化逻辑，但这并不是您真正想要的。无论你在构建什么样的服务或应用，你都不希望你的应用内部依赖于外部的东西。

因此，我决定在分派有效负载之前实现一个额外的步骤来解析和准备它。这里最简单的方法是创建一个`parsePayload`函数，它接受对象并返回一个准备发送的新对象。

我担心客户端 API 所需的格式可能会改变，所以我决定将操作拆分成多个小函数，并在将来修改时更加灵活。另一个很大的好处是解析过程的清晰性。

Same syntax as before but split in new lines

在这个特殊的例子中，我们从`filterEmpty`开始。不要忘记，用这种特殊的方式写作，执行总是由内而外的。在我们过滤掉空属性后，我们将对象返回给`formatValues`函数，该函数将获取该对象并执行其名称所暗示的操作。它将格式化后的对象返回给`mapKeys`，后者在键上做一些工作，然后它被*字符串化*，这样它就可以被发送了。

如果我们使用数组，这可以通过 JavaScript 数组对象的内置方法来实现，但这让继承代码库的未来开发人员更清楚我到底想做什么。

# 更加数学化的解释

尽管我尽量不给出数学解释，但函数合成是一个很容易用数学例子描述的概念。

假设你有一些计算`x + 3`，你想把它的结果乘以`10`——你可以写成`(x + 3) * 10`。下面是我们如何使用函数组合轻松实现这一点

看起来很直观吧？它可以被大声读出，而且它将完全理解你正在尝试做的事情——将数字`3`和`5`相加，然后乘以`10`。这是一个让函数组合为我所用的例子，我相信它最好地说明了描述性函数代码是如何的。

# 为什么这是一件事？

当你第一次读到这个的时候，你可能会问自己，如果你可以使用某种链接的话，为什么有必要这样做。JavaScript 有很多针对其数据类型的实用函数，所以修改数组或字符串并不难。

但是，为了使链接工作，您需要传递同一个对象，因为您不仅仅是在调用一个函数，而是在从上一个函数传递来的对象上调用它。因此，您需要该对象包含您想要链接的所有函数。

在您想要过滤和映射数组的情况下，链接是更好和更可读的方法。但是在您希望数据类型改变或者您正在实现内置方法不支持的复杂流的场景中，组合仍然可以在不牺牲可读性的情况下为您带来好处。

# 图书馆

有许多 JS 库是用函数式编程构建的，但是对于这个例子，我们将使用 Ramda。如果您想尝试一下，看看使用一种更实用的方法来构建您的程序会有什么样的感觉，这是一个完美的选择。

为了简单起见，让我们用一个有一些计算操作的例子。

这个例子非常简单，只使用了三个函数，所以还是可以理解的。然而，如果我们需要组成五个函数，它将失去控制，变得难以阅读。我们总是可以将函数拆分到不同的行中，但是我们必须小心不要过度，尤其是当组合函数的数量增加时。

为了避免不必要的混乱，我们可以使用 Ramda 的`compose`函数。使用函数库的好处是语法很容易理解和查找，所以没有玩过函数式编程的同事也能理解到底发生了什么，而不直接依赖你。

您在这里可以看到的第一个区别是，在 compose 调用中，我们没有为第一个函数提供参数。事实上，compose 将返回一个新函数，我们可以调用它。另外，记住用 composed 创建的函数是从最后到第一执行的——这意味着首先运行`sum`,然后是`square`,最后是`addTen`。如果你想让它们从头到尾运行，你可以使用 Ramda 提供的`pipe`函数。语法 100%相同，不同之处在于执行的顺序。

# 为什么函数构成很重要？

函数组合是函数式编程的核心，它将教会你创建强大的函数和流所需的基础知识。我们在本文中所学到的知识仅仅触及了主题的表面，但是它的目的是让您更舒适地操作函数

# 下一步是什么？

我们已经介绍了函数组合的基础知识，无论是使用 Ramda 还是普通的 JavaScript，您都应该可以轻松地组合函数。

这是推销员说“但是等等，还有更多！”。当然还有更多——通过将我们在本文中学到的内容与其他几个函数式编程概念结合起来——*和 ***局部应用*** *，*我们可以创建非常强大的抽象，并释放函数的真正潜力。*

*在下一篇文章中，我们将研究*局部应用*以及它的特别之处！*

*[](https://hackernoon.com/functional-programming-paradigms-in-modern-javascript-pure-functions-797d9abbee1) [## 现代 JavaScript 中的函数式编程范例:纯函数

### JavaScript 是最流行的编程语言之一。它可以在浏览器、桌面、手机上运行…

hackernoon.com](https://hackernoon.com/functional-programming-paradigms-in-modern-javascript-pure-functions-797d9abbee1) [](https://hackernoon.com/functional-programming-paradigms-in-modern-javascript-immutability-4e9751ca005c) [## 现代 JavaScript 中的函数式编程范式:不变性

### 这是实用函数式编程范例系列文章的第二章。如果你没有读过…

hackernoon.com](https://hackernoon.com/functional-programming-paradigms-in-modern-javascript-immutability-4e9751ca005c)*