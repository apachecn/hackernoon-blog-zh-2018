# 微服务如何拯救互联网

> 原文：<https://medium.com/hackernoon/how-microservices-saved-the-internet-30cd4b9c6230>

## 规模建筑应用导论

## 介绍

就今天的影响力而言，分布式系统仍然是最容易被忽视的话题之一，至少在大学里是这样。没有多少学生理解像容器化和容错这样的概念，你永远不会看到一个系统项目赢得黑客马拉松。尽管如此，我认为至少对今天的大规模系统如何工作有一个简单的理解是非常重要的。

这个故事是针对初学者的系列文章的第一篇，比如受过 1-2 年普通计算机科学教育的人或者广泛自学过 web 开发的人。前几篇文章将是对主要概念的高层次介绍，并对一些技术细节进行深入探讨。稍后我希望探索[网络](https://hackernoon.com/tagged/networking)中的主题，Kubernetes，以及我在研究中看到的酷的东西。第一个非常简单，旨在解释微服务背后的[动机](https://hackernoon.com/tagged/motivation)和基本概念。

## 分布式系统保持互联网运行

回到过去，应用程序是整体构建的。该应用程序可能由 web 服务器本身和某种数据存储系统组成，只是构建并打包成一个或两个二进制文件。然后，这些二进制文件被上传到服务器机架上，并直接在机器上运行。这对 80 年代和 90 年代的互联网来说没什么，但今天谷歌每天收到 35 亿次搜索查询，没有服务器——不管有多大——能够处理这些。

过去，工程师们通过购买更好的服务器、更好的电缆等进行纵向扩展。随着互联网的发展和[摩尔定律](http://www.mooreslaw.org)的终结，这很快变得不可持续，水平扩展的需求变得非常明显。与其购买更好、更贵的硬件，不如简单地购买大量廉价的服务器，并在所有服务器上分配负载。

最早的横向扩展只是运行 web 服务器的副本。然而，最近随着云的发展，*微服务*架构已经迅速开始主导市场。这个想法是将一个巨大的应用程序分割成单独的组件，称为服务，每个组件执行一个专门的任务。因此，开发人员不是让单个 web 服务器从头到尾处理一个请求，而是将应用程序分成多个服务，如用户验证器、页面服务器、api 服务器、数据库模型服务等。

![](img/0ff2d273253f246477c3c47a9e1738bd.png)

Splitting up a Monolithic Application (Source: [Dzone](https://dzone.com/articles/what-are-microservices-actually))

每个微服务由一个或多个*副本*组成。对于一个后端运行在 Django 上的网站，我们可以通过增加运行的 Django 服务器的副本数量来进行水平扩展。这些副本是复制品。如果我们正在运行一个数据库，我们可以通过增加副本的数量来增加副本的数量，这对于数据库来说通常被称为*碎片。*把碎片想象成整个数据库的一部分，你可以单独运行它，它保存着全部数据的一部分*。*通过增加碎片的数量，我们可以横向扩展数据库。然后，这些副本可以在不同的机器上运行。因此，如果我们想要一个运行在 100 台机器上的大型 web 服务器，我们可以制作 100 个副本，并在不同的机器上运行每个副本。

让我们看一个完整的例子。负载平衡器可以接受 Google 搜索查询，并将其转发给 api 服务器的数千个副本中的一个。然后，api 服务器将请求同时转发给索引器、广告生成器和 ML 神经网络。这些服务中的每一个也可以运行数千个副本。这些单独的服务完成它们自己的任务，每一个都是整个原始请求的一部分，然后 api 服务器聚集结果并以搜索结果的形式返回给您。

![](img/567140c8debc42d16d355a48eb928c8c.png)

Aggregation Style Microservice Architecture (Source: [Arun Gupta](http://blog.arungupta.me/microservice-design-patterns/))

有关微服务架构模式的更多信息，请访问 Arun Gupta 的[博客](http://blog.arungupta.me/microservice-design-patterns/)。他是 AWS 的首席技术专家。

## 优势

以下是使用微服务的一些最大优势。虽然还有很多，但这四个是最重要的。

*   微服务框架最大且最不可否认的优势是能够横向扩展其任何组件。如果一个服务(比如神经网络)负载很重，你可以简单地运行这个特定服务的更多副本。
*   服务是独立的。每个组件都可以存在于一个独立的存储库中，并由一个专门的工程师团队进行维护。该组件是用最适合其用途的语言编写的，因此数据库服务可能用 C 编写，而 web 服务器用 Python 编写。这些服务可以更新，新的组件可以编写，而不会影响管道的其余部分。
*   该架构是可插拔的。这一个建立在服务的独立性上，但是把它带到了一个全新的水平。一个公司甚至不需要编写它所有的服务。像 MySQL，Elasticsearch，Redis 这样的第三方应用都是微服务，可以很容易地集成到你的系统中。
*   容错(通过故障隔离)。这种优势实际上只存在于你的系统设计不差的情况下。一个服务副本的失败不应该导致整个管道甚至该服务失败。同样，特定服务中的错误不会影响其他不相关服务的正常运行时间。这并不总是容易的，容错在工业和研究中都是一个令人感兴趣的问题，特别是对于分布式数据库和网络这样的主题。

当然，和所有事情一样，也有一些缺点。将请求从一个服务退回到另一个服务会带来开销和复杂性。分布式系统通常会有依赖性、复制和共享命运的问题。部署和调试的难度随着微服务的数量和复杂性呈指数增长。

好消息是，有大量的研究人员、公司和初创企业正在研究这些问题的各个方面。像 Jenkins、Spinnaker 和 Jaegertracing 这样的项目是当今最受欢迎的开源解决方案，工业界和学术界每天都有新的创新。

因此，尽管分布式系统仍然相对较新，但它们的影响每天都可以感受到。我是说，想想你是怎么读这篇文章的。