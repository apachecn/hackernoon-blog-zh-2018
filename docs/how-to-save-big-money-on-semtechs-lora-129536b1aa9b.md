# 如何在 Semtech 的 LoRa 上节省大笔资金

> 原文：<https://medium.com/hackernoon/how-to-save-big-money-on-semtechs-lora-129536b1aa9b>

![](img/767a304dce446b2741ea51ce3207cded.png)

在 Haystack，我们是 Semtech 的 LoRa LPWAN 电台的粉丝。直到最近，我们还认为 915 MHz 频段对于低功耗物联网系统来说噪音太大，但 Semtech 使用啁啾扩频技术并结合现代芯片功能，使其在不断增长的 LPWAN 行业中占据优势。我们特别看好 LoRa 在移动 LPWAN 应用方面的前景，在这方面，竞争对手 NB-IoT 和 Sigfox 实际上已经胎死腹中。每天我们都在发现关于 LoRa 的事情，这加强了这样一个结论，即它是一个很好的 LPWAN 无线电，可以以一种成本有效的方式部署。

但就像尤塞恩·博尔特穿着锁子甲和滑雪靴参加 100 米短跑一样，Semtech 推出了一个[弱](http://bit.ly/lorawan)网络软件选项来支持 LoRa。旨在让最不成功的物联网开发者失望的是，使用 LoRaWAN 的电池供电的 LoRa 端点只能有效地将消息*发送到网关*，实际上不能从网关接收消息*。向一个端点发送命令、查询一个端点、向一组端点广播消息、无线刷新安全密钥或使用公钥加密验证一个端点，这些只是运行 LoRaWAN 的电池供电的 LoRa 端点或多或少无法完成的一些事情。*

这部分是因为 LoRaWAN 的设计非常像蜂窝网络，只是更简单:有一个相对低成本的端点，可以由电池供电，还有一个相对高成本的网关，通常由市电供电。端点和网关之间的通信是一对一的，类似于蜂窝，这意味着广播数据流是不可能的。这对于电话呼叫来说是有意义的，但是即使对于比以往更加面向数据的当代蜂窝系统，一对一的路由限制也阻止了频谱的最大利用。然而，这在 LoRa 中是一个比蜂窝更大的问题，因为 LoRa 的数据速率非常低，通常低于 10 kbps，通常低于 2400 bps。因此，将消息推送到 1，000 个端点可能需要 1 秒钟的广播操作最少需要 1，000 秒。这种局限性是可以理解的，LoRaWAN 反对从网关到端点的通信。在很大程度上，LoRaWAN 是一种为固定的自动化仪表读数而设计的技术，并且适合于这种技术，因为其设计限制使其很难适合低延迟、广播或双向数据流。端点和应用之间需要两分钟通信延迟的应用——这是 LoRaWAN 支持的最低延迟——建议每 60 个端点使用一个以上的网关，这将导致相当高的网关密度。

## 洛拉万锁定策略

人们可能会认为 Semtech 对基于 LoRa 的应用软件或多或少是不可知的，因为 Semtech 是一家半导体制造商，当芯片以任何目的出售时，他们都会获利。尽管如此，Semtech 展示了一个清晰的策略来推动 LoRaWAN 超越其他使用 LoRa 的网络软件实现。看一下他们的芯片价格就能提供更好地理解他们计划所需的信息。

选择 LoRaWAN 的开发人员被有效地“锁定”到 SX1301 LoRa 网关 IC，作为网络实施的一部分，该网关组件具有[**【68.00 美元**](http://bit.ly/2pxpHLx) **的**经销商定价，而其端点无线电只有**[**【3.00 美元**](http://bit.ly/2Q0Td7G) **。那就是价格溢价 2300%。**郑重声明，芯片的材料成本几乎可以忽略不计——芯片是由硅(沙子)和少量金属制成的。鉴于网关 IC 的利润率如此之高，Semtech 将网络技术推向市场，将开发者锁定在这些网关 IC 上也就不足为奇了。**

通过竞争，LoRa 网关 IC 的高价点最终会降低。事实上，LoRa 调制和编码方案实际上已经被逆向工程并且用于 SDR 实现的流行的“GNU Radio”软件包括一个 [LoRa 软件驱动程序](https://github.com/BastilleResearch/gr-lora)。然而，Semtech 为 LoRa 保留了专利，阻止了这种技术的商业应用。否则，使用现成的元件，如 Intel Zynq 和几乎任何 SDR 前端 IC(有很多),可以构建自己的 LoRa 网关软件定义无线电(SDR ),性能超过 SX1301。对专利技术收取高价没有错，但值得指出的是，LoRaWAN 今天存在的强大可能性不是为了给开发者提供 LoRa 网络软件的最佳选择，而是为了支持 LoRa 网关 IC 的某种收入模式。**换句话说，如果没有 LoRaWAN，Semtech 的网关 IC 利润率可能会受到威胁。**

## 消费者/中小企业市场中的 LoRaWAN 价格昂贵

对于部署只需要有限数量的网关的业务模型，这种额外的定价可能相当于舍入误差。但是，对于那些计划在消费者或 SMB 市场进行大规模部署的人，以及那些设想在每个住宅或小型企业中部署 LoRa 网关的人(例如，像 [this](https://machineq.com/) )，端点和网关之间 65.00 美元的差异相当于一笔不小的 LoRa“网关税”，可以毁掉一项业务计划。对于那些考虑使用 LoRa 网关解决方案(例如，一个端点+一个网关)进行线下零售的人来说，65.00 美元的溢价对需求的价格弹性的影响是严重的。对于那些考虑通过基于订阅的方法来模仿蜂窝运营商的人来说，比方说，在三年的客户生命周期内直接摊销 65 美元会使消费者的月账单增加 1.81 美元。祝你好运。

Semtech 向市场传递的隐含信息是，面向消费者的客户应该从别处寻找他们的 LPWAN 需求。

## 用干草堆避免劳拉网关税

幸运的是，有答案。 [**Haystack 的 DASH7**](http://haystacktechnologies.com/technology/#technology_DASH7) **允许使用 LoRa 端点无线电作为网关无线电。**换句话说，使用 Haystack，端点和网关之间的材料清单的 LoRa 部分没有区别。

Haystack 的 DASH7 网络堆栈是 LoRaWAN 的替代产品。两者都是非常低的功率，但是它们不做完全相同的事情。事实上，两者可以在相同的设备上同时运行。然而，DASH7 确实提供了非常强大的广播和多播功能，以及低延迟、双向通信。DASH7 可以让普通的、面向 REST 的应用程序在 LoRa 上工作，而 LoRaWAN 不能非常有效地做到这一点。

DASH7 另一个有趣的属性是支持它的 Haystack 网关中间件。在这种情况下，它和洛拉万完全不同。LoRaWAN 将其协议的底层属性传递给云，在云上进行数据包处理并运行任何业务逻辑。这种模型简化了中间件，但代价是很高的网络延迟。对于许多开发人员来说，两分钟的延迟是不可能的，尤其是对于移动应用程序。然而，DASH7 网关必须能够在几毫秒内与端点进行往返通信，因此中间件的需求非常不同。特别是，Haystack 网关做了三件事，这在 LPWAN 领域是独一无二的。

*   每个网关上的代理端点数据集，以便将高吞吐量的互联网数据流与低吞吐量的 LPWAN 数据流连接起来。你可以认为这有点像“物联网的 Dropbox ”,只是它不是集中在云中，而是在每个网关上智能管理。一个 Haystack 网关可以支持大约 30，000 个代理端点。
*   基于 MQTT 的代理数据集与基于云的代理的同步。如果您想在云中集中同步，可以通过 MQTT 来实现。DASH7 数据模型和广播/组播模型非常适合 MQTT 使用的发布/订阅主题模型。
*   核心网关软件是用 C 语言编写的，因此它可以在简单、低成本的平台上运行，比如售价 5 美元的 Onion Omega 2。不需要臃肿的虚拟机环境。额外业务逻辑的定制插件可以用 C 或 Python 来完成。

由于中间件的复杂性， **Haystack 网关可以使用高价的 SX1301 网关 IC，或者更便宜的 3 美元 LoRa 端点 IC 来构建。**使用端点 IC，如 SX1276，网关的成本与远程传感器端点的成本相似。这些低成本网关可以分散在网络环境中，它们将协同工作，提供比同等价格的 LoRaWAN 网关优越得多的网络覆盖，同时还允许互联网应用程序在比 LoRaWAN 更基本的层次上与 DASH7 LPWAN 进行交互。

对 Haystack 如何帮助克服 LoRa“网关税”感兴趣的开发者，[点击这里](mailto:pat@haystacktechnologies.com)。

最后一个想法:

*   对于那些在家保持分数的人来说，如果 Semtech 继续追求 pro-LoRaWAN 课程，LoRaWAN 对上述大容量消费者/SMB 应用的不良适用性进一步限制了 LoRaWAN 在物联网中的潜力。此外，还有手机、电池供电的应用，如这里的[和这里的](http://bit.ly/2pBcYqp)和[所示。我认为，这基本上让 LoRaWAN 与另一个未准备好用于移动的协议 NB-IoT 在固定抄表用例上争吵不休。专注于固定仪表读数并不可耻，但人们不得不怀疑为什么 Semtech 会在这里留下这么多钱，以及这给据传将在未来几个月推出的竞争对手留下了什么样的免费赠品。](http://bit.ly/2xuqQWv)