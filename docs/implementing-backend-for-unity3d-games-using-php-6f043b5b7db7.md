# ä½¿ç”¨ PHP å®ç° Unity3D æ¸¸æˆçš„åç«¯

> åŸæ–‡ï¼š<https://medium.com/hackernoon/implementing-backend-for-unity3d-games-using-php-6f043b5b7db7>

![](img/1a4bcd1544878168af878a4c4cdd3d0a.png)

Photo by [Sean Do](https://unsplash.com/@everywheresean?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

# ä»‹ç»

**Unity3D** å·²ç»æˆä¸ºå½“ä»Šæµè¡Œçš„æ¸¸æˆå¼•æ“ä¹‹ä¸€ã€‚åªéœ€å¯¹ä»£ç åšä¸€äº›ä¿®æ”¹ï¼Œå°±å¯ä»¥å¼€å‘è·¨å¹³å°çš„æ¸¸æˆã€‚å¦‚æœä½ éå¸¸ä¹ æƒ¯ä½¿ç”¨ *JavaScript* æˆ– *C#ï¼Œ*é‚£ä¹ˆ Unity3D åº”è¯¥æ˜¯ä½ çš„é€‰æ‹©ã€‚

# æ¸¸æˆåŒ–

ä¸šå†…è®¸å¤šæ¸¸æˆèƒŒåçš„æˆåŠŸè‚¯å®šæ˜¯æ¸¸æˆåŒ–çš„æœ€ä½³å®è·µã€‚æ¸¸æˆåŒ–åŒ…å«äº†è®©æ¸¸æˆæ›´å…·ç«äº‰æ€§çš„ä¸€åˆ‡ï¼Œå¹¶ä¿ƒä½¿æ›´å¤šçš„è‚¾ä¸Šè…ºç´ å†²å‡»æ’è¡Œæ¦œçš„æ¦œé¦–ä½ç½®ã€‚ä¸ºä¸€ä¸ªæ¸¸æˆåˆ¶ä½œä¸€ä¸ªæ’è¡Œæ¦œå¹¶ä¸å®¹æ˜“ï¼Œå› ä¸ºæœ‰å¾ˆå¤šç»„ä»¶ï¼Œæ¯”å¦‚æ•°æ®åº“å®‰å…¨ï¼Œç”¨æˆ·è®¤è¯ç­‰ç­‰â€¦

# å±¥è¡Œ

è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ *PHP* å’Œ *MySQL* ä¸º unity3D ä¸Šçš„ä¸€ä¸ªç®€å•æ¸¸æˆå®ç°ä¸€ä¸ªæ’è¡Œæ¦œã€‚è®¡åˆ’æ˜¯è¿™æ ·çš„:

*   ç¼–å†™ PHP è„šæœ¬å¯¹æˆ‘ä»¬çš„æ•°æ®åº“è¿›è¡Œ SQL æŸ¥è¯¢
*   ç¼–å†™ *C#* è„šæœ¬ï¼Œåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå’Œåç«¯æœåŠ¡å™¨ä¹‹é—´å‘é€å’Œè®¿é—®æ•°æ®ã€‚è¿™é‡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°†æ˜¯ Unity3D æ¸¸æˆï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä½¿ç”¨ä»–ä»¬è‡ªå·±çš„æ–‡æ¡£æ¥å®ç°å®ƒã€‚
*   æœ€ç»ˆå°†æˆ‘ä»¬çš„æ•°æ®åº“è½¬å‚¨åˆ°äº‘ä¸Šï¼Œå°½ç®¡æˆ‘ä»¬åœ¨å¼€å‘æœŸé—´åœ¨æœ¬åœ°ä¸»æœºä¸Šæµ‹è¯•å®ƒğŸ˜ƒã€‚

# æˆ‘ä»¬å°†å®æ–½ä»€ä¹ˆ

æˆ‘ä»¬å°†å°½å¯èƒ½ç®€åŒ–è¿™ä¸€è¿‡ç¨‹ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿè·å¾—æ›´å¥½çš„å­¦ä¹ ä½“éªŒã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¸¸æˆï¼Œæˆ‘ä»¬å¿…é¡»åœ¨****æ•°æ®åº“ä¸­å­˜å‚¨**ç”¨æˆ·å**å’Œ**åˆ†æ•°**ã€‚å› æ­¤ï¼Œæ¯å½“æ¸¸æˆç»“æŸæ—¶ï¼Œæˆ‘ä»¬ä¼šå°†è¿™äº›æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œç„¶åæ£€ç´¢æ•´ä¸ªæ•°æ®ï¼Œè¿™äº›æ•°æ®å°†è¢«æ’åºå¹¶æ˜¾ç¤ºåœ¨æ’è¡Œæ¦œä¸Šã€‚æ²¡é‚£ä¹ˆç®€å•ã€‚è®©æˆ‘ä»¬ç°åœ¨å°±å®æ–½å§ğŸ˜ƒã€‚****

## ******ç¼–å†™ PHP è„šæœ¬******

****æ‚¨éœ€è¦æœ‰ä¸€äº›åç«¯è„šæœ¬çš„æƒ³æ³•ğŸ˜‰ã€‚****

****æˆ‘ä»¬å°†ç¼–å†™ä¸¤ä¸ª PHP æ–‡ä»¶ã€‚****

*   ****`*data.php*` ç”¨äº**å‘é€**å’Œ**æ£€ç´¢**æ•°æ®****
*   ****`update.php`ç”¨äº**æ›´æ–°**æ¯å½“ç©å®¶å–å¾—å±€éƒ¨é«˜åˆ†æ—¶çš„åˆ†æ•°ã€‚****

****`data.php`:****

****æˆ‘ä»¬å°†å£°æ˜ä¸€äº›åœ¨ä»£ç ä¸­ä½¿ç”¨çš„åŸºæœ¬å˜é‡ã€‚****

```
**$servername = "host_name";
$dbname = "dabase_name";
$username = "username";
$password = "database_password";
$playername = $_POST["playernamePost"];
$score = $_POST["scorePost"];**
```

****`$playername`è¯¥å˜é‡ç”¨äºå­˜å‚¨æ¸¸æˆåº”ç”¨ç¨‹åºå‘é€çš„ç”¨æˆ·åã€‚`$_POST["playernamePost"]`è¿™æ˜¯ä¸€ä¸ªç‰¹å®šçš„åŠ¨ä½œï¼Œå®ƒè¡¨ç¤ºå°†è·å–å­˜å‚¨åœ¨å˜é‡`playernamePost`ä¸­çš„æ•°æ®ï¼Œè¯¥å˜é‡æ˜¯ç”±æŸä¸ªæœªçŸ¥æ¥æºå‘é€çš„ã€‚è™½ç„¶è¿™å¹¶ä¸å®‰å…¨ï¼Œä½†æˆ‘ä»¬å°†åªç ”ç©¶åŸºæœ¬çš„å®ç°ã€‚è¿™åŒæ ·é€‚ç”¨äº`$score`å˜é‡ã€‚****

****æ¥ä¸‹æ¥ï¼Œè¿æ¥æ•°æ®åº“****

```
**$db = mysqli_connect($servername, $username,$password, $dbname);**
```

****ä¸€æ—¦è¿æ¥æˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ä½¿ç”¨ *SQL* æŸ¥è¯¢æˆ‘ä»¬çš„æ•°æ®ã€‚****

```
**$sql = " SELECT * FROM data ORDER BY score";
$push = "INSERT INTO data ( name, score) VALUES ('".$playername."','".$score."')";**
```

****`$sql`è¯¥å˜é‡ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜å‚¨ *SQL* æŸ¥è¯¢(æ•°æ®æ£€ç´¢)ã€‚`$push`è¯¥å˜é‡å†æ¬¡ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜å‚¨ *SQL* æŸ¥è¯¢ *(* æ•°æ®æ¨é€åˆ°æ•°æ®åº“)ã€‚æ‚¨éœ€è¦å¯¹ SQL æŸ¥è¯¢è¯­å¥æœ‰æ‰€äº†è§£ï¼Œæ¯”å¦‚`SELECT`ã€`INSERT`ç­‰ç­‰â€¦â€¦å¯¹æ•°æ®åšäº†ä»€ä¹ˆã€‚å°½ç®¡å®ƒä»¬å¾ˆå®¹æ˜“ç†è§£ğŸ˜œã€‚`name`å’Œ`score`æ˜¯æˆ‘ä»¬æ•°æ®åº“è¡¨çš„åˆ—ã€‚`data`æ˜¯è¡¨åã€‚`ORDER BY`è¿™æ˜¯ç”¨æ¥å¯¹æˆ‘ä»¬çš„æ•°æ®è¿›è¡Œæ’åºçš„ï¼Œä¸éœ€è¦ä¸ºæˆ‘ä»¬çš„æ•°æ®ç¼–å†™å•ç‹¬çš„æ’åºç®—æ³•ã€‚æˆ‘å»ºè®®ä½ é¿å…ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒæ•ˆç‡ä¸é«˜ã€‚****

****è®©è¿™äº›æŸ¥è¯¢èµ·ä½œç”¨****

```
**$retrieval = mysqli_query($db, $sql);
$pushdata = mysqli_query($db,$push);**
```

****å°†å˜é‡ä½œä¸ºå‚æ•°å‘é€ç»™`mysqli_query`å‡½æ•°å°†å®Œæˆæˆ‘ä»¬çš„å·¥ä½œã€‚****

****æ‚¨å¯èƒ½ä¼šæƒ³æˆ‘ä»¬çš„æ¸¸æˆåº”ç”¨ç¨‹åºå°†å¦‚ä½•è·å–æ•°æ®ã€‚è¿™å¾ˆç®€å•ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰æ•°æ®ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²æ‰“å°åˆ°æˆ‘ä»¬çš„ PHP æ–‡ä»¶ä¸­ã€‚ç¨åï¼Œæˆ‘ä»¬å°†æ£€ç´¢æ•°æ®ä½œä¸ºä¸€ä¸ªå•ä¸€çš„å­—ç¬¦ä¸²ï¼Œå¹¶åšä¸€äº›å­—ç¬¦ä¸²å¤„ç†çš„ä¸œè¥¿ï¼ŒæŠŠå®ƒæ”¾åœ¨æˆ‘ä»¬çš„æ’è¡Œæ¦œã€‚****

```
**while ($row = mysqli_fetch_assoc($retrieval))
{
echo";".$row['name'].":".$row['score']."";
}**
```

****æˆ‘ä»¬å°†ä½¿ç”¨`mysqli_fetch_assoc($retrieval)`å°†æ•°æ®æå–åˆ°å•ä¸ªå˜é‡`$row`ä¸­ï¼Œç„¶åä½¿ç”¨ while å¾ªç¯æ‰“å°å®Œæ•´çš„æ•°æ®ã€‚æˆ‘ä»¬å®Œæˆäº†`data.php`****

****ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`data.php`æ–‡ä»¶æ£€ç´¢å’Œæ¨é€æ•°æ®ã€‚ç°åœ¨å½“ä½ è¦åœ¨ç©å®¶æ‰“å‡ºé«˜åˆ†çš„æ—¶å€™æ›´æ–°ä»–çš„åˆ†æ•°ï¼Œé‚£ä¹ˆä½ å°±è¦ç”¨è¿™ä¸ª`update.php`è„šæœ¬äº†ã€‚è¿™ä¸æ‚¨ç®€å•åœ°ä½¿ç”¨æ›´æ–°æŸ¥è¯¢éå¸¸ç›¸ä¼¼ã€‚****

****`update.php`****

```
**$servername = "host_name";
$dbname = "database_name";
$username = "username";
$password = "password";$playername = $_POST["playernamePos"];
$score =$_POST["scorePos"];
$db = mysqli_connect($servername, $username,$password, $dbname);
$update = "UPDATE data SET score='$score' WHERE name='$playername'";
$result = mysqli_query($db,$update);**
```

****æ‚¨å¯ä»¥åœ¨ç”¨æˆ·åçš„å¸®åŠ©ä¸‹æ‰¾åˆ°ç‰¹å®šçš„åˆ—ï¼Œç„¶åæ›´æ–°ç›¸åº”çš„é«˜åˆ†ã€‚****

****æˆ‘ä»¬å·²ç»å®Œæˆäº† PHP æ–‡ä»¶çš„ç¼–å†™ã€‚ç°åœ¨è®©æˆ‘ä»¬ç¼–å†™ *C#* è„šæœ¬æ¥è¿æ¥åº”ç”¨ç¨‹åºå’Œåç«¯ã€‚****

## ****åœ¨ Unity3D ä¸­ç¼–å†™ C#è„šæœ¬****

****æ‚¨éœ€è¦ç†Ÿæ‚‰ *unity3D* æ–‡æ¡£ğŸ˜œã€‚****

****`retrieval.cs`****

```
**public string url = "www.somecloudstorage.com/data.php";
IEnumerator Start () 
{       
WWW retrieve = new WWW(url); 
yield return retrieve;  
string fulldata = retrieve.text;  
users = fulldata.Split(';');  
int n =0;  
list.text = "";  
for (int i = users.Length-1; i>=0; i--)
{ 
n++;
if (users[i] != "->0" && !(users[i].StartsWith("<")))
{   
items = users[i].Split(':');
list.text = list.text+ "\n"+n+".  "+ items[0];   
list2.text = list2.text + "\n" + items[1];  
}}}**
```

****`IEnumarator`åœ¨è¿™é‡Œéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›ç¨‹åºæš‚åœæ‰§è¡Œï¼Œç›´åˆ°æˆ‘ä»¬çš„å…¨éƒ¨æ•°æ®ä» *PHP* æ–‡ä»¶ä¸­åŠ è½½å®Œæ¯•ã€‚æˆ‘ä»¬å¯¹é‚£ä¸ªç‰¹å®šçš„ *PHP æ–‡ä»¶å‘å‡ºä¸€ä¸ª *HTTP* è¯·æ±‚ã€‚æˆ‘ä»¬é€šè¿‡åˆ›å»ºä¸€ä¸ª`WWW`å¯¹è±¡å¹¶å‘é€æ‰€éœ€çš„ *URL æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚*ç„¶åæˆ‘ä»¬ä¼šä¸€ç›´ç­‰åˆ°æ•°æ®åŠ è½½å®Œæ¯•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`retrieve.text` *å°†æ•°æ®ä½œä¸ºå•ä¸ªå­—ç¬¦ä¸²è®¿é—®(éœ€è¦æ—¶æŸ¥çœ‹ Unity3D æ–‡æ¡£)ã€‚* Rest å¾ˆç®€å•ï¼Œæˆ‘ä»¬åšä¸€äº›å­—ç¬¦ä¸²å¤„ç†å·¥ä½œï¼Œä»¥æœŸæœ›çš„å½¢å¼æ£€ç´¢å®ƒã€‚*****

****æˆ‘ä»¬èƒ½å¤Ÿæ£€ç´¢æ•°æ®ï¼Œè¿™æ˜¯å°èœä¸€ç¢Ÿï¼Œæ²¡é”™ï¼ï¼ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å°†æ•°æ®ä»æ¸¸æˆåº”ç”¨ç¨‹åºæ¨é€åˆ°æ•°æ®åº“ã€‚****

****`push_highscore.cs`****

```
**public string url = "www.somecloudstorage.com/data.php";
public void pushData(string username, int highscore) 
{
WWWForm form = new WWWForm ();
form.AddField("playernamePos",username);  form.AddField("scorePos",highscore);
WWW push_Data = new WWW(url,form);
}**
```

****è¿™å‡ è¡Œ *PHP* ä»£ç å°†å®Œæˆæˆ‘ä»¬çš„å·¥ä½œã€‚â­ï¸ï¼Œè®°ä½æˆ‘ä»¬ä½¿ç”¨ Unit3D å®˜æ–¹æ–‡æ¡£æ¥å®ç°è¿™ä¸ªï¼Œæ‰€ä»¥ä½ å¿…é¡»å¯¼å…¥å¿…è¦çš„åŒ…ã€‚****

****å‡ ä¹ä»€ä¹ˆéƒ½åšå¥½äº†ï¼ï¼ä½†æˆ‘ä¸ä¼šè°ˆè®ºä½ å°†å¦‚ä½•æ›´æ–°åˆ†æ•°ã€‚äº«å—è‡ªå·±å®ç°å®ƒçš„ä¹è¶£ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¹Ÿèƒ½åšåˆ°ğŸ˜œã€‚****

****å°†æ‚¨çš„æ•°æ®è½¬å‚¨åˆ°äº‘ç©ºé—´æ˜¾ç„¶æ˜¯å¿…è¦çš„ã€‚ä½ å¯èƒ½ä¼šåœ¨å¸‚åœºä¸Šæ‰¾åˆ°å¾ˆå¤šäº‘ç©ºé—´æä¾›å•†ï¼Œè½¬å‚¨ä½ çš„åç«¯ä»£ç ( *PHP* æ–‡ä»¶)ï¼Œæ•°æ®åº“æ–‡ä»¶(ã€‚sql æ–‡ä»¶)å¹¶æ­£ç¡®é…ç½®æ‚¨çš„ PHPMyAdminã€‚å°±è¿™æ ·ï¼Œä½ å®Œäº†ï¼ï¼ğŸ‰****

# ****ç»“è®º****

****å°±æ˜¯è¿™æ ·ï¼Œè¿™æ˜¯å®ç°ä¸€ä¸ª*æ’è¡Œæ¦œ*å’Œä½¿ç”¨ *PHP* å’Œ *MySQL* ä¸ºä½ çš„æ¸¸æˆåº”ç”¨ç¼–å†™ä½ è‡ªå·±çš„åç«¯çš„åŸºæœ¬æ–¹æ³•ğŸ‘‹ã€‚****

****ğŸŒŸè¯·è®°ä½ï¼Œè¿™æ ¹æœ¬ä¸æ˜¯ä¸€ç§ä¸ºæ¸¸æˆåº”ç”¨ç¨‹åº(äº§å“)å®ç°æ’è¡Œæ¦œçš„å®‰å…¨æ–¹å¼ã€‚è¿™åªæ˜¯ä¸ºäº†è®©ä½ ç«™èµ·æ¥å¼€å§‹ã€‚ğŸŒŸ****

****ä½ å¯ä»¥åœ¨ [GitHub](https://github.com/kmehant) ã€ [Twitter](https://twitter.com/mehant1) ã€ [LinkedIn](https://www.linkedin.com/in/mehant-kammakomati-1a0b41170/) âœ¨âœ¨æ‰¾åˆ° Mehant Kammakomati****