# 股权证明(POS)优于比特币的工作证明(POW)

> 原文：<https://medium.com/hackernoon/is-bft-consensus-effective-for-proof-of-stake-blockchain-implementations-dc01f429d225>

股权证明(POS)模型在区块链共识设计中越来越受欢迎，特别是随着以太坊(按市值计算的第二大加密货币)的“Casper”升级正在进行中。是的，直接原因是它比工作验证(POW)更节能(降低计算成本),而工作验证是高度资源密集型的，但还有更多。

一般来说，POS 采用个人数字签名来证明网络根据其比例股份选择的股份的所有权，以便验证提交给数据库的消息和交易。如果我们更深入地观察，有两种主要模式属于这一类别:

1.  **基于链条的**；其提供“可用性”,因为在设定的时隙期间随机选择验证器来创建块，该验证器指向前一个块，使得随着时间的推移，这些块汇聚成一个增长链。这种类型更有利于“无许可”的方法。实施这一模式的著名区块链项目有 Nxt、Peercoin 和 Ardor。
2.  **联盟共识**——拜占庭容错(BFT)协议:该协议提供了“一致性”,因为为每轮随机选择的验证者最终同意该块是否成为链的一部分。这种类型可能更有利于“许可”的方法。用于 Neo、Tendermint、Polkadot、Hyperledge 织物。

上周，BFT 共识算法成为业内的热门话题，因为近地天体区块链在网络中的一个断开节点面前停止运行，让其他节点等待回复。这个问题是通过“强制改变视图”解决的，即重新启动所有节点，这提出了一个集中化的问题，因为权力仍然在近地天体手中。该问题随后导致网络中的数据块生成时间增加，由于节点同步问题，网络中的事务要花费更长的时间。这个问题看起来很有趣，对于测试这种共识模型变体的所有其他项目来说，这是一条有价值的学习曲线。设计的想法是在网络中有许多节点(比如说一百个),以便保持“分散”的概念，并且没有单点故障，以确保这样的问题不会发生。NEO 只有大约 10 个“簿记节点”,更像是一个“集中式”设计。这一事实完全在意料之中，因为 NEO 是中国的区块链经济，得到了中国政府的认可，所以完全有道理。这可以说是它吸引如此多公司的最大原因。

# 那么什么是 BFT 呢？

BFT 是分布式计算中的一个流行协议，自 1978 年(由 Leslie Lamport 首次提出)以来一直被研究。到目前为止，它已经有超过 700 个协议，以及开源实现。这是一个非常受欢迎的模型，用于像谷歌这样的大型“集中式”公司的共识，但它现在也是区块链项目中的一个受欢迎的选择，因为它旨在解决可扩展性问题。使用 BFT 协议的流行项目包括 Hyperledger Fabric、Tendermint、Polkadot、NEO 等。

就共识而言，关键是当涉及网络上不诚实和有缺陷的节点时，如何保证容错，因为攻击和软件错误是常见的，导致节点表现出任意行为(拜占庭故障)，最好将其描述为“将军的问题”的类比。Miguel Castro 和 Barbra Liskov 推出的“实用拜占庭容错”(PBFT)算法提供了高性能的拜占庭状态机复制，每秒处理数千个请求，延迟增加到亚毫秒级。这提供了类似上面提到的“一致性”的优点，因为在生成块之前，验证器节点应该达成一致。另一个优点是，它确保了结算的“最终性”，将结算时间从目前的几十秒钟缩短到几十分钟，缩短到 1 秒钟以内，同时大幅降低了能耗。BFT 式共识模型最适合大多数金融机构青睐的区块链财团。

随着去中心化，出现了比特币那样的性能权衡。BFT 提供了一种更有效的共识协议，以更少的计算、带宽和存储实现了更好的延迟和吞吐量。具体地，使用具有少量预先指定的可信实体/节点的标准 BFT 协议。“即使有几十个节点，PBFT 在交易延迟和吞吐量方面都大大优于比特币。例如，处理 8192 个事务的 64 个节点可以实现 4.5K tx/sec 的吞吐量。，平均事务延迟为 1.79 秒。，每笔交易的估计资源成本仅为 3.95 美元×10–7 英寸(1)。该模型包括一组指定的同构确认器节点，它们容忍 n 个故障节点中的 f 个。在这个模型中，事务被发送到共识节点进行验证。节点验证事务并做出决定，然后传播结果。在每一轮验证后，从节点中删除数据，以免阻塞系统。该协议可以定制为“受控成员”模式，其中通常有一个控制成员的中央实体(在金融机构/政府和一些私营公司的情况下是有益的)。它还可以具有更“动态的成员资格”,这在决定成员资格的协议本身中是不同的。

# BFT 和区块链

BFT 协议通常假设同步或弱同步性质，即它们依赖于先验节点和网络定时假设，并且仅当网络如预期那样运行时才确保活跃度。因此，在分散式区块链实现的情况下，有一种观点认为这些协议存在缺陷，并且应该表现出更多的异步性质，以便在不依赖于节点和定时假设的情况下保证活性。有人认为这可以显著提高可伸缩性的事务吞吐量。下图显示了不同类型的 BFT 协议如何实现可扩展性以及实现的程度，显示并行 BFT 实现了高性能，吞吐量接近 100，000 tx/s。

![](img/6faa4fc83d47c2165fe478439397b05d.png)

Scalability/ Performance Tradeoff (M. Vukolic: The Quest for Scalable Blockchain Fabric: Proof-of-Work vs. BFT Replication)

**平行共识**

并行 BFT 通过任命多个领导者来并行处理请求，而不是基本 BFT 协议中的单个领导者。这允许实现高吞吐量和可伸缩性。“Sarek”是一个并行排序框架，它对服务状态进行划分，以便在协定和执行期间利用并行性。区块链的 Sarek 实现会很有趣。对于整个系统来说，不是每次只有一个领导者，而是每个分区使用一个领导者，并且只对访问同一个分区的请求建立一个顺序。Sarek 还支持跨多个分区的操作，并提供一种确定性机制来自动处理这些操作。根据 Sarek (2)的说法，与单领导实施相比，这确保了吞吐量性能提高 2 倍，延迟减半。通过 Sarek，可以同时运行多轮共识。

**异步 BFT**

在异步设置中，消息在没有计时假设的情况下被传递到不同的节点。这些设置被认为是不切实际的，因为它们限制了网络中的吞吐量。解决这个问题的尝试是通过引入“公平”(3)，即审查弹性，来解决冗余工作，这仍然允许有针对性的审查攻击。然而，A. Miller 等人(4)的新研究表明，通过使用门限公钥加密，可以防止这些攻击风险。

异步 BFT 特别适合于区块链实现，因为在该领域中，带宽是稀缺资源，并且计算量很大，这意味着可以使用像门限公钥加密这样的加密元素，否则这些元素是昂贵的(在经典的容错数据库设置中)，因此攻击减少了。在这种情况下，即使在不一致的情况下(在标准 BFT 设置中),消息也最终被传递，而不是以最小化响应时间为目标，同时不做任何时间假设。不管网络条件如何波动，吞吐量总是跟踪网络的可用带宽。通过实验，该设置已经证明了比 PBFT 协议更好的吞吐量，并且已经证明了安全性和活性(4)。该解决方案涉及“批处理”过程，即创建多方节点池，以提供更高的效率并降低成本，同时使用阈值加密来保持审查弹性。

# 结论

当谈到将 POS 模型与第一个区块链共识模型(基于 Adam Back 的 Hashcah POW 函数(1997 年),比特币的工作证明(POW ))进行比较时，首先值得记住的是，有如此多的 POS 变体，包括那些 BFT 风格的，因此这不是一个类似的比较，一般的比较是不够的。

反对 POS 的一个最常见的论点是“磨桩”的问题，即回合操纵(为了制造方块和赢得奖励)。这可以通过使用为下一个块创建者生成密钥值的门限签名方案来解决。此外，当不诚实或任意节点在多个链上创建块时，会出现“无关紧要”的问题，这可以通过惩罚措施(如释放存款)来解决。

也许，主要的问题可能是哪种模式最适合未来的连锁店，可扩展性？在这种情况下，基于 POS、BFT 的模型需要最少的存储空间，因为需要更少的工作，即(签名),这是由于达成共识所涉及的节点必须在实际生成块之前达成一致，因此具有很强的终结性保证。这意味着交易不会给区块链带来太多负担。此外，上面提到的基本 BFT 协议在交易吞吐量和延迟方面都优于比特币，更不用说资源成本了。让我们以通过 pBFT 协议(39.4 美元)和通过 POW 比特币挖矿(在美国平均为 5000 美元，在韩国最高可达 26000 美元)进行交易的资源成本比较来结束。

> 1.Croman，Kyle 等人，“关于扩大分散的区块链—(立场文件)”，金融密码学研讨会(2016 年)。
> 
> 2.李，毕军等，“SAREK:拜占庭容错中的乐观并行排序”，2016 第 12 届欧洲可信计算大会(EDCC) (2016)。
> 
> 3.Koblitz，Neal 等人，“椭圆曲线密码学的现状”，Des。密码密码术 19 (2000)。
> 
> 4.BFT 协议中的蜜獾 IACR 密码学 ePrint 档案(2016)。