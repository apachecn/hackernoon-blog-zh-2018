# æé«˜æ€§èƒ½çš„ JavaScript åœ°å›¾

> åŸæ–‡ï¼š<https://medium.com/hackernoon/javascripts-maps-for-better-performance-bbebb987c997>

## å±•ç¤º JavaScript åœ°å›¾æ€§èƒ½çš„å…·ä½“ä¾‹å­ã€‚

> æœ¬æ–‡ä¸æ‰“ç®—è¯¦ç»†æ¢ç©¶åœ°å›¾å¯¹è±¡çš„ APIã€‚å¦‚æœä½ æ­£åœ¨å¯»æ‰¾è¿™æ ·çš„èµ„æºï¼Œè¯·æŸ¥çœ‹ [MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) ã€‚

*æœ¬æ–‡åŸè½½äº*[*Tinloof*](https://tinloof.com/blog/java-scripts-maps-for-better-performance/)*ã€‚*

é€šå¸¸ï¼Œå½“æˆ‘ä»¬æƒ³è¦é€šè¿‡ä¸€ç»„å”¯ä¸€çš„é”®æ¥æ£€ç´¢/æ·»åŠ /åˆ é™¤å€¼æ—¶ï¼ŒMap æ•°æ®ç»“æ„æ˜¯æœ‰ç”¨çš„ã€‚

ä¸å…¶ä»–è¯­è¨€ä¸­çš„å®ç°ç›¸æ¯”ï¼ŒJavaScript Map æ•°æ®ç»“æ„çš„ä¸€ä¸ªç‹¬ç‰¹ä¹‹å¤„åœ¨äºå®ƒè®°ä½äº†é”®çš„æ’å…¥é¡ºåºã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»”ç»†ç ”ç©¶æ˜¯ä»€ä¹ˆä½¿å¾—è¿™ä¸ªç‰¹æ€§éå¸¸æœ‰ç”¨ï¼Œä»¥åŠä¸ºä»€ä¹ˆåœ¨æŸäº›æƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨ map è€Œä¸æ˜¯å…¶ä»–æ•°æ®ç»“æ„ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ„å»ºè´­ç‰©ç¯®æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚

# é—®é¢˜:æ„å»ºè´­ç‰©ç¯®

æœ€åˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè´­ç‰©æ¸…å•å’Œä¸€ä¸ªç©ºè´­ç‰©ç¯®ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
// initial shop_itemsshop_items: [ { *value*:"ğŸ‘•", *stock*:10 }, { *value*:"ğŸ‘–", *stock*:10 }, { *value*:"ğŸ‘", *stock*:10}]// initial empty shopping_basketshopping_basket: empty
```

æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå°†å•†å“æ·»åŠ åˆ°æˆ‘ä»¬çš„è´­ç‰©ç¯®ä¸­ï¼Œå¹¶å°†å…¶æ”¾å›åŸå¤„ã€‚

å°†å•†å“æ·»åŠ åˆ°è´­ç‰©ç¯®åº”è¯¥:

*   å‡å°‘è¯¥ç‰¹å®šé¡¹ç›®çš„åº“å­˜ã€‚
*   å¦‚æœè¯¥é¡¹ç›®ä»æœªè¢«æ·»åŠ åˆ°è´­ç‰©ç¯®ä¸­ï¼Œå®ƒåº”è¯¥å°†å®ƒæ·»åŠ åˆ°è®¡æ•°ä¸º 1 çš„è´­ç‰©ç¯®ä¸­
*   å¦‚æœè¯¥é¡¹ç›®å·²ç»å­˜åœ¨äºè´­ç‰©ç¯®ä¸­ï¼Œå®ƒåº”è¯¥å¢åŠ å®ƒåœ¨è´­ç‰©ç¯®ä¸­çš„è®¡æ•°ã€‚

å°†å•†å“é€€å›å•†åº—å•†å“åº”:

*   å¢åŠ è¯¥ç‰¹å®šé¡¹ç›®çš„åº“å­˜ã€‚
*   å¦‚æœé¡¹ç›®åœ¨è´­ç‰©ç¯®ä¸­çš„è®¡æ•°å¤§äº 1ï¼Œå®ƒåº”è¯¥å‡å°‘å®ƒçš„è®¡æ•°ã€‚
*   å¦‚æœè¯¥é¡¹ç›®åœ¨è´­ç‰©ç¯®ä¸­çš„è®¡æ•°ä¸º 1ï¼Œåˆ™åº”è¯¥å°†å…¶ä»è´­ç‰©ç¯®ä¸­ç§»é™¤ã€‚

é¢å¤–è¦æ±‚:æˆ‘ä»¬éœ€è¦ç¡®ä¿è´­ç‰©ç¯®ä¸­çš„é¡¹ç›®æŒ‰ç…§å®ƒä»¬è¢«æ’å…¥çš„é¡ºåºä¿å­˜ã€‚

# ä½¿ç”¨æ•°ç»„çš„è§£å†³æ–¹æ¡ˆ

é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨è´­ç‰©ç¯®ä½œä¸ºæ•°ç»„æ¥è§£å†³å®ƒã€‚

æœ€åˆï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹å†…å®¹:

```
// *initial shop_items*letshop_items=[ { *value*:"ğŸ‘•", *stock*:10}, { *value*:"ğŸ‘–", *stock*:10}, { *value*:"ğŸ‘", *stock*:10}];// *initial empty shopping_basket*letshopping_basket=[];
```

ç„¶åï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°`addToBasket`,å°†å•†åº—å•†å“ä¸­çš„ä¸€ä¸ªç‰¹å®šå•†å“æ·»åŠ åˆ°è´­ç‰©ç¯®ä¸­:

è®©æˆ‘ä»¬ä¹Ÿæ·»åŠ ä¸€ä¸ª`removeFromBasket`å‡½æ•°æ¥ç§»é™¤å°†å•†å“ä»è´­ç‰©ç¯®æ”¾å›å•†åº—å•†å“åˆ—è¡¨:

æµ‹è¯•æˆ‘ä»¬çš„å®ç°ç»™å‡ºäº†ä»¥ä¸‹ç»“æœ:

```
// *(1)*addToBasket("ğŸ‘•");
addToBasket("ğŸ‘•");// Output:shop_items: [ { *value*:"ğŸ‘•", *stock*: *8*}, { *value*:"ğŸ‘–", *stock*:10 }, { *value*:"ğŸ‘", *stock*:10}]shopping_basket: [ { *value*:"ğŸ‘•", *count*: *2 }* ]// *(2)*addToBasket("ğŸ‘");// Output:shop_items: [{ *value*:"ğŸ‘•", *stock*: *8*},{ *value*:"ğŸ‘–", *stock*:10 },{ *value*:"ğŸ‘", *stock*:}]shopping_basket: [ { *value*:"ğŸ‘•", *count*: *2*}, { value: "ğŸ‘", count: 1}]// ------------------------------------ //// *(3)*removeFromBasket("ğŸ‘•");// Output:shop_items: [ { *value*:"ğŸ‘•", *stock*: *9*}, { *value*:"ğŸ‘–", *stock*:10 }, { *value*:"ğŸ‘", *stock*: *9*}]shopping_basket: [ { *value*:"ğŸ‘•", *count*: *1*}, { value: "ğŸ‘", count: 1}]// ------------------------------------ //// *(4)*removeFromBasket("ğŸ‘");// Output:shop_items: [ { *value*:"ğŸ‘•", *stock*: *9*}, { *value*:"ğŸ‘–", *stock*:10 }, { *value*:"ğŸ‘", *stock*: *10*}]// initial empty shopping_basketshopping_basket: [ { *value*:"ğŸ‘•", *count*: *1*} ]
```

é‚£ä¹ˆï¼Œæˆ‘ä»¬çš„å®ç°èµ·ä½œç”¨äº†å—ï¼Ÿï¼é‚£è¿˜æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼ŸğŸ¤”

å¦‚æœæˆ‘ä»¬ä»”ç»†çœ‹çœ‹æˆ‘ä»¬çš„ä¸¤ä¸ªæ›´æ–°å‡½æ•°ï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ°æˆ‘ä»¬åœ¨æœç´¢è´­ç‰©ç¯®ä¸­çš„å•†å“æ—¶ä½¿ç”¨äº†`findIndex`ã€‚è¿™å¯¼è‡´ O(N)çš„çº¿æ€§æ—¶é—´å¤æ‚åº¦ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†åœ¨åŒä¸€ä¸ªå‡½æ•°ä¸­éå†æ•´ä¸ªå•†åº—å•†å“åˆ—è¡¨å’Œè´­ç‰©ç¯®ä¸¤æ¬¡ã€‚

åœ¨å½“å‰çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä¸¤è€…çš„å¤§å°éƒ½éå¸¸å°ï¼Œå¹¶ä¸”ä¸¤ä¸ªå‡½æ•°çš„ä½¿ç”¨éƒ½éå¸¸ç®€å•ï¼Œè¿™å®é™…ä¸Šä¸ä¼šå¯¼è‡´ä»»ä½•æ€§èƒ½é—®é¢˜ã€‚ç„¶è€Œï¼Œè¿™å¹¶ä¸æ€»æ˜¯æˆæ¯”ä¾‹çš„ã€‚å¦‚æœæˆ‘ä»¬å°†å‡½æ•°åµŒå¥—åœ¨å¦ä¸€ä¸ªå¾ªç¯ä¸­ï¼Œå¤æ‚åº¦å¾ˆå®¹æ˜“å¢é•¿åˆ° O(n)ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ°å›¾å¯ä»¥è§£å†³æˆ‘ä»¬çš„é—®é¢˜:

*   æ·»åŠ /æ£€ç´¢/åˆ é™¤é¡¹ç›®çš„å¤æ‚åº¦æ˜¯å¸¸æ•° O(1)ã€‚
*   å®ƒæœ‰æ›´å¤šçš„å¯è¯»å’Œåˆé€‚çš„åŠŸèƒ½æ¥æ·»åŠ /æ£€ç´¢/åˆ é™¤é¡¹ç›®ã€‚

æœ€åˆï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹å†…å®¹:

```
// *initial shop_items*letshop_items=[ { *value*:"ğŸ‘•", *stock*:10}, { *value*:"ğŸ‘–", *stock*:10}, { *value*:"ğŸ‘", *stock*:10}];// *initial empty shopping_basket*letshopping_basket= *new Map()*;
```

ç„¶åè®©æˆ‘ä»¬é‡æ„`addToBasket`å‡½æ•°:

è®©æˆ‘ä»¬ä¹Ÿé‡æ„ä¸€ä¸‹`removeFromBasket`å‡½æ•°:

å¦‚æœæˆ‘ä»¬å†åšä¸€æ¬¡æµ‹è¯•ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°åŒæ ·çš„ç»“æœã€‚

# ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨å¯¹è±¡å‘¢ï¼Ÿ

æœ‰äººå¯èƒ½ä¼šè®¤ä¸ºï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å¯¹è±¡è€Œä¸æ˜¯åœ°å›¾ï¼Œä¹Ÿå¯ä»¥å®ç°å‰é¢çš„æ€§èƒ½ã€‚

`addToBasket`çš„å®ç°å¦‚ä¸‹æ‰€ç¤º:

`removeFromBasket`çš„å®ç°å¦‚ä¸‹æ‰€ç¤º:

å°½ç®¡è¿™ç§å®ç°ä¹Ÿå¯ä»¥å·¥ä½œï¼Œä½†æ˜¯å®ƒæœ‰ä»¥ä¸‹é—®é¢˜:

*   æ ¹æ® [MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) ï¼Œå¯¹è±¡é”®ä¸ä¸€å®šæ˜¯æœ‰åºçš„ã€‚
*   åˆ é™¤æ“ä½œä¸å…·æœ‰å¸¸æ•°å¤æ‚åº¦ O(1)ï¼

# æŠŠå®ƒåŒ…èµ·æ¥ğŸ™Œ

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ç†è§£ JavaScript Maps çš„æ€§èƒ½ä¼˜åŠ¿éå¸¸æœ‰ç”¨ã€‚å¸Œæœ›è¿™èƒ½æ¿€åŠ±ä½ åœ¨ç±»ä¼¼çš„ç”¨ä¾‹ä¸­ä½¿ç”¨å®ƒä»¬ã€‚

å¦‚æœä½ æœ‰ä»»ä½•åé¦ˆæˆ–é—®é¢˜ï¼Œæˆ‘ä¹Ÿå¾ˆä¹æ„å¬åˆ°ã€‚

*å¯ä»¥æ‰¾åˆ°æ›´å¤šå…³äº*[*Tinloof*](https://tinloof.com/blog)*çš„æ–‡ç« ã€‚*

> ***é™„è¨€:*** *ä½ å¯ä»¥åœ¨æ¨ç‰¹ä¸Šæ‰¾åˆ°æˆ‘*[*@ seif _ ghe zala*](http://twitter.com/seif_ghezala)*:)*

![](img/c5be5636d30577bee9d6483580dc1bff.png)