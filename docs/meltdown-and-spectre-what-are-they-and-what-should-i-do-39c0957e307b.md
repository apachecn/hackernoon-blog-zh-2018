# Meltdown 和 Spectre:它们是什么，我该怎么办？

> 原文：<https://medium.com/hackernoon/meltdown-and-spectre-what-are-they-and-what-should-i-do-39c0957e307b>

![](img/4cdef980bcbefc1d4da20d94c78e00f0.png)

Example code demonstrating the Meltdown attack ([http://meltdownattack.com/](http://meltdownattack.com/))

一夜之间，一项协调的披露披露了影响全球几乎所有计算机用户的两大漏洞的细节。此前几天，网上出现了越来越多的猜测，原因是一个无法解释的 bug 修复基准据报道导致了 5%到 30%的性能损失，具体取决于手头的任务。

这些漏洞是由来自谷歌 Project Zero、德国安全公司 Cyberus Technology 和全球几所大学的独立研究团队发现的，这些漏洞被称为 [Meltdown](https://hackernoon.com/tagged/meltdown) 和 Spectre，部分原因是它们的严重性和普遍性。

如果你拥有一台电脑、手机或任何其他在过去 20 年制造的设备，这很可能会影响到你。好消息是，帮助减轻这些漏洞影响的更新现在正在推出，并将在未来几周内继续推出。坏消息是，在一定程度上，这些攻击利用了现代处理器的基础架构，因此很可能需要全新的硬件来彻底修复它。

现在，你能做的最好的保护自己的事情就是尽快安装你的操作系统、网络浏览器和其他关键软件的更新。无论如何，我们都应该定期更新我们的软件，但这并不总是如此，正如我们在 2017 年看到的 WannaCry 勒索软件攻击一样，这一事件本来可以通过一个已发布近 2 个月的 Windows 漏洞修复程序轻松阻止。预计类似的故事将在未来几个月再次上演，因为恶意行为者会利用那些没有更新系统的人。

我会在页脚包含相关更新的链接，并会随着更多信息的出现而努力更新此列表。

那么，了解了这些之后，这些攻击到底是什么，它们是如何工作的呢？

Meltdown 和 Spectre 的核心是允许攻击者访问他们通常无法访问的计算机内存。此外，专门影响几乎所有英特尔处理器的 Meltdown 漏洞允许任意访问“受保护”的内存，这一结果从根本上破坏了现代操作系统中的安全系统。使用这种不受限制的内存访问，攻击者可以轻松读取密码和其他敏感数据，这些数据以前被认为是安全的，不会被窥探，尽管根据当前的最佳实践，它们是“安全的”。

Proof of concept using Meltdown to reveal passwords

为了做到这一点，Meltdown 和 Spectre 都利用了推测执行，这是 90 年代引入的一项功能，处理器使用它来加速程序的执行。为了试着解释这是如何工作的，想象你和一个朋友正在穿越丛林，你到达了一个岔路口。你不确定你需要向左还是向右走，所以你的朋友拿出一张地图，试图找出你在哪里，你应该走哪条路。现在，了解你的朋友，这可能需要一段时间才能得到答案，你一直遵循的轨道需要你在前进的路上清除树枝。没有投机执行，你会和你的朋友呆在一起，直到你知道正确的路要走，但在你看来，那只是浪费时间。相反，作为一个不耐烦的投机执行者，你决定正确的道路很有可能是右边的那条，所以当你的朋友还在岔路口忙碌的时候，你已经在前面开路了。这可能被证明是错误的路径，在这种情况下，你可以沿着清理过的轨道快速跑回到岔路口，并与你的朋友走另一条路径，在你走的时候清理它，就像你只是等待一样。或者它可能是正确的路径，在这种情况下，你可以通过提前清理轨道来节省时间，而你的朋友会很快赶上你。

一个类似的故事正在你的计算机中上演，它带有处理器或 CPU。处理器到达一个依赖于某个值的分叉。访问存储该值的 RAM 需要(相对)很长的时间，所以当这发生时，处理器在其中一个结果上冒险并继续它的方式。如果这是正确的选择，生活是美好的，结果你的计算机更快，但如果不是，不正确的工作很快被扔掉，并采取了正确的道路。这种无序执行在理论上很棒，因为它允许处理器在任何时候都在做一些事情，而不是无所事事，但是它的实现有一些微妙的细微差别，导致了我们现在看到的问题。

在你的计算机中有几种不同类型的内存，每一种都有不同的速度数量级。一般来说，记忆速度越快，你拥有的就越少。计算机中最快的内存类型之一是高速缓存，它很小——最快的高速缓存通常只能存储 32kb 的数据(例如，仅仅是手机中照片的一小部分)。现在，您的计算机希望能够快速访问它需要的信息，因此它试图将有用的数据保存在这个快速缓存中，以便快速访问。不幸的是，什么是有用的数据通常很难预先预测，因此大多数处理器都假设，如果一段数据最近被使用过，那么它很可能在不久的将来再次被使用，并将它存储在高速缓存中。就像之前的推测性执行一样，这是一件让你的计算机更快的好事，理论上不会造成任何麻烦。

现在我们要把我们最喜欢的两个 CPU 优化结合起来。作为推测性执行的结果，处理器到达一个分叉，并在预期中沿着一条路径继续前进。在这样做的同时，它从内存中访问更多的值，其中一些将最终存储在更快的缓存中，以加快后续的使用。结果可能是这是一条错误的路径，处理器返回并遵循正确的路径，丢弃它沿途做的不正确的工作。但是，加载到缓存中的值会保留在那里，因为它们在正确的路径中可能仍然有用，并且因为还没有加载任何其他可以替换它的值。这就是乐趣的开始。

接下来发生的事情对我来说很难详细解释，所以我会尽我所能，以一种比较容易理解的方式来传达总体思想，希望这种方式仍然符合基本原则。

攻击者可以构建一个程序，试图访问处理器推测性执行的分支中受保护的内存。在普通的、非推测性的执行期间，用于阻止这种未授权的存储器访问的保护措施将防止数据被访问和加载到高速缓存中。然而，在推测性执行期间，只有当分支被验证为正确的分支时，才应用这些措施。如果攻击者确保包含这个受保护的内存访问的分支不是正确的分支，那么这些权限永远不会被检查，但是请求的值仍然如前所述被加载。

虽然直接访问缓存中新加载的数据是不可能的，但一个巧妙构建的程序可以根据受保护的值以完全合法的方式将不同的项加载到内存中。例如，在推测性执行期间，如果受保护的值是 0，我可能加载内存“box”10，或者如果它是 1，我可能加载内存“box”11(为了简单起见，假设现在只能是这两个值)。一旦处理器确定它不应该跟随分支并继续正常执行，攻击者就可以测量加载内存“盒子”10 和 11 所花费的时间。由于之前应该只加载了其中一个盒子，因此一个盒子的加载速度应该快得多，因为它已经在缓存中，而另一个盒子在较慢的内存中。恭喜你，尽管你的计算机通常采用各种措施来阻止你泄漏受保护的数据，但你还是成功了。冲洗并重复，可能会暴露计算机内存中的所有数据。

这种攻击称为旁道攻击，依靠物理现象从系统中收集额外的信息。在这种情况下，Meltdown 和 Spectre 是基于时间的旁道攻击，它们利用了现代计算机系统中不同层次内存的基本属性。如前所述，这使得它们特别难以修复，因为它们是物理设备的属性，而不是软件指令序列中的逻辑错误。

与高特权内存访问相关的英特尔特有的 Meltdown bug 更容易在软件中修复，目前正在提供修复程序。你可能会在更新描述中看到 KPTI 或凯撒的名字。这些与熔毁有关，所以请尽快安装。

对 Spectre 的缓解是一个更令人不安的情况。它不仅会潜在地影响你的电脑，还会影响你的手机和任何其他现代计算设备，不管里面是什么处理器。世界各地的软件公司都需要花费时间和精力来最小化它的影响。Chrome、Firefox 和 Safari 等网络浏览器面临的风险很高，因为网页执行的代码可能会触发该漏洞。具有各种缓解措施的浏览器更新将在未来几周内发布，但现在有一些方法可以启用其中一些。这些细节在页脚，我会尽我所能更新他们的要求。

长话短说，几乎所有现代处理器都有两个严重的设计缺陷，允许任意访问内存，可能会向攻击者泄露密码和加密密钥等敏感信息。正确地修复一切需要一段时间，所以在此期间，确保一旦有更新可用，就安装。早在 6 个月前，这些攻击就首次被披露给英特尔等相关组织。鉴于多个独立团体参与了披露，这些漏洞也有可能被其他团体发现，并可能被武器化以窃取数据。因此，通常的安全建议适用——避免看起来不可靠的下载和网站，注意可疑的活动电子邮件，如密码重置，并确保您为每个网站使用强有力的、唯一的密码。我发现密码管理器在这方面非常有用，我将在下面链接我当前的选择。

我希望这个解释者对于理解这些最近的漏洞有所帮助。综合起来看，我一直在关注澳大利亚的主流新闻，但几乎没有记录。与此同时，世界各地的人们利用这些漏洞和分享他们发现的速度惊人，用不了多久就会发生一些真正的破坏。我想在接下来的几天和几周内，我们会听到更多关于熔毁和幽灵的事情，所以更新你的设备，让你周围的人也这样做，然后吃点爆米花。

**进一步阅读**

[https://meltdownattack.com](https://meltdownattack.com)

我强烈建议使用密码管理器来跟踪所有登录的强而唯一的密码。我目前选择的密码管理器是 remembar([https://www.remembear.com](https://www.remembear.com))

**您需要应用的更新:**

Windows:

*微软正在通过 Windows Update 推出更新，将于 1 月 9 日左右推出*[https://www . the erge . com/2018/1/3/16846784/Microsoft-processor-bug-Windows-10-fix](https://www.theverge.com/2018/1/3/16846784/microsoft-processor-bug-windows-10-fix)

MacOS:

*苹果发布了 MacOS 10.13.2 的部分补丁(使用苹果图标>查看关于这台 Mac)。在不久的将来，10.13.3 显然会有更多的修正。*

镀铬:

定于 1 月 23 日发布的 Chrome 64 将包含缓解措施。在此期间，可以按照[*【https://support.google.com/faqs/answer/7622138#chrome】*](https://support.google.com/faqs/answer/7622138#chrome)的指示启用“现场隔离”设置

其他软件应根据需要进行更新。

2018 年是我尝试做一些不同的事情的一年。在 insta gram[或 YouTube](https://www.instagram.com/hadenhiggs/)上关注我的其他创作