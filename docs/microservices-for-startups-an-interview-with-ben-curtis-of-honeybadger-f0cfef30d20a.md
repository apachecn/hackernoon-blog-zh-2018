# 初创公司的微服务:Honeybadger 的本·柯蒂斯访谈

> 原文：<https://medium.com/hackernoon/microservices-for-startups-an-interview-with-ben-curtis-of-honeybadger-f0cfef30d20a>

*这次采访是为我们的* [*创业微服务*](https://buttercms.com/books/microservices-for-startups/) *电子书做的。一定要去看看关于微服务的实用建议。感谢 Ben 的时间和投入！*

![](img/08772114c434564edcfd6fb6fff97014.png)

[*Ben Curtis*](https://twitter.com/stympy?lang=en) *是*[*honey badger*](https://www.honeybadger.io/)*的联合创始人，该公司为 web 开发人员处理生产监控，并提供零工具，360 度覆盖错误、中断和服务降级。*

对于上下文，您的工程团队有多大？您是否正在使用微服务，能否概述一下您是如何使用它们的？

我们的工程团队是整个公司——三个人。我们使用了一些微服务。一个处理所有传入的 API 流量，查找客户应用程序报告的错误。另一个处理从 Heroku 应用程序接收 logplex 流量，记录从 Heroku 平台报告的错误。

**你是从整体开始，后来采用微服务的吗？如果是，采用微服务的动机是什么？**

我们从 Rails monolith 开始，在入站 API 流量开始淹没我们的应用时，我们采用了微服务。很明显，我们需要以不同的方式扩展它们，并且我们可以从处理 API 流量的轻量级应用程序中受益。分离微服务并不太复杂，因为我们已经通过使用作业队列隔离了 monolith 中的 API 代码。

作为一个团队/工程组织，你是如何处理微服务这个话题的？

没有太多调整的必要——我们有一个清晰的感觉，简单地将一块功能从我们的 monolith 移动到一个单独的应用程序，该应用程序具有实现微服务的单一职责。

在技术选择上有多大的自由度？你们是否都同意坚持使用一个堆栈，或者是否有尝试新堆栈的灵活性？

在考虑技术选择时，我们给自己 100%的自由。我们在两三项技术上做了突破，但最终我们选择不使用，主要是因为不想让我们的部署故事变得复杂。换句话说，虽然我们在创建微服务时考虑过将新语言和新方法引入我们的技术体系，并且我们确实在不同的体系上部署了生产微服务，但我们决定坚持使用我们熟悉的技术，以免增加我们运营体系的复杂性。我们会定期重新审视这个决定，看看采用新技术是否会带来潜在的性能或可靠性优势，但到目前为止，我们还没有做出改变。

你有没有把一个单一的应用程序分解成更小的微服务？如果是的话，你能给我们介绍一下这个过程吗？

我们研究了哪些功能在逻辑上是独立于其他功能的。在我们的案例中，很明显，数据接收可以而且应该与客户与存储在我们数据库中的数据的交互完全分离。在这一点上，很简单，从我们的 monolith 中删除处理 API 端点的代码，并将该代码放入一个单独的 Rack 应用程序中。我们还将相关测试从一个应用程序转移到另一个应用程序。我们在一开始做出的一个关键决定是，新的应用程序不能访问主数据库。它需要能够完全独立地运行，这将允许我们的 API 继续接收数据，即使我们的主数据库关闭或我们的主服务不可用。我们非常依赖 Redis，它不仅用于存储作业队列，还作为微服务工作所需的主数据库数据的缓存层。

**微服务对你的开发过程有什么影响？您的运营和部署流程？**

我们的开发流程没有受到太大影响。当从一个代码库转移到另一个代码库时，我们确实有一些额外的上下文切换成本，但我们的 monolith 比我们的微服务更新得更频繁，所以即使这样也是最小化的。我想我们得到的教训是，根据业务逻辑的变化来设定微服务的边界是有帮助的。如果您的代码中有一个区域几乎从不改变，但另一个区域经常改变，那么使用这个区域作为可以拆分到微服务中的指示可能是有意义的。理想情况下，您应该能够创建您的微服务，然后能够在一段较长的时间内运行它，而无需进行太多更改。

当我们拆分我们的微服务时，我们评估了其他编程语言(用 Elixir 和 Go 代替 Ruby)和部署策略(用 Docker 或蓝/绿 EC2 实例代替 Capistrano)。我们甚至和 Elixir 和 Docker 一起去生产了一段时间。但最终，我们决定不在我们的运营和部署流程中引入额外的复杂性，我们最终使用 Capistrano 部署了 Rack 应用程序。然而，我们确实将微服务隔离到单独的自动扩展组中，这些组具有自己的负载平衡器，并且我们用于配置实例的角色也不同，因此即使使用相同的堆栈，我们仍然增加了一些操作负担。

**微服务对您的测试方式有何影响？**

我们还没有看到对我们测试方法的影响。每个微服务都有测试，就像我们的 monolith 一样，但是我们没有跨服务测试，因为它们彼此之间不直接对话。因为数据只在一个方向上流动，并且因为我们使用消息总线来传输数据，所以我们只是隔离地测试我们的微服务。

**微服务对安全性和控制数据访问有何影响？**

安全性和数据访问对我们来说不是问题，因为我们的微服务只接收数据，并与系统的其余部分断开连接。

*再次感谢 Ben 的时间和投入！这次采访是为我们的* [*创业微服务*](https://buttercms.com/books/microservices-for-startups/) *电子书做的。一定要去看看关于微服务的实用建议。*

*本文原载于*[*buttercms.com*](https://buttercms.com/blog/microservices-for-startups-an-interview-with-ben-curtis-of-honeybadger)*。这是《创业公司的微服务》一书* [*采访系列的一部分。新章节一发布，你就可以通过电子邮件收到。*](https://buttercms.com/books/microservices-for-startups/)

如果你喜欢这篇文章，请在下面鼓掌，帮助它传播！如需更多类似内容，请关注我们的[*Twitter*](https://twitter.com/ButterCMS)*和* [*订阅我们的博客*](https://buttercms.com/blog/) *。*

如果你想在你的网站上添加一个博客或者内容管理系统，而又不想在 Wordpress、 [*上浪费时间，你应该试试黄油内容管理系统*](https://buttercms.com/) *。*