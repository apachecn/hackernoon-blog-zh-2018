# ML 编程让[太多]变得简单—第 2 部分

> 原文：<https://medium.com/hackernoon/ml-programming-made-too-much-easy-part-2-13a2dc9e5e91>

机器学习(ML)，尤其是人工神经网络(ANN)，是我们今天可以使用的强大工具——你可以在[第一部分](/@alonn24/ml-programming-made-too-much-easy-part-1-cf9171e41dfb)中读到关于它的所有内容。给定训练数据集，我们可以训练一个模型，该模型将为我们提供某些特征的预测，如预测给定平方英尺、卧室数量等的房价。如果你缺乏关于 ML 或 ANN 的知识，请阅读[第 1 部分](/@alonn24/ml-programming-made-too-much-easy-part-1-cf9171e41dfb)，它解释了什么是 ANN 及其构建模块。接下来，我们将了解如何使用 Tensorflow 构建、训练和预测模型。

![](img/ff5477769d90b8834e4e277fcabcc28a.png)

Tensorflow 是一个开源的 ML 框架，供每个人使用。Tensorflow 试图让简单的事情变得简单，让复杂的事情变得可行。通过 Tensorflow，可以使用简单的 python API 轻松创建、训练和预测人工神经网络。

要创建一个 ANN 模型，首先我们需要创建一个输入层，其输入节点的数量与我们要提供给模型的输入参数的数量一样多。接下来，我们需要创建隐藏层，它将为模型提供持久存储所需数据所需的深度，最后，我们需要创建输出层，它包括输出所需的所有节点。所有层的权重和偏差都将被初始化，并准备进行优化。我们还需要陈述其他已知参数，如损失函数、训练优化策略，可能还有一个日志记录器。

以下是用 python 编写的张量流人工神经网络模型的示例:

看起来相当苛刻，让我们深入探讨，打破这里的复杂性。首先，我们有两个初始化函数——一个用于权重，一个用于偏差。zero_weights 函数创建一个从一层到另一层的初始权重变量，zero _ biases 为所有可用节点创建一个偏差变量。

接下来，我们将从输入层开始创建 ANN 中的所有层。假设我们的输入有 9 个变量，我们创建一个新的 tf 变量，从 0 到 9，因为它是第一层。然后我们再创建 3 个隐藏层，50 个节点-> 100 个节点-> 50 个节点，命名为“层 1”，“层 2”和“层 3”。接下来，我们创建只有一个输出的输出层。最后，我们创建损失函数，命名为成本，这是损失函数的另一个名称。损失函数将通过均方根来测量，以找到与期望值最接近的值，优化策略是 adam，它是一种随机优化方法。这是目前已知的最佳策略。

为了训练一个新创建的模型，我们需要向它提供训练数据集。随着训练过程的发展，权重和偏差变得更加精确，以优化输入组合并减少损失函数。

下面是一个给定 X 输入和 Y 预期输出的模型训练示例:

现在，模型只是一个保存我们之前创建的所有变量的对象。Df 是数据帧，值是预期的输出列。x 将是值列旁边的所有内容，Y 将只是 Y 列。现在，我们运行优化器 50 个时段，每个时段将输入所有数据集并执行优化器以优化结果。然后，在每个时期之后，我们将计算损失函数，并观察它随着时间的推移而减少。

我们必须用新的测试数据集来验证创建的模型。测试数据集必须是模型之前没有看到的新数据集，并且将向我们显示误差保持较低，因为它可能由于各种原因产生错误的结果。其中一个原因可能是当模型被训练为适合特定训练数据集时发生的过度拟合。例如，它可能是由太多的纪元引起的。

![](img/f3995a31a24281c815347abedddfe7a1.png)

创建 Tensorflow 模型需要大约 35 行代码，其中包含大量样板代码、默认值和需要指定的最佳实践。Keras 是一个试图解决这个问题的新工具。Keras 是构建在 Tensorflow 等其他框架之上的高级 API，提供了几乎不费吹灰之力就能构建 ANN 模型的能力。

相比之下，同样的 Tensorflow 模型可以用 Keras 用 6 行代码构建:

Keras 提供了该实现的简化版本，旨在提供快速实验参考。虽然 Keras 是轻量级的，但它提供了很好的定制级别，我们今天不仅可以用它来做实验，还可以用它来实现生产级别的特性。实现要好得多，所有的最佳实践都是在幕后实现的。使用 Keras 和建立 ann 比你想象的要快得多。

![](img/833156ccd343edd5a3d695361670eb9f.png)