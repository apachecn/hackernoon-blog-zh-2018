# PHP 7.3 及其优势

> 原文：<https://medium.com/hackernoon/php-7-3-and-its-gifts-ecffb275ae5d>

![](img/0a7ef8e09476e9e4f653237db68d5e43.png)

# PHP 7.3 简介

这是 12 月 24 日的晚上，

尽管这段时间房子很温暖，有一股伤感的味道，主要是因为前几天壁炉里燃烧的木头。

圣诞树闪烁的灯光照耀着一张有 9 道菜的餐桌，这是我刚刚和全家人一起吃完的。

我现在穿上了我最喜欢的力量游侠法兰绒睡衣(还记得那些吗？).

我把闹钟设定在 7 点，尽管我已经知道这是没有用的，因为我会在闹钟响之前就醒了。

我等不及要醒来了！
就像过去 4、5 年的同一天一样。

…

早上，黎明开始后的几分钟，我跳下床，跑到楼下的树下。

![](img/5e8e51bfdc65ba389751809485eed932.png)

正如你可能已经理解的那样，这一事件发生在几年前，但我后来才知道，给予和接受新东西的欣快感只是由脑内啡释放到他们的大脑中引起的，这种欣快感在没有任何来自我的意识侧的力量的情况下仍然存在。

近 20 年来，我已经在两个国家搬过家，有过几十份工作经历，但我仍然热爱圣诞节。

我相信，拉斯马斯·勒德尔夫和他的团队也是如此。

事实上，今年圣诞节 PHP 的开发团队将会给我们一个新版本的语言。

终于到了 PHP 7.3 的时候了。

从 2015 年 12 月 3 日 PHP 7.0 的正式发布开始，
这些版本已经以不真实的一致性进行了调度和部署，并且增强列表呈指数级增长。

即使新版本与您去年使用的版本之间不会有重大差异，仍然值得查看新特性，并检查这些特性将如何影响您在 2019 年的日常工作流程。

我把所有的更新分成了四个部分，分别是:**语法、弃用、新特性和其他变化。**

我认为，使用这种方法，你可以只检查出你感兴趣的功能，但是，我的建议是，至少有一个快速浏览所有的功能。

**语法**
Heredoc 和 Nowdoc 语法
允许函数调用中有尾随逗号
list()引用赋值
**弃用**
弃用 image2wbmp()函数
弃用 FILTER_FLAG_SCHEME_REQUIRED 和 FILTER_FLAG_HOST_REQUIRED 标志与 FILTER_VALIDATE_URL 一起使用
弃用不区分大小写的常量
**新功能**
JSON _ THROW _ ON _ ERROR

# 实现了灵活的 Heredoc 和 Nowdoc 语法

Heredoc 是一种编写字符串的完美方法，它允许创建多行文本，而无需使用换行符。

Heredoc 像双引号字符串一样计算变量和字符。

Heredoc 的常见用途是创建多行文本、SQL 查询，或者为电子邮件或 web 创建 HTML 片段。

这个特性在几个版本之前就已经实现了，但是它非常严格，迫使 [web 开发者](https://hackernoon.com/tagged/web-developer)对语法和缩进非常关注。

PHP 7.3 的改进在于使特性的实现更容易适应和使用。

```
$NorthPolePopulation = ['Santa Claus', 'Msr. Claus', <<<REINDEERS
    Rudolph
    Dasher
    Dancer
    Prancer
    Vixen
    Comet
    Cupid
    Donner
    Blitzen
    REINDEERS, 'Elf Ernest'
    ]*;*
```

一个有经验的人可能已经发现了一些变化，这些变化使得这段 PHP 7.3 比以前的版本可读性更好。

让我们从缩进开始:在这个新版本中，最后一个标记(前一个例子中的第二个驯鹿)不需要成为新行的第一个字符串，正如您可以看到的，代码非常容易阅读和理解，如果我需要打破缩进，

该行可以包含空格或制表符，这没有关系，因为它们将从 heredoc 中的内容中删除。

对我来说，一个很大的不同是，在之前，结束标记后面唯一允许的字符是分号，这意味着您必须终止命令，

现在，相反，

**你可以添加其他表达式，因此，正如我上面展示的，你可以在其他命令中使用 heredoc 语句，例如数组。**

使用起来似乎很复杂，但请记住，最终 heredoc 和 nowdoc 是简单的字符串。

说到与旧版本 PHP 的回溯兼容性，致力于这次更新的人做了一件惊人的工作，简单来说，只要你没有任何包含相同结束标记的字符串，你就不需要做任何事情，一切都会很好。

```
$reindeers = <<<REINDEERS
  REINDEER
  CLAUSSREINDEER
  REINDEERS;
```

在上面的例子中，唯一有效的结束标记是最后一个。

原因是最后一个与开始标记完全相同，而驯鹿和子句 reader 将显示为内容。

一点小插曲。

我几乎没有提到过，但是现在我要涵盖所有的内容。

它们不计算变量或特殊字符。

我没有在这上面停留的原因是 PHP 7.3 带来的变化对于 nowdoc 也是有效的，

# 在函数调用中允许尾随逗号

科学证明，web 开发人员花在修正脚本语法错误上的时间，可以从头开始重新编写整个程序，而且不会出错。

(Ok 不是，但是你说到点子上了)。

一些最常见的错误很简单，比如忘记在命令末尾添加分号，或者在不必要的地方添加冒号或字符。

有了 PHP 的新版本，至少在某些情况下，这个问题可以得到解决。

正如您在上一节中所看到的，看起来核心语言正在向一个不太严格的版本发展，这将使代码更加可定制，同时提供对错误处理和调试的更多控制(您很快就会看到)。

对于一些 web 开发人员来说，尾随逗号是一个问题，忘记将它们放在需要的地方，或者将它们添加到 PHP 不允许的地方会很快变成一场噩梦。

在 PHP7.3 之前的版本中，类似下面的代码行将导致以下错误消息:

```
santaBag('football', 'dolly', 'family portrait', 'Monopoly',);
// PHP Parse error:  syntax error, unexpected ')'
```

现在取而代之的是，**只要你只使用一个逗号，你可以把它加在列表的末尾，脚本就会顺利解析。**

同样的概念也适用于数组，
用我以前用过的同一个例子:

```
$reindeers = [“Rudolph”,
    “Dasher”,
    “Dancer”,
    “Prancer”,
    “Vixen”,
    “Comet”,
    “Cupid”,
    “Donner”,
    “Blitzen”,
   ];
```

把最后一个逗号留在那里不会抛出任何错误。

我是无压力工作和编码的坚定支持者，当你处于一种平静的心态时，甚至可以听一些环境噪音或背景音乐，

不得不中断编码流程，以便回去修复这些小的语法问题，甚至可能一整天只有 2 或 3 次，使压力迅速升级，最终将使代码看起来很松散。

不必担心这个小小的语法错误会大大提高项目部署的整体质量。

需要记住的是，这个新规则不影响函数或方法声明。

```
function delivery($day, $month, ) 
{ 
}
```

注意，上面的代码片段仍然会返回一个错误
，为了避免这个错误，你可以通过 PHP5.6 中发布的…(点点点)关键字使用变量函数。

关于向后兼容，完全没有问题。

您已经编写的代码将继续正常工作。

如果你需要清理一点，我建议重构的唯一部分是把刚才看到的变量参数换成这个尾随逗号。

但是不要在你看到的每一个数组和方法后面都加上逗号，要谨慎使用这个新特性。

# List()引用赋值

List 是一个 PHP 构造(一个类似 echo 的简单命令)，如果您知道如何使用它，它会非常强大。

它用于在一次操作中分配多个变量，
语法有点奇怪，但是一旦理解了它的工作原理，就可以很容易地实现它。

这里有一个简单的例子:

```
$christmasWords = ["Santa", "distributes" ,"gifts"];
list($subject, $verb, $object) = $christmasWords;
echo "$subject $verb the $object on christmas day";
```

在这里，你可以看到一个包含圣诞单词的数组，在这种情况下，我们要做的是对它进行划分，并为数组的每个元素赋予一个单一变量。

这与 explode()不同，因为这个过程自动化程度较低，但给了程序员更多的控制权。

这是另一个例子:

```
list($subject,, $object) = $christmasWords;
```

在这种情况下，不会分配“distributes”(数组的第二个元素)。

一个更难的例子将让您看到这个命令有多强大:

```
$Passport = ['locality' => 'North Pole', 'position' => 'Santa Claus'];
**list**('position' => $role, 'locality' => $location) = $Passport;
**Echo** $role; *// will output Santa Claus*
**Echo** $location; *// will output North Pole*
```

现在，

谈到 the 7.3 版本的变化，list()上引用赋值的 RFC 在大约 18 年前第一次被请求[关于引用赋值的 bug](https://bugs.php.net/bug.php?id=6768)。

考虑以下命令

```
**$**SantaClaus = &$SaintNicholas;
```

在前一种情况下，创建的变量不是复制现有变量的值，而是两个变量指向相同的数据。

**这意味着当任何变量发生变化时它都会影响原始数据。**

```
$SaintNicholas = "Saint Nicholas";
$SantaClaus = &$SaintNicholas;
Echo $SaintNicholas; // echoes "Saint Nicholas"
Echo $SantaClaus; // echoes "Saint Nicholas"
$SaintNicholas = "Father Christmas";
Echo $SaintNicholas; // echoes "Father Christmas"
Echo $SantaClaus; // echoes "Father Christmas"
```

list()在 PHP 7.3 中有什么变化？。

PHP 7.3 允许我们通过引用分配变量，
它的优点是现在我们可以编辑单个变量而不是在数组中寻找索引。

```
$reindeers = ["Rudolph","Blitzen"];

**list**($zero, &$first) = $reindeers;
$first = 'Vixen';
**echo** $reindeers[1]; *//echoes "Vixen"*
```

因为这是一个全新的特性，在没有向后兼容性问题之前，不可能使用这个特性。

然而，尽管这是该语言的一个长期要求的特性，PHP 社区现在更喜欢通过值对象来实现，这些值对象在任何情况下都将通过引用来传递，并使代码更容易理解。

# 结论

如果你已经读过我以前的一些博文，你就会知道我喜欢谈论细节，

![](img/afb608c5f5a0dfe994c41b1e05c97dc1.png)

深入挖掘，以提供尽可能完整的价值。

在本文的第一部分中，您已经看到了 PHP 7.2 和即将发布的新版本之间的一些语法差异。

以上只是由拉斯马斯·勒德尔夫领导的开发团队已经实现的更新中的一小部分。

经过很长一段时间的停顿后，在过去的几年里，全世界的 PHP 开发人员社区每年都在享受这种语言的新版本。

这种改进是有目共睹的，数据显示 PHP 7.x 与更流行的服务器端语言如 Python 和 NodeJs 相比没有什么可羡慕的

在等待版本 8 的突破性变化时，请继续关注并订阅我的时事通讯，以便在本文的其他部分发布时得到通知。

# 未完待续…

这篇博文是 Kindle book“[*PHP 7.3 及其圣诞礼物*](https://amzn.to/2PpbxeS) ”的一段

[![](img/81f240e8dd073aab6ad31da0e0d28d60.png)](http://eepurl.com/dIZqjf)

# 现在轮到你了

我希望你喜欢这次语法复习。

现在我想听听你的意见:

PHP 7.3 的什么新特性你会经常使用？

请在下面留言告诉我。

如果你喜欢这个内容，并且你渴望更多，加入脸书的社区，我们在这里分享信息和新闻，就像这个一样！