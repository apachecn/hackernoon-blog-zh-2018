# 智能合约——玻璃大炮之路*

> 原文：<https://medium.com/hackernoon/smart-contracts-road-of-a-glass-cannon-581e3d60e2d1>

## 如此强大…却又脆弱

![](img/bd5151da3769d557c255f84ecf04e7a7.png)

by [Emily Morter](https://unsplash.com/@emilymorter?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

> *玻璃加农炮——通常指具有巨大潜力的 smth，例如(攻击)，但通常防御较差。

这些天来，“智能合同”作为其他热门词汇(“物联网”、“人工智能”、“量子计算”)得到了大量的炒作。兴趣不仅在初创公司和其他早期采用[区块链](https://hackernoon.com/tagged/blockchain) [技术](https://hackernoon.com/tagged/technology)的公司中蔓延，也吸引了大型 [**公司**](https://azure.microsoft.com/en-us/blog/introducing-enterprise-smart-contracts/) **的注意。**

*最后，不随大流真的很难。但是……什么是智能合约？*

一般而言，智能合同只是部署在区块链上的自动执行计算机程序，代表纸质合同的数字化版本。

将它们发布在区块链上给智能合约带来了几个很酷的特性，的确让它们变得独一无二。

智能合约承诺的最重要功能:

1.  在合同谈判(评估)和执行过程中取消中间人
2.  合同的自动执行
3.  不信任—(然而 [**有争议**](https://www.libertarianism.org/building-tomorrow/smart-contracts-arent-trustless-nor-should-they-be) )
4.  不变性(无论部署在区块链上的是什么，都不能更改)
5.  让律师变得多余

补充说明——第三点和第五点是密切相关的。无真基本上意味着智能契约的利益相关者不必依赖第三方来执行代码中包含的条件。这些条件一旦满足，就会自动触发并执行。由于智能合同代码应根据法律规则编写，因此在此阶段不需要律师。

然而，这并不意味着完全不需要它们——毕竟，在创建智能契约时，必须确保它得到正确验证。这就需要开发者和律师之间的紧密合作，或者需要同时具备这两种技能的人。随着智能合同的发展，新的工作可能会出现。在这种情况下，你会如何称呼自己？开发人员/程序员和律师的结合会带来什么？—***罗默*【什么？“*律师*”？只是一个想法。**

聪明的合同承诺非常令人鼓舞。然而，尽管我是智能合同的忠实粉丝，并且带着他们带来的所有“行李”——我们离乌托邦还很远。尤其是从安全角度看合同。

在这篇文章中，我将揭开冰山的一角，并简要描述一些显著削弱智能合同创建效率的挑战。

由于目前最流行和广泛使用的区块链智能合约平台( [**可能除了中国**](https://www.forbes.com/sites/nguyenjames/2018/03/29/why-chinas-largest-cryptocurrency-neo-is-aiming-to-build-a-smart-economy/#1949becc54d4) )是以太坊，我将直接关注它。

# 图灵完备性

一堆理论:

图灵完全性是一种可以与大多数典型编程语言联系起来的属性，简单地说，它们是完全通用的。根据[丘奇-图灵论文](https://en.wikipedia.org/wiki/Church%E2%80%93Turing_thesis)图灵完备的编程语言可以执行任何可以手工完成的计算。

在比较以太坊和比特币时，两者都使用智能合约语言——比特币使用 [**脚本**](https://en.bitcoin.it/wiki/Script) ，以太坊使用 [**实性**](https://en.wikipedia.org/wiki/Solidity) 。这两者的主要区别在于，Solidity 是图灵完全的——它不仅给开发者创造更复杂的契约的可能性，而且基本上可以编写任何给定的契约。

![](img/1e7c06706fb1850e725a7008b5513712.png)

Smart contract

图灵完全性是完全有益的，对吗？毕竟，由于它，我们可以模拟包含大量业务逻辑和规则的非常复杂的情况。

那会有什么问题呢？

在一个完美的世界里，可能什么都没有。但是……(是的，总要有“但是”)……我们不是生活在这样的世界里。随着复杂性的增加，分析智能合约代码是否存在潜在的安全问题变得更加困难。简而言之，它基本上意味着准备好应对任何恶意攻击和合同可能执行的每一种方式。不幸的是，更复杂的契约=更多的代码行。将智能合约代码行数增加一倍并不会将潜在暂停点的数量增加两倍。—更有可能我们在这里谈论的是指数函数。

因此……确保合同安全——这不是一项简单的任务——想象一下创建一个没有任何错误的软件。即使看起来很有挑战性，也绝对不能草草了事，因为忽略它的“代价”，正如历史所显示的，可能是 [**戏剧性的**](/@ryanshea/simple-contracts-are-better-contracts-what-we-can-learn-from-the-dao-6293214bad3a) 。

# 坚固性编码

至于智能合约安全性，代码部署后发生的任何修复都可能会以非常糟糕的结果告终。因此，首先要做的是。为了开始解决安全“漏洞”,我们需要深入到最底层——看看编码级别。

在 Solidity 中编写智能契约，人们可能会注意到它与 JavaScript 有很多相似之处。从另一方面来说，它有更多的特点，不得不考虑在过去并不真正知道。

如前所述，在区块链上使用 smart contract 部署的代码是不可变的——它将永久存在。此外，在谈论智能合同时，经常讨论的是“代码就是法律”规则。当你阅读智能契约体时，你可以确信每一个特定的函数将完全按照代码所说的那样去做。不幸的是，所有这些都让开发者律师独自承担了巨大的责任，没有犯错的余地。

*那么，Solidity 代码中有哪些示范性的方面让它如此独特呢？*

举个简单的例子，开发人员必须考虑谁以及如何与智能合约中的功能进行交互。从安全角度来看，这一点至关重要。

在 solidity 中，有四个固有的“可见性修饰符”来决定从哪里调用特定的函数。例如，向 function 添加一个“内部”修饰符意味着它只能由该契约中的其他函数以及从其继承的契约来触发。

此外，还有两个本机“状态修饰符”决定函数如何与区块链交互…以及无限量的自定义修饰符，它们可以简单地根据特定需求来创建。

从安全的角度来看，这里最重要的是可见性修饰符和自定义修饰符。

默认情况下，用 solidity 编写的每个函数都被设置为“public”。意思是每个人都可以调用和触发。智能合约越复杂，它需要的功能就越多，每个公共功能都是恶意操作的潜在入口，因此，良好的做法是将公共功能的数量限制到必要的最低限度。

自定义修饰符的用途略有不同，可以用于各种不同的原因。一个例子是 OpenZappelin[**only owner**](https://github.com/OpenZeppelin/openzeppelin-solidity/blob/master/contracts/ownership/Ownable.sol)**修饰符，一旦添加到一个函数中，就只允许一个特定的“所有者”执行该函数。**

**有哪些函数可以从这种修饰符中受益？**

**可能有各种不同的例子。想象一下，一个功能可以让你发行新的代币，从而增加市场上代币的总量。想象一个允许你改变智能合约逻辑的函数…等等。使用此类修饰符(无需进一步解释)无疑旨在提高智能合约的安全性。(允许每个人都为自己创建令牌并不是一个好的做法，不是吗？)此外，使用这样的修饰语是普遍的做法。但是，[一些案例表明，它仍然不是完美的](/@bill_26126/oyster-update-b813390ce10e)。**

****这导致一个结论，即曾经作为安全措施引入的实践在未来可能需要一些进一步的发展。****

# **结论**

**如前所述，我绝对是智能合约的粉丝，我希望他们的采用程度比现在更重要。另一方面，考虑所有关于它们最有利的特性和安全问题的讨论，有时会导致矛盾的发现。**

**幸运的是，有很多工作正在进行，以保护和促进智能合同的创建。像 [**OpenZappelin**](https://openzeppelin.org/) 这样的网站提供了巨大的库和安全可靠的框架。 [**Consensys**](https://consensys.github.io/smart-contract-best-practices/) 提供了大量关于智能合约应防范的最佳实践和攻击类型的信息。这些并不是唯一的例子。**

**智能合约实际上可以比作极易出错的玻璃炮，然而它们带来的好处仍然太大，不能不冒这个风险。**

**__________________________________________________________________**

**你喜欢这篇文章吗？请随意分享您的想法/评论。**

**卡米尔·维特科夫斯基是一名住在波兰克拉科夫的信息系统分析师。你总能在[**LinkedIn**](https://www.linkedin.com/in/kamil-witkowski-ba134892/)**上找到他，打个招呼:)****